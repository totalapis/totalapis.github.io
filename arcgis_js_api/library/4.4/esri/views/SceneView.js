// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.4/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/DOMContainer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang dojo/on dojo/dom dojo/dom-construct ../core/Accessor ../core/HandleRegistry ../core/Scheduler ../core/watchUtils ../widgets/Popup ./PopupManager ./ui/DefaultUI ../core/accessorSupport/decorators".split(" "),function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t){var u=[0,0];m=function(c){function r(){var a=c.call(this)||this;a.height=0;a.position=null;
a.resizing=!1;a.root=null;a.surface=null;a.suspended=!0;a.width=0;Object.defineProperty(a,"_measureInfo",{enumerable:!1,writable:!1,value:{task:null,freq:16,time:750}});a._domHandles=new e;a.watch("interacting",function(b){var c=a.surface;c&&c.setAttribute("data-interacting",b.toString())});return a}d(r,c);r.prototype.getDefaults=function(){return a.mixin(this.inherited(arguments),{popup:{},ui:{}})};r.prototype.initialize=function(){var a=this,c=this._measureInfo,r=null;p.init(this,"container",function(e,
g,n,d){if(null!=e||null!=g)r&&(r.remove(),r=null,c.freq=16,c.time=750),c.task&&(c.task.remove(),c.task=null),e?(r=b(window,"resize",function(){c.freq=16;c.time=750}),c.task=l.addFrameTask({prepare:function(b){var c=a._measureInfo;c.time+=b.deltaTime;c.time<c.freq||(c.time=0,a._measure()?(c.freq=16,a._set("resizing",!0)):(c.freq=Math.min(750,2*c.freq),512<=c.freq&&a._set("resizing",!1)))}})):a._set("resizing",!1),a._measure(),e=a.root,g=a.surface,n=a.width,d=a.height,e&&g&&n&&d&&(e.style.width=g.style.width=
n+"px",e.style.height=g.style.height=d+"px")})};r.prototype.destroy=function(){this.ui.destroy();this.popup&&this.popup.destroy();this.container=null};Object.defineProperty(r.prototype,"container",{set:function(a){var b=this._get("container");if(b!==a){b&&(b.classList.remove("esri-view"),this.popupManager.destroy(),this.popupManager=null,f.destroy(this.root),this._set("root",null));if(a){a.classList.add("esri-view");b=document.createElement("div");b.className="esri-view-root";a.insertBefore(b,a.firstChild);
this._set("root",b);var c=document.createElement("div");c.className="esri-view-surface";k.setSelectable(c,!1);b.appendChild(c);this._set("surface",c);this._forceReadyCycle();this.popupManager=new q({enabled:!0,view:this})}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null);this._set("container",a)}},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"popup",{set:function(a){var b=this._get("popup");a!==b&&(this._domHandles.remove("view-popup"),
b&&b.destroy(),a&&(a.viewModel.view=this,a._started||a.startup(),this._domHandles.add([p.init(this,"root",function(b,c){var r=a.domNode;k.isDescendant(r.parentNode,c)&&r.parentNode.removeChild(r);b&&!r.parentNode&&a.placeAt(b)})],"view-popup")),this._set("popup",a))},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"ui",{set:function(a){var b=this._get("ui");a!==
b&&(this._domHandles.remove("ui"),b&&b.destroy(),a&&(a.view=this,this._domHandles.add([p.init(this,"root",function(b){a.container=b?f.create("div",null,b):null})],"ui")),this._set("ui",a))},enumerable:!0,configurable:!0});r.prototype.pageToContainer=function(a,b,c){var r=this.position;a-=r[0];b-=r[1];c?(c[0]=a,c[1]=b):c=[a,b];return c};r.prototype.containerToPage=function(a,b,c){var r=this.position;a+=r[0];b+=r[1];c?(c[0]=a,c[1]=b):c=[a,b];return c};r.prototype._measure=function(){var a=this.container,
b=a?a.clientWidth:0,c=a?a.clientHeight:0;if(0===b||0===c||"hidden"===window.getComputedStyle(a).visibility)return this._set("suspended",!0),!1;var r=this.root,e=this.surface,g=this.width,n=this.height,d=this.position;if(b===g&&c===n)return this._set("suspended",!1),!1;r&&e&&(r.style.width=e.style.width=b+"px",r.style.height=e.style.height=c+"px");this._set("width",b);this._set("height",c);this._set("suspended",!1);r=(a.ownerDocument||window.document).defaultView;a=a.getBoundingClientRect();u[0]=a.left+
r.pageXOffset;u[1]=a.top+r.pageYOffset;d&&u[0]===d[0]&&u[1]===d[1]||this._set("position",u.slice());this.emit("resize",{oldWidth:g,oldHeight:n,width:b,height:c});return!0};return r}(t.declared(g));c([t.property({value:null,cast:function(a){return k.byId(a)}})],m.prototype,"container",null);c([t.property({readOnly:!0})],m.prototype,"height",void 0);c([t.property({type:v})],m.prototype,"popup",null);c([t.property({readOnly:!0})],m.prototype,"position",void 0);c([t.property({readOnly:!0})],m.prototype,
"resizing",void 0);c([t.property({readOnly:!0})],m.prototype,"root",void 0);c([t.property({value:null,dependsOn:["width","height"],readOnly:!0})],m.prototype,"size",null);c([t.property({readOnly:!0})],m.prototype,"surface",void 0);c([t.property({readOnly:!0})],m.prototype,"suspended",void 0);c([t.property({type:n})],m.prototype,"ui",null);c([t.property({readOnly:!0})],m.prototype,"width",void 0);return m=c([t.subclass("esri.views.DOMContainer")],m)})},"esri/widgets/Popup":function(){define("./support/viewModelWiring ./Widgette ./Popup/PopupViewModel ../core/HandleRegistry ../core/watchUtils ../views/2d/viewpointUtils dijit/a11yclick dijit/_TemplatedMixin dojo/keys dojo/on dojo/query dojo/Deferred dojo/i18n!./Popup/nls/Popup dojo/text!./Popup/templates/Popup.html ../core/lang dojo/_base/lang dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style ./Popup/PopupRenderer ./Popup/PopupRendererViewModel ./Spinner require".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E){var H=E.toUrl("./Popup/images/default-action.svg"),G={hidden:"esri-hidden",invisible:"esri-invisible",iconText:"esri-icon-font-fallback-text",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",
iconPaginationMenu:"esri-icon-layer-list",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-rotating esri-icon-loading-indicator",iconZoom:"esri-icon-zoom-in-magnifying-glass",base:"esri-popup",container:"esri-popup__position-container",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",shadow:"esri-popup--shadow",showDock:"esri-popup--dock-button-visible",showContent:"esri-popup--content-visible",showFooter:"esri-popup--footer-visible",showTitle:"esri-popup--title-visible",
showPagination:"esri-popup--pagination-visible",hasPopupRenderer:"esri-popup--has-popup-renderer",hasPromiseFeatures:"esri-popup--has-promise-features",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",
canDockToLeft:"esri-popup--can-dock-to-left",canDockToRight:"esri-popup--can-dock-to-right",canDockToTop:"esri-popup--can-dock-to-top",canDockToBottom:"esri-popup--can-dock-to-bottom",hasPaginationMenuOpen:"esri-popup--feature-menu-open",alignTop:"esri-popup--top-aligned",alignBottom:"esri-popup--bottom-aligned",alignLeftTop:"esri-popup--left-top-aligned",alignLeftBottom:"esri-popup--left-bottom-aligned",alignRightTop:"esri-popup--right-top-aligned",alignRightBottom:"esri-popup--right-bottom-aligned",
hasPendingPromises:"esri-popup--has-pending-promises",isPendingPromisesResult:"esri-popup--is-pending-promises-result",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",button:"esri-popup__button",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",actions:"esri-popup__actions",action:"esri-popup__action",
actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",pagination:"esri-popup__pagination",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",
paginationText:"esri-popup__pagination-page-text",paginationDocked:"esri-popup__pagination-docked",paginationDockedButtons:"esri-popup__pagination-docked-buttons",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",
featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title"},J={auto:"auto",topLeft:"top-left",topCenter:"top-center",topRight:"top-right",bottomLeft:"bottom-left",bottomCenter:"bottom-center",bottomRight:"bottom-right"},I={buttonEnabled:!0,position:J.auto,breakpoint:{width:544}},F={popupRenderer:"popup-renderer",acions:"actions",actionsChange:"actions-change",paginationTitles:"pagination-titles",view:"view"};return h.createSubclass([f],{declaredClass:"esri.widgets.Popup",
baseClass:G.base,templateString:q,constructor:function(){this._handleRegistry=new c;this._contentStorage=r.create("div");this._repositionTimeoutHandle=0},postCreate:function(){var b=this;this.inherited(arguments);var c=this.viewModel;this.own(a.init(c,"visible",function(a){u.remove(this._containerNode,G.hasPaginationMenuOpen);u.toggle(this.domNode,G.invisible,!a);this._togglePopupLocationRepositioning(a);this._toggleContentVisibility(a);this._autoAlign();this.reposition()}.bind(this)),a.watch(this,
"viewModel.view",function(a,b){a&&b&&(this.close(),this.clear())}.bind(this)),a.watch(this,"viewModel.view.ready",function(a,b){a?this._wireUpView(this.viewModel.view):b&&(this.close(),this.clear())}.bind(this)),a.init(c,"pendingPromisesCount,featureCount,promises,location",function(){var a=this.viewModel;this._displayPendingFeaturesStatus(a.pendingPromisesCount,a.featureCount,a.promises,a.location)}.bind(this)),a.init(c,"features",this._updateFeatures.bind(this)),a.init(c,"selectedFeatureIndex,selectedFeature",
function(){var a=this.viewModel;this._updateSelectedFeature(a.selectedFeature);this._updateActions(a.actions,a.features,a.selectedFeature);this._updatePageText(a.features,a.selectedFeatureIndex);this._createPaginationNodes(a.features,a.selectedFeatureIndex);this._bodyContentNode.scrollTop=0}.bind(this)),a.init(c,"title",function(a){this._updateTitle(a);this.reposition()}.bind(this)),a.watch(this,"viewModel.waitingForResult, _popupRenderer.viewModel.waitingForContent",function(){this._repositionTimeoutHandle||
(this._repositionTimeoutHandle=setTimeout(function(){this._repositionTimeoutHandle=0;this._autoAlign();this.reposition()}.bind(this),50))}.bind(this)),a.init(c,"actions",function(a){var b=this.viewModel;this._updateActions(a,b.features,b.selectedFeature);this._actionChangeListener(a)}.bind(this)),a.init(c,"content",function(a){this._updateContent(a);this.reposition()}.bind(this)),a.init(c,"location",function(a){this._togglePopupLocationRepositioning(this.visible);this._autoAlign();this.reposition()}.bind(this)),
e(this._dockNode,k,this._toggleDock.bind(this)),e(this._closeNode,k,this.close.bind(this)),e(this._previousNode,k,c.previous.bind(c)),e(this._previousDockedNode,k,c.previous.bind(c)),e(this._nextNode,k,c.next.bind(c)),e(this._nextDockedNode,k,c.next.bind(c)),e(this._pageMenuNode,k,this._togglePageMenu.bind(this)),e(this._pageMenuDockedNode,k,this._togglePageMenu.bind(this)),e(this._pageMenuInfoNode,k,this._togglePageMenu.bind(this)),e(this._paginationNode,e.selector("li",k),function(){b._selectFeature(this)}),
e(this._paginationNode,e.selector("li","keyup"),function(a){b._keyupFeature(a,this)}),e(this._actionsNode,e.selector("[data-action-index]",k),function(){b._actionEvent(this)}),e(c,"trigger-action",function(a){a.action&&"zoom-to"===a.action.id&&this.viewModel.zoomToLocation()}.bind(this)));m.setUpEventDelegates(this,"trigger-action")},destroy:function(){this._destroyPopupRendererVMs();this._destroySpinner();this._destroyPopupRenderer();this._handleRegistry.destroy();this._handleRegistry=null;this._repositionTimeoutHandle&&
(clearTimeout(this._repositionTimeoutHandle),this._repositionTimeoutHandle=0);this._repositionTimeoutHandle=0},properties:{_popupRenderer:{readOnly:!0,value:null},actions:{aliasOf:"viewModel.actions"},alignment:{value:"top",set:function(a){this._set("alignment",a);this.reposition()}},autoPanEnabled:!0,autoAlignmentEnabled:!1,content:{aliasOf:"viewModel.content"},closeOnViewChangeEnabled:!1,currentDockPosition:{readOnly:!0,value:null},dockOptions:{value:I,set:function(a){var b=t.clone(I),c=this.viewModel.get("view.breakpoints"),
r={};c&&(r.width=c.xsmall,r.height=c.xsmall);a=t.mixin({},b,a);b=t.mixin({},b.breakpoint,r);!0===a.breakpoint?a.breakpoint=b:"object"===typeof a.breakpoint&&(a.breakpoint=t.mixin({},b,a.breakpoint));this._set("dockOptions",a);this._toggleDockButton(a)}},dockEnabled:{value:!1,set:function(a){this._set("dockEnabled",a);this._togglePopupDocking(a);this._togglePopupLocationRepositioning(this.visible);this._autoAlign();this.reposition()}},featureCount:{aliasOf:"viewModel.featureCount"},features:{aliasOf:"viewModel.features"},
highlightEnabled:{aliasOf:"viewModel.highlightEnabled"},location:{aliasOf:"viewModel.location"},paginationEnabled:{value:!0,set:function(a){var b=this.viewModel;this._set("paginationEnabled",a);this._updatePagination(b.features,b.selectedFeatureIndex);this._updateFooterVisibility(b.features,b.actions);this.reposition()}},promises:{aliasOf:"viewModel.promises"},selectedFeature:{aliasOf:"viewModel.selectedFeature"},selectedFeatureIndex:{aliasOf:"viewModel.selectedFeatureIndex"},spinnerEnabled:{value:!0,
set:function(a){this._set("spinnerEnabled",a);this._createSpinner(a,this.viewModel.view)}},title:{aliasOf:"viewModel.title"},view:{aliasOf:"viewModel.view"},viewModel:{type:d},visible:{aliasOf:"viewModel.visible"}},_css:G,_i18n:v,_hideActionsTextNum:3,_animationDelay:10,_pointerOffset:16,_popupRendererVMs:[],clear:m.createMethodDelegate("clear"),close:function(){this.set("visible",!1)},next:m.createMethodDelegate("next"),previous:m.createMethodDelegate("previous"),reposition:function(){this._positionPopup();
return this._moveIntoView()},open:function(a){var b=t.mixin({updateLocationEnabled:!1},a);this.viewModel.set(b);a&&a.promises?this.set("visible",!1):this.set("visible",!0)},triggerAction:m.createMethodDelegate("triggerAction"),_actionChangeListener:function(a){this._handleRegistry.remove(F.actionsChange);a&&this._handleRegistry.add([a.on("change",function(){var a=this.viewModel;this._updateActions(a.actions,a.features,a.selectedFeature)}.bind(this))],F.actionsChange)},_actionEvent:function(a){var b=
this.viewModel;if(a=x.get(a,"data-action-index"))a=parseInt(a,10),b.triggerAction(a)},_addContent:function(){var a=this.viewModel;this._updateSelectedFeature(a.selectedFeature);this._updateContent(a.content);this._updateTitle(a.title);this._updatePageText(a.features,a.selectedFeatureIndex)},_updateActions:function(a,b,c){this._updateActionButtons(a,c);this._updateFooterVisibility(b,a);this.reposition()},_contentIsPopupRenderer:function(){var a=this.get("viewModel.content"),b=this.get("_popupRenderer.domNode");
return!(!a||!b||a!==b)},_updateActionButtons:function(b,c){this._handleRegistry.remove(F.actions);if(this._actionsNode){var e=document.createDocumentFragment(),g=b.length;g&&b.forEach(function(b,d){"zoom-to"===b.id&&(b.title=this._i18n.zoom,b.className=G.iconZoom);var l=b.title,f=b.className,k=b.image;k||f||(k=H);var t=c&&c.attributes;t&&(l=l?n.substitute(t,l):"",f=f?n.substitute(t,f):null,k=k?n.substitute(t,k):null);var p=r.create("div",{tabindex:"0",title:l},e);x.set(p,"data-action-index",d);u.add(p,
[G.button,G.action]);var z=r.create("span",{"aria-hidden":!0},p);u.add(z,G.icon);f&&u.add(z,f);k&&(u.add(z,G.actionImage),B.set(z,"background-image","url("+k+")"));d={className:G.actionText,textContent:l};g>=this._hideActionsTextNum&&(d.className=G.iconText);var q=r.create("span",d,p);this._handleRegistry.add([a.init(b,"visible",function(a){u.toggle(p,G.hidden,!a)}),a.init(b,"className",function(a,b){t&&(a=n.substitute(t,a),b=n.substitute(t,b));u.remove(z,b);u.add(z,a)}),a.init(b,"image",function(a){t&&
(a=n.substitute(t,a));u.toggle(z,G.actionImage,!!a);B.set(z,"background-image",a?"url("+a+")":"")}),a.init(b,"title",function(a){t&&(a=n.substitute(t,a));a=a||"";x.set(p,"title",a);x.set(q,"textContent",a)})],F.actions)},this);r.place(e,this._actionsNode,"only")}},_getLocationScreenPoint:function(){var a=this.viewModel,b;if(a.location&&this.visible){var c=a.location;c&&a.get("view.ready")&&(b=a.view.toScreen(c))}return b},_calculatePosition:function(a,b,c){var r=this.alignment,e,g=this._pointerOffset,
n=null,d=null,l=null,f=null;if(a&&b&&c){e=b.h;if("top"===r||"bottom"===r)e+=g;b=b.w;if("left-top"===r||"left-bottom"===r||"right-top"===r||"right-bottom"===r)b+=g,e+=g;var k=b/2,t=a.y,p=a.x,z=c.height-t,q=c.width-p,B=b;switch(r){case "bottom":n=t+g;d=p-k;B=k;break;case "left-top":l=z+g;f=q+g;break;case "left-bottom":n=t+g;f=q+g;break;case "right-top":l=z+g;d=p+g;break;case "right-bottom":n=t+g;d=p+g;break;default:l=z+g,d=p-k,B=k}c=c.padding;c=this.dockEnabled?{left:c.left?c.left+"px":"",top:c.top?
c.top+"px":"",right:c.right?c.right+"px":"",bottom:c.bottom?c.bottom+"px":""}:{top:null!==n?n+"px":"auto",left:null!==d?d+"px":"auto",bottom:null!==l?l+"px":"auto",right:null!==f?f+"px":"auto"};return{height:e,width:b,box:{top:null!==n?n:a.y-e,left:null!==d?d:a.x-B,bottom:null!==l?l:a.y+e,right:null!==f?f:a.x+B},style:c}}},_createPopupRendererVMs:function(a){this._destroyPopupRendererVMs();a&&1<a.length&&a.forEach(function(a,b){a=new A({contentEnabled:!1,graphic:a});this._popupRendererVMs.push(a)},
this)},_destroyPopupRendererVMs:function(){this._handleRegistry.remove(F.paginationTitles);this._popupRendererVMs.forEach(function(a){a.destroy()});this._popupRendererVMs.length=0},_createPaginationNodes:function(b,c){this._handleRegistry.remove(F.paginationTitles);if(b){var e=b.length;this._paginationNode&&x.set(this._paginationNode,"innerHTML","");1<e&&(e=n.substitute({total:e},this._i18n.selectedFeatures),x.set(this._pageMenuInfoNode,"textContent",e),b.forEach(function(b,e){b=this._i18n.untitled;
var g=r.create("li",{role:"menuitem",className:G.featureMenuItem},this._paginationNode);e===c?(x.set(g,"aria-label",v.selectedFeature),u.add(g,G.featureMenuSelected)):x.set(g,"data-feature-index",e);var n=r.create("span",{className:G.featureMenuTitle,innerHTML:b},g);if(b=this._popupRendererVMs[e])b=a.init(b,"title",function(a){x.set(n,"innerHTML",a)}),this._handleRegistry.add(b,F.paginationTitles);e===c&&r.create("span",{className:G.iconCheckMark},n)},this))}},_createSpinner:function(a,b){this._destroySpinner();
a&&b&&(this._spinner=new D({container:document.createElement("div"),view:b}),r.place(this._spinner.container,b.root))},_updateContent:function(a){a&&a.nodeName?(r.place(a,this._contentStorage),r.place(a,this._bodyContentNode,"only")):"string"===typeof a&&(this._destroyPopupRenderer(),x.set(this._bodyContentNode,"innerHTML",a));this._bodyContentNode.scrollTop=0;u.toggle(this._containerNode,G.hasPopupRenderer,this._contentIsPopupRenderer());u.toggle(this._containerNode,G.showContent,!!a);u.remove(this._containerNode,
G.hasPaginationMenuOpen);this._autoAlign()},_destroyPopupRenderer:function(){this._popupRenderer&&!this._popupRenderer._destroyed&&(this._handleRegistry.remove(F.popupRenderer),this._popupRenderer.destroy(),this._set("_popupRenderer",null))},_destroySpinner:function(){this._spinner&&(this._spinner.destroy(),this._spinner=null)},_setDockEnabledForViewSize:function(a){a.breakpoint&&this.set("dockEnabled",this._shouldDockAtCurrentViewSize(a))},_togglePopupDocking:function(a){u.remove(this._containerNode,
G.hasPaginationMenuOpen);u.toggle(this._containerNode,G.isDocked,!!a);x.set(this._dockNode,"title",a?this._i18n.undock:this._i18n.dock);this._updateDockPosition(this.dockOptions)},_dockingThresholdCrossed:function(a,b,c){var r=a[0];a=a[1];var e=b[0];b=b[1];var g=c.width;c=c.height;return r<=g&&e>g||r>g&&e<=g||a<=c&&b>c||a>c&&b<=c},_determineDockPosition:function(a){var b=this.viewModel,c=b.view,r=c&&c.padding,r=c&&c.width-r.left-r.right;return(b=c&&b.get("view.breakpoints"))&&r<=b.xsmall?a.bottomCenter:
this.isLeftToRight()?a.topRight:a.topLeft},_updateDockPosition:function(a){u.remove(this._containerNode,[G.isDockedTopLeft,G.isDockedTopCenter,G.isDockedTopRight,G.isDockedBottomLeft,G.isDockedBottomCenter,G.isDockedBottomRight,G.canDockToTop,G.canDockToBottom,G.canDockToLeft,G.canDockToRight]);var b,c,r;b=a.position;b=b===J.auto?this._determineDockPosition(J):"function"===typeof b?b.call(this):b;switch(b){case J.topLeft:c=G.isDockedTopLeft;r=G.canDockToLeft;break;case J.topCenter:c=G.isDockedTopCenter;
r=G.canDockToTop;break;case J.bottomLeft:c=G.isDockedBottomLeft;r=G.canDockToLeft;break;case J.bottomCenter:c=G.isDockedBottomCenter;r=G.canDockToBottom;break;case J.bottomRight:c=G.isDockedBottomRight;r=G.canDockToRight;break;default:c=G.isDockedTopRight,r=G.canDockToRight}u.toggle(this._containerNode,r,!!a.buttonEnabled);this.dockEnabled?(u.add(this._containerNode,c),this._set("currentDockPosition",b)):this._set("currentDockPosition",null);this._popupRenderer&&this._popupRenderer.resize();this.reposition()},
_toggleDockButton:function(a){var b=this._containerNode;u.toggle(b,G.showDock,!!a.buttonEnabled);u.toggle(b,G.isDocked,!!this.dockEnabled);this._updateDockPosition(a)},_updateFooterVisibility:function(a,b){a=this._isPaginationEnabled(a)||b&&b.length;u.toggle(this._containerNode,G.showFooter,!!a)},_isPaginationEnabled:function(a){return this.paginationEnabled&&a&&1<a.length},_updatePagination:function(a,b){this._updatePageText(a,b);this._createPaginationNodes(a,b);u.toggle(this._containerNode,G.showPagination,
this._isPaginationEnabled(a))},_displayPendingFeaturesStatus:function(a,b,c,r){var e=0<a&&0===b;c=c&&c.length;a&&c&&a===c&&this.set("visible",!1);u.toggle(this._containerNode,G.hasPendingPromises,!!a);u.toggle(this._containerNode,G.isPendingPromisesResult,!!e);u.toggle(this._containerNode,G.hasPromiseFeatures,!!b);e?this._spinner&&this._spinner.show({location:r}):(this._spinner&&this._spinner.hide(),c&&b&&!this.visible?this.set("visible",!0):c&&!b&&this.visible&&this.set("visible",!1))},_moveIntoView:function(){var a=
new p;setTimeout(a.resolve.bind(this),this._animationDelay);return a.then(function(){if(!this._destroyed){var a=this.viewModel,c=this.get("viewModel.view");if(a&&c&&c.stationary){var r=this._getLocationScreenPoint();if(r){var e=this._sizePopup(),e=this._calculatePosition(r,e,c),g=c.width,n=c.height,d=c.padding,l=c.ui.padding;if(this.autoPanEnabled&&!this.autoAlignmentEnabled){if(r.y<d.top||r.y>n-d.bottom||r.x<d.left||r.x>g-d.right)return a.centerAtLocation();if(!this.dockEnabled&&e&&e.width<c.width&&
e.height<c.height){var f=r=0;e.box.top<d.top?f=-e.box.top+l.top+d.top:e.box.bottom>n-d.bottom&&(f=-(e.box.bottom-n+d.bottom)-l.bottom);e.box.left<d.left?r=e.box.left-l.left-d.left:e.box.right>g-d.right&&(r=e.box.right-g+d.right+l.right);if(r||f)return e=b.translateBy(b.create(),c.viewpoint,[r,f]),c.goTo(e,a.animationOptions)}}}}}}.bind(this))},_isScreenPointWithinView:function(a,b){return b&&a&&-1<a.x&&-1<a.y&&a.x<=b.width&&a.y<=b.height},_autoAlign:function(){if(this.autoAlignmentEnabled&&this.visible){var a=
this.get("viewModel.view"),b=this._getLocationScreenPoint();if(this._isScreenPointWithinView(b,a)){var c=this._sizePopup(),r=this._pointerOffset,e=c.h+r,c=(c.w+r)/2,g,n,d,l,r=a.padding;b.x-c<0+r.left&&(n=!0);b.x+c>a.width-r.right&&(g=!0);b.y-e<0+r.top&&(d=!0);b.y+e>a.height-r.bottom&&(l=!0);n?this._set("alignment",d?"right-bottom":"right-top"):g?this._set("alignment",d?"left-bottom":"left-top"):d?this._set("alignment",l?"top":"bottom"):this._set("alignment","top")}}},_positionPopup:function(){var a=
this.viewModel.view;if(a){u.remove(this._containerNode,[G.alignTop,G.alignBottom,G.alignLeftTop,G.alignLeftBottom,G.alignRightTop,G.alignRightBottom]);this._triggerOffset();var b;switch(this.alignment){case "bottom":b=G.alignBottom;break;case "right-top":b=G.alignRightTop;break;case "right-bottom":b=G.alignRightBottom;break;case "left-top":b=G.alignLeftTop;break;case "left-bottom":b=G.alignLeftBottom;break;default:b=G.alignTop}u.add(this._containerNode,b);b=this._getLocationScreenPoint();var c=this._sizePopup();
(a=(a=this._calculatePosition(b,c,a))&&a.style)&&B.set(this._containerNode,a)}},_removeContent:function(){this._destroyPopupRenderer();x.set(this._bodyContentNode,"innerHTML","");x.set(this._titleNode,"innerHTML","");x.set(this._pageTextNode,"innerHTML","");x.set(this._pageTextDockedNode,"innerHTML","");u.remove(this._containerNode,[G.showTitle,G.showContent])},_keyupFeature:function(a,b){var c=a.keyCode;if(c===g.UP_ARROW||c===g.DOWN_ARROW){a.stopPropagation();a.preventDefault();a=l("li",this._paginationNode);
var r=a.length;b=a.indexOf(b);var e;c===g.UP_ARROW?e=b-1:c===g.DOWN_ARROW&&(e=b+1);0>e?e=r-1:e>=r&&(e=0);a[e].focus()}},_selectFeature:function(a){var b=this.viewModel,c=-1;(a=x.get(a,"data-feature-index"))&&(c=parseInt(a,10));-1!==c&&(b.selectedFeatureIndex=c);u.remove(this._containerNode,G.hasPaginationMenuOpen);this._pageMenuNode.focus()},_updateSelectedFeature:function(b){var c=this.viewModel,g,n="",d="";if(b){if(g=b.layer)n=g.id||"",d=g.title||"";if(!this._popupRenderer||this._popupRenderer&&
this._popupRenderer._destroyed){this._handleRegistry.remove(F.popupRenderer);this._set("_popupRenderer",new C({container:r.create("div")}));g=a.init(this._popupRenderer.viewModel,"title",function(a){c.title=a});var l=a.init(this._popupRenderer.viewModel,"content",function(a){c.content=this._popupRenderer.domNode}.bind(this)),f=e(this._popupRenderer,"resize",this.reposition.bind(this));this._handleRegistry.add([g,l,f],F.popupRenderer)}this._popupRenderer.graphic=b}this._toggleFeatureUpdatedClass();
x.set(this._containerNode,"data-layer-title",d);x.set(this._containerNode,"data-layer-id",n);this.reposition()},_updateFeatures:function(a){var b=this.viewModel;this._createPopupRendererVMs(a);this._updatePagination(a,b.selectedFeatureIndex);this._updateFooterVisibility(a,b.actions);this.reposition()},_shouldDockAtCurrentViewSize:function(a){var b=this.viewModel;a=a.breakpoint;return b.view&&(a.hasOwnProperty("width")&&b.view.ui.width<=a.width||a.hasOwnProperty("height")&&b.view.ui.height<=a.height)},
_sizePopup:function(){return z.getContentBox(this._containerNode)},_updateTitle:function(a){a=a||"";x.set(this._titleNode,"innerHTML",a);u.toggle(this._containerNode,G.showTitle,!!a);u.remove(this._containerNode,G.hasPaginationMenuOpen)},_toggleDock:function(){this.set("dockEnabled",!this.dockEnabled)},_togglePageMenu:function(){u.toggle(this._containerNode,G.hasPaginationMenuOpen);var a=u.contains(this._containerNode,G.hasPaginationMenuOpen);x.set(this._pageMenuSectionNode,"aria-hidden",!a);var b=
l("li",this._paginationNode),c=b[0];b.forEach(function(b){x.set(b,"tabIndex",a?"0":"")});a?c&&c.focus():this._pageMenuNode.focus()},_updatePageText:function(a,b){var c="";this._isPaginationEnabled(a)&&(c=n.substitute({index:b+1,total:a.length},this._i18n.pageText));this._pageTextNode&&x.set(this._pageTextNode,{textContent:c});this._pageTextDockedNode&&x.set(this._pageTextDockedNode,{textContent:c})},_triggerOffset:function(){this._containerNode.offsetWidth=this._containerNode.offsetWidth},_toggleFeatureUpdatedClass:function(){u.remove(this._containerNode,
G.hasFeatureUpdated);this._triggerOffset();u.add(this._containerNode,G.hasFeatureUpdated)},_viewPointChanged:function(){this.closeOnViewChangeEnabled?this.close():this._positionPopup()},_wireUpView:function(b){this._handleRegistry.remove(F.view);this._viewPointEvent=null;if(b){var c="viewpoint";"3d"===b.type&&(c="camera");this._viewPointEvent=a.pausable(b,c,this._viewPointChanged.bind(this));this._handleRegistry.add([b.watch("padding",this.reposition.bind(this)),b.watch("size",this._updateDockEnabledForViewSize.bind(this)),
e(b,"resize",this.reposition.bind(this)),this._viewPointEvent],F.view);this._togglePopupLocationRepositioning(this.visible);this._createSpinner(this.spinnerEnabled,b);this._setDockEnabledForViewSize(this.dockOptions);this._toggleDockButton(this.dockOptions);this.reposition()}},_updateDockEnabledForViewSize:function(a,b){var c=this.get("viewModel.view.padding"),r=c.left+c.right,e=c.top+c.bottom,c=[],g=[];c[0]=a[0]-r;c[1]=a[1]-e;g[0]=b[0]-r;g[1]=b[1]-e;a=this.dockOptions;this._dockingThresholdCrossed(c,
g,a.breakpoint)&&this._setDockEnabledForViewSize(a);this._updateDockPosition(a)},_togglePopupLocationRepositioning:function(a){var b=this.viewModel;this._viewPointEvent&&(a&&b.location&&!this.dockEnabled?this._viewPointEvent.resume():this._viewPointEvent.pause())},_toggleContentVisibility:function(a){a?this._addContent():this._removeContent()}})})},"esri/widgets/support/viewModelWiring":function(){define(["../../core/watchUtils"],function(m){function h(d,c){Array.isArray(c)||(c=[c]);return c.map(function(a){return d.viewModel.on(a,
function(b){d.emit(a,b)})})}return{createGetterDelegate:function(d){var c="viewModel."+d;return function(){return this.get(c)}},createSetterDelegate:function(d){return function(c){var a=this.get("viewModel");a&&a.set(d,c)}},createMethodDelegate:function(d){var c="viewModel."+d;return function(){var a=this.get(c);if(a)return a.apply(this.viewModel,arguments)}},setUpEventDelegates:function(d,c){var a=h(d,c),b=m.init(d,"viewModel",function(b,f){a.forEach(function(a){a.remove()});a.length=0;b&&(a=h(d,
c));d.own.apply(d,a)});d.own(b)}}})},"esri/widgets/Widgette":function(){define("../core/Accessor ../core/declare ../core/accessorSupport/metadata dijit/_WidgetBase dijit/Destroyable dijit/registry dojo/_base/lang dojo/_base/window dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/on".split(" "),function(m,h,d,c,a,b,k,f,g,e,l,p,v){function q(a){return function(b){this._set(a,b)}}function n(a,b){return function(c){t.call(this,a,b,c);this._set(a,c)}}function t(a,b,c){(Array.isArray(b)?b:[b]).forEach(function(b){var r=
this[b.node||b||"domNode"];switch(b.type||"attribute"){case "attribute":k.isFunction(c)&&(c=c.bind(this));b=b.attribute?b.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;r.tagName?l.set(r,b,c):r.set(b,c);break;case "innerText":r.innerHTML="";r.appendChild(this.ownerDocument.createTextNode(c));break;case "innerHTML":r.innerHTML=c;break;case "class":b=this._get(a),p.replace(r,c,b)}},this)}function u(a,b,c){g.around(a,b,function(b){return function(){c(a)||b.apply(a)}})}h.before(function(a,b){if(b.declaredClass===
x||h.hasMixin(a,x)){var c=d.getPropertiesMetadata(b);Object.keys(c).forEach(function(a){var b=c[a];var r=b.set;a="function"===typeof r?r:null===r?q(b.name):"string"===typeof r||"object"===typeof r?n(a,r):void 0;b.set=a})}});var x="esri.widgets._WidgetBase";return m.createSubclass([a],{declaredClass:x,postscript:function(a){var c=this.__accessor__;a=c.ctorArgs||a;var r;(r=this.getDefaults?a?this.getDefaults(a):this.getDefaults({}):null)&&Object.getOwnPropertyNames(r).forEach(function(a){c.set(a,r[a])},
this);this.postMixInProperties();this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=f.body(this.ownerDocument);b.add(this);this.buildRendering();c.initialize();a&&(this.set(a),c.ctorArgs=null);c.initialize();this.initialize();this.postCreate();if(this.domNode){var e;(a=this.srcNodeRef)&&a.parentNode&&this.domNode!==a&&(a.parentNode.replaceChild(this.domNode,a),e=!0);l.set(this.domNode,{widgetId:this.id,id:this.id});e&&(this.srcNodeRef=
null)}this._created=!0;this.notifyChange("container");u(this,"startup",function(a){return a._started});u(this,"destroy",function(a){return a._beingDestroyed||a._destroyed});this.autoStart&&this.startup()},getDefaults:function(a){var c={};c.id=a.id?a.id:a.srcNodeRef&&a.srcNodeRef.id||b.getUniqueId(this.declaredClass.replace(/\./g,"_"));delete a.id;a.srcNodeRef&&(c.srcNodeRef=a.srcNodeRef,delete a.srcNodeRef);return k.mixin(this.inherited(arguments),c)},normalizeCtorArgs:function(a,b){a=a||{};if(b=
a.container||a.srcNodeRef||b)a.srcNodeRef=e.byId(b);return a},destroy:function(){this._customWidgetBaseDestroy()},postMixInProperties:c.prototype.postMixInProperties,buildRendering:c.prototype.buildRendering,postCreate:c.prototype.postCreate,startup:c.prototype.startup,_beingDestroyed:!1,_destroyed:!1,_created:!1,properties:{autoStart:!0,"class":{value:"",set:{node:"domNode",type:"class"}},domNode:{value:null},focused:!1,id:{value:""},srcNodeRef:{value:null},style:{value:null,set:c.prototype._setStyleAttr},
widgetId:{}},destroyDescendants:c.prototype.destroyDescendants,destroyRecursive:c.prototype.destroyRecursive,destroyRendering:c.prototype.destroyRendering,emit:c.prototype.emit,on:function(a,b){return this.own(v(this.domNode,a,b))[0]},toString:c.prototype.toString,getChildren:c.prototype.getChildren,getParent:c.prototype.getParent,isLeftToRight:c.prototype.isLeftToRight,placeAt:c.prototype.placeAt,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()},
dojoAttachEvent:"",dojoAttachPoint:"",_customWidgetBaseDestroy:function(a){function c(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.domNode&&b.findWidgets(this.domNode,this.containerNode).forEach(c);this.destroyRendering(a);b.remove(this.id);this._destroyed=!0}}).createSubclass({declaredClass:"esri.widgets.Widgette",getDefaults:function(){return k.mixin(this.inherited(arguments),{viewModel:{}})},buildRendering:function(){this.inherited(arguments);
p.add(this.domNode,"esri-widget")},destroy:function(){this.viewModel.destroy&&this.viewModel.destroy();this.viewModel=null},properties:{container:{get:function(){return this._created?this.domNode:this._get("container")},set:function(a){var b=this._get("container");this._created||b||!a||this._set("container",e.byId(a))}},viewModel:{value:null},visible:{value:!0,set:function(a){this._set("visible",a);p.toggle(this.domNode,"esri-hidden",!a)}}}})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../core/Accessor ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleRegistry ../../core/promiseUtils ../../core/watchUtils ../../geometry/support/webMercatorUtils ../../geometry/Point ../../support/Action dojo/fx/easing dojo/_base/lang".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p){function v(a,b){return b.allLayerViews.find(function(b){return b.layer===a})}var q={id:"zoom-to"};return m.createSubclass([c],{declaredClass:"esri.widgets.Popup.PopupViewModel",properties:{actions:{type:h.ofType(e)},animationOptions:{},content:{},featureCount:{readOnly:!0},features:{},location:{type:g},pendingPromisesCount:{readOnly:!0},promises:{},selectedFeature:{readOnly:!0},selectedFeatureIndex:{},state:{dependsOn:["view.ready"],readOnly:!0},title:{},updateLocationEnabled:{},
view:{},visible:{},waitingForResult:{dependsOn:["pendingPromisesCount","featureCount"],readOnly:!0},zoomFactor:{},zoomScale:{readOnly:!0}},_handles:null,constructor:function(){this._handles=new a},getDefaults:function(a){return p.mixin(this.inherited(arguments),{actions:[q],animationOptions:{duration:300,easing:l.quadInOut},promises:[]})},initialize:function(){this._handles.add([k.init(this,"view.scale",this._scaleWatcher),k.whenFalse(this,"visible",this._visibleWatcher)])},destroy:function(){this._handles.destroy();
this.view=this._handles=null},actions:[q],animationOptions:{duration:300,easing:l.quadInOut},content:null,featureCount:0,features:null,_featuresSetter:function(a){this._set("features",a);this._updateFeatureCount(a);this.pendingPromisesCount||(this.selectedFeatureIndex=-1,a.length&&(this.selectedFeatureIndex=0))},highlightEnabled:!0,_highlightEnabledSetter:function(a){this._set("highlightEnabled",a);this._highlightFeature(this.selectedFeature,this.view)},location:null,_locationSetter:function(a){var b=
this.get("view.spatialReference.isWebMercator");a&&a.get("spatialReference.isWGS84")&&b&&(a=f.geographicToWebMercator(a));this._set("location",a)},pendingPromisesCount:0,waitingForResult:!1,_waitingForResultGetter:function(){return 0<this.pendingPromisesCount&&0===this.featureCount},promises:[],_promisesSetter:function(a){var b=this._get("promises");b&&b.forEach(function(a){a.cancel()});this.features=[];this._set("pendingPromisesCount",0);this._set("promises",a);a&&a.length&&(this._set("pendingPromisesCount",
a.length),a=a.slice(0),a.forEach(function(a){a.always(function(b){a.isCanceled()||(this._set("pendingPromisesCount",this.pendingPromisesCount-1),this._updateFeatures(a,b))}.bind(this))},this))},selectedFeature:null,selectedFeatureIndex:-1,_selectedFeatureIndexSetter:function(a){if(isNaN(a)||-1>a)a=-1;var b=null,c=this.features;c&&c.length&&(a=(a+c.length)%c.length,b=c[a]);this._set("selectedFeature",b);this._set("selectedFeatureIndex",a);this._selectedFeatureChange(b,this.updateLocationEnabled)},
state:"disabled",_stateGetter:function(){return this.get("view.ready")?"ready":"disabled"},title:null,updateLocationEnabled:!1,_updateLocationEnabledSetter:function(a){this._selectedFeatureChange(this.selectedFeature,a);this._set("updateLocationEnabled",a)},view:null,visible:!1,zoomFactor:4,_zoomFactorSetter:function(a){var b=this.view;b&&null!=b.scale&&this._setZoomScale(b.scale,a);this._set("zoomFactor",a)},zoomScale:0,centerAtLocation:function(){return this.location&&this.view?this.view.goTo({target:this.location,
scale:this.view.scale},this.animationOptions):b.reject(new d(this.declaredClass+"::Cannot center at location without a location and view."))},clear:function(){this.set({promises:[],features:[],content:null,title:null,location:null})},triggerAction:function(a){(a=this.actions.getItemAt(a))&&this.emit("trigger-action",{action:a})},next:function(){this.selectedFeatureIndex+=1;return this},previous:function(){--this.selectedFeatureIndex;return this},zoomToLocation:function(){var a=this.view,c=this.location,
e=this.zoomScale;if(!c||!a)return b.reject(new d(this.declaredClass+"::Cannot zoom to location without a location and view."));var g=this.selectedFeature,r=g&&g.geometry,l=g&&"3d"===a.type;r||l?(c={target:g},r&&"point"===r.type&&this._isScreenSize(g)&&(c.scale=e,this.location=r)):c={target:c,scale:e};return a.goTo(c,this.animationOptions)},_isScreenSize:function(a){if("3d"!==this.view.type||"esri.Graphic"!==a.declaredClass)return!0;var b=!0,c=this.view.getViewForGraphic(a);c&&c.whenGraphicBounds&&
c.whenGraphicBounds(a).then(function(a){b=!a||a[0]===a[3]&&a[1]===a[4]&&a[2]===a[5]});return b},_getSelectedFeatureActions:function(){this._originalActions&&(this.actions=this._originalActions,this._originalActions=null);var a=this.actions.filter(function(a){return!a.temporary},this),b=a,c=this.selectedFeature.getEffectivePopupTemplate();if(c&&c.actions){for(var b=c.actions,e=0;e<b.length;e++)b.getItemAt(e).temporary=!0;c.overwriteActions?this._originalActions=a:b=a.concat(b)}this.actions=b},_scaleWatcher:function(a){null!=
a&&this._setZoomScale(a,this.zoomFactor)},_getPointFromGeometry:function(a){switch(a&&a.type){case "point":return a;case "extent":return a.center;case "polygon":return a.centroid;case "multipoint":case "polyline":return a.extent.center;default:return null}},_visibleWatcher:function(a){this._handles.remove("highlight")},_highlightFeature:function(a,b){this._handles.remove("highlight");if(a&&b&&this.highlightEnabled){var c=a.layer,e=b.type;c&&"3d"===e&&(b=v(c,b))&&"function"===typeof b.highlight&&(c=
c.objectIdField,e=a.attributes,a=b.highlight(e&&e[c]||a),this._handles.add(a,"highlight"))}},_selectedFeatureChange:function(a,b){this._highlightFeature(a,this.view);a&&(b&&(this.location=this._getPointFromGeometry(this.selectedFeature.geometry)),this._getSelectedFeatureActions())},_updateFeatureCount:function(a){var b=0;a&&a.length&&(b=a.length);this._set("featureCount",b)},_setZoomScale:function(a,b){this._set("zoomScale",a/b)},_updateFeatures:function(a,b){a&&this.promises&&!(!this._validatePromise(a)||
b instanceof d||b instanceof Error)&&b&&b.length&&(a={},this.features&&this.features.length?(b=b.filter(function(a){return-1===this.features.indexOf(a)},this),a.features=this.features.concat(b)):(a.features=b,a.selectedFeatureIndex=0),this.set(a))},_validatePromise:function(a){return-1<this.promises.indexOf(a)}})})},"dojo/fx/easing":function(){define(["../_base/lang"],function(m){var h={linear:function(d){return d},quadIn:function(d){return Math.pow(d,2)},quadOut:function(d){return d*(d-2)*-1},quadInOut:function(d){d*=
2;return 1>d?Math.pow(d,2)/2:-1*(--d*(d-2)-1)/2},cubicIn:function(d){return Math.pow(d,3)},cubicOut:function(d){return Math.pow(d-1,3)+1},cubicInOut:function(d){d*=2;return 1>d?Math.pow(d,3)/2:(Math.pow(d-2,3)+2)/2},quartIn:function(d){return Math.pow(d,4)},quartOut:function(d){return-1*(Math.pow(d-1,4)-1)},quartInOut:function(d){d*=2;return 1>d?Math.pow(d,4)/2:-.5*(Math.pow(d-2,4)-2)},quintIn:function(d){return Math.pow(d,5)},quintOut:function(d){return Math.pow(d-1,5)+1},quintInOut:function(d){d*=
2;return 1>d?Math.pow(d,5)/2:(Math.pow(d-2,5)+2)/2},sineIn:function(d){return-1*Math.cos(Math.PI/2*d)+1},sineOut:function(d){return Math.sin(Math.PI/2*d)},sineInOut:function(d){return-1*(Math.cos(Math.PI*d)-1)/2},expoIn:function(d){return 0==d?0:Math.pow(2,10*(d-1))},expoOut:function(d){return 1==d?1:-1*Math.pow(2,-10*d)+1},expoInOut:function(d){if(0==d)return 0;if(1==d)return 1;d*=2;if(1>d)return Math.pow(2,10*(d-1))/2;--d;return(-1*Math.pow(2,-10*d)+2)/2},circIn:function(d){return-1*(Math.sqrt(1-
Math.pow(d,2))-1)},circOut:function(d){return Math.sqrt(1-Math.pow(d-1,2))},circInOut:function(d){d*=2;return 1>d?-.5*(Math.sqrt(1-Math.pow(d,2))-1):.5*(Math.sqrt(1-Math.pow(d-2,2))+1)},backIn:function(d){return Math.pow(d,2)*(2.70158*d-1.70158)},backOut:function(d){--d;return Math.pow(d,2)*(2.70158*d+1.70158)+1},backInOut:function(d){d*=2;if(1>d)return Math.pow(d,2)*(3.5949095*d-2.5949095)/2;d-=2;return(Math.pow(d,2)*(3.5949095*d+2.5949095)+2)/2},elasticIn:function(d){if(0==d||1==d)return d;--d;
return-1*Math.pow(2,10*d)*Math.sin(2*(d-.075)*Math.PI/.3)},elasticOut:function(d){return 0==d||1==d?d:Math.pow(2,-10*d)*Math.sin(2*(d-.075)*Math.PI/.3)+1},elasticInOut:function(d){if(0==d)return 0;d*=2;if(2==d)return 1;var c=.3*1.5,a=c/4;if(1>d)return--d,-.5*Math.pow(2,10*d)*Math.sin(2*(d-a)*Math.PI/c);--d;return.5*Math.pow(2,-10*d)*Math.sin(2*(d-a)*Math.PI/c)+1},bounceIn:function(d){return 1-h.bounceOut(1-d)},bounceOut:function(d){return d<1/2.75?7.5625*Math.pow(d,2):d<2/2.75?7.5625*Math.pow(d-1.5/
2.75,2)+.75:d<2.5/2.75?7.5625*Math.pow(d-2.25/2.75,2)+.9375:7.5625*Math.pow(d-2.625/2.75,2)+.984375},bounceInOut:function(d){return.5>d?h.bounceIn(2*d)/2:h.bounceOut(2*d-1)/2+.5}};m.setObject("dojo.fx.easing",h);return h})},"esri/views/2d/viewpointUtils":function(){define("require exports ./libs/gl-matrix/common ./libs/gl-matrix/mat2d ./libs/gl-matrix/vec2 ../../Viewpoint ../../core/promiseUtils ../../core/Error ../../geometry/SpatialReference ../../geometry/Geometry ../../geometry/Point ../../geometry/Extent ../../geometry/support/webMercatorUtils ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t){function u(b,c,r,e){return e&&r&&!e.equals(r)&&v.canProject(e,r)&&e.isWebMercator?(e.isWebMercator?(r=c[1],89.99999<r?r=89.99999:-89.99999>r&&(r=-89.99999),r=Math.sin(d.toRadian(r)),b=a.set(b,6378137*d.toRadian(c[0]),3189068.5*Math.log((1+r)/(1-r)))):(r=d.toDegree(c[0]/6378137),b=a.set(b,r-360*Math.floor((r+180)/360),d.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*c[1]/6378137))))),b):a.copy(b,c)}function x(a){return a.wkid?a:a.spatialReference||g.WGS84}function r(b,
c){return c.type?a.set(b,c.x,c.y):a.copy(b,c)}function z(a,b){return Math.max(a.width/b[0],a.height/b[1])*J(a.spatialReference)}function B(a,b,c){var r;if(!a)return null;if(Array.isArray(a)&&2===a.length&&"number"===typeof a[0]&&"number"===typeof a[1])return new l(a);if(a.reduce)return a.reduce(function(a,c){return B(c,b,a)},c);a instanceof e?r=a:a.geometry&&(r=a.geometry);if(!r)return null;a="point"===r.type?new p({xmin:r.x,ymin:r.y,xmax:r.x,ymax:r.y,spatialReference:r.spatialReference}):r.extent;
if(!a)return null;r=v.canProject(a,b);if(!a.spatialReference.equals(b)&&r)a=v.project(a,b);else if(!r)return null;return c=c?c.union(a):a.clone()}function C(c,g){if(!c)return new b({targetGeometry:new l,scale:0,rotation:0});var d=g.spatialReference,n=g.size,f=g.viewpoint,k=g.constraints,p=null;"esri.Viewpoint"===c.declaredClass?p=c:c.viewpoint?p=c.viewpoint:c.target&&"esri.Viewpoint"===c.target.declaredClass&&(p=c.target);var q=null;if(p&&p.targetGeometry)q=p.targetGeometry;else if(c instanceof e)q=
c;else if(c||c&&(c.hasOwnProperty("center")||c.hasOwnProperty("extent")||c.hasOwnProperty("target")))q=B(c.center,d)||B(c.extent,d)||B(c.target,d)||B(c,d);!q&&f&&f.targetGeometry?q=f.targetGeometry:!q&&g.extent&&(q=g.extent);var v=x(q);d||(d=x(g.spatialReference||g.extent||q));if(!t.canProject(q,d)&&v&&!v.equals(d))return null;var C=r(a.create(),q.center?q.center:q),d=new l(u(C,C,v,d),d),v=null,v=p&&p.targetGeometry&&"point"===p.targetGeometry.type?p.scale:c.hasOwnProperty("scale")&&c.scale?c.scale:
c.hasOwnProperty("zoom")&&-1!==c.zoom&&k&&k.effectiveLODs?k.zoomToScale(c.zoom):Array.isArray(q)||"point"===q.type||"extent"===q.type&&0===q.width&&0===q.height?g.extent?z(g.extent,n):f.scale:z(q.extent,n);g=0;p?g=p.rotation:c.hasOwnProperty("rotation")?g=c.rotation:f&&(g=f.rotation);k&&(k.rotationEnabled||(g=0),k.snapToZoom&&(v=k.snapScale(v)),0!==k.effectiveMinScale&&(v=Math.min(k.effectiveMinScale,v)),0!==k.effectiveMaxScale&&(v=Math.max(k.effectiveMaxScale,v)));return new b({targetGeometry:d,
scale:v,rotation:g})}function A(a,b){var c=a.targetGeometry,r=b.targetGeometry;c.x=r.x;c.y=r.y;c.spatialReference=r.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function D(b,c,r){return r?a.set(b,.5*(c[0]-r.right+r.left),.5*(c[1]-r.bottom+r.top)):a.scale(b,c,.5)}function E(a,b,r,e){h.getTransform(a,b,r,e);return c.invert(a,a)}function H(b,c,r){var e=d.toRadian(c.rotation)||0;c=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return a.set(b,Math.round(r[1]*e+r[0]*c),Math.round(r[1]*
c+r[0]*e))}function G(a){return a.scale*(1/(39.37*(q.getUnitValueForSR(a.targetGeometry.spatialReference)||N)*96))}function J(a){return 39.37*(q.getUnitValueForSR(a)||N)*96}function I(a){return a.isWrappable?(a=n.getInfo(a),a.valid[1]-a.valid[0]):0}function F(a,b){return Math.round(I(a)/b)}Object.defineProperty(h,"__esModule",{value:!0});var N=6370997*Math.PI/180,L=180/Math.PI;h.create=C;h.copy=A;h.getAnchor=D;h.getExtent=function(){var b=a.create();return function(a,c,e){var g=c.targetGeometry;r(b,
g);c=.5*G(c);a.xmin=b[0]-c*e[0];a.ymin=b[1]-c*e[1];a.xmax=b[0]+c*e[0];a.ymax=b[1]+c*e[1];a.spatialReference=g.spatialReference;return a}}();h.setExtent=function(a,b,c,r,e){h.centerAt(a,b,c.center);a.scale=z(c,r);e&&e.constraints&&e.constraints.constrain(a);return a};h.getOuterExtent=function(){var b=a.create(),c=a.create();return function(a,e,g){r(b,e.targetGeometry);H(c,e,g);g=.5*G(e);a.set({xmin:b[0]-g*c[0],ymin:b[1]-g*c[1],xmax:b[0]+g*c[0],ymax:b[1]+g*c[1],spatialReference:e.targetGeometry.spatialReference});
return a}}();h.getClippedExtent=function(){var b=a.create(),c=a.create();return function(a,e,g){var d=G(e),l=e.targetGeometry.spatialReference,n=F(l,d);r(b,e.targetGeometry);H(c,e,g);l.isWrappable&&c[0]>n&&(c[0]=n);e=.5*d;a.set({xmin:b[0]-e*c[0],ymin:b[1]-e*c[1],xmax:b[0]+e*c[0],ymax:b[1]+e*c[1],spatialReference:l});return a}}();h.getOuterSize=H;h.getPaddingScreenTranslation=function(){var b=a.create();return function(c,r,e){return a.sub(c,a.scale(c,r,.5),D(b,r,e))}}();var M=function(){var b=c.create(),
r=a.create();return function(e,g,l,n){var f=G(g);g=d.toRadian(g.rotation)||0;a.set(r,f,f);c.fromScaling(b,r);c.rotate(b,b,g);c.translate(b,b,h.getPaddingScreenTranslation(r,l,n));c.translate(b,b,[0,n.top-n.bottom]);return a.set(e,b[4],b[5])}}();h.getResolution=G;h.getResolutionToScaleFactor=J;h.getMatrix=function(){var b=a.create(),r=a.create(),e=a.create();return function(g,d,l,n,f,k){a.negate(b,d);a.scale(r,l,.5*k);a.set(e,1/n*k,-1/n*k);c.identity(g);c.translate(g,g,r);f&&c.rotate(g,g,f);c.scale(g,
g,e);c.translate(g,g,b);return g}}();h.getTransform=function(){var b=a.create();return function(a,c,e,g){var l=G(c),n=d.toRadian(c.rotation)||0;r(b,c.targetGeometry);return h.getMatrix(a,b,e,l,n,g)}}();h.getTransformNoRotation=function(){var b=a.create();return function(a,c,e,g){var d=G(c);r(b,c.targetGeometry);return h.getMatrix(a,b,e,d,0,g)}}();h.getWorldWidth=I;h.getWorldScreenWidth=F;h.createAsync=function(a,b){if(a=C(a,b))return k.resolve(a);a=new f("viewpointUtils-createAsync:different-spatialReference",
"Target spatialReference cannot be projected and is different from out spatialReference");return k.reject(a)};h.angleBetween=function(){var b=a.create(),c=a.create(),r=a.create();return function(e,g,d){a.subtract(b,e,g);a.normalize(b,b);a.subtract(c,e,d);a.normalize(c,c);a.cross(r,b,c);e=Math.acos(a.dot(b,c)/(a.length(b)*a.length(c)))*L;0>r[2]&&(e=-e);isNaN(e)&&(e=0);return e}}();h.addPadding=function(){var b=a.create();return function(a,c,r,e){var g=a.targetGeometry;A(a,c);M(b,c,r,e);g.x+=b[0];g.y+=
b[1];return a}}();h.removePadding=function(){var b=a.create();return function(a,c,r,e){var g=a.targetGeometry;A(a,c);M(b,c,r,e);g.x-=b[0];g.y-=b[1];return a}}();h.centerAt=function(){var b=a.create();return function(a,c,e){A(a,c);c=a.targetGeometry;var g=x(e),d=x(c);r(b,e);u(b,b,g,d);c.x=b[0];c.y=b[1];return a}}();h.pixelSizeAt=function(a,b,c){return G(b)};h.resize=function(){var b=a.create();return function(c,r,e,g,d){d||(d="center");a.sub(b,e,g);a.scale(b,b,.5);e=b[0];g=b[1];switch(d){case "center":a.set(b,
0,0);break;case "left":a.set(b,-e,0);break;case "top":a.set(b,0,g);break;case "right":a.set(b,e,0);break;case "bottom":a.set(b,0,-g);break;case "top-left":a.set(b,-e,g);break;case "bottom-left":a.set(b,-e,-g);break;case "top-right":a.set(b,e,g);break;case "bottom-right":a.set(b,e,-g)}h.translateBy(c,r,b);return c}}();h.rotateBy=function(a,b,c){A(a,b);a.rotation+=c;return a};h.rotateTo=function(a,b,c){A(a,b);a.rotation=c;return a};h.scaleBy=function(){var b=a.create();return function(c,r,e,g,d){A(c,
r);0!==e&&(h.toMap(b,g,r,d),c.scale=r.scale*e,h.toScreen(b,b,c,d),h.translateBy(c,c,a.set(b,b[0]-g[0],g[1]-b[1])));return c}}();h.scaleTo=function(a,b,c){A(a,b);a.scale=c;return a};h.scaleAndRotateBy=function(){var b=a.create();return function(c,r,e,g,d,l){A(c,r);0!==e&&(h.toMap(b,d,r,l),c.scale=r.scale*e,c.rotation+=g,h.toScreen(b,b,c,l),h.translateBy(c,c,a.set(b,b[0]-d[0],d[1]-b[1])));return c}}();h.padAndScaleAndRotateBy=function(){var b=a.create(),c=a.create();return function(r,e,g,d,l,n,f){h.getPaddingScreenTranslation(c,
n,f);a.add(b,l,c);return d?h.scaleAndRotateBy(r,e,g,d,b,n):h.scaleBy(r,e,g,b,n)}}();h.toMap=function(){var b=c.create();return function(c,r,e,g){return a.transformMat2d(c,r,E(b,e,g,1))}}();h.toScreen=function(){var b=c.create();return function(c,r,e,g){return a.transformMat2d(c,r,h.getTransform(b,e,g,1))}}();h.translateBy=function(){var b=a.create(),r=c.create();return function(e,g,l){A(e,g);var n=G(g),f=e.targetGeometry;c.fromRotation(r,d.toRadian(g.rotation)||0);c.scale(r,r,a.fromValues(n,n));a.transformMat2d(b,
l,r);f.x+=b[0];f.y+=b[1];return e}}()})},"esri/views/2d/libs/gl-matrix/common":function(){define([],function(){if(!m)var m=1E-6;if(!h)var h="undefined"!==typeof Float32Array?Float32Array:Array;if(!d)var d=Math.random;var c={GLMAT_EPSILON:m,GLMAT_ARRAY_TYPE:h,GLMAT_RANDOM:d,setMatrixArrayType:function(a){c.GLMAT_ARRAY_TYPE=a}},a=Math.PI/180,b=180/Math.PI;c.toRadian=function(b){return b*a};c.toDegree=function(a){return a*b};c.setMatrixArrayType(Array);return c})},"esri/views/2d/libs/gl-matrix/mat2d":function(){define(["./common"],
function(m){var h=m.GLMAT_ARRAY_TYPE;m={create:function(){var d=new h(6);d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=0;d[5]=0;return d},clone:function(d){var c=new h(6);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];return c},copy:function(d,c){d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];return d},identity:function(d){d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=0;d[5]=0;return d},invert:function(d,c){var a=c[0],b=c[1],k=c[2],f=c[3],g=c[4];c=c[5];var e=a*f-b*k;if(!e)return null;e=1/e;d[0]=f*
e;d[1]=-b*e;d[2]=-k*e;d[3]=a*e;d[4]=(k*c-f*g)*e;d[5]=(b*g-a*c)*e;return d},determinant:function(d){return d[0]*d[3]-d[1]*d[2]},multiply:function(d,c,a){var b=c[0],k=c[1],f=c[2],g=c[3],e=c[4];c=c[5];var l=a[0],p=a[1],v=a[2],q=a[3],n=a[4];a=a[5];d[0]=b*l+f*p;d[1]=k*l+g*p;d[2]=b*v+f*q;d[3]=k*v+g*q;d[4]=b*n+f*a+e;d[5]=k*n+g*a+c;return d}};m.mul=m.multiply;m.rotate=function(d,c,a){var b=c[0],k=c[1],f=c[2],g=c[3],e=c[4];c=c[5];var l=Math.sin(a);a=Math.cos(a);d[0]=b*a+f*l;d[1]=k*a+g*l;d[2]=b*-l+f*a;d[3]=
k*-l+g*a;d[4]=e;d[5]=c;return d};m.scale=function(d,c,a){var b=c[1],k=c[2],f=c[3],g=c[4],e=c[5],l=a[0];a=a[1];d[0]=c[0]*l;d[1]=b*l;d[2]=k*a;d[3]=f*a;d[4]=g;d[5]=e;return d};m.translate=function(d,c,a){var b=c[0],k=c[1],f=c[2],g=c[3],e=c[4];c=c[5];var l=a[0];a=a[1];d[0]=b;d[1]=k;d[2]=f;d[3]=g;d[4]=b*l+f*a+e;d[5]=k*l+g*a+c;return d};m.fromRotation=function(d,c){var a=Math.sin(c);c=Math.cos(c);d[0]=c;d[1]=a;d[2]=-a;d[3]=c;d[4]=0;d[5]=0;return d};m.fromScaling=function(d,c){d[0]=c[0];d[1]=0;d[2]=0;d[3]=
c[1];d[4]=0;d[5]=0;return d};m.fromTranslation=function(d,c){d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=c[0];d[5]=c[1];return d};m.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"};m.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+1)};return m})},"esri/views/2d/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var h=m.GLMAT_ARRAY_TYPE,d=m.GLMAT_RANDOM,c={create:function(){var a=
new h(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new h(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new h(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};c.sub=c.subtract;c.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};c.mul=c.multiply;c.divide=function(a,b,
c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};c.div=c.divide;c.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};c.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};c.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};c.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};c.distance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)};c.dist=c.distance;c.squaredDistance=function(a,b){var c=b[0]-a[0];
a=b[1]-a[1];return c*c+a*a};c.sqrDist=c.squaredDistance;c.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};c.len=c.length;c.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};c.sqrLen=c.squaredLength;c.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};c.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};c.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};c.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};c.cross=
function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};c.lerp=function(a,b,c,d){var g=b[0];b=b[1];a[0]=g+d*(c[0]-g);a[1]=b+d*(c[1]-b);return a};c.random=function(a,b){b=b||1;var c=2*d()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};c.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};c.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};c.transformMat3=function(a,b,c){var d=b[0];
b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};c.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};c.forEach=function(){var a=c.create();return function(b,c,d,g,e,l){c||(c=2);d||(d=0);for(g=g?Math.min(g*c+d,b.length):b.length;d<g;d+=c)a[0]=b[d],a[1]=b[d+1],e(a,a,l),b[d]=a[0],b[d+1]=a[1];return b}}();c.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};return c})},"esri/widgets/Popup/PopupRenderer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../support/widget ../Widget ./PopupRendererViewModel ../../core/requireUtils dojo/i18n!./nls/PopupRenderer".split(" "),
function(m,h,d,c,a,b,k,f,g,e){function l(a,b){return void 0===b?"esri-popup-renderer__"+a:"esri-popup-renderer__"+a+"-"+b}var p=/^\s*(https?:\/\/[^\s]+)\s*$/i;h=function(a){function c(b){b=a.call(this)||this;b._chartMap=new Map;b._activeMediaMap=new Map;b._chartRequirePromise=null;b._chartResizeTimer=null;b.graphic=null;b.title=null;b.viewModel=new f;return b}d(c,a);c.prototype.destroy=function(){clearTimeout(this._chartResizeTimer);this._chartResizeTimer=null;this._activeMediaMap.clear();this._activeMediaMap=
null;this._cancelChartModules();this._destroyCharts()};c.prototype.resize=function(){this._resizeCharts();this.emit("resize")};c.prototype.render=function(){var a=b.tsx("div",{key:l("loading-container"),class:"esri-popup-renderer__loading-container"},b.tsx("span",{class:b.join("esri-icon-loading-indicator esri-rotating","esri-popup-renderer__loading-spinner")})),a=this.viewModel.waitingForContent?a:this._renderContent();return b.tsx("div",{class:"esri-popup-renderer"},b.tsx("div",{class:"esri-popup-renderer__size-container"},
b.tsx("div",{class:"esri-popup-renderer__main-container"},a)))};c.prototype.goToMedia=function(a,b){this._activeMediaMap.set(a,b);this.scheduleRender()};c.prototype.nextMedia=function(a){this._pageContentElementMedia(a,"next")};c.prototype.previousMedia=function(a){this._pageContentElementMedia(a,"previous")};c.prototype._cancelChartModules=function(){this._chartRequirePromise&&this._chartRequirePromise.cancel()};c.prototype._destroyChart=function(a){var b=this._chartMap.get(a);b&&(b.chart.destroy(),
b.tooltip.destroy());this._chartMap.delete(a)};c.prototype._destroyCharts=function(){this._chartMap.forEach(function(a){a.chart.destroy();a.tooltip.destroy()});this._chartMap.clear()};c.prototype._resizeCharts=function(){this._chartMap.forEach(function(a){a=a.chart;var b=a.node;b&&b.offsetWidth&&b.offsetHeight&&a.resize()})};c.prototype._renderContent=function(){this._destroyCharts();var a=this.viewModel.content;if("string"===typeof a){var c=document.createElement("div");c.innerHTML=a;return b.tsx("div",
{key:l("content"),bind:c,afterCreate:this._attachToNode})}if(a&&a.isInstanceOf&&a.isInstanceOf(k))return b.tsx("div",{key:l("content")},a.render());if(a instanceof HTMLElement)return b.tsx("div",{key:l("content"),bind:a,afterCreate:this._attachToNode});if(a&&"function"===typeof a.postMixInProperties&&"function"===typeof a.buildRendering&&"function"===typeof a.postCreate&&"function"===typeof a.startup)return b.tsx("div",{key:l("content"),bind:a.domNode,afterCreate:this._attachToNode});if(Array.isArray(a))return a.length?
b.tsx("div",{key:l("content")},a.map(this._renderContentElement,this)):null};c.prototype._renderContentElement=function(a,b){var c=this.viewModel.contentTypes;switch(a.type){case c.attachments:return this._renderAttachments(a,b);case c.fields:return this._renderFields(a,b);case c.media:return this._renderMedia(a,b);case c.text:return this._renderText(a,b);default:return null}};c.prototype._renderAttachmentInfo=function(a,c){return b.tsx("li",{class:"esri-popup-renderer__attachments-item",key:l("attachment",
c)},b.tsx("a",{class:"esri-popup-renderer__attachments-item-link",href:a.url,target:"_blank"},b.tsx("span",{class:b.join("esri-icon-download","esri-popup-renderer__attachments-item-icon")}),b.tsx("span",{class:"esri-popup-renderer__attachments-item-title"},a.name||e.noTitle)))};c.prototype._renderAttachments=function(a,c){return(a=a.attachmentInfos)&&a.length?b.tsx("div",{key:l("attachments-element"),class:b.join("esri-popup-renderer__attachments","esri-popup-renderer__content-element")},b.tsx("div",
{class:"esri-popup-renderer__attachments-title"},e.attach),b.tsx("ul",{class:"esri-popup-renderer__attachments-items"},a.map(this._renderAttachmentInfo))):null};c.prototype._renderFieldInfo=function(a,c){var g=this.viewModel,d=g.formattedAttributes.content[c]||g.formattedAttributes.global,r=a.fieldName,g=a.label||r,d=null==d[r]?"":d[r];a=!(!a.format||!a.format.dateFormat);r='\x3ca target\x3d"_blank" href\x3d"$1" title\x3d"'+g+'"\x3e'+e.view+"\x3c/a\x3e";d=d&&"string"===typeof d?d.replace(p,r):d;a=
(n={},n["esri-popup-renderer__field-data--date"]=a,n);return b.tsx("tr",{key:l("fields-element-info-row",c)},b.tsx("th",{key:l("fields-element-info-row-header",c),class:"esri-popup-renderer__field-header"},g),b.tsx("td",{key:l("fields-element-info-row-data",c),class:"esri-popup-renderer__field-data",classes:a,innerHTML:d}));var n};c.prototype._renderFields=function(a,c){var g=this;return(a=a.fieldInfos)?b.tsx("div",{key:l("fields-element",c),class:b.join("esri-popup-renderer__fields","esri-popup-renderer__content-element")},
b.tsx("table",{summary:e.fieldsSummary,key:l("fields-element-table",c)},b.tsx("tbody",{key:l("fields-element-table-body",c)},a.map(function(a){return g._renderFieldInfo(a,c)})))):null};c.prototype._shouldOpenInNewTab=function(a){void 0===a&&(a="");return!/^(?:mailto:|tel:)/.test(a.trim().toLowerCase())};c.prototype._renderMediaInfoType=function(a,c){var e=a.value,g=a.title,g=void 0===g?"":g,r=a.type,d=e.sourceURL,e=e.linkURL,n=this._shouldOpenInNewTab(e)?"_self":"_blank";if("image"===r)return a=b.tsx("img",
{alt:g,src:d}),(c=e?b.tsx("a",{title:g,href:e,target:n},a):null)?c:a;if(-1!==r.indexOf("chart"))return b.tsx("div",{key:l("chart",c),bind:this,"data-media-info":a,"data-content-element-index":c,class:"esri-popup-renderer__media-chart",afterCreate:this._getChartDependencies,afterUpdate:this._getChartDependencies})};c.prototype._getChartDependencies=function(a){var b=this,c=a["data-media-info"],e=a["data-content-element-index"],r=c.value,d=r.theme||"Claro",l=c.type,c=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],
n=d;"string"===typeof d&&(n=d.replace(/\./g,"/"),-1===n.indexOf("/")&&(n="dojox/charting/themes/"+n));c.push(n);this._cancelChartModules();this._chartRequirePromise=g.when(m,c).then(function(c){b._renderChart(a,e,l,r,c[0],c[1],c[2]);clearTimeout(b._chartResizeTimer);b._chartResizeTimer=setTimeout(function(){return b.resize()},0);b._chartRequirePromise=null})};c.prototype._renderChart=function(a,b,c,e,r,g,d){a=new r(a,{margins:{l:4,t:4,r:4,b:4}});d&&a.setTheme(d);switch(c){case "pie-chart":a.addPlot("default",
{type:"Pie",labels:!1});a.addSeries("Series A",e.fields);break;case "line-chart":a.addPlot("default",{type:"Markers"});a.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.fields.forEach(function(a,b){a.x=b+1});a.addSeries("Series A",e.fields);break;case "column-chart":a.addPlot("default",{type:"Columns",gap:3});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});a.addSeries("Series A",e.fields);break;
case "bar-chart":a.addPlot("default",{type:"Bars",gap:3}),a.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),a.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),a.addSeries("Series A",e.fields)}c=new g(a);a.render();this._chartMap.set(b,{chart:a,tooltip:c})};c.prototype._renderMediaInfo=function(a,c){this._destroyChart(c);var e=this._renderMediaInfoType(a,c),g=a.title?b.tsx("div",{key:l("media-title",c),class:"esri-popup-renderer__media-item-title",
innerHTML:a.title}):null;a=a.caption?b.tsx("div",{key:l("media-caption",c),class:"esri-popup-renderer__media-item-caption",innerHTML:a.caption}):null;return b.tsx("div",{key:l("media-container",c),class:"esri-popup-renderer__media-item-container",bind:this,afterCreate:this.resize,afterUpdate:this.resize},b.tsx("div",{key:l("media-itme-container",c),class:"esri-popup-renderer__media-item"},e),g,a)};c.prototype._renderMediaStatsItem=function(a,c,e){e="chart"===e?b.join("esri-popup-renderer__media-chart-icon",
"esri-icon-chart"):b.join("esri-popup-renderer__media-image-icon","esri-icon-media");return b.tsx("li",{class:"esri-popup-renderer__media-image-summary"},b.tsx("span",{class:"esri-popup-renderer__media-count","aria-label":a},"("+c+")"),b.tsx("span",{"aria-hidden":"true",class:e}))};c.prototype._renderMediaPageButton=function(a,c){var g=(a="previous"===a)?e.previous:e.next,d=a?b.join("esri-popup-renderer__button","esri-popup-renderer__media-previous"):b.join("esri-popup-renderer__button","esri-popup-renderer__media-next"),
r=a?b.join("esri-popup-renderer__icon","esri-popup-renderer__media-previous-icon","esri-icon-left-triangle-arrow"):b.join("esri-popup-renderer__icon","esri-popup-renderer__media-next-icon","esri-icon-right-triangle-arrow"),f=a?b.join("esri-popup-renderer__icon","esri-popup-renderer__media-previous-icon--rtl","esri-icon-right-triangle-arrow"):b.join("esri-popup-renderer__icon","esri-popup-renderer__media-next-icon--rtl","esri-icon-left-triangle-arrow"),n=a?this._previousClick:this._nextClick;return b.tsx("div",
{key:l(a?"previous":"next",c),title:g,tabIndex:0,role:"button",class:d,"data-content-element-index":c,bind:this,onclick:n},b.tsx("span",{"aria-hidden":"true",class:r}),b.tsx("span",{"aria-hidden":"true",class:f}),b.tsx("span",{class:"esri-icon-font-fallback-text"},g))};c.prototype._renderMedia=function(a,c){a=a.mediaInfos;var g=this._getMediaStats(a),d=g.total,r=(f={},f["esri-popup-renderer--media-pagination-visible"]=1<g.total,f),f=this._renderMediaStatsItem(e.numImages,g.images,"image"),g=this._renderMediaStatsItem(e.numCharts,
g.charts,"chart"),n=this._renderMediaPageButton("previous",c),k=this._renderMediaPageButton("next",c),t=this._activeMediaMap.get(c);isNaN(t)&&(this._activeMediaMap.set(c,0),t=0);return d?b.tsx("div",{key:l("media-element",c),class:b.join("esri-popup-renderer__media","esri-popup-renderer__content-element"),classes:r},b.tsx("ul",{class:"esri-popup-renderer__media-summary"},f,g),b.tsx("div",{key:l("media-element-container",c),class:"esri-popup-renderer__media-container"},n,this._renderMediaInfo(a[t],
c),k)):null;var f};c.prototype._renderText=function(a,c){return a.text?b.tsx("div",{key:l("text-element",c),innerHTML:a.text,class:b.join("esri-popup-renderer__text","esri-popup-renderer__content-element")}):null};c.prototype._attachToNode=function(a){a.appendChild(this)};c.prototype._getMediaStats=function(a){var b=0,c=0;a.forEach(function(a){a=a.type;"image"===a?b++:-1!==a.indexOf("chart")&&c++});return{total:c+b,images:b,charts:c}};c.prototype._pageContentElementMedia=function(a,b){var c=this.viewModel.content;
(c=(c=c&&c[a])&&c.mediaInfos)&&c.length&&(b="previous"===b?-1:1,b=(this._activeMediaMap.get(a)+b+c.length)%c.length,this._activeMediaMap.set(a,b),this.scheduleRender())};c.prototype._previousClick=function(a){this.previousMedia(a.currentTarget["data-content-element-index"])};c.prototype._nextClick=function(a){this.nextMedia(a.currentTarget["data-content-element-index"])};return c}(a.declared(k));c([a.aliasOf("viewModel.graphic")],h.prototype,"graphic",void 0);c([a.aliasOf("viewModel.title")],h.prototype,
"title",void 0);c([a.property({type:f}),b.renderable(["viewModel.waitingForContent","viewModel.content"])],h.prototype,"viewModel",void 0);c([b.accessibleHandler()],h.prototype,"_previousClick",null);c([b.accessibleHandler()],h.prototype,"_nextClick",null);return h=c([a.subclass("esri.widgets.Popup.PopupRenderer")],h)})},"esri/widgets/support/widget":function(){define(["require","exports","./decorators","./jsxFactory","./widgetUtils"],function(m,h,d,c,a){function b(a){for(var b in a)h.hasOwnProperty(b)||
(h[b]=a[b])}Object.defineProperty(h,"__esModule",{value:!0});b(d);b(c);b(a)})},"esri/widgets/support/decorators":function(){define("require exports ./decorators/accessibleHandler ./decorators/renderable ./decorators/triggerWithSpaceOrEnter ./decorators/vmEvent ./decorators/vmMethod ./decorators/vmProperty".split(" "),function(m,h,d,c,a,b,k,f){function g(a){for(var b in a)h.hasOwnProperty(b)||(h[b]=a[b])}Object.defineProperty(h,"__esModule",{value:!0});g(d);g(c);g(a);g(b);g(k);g(f)})},"esri/widgets/support/decorators/accessibleHandler":function(){define(["require",
"exports","dojo/keys"],function(m,h,d){function c(a){return function(b){for(var c=[],f=1;f<arguments.length;f++)c[f-1]=arguments[f];f=b.type;if(b instanceof KeyboardEvent||"keyup"===f||"keydown"===f||"keypress"===f){if(b.keyCode===d.ENTER||b.keyCode===d.SPACE)b.preventDefault(),b.target.click()}else a.call.apply(a,[this,b].concat(c))}}Object.defineProperty(h,"__esModule",{value:!0});h.accessibleHandler=function(){return function(a,b){return{value:c(a[b])}}}})},"esri/widgets/support/decorators/renderable":function(){define(["require",
"exports","./propUtils"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.renderable=function(c){var a="string"===typeof c?d.splitProps(c):c;return function(b,c){b._renderableProps||(b._renderableProps=[]);b=b._renderableProps;a?b.push.apply(b,d.normalizePropNames(a,c)):b.push(c)}}})},"esri/widgets/support/decorators/propUtils":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.splitProps=function(d){return d.split(",").map(function(c){return c.trim()})};
h.normalizePropNames=function(d,c){return d.map(function(a){a=0===a.indexOf(c)?a:c+"."+a;return a})}})},"esri/widgets/support/decorators/triggerWithSpaceOrEnter":function(){define(["require","exports","../../../core/Logger","./accessibleHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});h.triggerWithSpaceOrEnter=function(){d.getLogger("esri.widgets.support.decorators.triggerWithSpaceOrEnter").warn("@triggerWithSpaceOrEnter is deprecated, use @accessibleHandler instead.");
return c.accessibleHandler.apply(this,arguments)}})},"esri/widgets/support/decorators/vmEvent":function(){define(["require","exports","./propUtils"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.vmEvent=function(c){return function(a){a._delegatedEventNames||(a._delegatedEventNames=[]);var b=Array.isArray(c)?c:d.splitProps(c);a._delegatedEventNames=a._delegatedEventNames.concat(b)}}})},"esri/widgets/support/decorators/vmMethod":function(){define(["require","exports","../../../core/accessorSupport/get"],
function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.vmMethod=function(){console.warn("@vmMethod is deprecated, use @aliasOf instead");return function(c,a,b){var k="viewModel."+a,f;b.value=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(b=d.default(this,k))return f||(f=k.split(".").slice(0,-1).join(".")),b=b.bind(d.default(this,f)),b.call.apply(b,[this].concat(a))}}}})},"esri/widgets/support/decorators/vmProperty":function(){define(["require","exports","../../../core/accessorSupport/decorators"],
function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.vmProperty=function(c){var a=this;console.warn("@vmProperty is deprecated, use @aliasOf instead");return function(b,k){d.property.call(a,{aliasOf:"viewModel."+(c||k)}).call(a,b,k)}}})},"esri/widgets/support/jsxFactory":function(){define(["require","exports","../libs/maquette/maquette"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.tsx=d.h})},"esri/widgets/support/widgetUtils":function(){define(["require","exports",
"../../core/Logger"],function(m,h,d){function c(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return a.join(" ")}Object.defineProperty(h,"__esModule",{value:!0});h.classes=function(){d.getLogger("esri.widgets.support.widgetUtils").warn("classes is deprecated, use join instead.");return c.apply(this,arguments)};h.join=c;h.isRtl=function(){return"rtl"===document.head.dir}})},"esri/widgets/Spinner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./support/widget ../core/accessorSupport/decorators ./Widget ../core/promiseUtils ../core/watchUtils ./support/AnchorElementViewModel".split(" "),
function(m,h,d,c,a,b,k,f,g,e){m=function(b){function c(a){a=b.call(this)||this;a._animationDelay=500;a._animationPromise=null;a.location=null;a.view=null;a.visible=!1;a.viewModel=new e;return a}d(c,b);c.prototype.postInitialize=function(){var a=this;this.own([g.watch(this,"visible",function(b){return a._visibleChange(b)})])};c.prototype.destroy=function(){this._cancelAnimationPromise()};c.prototype.show=function(a){var b=this,c=a.location;a=a.promise;c&&(this.viewModel.location=c);this.visible=!0;
a&&a.always(function(){return b.hide()})};c.prototype.hide=function(){this.visible=!1};c.prototype.render=function(){var b=this.visible,c=!!this.viewModel.screenLocation,b=(e={},e["esri-spinner--start"]=b&&c,e["esri-spinner--finish"]=!b&&c,e),e=this._getPositionStyles();return a.tsx("div",{class:"esri-spinner",classes:b,styles:e});var e};c.prototype._cancelAnimationPromise=function(){this._animationPromise&&(this._animationPromise.cancel(),this._animationPromise=null)};c.prototype._visibleChange=
function(a){var b=this;a?this.viewModel.screenLocationEnabled=!0:(this._cancelAnimationPromise(),this._animationPromise=f.after(this._animationDelay).then(function(){b.viewModel.screenLocationEnabled=!1;b._animationPromise=null}))};c.prototype._getPositionStyles=function(){var a=this.viewModel.screenLocation;return a?{left:a.x+"px",top:a.y+"px"}:{}};return c}(b.declared(k));c([b.aliasOf("viewModel.location")],m.prototype,"location",void 0);c([b.aliasOf("viewModel.view")],m.prototype,"view",void 0);
c([b.property(),a.renderable()],m.prototype,"visible",void 0);c([b.property({type:e}),a.renderable(["viewModel.screenLocation","viewModel.screenLocationEnabled"])],m.prototype,"viewModel",void 0);return m=c([b.subclass("esri.widgets.Spinner")],m)})},"esri/widgets/support/AnchorElementViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ../../core/Accessor ../../core/Evented ../../core/HandleRegistry ../../core/watchUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e){m=function(a){function c(){var b=a.call(this)||this;b._handles=new g;b.location=null;b.screenLocation=null;b.screenLocationEnabled=!1;b.view=null;b._handles.add([e.watch(b,"screenLocationEnabled,location",function(){return b._updateScreenPointAndHandle()}),e.watch(b,"view, view.ready",function(){return b._wireUpView()})]);return b}d(c,a);c.prototype.destroy=function(){this.view=null;this._handles.destroy();this._viewpointHandle=this._handles=null};c.prototype._wireUpView=
function(){var a=this;this._handles.remove("view");this._viewpointHandle=null;if(this.get("view.ready")){this._setScreenLocation();var c=this.view,c=b.pausable(c,"3d"===c.type?"camera":"viewpoint",function(){return a._viewpointChange()});this._handles.add(c,"view");this._viewpointHandle=c;this._toggleWatchingViewpoint()}};c.prototype._viewpointChange=function(){this._setScreenLocation();this.emit("view-change")};c.prototype._updateScreenPointAndHandle=function(){this._setScreenLocation();this._toggleWatchingViewpoint()};
c.prototype._toggleWatchingViewpoint=function(){var a=this._viewpointHandle,b=this.screenLocationEnabled;a&&(this.location&&b?a.resume():a.pause())};c.prototype._setScreenLocation=function(){var a=this.location,b=this.view,c=this.screenLocationEnabled,e=this.get("view.ready"),a=c&&a&&e?b.toScreen(a.x,a.y,a.z):null;this._set("screenLocation",a)};return c}(a.declared(k,f));c([a.property()],m.prototype,"location",void 0);c([a.property({readOnly:!0})],m.prototype,"screenLocation",void 0);c([a.property()],
m.prototype,"screenLocationEnabled",void 0);c([a.property()],m.prototype,"view",void 0);return m=c([a.subclass("esri.widgets.support.AnchorElementViewModel")],m)})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ./UI ./Component ../../widgets/Attribution ../../widgets/Compass ../../widgets/Zoom ../../widgets/NavigationToggle dojo/dom-geometry".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){m=function(a){function c(b){b=a.call(this)||this;b._defaultPositionLookup=null;b.components=[];return b}d(c,a);c.prototype.initialize=function(){this._handles.add([b.init(this,"components",this._componentsWatcher.bind(this)),b.init(this,"view",this._updateViewAwareWidgets.bind(this))])};c.prototype._findComponentPosition=function(a){if(!this._defaultPositionLookup){var b=v.isBodyLtr();this._defaultPositionLookup={attribution:"manual",compass:b?"top-left":"top-right",
"navigation-toggle":b?"top-left":"top-right",zoom:b?"top-left":"top-right"}}return this._defaultPositionLookup[a]};c.prototype._removeComponents=function(a){var b=this;a.forEach(function(a){if(a=b.find(a))b.remove(a),a.destroy()})};c.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b.find(c))&&c.widget)&&void 0!==c.view&&c.set("view",a)})};c.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a)};c.prototype._addComponents=
function(a){var b=this;this.initialized&&a.forEach(function(a){return b.add(b._createComponent(a),b._findComponentPosition(a))})};c.prototype._createComponent=function(a){var b=this._createWidget(a);if(b)return new f({id:a,node:b})};c.prototype._createWidget=function(a){if("attribution"===a)return this._createAttribution();if("compass"===a)return this._createCompass();if("navigation-toggle"===a)return this._createNavigationToggle();if("zoom"===a)return this._createZoom()};c.prototype._createAttribution=
function(){return new g({view:this.view})};c.prototype._createCompass=function(){return new e({view:this.view})};c.prototype._createNavigationToggle=function(){return new p({view:this.view})};c.prototype._createZoom=function(){return new l({view:this.view})};return c}(a.declared(k));c([a.property()],m.prototype,"components",void 0);return m=c([a.subclass("esri.views.ui.DefaultUI")],m)})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Component ../../core/Accessor ../../core/HandleRegistry ../../core/watchUtils dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){function q(a){return"object"!==typeof a||a&&a.isInstanceOf&&a.isInstanceOf(b)||!("component"in a||"index"in a||"position"in a)?null:a}var n={left:0,top:0,bottom:0,right:0},t={bottom:30,top:15,right:15,left:15};m=function(a){function c(){var b=a.call(this)||this;b._cornerNameToContainerLookup={};b._positionNameToContainerLookup={};b._components=[];b._handles=new f;b.padding=t;b.view=null;b._initContainers();return b}d(c,a);c.prototype.initialize=function(){this._handles.add([g.init(this,
"view.padding, container",this._applyViewPadding.bind(this)),g.init(this,"padding",this._applyUIPadding.bind(this))])};c.prototype.destroy=function(){this.container=null;this._components.forEach(function(a){a.destroy()});this._components.length=0;this._handles.destroy()};Object.defineProperty(c.prototype,"container",{set:function(a){var b=this._get("container");a!==b&&(a&&(l.add(a,"esri-ui"),this._attachContainers(a)),b&&(l.remove(b,"esri-ui"),v.set(b,{top:"",bottom:"",left:"",right:""}),p.empty(b)),
this._set("container",a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0});c.prototype.castPadding=function(a){return"number"===typeof a?{bottom:a,top:a,right:a,left:a}:e.mixin({},t,a)};Object.defineProperty(c.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();
return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0});c.prototype.add=function(a,c){var r=this,e;if(Array.isArray(a))a.forEach(function(a){return r.add(a,c)});else{var g=q(a);g&&(e=g.index,c=g.position,a=g.component);c&&"object"===typeof c&&(e=c.index,c=c.position);!a||c&&!this._isValidPosition(c)||(a&&a.isInstanceOf&&a.isInstanceOf(b)||(a=new b({node:a})),this._place({component:a,position:c,index:e}),this._components.push(a))}};c.prototype.remove=function(a){if(a){if(Array.isArray(a))return a.map(this.remove,
this);if(a=this.find(a)){var b=this._components.indexOf(a);a.node.parentNode&&a.node.parentNode.removeChild(a.node);return this._components.splice(b,1)[0]}}};c.prototype.empty=function(a){var b=this;if(Array.isArray(a))return a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)});a=a||"manual";if("manual"===a)return Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!l.contains(a,"esri-ui-corner")}).map(function(a){return b.remove(a)});if(this._isValidPosition(a))return Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,
this)};c.prototype.move=function(a,b){var c=this;Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)});if(a){var e,r=q(a)||q(b);r&&(e=r.index,b=r.position,a=r.component||a);(!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:e})}};c.prototype.find=function(a){return a?a&&a.isInstanceOf&&a.isInstanceOf(b)?this._findByComponent(a):"string"===typeof a?this._findById(a):this._findByNode(a.domNode||a):null};c.prototype._getViewPadding=function(){return this.get("view.padding")||
n};c.prototype._attachContainers=function(a){p.place(this._manualContainer,a);p.place(this._innerContainer,a)};c.prototype._initContainers=function(){var a=p.create("div",{className:"esri-ui-inner-container esri-ui-corner-container"}),b=p.create("div",{className:"esri-ui-inner-container esri-ui-manual-container"}),c=p.create("div",{className:"esri-ui-top-left esri-ui-corner"},a),g=p.create("div",{className:"esri-ui-top-right esri-ui-corner"},a),d=p.create("div",{className:"esri-ui-bottom-left esri-ui-corner"},
a),l=p.create("div",{className:"esri-ui-bottom-right esri-ui-corner"},a);this._innerContainer=a;this._manualContainer=b;this._cornerNameToContainerLookup={"top-left":c,"top-right":g,"bottom-left":d,"bottom-right":l};this._positionNameToContainerLookup=e.mixin({manual:b},this._cornerNameToContainerLookup)};c.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]};c.prototype._place=function(a){var b=a.component,c=a.index;a=this._positionNameToContainerLookup[a.position||
"manual"];var e;-1<c?(e=Array.prototype.slice.call(a.children),0===c?this._placeComponent(b,a,"first"):c>=e.length?this._placeComponent(b,a,"last"):this._placeComponent(b,e[c],"before")):this._placeComponent(b,a,"last")};c.prototype._placeComponent=function(a,b,c){var e=a.widget;e&&!e._started&&"function"===typeof e.postMixInProperties&&"function"===typeof e.buildRendering&&"function"===typeof e.postCreate&&"function"===typeof e.startup&&a.widget.startup();p.place(a.node,b,c)};c.prototype._applyViewPadding=
function(){var a=this.container;a&&v.set(a,this._toPxPosition(this._getViewPadding()))};c.prototype._applyUIPadding=function(){this._innerContainer&&v.set(this._innerContainer,this._toPxPosition(this.padding))};c.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}};c.prototype._toPxUnit=function(a){return 0===a?0:a+"px"};c.prototype._findByComponent=function(a){var b=null,c;this._components.some(function(e){(c=
e===a)&&(b=e);return c});return b};c.prototype._findById=function(a){var b=null,c;this._components.some(function(e){(c=e.id===a)&&(b=e);return c});return b};c.prototype._findByNode=function(a){var b=null,c;this._components.some(function(e){(c=e.node===a)&&(b=e);return c});return b};return c}(a.declared(k));c([a.property()],m.prototype,"container",null);c([a.property()],m.prototype,"height",null);c([a.property()],m.prototype,"padding",void 0);c([a.cast("padding")],m.prototype,"castPadding",null);c([a.property()],
m.prototype,"view",void 0);c([a.property()],m.prototype,"width",null);return m=c([a.subclass("esri.views.ui.UI")],m)})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor dojo/dom dojo/dom-class".split(" "),function(m,h,d,c,a,b,k,f){m=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.widget=null;return b}d(b,a);b.prototype.destroy=
function(){this.widget&&this.widget.destroy();this.node=null};Object.defineProperty(b.prototype,"id",{get:function(){return this._get("id")||this.get("node.id")},set:function(a){this._set("id",a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"node",{set:function(a){var b=this._get("node");a!==b&&(a&&f.add(a,"esri-component"),b&&f.remove(b,"esri-component"),this._set("node",a))},enumerable:!0,configurable:!0});b.prototype.castNode=function(a){if(!a)return this._set("widget",null),
null;if("string"===typeof a||a&&"nodeType"in a)return this._set("widget",null),k.byId(a);a&&"function"===typeof a.render&&!a.domNode&&(a.domNode=document.createElement("div"));this._set("widget",a);return a.domNode};return b}(a.declared(b));c([a.property()],m.prototype,"id",null);c([a.property()],m.prototype,"node",null);c([a.cast("node")],m.prototype,"castNode",null);c([a.property({readOnly:!0})],m.prototype,"widget",void 0);return m=c([a.subclass("esri.views.ui.Component")],m)})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Attribution/AttributionViewModel".split(" "),
function(m,h,d,c,a,b,k,f){m=function(a){function c(b){b=a.call(this)||this;b._isOpen=!1;b._attributionTextOverflowed=!1;b._prevSourceNodeHeight=0;b.view=null;b.viewModel=new f;return b}d(c,a);c.prototype.render=function(){var a=(c={},c["esri-attribution--open"]=this._isOpen,c);return b.tsx("div",{bind:this,class:"esri-attribution esri-widget",classes:a,onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),b.tsx("div",{class:"esri-attribution__powered-by"},"Powered by ",
b.tsx("a",{target:"_blank",href:"http://www.esri.com/",class:"esri-attribution__link"},"Esri")));var c};c.prototype._renderSourcesNode=function(){var a=this._isOpen,c=this._isInteractive(),e=c?0:-1,g=this.get("viewModel.attributionText"),a=(d={},d["esri-attribution__sources--open"]=a,d["esri-interactive"]=c,d);return b.tsx("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:"esri-attribution__sources",classes:a,innerHTML:g,role:c?"button":void 0,
tabIndex:e});var d};c.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=a.clientWidth};c.prototype._afterSourcesNodeUpdate=function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>=a.clientWidth;var e=this._attributionTextOverflowed!==a;this._attributionTextOverflowed=a;e&&(b=!0);this._isOpen&&(a=c<this._prevSourceNodeHeight,this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0));b&&this.scheduleRender()};c.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=
!this._isOpen)};c.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed};return c}(a.declared(k));c([a.aliasOf("viewModel.view")],m.prototype,"view",void 0);c([a.property({type:f}),b.renderable(["attributionText","state","view.size"])],m.prototype,"viewModel",void 0);c([b.accessibleHandler()],m.prototype,"_toggleState",null);return m=c([a.subclass("esri.widgets.Attribution")],m)})},"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../geometry/support/webMercatorUtils ../../core/HandleRegistry ../../core/Accessor ../../core/lang ../../core/watchUtils ../../geometry/Extent".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){m=function(a){function c(b){b=a.call(this,b)||this;b._handles=new k;b._pendingAttributionItemsByLayerId={};b._attributionDataByLayerId={};b.itemDelimiter=" | ";b.items=[];b.view=null;b._updateAttributionItems=b._updateAttributionItems.bind(b);return b}d(c,a);c.prototype.initialize=function(){this._handles.add(e.init(this,"view",this._viewWatcher))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,
"attributionText",{get:function(){return this.items.join(this.itemDelimiter)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype._viewWatcher=function(a){var b=this,c=this._handles;c&&c.remove();a&&(c.add([a.allLayerViews.on("change",function(a){b._addLayerViews(a.added);0<a.removed.length&&(a.removed.forEach(function(a){c.remove(a.uid)}),b._updateAttributionItems())}),
e.init(a,"stationary",this._updateAttributionItems)]),this._addLayerViews(a.allLayerViews))};c.prototype._addLayerViews=function(a){var b=this;a.forEach(function(a){b._handles.has(a.uid)||b._handles.add(e.init(a,"suspended",b._updateAttributionItems),a.uid)})};c.prototype._updateAttributionItems=function(){var a=this,b=[];this._getActiveLayerViews().forEach(function(c){var e=c.layer;if(!e.hasAttributionData)c=e.get("copyright"),a._isUnique(b,c)&&b.push(c);else if(e&&e.tileInfo){var g=a._attributionDataByLayerId;
if(g[e.uid])c=a._getDynamicAttribution(g[e.uid],a.view,e),a._isUnique(b,c)&&b.push(c);else{var r=a._pendingAttributionItemsByLayerId;a._inProgress(r[e.uid])||(r[e.uid]=e.fetchAttributionData().then(function(b){b=a._createContributionIndex(b,a._isBingLayer(e));delete r[e.uid];g[e.uid]=b;a._updateAttributionItems()}))}}});this._itemsChanged(this.items,b)&&this._set("items",b)};c.prototype._itemsChanged=function(a,b){return a.length!==b.length||a.some(function(a,c){return a!==b[c]})};c.prototype._inProgress=
function(a){return a&&!a.isFulfilled()};c.prototype._getActiveLayerViews=function(){return this.get("view.allLayerViews").filter(function(a){return!a.suspended&&a.get("layer.attributionVisible")})};c.prototype._isUnique=function(a,b){return b&&-1===a.indexOf(b)};c.prototype._isBingLayer=function(a){return-1!==a.declaredClass.toLowerCase().indexOf("vetiledlayer")};c.prototype._createContributionIndex=function(a,c){a=a.contributors;var e={};if(!a)return e;a.forEach(function(a,d){var r=a.coverageAreas;
r&&r.forEach(function(r){var f=r.bbox,n=r.zoomMin-(c&&r.zoomMin?1:0),k=r.zoomMax-(c&&r.zoomMax?1:0);a={extent:b.geographicToWebMercator(new l({xmin:f[1],ymin:f[0],xmax:f[3],ymax:f[2]})),attribution:a.attribution||"",score:g.isDefined(r.score)?r.score:100,id:d};for(r=n;r<=k;r++)e[r]=e[r]||[],e[r].push(a)})});e.maxKey=Math.max.apply(null,Object.keys(e));return e};c.prototype._getDynamicAttribution=function(a,b,c){var e=b.extent;b=c.tileInfo.scaleToZoom(b.scale);b=Math.min(a.maxKey,Math.round(b));if(!e||
!g.isDefined(b)||-1>=b)return"";a=a[b];var d=e.center.clone().normalize(),r={};return a.filter(function(a){var b=!r[a.id]&&a.extent.contains(d);b&&(r[a.id]=!0);return b}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", ")};return c}(a.declared(f));c([a.property({dependsOn:["items","itemDelimiter"],readOnly:!0})],m.prototype,"attributionText",null);c([a.property()],m.prototype,"itemDelimiter",void 0);c([a.property({readOnly:!0})],m.prototype,
"items",void 0);c([a.property({dependsOn:["view.ready"],readOnly:!0})],m.prototype,"state",null);c([a.property()],m.prototype,"view",void 0);return m=c([a.subclass("esri.widgets.Attribution.AttributionViewModel")],m)})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Compass/CompassViewModel dojo/i18n!./Compass/nls/Compass".split(" "),function(m,h,d,c,a,
b,k,f,g){m=function(a){function c(b){b=a.call(this)||this;b.view=null;b.viewModel=new f;return b}d(c,a);c.prototype.reset=function(){};c.prototype.render=function(){var a=this.viewModel.orientation,c=this.viewModel.state,e="disabled"===c,d="compass"===("rotation"===c?"rotation":"compass"),c=(l={},l["esri-disabled"]=e,l["esri-interactive"]=!e,l),l=(f={},f["esri-icon-compass"]=d,f["esri-icon-dial"]=!d,f);return b.tsx("div",{bind:this,class:"esri-compass esri-widget-button esri-widget",classes:c,onclick:this._reset,
onkeydown:this._reset,role:"button",tabIndex:e?-1:0},b.tsx("span",{"aria-hidden":"true",class:"esri-compass__icon",classes:l,styles:this._toRotationTransform(a),title:g.reset}),b.tsx("span",{class:"esri-icon-font-fallback-text"},g.reset));var l,f};c.prototype._reset=function(){this.reset()};c.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+a.z+"deg)"}};return c}(a.declared(k));c([a.aliasOf("viewModel.view")],m.prototype,"view",void 0);c([a.property({type:f}),b.renderable(["viewModel.orientation",
"viewModel.state"])],m.prototype,"viewModel",void 0);c([a.aliasOf("viewModel.reset")],m.prototype,"reset",null);c([b.accessibleHandler()],m.prototype,"_reset",null);return m=c([a.subclass("esri.widgets.Compass")],m)})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/HandleRegistry ../../core/Accessor ../../core/watchUtils".split(" "),function(m,
h,d,c,a,b,k,f){m=function(a){function c(c){c=a.call(this,c)||this;c._handles=new b;c.orientation={x:0,y:0,z:0};c.view=null;c._updateForCamera=c._updateForCamera.bind(c);c._updateForRotation=c._updateForRotation.bind(c);c._updateRotationWatcher=c._updateRotationWatcher.bind(c);return c}d(c,a);c.prototype.initialize=function(){this._handles.add(f.init(this,"view",this._updateRotationWatcher))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,
"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return a&&(a.isWebMercator||4326===a.wkid)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"},enumerable:!0,configurable:!0});c.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.view.goTo(a)}};c.prototype._updateForRotation=function(a){void 0!==
a&&null!==a&&(this.orientation={z:a})};c.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})};c.prototype._updateRotationWatcher=function(a){this._handles.removeAll();a&&("2d"===a.type?this._handles.add(f.init(this,"view.rotation",this._updateForRotation)):this._handles.add(f.init(this,"view.camera",this._updateForCamera)))};return c}(a.declared(k));c([a.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],m.prototype,
"canShowNorth",null);c([a.property()],m.prototype,"orientation",void 0);c([a.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],m.prototype,"state",null);c([a.property()],m.prototype,"view",void 0);return m=c([a.subclass("esri.widgets.CompassViewModel")],m)})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel dojo/i18n!./Zoom/nls/Zoom".split(" "),
function(m,h,d,c,a,b,k,f,g,e){m=function(a){function c(b){b=a.call(this)||this;b.layout="vertical";b.view=null;b.viewModel=new g;return b}d(c,a);c.prototype.postInitialize=function(){this._zoomInButton=new f({action:this.zoomIn.bind(this),iconClass:"esri-icon-plus",title:e.zoomIn});this._zoomOutButton=new f({action:this.zoomOut.bind(this),iconClass:"esri-icon-minus",title:e.zoomOut})};c.prototype.render=function(){var a=this.viewModel,c=(e={},e["esri-zoom--horizontal"]="horizontal"===this.layout,
e);this._zoomInButton.enabled="ready"===a.state&&a.canZoomIn;this._zoomOutButton.enabled="ready"===a.state&&a.canZoomOut;return b.tsx("div",{class:"esri-zoom esri-widget",classes:c},this._zoomInButton.render(),this._zoomOutButton.render());var e};c.prototype.zoomIn=function(){};c.prototype.zoomOut=function(){};return c}(a.declared(k));c([a.property(),b.renderable()],m.prototype,"layout",void 0);c([a.aliasOf("viewModel.view"),b.renderable()],m.prototype,"view",void 0);c([a.property({type:g}),b.renderable(["viewModel.canZoomIn",
"viewModel.canZoomOut","viewModel.state"])],m.prototype,"viewModel",void 0);c([a.aliasOf("viewModel.zoomIn")],m.prototype,"zoomIn",null);c([a.aliasOf("viewModel.zoomOut")],m.prototype,"zoomOut",null);return m=c([a.subclass("esri.widgets.Zoom")],m)})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../support/widget ../Widget".split(" "),function(m,h,d,c,a,b,k){m=function(a){function c(){var b=
null!==a&&a.apply(this,arguments)||this;b.enabled=!0;b.iconClass="";b.title="";return b}d(c,a);c.prototype.render=function(){var a=this.enabled?0:-1,c=(g={},g["esri-disabled"]=!this.enabled,g["esri-interactive"]=this.enabled,g),g=(d={},d[this.iconClass]=!!this.iconClass,d);return b.tsx("div",{bind:this,class:"esri-widget-button esri-widget",classes:c,onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:a,title:this.title},b.tsx("span",{"aria-hidden":"true",role:"presentation",
class:"esri-icon",classes:g}),b.tsx("span",{class:"esri-icon-font-fallback-text"},this.title));var g,d};c.prototype._triggerAction=function(){this.action.call(this)};return c}(a.declared(k));c([a.property()],m.prototype,"action",void 0);c([a.property(),b.renderable()],m.prototype,"enabled",void 0);c([a.property(),b.renderable()],m.prototype,"iconClass",void 0);c([a.property(),b.renderable()],m.prototype,"title",void 0);c([b.accessibleHandler()],m.prototype,"_triggerAction",null);return m=c([a.subclass("esri.widgets.IconButton")],
m)})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,h,d,c,a,b){m=function(a){function b(b){b=a.call(this,b)||this;b.view=null;b.zoomIn=b.zoomIn.bind(b);b.zoomOut=b.zoomOut.bind(b);return b}d(b,a);b.prototype.destroy=function(){this.view=null};Object.defineProperty(b.prototype,"canZoomIn",{get:function(){if("2d"!==this.get("view.type"))return!0;
var a=this.get("view.scale"),b=this.get("view.constraints.effectiveMaxScale");return 0===b||a>b},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"canZoomOut",{get:function(){if("2d"!==this.get("view.type"))return!0;var a=this.get("view.scale"),b=this.get("view.constraints.effectiveMinScale");return 0===b||a<b},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});
b.prototype.zoomIn=function(){this.canZoomIn&&this._zoomToFactor(.5)};b.prototype.zoomOut=function(){this.canZoomOut&&this._zoomToFactor(2)};b.prototype._zoomToFactor=function(a){"ready"===this.state&&this.view.goTo({scale:this.get("view.scale")*a})};return b}(a.declared(b));c([a.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],m.prototype,"canZoomIn",null);c([a.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],m.prototype,"canZoomOut",null);c([a.property({dependsOn:["view.ready"],
readOnly:!0})],m.prototype,"state",null);c([a.property()],m.prototype,"view",void 0);return m=c([a.subclass("esri.widgets.Zoom.ZoomViewModel")],m)})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./NavigationToggle/NavigationToggleViewModel dojo/i18n!./NavigationToggle/nls/NavigationToggle".split(" "),function(m,h,d,c,a,b,k,f,g){m=function(a){function c(b){b=
a.call(this)||this;b.view=null;b.viewModel=new f;return b}d(c,a);Object.defineProperty(c.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});c.prototype.toggle=function(){};c.prototype.render=function(){var a="disabled"===this.get("viewModel.state"),c="pan"===this.get("viewModel.navigationMode"),e=(d={},d["esri-disabled"]=a,d),d=(l={},l["esri-navigation-toggle__button--active"]=c,l),c=(f={},f["esri-navigation-toggle__button--active"]=
!c,f);return b.tsx("div",{bind:this,class:"esri-navigation-toggle esri-widget",classes:e,onclick:this._toggle,onkeydown:this._toggle,tabIndex:a?-1:0,title:g.toggle},b.tsx("div",{class:b.join("esri-navigation-toggle__button esri-widget-button","esri-navigation-toggle__button--pan"),classes:d},b.tsx("span",{class:"esri-icon-pan"})),b.tsx("div",{class:b.join("esri-navigation-toggle__button esri-widget-button","esri-navigation-toggle__button--rotate"),classes:c},b.tsx("span",{class:"esri-icon-rotate"})));
var d,l,f};c.prototype._toggle=function(){this.toggle()};return c}(a.declared(k));c([a.property({value:"vertical"}),b.renderable()],m.prototype,"layout",null);c([a.aliasOf("viewModel.view"),b.renderable()],m.prototype,"view",void 0);c([a.property({type:f}),b.renderable(["viewModel.state","viewModel.navigationMode"])],m.prototype,"viewModel",void 0);c([a.aliasOf("viewModel.toggle")],m.prototype,"toggle",null);c([b.accessibleHandler()],m.prototype,"_toggle",null);return m=c([a.subclass("esri.widgets.NavigationToggle")],
m)})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ../../core/Accessor ../../core/HandleRegistry".split(" "),function(m,h,d,c,a,b,k,f){m=function(a){function c(b){b=a.call(this,b)||this;b._handles=new f;b.navigationMode="pan";b.view=null;b.toggle=b.toggle.bind(b);return b}d(c,a);c.prototype.initialize=function(){this._handles.add(b.when(this,
"view.inputManager",this._setNavigationMode.bind(this)))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype.toggle=function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())};c.prototype._setNavigationMode=function(){this.get("view.inputManager").primaryDragAction=
"pan"===this.navigationMode?"pan":"rotate"};return c}(a.declared(k));c([a.property({dependsOn:["view.ready"],readOnly:!0})],m.prototype,"state",null);c([a.property()],m.prototype,"navigationMode",void 0);c([a.property()],m.prototype,"view",void 0);return m=c([a.subclass("esri.widgets.NavigationToggleViewModel")],m)})},"esri/views/animation/easing":function(){define(["require","exports"],function(m,h){function d(a){return a}function c(a){var b=2*(a-Math.sqrt((a-1)*a)),c=b/2/a;return function(g){return g<
c?a*g*g:b*g-b+1}}function a(a,c){return function(b){return b<c?c*a(b/c):1-a((1-b)/(1-c))*(1-c)}}Object.defineProperty(h,"__esModule",{value:!0});h.linear=d;h.inQuad=function(a){return a*a};h.outQuad=function(a){return 1-h.inQuad(1-a)};h.inOutQuad=function(a){return.5>a?h.inQuad(2*a)/2:(h.outQuad(2*(a-.5))+1)/2};h.inCubic=function(a){return a*a*a};h.outCubic=function(a){return 1-h.inCubic(1-a)};h.inOutCubic=function(a){return.5>a?h.inCubic(2*a)/2:(h.outCubic(2*(a-.5))+1)/2};h.inQuart=function(a){return a*
a*a*a};h.outQuart=function(a){return 1-h.inQuart(1-a)};h.inOutQuart=function(a){return.5>a?h.inQuart(2*a)/2:(h.outQuart(2*(a-.5))+1)/2};h.inQuint=function(a){return a*a*a*a*a};h.outQuint=function(a){return 1-h.inQuint(1-a)};h.inOutQuint=function(a){return.5>a?h.inQuint(2*a)/2:(h.outQuint(2*(a-.5))+1)/2};h.inSine=function(a){return-Math.cos(a*Math.PI/2)+1};h.outSine=function(a){return 1-h.inSine(1-a)};h.inOutSine=function(a){return.5>a?h.inSine(2*a)/2:(h.outSine(2*(a-.5))+1)/2};h.inExpo=function(a){return Math.pow(2,
10*(a-1))};h.outExpo=function(a){return 1-h.inExpo(1-a)};h.inOutExpo=function(a){return.5>a?h.inExpo(2*a)/2:(h.outExpo(2*(a-.5))+1)/2};h.inCirc=function(a){return-(Math.sqrt(1-a*a)-1)};h.outCirc=function(a){return 1-h.inCirc(1-a)};h.inOutCirc=function(a){return.5>a?h.inCirc(2*a)/2:(h.outCirc(2*(a-.5))+1)/2};h.inCoastQuad=a(c(1),1);h.outCoastQuad=a(c(1),0);h.inOutCoastQuad=a(c(1),.5);h.inCoastCubic=a(c(2),1);h.outCoastCubic=a(c(2),0);h.inOutCoastCubic=a(c(2),.5);h.inCoastQuart=a(c(3),1);h.outCoastQuart=
a(c(3),0);h.inOutCoastQuart=a(c(3),.5);h.inCoastQuint=a(c(4),1);h.outCoastQuint=a(c(4),0);h.inOutCoastQuint=a(c(4),.5);h.named={linear:d,"in-quad":h.inQuad,"out-quad":h.outQuad,"in-out-quad":h.inOutQuad,"in-cubic":h.inCubic,"out-cubic":h.outCubic,"in-out-cubic":h.inOutCubic,"in-quart":h.inQuart,"out-quart":h.outQuart,"in-out-quart":h.inOutQuart,"in-quint":h.inQuint,"out-quint":h.outQuint,"in-out-quint":h.inOutQuint,"in-sine":h.inSine,"out-sine":h.outSine,"in-out-sine":h.inOutSine,"in-expo":h.inExpo,
"out-expo":h.outExpo,"in-out-expo":h.inOutExpo,"in-circ":h.inCirc,"out-circ":h.outCirc,"in-out-circ":h.inOutCirc}})},"esri/geometry/ScreenPoint":function(){define(["./Point"],function(m){return m.createSubclass({declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/webscene/Environment":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./Lighting".split(" "),function(m,
h,d,c,a,b,k){m=f=function(a){function b(b){b=a.call(this,b)||this;b.lighting=new k;return b}d(b,a);b.prototype.clone=function(){return new f({lighting:k.prototype.clone.call(this.lighting)})};b.sanitizeJSON=function(a){return{lighting:a.lighting?k.sanitizeJSON(a.lighting):(new k).toJSON()}};return b}(b.declared(a));c([b.property({type:k,json:{write:!0}})],m.prototype,"lighting",void 0);m=f=c([b.subclass("esri.webscene.Environment")],m);var f;return m})},"esri/webscene/Lighting":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(m,h,d,c,a,b){m=k=function(a){function b(b){b=a.call(this,b)||this;b.date=null;b.directShadowsEnabled=!1;b.displayUTCOffset=null;return b}d(b,a);b.prototype.readDate=function(a,b){return null!=b.datetime&&new Date(b.datetime)||null};b.prototype.writeDate=function(a,b){null!=a&&(b.datetime=a.getTime())};b.prototype.readDirectShadowsEnabled=function(a,b){return!!b.directShadows};b.prototype.writedirectShadowsEnabled=function(a,b){a&&(b.directShadows=!0)};b.prototype.writeDisplayUTCOffset=function(a,
b){null!=a&&(b.displayUTCOffset=a)};b.prototype.clone=function(){return new k({date:null!=this.date?new Date(this.date.getTime()):null,directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null})};b.sanitizeJSON=function(a){var b={datetime:a.datetime};void 0!==a.directShadows&&(b.directShadows=!!a.directShadows);void 0!==a.displayUTCOffset&&(b.displayUTCOffset=a.displayUTCOffset);return b};return b}(b.declared(a));c([b.property({type:Date})],
m.prototype,"date",void 0);c([b.reader("date",["datetime"])],m.prototype,"readDate",null);c([b.writer("date")],m.prototype,"writeDate",null);c([b.property({type:Boolean})],m.prototype,"directShadowsEnabled",void 0);c([b.reader("directShadowsEnabled",["directShadows"])],m.prototype,"readDirectShadowsEnabled",null);c([b.writer("directShadowsEnabled")],m.prototype,"writedirectShadowsEnabled",null);c([b.property({type:Number,json:{write:!0}})],m.prototype,"displayUTCOffset",void 0);c([b.writer("displayUTCOffset")],
m.prototype,"writeDisplayUTCOffset",null);m=k=c([b.subclass("esri.webscene.Lighting")],m);var k;return m})},"esri/views/support/screenshotUtils":function(){define(["require","exports","dojo/_base/lang"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.adjustScreenshotSettings=function(c,a){c=d.mixin({format:"png",quality:100},c||{});var b,k;c.includePadding?(b=a.width,k=a.height):(b=a.width-a.padding.left-a.padding.right,k=a.height-a.padding.top-a.padding.bottom);var f=b/k;void 0!==
c.width&&void 0===c.height?c.height=c.width/f:void 0!==c.height&&void 0===c.width&&(c.width=f*c.height);void 0!==c.height&&(c.height=Math.floor(c.height));void 0!==c.width&&(c.width=Math.floor(c.width));c.area||c.includePadding||(c.area={x:a.padding.left,y:a.padding.top,width:b,height:k});return c};h.resampleHermite=function(c,a,b,d,f,g,e){void 0===e&&(e=!0);var l=a/f;b/=g;for(var k=Math.ceil(l/2),v=Math.ceil(b/2),q=0;q<g;q++)for(var n=0;n<f;n++){for(var t=4*(n+(e?g-q-1:q)*f),u=0,h=0,r=0,z=0,B=0,
C=0,A=0,D=(q+.5)*b,E=Math.floor(q*b);E<(q+1)*b;E++)for(var H=Math.abs(D-(E+.5))/v,m=(n+.5)*l,H=H*H,J=Math.floor(n*l);J<(n+1)*l;J++){var I=Math.abs(m-(J+.5))/k,u=Math.sqrt(H+I*I);-1<=u&&1>=u&&(u=2*u*u*u-3*u*u+1,0<u&&(I=4*(J+E*a),A+=u*c[I+3],r+=u,255>c[I+3]&&(u=u*c[I+3]/250),z+=u*c[I],B+=u*c[I+1],C+=u*c[I+2],h+=u))}d[t]=z/h;d[t+1]=B/h;d[t+2]=C/h;d[t+3]=A/r}}})},"esri/views/support/WebGLRequirements":function(){define(["require","exports","../../core/Error","../../core/sniff"],function(m,h,d,c){Object.defineProperty(h,
"__esModule",{value:!0});h.check=function(){var a=null;c("esri-webgl")?c("esri-webgl-high-precision-fragment")?c("esri-webgl-vertex-shader-samplers")?c("esri-webgl-element-index-uint")||(a=new d("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported")):a=new d("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported"):a=new d("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported"):
a=new d("webgl:required","WebGL is required but not supported");return a}})},"esri/views/3d/environment/SceneViewEnvironment":function(){define(["dojo/_base/lang","../../../webscene/Environment","../../../webscene/Lighting","./SceneViewLighting","./SceneViewAtmosphere"],function(m,h,d,c,a){var b=h.createSubclass({declaredClass:"esri.views.3d.environment.SceneViewEnvironment",properties:{atmosphere:{type:a,json:{read:!1}},atmosphereEnabled:{value:!0,json:{read:!1}},starsEnabled:{value:!0,json:{read:!1}},
lighting:{set:function(a){if(a)if(this.lighting)null!=a.date&&(this.lighting.date=a.date),null!=a.defaultDate&&(this.lighting.defaultDate=a.defaultDate),null!=a.displayUTCOffset&&(this.lighting.displayUTCOffset=a.displayUTCOffset),this.lighting.directShadowsEnabled=a.directShadowsEnabled,null!=a.ambientOcclusionEnabled&&(this.lighting.ambientOcclusionEnabled=a.ambientOcclusionEnabled),null!=a.cameraTrackingEnabled&&(this.lighting.cameraTrackingEnabled=a.cameraTrackingEnabled);else if(a instanceof
c)this._set("lighting",a);else if(a instanceof d){var b={directShadowsEnabled:a.directShadowsEnabled};null!=a.date&&(b.date=a.date);null!=a.displayUTCOffset&&(b.displayUTCOffset=a.displayUTCOffset);null!=a.defaultDate&&(b.defaultDate=a.defaultDate);this._set("lighting",new c(b))}else this._set("lighting",new c(a));else this.lighting||this._set("lighting",new c)}}},getDefaults:function(){return m.mixin(this.inherited(arguments),{atmosphere:{}})},atmosphere:null,atmosphereEnabled:!0,starsEnabled:!0,
clone:function(){return new b({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled})}});return b})},"esri/views/3d/environment/SceneViewLighting":function(){define(["../../../core/Evented","../../../webscene/Lighting"],function(m,h){var d=new Date,c={target:null,date:null},a={target:null,timezoneOffset:0};return h.createSubclass([m],{declaredClass:"esri.views.3d.environment.SceneViewLighting",properties:{cameraTrackingEnabled:{value:!0},
ambientOcclusionEnabled:{value:!1},defaultDate:{get:function(){return new Date(this._get("defaultDate"))},set:function(a){var b=this._get("date")===this._get("defaultDate");a=new Date(a);this._set("defaultDate",a);b&&this._set("date",a)}},date:{cast:function(a){return a},set:function(a){null!=a&&(this._set("date",new Date(a)),this.positionTimezoneInfo.autoUpdated=!1,this._emitDateWillChange())}}},constructor:function(){this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};this._autoUpdateDate=
null;var a=(new Date).getFullYear(),a=new Date("March 15, "+a+" 12:00:00 UTC");this._set("defaultDate",a);this._set("date",a)},autoUpdate:function(b,c){var d=this._calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=c.hours;this.positionTimezoneInfo.minutes=c.minutes;this.positionTimezoneInfo.seconds=c.seconds;if(null!=b){this.positionTimezoneInfo.autoUpdated=!0;var g=this.date&&this.date.getTime();this._set("date",new Date(b));this._emitDateWillChange()}c=this._calculateTimezoneOffset(this.positionTimezoneInfo);
d!==c&&(a.target=this,a.timezoneOffset=c,this.emit("timezone-will-change",a));if(null!=b)return g!==b.getTime()},_calculateTimezoneOffset:function(a){return Math.round(a.hours+a.minutes/60+a.seconds/3600)},_emitDateWillChange:function(){c.target=this;d.setTime(this._get("date").getTime());c.date=d;this.emit("date-will-change",c)}})})},"esri/views/3d/environment/SceneViewAtmosphere":function(){define(["../../../core/Accessor"],function(m){return m.createSubclass({properties:{quality:{}},quality:"low",
_qualitySetter:function(h){-1!==["low","high"].indexOf(h)&&this._set("quality",h)},clone:function(){return new this.constructor({quality:this.quality})}})})},"esri/views/3d/environment/SceneViewEnvironmentManager":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Evented ../../../core/promiseUtils ../../../core/watchUtils ../../../core/HandleRegistry ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../geometry/SpatialReference ../support/sunUtils ../support/earthUtils ./EnvironmentRenderer ../webgl-engine/lighting/Lightsources ../lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q){var n=q.vec3d,t=new Date,u={hours:0,minutes:0,seconds:0},x=[.5773502691896258,-.5773502691896258,.5773502691896258],r=n.createFrom(.22,.22,.33),z=n.createFrom(.22,.22,.22);m=m([h,d],{declaredClass:"esri.views.3d.environment.SceneViewEnvironmentManager",referencePointUpdateDelay:200,referencePointUpdateInterval:3E3,referencePointUpdateDistThreshold:1E6,properties:{updating:{dependsOn:["noReferencePositionQueries"],readOnly:!0,get:function(){return!this.noReferencePositionQueries&&
(!!this._referencePosUpdateQuery||!!this._referencePosMapCoordsRequested)}},noReferencePositionQueries:{},view:{},_environmentRenderer:{}},constructor:function(){this._viewHandles=new b;this._environmentRenderer=null;this._viewConnected=this._trackingEnabled=this._preserveAbsoluteDateTime=!1;this._referencePosResetPreserveAbsoluteTime=null;this._resetReferencePosition()},destroy:function(){this._viewHandles.destroy();this.disposeRendering()},disposeRendering:function(){this._environmentRenderer&&
(this._environmentRenderer.destroy(),this._environmentRenderer=null);this._resetReferencePosition(!0)},updateReadyChange:function(a){a&&!this._viewConnected?(this._viewConnected=!0,this.connectView(this.view)):!a&&this._viewConnected&&(this._viewConnected=!1,this.disconnectView(this.view))},connectView:function(b){this._environmentRenderer=new p({view:b});this._viewHandles.add([a.on(this.view,"environment.lighting","date-will-change",this._lightingDateHandler.bind(this)),this.view.watch("interacting,stationary",
this._interactingStationaryHandler.bind(this)),this.view.watch("environment.lighting.directShadowsEnabled,environment.lighting.ambientOcclusionEnabled",this._updateRenderParamsHandler.bind(this)),this.view.watch("spatialReference",this._spatialReferenceHandler.bind(this)),a.init(this.view,"viewingMode",this._viewingModeHandler.bind(this)),a.init(this.view,"environment.lighting.cameraTrackingEnabled",this._updateCameraTracking.bind(this),!0),this.watch("noReferencePositionQueries",this._cameraHandler.bind(this,
null))]);this._updateRenderParamsHandler();this._updateLightParams();this._cameraHandler()},_updateCameraTracking:function(b){if(this._trackingEnabled=b)b=a.on(this,"view.navigation","currentViewChanged",this._cameraHandler.bind(this,null),this._cameraHandler.bind(this,null),null,!0),this._viewHandles.add(b,"camera");else{if(b=this.get("view.environment.lighting"))b.positionTimezoneInfo.autoUpdated=!1;this._viewHandles.remove("camera")}},disconnectView:function(a){this.disposeRendering();this._viewHandles.removeAll()},
_lightingDateHandler:function(a){if(a=a.date){var b=this.view.environment.lighting;if(!b.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=!0;var c=this.view.spatialReference;if(!(c.isWGS84||c.isWebMercator||(c=this.view.camera.position,this._referencePosMapCoords&&this._referencePosMapCoords.equals(c)))){this._requestReferencePositionUpdate(c);return}this._preupdateTracking(a);this._referencePosWGS84&&(c=l.positionToTimezone(this._referencePosWGS84,u),b.autoUpdate(null,c),this._trackingEnabled&&
(b.positionTimezoneInfo.autoUpdated=!0))}this._updateLightParams(a)}},_preupdateTracking:function(a){!this._trackingEnabled&&this.get("view.environment.lighting.cameraTrackingEnabled")&&this._cameraHandler(a)},_cameraHandler:function(a){var b=this.view.camera;if(b){var c=this.view.spatialReference;c.isWGS84||c.isWebMercator?this._cameraHandlerGlobal(b,a):this._cameraHandlerLocal(b,a)}},_cameraHandlerGlobal:function(a,b){a=a.position;this._referencePosWGS84||(this._referencePosWGS84=new k({spatialReference:g.WGS84}));
a.spatialReference.isWebMercator?f.webMercatorToGeographic(a,!1,this._referencePosWGS84):(this._referencePosWGS84.x=a.x,this._referencePosWGS84.y=a.y);this._referencePosWGS84.z=a.z;this._autoUpdateTimezone(a,b)||this._updateLightParams(b)},_cameraHandlerLocal:function(a,b){a=a.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(a))&&this._requestReferencePositionUpdate(a,!0);this.view.mapCoordsHelper&&this._referencePosWGS84&&(this._referencePosWGS84.z=
a.z*this.view.mapCoordsHelper.unitInMeters,this._referencePosChanged())},_interactingStationaryHandler:function(){!this.view.interacting&&this.view.stationary&&this._executePendingReferencePositionUpdate()},_mainLight:new v.MainLight,_ambientLight:new v.AmbientLight,_moonLight:new v.FillLight,_updateLightParams:function(a){var b=this.view.environment.lighting;a=a||b.date;var b=this.view._stage,c;this._referencePosWGS84?(c=e.computeColorAndIntensity(a,this._referencePosWGS84),e.computeDirection(a,
this._referencePosWGS84,this.view.viewingMode,c.diffuse.direction)):c={diffuse:{color:[1,1,1],intensity:.55,direction:x},ambient:{color:[1,1,1],intensity:.55},noonFactor:.5,globalFactor:0};n.scale(c.diffuse.color,c.diffuse.intensity*Math.PI,this._mainLight.intensity);n.negate(c.diffuse.direction,this._mainLight.direction);n.scale(c.ambient.color,c.ambient.intensity,this._ambientLight.intensity);n.lerp(r,z,c.globalFactor,this._moonLight.intensity);n.scale(this._moonLight.intensity,(1-.5*c.globalFactor)*
(1-.4*c.noonFactor*(1-c.globalFactor)));n.set(c.diffuse.direction,this._moonLight.direction);b.setLighting({lights:[this._mainLight,this._ambientLight,this._moonLight],globalFactor:c.globalFactor,groundLightingFactor:1-c.noonFactor});this._updateRenderParamsHandler()},_autoUpdateTimezone:function(a,b){if(!this.view.get("environment.lighting.cameraTrackingEnabled"))return!1;t.setTime((b||this.view.environment.lighting.date).getTime());a=l.positionToTimezone(a,u);var c=this.view.environment.lighting.positionTimezoneInfo;
if(!c.autoUpdated)c=a;else if(c.hours===a.hours&&c.minutes===a.minutes&&c.seconds===a.seconds)return!1;var e=t.getUTCHours()-(a.hours-c.hours),r=t.getUTCMinutes()-(a.minutes-c.minutes),c=t.getUTCSeconds()-(a.seconds-c.seconds);t.setUTCHours(e);t.setUTCMinutes(r);t.setUTCSeconds(c);return b?!1:this.view.environment.lighting.autoUpdate(t,a)},_updateRenderParamsHandler:function(){var a=this.view._stage,b=!0;this._referencePosWGS84&&(b=e.computeShadowsEnabled(this._referencePosWGS84,this.view.viewingMode));
a&&a.setRenderParams({shadowMap:this.view.environment.lighting.directShadowsEnabled&&b,ssao:this.view.environment.lighting.ambientOcclusionEnabled})},_spatialReferenceHandler:function(){this._resetReferencePosition()},_viewingModeHandler:function(a){this._resetReferencePosition()},_resetReferencePosition:function(a){this._cancelReferencePosUpdates();this._referencePosWGS84=this._referencePosResetPreserveAbsoluteTime=this._referencePosMapCoordsRequested=this._referencePosMapCoords=null;a||this.notifyChange("updating")},
_requestReferencePositionUpdate:function(a,b){if(this.view.mapCoordsHelper.canProject()&&!this.noReferencePositionQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(a):this._referencePosMapCoordsRequested=a.clone(),this._referencePosResetPreserveAbsoluteTime=!!b,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&!this.view.interacting&&this.view.stationary)){var e=this,r=this._referencePosUpdateQuery=c.after(this.referencePointUpdateDelay).then(function(){if(e._referencePosUpdateQuery===
r)return e._doReferencePositionUpdateQuery(function(){return e._referencePosUpdateQuery!==r})}).always(function(){e._referencePosUpdateQuery===r&&(e._referencePosUpdateQuery=null,e._referencePosUpdateTimer||e._executePendingReferencePositionUpdate(),e.notifyChange("updating"))}),g=this._referencePosUpdateTimer=c.after(this.referencePointUpdateInterval).then(function(){e._referencePosUpdateTimer===g&&(e._referencePosUpdateTimer=null,e._referencePosUpdateQuery||e._executePendingReferencePositionUpdate())});
this.notifyChange("updating")}},_doReferencePositionUpdateQuery:function(a){this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1);this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone();this._referencePosMapCoordsRequested=this._referencePosResetPreserveAbsoluteTime=null;return this.view.mapCoordsHelper.toGeographic(this._referencePosMapCoords).then(function(b){if(!a()&&
!isNaN(b[0])&&!isNaN(b[1])){var c=this._referencePosMapCoords.z*this.view.mapCoordsHelper.unitInMeters;this._referencePosWGS84?(this._referencePosWGS84.x=b[0],this._referencePosWGS84.y=b[1],this._referencePosWGS84.z=c):this._referencePosWGS84=new k({x:b[0],y:b[1],z:c,spatialReference:g.WGS84});this._referencePosChanged()}}.bind(this))},_executePendingReferencePositionUpdate:function(){var a=this._referencePosMapCoordsRequested;a&&this._requestReferencePositionUpdate(a,this._referencePosResetPreserveAbsoluteTime)},
_referencePosChanged:function(){this._preserveAbsoluteDateTime?this._updateLightParams():this._autoUpdateTimezone(this._referencePosWGS84)||this._updateLightParams()},_exceedsReferencePosDistThreshold:function(a){return this._referencePosMapCoords?(a=this._referencePosMapCoords.distance(a),this.view.mapCoordsHelper&&(a*=this.view.mapCoordsHelper.unitInMeters),a>this.referencePointUpdateDistThreshold):!0},_cancelReferencePosUpdates:function(){this._referencePosUpdateTimer=this._referencePosUpdateQuery=
null}});m.FIXED_LIGHT_DIRECTION=x;return m})},"esri/views/3d/support/sunUtils":function(){define(["./mathUtils","../lib/glMatrix","../lib/SunCalc"],function(m,h,d){var c=h.vec3d,a=h.mat4d,b=m.lerp,k=a.identity(),f={azimuth:0,altitude:0},g={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,diffuseAtNoon:.65,diffuseAtTwilight:.7},global:{altitude:8E5,ambient:.015,diffuse:.75},planarDirection:{localAltitude:1E4,globalAltitude:1E6,globalAngles:{azimuth:Math.PI/3,altitude:Math.PI/
3}}},e={ambient:{color:c.create(),intensity:0},diffuse:{color:c.create(),intensity:0,direction:c.create()}},l={settings:g,computeDirection:function(b,e,g,t){t||(t=c.create());var n=a.identity(k);if("global"===g)d.getPosition(b,0,0,f),c.set3(0,0,-1,t),a.rotateX(n,-f.azimuth),a.rotateY(n,-f.altitude);else{var p=l.settings.planarDirection;g=p.globalAngles;p=(e.z-p.localAltitude)/(p.globalAltitude-p.localAltitude);p=m.clamp(p,0,1);1>p?(d.getPosition(b,e.y,e.x,f),f.azimuth=(1-p)*f.azimuth+p*g.azimuth,
f.altitude=(1-p)*f.altitude+p*g.altitude):(f.azimuth=g.azimuth,f.altitude=g.altitude);c.set3(0,-1,0,t);a.rotateZ(n,-f.azimuth);a.rotateX(n,-f.altitude)}a.multiplyVec3(n,t);return t},computeShadowsEnabled:function(a,b){return"global"===b?!0:a.z<l.settings.planarDirection.localAltitude},computeColorAndIntensity:function(a,f){var n,k,q,v=f.z;k=l.settings;c.set3(1,1,1,e.ambient.color);e.ambient.intensity=k.global.ambient;c.set3(1,1,1,e.diffuse.color);e.diffuse.intensity=k.global.diffuse;v=(v-k.local.altitude)/
(k.global.altitude-k.local.altitude);v=m.clamp(v,0,1);e.globalFactor=v;f=d.getTimes(a,f.y,f.x);if(1>v){k=a.valueOf();var r,z;f.polarException===d.POLAR_EXCEPTION.MIDNIGHT_SUN?(r=k-36E5*(a.getHours()+48)-6E4*a.getMinutes(),z=r+432E6):f.polarException===d.POLAR_EXCEPTION.POLAR_NIGHT?(r=k-2,z=k-1):(r=f.sunrise.valueOf(),z=f.sunset.valueOf());var B=z-r;q=r+B/2;var C=B/4;n=q-C;var C=q+C,h=.06*B,B=r-h/2;r+=h/2;var D=z-h/2,E=z+h/2;z=g.local;var H=[.01,z.ambientAtNight],G=[.8,.8,1],J=[.01,.01,.01],I=[z.diffuseAtTwilight,
z.ambientAtTwilight],F=[1,.75,.75],N=[.8,.8,1],L=[.9*z.diffuseAtNoon,z.ambientAtNoon],M=[1,.98,.98],K=[.98,.98,1],ba=[z.diffuseAtNoon,z.ambientAtNoon],X=[1,1,1],T=[1,1,1];z=[0,0];var V=[0,0],h=[0,0];k<B||k>E?(z=H,V=J,h=G):k<r?(h=r-B,z=p(k-B,h,H,I),V=p(k-B,h,J,F),h=p(k-B,h,G,N)):k<n?(h=n-r,z=p(k-r,h,I,L),V=p(k-r,h,F,M),h=p(k-r,h,N,K)):k<q?(h=q-n,z=p(k-n,h,L,ba),V=p(k-n,h,M,X),h=p(k-n,h,K,T)):k<C?(h=C-q,z=p(k-q,h,ba,L),V=p(k-q,h,X,M),h=p(k-q,h,T,K)):k<D?(h=D-C,z=p(k-C,h,L,I),V=p(k-C,h,M,F),h=p(k-C,
h,K,N)):k<E&&(h=E-D,z=p(k-D,h,I,H),V=p(k-D,h,F,J),h=p(k-D,h,N,G));k=z[0];q=V;n=z[1];c.lerp(h,e.ambient.color,v,e.ambient.color);e.ambient.intensity=b(n,e.ambient.intensity,v);c.lerp(q,e.diffuse.color,v,e.diffuse.color);e.diffuse.intensity=b(k,e.diffuse.intensity,v)}v=a.valueOf();f.polarException===d.POLAR_EXCEPTION.MIDNIGHT_SUN?(a=v-36E5*(a.getHours()+48)-6E4*a.getMinutes(),f=a+432E6):f.polarException===d.POLAR_EXCEPTION.POLAR_NIGHT?(a=v-2,f=v-1):(a=f.sunrise.valueOf(),f=f.sunset.valueOf());a=1-m.clamp(Math.abs(v-
(a+(f-a)/2))/432E5,0,1);e.noonFactor=a;return e}},p=function(a,b,c,e){for(var g=[],d=0;d<c.length;d++)g[d]=(e[d]-c[d])*a/b+c[d];return g};return l})},"esri/views/3d/lib/SunCalc":function(){define([],function(){function m(a){return new Date(864E5*(a+.5-2440588))}function h(a,b){return n(l(a)*p(r)-v(b)*l(r),p(a))}function d(a,b){return q(l(b)*p(r)+p(b)*l(r)*l(a))}function c(a,b,c){return n(l(a),p(a)*l(b)-v(c)*p(b))}function a(a,b,c){return q(l(b)*l(c)+p(b)*p(c)*p(a))}function b(a){return u*(1.9148*
l(a)+.02*l(2*a)+3E-4*l(3*a))}function k(a,c){a=u*(357.5291+.98560028*a);var r=b(a);a=a+r+102.9372*u+e;c||(c={dec:0,ra:0});c.dec=d(a,0);c.ra=h(a,0);return c}function f(a,b,c){return 2451545+a+.0053*l(b)-.0069*l(2*c)}function g(a){var b=u*(134.963+13.064993*a),c=u*(93.272+13.22935*a);a=u*(218.316+13.176396*a)+6.289*u*l(b);c=5.128*u*l(c);b=385001-20905*p(b);return{ra:h(a,c),dec:d(a,c),dist:b}}var e=Math.PI,l=Math.sin,p=Math.cos,v=Math.tan,q=Math.asin,n=Math.atan2,t=Math.acos,u=e/180,x={dec:0,ra:0},r=
23.4397*u,z={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(b,e,r,g){r=u*-r;e*=u;var d=b.valueOf()/864E5-.5+2440588-2451545;b=k(d,x);r=u*(280.16+360.9856235*d)-r-b.ra;g||(g={azimuth:0,altitude:0});g.azimuth=c(r,e,b.dec);g.altitude=a(r,e,b.dec);return g}},B=[[-.83,"sunrise","sunset"]];z.addTime=function(a,b,c){B.push([a,b,c])};z.getTimes=function(a,c,r){function g(a){var b=k,c=h;a=t((l(a)-l(b)*l(c))/(p(b)*p(c)));return f(9E-4+(a+n)/(2*e)+q,v,C)}var n=u*-r,k=u*c,q=Math.round(a.valueOf()/
864E5-.5+2440588-2451545-9E-4-n/(2*e));a=9E-4+(0+n)/(2*e)+q;var v=u*(357.5291+.98560028*a);c=b(v);var C=v+c+102.9372*u+e,h=d(C,0);a=f(a,v,C);c={solarNoon:m(a),nadir:m(a-.5),polarException:z.POLAR_EXCEPTION.NORMAL};var x,A,D,ba;r=0;for(x=B.length;r<x;r+=1)A=B[r],D=g(A[0]*u),ba=a-(D-a),c[A[1]]=m(ba),c[A[2]]=m(D);c.polarException=function(a){a=(l(a)-l(k)*l(h))/(p(k)*p(h));return-1>a?z.POLAR_EXCEPTION.MIDNIGHT_SUN:1<a?z.POLAR_EXCEPTION.POLAR_NIGHT:z.POLAR_EXCEPTION.NORMAL}(B[0][0]*u);return c};z.getMoonPosition=
function(b,e,r){r=u*-r;e*=u;var d=b.valueOf()/864E5-.5+2440588-2451545;b=g(d);r=u*(280.16+360.9856235*d)-r-b.ra;d=a(r,e,b.dec);d+=.017*u/v(d+10.26*u/(d+5.1*u));return{azimuth:c(r,e,b.dec),altitude:d,distance:b.dist}};z.getMoonFraction=function(a){var b=a.valueOf()/864E5-.5+2440588-2451545;a=k(b);b=g(b);a=t(l(a.dec)*l(b.dec)+p(a.dec)*p(b.dec)*p(a.ra-b.ra));a=n(149598E3*l(a),b.dist-149598E3*p(a));return(1+p(a))/2};return z})},"esri/views/3d/support/earthUtils":function(){define(["dojo/_base/lang","./mathUtils",
"../../../geometry/Point","../../../geometry/SpatialReference","../../../geometry/support/webMercatorUtils"],function(m,h,d,c,a){var b=6378137*Math.PI,k=new d(0,0,c.WGS84),f={earthRadius:6378137,halfEarthCircumference:b,earthCircumference:2*b,metersPerDegree:b/180,getGreatCircleDistance:function(a,b,c,d){void 0===c&&void 0===d&&m.isObject(a)&&m.isObject(b)&&(c=b.get("longitude"),d=b.get("latitude"),b=a.get("latitude"),a=a.get("longitude"));b=h.deg2rad(b);d=h.deg2rad(d);a=h.deg2rad(a);var e=h.deg2rad(c);
c=Math.sin((b-d)/2);a=Math.sin((a-e)/2);b=12756274*h.asin(Math.sqrt(c*c+Math.cos(b)*Math.cos(d)*a*a));return b=Math.round(1E4*b)/1E4},getGreatCircleSpanAt:function(a,b,c){var e=b.spatialReference,g=new d(b.x,a.y,e),f=new d(c.x,a.y,e);b=new d(a.x,b.y,e);a=new d(a.x,c.y,e);return{lon:this.getGreatCircleDistance(g,f),lat:this.getGreatCircleDistance(b,a)}},getLonDeltaForDistance:function(a,b,c){a=c/6378137;b=h.deg2rad(b);a=Math.sin(a/2);b=Math.cos(b);b=2*h.asin(Math.sqrt(a*a/(b*b)));return h.rad2deg(b)},
getLatDeltaForDistance:function(a,b,c){return h.rad2deg(c/6378137)},getLatLonDeltaForDistance:function(a,b,c){return{lat:this.getLatDeltaForDistance(a,b,c),lon:this.getLonDeltaForDistance(a,b,c)}},getMaxCameraAltitude:function(a){a=h.deg2rad(a/2);return 6378137*(1-Math.sin(a))/Math.sin(a)},getViewExtentDistance:function(a,b){b=h.deg2rad(b/2);return 12756274*h.acos((Math.pow(a+6378137,2)+Math.pow(6378137,2)-Math.pow((a+6378137)*Math.cos(b)-Math.sqrt(Math.pow(Math.cos(b)*(a+6378137),2)-a*a-12756274*
a),2))/(12756274*(a+6378137)))},computeCarthesianDistance:function(a,b){function c(a){var b=h.deg2rad(a.get("latitude")),c=h.deg2rad(a.get("longitude")),e=Math.cos(b);a=6378137+(a.z||0);return[Math.cos(c)*e*a,Math.sin(b)*a,-Math.sin(c)*e*a]}a=c(a);b=c(b);b=[b[0]-a[0],b[1]-a[1],b[2]-a[2]];return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])},longitudeToTimezone:function(a,b){a/=15;b||(a=Math.round(a));return a},positionToTimezone:function(b,e){b.spatialReference.wkid!==c.WGS84.wkid?a.webMercatorToGeographic(b,
!1,k):(k.x=b.x,k.y=b.y);k.z=b.z;e||(e={hours:0,minutes:0,seconds:0});e.hours=f.longitudeToTimezone(k.x,!0);b=e.hours%1;e.hours-=b;e.minutes=60*b;b=e.minutes%1;e.minutes-=b;e.seconds=Math.round(60*b);return e}};return f})},"esri/views/3d/environment/EnvironmentRenderer":function(){define("../../../core/watchUtils ../support/ExternalRenderer ./PanoramicAtmosphere ./RealisticAtmosphere ./SimpleAtmosphere ./Stars ../webgl-engine/lib/RenderSlot".split(" "),function(m,h,d,c,a,b,k){return h.createSubclass({declaredClass:"esri.views.3d.environment.EnvironmentRenderer",
properties:{view:{},viewingMode:{dependsOn:["view.viewingMode"],get:function(){return this.get("view.viewingMode")||"global"}},atmosphereQuality:{dependsOn:["view.environment.atmosphereEnabled","view.environment.atmosphere.quality"],get:function(){return this.get("view.environment.atmosphereEnabled")?this.get("view.environment.atmosphere.quality")||"none":"none"}},starsEnabled:{dependsOn:["view.environment.starsEnabled"],get:function(){return this.get("view.environment.starsEnabled")||!1}},transparent:{dependsOn:["view.basemapTerrain.opacity",
"view.basemapTerrain.wireframe"],get:function(){var a=this.get("view.basemapTerrain");return a&&a._renderer.isTransparent()}},_atmosphere:{},_stars:{},needsRender:{dependsOn:["_stars.needsRender","_atmosphere.needsRender"],get:function(){return!!(this._needsRender||this._atmosphere&&this._atmosphere.needsRender||this._stars&&this._stars.needsRender)}}},constructor:function(){this._STANDARD_SLOT=k.BACKGROUND;this._SPECIAL_SLOT=k.POSTPROCESSING_ATMOSPHERE;this._slots=[this._STANDARD_SLOT,this._SPECIAL_SLOT];
this._stars=this._atmosphere=this._atmosphereReadyPromise=this._AtmosphereClass=null;this._needsRender=!0;this.notifyChange("needsRender")},initialize:function(){this.view._stage.addExternalRenderer(this._slots,this);this._basemapTerrainHandle=m.when(this.view,"basemapTerrain",this._updateBasemapTerrain.bind(this))},destroy:function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null);this._stars&&(this._stars.destroy(),this._stars=null);this._basemapTerrainHandle&&this._basemapTerrainHandle.remove();
this.view&&(this.view._stage.removeExternalRenderer(this),this.view=null)},setup:function(a){this.watch("viewingMode,atmosphereQuality,transparent,visible",this._updateAtmosphere.bind(this));this._updateAtmosphere();this.watch("starsEnabled,transparent,visible",this._updateStars.bind(this));this._updateStars();this.watch("view.basemapTerrain.loaded",function(){this._needsRender=!0;this.notifyChange("needsRender")}.bind(this))},resetNeedsRender:function(){this._atmosphere&&(this._atmosphere.resetNeedsRender?
this._atmosphere.resetNeedsRender():this._atmosphere.didRender&&(this._atmosphere.needsRender=!1,this._atmosphere.didRender=!1));this._stars&&(this._stars.resetNeedsRender?this._stars.resetNeedsRender():this._stars.didRender&&(this._stars.needsRender=!1,this._stars.didRender=!1));this.didRender&&(this.didRender=this._needsRender=!1,this.notifyChange("needsRender"))},render:function(a){if(!this.get("view.basemapTerrain.loaded")&&"global"===this.viewingMode)return!1;if(!this._stars&&!this._atmosphere)return!0;
this._stars&&this._stars.render(a);this._atmosphere&&this._atmosphere.render(a);return this._stars&&this._stars.didRender||this._atmosphere&&this._atmosphere.didRender},_updateStars:function(){var a=this._getAtmosphereSlot();this.starsEnabled&&!this._stars?(this._stars=new b({view:this.view,slot:a}),this._stars.initializeRenderContext(this.renderContext)):!this.starsEnabled&&this._stars?(this._stars.destroy(),this._stars=null):this._stars&&(this._stars.slot=a);this._needsRender=!0;this.notifyChange("needsRender")},
_updateAtmosphere:function(){var a=this._getAtmosphereSlot();this._atmosphere&&(this._atmosphere.slot=a);if(this._updateAtmosphereClass(this.renderContext)){this._needsRender=!0;this.notifyChange("needsRender");var b=function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null)}.bind(this);if(this._AtmosphereClass){this._atmosphereReadyPromise&&(this._atmosphereReadyPromise.cancel(),this._atmosphereReadyPromise=null);var c=new this._AtmosphereClass({view:this.view,slot:a});c.initializeRenderContext(this.renderContext);
this._atmosphere?this._atmosphereReadyPromise=c.then(function(){b();this._atmosphereReadyPromise=null;this._atmosphere=c}.bind(this)):this._atmosphere=c;c.then(function(){this._updateBasemapTerrain()}.bind(this))}else b(),this._updateBasemapTerrain()}},_updateAtmosphereClass:function(b){var g=this._AtmosphereClass;"none"===this.atmosphereQuality?this._AtmosphereClass=null:"high"===this.atmosphereQuality&&!this.transparent&&c.isSupported(b)?this._AtmosphereClass="local"===this.viewingMode?d:c:this._AtmosphereClass=
"local"===this.viewingMode?d:a;return this._AtmosphereClass!==g},_getAtmosphereSlot:function(){return this.transparent&&"global"===this.viewingMode?this._SPECIAL_SLOT:this._STANDARD_SLOT},_updateBasemapTerrain:function(){var a=this.get("view.basemapTerrain");a&&(a.velvetOverground=!(!this._AtmosphereClass||this._AtmosphereClass===c))}})})},"esri/views/3d/support/ExternalRenderer":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Promise dojo/Deferred dojo/aspect dojo/_base/lang".split(" "),
function(m,h,d,c,a,b){return m([h,d],{"-chains-":b.mixin(h._meta.chains,{setup:"after",initializeRenderContext:"after",uninitializeRenderContext:"before"}),properties:{gl:{readOnly:!0,get:function(){return this._gl}},needsRender:{value:!0},visible:{value:!0}},constructor:function(){this.didRender=!1;this.renderContext=null;this.watch("visible",function(){this.needsRender=!0}.bind(this));this._contextDfd=new c},initialize:function(){this.addResolvingPromise(this._contextDfd.promise);a.around(this,
"render",function(a){return function(){return this.isRejected()?this.didRender=!0:this.isResolved()?!this.visible||a.apply(this,arguments)?this.didRender=!0:!1:!1}.bind(this)}.bind(this));this.then(function(){this.destroyed||this.setup(this.renderContext)}.bind(this))},needsRender:!0,visible:!0,initializeRenderContext:function(a){this.renderContext=a;this._contextDfd.resolve()},uninitializeRenderContext:function(a){},setup:function(a){},render:function(a){return!1}})})},"esri/views/3d/environment/PanoramicAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n){var t=c.vec2d,u=c.vec3d,x=c.mat4d,r=f.VertexAttrConstants,z=x.create();return d.createSubclass({declaredClass:"esri.views.3d.environment.PanoramicAtmosphere",properties:{view:{},needsRender:{value:!1},slot:{value:l.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:t.create(),silCircleCenter:u.create(),silCircleV1:u.create(),silCircleV2:u.create()};this._textureRep=this._texture=null;this.slot=
l.BACKGROUND},initialize:function(){this._textureDfd=new h;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),this._textureDfd=null)},initializeRenderContext:function(a){this._textureRep=new g({SimpleAtmosphere:new k(p,
"SimpleAtmosphere",{wrapClamp:!0})},a.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),a.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(b){var c=this._createGeometryData(),r=this.renderContext.rctx;this._renderer=new a(c,q.Pos3,null,r);b.shaderSnippets.vsSimpleAtmosphere||b.shaderSnippets._parse(m);this._program=new v(r,
b.shaderSnippets.vsSimpleAtmosphere,b.shaderSnippets.fsSimpleAtmosphere,n.Default3D,["PANORAMIC"])},render:function(a){if(a.slot!==this.slot||a.pass!==e.MATERIAL||!this._textureRep.getIsLoaded("SimpleAtmosphere"))return!1;var b=this.renderContext.rctx,c=b.gl,r=this._program;b.bindProgram(r);b.bindTexture(this._texture);r.setUniform1i("tex",0);r.setUniformMatrix4fv("proj",a.camera.projectionMatrix);x.toRotationMat(a.camera.viewMatrix,z);r.setUniformMatrix4fv("view",z);r.setUniform4f("color",1,1,1,
1);r.setUniform3fv("lightDirection",a.lightingData.direction);b.setFaceCullingEnabled(!0);b.setDepthFunction(c.LEQUAL);b.setBlendingEnabled(!0);b.setDepthWriteEnabled(!1);this._renderer.render(this._program);b.setDepthWriteEnabled(!0);b.setBlendingEnabled(!1);b.setDepthFunction(c.LESS);b.setFaceCullingEnabled(!1);return!0},_createGeometryData:function(){for(var a=b.createPolySphereGeometry(1,2),c=a.getFaces(),e=c[0].indices[r.POSITION],d=0;d<e.length;d+=3){var g=e[d];e[d]=e[d+2];e[d+2]=g}a=a.getVertexAttr();
e=a[r.NORMAL].data;for(d=0;d<e.length;d++)e[d]=-e[d];return{faces:c[0],vertexAttr:a}}})})},"esri/views/3d/webgl-engine/lib/GeometryRenderer":function(){define("require exports ../materials/internal/MaterialUtil ./DefaultVertexAttributeLocations ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums".split(" "),function(m,h,d,c,a,b,k,f){return function(){function g(e,g,f,v){this._drawMode=4;this._layout=g;var l=e.faces;this._count=l.indices[l.positionKey].length;
l=new Float32Array(this._count*k.getStride(g)/4);f?f(e,void 0,void 0,null,g,l,0):d.fillInterleaved(e,void 0,void 0,null,g,l,0);this._rctx=v;this._vao=new a(v,c.Default3D,{geometry:g},{geometry:b.createVertex(v,35044,l)})}g.prototype.enablePointRendering=function(a){this._drawMode=a?0:4};g.prototype.render=function(a){var b=this._rctx;b.bindVAO(this._vao);k.assertCompatibleVertexAttributeLocations(this._vao,a);b.drawArrays(this._drawMode,0,this._count)};return g}()})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("require exports ../../lib/IdGen ../../lib/gl-matrix ../../lib/ComponentUtils ../../lib/Util ../../parts/Model ../../lib/screenSizePerspectiveUtils ../../../../webgl/Util ../../../support/aaBoundingBox".split(" "),
function(m,h,d,c,a,b,k,f,g,e){function l(a,b,c,r,e,d){if(void 0===e||3!==d)for(e=0;e<d;++e)c[r+e]=a[b+e];else{var g=a[b],f=a[b+1];a=a[b+2];c[r]=e[0]*g+e[4]*f+e[8]*a+e[12];c[r+1]=e[1]*g+e[5]*f+e[9]*a+e[13];c[r+2]=e[2]*g+e[6]*f+e[10]*a+e[14]}return d}function p(a,b,c,e,r,d){for(var g=a.length,f=0;f<g;++f){for(var l=c*a[f],n=0;n<c;++n)e[r+n]=b[l+n];r+=d}}function v(a,b,c,e,r,d){e=new Uint8Array(e.buffer);r*=4;d*=4;var g=a.length;if(4===c)for(c=0;c<g;++c){var f=4*a[c];e[r]=b[f];e[r+1]=b[f+1];e[r+2]=b[f+
2];e[r+3]=b[f+3];r+=d}else if(3===c)for(c=0;c<g;++c)f=3*a[c],e[r]=b[f],e[r+1]=b[f+1],e[r+2]=b[f+2],e[r+3]=255,r+=d}function q(a,b,c,r,d){var g=t(b,c,E);e.setMin(A,a.getBBMin());e.setMax(A,a.getBBMax());if(u(A,b,g,r)){var g=a.getPrimitiveIndices(),f=a.getIndices(),l=a.getPosition(),k=g?g.length:f.length/3;if(1E4<k&&(a=a.getChildren(),void 0!==a)){for(g=0;8>g;++g)void 0!==a[g]&&q(a[g],b,c,r,d);return}n(b,c,0,k,f,l,g,d)}}function n(a,b,e,r,d,g,f,l){var n=g.data;g=g.size;var k=a[0],p=a[1];a=a[2];var t=
b[0]-k,z=b[1]-p;for(b=b[2]-a;e<r;e++){var q=f?f[e]:e,B=g*d[3*q],u=g*d[3*q+1],v=g*d[3*q+2],h=n[B],C=n[B+1],x=n[B+2],B=n[u]-h,A=n[u+1]-C,u=n[u+2]-x,D=n[v]-h,E=n[v+1]-C,v=n[v+2]-x,m=z*v-E*b,L=b*D-v*t,F=t*E-D*z,w=B*m+A*L+u*F,h=k-h,N=p-C,M=a-x,C=N*u-A*M,x=M*B-u*h,K=h*A-B*N;if(w>H){m=h*m+N*L+M*F;if(0>m||m>w)continue;L=t*C+z*x+b*K;if(0>L||m+L>w)continue}else if(w<-H){m=h*m+N*L+M*F;if(0<m||m<w)continue;L=t*C+z*x+b*K;if(0<L||m+L<w)continue}else continue;w=(D*C+E*x+v*K)/w;0<=w&&(m=G,c.vec3d.set3(B,A,u,J),c.vec3d.set3(D,
E,v,I),B=c.vec3d.normalize(c.vec3d.cross(J,I,m)),l(w,B,q))}}function t(a,b,e){return c.vec3d.set3(1/(b[0]-a[0]),1/(b[1]-a[1]),1/(b[2]-a[2]),e)}function u(a,b,c,e){var r=(a[0]-e-b[0])*c[0],d=(a[3]+e-b[0])*c[0],g=Math.min(r,d),r=Math.max(r,d),d=(a[1]-e-b[1])*c[1],f=(a[4]+e-b[1])*c[1],g=Math.max(g,Math.min(d,f)),r=Math.min(r,Math.max(d,f));if(g>r)return!1;d=(a[2]-e-b[2])*c[2];a=(a[5]+e-b[2])*c[2];g=Math.max(g,Math.min(d,a));r=Math.min(r,Math.max(d,a));return g<=r}function x(a,b,c,e){if(void 0!==a)return c.aquire(a,
b,e)}function r(a,b){void 0!==a&&b.release(a)}function z(a,b){b=b?z(b):{};for(var c in a){var e=a[c];e&&e.forEach&&(e=B(e));null==e&&c in b||(b[c]=e)}return b}function B(a){var b=[];a.forEach(function(a){return b.push(a)});return b}Object.defineProperty(h,"__esModule",{value:!0});var C=c.mat4d.create(),A=e.create(),D=b.VertexAttrConstants;h.__Material_idGen=new d;h.__GLMaterial_id=0;h.IDENTITY=c.mat4d.identity();h.fill=l;h.fillInterleaved=function(a,b,c,e,r,d,f,l){for(var n=g.getStride(r)/4,k=0;k<
r.length;k++){var t=r[k],z=f+t.offset/4,t=t.name,q=a.vertexAttr[t];if(null!=q&&(null==l||null!=l[t]))switch(t){case "uv0":p(a.faces.indices[t],q.data,q.size,d,z,n);break;case "region":for(var t=a.faces.indices[t],B=q.data,u=q.size,q=d,h=n,q=new Uint16Array(q.buffer),z=2*z,h=2*h,C=t.length,x=0;x<C;++x){for(var A=u*t[x],E=0;E<u;++E)q[z+E]=B[A+E];z+=h}break;case "color":if(e&&e.color)if(t=a.faces.indices[t],B=q.data,u=e.color,x=q.size,q=d,h=n,q=new Uint8Array(q.buffer),z*=4,h*=4,C=t.length,4===x)for(x=
0;x<C;++x)A=4*t[x],q[z]=B[A]*u[0],q[z+1]=B[A+1]*u[1],q[z+2]=B[A+2]*u[2],q[z+3]=B[A+3]*u[3],z+=h;else{if(3===x)for(E=255*u[3],x=0;x<C;++x)A=3*t[x],q[z]=B[A]*u[0],q[z+1]=B[A+1]*u[1],q[z+2]=B[A+2]*u[2],q[z+3]=E,z+=h}else v(a.faces.indices[t],q.data,q.size,d,z,n);break;case "symbolColor":v(a.faces.indices[t],q.data,q.size,d,z,n);break;default:if(u=t===D.POSITION?b:t===D.NORMAL?c:void 0,void 0!==u&&3===q.size)for(t=a.faces.indices[t],B=q.data,q=d,h=n,C=t.length,x=0;x<C;++x){var H=3*t[x],A=B[H],E=B[H+1],
H=B[H+2];q[z]=u[0]*A+u[4]*E+u[8]*H+u[12];q[z+1]=u[1]*A+u[5]*E+u[9]*H+u[13];q[z+2]=u[2]*A+u[6]*E+u[10]*H+u[14];z+=h}else p(a.faces.indices[t],q.data,q.size,d,z,n)}}};h.triangleVertexArrayToWireframeLines=function(a,b,c,e){for(c=Math.floor(c/3)-1;0<=c;c--){var r=b+3*c*e,d=b+6*c*e+5*e;l(a,r,a,d,null,e);d-=e;l(a,r+e,a,d,null,e);d-=e;l(a,r+e,a,d,null,e);d-=e;l(a,r+2*e,a,d,null,e);d-=e;l(a,r+2*e,a,d,null,e);d-=e;l(a,r,a,d,null,e)}};h.intersectTriangleGeometry=function(c,r,d,g,f,l,k){b.assert("triangle"===
c.data.primitiveType);r=r.componentVisibilities;g=g.tolerance;var p=c.getBoundingInfo(0);if(1<c.getComponentCount()){if(d=t(f,l,E),e.setMin(A,p.getBBMin()),e.setMax(A,p.getBBMax()),u(A,f,d,g))for(var p=c.getComponentCount(),z=c.data.faces[0],B=z.indices[z.positionKey],z=c.data.vertexAttributes[z.positionKey],v=c.data.componentOffsets,h=0;h<p;h++)if(a.getVisibility(r,h)){var C=c.getComponentAABB(h,A);u(C,f,d,g)&&n(f,l,v[h]/3,v[h+1]/3,B,z,void 0,k)}}else a.getVisibility(r,0)&&q(p,f,l,g,k)};var E=c.vec3d.create(),
H=Math.pow(2,-52),G=c.vec3d.create(),J=c.vec3d.create(),I=c.vec3d.create();h.transformToWorld=function(a,b,e){return c.vec4d.set4(a[0]-b[0],a[1]-b[1],a[2]-b[2],1,e)};h.transformToView=function(a,b,e,r){c.mat4d.translate(e,b,C);e=C;return c.mat4d.multiplyVec4(e,a,r)};h.transformToProjection=function(a,b,e,r){r[0]=a[0]+e[0];r[1]=a[1]+e[1];r[2]=a[2]+e[2];r[3]=a[3];return c.mat4d.multiplyVec4(b,r)};h.transformToNDC=function(a,b){return c.vec4d.scale(a,1/Math.abs(a[3]),b)};h.applyScreenSizePerspectiveScale=
function(a,b,c,e,r){return f.scale(a,e,c,r)};h.verticalOffsetAtDistance=function(a,c,e,r,d){var g=e.screenLength||0;d&&(g=f.scale(g,r,c,d));return b.clamp(g*Math.tan(.5*a.fovY)/(.5*a.fullHeight)*c,e.minWorldLength||0,null!=e.maxWorldLength?e.maxWorldLength:Infinity)};h.basicMaterialConstructor=function(a,c){var e=!0,r=0,d=h.__Material_idGen.gen(c);a.getId=function(){return d};var g;a.getParentStage=function(){return g};a.addParentStage=function(a){b.assert(void 0===g,"Material can only be added to a single Stage");
g=a};a.removeParentStage=function(a){g=void 0};a.setVisible=function(b){e!==b&&(e=b,a.notifyDirty("matChanged"))};a.isVisible=function(){return e};a.notifyDirty=function(b){g&&g.notifyDirty(k.ContentType.MATERIAL,a,b)};a.setRenderPriority=function(a){r=a;this.notifyDirty("matChanged")};a.getRenderPriority=function(){return r}};h.aquireIfNotUndefined=x;h.releaseIfNotUndefined=r;var F=c.mat4.create();h.bindView=function(a,b,e){c.mat4d.translate(b,a,F);e.setUniform3fv("localOrigin",a);e.setUniformMatrix4fv("view",
F)};h.bindCamPos=function(a,b,c){c.setUniform3f("camPos",b[3]-a[0],b[7]-a[1],b[11]-a[2])};h.bindVerticalOffset=function(a,b,c){if(a){var e=b.fovY;b=b.viewport[3];var r=void 0;void 0===r&&(r=N);r.screenLength=a.screenLength;r.perDistance=Math.tan(.5*e)/(.5*b);r.minWorldLength=a.minWorldLength;r.maxWorldLength=a.maxWorldLength;a=r;c.setUniform4f("verticalOffset",a.screenLength,a.perDistance,a.minWorldLength,a.maxWorldLength)}};h.bindScreenSizePerspective=function(a,b,c){void 0===c&&(c="screenSizePerspectiveAlignment");
if(a){var e=a.parameters;b.setUniform4f(c,e.divisor,e.offset,e.minPixelSize,a.paddingPixelsOverride)}};h.basicGLMaterialConstructor=function(a,b){var c=h.__GLMaterial_id++;a.getId=function(){return c};a.getMaterialId=function(){return b.getId()};a.isVisible=function(){return b.isVisible()};a.getRenderPriority=function(){return b.getRenderPriority()}};h.singleTextureGLMaterialConstructor=function(a,b,c,e){var d=x(c.textureId,c.initTexture,b,e);a.updateTexture=function(a){c.textureId!==a&&(r(c.textureId,
b),c.textureId=a,d=x(c.textureId,c.initTexture,b,e))};a.renderTexture=function(a){(a=b.getTexture(c.textureId))&&a.dirty&&a.redraw&&a.redraw()};a.bindTexture=function(a,b){void 0!==d&&(b.setUniform1i("tex",0),a.bindTexture(d.getGLTexture()))};a.bindTextureSize=function(a,b){void 0!==d&&(a=d.getGLTexture(),b.setUniform2f("texSize",a.descriptor.width,a.descriptor.height))};a.dispose=function(){r(c.textureId,b)}};h.multiTextureGLMaterialConstructor=function(a,b,c,e){for(var d=e.length,g=Array(d),f=0;f<
d;f++)g[f]=x(c[e[f][0]],c[e[f][1]],b);a.updateTextures=function(a){for(var f=0;f<d;f++){var l=c[e[f][0]],n=a[e[f][0]];l!==n&&(r(l,b),c[e[f][0]]=n,g[f]=x(n,c[e[f][1]],b))}};a.bindTextures=function(a,b){for(var c=0;c<d;c++)void 0!==g[c]&&(b.setUniform1i(e[c][2],c),a.bindTexture(g[c].getGLTexture(),c));a.setActiveTexture(0)};a.bindOneTexture=function(a,b,c){b.setUniform1i(e[c][2],c);a.bindTexture(g[c].getGLTexture(),c);a.setActiveTexture(0)};a.disposeTextures=function(){for(var a=0;a<d;a++)r(c[e[a][0]],
b)}};h.copyParameters=z;h.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};var N={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(m,h){return function(){function d(){this._count=0}d.prototype.gen=function(c){null==c&&(c="a");return c+"_"+this._count++};return d}()})},"esri/views/3d/webgl-engine/lib/gl-matrix":function(){define([],function(){var m={};(function(h,d){d(h,!0);d(h,!1)})(m,function(h,
d){var c={};(function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),b=new Int32Array(a.buffer);c.invsqrt=function(c){a[0]=c;b[0]=1597463007-(b[0]>>1);var e=a[0];return e*(1.5-.5*c*e*e)}}else c.invsqrt=function(a){return 1/Math.sqrt(a)}})();var a=Array;"undefined"!=typeof Float32Array&&(a=d?Float32Array:Array);var b={create:function(b){var c=new a(3);b?(c[0]=b[0],c[1]=b[1],c[2]=b[2]):c[0]=c[1]=c[2]=0;return c},createFrom:function(b,c,e){var r=new a(3);r[0]=b;r[1]=c;r[2]=e;return r},
set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},set3:function(a,b,c,e){e[0]=a;e[1]=b;e[2]=c;return e},add:function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,b,c){if(!c||a===c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},multiply:function(a,b,c){if(!c||a===c)return a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a;c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];
return c},max:function(a,b,c){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=Math.max(a[2],b[2]);return c},min:function(a,b,c){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],e=a[1];a=a[2];var d=Math.sqrt(c*c+e*e+a*a);if(!d)return b[0]=
0,b[1]=0,b[2]=0,b;if(1===d)return b[0]=c,b[1]=e,b[2]=a,b;d=1/d;b[0]=c*d;b[1]=e*d;b[2]=a*d;return b},cross:function(a,b,c){c||(c=a);var e=a[0],d=a[1];a=a[2];var r=b[0],g=b[1];b=b[2];c[0]=d*b-a*g;c[1]=a*r-e*b;c[2]=e*g-d*r;return c},length:function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)},length2:function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var e=a[0]-b[0],d=a[1]-b[1];a=a[2]-b[2];
b=Math.sqrt(e*e+d*d+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=e*b;c[1]=d*b;c[2]=a*b;return c},lerp:function(a,b,c,e){e||(e=a);e[0]=a[0]+c*(b[0]-a[0]);e[1]=a[1]+c*(b[1]-a[1]);e[2]=a[2]+c*(b[2]-a[2]);return e},dist:function(a,b){var c=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+e*e+a*a)},dist2:function(a,b){var c=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];return c*c+e*e+a*a}},k=null,f=new a(4);b.unproject=function(a,b,c,e,d){d||(d=a);k||(k=n.create());var g=k;f[0]=2*(a[0]-e[0])/e[2]-1;f[1]=
2*(a[1]-e[1])/e[3]-1;f[2]=2*a[2]-1;f[3]=1;n.multiply(c,b,g);if(!n.inverse(g))return null;n.multiplyVec4(g,f);if(0===f[3])return null;d[0]=f[0]/f[3];d[1]=f[1]/f[3];d[2]=f[2]/f[3];return d};var g=b.createFrom(1,0,0),e=b.createFrom(0,1,0),l=b.createFrom(0,0,1);b.rotationTo=function(a,c,d){d||(d=t.create());var r=b.dot(a,c),f=b.create();if(1<=r)t.set(u,d);else if(-.999999>r)b.cross(g,a,f),1E-6>f.length&&b.cross(e,a,f),1E-6>f.length&&b.cross(l,a,f),b.normalize(f),t.fromAxisAngle(f,Math.PI,d);else{var r=
Math.sqrt(2*(1+r)),n=1/r;b.cross(a,c,f);d[0]=f[0]*n;d[1]=f[1]*n;d[2]=f[2]*n;d[3]=.5*r;t.normalize(d)}1<d[3]?d[3]=1:-1>d[3]&&(d[3]=-1);return d};var p=b.create(),v=b.create();b.project=function(a,c,e,d){d||(d=a);b.direction(c,e,p);b.subtract(a,c,v);a=b.dot(p,v);b.scale(p,a,d);b.add(d,c,d)};b.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var q={create:function(b){var c=new a(9);b?(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[4]=b[4],c[5]=b[5],c[6]=b[6],c[7]=b[7],c[8]=b[8]):c[0]=c[1]=c[2]=c[3]=
c[4]=c[5]=c[6]=c[7]=c[8]=0;return c},createFrom:function(b,c,e,d,g,f,l,n,k){var r=new a(9);r[0]=b;r[1]=c;r[2]=e;r[3]=d;r[4]=g;r[5]=f;r[6]=l;r[7]=n;r[8]=k;return r},determinant:function(a){var b=a[3],c=a[4],e=a[5],d=a[6],g=a[7],r=a[8];return a[0]*(r*c-e*g)+a[1]*(-r*b+e*d)+a[2]*(g*b-c*d)},inverse:function(a,b){var c=a[0],e=a[1],d=a[2],g=a[3],r=a[4],f=a[5],l=a[6],n=a[7];a=a[8];var k=a*r-f*n,t=-a*g+f*l,p=n*g-r*l,z=c*k+e*t+d*p;if(!z)return null;z=1/z;b||(b=q.create());b[0]=k*z;b[1]=(-a*e+d*n)*z;b[2]=(f*
e-d*r)*z;b[3]=t*z;b[4]=(a*c-d*l)*z;b[5]=(-f*c+d*g)*z;b[6]=p*z;b[7]=(-n*c+e*l)*z;b[8]=(r*c-e*g)*z;return b},multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],g=a[2],r=a[3],f=a[4],l=a[5],n=a[6],k=a[7];a=a[8];var t=b[0],p=b[1],q=b[2],z=b[3],u=b[4],v=b[5],B=b[6],h=b[7];b=b[8];c[0]=t*e+p*r+q*n;c[1]=t*d+p*f+q*k;c[2]=t*g+p*l+q*a;c[3]=z*e+u*r+v*n;c[4]=z*d+u*f+v*k;c[5]=z*g+u*l+v*a;c[6]=B*e+h*r+b*n;c[7]=B*d+h*f+b*k;c[8]=B*g+h*l+b*a;return c},multiplyVec2:function(a,b,c){c||(c=b);var e=b[0];b=b[1];c[0]=e*
a[0]+b*a[3]+a[6];c[1]=e*a[1]+b*a[4]+a[7];return c},multiplyVec3:function(a,b,c){c||(c=b);var e=b[0],d=b[1];b=b[2];c[0]=e*a[0]+d*a[3]+b*a[6];c[1]=e*a[1]+d*a[4]+b*a[7];c[2]=e*a[2]+d*a[5]+b*a[8];return c},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a||(a=q.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a===b){b=a[1];var c=a[2],e=a[5];a[1]=a[3];
a[2]=a[6];a[3]=b;a[5]=a[7];a[6]=c;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,b){b||(b=n.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},n={create:function(b){var c=new a(16);4===
arguments.length?(c[0]=arguments[0],c[1]=arguments[1],c[2]=arguments[2],c[3]=arguments[3],c[4]=arguments[4],c[5]=arguments[5],c[6]=arguments[6],c[7]=arguments[7],c[8]=arguments[8],c[9]=arguments[9],c[10]=arguments[10],c[11]=arguments[11],c[12]=arguments[12],c[13]=arguments[13],c[14]=arguments[14],c[15]=arguments[15]):b&&(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[4]=b[4],c[5]=b[5],c[6]=b[6],c[7]=b[7],c[8]=b[8],c[9]=b[9],c[10]=b[10],c[11]=b[11],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]);return c},
createFrom:function(b,c,e,d,g,f,l,n,k,t,p,q,u,v,h,x){var r=new a(16);r[0]=b;r[1]=c;r[2]=e;r[3]=d;r[4]=g;r[5]=f;r[6]=l;r[7]=n;r[8]=k;r[9]=t;r[10]=p;r[11]=q;r[12]=u;r[13]=v;r[14]=h;r[15]=x;return r},createFromMatrixRowMajor:function(b){var c=new a(16);c[0]=b[0];c[4]=b[1];c[8]=b[2];c[12]=b[3];c[1]=b[4];c[5]=b[5];c[9]=b[6];c[13]=b[7];c[2]=b[8];c[6]=b[9];c[10]=b[10];c[14]=b[11];c[3]=b[12];c[7]=b[13];c[11]=b[14];c[15]=b[15];return c},createFromMatrix:function(b){var c=new a(16);c[0]=b[0];c[1]=b[1];c[2]=
b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];c[6]=b[6];c[7]=b[7];c[8]=b[8];c[9]=b[9];c[10]=b[10];c[11]=b[11];c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},setRowMajor:function(a,b){b[0]=a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=a[10];b[14]=
a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},identity:function(a){a||(a=n.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a===b){b=a[1];var c=a[2],e=a[3],d=a[6],g=a[7],f=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=b;a[6]=a[9];a[7]=a[13];a[8]=c;a[9]=d;a[11]=a[14];a[12]=e;a[13]=g;a[14]=f;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];
b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],e=a[2],d=a[3],g=a[4],f=a[5],r=a[6],l=a[7],n=a[8],k=a[9],t=a[10],p=a[11],q=a[12],u=a[13],v=a[14];a=a[15];return q*k*r*d-n*u*r*d-q*f*t*d+g*u*t*d+n*f*v*d-g*k*v*d-q*k*e*l+n*u*e*l+q*c*t*l-b*u*t*l-n*c*v*l+b*k*v*l+q*f*e*p-g*u*e*p-q*c*r*p+b*u*r*p+g*c*v*p-b*f*v*p-n*f*e*a+g*k*e*a+n*c*r*a-b*k*r*a-g*c*t*a+b*f*t*a},inverse:function(a,b){b||(b=a);var c=a[0],e=
a[1],d=a[2],g=a[3],f=a[4],l=a[5],r=a[6],n=a[7],k=a[8],t=a[9],p=a[10],q=a[11],z=a[12],u=a[13],v=a[14];a=a[15];var h=c*l-e*f,x=c*r-d*f,m=c*n-g*f,P=e*r-d*l,W=e*n-g*l,U=d*n-g*r,Y=k*u-t*z,S=k*v-p*z,ca=k*a-q*z,ga=t*v-p*u,ea=t*a-q*u,aa=p*a-q*v,R=h*aa-x*ea+m*ga+P*ca-W*S+U*Y;if(!R)return null;R=1/R;b[0]=(l*aa-r*ea+n*ga)*R;b[1]=(-e*aa+d*ea-g*ga)*R;b[2]=(u*U-v*W+a*P)*R;b[3]=(-t*U+p*W-q*P)*R;b[4]=(-f*aa+r*ca-n*S)*R;b[5]=(c*aa-d*ca+g*S)*R;b[6]=(-z*U+v*m-a*x)*R;b[7]=(k*U-p*m+q*x)*R;b[8]=(f*ea-l*ca+n*Y)*R;b[9]=
(-c*ea+e*ca-g*Y)*R;b[10]=(z*W-u*m+a*h)*R;b[11]=(-k*W+t*m-q*h)*R;b[12]=(-f*ga+l*S-r*Y)*R;b[13]=(c*ga-e*S+d*Y)*R;b[14]=(-z*P+u*x-v*h)*R;b[15]=(k*P-t*x+p*h)*R;return b},toRotationMat:function(a,b){b||(b=n.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},toMat3:function(a,b){b||(b=q.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=
a[10];return b},toInverseMat3:function(a,b){var c=a[0],e=a[1],d=a[2],g=a[4],f=a[5],l=a[6],r=a[8],n=a[9];a=a[10];var k=a*f-l*n,t=-a*g+l*r,p=n*g-f*r,u=c*k+e*t+d*p;if(!u)return null;u=1/u;b||(b=q.create());b[0]=k*u;b[1]=(-a*e+d*n)*u;b[2]=(l*e-d*f)*u;b[3]=t*u;b[4]=(a*c-d*r)*u;b[5]=(-l*c+d*g)*u;b[6]=p*u;b[7]=(-n*c+e*r)*u;b[8]=(f*c-e*g)*u;return b},multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],g=a[2],f=a[3],l=a[4],n=a[5],r=a[6],k=a[7],t=a[8],p=a[9],q=a[10],u=a[11],v=a[12],z=a[13],B=a[14];a=a[15];
var h=b[0],x=b[1],m=b[2],W=b[3],U=b[4],Y=b[5],S=b[6],ca=b[7],ga=b[8],ea=b[9],aa=b[10],R=b[11],da=b[12],fa=b[13],la=b[14];b=b[15];c[0]=h*e+x*l+m*t+W*v;c[1]=h*d+x*n+m*p+W*z;c[2]=h*g+x*r+m*q+W*B;c[3]=h*f+x*k+m*u+W*a;c[4]=U*e+Y*l+S*t+ca*v;c[5]=U*d+Y*n+S*p+ca*z;c[6]=U*g+Y*r+S*q+ca*B;c[7]=U*f+Y*k+S*u+ca*a;c[8]=ga*e+ea*l+aa*t+R*v;c[9]=ga*d+ea*n+aa*p+R*z;c[10]=ga*g+ea*r+aa*q+R*B;c[11]=ga*f+ea*k+aa*u+R*a;c[12]=da*e+fa*l+la*t+b*v;c[13]=da*d+fa*n+la*p+b*z;c[14]=da*g+fa*r+la*q+b*B;c[15]=da*f+fa*k+la*u+b*a;return c},
multiplyVec3:function(a,b,c){c||(c=b);var e=b[0],d=b[1];b=b[2];c[0]=a[0]*e+a[4]*d+a[8]*b+a[12];c[1]=a[1]*e+a[5]*d+a[9]*b+a[13];c[2]=a[2]*e+a[6]*d+a[10]*b+a[14];return c},multiplyVec4:function(a,b,c){c||(c=b);var e=b[0],d=b[1],g=b[2];b=b[3];c[0]=a[0]*e+a[4]*d+a[8]*g+a[12]*b;c[1]=a[1]*e+a[5]*d+a[9]*g+a[13]*b;c[2]=a[2]*e+a[6]*d+a[10]*g+a[14]*b;c[3]=a[3]*e+a[7]*d+a[11]*g+a[15]*b;return c},translate:function(a,b,c){var e=b[0],d=b[1];b=b[2];var g,f,l,n,k,r,t,p,q,u,v,z;if(!c||a===c)return a[12]=a[0]*e+a[4]*
d+a[8]*b+a[12],a[13]=a[1]*e+a[5]*d+a[9]*b+a[13],a[14]=a[2]*e+a[6]*d+a[10]*b+a[14],a[15]=a[3]*e+a[7]*d+a[11]*b+a[15],a;g=a[0];f=a[1];l=a[2];n=a[3];k=a[4];r=a[5];t=a[6];p=a[7];q=a[8];u=a[9];v=a[10];z=a[11];c[0]=g;c[1]=f;c[2]=l;c[3]=n;c[4]=k;c[5]=r;c[6]=t;c[7]=p;c[8]=q;c[9]=u;c[10]=v;c[11]=z;c[12]=g*e+k*d+q*b+a[12];c[13]=f*e+r*d+u*b+a[13];c[14]=l*e+t*d+v*b+a[14];c[15]=n*e+p*d+z*b+a[15];return c},scale:function(a,b,c){var e=b[0],d=b[1];b=b[2];if(!c||a===c)return a[0]*=e,a[1]*=e,a[2]*=e,a[3]*=e,a[4]*=
d,a[5]*=d,a[6]*=d,a[7]*=d,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*e;c[1]=a[1]*e;c[2]=a[2]*e;c[3]=a[3]*e;c[4]=a[4]*d;c[5]=a[5]*d;c[6]=a[6]*d;c[7]=a[7]*d;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},maxScale:function(a){return Math.max(Math.max(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))},rotate:function(a,b,c,e){var d=c[0],g=c[1];c=c[2];var f=Math.sqrt(d*
d+g*g+c*c),l,n,k,r,t,p,q,u,v,z,h,B,x,C,m,U,Y,S,ca,ga;if(!f)return null;1!==f&&(f=1/f,d*=f,g*=f,c*=f);l=Math.sin(b);n=Math.cos(b);k=1-n;b=a[0];f=a[1];r=a[2];t=a[3];p=a[4];q=a[5];u=a[6];v=a[7];z=a[8];h=a[9];B=a[10];x=a[11];C=d*d*k+n;m=g*d*k+c*l;U=c*d*k-g*l;Y=d*g*k-c*l;S=g*g*k+n;ca=c*g*k+d*l;ga=d*c*k+g*l;d=g*c*k-d*l;g=c*c*k+n;e?a!==e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a;e[0]=b*C+p*m+z*U;e[1]=f*C+q*m+h*U;e[2]=r*C+u*m+B*U;e[3]=t*C+v*m+x*U;e[4]=b*Y+p*S+z*ca;e[5]=f*Y+q*S+h*ca;e[6]=r*Y+
u*S+B*ca;e[7]=t*Y+v*S+x*ca;e[8]=b*ga+p*d+z*g;e[9]=f*ga+q*d+h*g;e[10]=r*ga+u*d+B*g;e[11]=t*ga+v*d+x*g;return e},rotateX:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=a[4],g=a[5],f=a[6],l=a[7],n=a[8],k=a[9],r=a[10],t=a[11];c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=d*b+n*e;c[5]=g*b+k*e;c[6]=f*b+r*e;c[7]=l*b+t*e;c[8]=d*-e+n*b;c[9]=g*-e+k*b;c[10]=f*-e+r*b;c[11]=l*-e+t*b;return c},rotateY:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);
var d=a[0],g=a[1],f=a[2],l=a[3],n=a[8],k=a[9],r=a[10],t=a[11];c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=d*b+n*-e;c[1]=g*b+k*-e;c[2]=f*b+r*-e;c[3]=l*b+t*-e;c[8]=d*e+n*b;c[9]=g*e+k*b;c[10]=f*e+r*b;c[11]=l*e+t*b;return c},rotateZ:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=a[0],g=a[1],f=a[2],l=a[3],n=a[4],k=a[5],t=a[6],r=a[7];c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):
c=a;c[0]=d*b+n*e;c[1]=g*b+k*e;c[2]=f*b+t*e;c[3]=l*b+r*e;c[4]=d*-e+n*b;c[5]=g*-e+k*b;c[6]=f*-e+t*b;c[7]=l*-e+r*b;return c},frustum:function(a,b,c,e,d,g,f){f||(f=n.create());var l=b-a,k=e-c,t=g-d;f[0]=2*d/l;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*d/k;f[6]=0;f[7]=0;f[8]=(b+a)/l;f[9]=(e+c)/k;f[10]=-(g+d)/t;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(g*d*2)/t;f[15]=0;return f},perspective:function(a,b,c,e,d){a=c*Math.tan(a*Math.PI/360);b*=a;return n.frustum(-b,b,-a,a,c,e,d)},ortho:function(a,b,c,e,d,g,f){f||(f=n.create());
var l=b-a,k=e-c,t=g-d;f[0]=2/l;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/k;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/t;f[11]=0;f[12]=-(a+b)/l;f[13]=-(e+c)/k;f[14]=-(g+d)/t;f[15]=1;return f},lookAt:function(a,b,c,e){e||(e=n.create());var d,g,f,l,k,t,p,r,q=a[0],u=a[1];a=a[2];f=c[0];l=c[1];g=c[2];p=b[0];c=b[1];d=b[2];if(q===p&&u===c&&a===d)return n.identity(e);b=q-p;c=u-c;p=a-d;r=1/Math.sqrt(b*b+c*c+p*p);b*=r;c*=r;p*=r;d=l*p-g*c;g=g*b-f*p;f=f*c-l*b;(r=Math.sqrt(d*d+g*g+f*f))?(r=1/r,d*=r,g*=r,f*=r):f=g=d=0;l=c*f-
p*g;k=p*d-b*f;t=b*g-c*d;(r=Math.sqrt(l*l+k*k+t*t))?(r=1/r,l*=r,k*=r,t*=r):t=k=l=0;e[0]=d;e[1]=l;e[2]=b;e[3]=0;e[4]=g;e[5]=k;e[6]=c;e[7]=0;e[8]=f;e[9]=t;e[10]=p;e[11]=0;e[12]=-(d*q+g*u+f*a);e[13]=-(l*q+k*u+t*a);e[14]=-(b*q+c*u+p*a);e[15]=1;return e},fromRotationTranslation:function(a,b,c){c||(c=n.create());var e=a[0],d=a[1],g=a[2],f=a[3],l=e+e,k=d+d,t=g+g;a=e*l;var p=e*k,e=e*t,r=d*k,d=d*t,g=g*t,l=f*l,k=f*k,f=f*t;c[0]=1-(r+g);c[1]=p+f;c[2]=e-k;c[3]=0;c[4]=p-f;c[5]=1-(a+g);c[6]=d+l;c[7]=0;c[8]=e+k;c[9]=
d-l;c[10]=1-(a+r);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},t={create:function(b){var c=new a(4);b?(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3]):c[0]=c[1]=c[2]=c[3]=0;return c},createFrom:function(b,c,e,d){var g=new a(4);g[0]=b;g[1]=c;g[2]=e;g[3]=d;return g},set:function(a,b){b[0]=a[0];b[1]=a[1];
b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=t.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},u=t.identity();t.calculateW=function(a,b){var c=a[0],e=a[1],d=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-c*c-e*e-d*d)),a;b[0]=c;b[1]=e;b[2]=d;b[3]=-Math.sqrt(Math.abs(1-c*c-e*e-d*d));return b};t.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};t.inverse=function(a,b){var c=a[0],e=a[1],d=a[2],g=a[3],c=(c=c*c+e*e+d*d+g*g)?1/c:0;if(!b||a===b)return a[0]*=-c,a[1]*=-c,a[2]*=
-c,a[3]*=c,a;b[0]=-a[0]*c;b[1]=-a[1]*c;b[2]=-a[2]*c;b[3]=a[3]*c;return b};t.conjugate=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};t.length=function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return Math.sqrt(b*b+c*c+e*e+a*a)};t.normalize=function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2];a=a[3];var g=Math.sqrt(c*c+e*e+d*d+a*a);if(0===g)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;g=1/g;b[0]=c*g;b[1]=e*g;b[2]=d*g;b[3]=a*g;return b};t.add=function(a,
b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};t.multiply=function(a,b,c){c||(c=a);var e=a[0],d=a[1],g=a[2];a=a[3];var f=b[0],l=b[1],n=b[2];b=b[3];c[0]=e*b+a*f+d*n-g*l;c[1]=d*b+a*l+g*f-e*n;c[2]=g*b+a*n+e*l-d*f;c[3]=a*b-e*f-d*l-g*n;return c};t.multiplyVec3=function(a,b,c){c||(c=b);var e=b[0],d=b[1],g=b[2];b=a[0];var f=a[1],l=a[2];a=a[3];var n=a*e+f*g-l*d,k=a*d+l*e-b*g,t=a*g+b*d-f*e,e=-b*e-f*d-l*g;c[0]=n*a+
e*-b+k*-l-t*-f;c[1]=k*a+e*-f+t*-b-n*-l;c[2]=t*a+e*-l+n*-f-k*-b;return c};t.scale=function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};t.toMat3=function(a,b){b||(b=q.create());var c=a[0],e=a[1],d=a[2],g=a[3],f=c+c,l=e+e,n=d+d;a=c*f;var k=c*l,c=c*n,t=e*l,e=e*n,d=d*n,f=g*f,l=g*l,g=g*n;b[0]=1-(t+d);b[1]=k+g;b[2]=c-l;b[3]=k-g;b[4]=1-(a+d);b[5]=e+f;b[6]=c+l;b[7]=e-f;b[8]=1-(a+t);return b};t.toMat4=function(a,b){b||(b=n.create());
var c=a[0],e=a[1],d=a[2],g=a[3],f=c+c,l=e+e,k=d+d;a=c*f;var t=c*l,c=c*k,p=e*l,e=e*k,d=d*k,f=g*f,l=g*l,g=g*k;b[0]=1-(p+d);b[1]=t+g;b[2]=c-l;b[3]=0;b[4]=t-g;b[5]=1-(a+d);b[6]=e+f;b[7]=0;b[8]=c+l;b[9]=e-f;b[10]=1-(a+p);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};t.slerp=function(a,b,c,e){e||(e=a);var d=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],g,f;if(1<=Math.abs(d))return e!==a&&(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3]),e;g=Math.acos(d);f=Math.sqrt(1-d*d);if(.001>Math.abs(f))return e[0]=.5*a[0]+
.5*b[0],e[1]=.5*a[1]+.5*b[1],e[2]=.5*a[2]+.5*b[2],e[3]=.5*a[3]+.5*b[3],e;d=Math.sin((1-c)*g)/f;c=Math.sin(c*g)/f;e[0]=a[0]*d+b[0]*c;e[1]=a[1]*d+b[1]*c;e[2]=a[2]*d+b[2]*c;e[3]=a[3]*d+b[3]*c;return e};t.fromRotationMatrix=function(a,b){b||(b=t.create());var c=a[0]+a[4]+a[8],e;if(0<c)e=Math.sqrt(c+1),b[3]=.5*e,e=.5/e,b[0]=(a[7]-a[5])*e,b[1]=(a[2]-a[6])*e,b[2]=(a[3]-a[1])*e;else{e=t.fromRotationMatrix.s_iNext=t.fromRotationMatrix.s_iNext||[1,2,0];c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var d=e[c],g=
e[d];e=Math.sqrt(a[3*c+c]-a[3*d+d]-a[3*g+g]+1);b[c]=.5*e;e=.5/e;b[3]=(a[3*g+d]-a[3*d+g])*e;b[d]=(a[3*d+c]+a[3*c+d])*e;b[g]=(a[3*g+c]+a[3*c+g])*e}return b};q.toQuat4=t.fromRotationMatrix;(function(){var a=q.create();t.fromAxes=function(b,c,e,d){a[0]=c[0];a[3]=c[1];a[6]=c[2];a[1]=e[0];a[4]=e[1];a[7]=e[2];a[2]=b[0];a[5]=b[1];a[8]=b[2];return t.fromRotationMatrix(a,d)}})();t.identity=function(a){a||(a=t.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};t.fromAngleAxis=function(a,b,c){c||(c=t.create());
a*=.5;var e=Math.sin(a);c[3]=Math.cos(a);c[0]=e*b[0];c[1]=e*b[1];c[2]=e*b[2];return c};t.toAngleAxis=function(a,b){b||(b=a);var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<e?(b[3]=2*Math.acos(a[3]),e=c.invsqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};t.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var x={create:function(b){var c=new a(4);b?(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3]):c[0]=c[1]=c[2]=c[3]=0;return c},createFrom:function(b,c,e,d){var g=new a(4);
g[0]=b;g[1]=c;g[2]=e;g[3]=d;return g},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=x.create());a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(!b||a===b)return b=a[1],a[1]=a[2],a[2]=b,a;b[0]=a[0];b[1]=a[2];b[2]=a[1];b[3]=a[3];return b},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2];a=a[3];var g=c*a-d*e;if(!g)return null;g=1/g;b[0]=a*g;b[1]=-e*g;b[2]=-d*g;b[3]=c*g;return b},
multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],g=a[2];a=a[3];c[0]=e*b[0]+d*b[2];c[1]=e*b[1]+d*b[3];c[2]=g*b[0]+a*b[2];c[3]=g*b[1]+a*b[3];return c},rotate:function(a,b,c){c||(c=a);var e=a[0],d=a[1],g=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);c[0]=e*b+d*f;c[1]=e*-f+d*b;c[2]=g*b+a*f;c[3]=g*-f+a*b;return c},multiplyVec2:function(a,b,c){c||(c=b);var e=b[0];b=b[1];c[0]=e*a[0]+b*a[1];c[1]=e*a[2]+b*a[3];return c},scale:function(a,b,c){c||(c=a);var e=a[1],d=a[2],g=a[3],f=b[0];b=b[1];c[0]=a[0]*f;c[1]=
e*b;c[2]=d*f;c[3]=g*b;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};d=d?"":"d";h["glMath"+d]=c;h["vec2"+d]={create:function(b){var c=new a(2);b?(c[0]=b[0],c[1]=b[1]):(c[0]=0,c[1]=0);return c},createFrom:function(b,c){var e=new a(2);e[0]=b;e[1]=c;return e},add:function(a,b,c){c||(c=b);c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c},subtract:function(a,b,c){c||(c=b);c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c},multiply:function(a,b,c){c||(c=b);c[0]=a[0]*b[0];c[1]=a[1]*b[1];return c},
divide:function(a,b,c){c||(c=b);c[0]=a[0]/b[0];c[1]=a[1]/b[1];return c},scale:function(a,b,c){c||(c=a);c[0]=a[0]*b;c[1]=a[1]*b;return c},dist:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)},dist2:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a},set:function(a,b){b[0]=a[0];b[1]=a[1];return b},set2:function(a,b,c){c[0]=a;c[1]=b;return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];return b},normalize:function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];0<c?(c=Math.sqrt(c),
b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0;return b},cross:function(a,b,c){a=a[0]*b[1]-a[1]*b[0];if(!c)return a;c[0]=c[1]=0;c[2]=a;return c},length:function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,c){c||(c=a);var e=a[0]-b[0];a=a[1]-b[1];b=e*e+a*a;if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/Math.sqrt(b);c[0]=e*b;c[1]=a*b;return c},lerp:function(a,b,c,e){e||(e=a);e[0]=a[0]+c*(b[0]-a[0]);e[1]=a[1]+c*(b[1]-a[1]);return e},str:function(a){return"["+
a[0]+", "+a[1]+"]"}};h["vec3"+d]=b;h["vec4"+d]={create:function(b){var c=new a(4);b?(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3]):(c[0]=0,c[1]=0,c[2]=0,c[3]=0);return c},createFrom:function(b,c,e,d){var g=new a(4);g[0]=b;g[1]=c;g[2]=e;g[3]=d;return g},add:function(a,b,c){c||(c=b);c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c},subtract:function(a,b,c){c||(c=b);c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c},multiply:function(a,b,c){c||(c=b);c[0]=a[0]*b[0];c[1]=
a[1]*b[1];c[2]=a[2]*b[2];c[3]=a[3]*b[3];return c},divide:function(a,b,c){c||(c=b);c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];c[3]=a[3]/b[3];return c},scale:function(a,b,c){c||(c=a);c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},set4:function(a,b,c,e,d){d[0]=a;d[1]=b;d[2]=c;d[3]=e;return d},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];
b[3]=-a[3];return b},lerp:function(a,b,c,e){e||(e=a);e[0]=a[0]+c*(b[0]-a[0]);e[1]=a[1]+c*(b[1]-a[1]);e[2]=a[2]+c*(b[2]-a[2]);e[3]=a[3]+c*(b[3]-a[3]);return e},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};h["mat2"+d]=x;h["mat3"+d]=q;h["mat4"+d]=n;h["quat4"+d]=t});return m})},"esri/views/3d/webgl-engine/lib/ComponentUtils":function(){define(["require","exports"],function(m,h){function d(a,b){if(null!=a){var c=a.isVisibleBit,e=a.data,d=8*e.BYTES_PER_ELEMENT;return b<e.length*d?
p(c,e,b,d):!a.isVisibleBit}return!0}function c(a){return null===a.component?-1:a.component}function a(a,c,e,g,f){d(c,g)&&b(a,c,e,e[g],e[g+1]-1,f)}function b(a,b,c,e,d,g){c=(b=0<a.length?a[a.length-1]:null)?b.range[1]:-1;var f=b?b.options:null;c>=e||(c+1===e&&f===g?b.range[1]=d:a.push({range:[e,d],options:g}))}function k(a){void 0===a&&(a=!0);return{isVisibleBit:!a,data:new Uint32Array(0)}}function f(a,b){return e(a,b,!0)}function g(a,b){return e(a,b,!1)}function e(a,b,c){var e=!1;a=a||q;e=a.isVisibleBit;
a=a.data;b=v(b);var d=8*a.BYTES_PER_ELEMENT,g=a.length*d;c=c===e;if(0===a.length||0===b)e=!c;else if(g<b&&!c)e=!0;else{for(var f=n[d],g=n[0],l=0;l<a.length-1;l++)if(e=!c&&a[l]!==f||c&&a[l]!==g)return e;e=a.length-1;b=n[(b-1)%d+1];e=!c&&(a[e]&b)!==b||c&&(a[e]&b)!==g}return e}function l(a){return 0<a.length}function p(a,b,c,e){var d=c/e|0;return 0!==(b[d]&1<<c-d*e)===a}function v(a){return Math.max(0,a.length-1)}Object.defineProperty(h,"__esModule",{value:!0});h.updateVisibility=function(a,b,c,e){if(c<
v(b)){null==a&&(a=k());var d=a.isVisibleBit,g=a.data,f=8*g.BYTES_PER_ELEMENT,l=c/f|0,n=c-f*l;b=(v(b)-1)/f|0;var p=g;e=e===d;c<p.length*f||!e||(c=Math.max(l+1,Math.ceil(1.5*p.length)),c=Math.min(c,b+1),g=new Uint32Array(c),g.set(p));l<g.length&&(g[l]=g[l]&~(1<<n)|(e?1:0)<<n);a.data=g}return a};h.getVisibility=d;h.hideAllComponents=function(a){if(null==a)a=k(!1);else{a.isVisibleBit=!0;for(var b=0;b<a.data.length;b++)a.data[b]=0}return a};h.unhideAllComponents=function(a){var b;if(null!=a)for(b=a,b.isVisibleBit=
!1,a=0;a<b.data.length;a++)b.data[a]=0;return b};h.generateVisibleIndexRanges=function(a,b){var c;if(a)if(l(b))if(0===a.data.length)c=[],b=[[b[0],b[b.length-1]-1]],c=a.isVisibleBit?c:b;else{c=[];for(var e=a.isVisibleBit,d=a.data,g=8*d.BYTES_PER_ELEMENT,f=d.length*g,n=v(b),k=!1,t=0;t<f&&t<n;t++){var q=p(e,d,t,g);if(q!==k){var u=b[t];q?c.push([u,0]):(k=c[c.length-1],k[1]=u-1);k=q}}a=!a.isVisibleBit;n>f&&a&&!k?c.push([b[f],b[n]-1]):k&&(k=c[c.length-1],k[1]=b[a?n:Math.min(n,f)]-1)}else c=[],c=a.isVisibleBit?
c:null;else c=null;return c};h.addHighlight=function(a,b,e,d){a=a||[];b={component:b,options:e,id:d};a.push(b);b=c(b);for(e=a.length-1;0<e&&b<c(a[e-1]);)d=[a[e],a[e-1]],a[e-1]=d[0],a[e]=d[1],--e;return a};h.removeHighlight=function(a,b){return a?(a=a.filter(function(a){return a.id!==b}),0===a.length?null:a):a};h.generateHighlightedIndexRanges=function(c,e,d){if(e){if(l(d)){for(var f=d[0],n=d[d.length-1]-1,k=[],p=!g(c,d),t=0;t<e.length;++t){var q=e[t].options,u=e[t].component;if(null!==u)a(k,c,d,u,
q);else if(p)b(k,c,d,f,n,q);else for(u=0;u<v(d);++u)a(k,c,d,u,q)}return 0<k.length?k:null}var p=!c||!c.isVisibleBit;return p?e.map(function(a){return{range:null,options:a.options}}):null}return null};h.defaultVisibilities=k;h.isAllVisible=function(a,b){return!g(a,b)};h.isAllHidden=function(a,b){return!f(a,b)};h.hasVisible=f;h.hasHidden=g;var q=k();h.createOffsets=function(a){return Array.isArray(a)?new Uint32Array(a):a};h.hasComponent=function(a,b){return b<v(a)};h.hasComponents=l;var n=[];for(m=
0;65>m;m++)n.push(Math.pow(2,m)-1);h.componentCount=v})},"esri/views/3d/webgl-engine/lib/Util":function(){define(["require","exports","./gl-matrix"],function(m,h,d){function c(a,b){if(!a)throw a=Error("dummy"),a.stack&&console.log(a.stack),new N(b);}function a(a,b,c){return a<b?b:a>c?c:a}function b(a){return a/180*Math.PI}function k(a){return 180*a/Math.PI}function f(a,b,c){d.mat4d.multiply(b,a,v);d.mat4d.inverse(v);for(a=0;8>a;++a)d.mat4d.multiplyVec4(v,q[a],n),d.vec3d.set3(n[0]/n[3],n[1]/n[3],n[2]/
n[3],c[a])}function g(a,b,c,e){d.vec3d.subtract(a,b,u);d.vec3d.subtract(c,b,x);d.vec3d.cross(x,u,e);d.vec3d.normalize(e);e[3]=-d.vec3d.dot(e,a)}function e(a,b,c,e){var d=6378137/Math.sqrt(1-h.ECCENTRICITY_SQUARED*Math.pow(Math.sin(a),2)),g=Math.cos(a);e[0]=(d+c)*Math.cos(b)*g;e[1]=(d*(1-h.ECCENTRICITY_SQUARED)+c)*Math.sin(a);e[2]=-(d+c)*Math.sin(b)*g}function l(a){for(var b in a)return b}function p(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2]}Object.defineProperty(h,"__esModule",{value:!0});var v=d.mat4d.create(),
q=[d.vec4d.createFrom(-1,-1,-1,1),d.vec4d.createFrom(1,-1,-1,1),d.vec4d.createFrom(1,1,-1,1),d.vec4d.createFrom(-1,1,-1,1),d.vec4d.createFrom(-1,-1,1,1),d.vec4d.createFrom(1,-1,1,1),d.vec4d.createFrom(1,1,1,1),d.vec4d.createFrom(-1,1,1,1)],n=d.vec4d.create(),t=[d.vec3d.create(),d.vec3d.create(),d.vec3d.create(),d.vec3d.create(),d.vec3d.create(),d.vec3d.create(),d.vec3d.create(),d.vec3d.create()],u=d.vec3d.create(),x=d.vec3d.create(),r=d.vec3d.create(),z=d.vec3d.create(),B=d.vec3d.create(),C=d.vec3d.create(),
A=d.vec3d.create(),D=d.vec3d.create(),E=d.vec3d.create(),H=d.vec3d.create(),G=d.vec3d.create(),J=d.vec3d.create(),I=d.vec3d.create(),F=d.vec3d.create(),N=function(){function a(a){this.message=a}a.prototype.toString=function(){return"AssertException: "+this.message};return a}();h.AssertException=N;h.EARTH_RADIUS=6378137;h.METER2FEET=3.28084;h.ECCENTRICITY_SQUARED=.0066943799901414;h.VertexAttrConstants={POSITION:"position",NORMAL:"normal",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",
SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region"};h.assert=c;h.verify=function(a,b){a||(console.log("Verify failed: "+b),console.log(Error("dummy").stack))};h.createQuadVertexUvBuffer=function(a){void 0===a&&(a=Float32Array);a=new a(20);a[0]=-1;a[1]=-1;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=-1;a[7]=0;a[8]=1;a[9]=0;a[10]=-1;a[11]=1;a[12]=0;a[13]=0;a[14]=1;a[15]=1;a[16]=1;a[17]=0;a[18]=1;a[19]=1;return a};h.isPowerOfTwo=function(a){return 0===(a&a-1)};h.lerp=function(a,b,c){return a+(b-a)*c};h.clamp=
a;h.fallbackIfUndefined=function(a,b){return void 0===a?b:a};h.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255]};h.rgb2hex=function(b){var c=a(Math.round(255*b[0]),0,255),e=a(Math.round(255*b[1]),0,255);b=a(Math.round(255*b[2]),0,255);return"0x"+((c<<16)+(e<<8)+b).toString(16)};h.dec2hex=function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a};h.deg2rad=b;h.rad2deg=k;h.azimuthElevationAngle2Direction=function(a,b){a=1.5*Math.PI-a;b=.5*Math.PI-b;return[Math.cos(a)*
Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b)]};h.rayPlane=function(a,b,c,e){var g=d.vec3d.dot(c,b);if(0===g)return!1;c=-(d.vec3d.dot(c,a)+c[3])/g;d.vec3d.add(a,d.vec3d.scale(b,c,e),e);return!0};h.raySphereClosestPositive=function(a,b,c,e){var g=d.vec3d.dot(b,b),f=2*d.vec3d.dot(b,a);c=d.vec3d.dot(a,a)-c*c;c=f*f-4*g*c;if(0>c)return!1;var l=Math.sqrt(c);c=(-f-l)/(2*g);g=(-f+l)/(2*g);if(0>c||g<c&&0<g)c=g;return 0<c?(d.vec3d.add(a,d.vec3d.scale(b,c,e),e),!0):!1};h.rayTriangle3D=function(a,b,c,e,g,f,
l,n,k){void 0===k&&(k=d.vec3d.create());var p=e[l]-c[f],t=e[l+1]-c[f+1],q=e[l+2]-c[f+2];e=g[n]-c[f];l=g[n+1]-c[f+1];g=g[n+2]-c[f+2];var u=b[1]*g-l*b[2],v=b[2]*e-g*b[0],r=b[0]*l-e*b[1];n=p*u+t*v+q*r;if(-1E-5<n&&1E-5>n)return!1;n=1/n;var h=a[0]-c[f],x=a[1]-c[f+1];a=a[2]-c[f+2];k[1]=n*(h*u+x*v+a*r);if(0>k[1]||1<k[1])return!1;c=x*q-t*a;a=a*p-q*h;p=h*t-p*x;k[2]=n*(b[0]*c+b[1]*a+b[2]*p);if(0>k[2]||1<k[1]+k[2])return!1;k[0]=n*(e*c+l*a+g*p);return!0};h.rayBoxTest=function(a,b,c,e){var d,g=(c[0]-a[0])/b[0],
f=(e[0]-a[0])/b[0];g>f&&(d=g,g=f,f=d);var l=(c[1]-a[1])/b[1],n=(e[1]-a[1])/b[1];l>n&&(d=l,l=n,n=d);if(g>n||l>f)return!1;l>g&&(g=l);n<f&&(f=n);c=(c[2]-a[2])/b[2];a=(e[2]-a[2])/b[2];c>a&&(d=c,c=a,a=d);if(g>a||c>f)return!1;a<f&&(f=a);return 0>f?!1:!0};h.rayRay2D=function(a,b,c,e,g,f){void 0===f&&(f=d.vec2d.create());var l=(e[g]-c[g])*(b[0]-a[0])-(e[0]-c[0])*(b[g]-a[g]);if(0===l)return!1;c=((e[0]-c[0])*(a[g]-c[g])-(e[g]-c[g])*(a[0]-c[0]))/l;f[0]=a[0]+c*(b[0]-a[0]);f[1]=a[g]+c*(b[g]-a[g]);return!0};h.matrix2frustum=
f;h.matrix2frustumPlanes=function(a,b,c,e){void 0===e&&(e=c,c=t);f(a,b,c);g(c[4],c[0],c[3],e[0]);g(c[1],c[5],c[6],e[1]);g(c[4],c[5],c[1],e[2]);g(c[3],c[2],c[6],e[3]);g(c[0],c[1],c[2],e[4]);g(c[5],c[4],c[7],e[5])};h.point2plane=g;h.project=function(a,b,e,g,f){f||(f=a);n[0]=a[0];n[1]=a[1];n[2]=a[2];n[3]=1;d.mat4d.multiplyVec4(b,n);2<f.length&&(f[2]=-n[2]);d.mat4d.multiplyVec4(e,n);c(0!==n[3]);f[0]=n[0]/n[3];f[1]=n[1]/n[3];f[2]=n[2]/n[3];f[0]=(.5*f[0]+.5)*g[2]+g[0];f[1]=(.5*f[1]+.5)*g[3]+g[1]};h.geodeticToGeocentricLatidude=
function(a){return Math.atan((1-h.ECCENTRICITY_SQUARED)*Math.tan(a))};h.latLon2positionWGS84Ellipsoid=e;h.pos2latLon=function(b,c){var e=d.vec3d.length(b);c[0]=Math.asin(a(b[1]/e,-1,1));c[1]=(0>b[2]?1:-1)*Math.acos(a(b[0]/(Math.cos(c[0])*e),-1,1));c[0]=k(c[0]);c[1]=k(c[1]);c[2]=e};h.pos2latLonWGS84Ellipsoid=function(a,b){var c=a[0],e=-a[2],d=a[1],g=Math.sqrt(Math.pow(6378137,2)*(1-h.ECCENTRICITY_SQUARED));a=Math.sqrt(Math.pow(c,2)+Math.pow(e,2));var f=Math.atan2(6378137*d,g*a),c=Math.atan2(e,c),e=
Math.atan2(d+Math.pow(Math.sqrt((Math.pow(6378137,2)-Math.pow(g,2))/Math.pow(g,2)),2)*g*Math.pow(Math.sin(f),3),a-6378137*h.ECCENTRICITY_SQUARED*Math.pow(Math.cos(f),3));a=a/Math.cos(e)-6378137/Math.sqrt(1-h.ECCENTRICITY_SQUARED*Math.pow(Math.sin(e),2))+h.EARTH_RADIUS;b[0]=e;b[1]=c;b[2]=a};h.computeGlobeTransformation=function(a,c,g){var f=b(a[0]);a=b(a[1]);e(f,a,c,r);d.mat4d.translate(g,r);d.mat4d.rotateY(g,.5*Math.PI+a);d.mat4d.rotateX(g,.5*Math.PI-f);return g};h.readUInt16=function(a,b){return a[b]+
(a[b+1]<<8)};h.readUInt32=function(a,b){return a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24)};h.setIfDefined=function(a,b,c){void 0!==b[a]&&(c[a]=b[a])};h.array2object=function(a,b){var c={};if(void 0!==b)for(var e=0;e<a.length;e++){var d=a[e];c[b(d)]=d}else for(b=0;b<a.length;b++)d=a[b],c[d]=d;return c};h.object2array=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};h.mergeObjects=function(a,b,c){void 0===c&&(c={});if(c!==a)for(var e in a)c[e]=a[e];if(c!==b)for(var d in b)c[d]=b[d];return c};
h.subtractObjects=function(a,b){var c={},e;for(e in a)void 0===b[e]&&(c[e]=a[e]);return c};h.intersectObjects=function(a,b){var c={},e;for(e in a)void 0!==b[e]&&(c[e]=a[e]);return c};h.getFirstObjectKey=l;h.getFirstObjectValue=function(a){return a[l(a)]};h.objectEmpty=function(a){for(var b in a)return!1;return!0};h.arraysEqual=function(a,b){if(a.length!==b.length)return!1;for(var c=0,e=a.length;c<e;++c)if(a[c]!==b[c])return!1;return!0};h.arrayRemove=function(a,b){var c=a.indexOf(b);return-1!==c?(a[c]=
a[a.length-1],a.pop(),b):null};h.byteBuffer2base64image=function(a,b,e,d,g){var f=4*b;c(a.length===f*e,"buffer length must match image resolution");var l=document.createElement("canvas");l.width=b;l.height=e;var n=l.getContext("2d");b=n.getImageData(0,0,b,e);for(var k=b.data,p=0;p<e;++p)for(var t=p*f,q=(e-1-p)*f,u=0;u<f;++u)k[t++]=a[q++];n.putImageData(b,0,0);return l.toDataURL(d,g)};h.cround=function(a){return Math.round(100*a)/100};h.logWithBase=function(a,b){return Math.log(a)/Math.log(b)};h.setMatrixTranslation=
p;h.setMatrixTranslation3=function(a,b,c,e){a[12]=b;a[13]=c;a[14]=e};h.getMatrixTranslation=function(a,b){void 0===b&&(b=d.vec3d.create());b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};h.createTranslationMatrix=function(a,b){a=d.mat4d.identity(a);p(a,b);return a};h.fovx2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};h.fovy2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/c)};h.fovx2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/b)};h.fovy2fovd=function(a,
b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/c)};h.fovd2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};h.fovd2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};h.nextHighestPowerOfTwo=function(a){--a;for(var b=1;32>b;b<<=1)a|=a>>b;return a+1};h.linelineDistance3D=function(a,b,c,e){var g,f,l;z[0]=a[0]-c[0];z[1]=a[1]-c[1];z[2]=a[2]-c[2];B[0]=e[0]-c[0];B[1]=e[1]-c[1];B[2]=e[2]-c[2];if(1E-4>Math.abs(B[0])&&1E-4>Math.abs(B[1])&&1E-4>
Math.abs(B[2]))return[!1];C[0]=b[0]-a[0];C[1]=b[1]-a[1];C[2]=b[2]-a[2];if(1E-4>Math.abs(C[0])&&1E-4>Math.abs(C[1])&&1E-4>Math.abs(C[2]))return[!1];b=z[0]*B[0]+z[1]*B[1]+z[2]*B[2];e=B[0]*C[0]+B[1]*C[1]+B[2]*C[2];g=z[0]*C[0]+z[1]*C[1]+z[2]*C[2];f=B[0]*B[0]+B[1]*B[1]+B[2]*B[2];l=(C[0]*C[0]+C[1]*C[1]+C[2]*C[2])*f-e*e;if(1E-4>Math.abs(l))return[!1];g=(b*e-g*f)/l;b=(b+e*g)/f;A[0]=a[0]+g*C[0];A[1]=a[1]+g*C[1];A[2]=a[2]+g*C[2];D[0]=c[0]+b*B[0];D[1]=c[1]+b*B[1];D[2]=c[2]+b*B[2];return[!0,d.vec3d.dist(A,D),
A,D]};h.projectVectorVector2D=function(a,b,c){J[0]=b[0]-a[0];J[1]=b[1]-a[1];J[2]=0;I[0]=c[0]-a[0];I[1]=c[1]-a[1];I[2]=0;F[0]=c[0];F[1]=c[1];F[2]=0;b=d.vec3d.dot(I,J);c=d.vec3d.length(J);b/=c*c;G[0]=J[0]*b;G[1]=J[1]*b;E[0]=a[0]+G[0];E[1]=a[1]+G[1];d.vec3d.subtract(F,E,H);a=d.vec3d.length(H);b=d.vec3d.length(I);c=d.vec3d.length(J);var e=d.vec3d.length(G);if(e>b||e>c)a=Number.MAX_VALUE;return a};m=function(){var a=window.performance||{};if(a.now)return function(){return a.now()};if(a.webkitNow)return function(){return a.webkitNow()};
if(a.mozNow)return function(){return a.mozNow()};if(a.msNow)return function(){return a.msNow()};if(a.oNow)return function(){return a.oNow()};var b;b=a.timing&&a.timing.navigationStart?a.timing.navigationStart:Date.now();return function(){return Date.now()-b}}();h.performance={now:m}})},"esri/views/3d/webgl-engine/parts/Model":function(){define("require exports dojo/string ../lib/ModelContentType ../lib/ModelDirtySet ../lib/RenderGeometry ../lib/Util ../lib/gl-matrix".split(" "),function(m,h,d,c,a,
b,k,f){var g=k.assert,e=k.verify,l=f.vec3d,p=f.mat4d,v=k.logWithBase;m=function(){function f(){this.dirtySet=new a(this);this._uniqueIdx=0;this._id2origin={};this.content={};for(var b in c)this.content[c[b]]={}}f.prototype.getAll=function(a){a=this.content[a];g(void 0!==a);return a};f.prototype.get=function(a,b){return this.getAll(a)[b]};f.prototype.add=function(a,b){var e=this.content[a];g(void 0!==e);var d=b.getId();g(null==e[d],"Model/Stage already contains object to be added");e[d]=b;a===c.LAYER&&
this.notifyDirty(a,b,"layerAdded")};f.prototype.remove=function(a,b){var e=this.content[a];g(void 0!==e);var d=e[b];g(void 0!==d,"Model/Stage doesn't contain object to be removed");delete e[b];a===c.TEXTURE&&d.unload();a===c.LAYER&&this.notifyDirty(a,d,"layerRemoved");return d};f.prototype.getDirtySet=function(){return this.dirtySet};f.prototype.notifyDirty=function(a,b,c,e){this.dirtySet.handleUpdate(b,c,e)};f.prototype.getOrigin=function(a,b,c){void 0===c&&(c=10);var e=0;b=b*c/1E4;1<b&&(e=Math.ceil(v(b,
2)));b=1E4*Math.pow(2,e);c=Math.round(a[0]/b);var d=Math.round(a[1]/b);a=Math.round(a[2]/b);var e=e+"_"+c+"_"+d+"_"+a,g=this._id2origin[e];null==g&&(g={vec3:l.createFrom(c*b,d*b,a*b),id:e},this._id2origin[e]=g);return g};f.prototype.getGeometryRenderGeometries=function(a,c,e){var d=a.getId(),g=c.geometry,f=g.getData(),l=!!g.singleUse,k=c.materials,n=c.instanceParameters,t=a.getCombinedStaticTransformation(c),q=p.maxScale(t),v=c.origin,g=g.getBoundingInfo(0),u=c.getId()+"#0",h=this._uniqueIdx++;a=
new b(f,g,k[0],t,c.customTransformation,q,a.getCastShadow(),l,d,u,h);a.origin=v||this.getOrigin(a.center,a.bsRadius);a.instanceParameters=n;e.push(a)};f.prototype.updateRenderGeometryTransformation=function(a,b,c){a.getCombinedStaticTransformation(b,c.transformation);c.updateTransformation(c.transformation)};f.prototype.formatDebugInfo=function(a){var b=[];if(a){b[0]="\x3ctable\x3e";for(var e in c)a=c[e],b[0]+="\x3ctr\x3e\x3ctd\x3e"+a+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Object.keys(this.getAll(a)).length+
"\x3c/td\x3e\x3c/tr\x3e";b[0]+="\x3c/table\x3e";b[1]=this.dirtySet.formatDebugInfo(!0)}else{b[0]="";for(e in c)a=c[e],b[0]+=d.pad(String(Object.keys(this.getAll(a)).length),6," ")+" "+a+", ";b[1]=this.dirtySet.formatDebugInfo(!1)}return b};f.prototype.validateContent=function(){var a=this.getAll(c.OBJECT),b;for(b in a)this.validateObject(a[b]);var a=this.getAll(c.LAYER),e;for(e in a)this.validateLayer(a[e]);e=this.getAll(c.MATERIAL);for(var d in e)this.validateMaterial(e[d])};f.prototype.validateObject=
function(a){a=a.geometryRecords;for(var b=0;b<a.length;++b){var d=a[b];g(null!=this.get(c.GEOMETRY,d.geometry.id));var f=d.geometry.numGroups;g(f<=d.materials.length,"object materials do not match geometry groups");e(f===d.materials.length,"object materials do not match geometry groups");for(var l=0;l<f;++l)g(null!=this.get(c.MATERIAL,d.materials[l].getId()))}};f.prototype.validateLayer=function(a){a=a.getObjects();for(var b=0;b<a.length;++b){var e=this.get(c.OBJECT,a[b].getId());g(null!=e)}};f.prototype.validateMaterial=
function(a){a=a.getAllTextureIds();for(var b=0;b<a.length;++b){var e=this.get(c.TEXTURE,a[b]);g(null!=e)}};return f}();m.ContentType=c;return m})},"esri/views/3d/webgl-engine/lib/ModelContentType":function(){define(["require","exports"],function(m,h){m=function(){return function(){}}();m.LAYER="layers";m.OBJECT="objects";m.GEOMETRY="geometries";m.MATERIAL="materials";m.TEXTURE="textures";return m})},"esri/views/3d/webgl-engine/lib/ModelDirtySet":function(){define(["require","exports","./ModelContentType",
"./ModelDirtyTypesTs","./Util"],function(m,h,d,c,a){var b=a.objectEmpty,k=a.assert;return function(){function a(a){this._residentGeomRecords={};this._dirtyGeomRecords={};this._dirtyMaterials={};this._model=a}Object.defineProperty(a.prototype,"residentLayerCount",{get:function(){return Object.keys(this._residentGeomRecords).length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"residentObjectCount",{get:function(){var a=0,b;for(b in this._residentGeomRecords)a+=Object.keys(this._residentGeomRecords[b]).length;
return a},enumerable:!0,configurable:!0});a.prototype._getResidentGeometryRecords=function(){return this._residentGeomRecords};a.prototype._getDirtyGeometryRecords=function(){return this._dirtyGeomRecords};a.prototype.getDirtyMaterials=function(){return b(this._dirtyMaterials)?null:this._dirtyMaterials};a.prototype.clearDirtyMaterials=function(){this._dirtyMaterials={}};a.prototype.hasDirtyGeometryRecords=function(){for(var a in this._dirtyGeomRecords)for(var c in this._dirtyGeomRecords[a]){var d=
this._dirtyGeomRecords[a][c];if(d&&!b(d))return!0}return!1};a.prototype.handleUpdate=function(a,b,c){k(this[b],"ModelDirtySet doesn't know how to process "+b);return this[b](a,c)};a.prototype.shaderTransformationChanged=function(a){if(a=this._residentGeomRecords[a.getId()])for(var b in a){var c=this._model.content[d.OBJECT][b];if(c&&c.hasVolativeTransformation()){var c=a[b],g;for(g in c)for(var f=0,k=c[g][1];f<k.length;f++)k[f].shaderTransformationChanged()}}};a.prototype.getAddRemoveUpdateList=function(a){return this.getAddRemoveUpdateListFilteredByLayers(Object.keys(this._dirtyGeomRecords),
a)};a.prototype.getAddRemoveUpdateListFilteredByLayers=function(a,c){for(var e=[],g=[],f=[],q=0;q<a.length;q++){var n=a[q];if(n in this._dirtyGeomRecords){for(var t in this._dirtyGeomRecords[n]){var u=this._dirtyGeomRecords[n][t];if(u){var h=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,n,t),r;for(r in u){var z=u[r],B=z[0],C=z[1],z=z[2],A=C&2&&z&1;if(C&4||A){var D=h[r];D?g.push.apply(g,D[1]):4===C&&k(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove");c&&D&&delete h[r]}if(C&
1||A){var D=[B,[]],m=this._model.get(d.OBJECT,t);this._model.getGeometryRenderGeometries(m,B,D[1]);e.push.apply(e,D[1]);c&&(h[r]=D)}if(C&2&&!A)if(D=h[r],m=this._model.get(d.OBJECT,t),D){C=D[1];A=C.length;if(z&16)for(D=0;D<A;D++){var H=C[D];this._model.updateRenderGeometryTransformation(m,B,H)}for(D=0;D<A;D++)H=C[D],f.push({renderGeometry:H,updateType:z})}else k(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}b(h)&&delete this._residentGeomRecords[n][t]}}b(this._residentGeomRecords[n])&&
delete this._residentGeomRecords[n]}c&&delete this._dirtyGeomRecords[n]}return[e,g,f]};a.prototype.getResidentRenderGeometries=function(){return this.getResidentRenderGeometriesFilteredByLayers(Object.keys(this._residentGeomRecords))};a.prototype.getResidentRenderGeometriesFilteredByLayers=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d in this._residentGeomRecords)for(var g in this._residentGeomRecords[d]){var f=this._residentGeomRecords[d][g];if(f)for(var k in f)b.push.apply(b,f[k][1])}}return b};
a.prototype.componentVisibilityChanged=function(a,b,c){if(null!=b)this._componentPropertyChanged(a,b,c,2);else{b=0;for(var e=a.getGeometryRecords();b<e.length;b++)this._componentPropertyChanged(a,e[b],c,2)}};a.prototype.componentHighlightChanged=function(a,b,c){if(null!=b)this._componentPropertyChanged(a,b,c,32);else{b=0;for(var e=a.getGeometryRecords();b<e.length;b++)this._componentPropertyChanged(a,e[b],c,32)}};a.prototype.vertexAttrsUpdated=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,
2,0,0,2,5,4)};a.prototype.colorAttrsUpdated=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,2,0,0,2,5,8)};a.prototype.matChanged=function(a){this._dirtyMaterials[a.getId()]=!0};a.prototype.layerAdded=function(a){for(var b=a.getObjects(),c=0;c<b.length;c++)this.layObjectAdded(a,b[c])};a.prototype.layerRemoved=function(a){for(var b=a.getObjects(),c=0;c<b.length;c++)this.layObjectRemoved(a,b[c])};a.prototype.layObjectAdded=function(a,b){a=a.getId();for(var c=b.getGeometryRecords(),e=0;e<c.length;e++)this.objGeometryAdded(b,
c[e],a)};a.prototype.layObjectRemoved=function(a,b){a=a.getId();for(var c=b.getGeometryRecords(),e=0;e<c.length;e++)this.objGeometryRemoved(b,c[e],a)};a.prototype.layObjectReplaced=function(a,b){this.layObjectRemoved(a,b[0]);this.layObjectAdded(a,b[1])};a.prototype.objDirty=function(a,b){b=b||this._getParentLayerId(a);var c=a.getId(),c=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,c),e;for(e in c)this._updateOrCreateDirtyRecord(a,c[e][0],b,2,0,2,0,5,1)};a.prototype.objTransformation=
function(a,b){b=b||this._getParentLayerId(a);var c=a.getId(),c=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,c),e;for(e in c)this._updateOrCreateDirtyRecord(a,c[e][0],b,2,0,0,2,5,16)};a.prototype.objGeometryAdded=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,1,4,0,0,0)};a.prototype.objGeometryRemoved=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,4,1,2,0,0)};a.prototype.objGeometryReplaced=function(a,b){this.objGeometryRemoved(a,b[0]);this.objGeometryAdded(a,
b[1])};a.prototype.objGeometryTransformation=function(a,b){this.objGeometryReplaced(a,b)};a.prototype._componentPropertyChanged=function(a,b,c,d){this._updateOrCreateDirtyRecord(a,b,c,2,0,0,2,5,d)};a.prototype._updateOrCreateDirtyRecord=function(a,b,c,d,f,q,n,t,u){c=c||this._getParentLayerId(a);var e=a.getId();a=b.getId();c=this._createObjectRecordObjIfNonexistent(this._dirtyGeomRecords,c,e);(e=c[a])?(b=e[1],b&f?delete c[a]:b&q?(e[1]=d,e[2]=u):b&n?e[2]|=u:b&t||k(!1,"ModelDirtySet.objGeometryAdded: inconsistent state")):
c[a]=[b,d,u]};a.prototype._createObjectRecordObjIfNonexistent=function(a,b,c){a[b]||(a[b]={});a[b][c]||(a[b][c]={});return a[b][c]};a.prototype._getParentLayerId=function(a){return a.parentLayer.id};a.prototype.formatDebugInfo=function(a){var b=["ADD","UPD",void 0,"REM"];if(a)return"";a="";for(var c in this._dirtyGeomRecords)for(var d in this._dirtyGeomRecords[c]){var g=this._dirtyGeomRecords[c][d];if(g){0<a.length&&(a+="\n");a+=c+"."+d;var f=[],k;for(k in g){var t=g[k][1];f[t]||(f[t]=[]);f[t].push(g[k][0].geometry.id)}for(g=
0;g<f.length;g++)if(f[g])for(a+=" "+b[g-1]+": ",t=0;t<f[g].length;t++)a+=f[g][t]+", "}}return a};return a}()})},"esri/views/3d/webgl-engine/lib/ModelDirtyTypesTs":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define(["require","exports","./gl-matrix"],function(m,h,d){var c=d.vec3d,a=d.mat4d;return function(){function b(a,b,d,e,l,p,v,q,n,t,u){this.shaderTransformationDirty=!0;this.data=
a.toRenderData();this.componentOffsets=a.componentOffsets;this.boundingInfo=b;this.material=d;this.origin=null;this.center=c.create();this.bsRadius=0;this.transformation=null;this.calculateShaderTransformation=l;e&&this.updateTransformation(e,p);this.castShadow=v;this.singleUse=q;this.name=n;this.uniqueName=t;this.idx=u;this.canBeMerged=!0;this.instanceParameters={}}b.prototype.updateTransformation=function(a,b){this.transformation=a;this.shaderTransformationDirty=!0;this.bsRadius=this.getBoundingSphere(a,
b,this.center)};b.prototype.shaderTransformationChanged=function(){this.shaderTransformationDirty=!0};b.prototype.getBoundingSphere=function(b,c,d){c=c||a.maxScale(b);a.multiplyVec3(b,this.boundingInfo.getCenter(),d);return this.boundingInfo.getBSRadius()*c};Object.defineProperty(b.prototype,"hasShaderTransformation",{get:function(){return!!this.calculateShaderTransformation},enumerable:!0,configurable:!0});b.prototype.getShaderTransformation=function(){return this.calculateShaderTransformation?(this.shaderTransformationDirty&&
(this.shaderTransformation||(this.shaderTransformation=a.create()),a.set(this.calculateShaderTransformation(this.transformation),this.shaderTransformation),this.shaderTransformationDirty=!1),this.shaderTransformation):this.transformation};return b}()})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["require","exports","./Util"],function(m,h,d){function c(a){return Math.abs(a*a*a)}function a(a,b,d,g){void 0===g&&(g=e);var f=d.parameters;d=d.paddingPixelsOverride;g.scale=
Math.min(f.divisor/(b-f.offset),1);g.factor=c(a);g.minPixelSize=f.minPixelSize;g.paddingPixels=d;return g}function b(a,b){return Math.max(d.lerp(a*b.scale,a,b.factor),b.minPixelSize*(1+2*b.paddingPixels/a))}function k(c,e,d){c=a(c,e,d);c.minPixelSize=0;c.paddingPixels=0;return b(1,c)}Object.defineProperty(h,"__esModule",{value:!0});h.getSettings=function(a){return new f(a,h.defaultDescription)};h.getLabelSettings=function(a){var b=h.defaultDescription.curvatureDependent;return new f(a,{curvatureDependent:{min:{curvature:b.min.curvature,
tiltAngle:b.min.tiltAngle,scaleFallOffFactor:g.curvatureDependent.min.scaleFallOffFactor},max:{curvature:b.max.curvature,tiltAngle:b.max.tiltAngle,scaleFallOffFactor:g.curvatureDependent.max.scaleFallOffFactor}},scaleStart:h.defaultDescription.scaleStart,scaleFallOffRange:h.defaultDescription.scaleFallOffRange,minPixelSize:g.minPixelSize})};h.perspectiveFactor=c;h.scaleFactor=a;h.applyScaleFactor=b;h.applyScaleFactorVec2=function(a,b,c){void 0===c&&(c=[0,0]);var e=Math.min(Math.max(b.scale,b.minPixelSize*
(1+2*b.paddingPixels/a[1])/a[1]),1);c[0]=d.lerp(a[0]*e,a[0],b.factor);c[1]=d.lerp(a[1]*e,a[1],b.factor);return c};h.precomputeScale=k;h.precomputeScaleFactor=function(a,b,c,e){e.scale=k(a,b,c);e.factor=0;e.minPixelSize=c.parameters.minPixelSize;e.paddingPixels=c.paddingPixelsOverride;return e};h.applyPrecomputedScaleFactorVec2=function(a,b,c){void 0===c&&(c=[0,0]);b=Math.min(Math.max(b.scale,b.minPixelSize*(1+2*b.paddingPixels/a[1])/a[1]),1);c[0]=a[0]*b;c[1]=a[1]*b;return c};h.scale=function(c,e,
d,g){return b(c,a(e,d,g))};var f=function(){function a(a,b,c,e){void 0===c&&(c={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0});this.viewingMode=a;this.description=b;this.parameters=c;this._paddingPixelsOverride=e;"local"===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=
this.calculateCurvatureDependentParametersGlobal)}Object.defineProperty(a.prototype,"paddingPixelsOverride",{get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels},enumerable:!0,configurable:!0});a.prototype.update=function(a){if(this.parameters&&this.parameters.camera.fovY===a.fovY&&this.parameters.camera.distance===a.distance)return!1;this.calculateParameters(a,this.parameters);return!0};a.prototype.overridePadding=function(b){return b!==this.paddingPixelsOverride?new a(this.viewingMode,
this.description,this.parameters,b):this};a.prototype.calculateParameters=function(a,b){var c=this.description,e=c.scaleStart,d=c.scaleFallOffRange,c=c.minPixelSize,g=a.fovY,f=a.distance,l=this.calculateCurvatureDependentParameters(a),k=this.coverageCompensation(a,l),n=l.tiltAngle,l=l.scaleFallOffFactor,f=Math.sin(n)*f,n=.5*Math.PI-n-g*(.5-e*k),e=f/Math.cos(n),d=(e-f/Math.cos(n+g*d*k)*l)/(1-l);b.camera.fovY=a.fovY;b.camera.distance=a.distance;b.offset=d;b.divisor=e-d;b.minPixelSize=c;return b};a.prototype.calculateCurvatureDependentParametersLocal=
function(a,b){void 0===b&&(b=l);b.tiltAngle=this.description.curvatureDependent.min.tiltAngle;b.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor;return b};a.prototype.calculateCurvatureDependentParametersGlobal=function(a,b){void 0===b&&(b=l);var c=this.description.curvatureDependent;a=1+a.distance/p;var e=[c.min.curvature,c.max.curvature],g=e[0];a=d.clamp((Math.sqrt(a*a-1)-g)/(e[1]-g),0,1);e=[c.min,c.max];c=e[0];e=e[1];b.tiltAngle=d.lerp(c.tiltAngle,e.tiltAngle,a);b.scaleFallOffFactor=
d.lerp(c.scaleFallOffFactor,e.scaleFallOffFactor,a);return b};a.prototype.surfaceCoverageCompensationLocal=function(a,b){return(a.fovY-b.tiltAngle)/a.fovY};a.prototype.surfaceCoverageCompensationGlobal=function(a,b){var c=p*p;b=b.tiltAngle+.5*Math.PI;var e=a.fovY;a=a.distance;a=a*a+c-2*Math.cos(b)*a*p;var d=Math.sqrt(a);return(Math.acos(Math.sqrt(a-c)/d)-Math.asin(p/(d/Math.sin(b)))+.5*e)/e};return a}();h.defaultDescription={curvatureDependent:{min:{curvature:d.deg2rad(10),tiltAngle:d.deg2rad(12),
scaleFallOffFactor:.5},max:{curvature:d.deg2rad(70),tiltAngle:d.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0};var g={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};h.copyParameters=function(a,b){b.camera.distance=a.camera.distance;b.camera.fovY=a.camera.fovY;b.divisor=a.divisor;b.offset=a.offset;b.minPixelSize=a.minPixelSize;return b};var e={scale:0,factor:0,minPixelSize:0,paddingPixels:0},l={tiltAngle:0,scaleFallOffFactor:0},
p=6378137})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/Error"],function(m,h,d,c){return function(){function a(){}a.vertexCount=function(b,c){return b.vertexBuffers[c].size/a.getStride(b.layout[c])};a.getStride=function(a){return a[0].stride};a.getBytesPerElement=function(a){switch(a){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw Error("Unknown data type");
}};a.addDescriptor=function(b,c,d,g,e,l){var f=a.getBytesPerElement(g);if(0<b.length){var k=b[0].stride,q=k+f*d;b.forEach(function(a){return a.stride=q});b.push({name:c,count:d,type:g,offset:k,stride:q,normalized:e,divisor:l})}else b.push({name:c,count:d,type:g,offset:0,stride:f*d,normalized:e,divisor:l})};a.assertCompatibleVertexAttributeLocations=function(a,c){(a=a.locations===c.locations)||console.error("VertexAttributeLocations are incompatible");return a};a.hasAttribute=function(a,c){for(var b=
0;b<a.length;b++)if(a[b].name===c)return!0;return!1};a.findAttribute=function(a,c){for(var b=0;b<a.length;b++)if(a[b].name===c)return a[b];return null};a.copyFramebufferToTexture=function(a,c,d,g,e){void 0===e&&(e=0);var b=a.getBoundFramebufferObject(),f=a.getBoundTexture(0);a.bindFramebuffer(c);a.bindTexture(d,0);a.gl.copyTexImage2D(a.gl.TEXTURE_2D,e,d.descriptor.pixelFormat,g[0],g[1],g[2],g[3],0);a.gl.flush();a.bindFramebuffer(b);a.bindTexture(f,0)};a.assert=function(a,d){if(!a)throw new c(d);};
a.setBaseInstanceOffset=function(a,c){var b={},g;for(g in a)b[g]=a[g].map(function(a){return a.divisor?d({},a,{baseInstance:c}):a});return b};return a}()})},"esri/core/tsSupport/assignHelper":function(){define([],function(){return Object.assign||function(m){for(var h,d=1,c=arguments.length;d<c;d++){h=arguments[d];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(m[a]=h[a])}return m}})},"esri/views/3d/support/aaBoundingBox":function(){define(["require","exports","./aaBoundingRect","../../../geometry/Extent"],
function(m,h,d,c){function a(a){return a[0]>=a[3]?0:a[3]-a[0]}function b(a){return a[1]>=a[4]?0:a[4]-a[1]}function k(a){return a[2]>=a[5]?0:a[5]-a[2]}function f(a){return 6===a.length}Object.defineProperty(h,"__esModule",{value:!0});h.create=function(a){void 0===a&&(a=h.ZERO);return[a[0],a[1],a[2],a[3],a[4],a[5]]};h.fromExtent=function(a){return[a.xmin,a.ymin,a.zmin,a.xmax,a.ymax,a.zmax]};h.toExtent=function(a,b){return isFinite(a[2])||isFinite(a[5])?new c({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],
zmin:a[2],zmax:a[5],spatialReference:b}):new c({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:b})};h.fromMinMax=function(a,b){return[a[0],a[1],a[2],b[0],b[1],b[2]]};h.expand=function(a,b,c){void 0===c&&(c=a);var e=b.declaredClass;"esri.geometry.Extent"===e?(c[0]=Math.min(a[0],b.xmin),c[1]=Math.min(a[1],b.ymin),c[3]=Math.max(a[3],b.xmax),c[4]=Math.max(a[4],b.ymax),b.hasZ&&(c[2]=Math.min(a[2],b.zmin),c[5]=Math.max(a[5],b.zmax))):"esri.geometry.Point"===e?(c[0]=Math.min(a[0],b.x),c[1]=Math.min(a[1],
b.y),c[3]=Math.max(a[3],b.x),c[4]=Math.max(a[4],b.y),b.hasZ&&(c[2]=Math.min(a[2],b.z),c[5]=Math.max(a[5],b.z))):f(b)?(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]),c[3]=Math.max(a[3],b[3]),c[4]=Math.max(a[4],b[4]),c[5]=Math.max(a[5],b[5])):d.is(b)?(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[3]=Math.max(a[3],b[2]),c[4]=Math.max(a[4],b[3])):Array.isArray(b)&&(2===b.length?(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[3]=Math.max(a[3],b[0]),c[4]=Math.max(a[4],
b[1])):3===b.length&&(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]),c[3]=Math.max(a[3],b[0]),c[4]=Math.max(a[4],b[1]),c[5]=Math.max(a[5],b[2])));return c};h.expandBuffer=function(a,b,c,d,f){void 0===f&&(f=a);var e=a[0],g=a[1],l=a[2],k=a[3],p=a[4];a=a[5];for(var r=0;r<d;r++)e=Math.min(e,b[c+3*r]),g=Math.min(g,b[c+3*r+1]),l=Math.min(l,b[c+3*r+2]),k=Math.max(k,b[c+3*r]),p=Math.max(p,b[c+3*r+1]),a=Math.max(a,b[c+3*r+2]);f[0]=e;f[1]=g;f[2]=l;f[3]=k;f[4]=p;f[5]=a;return f};
h.allFinite=function(a){for(var b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};h.width=a;h.depth=b;h.height=k;h.center=function(c,e){void 0===e&&(e=[0,0,0]);e[0]=c[0]+a(c)/2;e[1]=c[1]+b(c)/2;e[2]=c[2]+k(c)/2;return e};h.size=function(c,e){void 0===e&&(e=[0,0,0]);e[0]=a(c);e[1]=b(c);e[2]=k(c);return e};h.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};h.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[2]>=a[2]-
c&&b[0]<=a[3]+c&&b[1]<=a[4]+c&&b[2]<=a[5]+c};h.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=a[4]&&b[5]<=a[5]};h.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])};h.offset=function(a,b,c,d,f){void 0===f&&(f=a);f[0]=a[0]+b;f[1]=a[1]+c;f[2]=a[2]+d;f[3]=a[3]+b;f[4]=a[4]+c;f[5]=a[5]+d;return f};h.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];
c[2]=b[2];c!==a&&(c[3]=a[3],c[4]=a[4],c[5]=a[5]);return c};h.setMax=function(a,b,c){void 0===c&&(c=a);c[3]=b[0];c[4]=b[1];c[5]=b[2];c!==a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);return a};h.set=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a};h.toRect=function(a,b){b||(b=d.create());b[0]=a[0];b[1]=a[1];b[2]=a[3];b[3]=a[4];return b};h.fromRect=function(a,b){a[0]=b[0];a[1]=b[1];a[3]=b[2];a[4]=b[3];return a};h.is=f;h.isPoint=function(c){return 0===a(c)&&0===b(c)&&0===k(c)};
h.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!f(a)||!f(b))return!1;if(c)for(var e=0;e<a.length;e++){if(!c(a[e],b[e]))return!1}else for(e=0;e<a.length;e++)if(a[e]!==b[e])return!1;return!0};h.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];h.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];h.ZERO=[0,0,0,0,0,0]})},"esri/views/3d/support/aaBoundingRect":function(){define(["require","exports"],function(m,h){function d(a){return a[0]>=
a[2]?0:a[2]-a[0]}function c(a){return a[1]>=a[3]?0:a[3]-a[1]}function a(a){return 4===a.length}Object.defineProperty(h,"__esModule",{value:!0});h.create=function(a){void 0===a&&(a=h.ZERO);return[a[0],a[1],a[2],a[3]]};h.fromExtent=function(a){return[a.xmin,a.ymin,a.xmax,a.ymax]};h.expand=function(b,c,d){void 0===d&&(d=b);var g=c.declaredClass;"esri.geometry.Extent"===g?(d[0]=Math.min(b[0],c.xmin),d[1]=Math.min(b[1],c.ymin),d[2]=Math.max(b[2],c.xmax),d[3]=Math.max(b[3],c.ymax)):"esri.geometry.Point"===
g?(d[0]=Math.min(b[0],c.x),d[1]=Math.min(b[1],c.y),d[2]=Math.max(b[2],c.x),d[3]=Math.max(b[3],c.y)):a(c)?(d[0]=Math.min(b[0],c[0]),d[1]=Math.min(b[1],c[1]),d[2]=Math.max(b[2],c[2]),d[3]=Math.max(b[3],c[3])):!Array.isArray(c)||2!==c.length&&3!==c.length||(d[0]=Math.min(b[0],c[0]),d[1]=Math.min(b[1],c[1]),d[2]=Math.max(b[2],c[0]),d[3]=Math.max(b[3],c[1]));return d};h.allFinite=function(a){for(var b=0;4>b;b++)if(!isFinite(a[b]))return!1;return!0};h.width=d;h.height=c;h.center=function(a,k){void 0===
k&&(k=[0,0]);k[0]=a[0]+d(a)/2;k[1]=a[1]+c(a)/2;return k};h.containsPoint=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[0]<=a[2]&&c[1]<=a[3]};h.containsPointWithMargin=function(a,c,d){return c[0]>=a[0]-d&&c[1]>=a[1]-d&&c[0]<=a[2]+d&&c[1]<=a[3]+d};h.intersects=function(a,c){return Math.max(c[0],a[0])<=Math.min(c[2],a[2])&&Math.max(c[1],a[1])<=Math.min(c[3],a[3])};h.offset=function(a,c,d,g){void 0===g&&(g=a);g[0]=a[0]+c;g[1]=a[1]+d;g[2]=a[2]+c;g[3]=a[3]+d;return g};h.setMin=function(a,c,d){void 0===
d&&(d=a);d[0]=c[0];d[1]=c[1];d!==a&&(d[2]=a[2],d[3]=a[3]);return d};h.setMax=function(a,c,d){void 0===d&&(d=a);d[2]=c[0];d[3]=c[1];d!==a&&(d[0]=a[0],d[1]=a[1]);return a};h.set=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a};h.is=a;h.isPoint=function(a){return(0===d(a)||!isFinite(a[0]))&&(0===c(a)||!isFinite(a[1]))};h.equals=function(b,c,d){if(null==b||null==c)return b===c;if(!a(b)||!a(c))return!1;if(d)for(var g=0;g<b.length;g++){if(!d(b[g],c[g]))return!1}else for(g=0;g<b.length;g++)if(b[g]!==
c[g])return!1;return!0};h.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];h.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];h.ZERO=[0,0,0,0]})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.Default3D={position:0,normal:1,uv0:2,color:3,instanceColor:3,size:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,region:7,model:8,modelNormal:12}})},
"esri/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(m,h){m=function(){function d(c,a,b,k,f){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=c;this._layout=b;this._buffers=k;this._locations=a;f&&(this._indexBuffer=f);this._id=d._nextId++}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",
{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"locations",{get:function(){return this._locations},
enumerable:!0,configurable:!0});d.prototype.dispose=function(c){void 0===c&&(c=!0);if(this._context){var a=this._context.extensions.vao;a&&this._glName&&(a.deleteVertexArrayOES(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(c){for(var b in this._buffers)this._buffers[b].dispose(),delete this._buffers[b];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}};d.prototype.initialize=function(){if(!this._initialized){var c=
this._context.extensions.vao;if(c){var a=c.createVertexArrayOES();c.bindVertexArrayOES(a);this._bindLayout();c.bindVertexArrayOES(null);this._glName=a}this._initialized=!0}};d.prototype.bind=function(){this.initialize();var c=this._context.extensions.vao;c?c.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())};d.prototype._bindLayout=function(){var c=this._buffers,a=this._context.extensions.vao,b=this._layout,d=this._indexBuffer;c||console.error("Vertex buffer dictionary is empty!");
var f=this._context.gl,g,e,l=0,p;for(p in c)for((g=c[p])||console.error("Vertex buffer is uninitialized!"),(e=b[p])||console.error("Vertex element descriptor is empty!"),this._context.bindBuffer(g),l=0;l<e.length;++l){g=e[l];var v=this._locations[g.name],q=g.baseInstance?g.baseInstance*g.stride:0;void 0===v&&console.error("There is no location for vertex attribute '"+g.name+"' defined.");g.baseInstance&&!g.divisor&&console.error("Vertex attribute '"+g.name+"' uses baseInstanceOffset without divisor.");
if(4>=g.count){if(f.enableVertexAttribArray(v),f.vertexAttribPointer(v,g.count,g.type,g.normalized,g.stride,g.offset+q),g.divisor&&0<g.divisor){var n=this._context.extensions.angleInstancedArrays;n&&n.vertexAttribDivisorANGLE(v,g.divisor)}}else if(16===g.count&&5126===g.type)for(var t=0;4>t;t++)f.enableVertexAttribArray(v+t),f.vertexAttribPointer(v+t,4,g.type,g.normalized,g.stride,g.offset+16*t+q),g.divisor&&0<g.divisor&&(n=this._context.extensions.angleInstancedArrays)&&n.vertexAttribDivisorANGLE(v+
t,g.divisor);else console.error("Unsupported vertex attribute element count: "+g.count)}d&&(a?f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,d.glName):this._context.bindBuffer(d))};d.prototype.unbind=function(){this.initialize();var c=this._context.extensions.vao;c?c.bindVertexArrayOES(null):this._unbindLayout()};d.prototype._unbindLayout=function(){var c=this._buffers,a=this._layout,b=this._locations,d=this._context;c||console.error("Vertex buffer dictionary is empty!");var f=d.gl,g,e,l,p=0,v=0,q;for(q in c){(g=
c[q])||console.error("Vertex buffer is uninitialized!");e=a[q];p=0;for(v=e.length;p<v;++p)l=e[p],f.disableVertexAttribArray(b[l.name]);d.unbindBuffer(g.bufferType)}(c=this._indexBuffer)&&d.unbindBuffer(c.bufferType)};return d}();m._nextId=0;return m})},"esri/views/webgl/BufferObject":function(){define(["require","exports"],function(m,h){m=function(){function d(c,a,b,k){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=c;this._bufferType=
a;this._usage=b;this._id=d._nextId++;this._glName=this._context.gl.createBuffer();k&&this.setData(k)}d.createIndex=function(c,a,b){return new d(c,34963,a,b)};d.createVertex=function(c,a,b){return new d(c,34962,a,b)};Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"size",{get:function(){return this._size},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?
4*this._size:2*this._size},enumerable:!0,configurable:!0});d.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)};d.prototype.setData=function(c){if(c){if("number"===typeof c)0>c&&console.error("Buffer size cannot be negative!"),this._size=c;else{var a=c.byteLength;c instanceof Uint16Array&&(a/=2,this._indexType=5123);c instanceof Uint32Array&&(a/=4,this._indexType=5125);this._size=a}a=this._context.getBoundVAO();
this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,c,this._usage);this._context.bindVAO(a)}};d.prototype.setSubData=function(c,a,b,d){void 0===a&&(a=0);void 0===b&&(b=0);if(c){(0>a||a>=this._size)&&console.error("offset is out of range!");var f=a,g=b,e=d,l=c.byteLength;c instanceof Uint16Array&&(l/=2,f*=2,g*=2,e*=2);c instanceof Uint32Array&&(l/=4,f*=4,g*=4,e*=2);void 0===d&&(d=l-1);b>=d&&console.error("end must be bigger than start!");a+b-d>this._size&&
console.error("An attempt to write beyond the end of the buffer!");a=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,f,(c instanceof ArrayBuffer?c:c.buffer).slice(g,e));this._context.bindVAO(a)}};return d}();m._nextId=0;return m})},"esri/views/webgl/enums":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.BASE_TEXTURE_UNIT=33984})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define(["./GeometryData",
"./BufferVectorMath","./Util","./gl-matrix"],function(m,h,d,c){function a(a,c,e,d,g){if(Math.abs(b.dot(c,a))>g)return!1;b.cross(a,c,e);b.normalize(e);b.cross(e,a,d);b.normalize(d);return!0}var b=c.vec3,k=c.vec4,f=c.vec3d,g=d.VertexAttrConstants,e=h.Vec3Compact,l=f.create(),p=f.create(),v={createSphereGeometry:function(a,c,e,f,l,k,p){a=a||50;f=void 0!==f?f:-Math.PI;l=void 0!==l?l:2*Math.PI;k=void 0!==k?k:.5*-Math.PI;p=void 0!==p?p:Math.PI;var n=Math.max(3,Math.floor(c)||8),t=Math.max(2,Math.floor(e)||
6),q=(n+1)*(t+1);e=new Float32Array(3*q);c=new Float32Array(3*q);var q=new Float32Array(2*q),r,u,v=[],h=b.create(),x=0;for(u=0;u<=t;u++){var z=[],F=u/t,N=k+F*p,L=Math.cos(N);for(r=0;r<=n;r++){var M=r/n,K=f+M*l,ba=Math.cos(K)*L*a,X=Math.sin(N)*a,K=-Math.sin(K)*L*a;e[3*x]=ba;e[3*x+1]=X;e[3*x+2]=K;b.set3(ba,X,K,h);b.normalize(h);c[3*x]=h[0];c[3*x+1]=h[1];c[3*x+2]=h[2];q[2*x]=M;q[2*x+1]=F;z.push(x);++x}v.push(z)}a=new Uint32Array(2*n*(t-1)*3);for(u=x=0;u<t;u++)for(r=0;r<n;r++)f=v[u][r],l=v[u][r+1],k=
v[u+1][r+1],p=v[u+1][r],0===u?(a[x++]=f,a[x++]=k,a[x++]=p):u===t-1?(a[x++]=f,a[x++]=l,a[x++]=k):(a[x++]=f,a[x++]=l,a[x++]=k,a[x++]=k,a[x++]=p,a[x++]=f);d.assert(x===a.length);n={};n[g.POSITION]=a;n[g.NORMAL]=a;n[g.UV0]=a;t={};t[g.POSITION]={size:3,data:e};t[g.NORMAL]={size:3,data:c};t[g.UV0]={size:2,data:q};return new m(t,n)},createPolySphereGeometry:function(a,b,c){function d(b,c){b>c&&(b=c+(c=b,0));var d=b.toString()+"."+c.toString();if(k[d])return k[d];var g=l.length;l.length+=3;e.add(l,3*b,l,
3*c,l,g);e.scale(l,g,a/e.length(l,g));g/=3;return k[d]=g}var f,l;c?(l=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],c=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):(c=a*(1+Math.sqrt(5))/2,l=[-a,c,0,a,c,0,-a,-c,0,a,-c,0,0,-a,c,0,a,c,0,-a,-c,0,a,-c,c,0,-a,c,0,a,-c,0,-a,-c,0,a],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(f=0;f<l.length;f+=3)e.scale(l,f,a/e.length(l,f));var k={};for(f=0;f<b;f++){for(var n=c.length,
p=new Uint32Array(4*n),t=0;t<n;t+=3){var q=c[t],v=c[t+1],h=c[t+2],G=d(q,v),J=d(v,h),I=d(h,q),F=4*t;p[F]=q;p[F+1]=G;p[F+2]=I;p[F+3]=v;p[F+4]=J;p[F+5]=G;p[F+6]=h;p[F+7]=I;p[F+8]=J;p[F+9]=G;p[F+10]=J;p[F+11]=I}c=p;k={}}b=new Float32Array(l);for(f=0;f<b;f+=3)e.normalize(b,f);l=new Float32Array(l);f={};f[g.POSITION]=c;f[g.NORMAL]=c;c={};c[g.POSITION]={size:3,data:l};c[g.NORMAL]={size:3,data:b};return new m(c,f)},createPointGeometry:function(a,b,c,e,d,f,l){var k=new Float32Array(3);k[0]=b?b[0]:0;k[1]=b?
b[1]:0;k[2]=b?b[2]:0;b=new Float32Array(3);b[0]=a?a[0]:0;b[1]=a?a[1]:0;b[2]=a?a[2]:1;if(null==f)a=new Float32Array(2),a[0]=0,a[1]=0;else{a=new Float32Array(f.length);for(var n=0;n<f.length;n++)a[n]=f[n]}f=new Uint8Array(4);f[0]=c?255*c[0]:255;f[1]=c?255*c[1]:255;f[2]=c?255*c[2]:255;f[3]=c&&3<c.length?255*c[3]:255;c=new Float32Array(2);c[0]=null!=e&&2==e.length?e[0]:1;c[1]=null!=e&&2==e.length?e[1]:1;if(null!=d){var p=new Float32Array(4);p[0]=d[0];p[1]=d[1];p[2]=d[2];p[3]=d[3]}if(null!=l){var t=new Float32Array(4);
t[0]=l[0];t[1]=l[1];t[2]=l[2];t[3]=l[3]}n=new Uint32Array(1);n[0]=0;e={};e[g.POSITION]=n;e[g.NORMAL]=n;e[g.UV0]=n;e[g.COLOR]=n;e[g.SIZE]=n;null!=d&&(e[g.AUXPOS1]=n);null!=l&&(e[g.AUXPOS2]=n);n={};n[g.POSITION]={size:3,data:k};n[g.NORMAL]={size:3,data:b};n[g.UV0]={size:a.length,data:a};n[g.COLOR]={size:4,data:f};n[g.SIZE]={size:2,data:c};null!=d&&(n[g.AUXPOS1]={size:4,data:p});null!=l&&(n[g.AUXPOS2]={size:4,data:t});return new m(n,e,m.DefaultOffsets,"point")},createPointArrayGeometry:function(a,b){for(var c=
new Float32Array(3*a.length),e=new Float32Array(b?3*a.length:3),d=new Uint32Array(a.length),f=new Uint32Array(a.length),l=0;l<a.length;l++)c[3*l]=a[l][0],c[3*l+1]=a[l][1],c[3*l+2]=a[l][2],b&&(e[3*l]=b[l][0],e[3*l+1]=b[l][1],e[3*l+2]=b[l][2]),d[l]=l,f[l]=0;b||(e[0]=0,e[1]=1,e[2]=0);a=new Float32Array(2);a[0]=0;a[1]=0;l={};l[g.POSITION]=d;l[g.NORMAL]=b?d:f;l[g.UV0]=f;b={};b[g.POSITION]={size:3,data:c};b[g.NORMAL]={size:3,data:e};b[g.UV0]={size:2,data:a};return new m(b,l,m.DefaultOffsets,"point")},createTriangleGeometry:function(){var a=
new Float32Array(9);a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=100;a[6]=100;a[7]=0;a[8]=0;var b=new Uint32Array(3);b[0]=0;b[1]=1;b[2]=2;var c=new Float32Array(3);c[0]=0;c[1]=1;c[2]=0;var e=new Uint32Array(3);e[0]=0;e[1]=0;e[2]=0;var d=new Float32Array(2);d[0]=0;d[1]=0;var f=new Uint32Array(3);f[0]=0;f[1]=0;f[2]=0;var l={};l[g.POSITION]=b;l[g.NORMAL]=e;l[g.UV0]=f;b={};b[g.POSITION]={size:3,data:a};b[g.NORMAL]={size:3,data:c};b[g.UV0]={size:2,data:d};return new m(b,l)},createSquareGeometry:function(a){var b,
c,e=new Float32Array(12);if(a)for(b=0;4>b;b++)for(c=0;3>c;c++)e[3*b+c]=a[b][c];else e[0]=-1,e[1]=-1,e[2]=0,e[3]=1,e[4]=-1,e[5]=0,e[6]=1,e[7]=1,e[8]=0,e[9]=-1,e[10]=1,e[11]=0;c=new Uint32Array(6);c[0]=0;c[1]=1;c[2]=2;c[3]=2;c[4]=3;c[5]=0;a=new Float32Array(3);a[0]=0;a[1]=0;a[2]=1;var d=new Uint32Array(6);for(b=0;6>b;b++)d[b]=0;b=new Float32Array(8);b[0]=0;b[1]=0;b[2]=1;b[3]=0;b[4]=1;b[5]=1;b[6]=0;b[7]=1;var f=new Uint8Array(4);f[0]=255;f[1]=255;f[2]=255;f[3]=255;var l={};l[g.POSITION]=c;l[g.NORMAL]=
d;l[g.UV0]=c;l[g.COLOR]=d;c={};c[g.POSITION]={size:3,data:e};c[g.NORMAL]={size:3,data:a};c[g.UV0]={size:2,data:b};c[g.COLOR]={size:4,data:f};return new m(c,l)},createBoxGeometry:function(){var a,b,c=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],e=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],d=[0,0,1,0,1,1,0,1],f=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],l=Array(36);for(a=0;6>a;a++)for(b=0;6>b;b++)l[6*a+b]=a;var k=
Array(36);for(a=0;6>a;a++)k[6*a+0]=0,k[6*a+1]=1,k[6*a+2]=2,k[6*a+3]=2,k[6*a+4]=3,k[6*a+5]=0;return function(a){var b;Array.isArray(a)||(a=[a,a,a]);var n=new Float32Array(24);for(b=0;8>b;b++)n[3*b]=c[b][0]*a[0],n[3*b+1]=c[b][1]*a[1],n[3*b+2]=c[b][2]*a[2];a={};a[g.POSITION]=new Uint32Array(f);a[g.NORMAL]=new Uint32Array(l);a[g.UV0]=new Uint32Array(k);b={};b[g.POSITION]={size:3,data:n};b[g.NORMAL]={size:3,data:new Float32Array(e)};b[g.UV0]={size:2,data:new Float32Array(d)};return new m(b,a)}}(),createDiamondGeometry:function(){var a=
[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],b=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],c=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],e=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];return function(d){var f;Array.isArray(d)||(d=[d,d,d]);var l=new Float32Array(18);for(f=0;6>f;f++)l[3*f]=a[f][0]*d[0],l[3*f+1]=a[f][1]*d[1],l[3*f+2]=a[f][2]*d[2];d={};d[g.POSITION]=new Uint32Array(c);d[g.NORMAL]=new Uint32Array(e);f={};f[g.POSITION]={size:3,data:l};f[g.NORMAL]=
{size:3,data:new Float32Array(b)};return new m(f,d)}}(),createTetrahedronGeometry:function(){var a=b.createFrom(-.5,0,-.5),c=b.createFrom(.5,0,-.5),e=b.createFrom(0,0,.5),d=b.createFrom(0,.5,0),f=b.create(),l=b.create(),k=b.create(),p=b.create(),v=b.create();b.subtract(a,d,f);b.subtract(a,c,l);b.cross(f,l,k);b.normalize(k,k);b.subtract(c,d,f);b.subtract(c,e,l);b.cross(f,l,p);b.normalize(p,p);b.subtract(e,d,f);b.subtract(e,a,l);b.cross(f,l,v);b.normalize(v,v);var h=[a,c,e,d],D=[0,-1,0,k[0],k[1],k[2],
p[0],p[1],p[2],v[0],v[1],v[2]],E=[0,1,2,3,1,0,3,2,1,3,0,2],H=[0,0,0,1,1,1,2,2,2,3,3,3];return function(a){var b;Array.isArray(a)||(a=[a,a,a]);var c=new Float32Array(12);for(b=0;4>b;b++)c[3*b]=h[b][0]*a[0],c[3*b+1]=h[b][1]*a[1],c[3*b+2]=h[b][2]*a[2];a={};a[g.POSITION]=new Uint32Array(E);a[g.NORMAL]=new Uint32Array(H);b={};b[g.POSITION]={size:3,data:c};b[g.NORMAL]={size:3,data:new Float32Array(D)};return new m(b,a)}}(),createConeGeometry:function(a,c,e,d){var f=0,l=b.createFrom(0,f,0),k=b.createFrom(0,
f+a,0),n=b.createFrom(0,-1,0),p=b.createFrom(0,1,0);d&&(f=a,k=b.createFrom(0,0,0),l=b.createFrom(0,f,0),n=b.createFrom(0,1,0),p=b.createFrom(0,-1,0));var l=[k,l],n=[n,p],p=e+2,t=0,k=Math.sqrt(a*a+c*c);if(d)for(d=e-1;0<=d;d--)t=2*Math.PI/e*d,q=b.createFrom(Math.cos(t)*c,f,Math.sin(t)*c),l.push(q),t=b.createFrom(a*Math.cos(t)/k,-c/k,a*Math.sin(t)/k),n.push(t);else for(d=0;d<e;d++){var t=2*Math.PI/e*d,q=b.createFrom(Math.cos(t)*c,f,Math.sin(t)*c);l.push(q);t=b.createFrom(a*Math.cos(t)/k,c/k,a*Math.sin(t)/
k);n.push(t)}a=new Uint32Array(6*(e+2));e=new Uint32Array(6*(e+2));f=c=0;for(d=3;d<l.length;d++)a[c++]=1,a[c++]=d-1,a[c++]=d,e[f++]=0,e[f++]=0,e[f++]=0;a[c++]=l.length-1;a[c++]=2;a[c++]=1;e[f++]=0;e[f++]=0;e[f++]=0;for(d=3;d<l.length;d++)a[c++]=d,a[c++]=d-1,a[c++]=0,e[f++]=d,e[f++]=d-1,e[f++]=1;a[c++]=0;a[c++]=2;a[c++]=l.length-1;e[f++]=1;e[f++]=2;e[f++]=n.length-1;f=1;Array.isArray(f)||(f=[f,f,f]);c=new Float32Array(3*p);for(d=0;d<p;d++)c[3*d]=l[d][0]*f[0],c[3*d+1]=l[d][1]*f[1],c[3*d+2]=l[d][2]*
f[2];l=new Float32Array(3*p);for(d=0;d<p;d++)l[3*d]=n[d][0],l[3*d+1]=n[d][1],l[3*d+2]=n[d][2];n={};n[g.POSITION]=a;n[g.NORMAL]=e;p={};p[g.POSITION]={size:3,data:c};p[g.NORMAL]={size:3,data:l};return new m(p,n)},createCylinderGeometry:function(a,c,e,d,f,l){d||(d=b.createFrom(1,0,0));f||(f=b.createFrom(0,0,0));l=void 0===l?!0:l;var k=b.create();b.normalize(d,k);d=b.create();b.scale(k,Math.abs(a),d);var n=b.create();b.scale(d,-.5,n);b.add(n,f);var p=b.createFrom(0,1,0);Math.abs(.2>1-b.dot(k,p))&&b.set3(0,
0,1,p);var t=b.create();b.cross(k,p,t);b.normalize(t);b.cross(t,k,p);var q=2*e+(l?2:0),v=e+(l?2:0);f=new Float32Array(3*q);a=new Float32Array(3*v);var r=new Float32Array(2*q),h=new Uint32Array(3*e*(l?4:2)),u=new Uint32Array(3*e*(l?4:2));l&&(f[3*(q-2)+0]=n[0],f[3*(q-2)+1]=n[1],f[3*(q-2)+2]=n[2],r[2*(q-2)]=0,r[2*(q-2)+1]=0,f[3*(q-1)+0]=f[3*(q-2)+0]+d[0],f[3*(q-1)+1]=f[3*(q-2)+1]+d[1],f[3*(q-1)+2]=f[3*(q-2)+2]+d[2],r[2*(q-1)]=1,r[2*(q-1)+1]=1,a[3*(v-2)+0]=-k[0],a[3*(v-2)+1]=-k[1],a[3*(v-2)+2]=-k[2],
a[3*(v-1)+0]=k[0],a[3*(v-1)+1]=k[1],a[3*(v-1)+2]=k[2]);var k=function(a,b,c){h[a]=b;u[a]=c},x,F,N=0,L=b.create(),M=b.create();for(x=0;x<e;x++)F=2*Math.PI/e*x,b.scale(p,Math.sin(F),L),b.scale(t,Math.cos(F),M),b.add(L,M),a[3*x+0]=L[0],a[3*x+1]=L[1],a[3*x+2]=L[2],b.scale(L,c),b.add(L,n),f[3*x+0]=L[0],f[3*x+1]=L[1],f[3*x+2]=L[2],r[2*x+0]=x/e,r[2*x+1]=0,f[3*(x+e)+0]=f[3*x+0]+d[0],f[3*(x+e)+1]=f[3*x+1]+d[1],f[3*(x+e)+2]=f[3*x+2]+d[2],r[2*(x+e)+0]=x/e,r[2*x+1]=1,F=(x+1)%e,k(N++,x,x),k(N++,x+e,x),k(N++,F,
F),k(N++,F,F),k(N++,x+e,x),k(N++,F+e,F);if(l){for(x=0;x<e;x++)F=(x+1)%e,k(N++,q-2,v-2),k(N++,x,v-2),k(N++,F,v-2);for(x=0;x<e;x++)F=(x+1)%e,k(N++,x+e,v-1),k(N++,q-1,v-1),k(N++,F+e,v-1)}c={};c[g.POSITION]=h;c[g.NORMAL]=u;c[g.UV0]=h;e={};e[g.POSITION]={size:3,data:f};e[g.NORMAL]={size:3,data:a};e[g.UV0]={size:2,data:r};return new m(e,c)},createTubeGeometry:function(a,b,c,e,f){c=c||10;e=null!=e?e:!0;d.assert(1<a.length);for(var g=[],l=[],k=0;k<c;k++){g.push([0,-k-1,-((k+1)%c)-1]);var n=k/c*2*Math.PI;
l.push([Math.cos(n)*b,Math.sin(n)*b])}return v.createPathExtrusionGeometry(l,a,[[0,0,0]],g,e,f)},createPathExtrusionGeometry:function(c,e,l,p,v,r){var n,t=c.length,q=new Float32Array(e.length*t*3+(6*l.length||0)),h=new Float32Array(e.length*t+(2*l.length||0)),u=new Float32Array(e.length*t*3+(l?6:0)),x=0,H=0,G=0,J=(e.length-1)*t*6+6*p.length,I=new Uint32Array(J),J=new Uint32Array(J),F=0,N=0,L=b.create(),M=b.create(),K=b.create(),ba=b.create();b.create();var X=b.create();b.create();b.create();var T=
b.create(),V=b.create(),P=b.create(),W=b.create(),U=b.create();b.create();b.create();var Y=b.create(),S=b.create(),ca=b.create(),ga=k.create();b.set3(0,1,0,W);b.subtract(e[1],e[0],M);b.normalize(M);v?(b.add(e[0],r,P),b.normalize(P,K)):b.set3(0,0,1,K);a(M,K,X,K,.99619469809)||a(M,W,X,K,.99619469809)||a(M,W,X,K,.99619469809);b.set(K,ba);b.set(X,S);for(n=0;n<l.length;n++)b.scale(X,l[n][0],T),b.scale(K,l[n][2],P),b.add(T,P),b.add(T,e[0]),q[x++]=T[0],q[x++]=T[1],q[x++]=T[2],h[G++]=0;u[H++]=-M[0];u[H++]=
-M[1];u[H++]=-M[2];for(n=0;n<p.length;n++)I[F++]=0<p[n][0]?p[n][0]:-p[n][0]-1+l.length,I[F++]=0<p[n][1]?p[n][1]:-p[n][1]-1+l.length,I[F++]=0<p[n][2]?p[n][2]:-p[n][2]-1+l.length,J[N++]=0,J[N++]=0,J[N++]=0;var ea=l.length;n=l.length-1;for(var aa,R=0;R<e.length;R++){aa=!1;if(0<R){b.set(M,L);R<e.length-1?(b.subtract(e[R+1],e[R],M),b.normalize(M)):aa=!0;b.add(L,M,U);b.normalize(U);b.add(e[R-1],ba,Y);ga[0]=U[0];ga[1]=U[1];ga[2]=U[2];ga[3]=-f.dot(U,e[R]);if(d.rayPlane(Y,L,ga,P))b.subtract(P,e[R]),b.normalize(P,
K),b.cross(U,K,X),b.normalize(X);else{var da=U,fa=S,la=W,ja=X,ka=K;a(da,ba,ja,ka,.99619469809)||a(da,fa,ja,ka,.99619469809)||a(da,la,ja,ka,.99619469809)}b.set(K,ba);b.set(X,S)}v&&(b.add(e[R],r,P),b.normalize(P,ca));for(da=0;da<t;da++)if(b.scale(X,c[da][0],T),b.scale(K,c[da][1],P),b.add(T,P),b.normalize(T,V),u[H++]=V[0],u[H++]=V[1],u[H++]=V[2],v?h[G++]=b.dot(T,ca):h[G++]=T[2],b.add(T,e[R]),q[x++]=T[0],q[x++]=T[1],q[x++]=T[2],!aa)for(fa=(da+1)%t,I[F++]=ea+da,I[F++]=ea+t+da,I[F++]=ea+fa,I[F++]=ea+fa,
I[F++]=ea+t+da,I[F++]=ea+t+fa,fa=0;6>fa;fa++)J[N++]=I[F-6+fa]-n;ea+=t}aa=e[e.length-1];for(n=0;n<l.length;n++)b.scale(X,l[n][0],T),b.scale(K,l[n][1],P),b.add(T,P),b.add(T,aa),q[x++]=T[0],q[x++]=T[1],q[x++]=T[2],h[G++]=0;c=H/3;u[H++]=M[0];u[H++]=M[1];u[H++]=M[2];t=ea-t;for(n=0;n<p.length;n++)I[F++]=0<=p[n][0]?ea+p[n][0]:-p[n][0]-1+t,I[F++]=0<=p[n][2]?ea+p[n][2]:-p[n][2]-1+t,I[F++]=0<=p[n][1]?ea+p[n][1]:-p[n][1]-1+t,J[N++]=c,J[N++]=c,J[N++]=c;p={};p[g.POSITION]=I;p[g.NORMAL]=J;I={};I[g.POSITION]={size:3,
data:q};I.zOffset={size:1,data:h};I[g.NORMAL]={size:3,data:u};return new m(I,p)},createPolylineGeometry:function(a){d.assert(1<a.length,"createPolylineGeometry(): polyline needs at least 2 points");d.assert(3===a[0].length,"createPolylineGeometry(): malformed vertex");for(var b=new Float32Array(3*a.length),c=new Uint32Array(2*(a.length-1)),e=0,f=0,l=0;l<a.length;l++){for(var k=0;3>k;k++)b[e++]=a[l][k];0<l&&(c[f++]=l-1,c[f++]=l)}a={};e={};a[g.POSITION]=c;e[g.POSITION]={size:3,data:b};return new m(e,
a,m.DefaultOffsets,"line")},addVertexColors:function(a,b,c){var e,d,f;if(c){var l={};c=a.getVertexAttr();for(f in c)l[f]=c[f];a=a.getFaces();c=Array(a.length);for(d=0;d<a.length;d++){e={};for(f in a[d].indices)e[f]=a[d].indices[f];c[d]={type:a[d].type,indices:e,positionKey:a[d].positionKey}}a=new m(c,l)}b=b||[1,1,1,1];f=new Uint8Array(4);f[0]=255*b[0];f[1]=255*b[1];f[2]=255*b[2];f[3]=255*(3<b.length?b[3]:1);a.getVertexAttr()[g.COLOR]={size:4,data:f};c=a.getFaces();for(d=0;d<c.length;d++)b=c[d],e=
new Uint32Array(b.indices[b.positionKey].length),b.indices[g.COLOR]=e;return a},addNormals:function(a){var b=a.getVertexAttr();a=a.getFaces();for(var c=h.Vec3Compact.subtract,e=a.map(function(a){return a.indices.position.length/3}).reduce(function(a,b){return a+b}),e=new Float32Array(3*e),d=b.position.data,g=0,k=0;k<a.length;k++){for(var q=a[k].indices.position,v=new Uint32Array(q.length),m=0;m<q.length;m+=3){c(d,3*q[m],d,3*q[m+2],p,0);c(d,3*q[m],d,3*q[m+1],l,0);f.cross(l,p);f.normalize(l);var D=
g/3;e[g++]=l[0];e[g++]=l[1];e[g++]=l[2];v[m]=D;v[m+1]=D;v[m+2]=D}a[k].indices.normal=v}b.normal={size:3,data:e}},cgToGIS:function(a){var b=a.getVertexAttr();a=b.position.data;var b=b.normal.data,c,e;if(b)for(c=0;c<b.length;c+=3)e=b[c+1],b[c+1]=-b[c+2],b[c+2]=e;if(a)for(c=0;c<a.length;c+=3)e=a[c+1],a[c+1]=-a[c+2],a[c+2]=e}};return v})},"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports","./Util","./ComponentUtils"],function(m,h,d,c){function a(a,b){var c=a.reduce(function(a,
c){c=c.indices[b];return a+(null==c?0:c.length)},0),e=new Uint32Array(c),d=0,f=0;a.forEach(function(a){var c=a.indices[b];if(null!=c){var g=c.length,l=c.byteLength;e.set(c,d);a.indices[b]=new Uint32Array(e.buffer,f,g);d+=g;f+=l}});return e}function b(a){var b={},c;c=d.getFirstObjectValue(a);c=c.data.length/c.size;if(c>k||null==f){for(;c>k;)k*=2;f=new Uint32Array(k);for(var g=0;g<k;g++)f[g]=g}c=new Uint32Array(f.buffer,0,c);for(var v in a)b[v]=c;return b}m=function(){function f(e,g,k,v){void 0===g&&
(g=f.DefaultIndices);void 0===k&&(k=f.DefaultOffsets);void 0===v&&(v="triangle");var l=[],n={},p={},h=Array.isArray(e);h?(l=e,p=g):(p=e,n=g,n===f.DefaultIndices&&(n=b(p)));if(h)if(1<l.length&&(k=l.map(function(a){return a.componentRange[0]}),k.push(l[l.length-1].componentRange[1]+1),k=new Uint32Array(k)),1===l.length){g=l[0];for(var x in p)e=g.indices,n[x]=e[x]}else for(x in p)n[x]=a(l,x);else{e=d.getFirstObjectValue(n).length;h=g=void 0;k===f.DefaultOffsets?(g=0,h=e):(g=k[0],h=k[k.length-1]);var r=
h-g,z=g*Uint32Array.BYTES_PER_ELEMENT;e={};for(x in n)e[x]=new Uint32Array(n[x].buffer,z,r);l.push({type:v,positionKey:"position",indices:e,componentRange:[g,h-1]})}this._id=f.getNewId();this._faces=l;this._vertexAttributes=p;this._indices=n;this._componentOffsets=c.createOffsets(k);this._primitiveType=v}Object.defineProperty(f.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"faces",{get:function(){return this._faces},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"vertexAttributes",{get:function(){return this._vertexAttributes},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"componentOffsets",{get:function(){return this._componentOffsets},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"indexCount",{get:function(){return this._indices.position.length},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"positionKey",{get:function(){return"position"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"primitiveType",{get:function(){return this._primitiveType},enumerable:!0,configurable:!0});f.prototype.toRenderData=function(){return{id:this._id.toString(),faces:this._faces[0],vertexAttr:this._vertexAttributes}};f.prototype.estimateGpuMemoryUsage=function(){var a=0;this._indices.position&&(a+=12*this._indices.position.length);this._indices.normal&&
(a+=12*this._indices.normal.length);this._indices.uv0&&(a+=8*this._indices.uv0.length);this._indices.color&&(a+=4*this._indices.color.length);return a};f.prototype.getId=function(){return this.id};f.prototype.getFaces=function(){return this.faces};f.prototype.getVertexAttr=function(){return this.vertexAttributes};f.getNewId=function(){return f._id++};return f}();m._id=0;m.AxisOrder={CG:0,GIS:1};m.DefaultIndices={};m.DefaultOffsets=new Uint32Array(0);var k=1,f=null;return m})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require",
"exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});(function(d){d.length=function(c,a){var b=c[a],d=c[a+1];c=c[a+2];return Math.sqrt(b*b+d*d+c*c)};d.normalize=function(c,a){var b=c[a],d=c[a+1],f=c[a+2],b=1/Math.sqrt(b*b+d*d+f*f);c[a]*=b;c[a+1]*=b;c[a+2]*=b};d.scale=function(c,a,b){c[a]*=b;c[a+1]*=b;c[a+2]*=b};d.add=function(c,a,b,d,f,g){void 0===g&&(g=a);f=f||c;f[g]=c[a]+b[d];f[g+1]=c[a+1]+b[d+1];f[g+2]=c[a+2]+b[d+2]};d.subtract=function(c,a,b,d,f,g){void 0===g&&(g=a);f=f||
c;f[g]=c[a]-b[d];f[g+1]=c[a+1]-b[d+1];f[g+2]=c[a+2]-b[d+2]}})(h.Vec3Compact||(h.Vec3Compact={}))})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports ./IdGen ./Util ./DDSUtil ./gl-matrix ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),function(m,h,d,c,a,b,k,f,g,e,l,p,v,q){function n(a,b,e,
d,g,l,k){k=!1!==k;var n=new Image;n.onerror=function(){l(null);n.onerror=void 0;n.onload=void 0};n.onload=function(){c.assert(1<=n.width&&1<=n.height);e.samplingMode=k?9987:9729;e.hasMipmap=k;if(c.isPowerOfTwo(n.width)&&c.isPowerOfTwo(n.height))e.width=n.width,e.height=n.height,b=new f(a,e,n);else var b=t(a,n,e,d,g);a.bindTexture(b);l(b);n.onerror=void 0;n.onload=void 0};n.src=b}function t(a,b,d,n,p){var t=c.nextHighestPowerOfTwo(b.width),h=c.nextHighestPowerOfTwo(b.height);c.assert(t!==b.width||
h!==b.height);d.width=t;d.height=h;var r=new f(a,d),x=k.createWithAttachments(a,r,{colorTarget:0,depthStencilTarget:0});b=new f(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,maxAnisotropy:8,preMultiplyAlpha:d.preMultiplyAlpha},b);a.bindFramebuffer(x);void 0===p&&(p=a.getViewport(),p=[p.x,p.y,p.width,p.height]);a.setViewport(0,0,t,h);n=n.get("texOnly");t=u.identity();a.bindProgram(n);n.setUniformMatrix4fv("model",t);n.setUniformMatrix4fv("view",t);n.setUniformMatrix4fv("proj",
t);n.setUniform4f("color",1,1,1,1);n.setUniform1i("tex",0);n=new e(a,q.Default3D,{geometry:v.Pos3Tex},{geometry:l.createVertex(a,35044,c.createQuadVertexUvBuffer())});a.bindTexture(b,0);a.bindVAO(n);a.setDepthTestEnabled(!1);a.setBlendingEnabled(!1);a.drawArrays(5,0,g.vertexCount(n,"geometry"));a.setDepthTestEnabled(!0);a.bindFramebuffer(null);a.setViewport(p[0],p[1],p[2],p[3]);n.dispose(!0);b.dispose();a.bindFramebuffer(null);x.detachColorTexture();x.dispose();d.hasMipmap&&r.generateMipmap();return r}
var u=b.mat4d;m=function(){function b(a,c,e){this.data=a;this.id=b.idGen.gen(c);this.unloadFunc=void 0;this.params=e||{};this.params.wrapClamp=this.params.wrapClamp||!1;this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1;this.estimatedTexMemRequiredMB=b.estimateTexMemRequiredMB(this.data,this.params)}b.estimateTexMemRequiredMB=function(a,b){return null==a?0:a instanceof ArrayBuffer||a instanceof
Uint8Array?a.byteLength/1E6:a instanceof Image||a instanceof ImageData||a instanceof HTMLCanvasElement?1.3*a.width*a.height*4/1E6:1.3*b.width*b.height*4/1E6||0};b.prototype.getId=function(){return this.id};b.prototype.getEstimatedTexMemRequiredMB=function(){return this.estimatedTexMemRequiredMB};b.prototype.dispose=function(){this.data=void 0};b.prototype.deferredLoading=function(){return"string"===typeof this.data};b.prototype.getWidth=function(){return this.params.width};b.prototype.getHeight=function(){return this.params.height};
b.prototype.initializeThroughUpload=function(e,d,g,l,k){var p=this.data;d.flipped=!this.params.noUnpackFlip;d.samplingMode=this.params.mipmap?9987:9729;d.hasMipmap=this.params.mipmap;d.wrapMode=this.params.wrapClamp?33071:10497;d.preMultiplyAlpha=this.params.preMultiplyAlpha;if("string"===typeof p)n(e,p,d,g,l,k,this.params.mipmap);else{if(p instanceof Image||p instanceof ImageData||p instanceof HTMLCanvasElement)this.params.width=p.width,this.params.height=p.height,!this.params.mipmap&&this.params.wrapClamp||
c.isPowerOfTwo(p.width)&&c.isPowerOfTwo(p.height)?(d.width=p.width,d.height=p.height,d=new f(e,d,p)):d=t(e,p,d,g,l);else if(p instanceof ArrayBuffer&&this.params.encoding===b.DDS_ENCODING)d=a.createDDSTexture(e,d,p,this.params.mipmap);else if(p instanceof Uint8Array&&this.params.encoding===b.DDS_ENCODING)d=a.createDDSTexture(e,d,p.buffer,this.params.mipmap);else if(p instanceof Uint8Array)c.assert(0<this.params.width&&0<this.params.height),d.pixelFormat=1===this.params.components?6409:6408,d.width=
this.params.width,d.height=this.params.height,d=new f(e,d,p);else{if(null!==p)throw console.warn("Unsupported image data"),Error("Unsupported image data");d=new f(e,d,null)}e.bindTexture(d);k(d)}this.data=void 0};b.prototype.setUnloadFunc=function(a){this.unloadFunc=a};b.prototype.unload=function(){void 0!==this.unloadFunc&&(this.unloadFunc(this.id),this.unloadFunc=void 0)};return b}();m.idGen=new d;m.DDS_ENCODING="image/vnd-ms.dds";return m})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require",
"exports","../../../webgl/Texture","../../../webgl/enums"],function(m,h,d,c){function a(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}Object.defineProperty(h,"__esModule",{value:!0});var b=a("DXT1"),k=a("DXT3"),f=a("DXT5");h.createDDSTexture=function(a,c,l,p){var e=new Int32Array(l,0,31);if(542327876!==e[0])return console.error("Invalid magic number in DDS header"),null;if(!(e[20]&4))return console.error("Unsupported format, must contain a FourCC code"),
null;var g=e[21],n;switch(g){case b:g=8;n=33776;break;case k:g=16;n=33778;break;case f:g=16;n=33779;break;default:return console.error("Unsupported FourCC code:",String.fromCharCode(g&255,g>>8&255,g>>16&255,g>>24&255)),null}var t=1;e[2]&131072&&!1!==p&&(t=Math.max(1,e[7]));p=e[4];var h=e[3],x=e[1]+4,r,z;c.samplingMode=1<t?9987:9729;c.hasMipmap=1<t;c.width=e[4];c.height=e[3];c=new d(a,c);a.bindTexture(c);for(e=0;;++e){e<t&&(z=Math.floor((p+3)/4)*Math.floor((h+3)/4)*g,r=new Uint8Array(l,x,z));a.gl.compressedTexImage2D(a.gl.TEXTURE_2D,
e,n,p,h,0,r);x+=z;if(1===p&&1===h||1===t)break;p=Math.max(1,p>>1);h=Math.max(1,h>>1)}return c}})},"esri/views/webgl/Texture":function(){define(["require","exports"],function(m,h){m=function(){function d(c,a,b){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=c;this._desc={pixelFormat:a.pixelFormat,dataType:a.dataType,target:a.target?a.target:3553,samplingMode:a.samplingMode?a.samplingMode:9729,wrapMode:a.wrapMode?
a.wrapMode:10497,maxAnisotropy:a.maxAnisotropy,flipped:void 0!==a.flipped?a.flipped:!1,hasMipmap:void 0!==a.hasMipmap?a.hasMipmap:!1,level:void 0!==a.level?a.level:0,unpackAlignment:a.unpackAlignment?a.unpackAlignment:4,width:a.width,height:a.height,preMultiplyAlpha:void 0!==a.preMultiplyAlpha?a.preMultiplyAlpha:!1};this._id=++d._nextId;this.setData(b)}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",
{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});d.prototype.dispose=function(){var c=this;if(this._context){if(this._glName){var a=this._context.gl;this._boundToUnits.forEach(function(a){c._context.bindTexture(null,a)});a.deleteTexture(this._glName);this._glName=null}this._context=null}};d.prototype.resize=function(c,a){var b=this._desc;if(b.width!==c||b.height!==
a)b.width=c,b.height=a,this.setData(null)};d.prototype.setData=function(c){var a=this._context.gl;this._glName||(this._glName=a.createTexture());void 0===c&&(c=null);null===c&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var k=this._desc;d._validateTexture(k);a.pixelStorei(a.UNPACK_ALIGNMENT,k.unpackAlignment);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,k.flipped?1:0);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
k.preMultiplyAlpha);c instanceof ImageData||c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement?(k.width&&k.height&&console.assert(c.width===k.width&&c.height===k.height),a.texImage2D(a.TEXTURE_2D,k.level,k.pixelFormat,k.pixelFormat,k.dataType,c),void 0===this._desc.width&&(this._desc.width=c.width),void 0===this._desc.height&&(this._desc.height=c.height)):(null!=k.width&&null!=k.height||console.error("Width and height must be specified!"),a.texImage2D(a.TEXTURE_2D,
k.level,k.pixelFormat,k.width,k.height,0,k.pixelFormat,k.dataType,c));k.hasMipmap&&this.generateMipmap();d._applySamplingMode(a,this._desc);d._applyWrapMode(a,this._desc);d._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(b,0)};d.prototype.updateData=function(c,a,b,d,f,g){g||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var e=this._context.gl,l=this._desc,k=this._context.getBoundTexture(0);
this._context.bindTexture(this,0);(0>a||0>b||d>l.width||f>l.height||a+d>l.width||b+f>l.height)&&console.error("An attempt to update out of bounds of the texture!");g instanceof ImageData||g instanceof HTMLImageElement||g instanceof HTMLCanvasElement||g instanceof HTMLVideoElement?(console.assert(g.width===d&&g.height===f),e.texSubImage2D(e.TEXTURE_2D,c,a,b,l.pixelFormat,l.dataType,g)):e.texSubImage2D(e.TEXTURE_2D,c,a,b,d,f,l.pixelFormat,l.dataType,g);this._context.bindTexture(k,0)};d.prototype.generateMipmap=
function(){var c=this._desc;c.hasMipmap||(c.hasMipmap=!0,d._validateTexture(c));9729===c.samplingMode?(this._samplingModeDirty=!0,c.samplingMode=9985):9728===c.samplingMode&&(this._samplingModeDirty=!0,c.samplingMode=9984);c=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var a=this._context.gl;a.generateMipmap(a.TEXTURE_2D);this._context.bindTexture(c,0)};d.prototype.setSamplingMode=function(c){c!==this._desc.samplingMode&&(this._desc.samplingMode=c,d._validateTexture(this._desc),
this._samplingModeDirty=!0)};d.prototype.setWrapMode=function(c){c!==this._desc.wrapMode&&(this._desc.wrapMode=c,d._validateTexture(this._desc),this._wrapModeDirty=!0)};d.prototype.applyChanges=function(){var c=this._context.gl,a=this._desc;this._samplingModeDirty&&(d._applySamplingMode(c,a),this._samplingModeDirty=!1);this._wrapModeDirty&&(d._applyWrapMode(c,a),this._wrapModeDirty=!1)};d.prototype.setBoundToUnit=function(c,a){a?this._boundToUnits.add(c):this._boundToUnits.delete(c)};d._isPowerOfTwo=
function(c){return 0===(c&c-1)};d._validateTexture=function(c){(0>c.width||0>c.height)&&console.error("Negative dimension parameters are not allowed!");d._isPowerOfTwo(c.width)&&d._isPowerOfTwo(c.height)||(33071!==c.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),c.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};d._applySamplingMode=function(c,a){var b=a.samplingMode;if(9985===b||9987===b)b=9729;else if(9984===b||9986===b)b=9728;
c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,b);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,a.samplingMode)};d._applyWrapMode=function(c,a){c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,a.wrapMode);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,a.wrapMode)};d._applyAnisotropicFilteringParameters=function(c,a){if(null!=a.maxAnisotropy){var b=c.extensions.textureFilterAnisotropic;b&&(c=c.gl,c.texParameterf(c.TEXTURE_2D,b.TEXTURE_MAX_ANISOTROPY_EXT,a.maxAnisotropy))}};return d}();m._nextId=
0;return m})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","./Texture"],function(m,h,d){m=function(){function c(a,b,k,f){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=a;this._desc={colorTarget:b.colorTarget,depthStencilTarget:b.depthStencilTarget,width:b.width,height:b.height,multisampled:b.multisampled};this._id=c._nextId++;k&&(a=void 0,k instanceof d?(this._colorAttachment=k,a=
k.descriptor):(a=k,this._colorAttachment=new d(this._context,a)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),c._validateTextureDimensions(a,this._desc));f&&(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),k=void 0,f instanceof d?(this._depthStencilTexture=
f,k=this._depthStencilTexture.descriptor):(k=f,this._depthStencilTexture=new d(this._context,k)),c._validateTextureDimensions(k,this._desc))}c.create=function(a,b){return new c(a,b)};c.createWithAttachments=function(a,b,d,f){return new c(a,d,b,f)};Object.defineProperty(c.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"descriptor",
{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof d?this._colorAttachment:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});c.prototype.dispose=function(){this._context&&this._glName&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),this._context.gl.deleteFramebuffer(this._glName),this._glName=null)};c.prototype.attachColorTexture=function(a){if(a){c._validateTextureDimensions(a.descriptor,this._desc);this._disposeColorAttachment();if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,
b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a.glName,0)}this._colorAttachment=a}};c.prototype.detachColorTexture=function(){var a=void 0;if(this._colorAttachment instanceof d){a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;this._context.gl.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)}this._colorAttachment=null}return a};c.prototype.attachDepthStencilTexture=function(a){if(a){var b=a.descriptor;34041!==b.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");
34042!==b.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");c._validateTextureDimensions(b,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),b=this._context.gl,b.framebufferTexture2D(b.FRAMEBUFFER,
b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,a.glName,0));this._depthStencilTexture=a}};c.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;this._context.gl.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return a};c.prototype.copyToTexture=function(a,b,c,d,g,e,l){(0>a||0>b||0>g||0>e)&&console.error("Offsets cannot be negative!");
(0>=c||0>=d)&&console.error("Copy width and height must be greater than zero!");var f=this._desc,k=l.descriptor;3553!==l.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(a+c>f.width||b+d>f.height||g+c>k.width||e+d>k.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");f=this._context;f.bindTexture(l);f.bindFramebuffer(this);f.gl.copyTexSubImage2D(3553,0,g,e,a,b,c,d)};c.prototype.readPixels=function(a,b,c,d,g,e,l){(0>=
c||0>=d)&&console.error("Copy width and height must be greater than zero!");l||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,b,c,d,g,e,l)};c.prototype.resize=function(a,b){var k=this._desc;if(k.width!==a||k.height!==b)if(this._initialized)k.width=a,k.height=b,this._colorAttachment instanceof d?(f=this._colorAttachment,k=f.descriptor,k.width=a,k.height=b,this._colorAttachment.dispose(),this._colorAttachment=new d(this._context,
k),c._validateTextureDimensions(f.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment(),null!=this._depthStencilTexture?(k=this._depthStencilTexture.descriptor,k.width=a,k.height=b,this._depthStencilTexture.dispose(),this._depthStencilTexture=new d(this._context,k)):(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments(),this._initialized=!1;else{k.width=a;k.height=b;if(this._colorAttachment instanceof d){var f=this._colorAttachment;f.resize(a,
b)}this._depthStencilTexture&&this._depthStencilTexture.resize(a,b)}};c.prototype.initialize=function(){if(this._initialized)return!1;var a=this._context.gl;this._glName&&a.deleteFramebuffer(this._glName);var b=a.createFramebuffer(),c=this._desc;a.bindFramebuffer(a.FRAMEBUFFER,b);if(!this._colorAttachment)if(0===c.colorTarget)this._colorAttachment=new d(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:c.width,height:c.height});else{var f=a.createRenderbuffer();
a.bindRenderbuffer(a.RENDERBUFFER,f);a.renderbufferStorage(a.RENDERBUFFER,a.RGBA4,c.width,c.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,f);this._colorAttachment=f}this._colorAttachment instanceof d&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._colorAttachment.glName,0);switch(c.depthStencilTarget){case 1:case 3:f=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,f);var g=1===c.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT;
a.renderbufferStorage(a.RENDERBUFFER,1===c.depthStencilTarget?a.DEPTH_COMPONENT16:a.DEPTH_STENCIL,c.width,c.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,g,a.RENDERBUFFER,f);this._depthAttachment=f;break;case 2:f=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,f);a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,c.width,c.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,f);this._stencilAttachment=f;break;case 4:this._depthStencilTexture||(this._context.extensions.depthTexture||
console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new d(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:c.width,height:c.height})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");
this._glName=b;return this._initialized=!0};c.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof d){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)}a.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(a=this._colorAttachment,b=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),b.framebufferRenderbuffer(b.FRAMEBUFFER,
b.COLOR_ATTACHMENT0,b.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(a));this._colorAttachment=null};c.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,1===this._desc.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,null)}a.deleteRenderbuffer(this._depthAttachment);this._depthAttachment=
null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),b=this._context.gl,b.framebufferRenderbuffer(b.FRAMEBUFFER,b.STENCIL_ATTACHMENT,b.RENDERBUFFER,null)),a.deleteRenderbuffer(this._stencilAttachment),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),a=this._context.gl,a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=
null)};c._validateTextureDimensions=function(a,b){console.assert(0<=a.width&&0<=a.height);3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==b.width&&0<=b.width&&void 0!==b.height&&0<=b.height?b.width===a.width&&b.height===a.height||console.error("Color attachment texture must match the framebuffer's!"):(b.width=a.width,b.height=a.height)};return c}();m._nextId=0;return m})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["require","exports"],
function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];h.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];h.Pos3Color=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,normalized:!1}];h.Pos3Norm=[{name:"position",count:3,type:5126,offset:0,stride:24,
normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:24,normalized:!1}];h.Pos3NormTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];h.Pos3NormCol=[{name:"position",count:3,type:5126,offset:0,stride:28,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:28,normalized:!1},{name:"color",count:4,type:5121,offset:24,stride:28,
normalized:!1}];h.Pos3NormTexCol=[{name:"position",count:3,type:5126,offset:0,stride:36,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:36,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:36,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:36,normalized:!1}];h.Pos3NormTexRegion=[{name:"position",count:3,type:5126,offset:0,stride:40,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:40,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,
stride:40,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:40,normalized:!1}];h.Pos3NormTexRegionCol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"color",count:4,type:5121,offset:40,stride:44,normalized:!1}];h.Pos3NormSymcol=[{name:"position",count:3,type:5126,
offset:0,stride:28,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:28,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:24,stride:28,normalized:!1}];h.Pos3NormTexSymcol=[{name:"position",count:3,type:5126,offset:0,stride:36,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:36,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:36,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:32,stride:36,normalized:!1}];h.Pos3NormColSymcol=[{name:"position",
count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"color",count:4,type:5121,offset:24,stride:32,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:28,stride:32,normalized:!1}];h.Pos3NormTexColSymcol=[{name:"position",count:3,type:5126,offset:0,stride:40,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:40,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:40,normalized:!1},{name:"color",
count:4,type:5121,offset:32,stride:40,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:36,stride:40,normalized:!1}];h.Pos3NormTexRegionSymcol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:40,stride:44,normalized:!1}];h.Pos3NormTexRegionColSymcol=
[{name:"position",count:3,type:5126,offset:0,stride:48,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:48,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:48,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:48,normalized:!1},{name:"color",count:4,type:5121,offset:40,stride:48,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:44,stride:48,normalized:!1}];h.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];h.Pos2Tex=[{name:"position",
count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];h.Model=[{name:"model",count:16,type:5126,offset:0,stride:128,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:128,normalized:!1,divisor:1}];h.ModelCol=[{name:"model",count:16,type:5126,offset:0,stride:144,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:144,normalized:!1,divisor:1},{name:"instanceColor",count:4,type:5126,
offset:128,stride:144,normalized:!1,divisor:1}]})},"esri/views/3d/webgl-engine/lib/GLTextureRep":function(){define("require exports ./Util ../../../../core/Logger ../../../webgl/Texture ../../../webgl/enums".split(" "),function(m,h,d,c,a,b){var k=c.getLogger("esri.views.3d.webgl-engine"),f=function(){function a(a){this._glTexture=null;this._refCount=0;this._glTexture=a}a.prototype.incRefCnt=function(){++this._refCount};a.prototype.decRefCnt=function(){--this._refCount;d.assert(0<=this._refCount)};
a.prototype.getRefCnt=function(){return this._refCount};a.prototype.setGLTexture=function(a){this._glTexture=a};a.prototype.getGLTexture=function(){return this._glTexture};return a}();return function(){function b(a,b,c,d){this.NUM_PARALLEL=8;this.textures=a;this._programRepository=b;this.getViewportToRestore=c;this._rctx=d;this.NUM_PARALLEL=8;this.id2textureRef={};this.loading={};this._queue=[];this.listeners=[];this.maxMaxAnisotropy=(this.afExt=d.extensions.textureFilterAnisotropic)?d.parameters.maxMaxAnisotropy:
1;this.maxAnisotropy=Math.min(8,this.maxMaxAnisotropy);this._needsRender=!0;this._fallbackTextureData=new Uint8Array(256);this._fallbackTextureTransparentData=new Uint8Array(256);for(a=0;a<this._fallbackTextureData.length;++a)this._fallbackTextureData[a]=255,this._fallbackTextureTransparentData[a]=0!==(a+1)%4?255:0;this._fallbackTextureDesc={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:8,height:8,maxAnisotropy:8}}b.prototype.resetNeedsRender=function(){this._needsRender=!1};
b.prototype.needsRender=function(){return this._needsRender};b.prototype.aquire=function(b,c,g,v){var e=this,l=this.id2textureRef[b];if(null==l){c=this.textures[b];d.assert(void 0!==c);c.setUnloadFunc(this._unload.bind(this));g=!0===g;var p=this._createGLTextureDescription(c),l=new f(g?new a(this._rctx,this._fallbackTextureDesc,this._fallbackTextureTransparentData):new a(this._rctx,this._fallbackTextureDesc,this._fallbackTextureData));d.assert(null==this.id2textureRef[b]);this.id2textureRef[b]=l;
if(c.initializeThroughRender)b=c.initializeThroughRender(this._rctx,p),l.setGLTexture(b),v&&v(l);else if(c.deferredLoading())this.getLoadingCount()<this.NUM_PARALLEL?this._loadImage(b,p,v):this._queue.push([b,p,v]);else try{c.initializeThroughUpload(this._rctx,p,this._programRepository,this.getViewportToRestore(),function(a){l.setGLTexture(a);e._needsRender=!0;v&&v(l)})}catch(u){k.error("#aquire","Error loading texture: "+u.toString()),l=new f(new a(this._rctx,this._fallbackTextureDesc,this._fallbackTextureTransparentData))}this._needsRender=
!0}l.incRefCnt();return l};b.prototype.release=function(a){a=this.id2textureRef[a];void 0!==a&&(a.decRefCnt(),d.assert(0<=a.getRefCnt()))};b.prototype.getLoadingCount=function(){return Object.keys(this.loading).length};b.prototype.getIsLoaded=function(a){if(null==this.id2textureRef[a]||void 0!==this.loading[a])return!1;for(var b=0;b<this._queue.length;++b)if(this._queue[b][0]===a)return!1;return!0};b.prototype.addTextureListener=function(a){d.assert(-1===this.listeners.indexOf(a));this.listeners.push(a)};
b.prototype.removeTextureListener=function(a){a=this.listeners.indexOf(a);d.assert(-1!==a);this.listeners.splice(a,1)};b.prototype.getTexture=function(a){return this.textures[a]};b.prototype.getMaxAnisotropy=function(){return this.maxAnisotropy};b.prototype._unload=function(a){var b=this.id2textureRef[a];void 0!==b&&(b.getGLTexture().dispose(),delete this.id2textureRef[a]);this.next(a)};b.prototype._createGLTextureDescription=function(a){return{target:3553,pixelFormat:6408,dataType:5121,maxAnisotropy:this.afExt&&
a.params&&a.params.mipmap&&!a.params.disableAnisotropy?this.maxAnisotropy:void 0,wrapMode:a.params&&a.params.wrapClamp?33071:void 0}};b.prototype.next=function(a){if(a in this.loading){delete this.loading[a];var b=Object.keys(this.id2textureRef),c=Object.keys(this.loading);this.listeners.forEach(function(d){d(a,b,c)});this.processQueue()}};b.prototype._loadImage=function(a,b,c){var e=this;d.assert(null==this.loading[a]);this.loading[a]=!0;var f=this.textures[a];d.assert(void 0!==f);setTimeout(function(){var d=
e.id2textureRef[a];d&&d.getRefCnt()&&f.initializeThroughUpload(e._rctx,b,e._programRepository,e.getViewportToRestore(),function(b){e.next(a);e._needsRender=!0;d&&d.getRefCnt()&&(d.setGLTexture(b),c&&c(d))})},0)};b.prototype.processQueue=function(){for(var a=[],b=0;b<this._queue.length;++b){var c=this._queue[b][0],d=this.id2textureRef[c];void 0!==d&&(0===d.getRefCnt()?(d.getGLTexture().dispose(),delete this.id2textureRef[c]):a.push(this._queue[b]))}this._queue=a;a=Math.min(this.NUM_PARALLEL-Object.keys(this.loading).length,
this._queue.length);for(b=0;b<a;++b)this._loadImage(this._queue[b][0],this._queue[b][1],this._queue[b][2]);this._queue.splice(0,a)};return b}()})},"esri/views/3d/webgl-engine/lib/RenderPass":function(){define(["require","exports"],function(m,h){var d;m=d||(d={});m[m.MATERIAL=0]="MATERIAL";m[m.MATERIAL_DEPTH=1]="MATERIAL_DEPTH";m[m.MATERIAL_NORMAL=2]="MATERIAL_NORMAL";m[m.MATERIAL_DEPTH_SHADOWMAP=3]="MATERIAL_DEPTH_SHADOWMAP";m[m.MATERIAL_HIGHLIGHT=4]="MATERIAL_HIGHLIGHT";m[m.MAX_PASS=5]="MAX_PASS";
return d})},"esri/views/3d/webgl-engine/lib/RenderSlot":function(){define(["require","exports"],function(m,h){var d;m=d||(d={});m[m.BACKGROUND=0]="BACKGROUND";m[m.INTERNAL_MATERIAL=1]="INTERNAL_MATERIAL";m[m.STENCIL_MATERIAL=2]="STENCIL_MATERIAL";m[m.OPAQUE_TERRAIN=3]="OPAQUE_TERRAIN";m[m.OPAQUE_MATERIAL=4]="OPAQUE_MATERIAL";m[m.OPAQUE_EXTERNAL=5]="OPAQUE_EXTERNAL";m[m.TRANSPARENT_MATERIAL=6]="TRANSPARENT_MATERIAL";m[m.TRANSPARENT_EXTERNAL=7]="TRANSPARENT_EXTERNAL";m[m.TRANSPARENT_TERRAIN=8]="TRANSPARENT_TERRAIN";
m[m.OCCLUSION_PIXELS=9]="OCCLUSION_PIXELS";m[m.POSTPROCESSING_HIGHLIGHT=10]="POSTPROCESSING_HIGHLIGHT";m[m.POSTPROCESSING_ATMOSPHERE=11]="POSTPROCESSING_ATMOSPHERE";m[m.HUDMATERIAL1=12]="HUDMATERIAL1";m[m.HUDMATERIAL2=13]="HUDMATERIAL2";m[m.LINE_CALLOUTS=14]="LINE_CALLOUTS";m[m.LINE_CALLOUTS_HUD_DEPTH=15]="LINE_CALLOUTS_HUD_DEPTH";m[m.MAX_SLOTS=16]="MAX_SLOTS";return d})},"esri/views/3d/environment/resources/SimpleAtmosphereTexture":function(){define([],function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7AAAAOwAFq1okJAAAAB3RJTUUH3wgSDDQn8uZvdwAAIABJREFUeNrsvdmObduyHRQxdu767FPfEvsaY0CAwaYyQgYkCsl+QSAKCQn5/z/jBg85xxhRtCh6nzNzrWNOPqyVOecoexnRIqI1JqJviEiIiB//nz/MzCIi5x+kfyciEpHzIGJmIaL7BHXc+fnj7+s+6lB4fXWP6//sR18L3J/Uc/HjesKPA87n1++j2oR0O6jnv67jPid1XXNP9d5MRKLa8XzQ85lgu599otvlPP/xjPo65zOdFzPPpz4zfafbOvu/aHfTpr4fks/Et9f1MvZzduMOjRFzjnuW0E9JX5n76/+z78NkwT9hfrm/y5/B9Wnh3h993p9//vzz558/gR9m5uPcCLK9NflemvOouaZfaNB37O4lzWLKybXFXQudU527tWCqjWp0HbDBTtpYkvZY6U9J2io7hpp+4Y1xwIt/r25YVX8v9bM2Lj7ix19fGxnV8cgAQs/qjZnVd/SGSHZPZByh3zvjBrXFKxa+V17vzz9//vmTNACO43g7F0S3AYW58fCyGGwkeoESsHlDLx0hBH5tcd7a9Zn3kL1HiJAEdG/t3fpzMhQiaRf9v9lo1GKqURKELiAnEz2DoGfz13TGR0BePJJzruG+zas2Ql59ZtR0iEK2Fus9w19eITb6ef1GhN7XjFP1LGj/1e3KCcLiO+361SFMpK/nx7p6T4MGubblYu9i1/++neFcy/ol69+///u/v9r4OA6uztV/nw99nuP/9s9TGTX+XH2ObpDjOFg/r/7s/F8bBcxM52cTVCZDsPz90TXQc2THTFChJ5GiP//8/9QA+KwfGXioGdzfee68+TwVAlChFBmisOqRVuGNpyHYyrDZ7DNJkBku2pXcu3J3j3ONL/p3ihQRfRyM/VEQ+QrqNkG3qGgXbuZlh+5IguCtIC1coIN/Uj/nZl59d27mfmP35+njuvuh+/rv0P8TQ2PlmOr9Xv2TXf+j7/tvlQFARG9ExMR8rs7vn4vQ47P3Sak8iOu7e5c5zU9R3wudaMF57On5as/n9DjfzXe6ficS9d197B1Lty7pec/4TH5HPN/rvrZ+H/3e9/vbxc5/r58p3seb7fb5qs/PPtHX1W15vzd67rgwW7cP941vE/v/2S90tcO5YL/3jYB28X1hn8F6wbjvUFtln/nv9N96POsN6TZI9Lhid39rcGRtfrcxX3Mgevq2//TGZ+95t7GdC3FTje9oXWncHnFDRs6jnn/+OVf6LZuP/nP7LlkCSjR8zvVB9198Jr9maAtc3PqWjQdxY86PaXLrUVyf8Pvje8W2Ybg2ozmH5kfWN9n88vMmS8aJY8jPBwrvh2BCPS/R+osMxft8aoxe/D2CdtF+eb8DFefZeeXhU3S8v24BO5HL6Vo6Pz4of1s8/NSD+shkocq738lPmHpMVHg7HZIhw7ar4umofbtrdue/ut+ebf9Xo0jAGw2363I+Mk/034aEuK6/qhyJKRIhxbitUAMuUJ1sDkzG9SSX5KkEzdf3TTtFugNk0IYdiipU52at5FLRYh99ZrMLtk6Rl5tZqdl1M8usOif3WurfsfeYn3NbDt+RgAGFp5uQEJ8+x/v57dZ5nnn+e/nR6hr6uqSur+/P6kwyT6DPsU9nz2Uw+OpUQj7t9xJw1kfsps9l5la15ddmgaiWovCUZ5vbNr1bRbeVqHPZ/Z1NfAajgNQY8Ne+n1hAH+g75/2XBSqIdtMJBb7NLNDg21/MdfC40//G+6N5RVc/ov6Nv1EYE3krSmhpDv3O7knjuNSz1farn1c72ziHNSbfEMU8c26uc2l2COgNCde2vRLbWlxL+BUVXYnAmktuvsR2wiNJMm81zDZp3cJJCrLDq8LaRGF/IbVGZX2S9UYWMNTtHVcl1PKk9o7cVGK3hlG6H2Tu57qJZedPWNMem3/TV+8GwMwTfTp7emsJ/lhrW5ph01nY1HTnNKt+pS269u88uApJ4GYJ/JpQngnywmBrmECC3HjHHZJDhVnSeZyz+fUsjrI/9jdQmHJznlzXbxmd1zlFCajxhGUZFXq+X56ZN13OzCoC0I3v+nNvzqK5YE2anfWfh2vyl0bvptVaK5Vfk7FQonNMzN9zsyJI42w+vhMmYjCDDf5xfqXxLnENwgm+4s953E9ObEM/ksZ+PW7jjaACIwl/vzcaHoiP43SZxPVc0uzolVUw2V0kaXNRTVdguumi9+jX80MGzygab9LDhc9sdYdJ6e/0pcBDsNzHXh+rsebfK7zesP3P+99cCYPVjocgD+1dS78bGsv+ncL8k/v9GZxzHa/6hRLcUMdT0GrKbh24xr/rgzB/QJvbUtp8pWM9NnU/TuMGqM05rk+o38TN+XQD1u1Idv3SayL59lftxOD59Vzx88Fgwn5+NesGu/7zx5n57DcWHuxCHXjJA4+LZufpMW3aTu1B2byC05ltfwvbto0VSq5PwNjP2gqte2gcstvTzD4IPjfzg+m9auQHsS+DRnKXPdzF0iYZyFTYHzuxow+J67lBNPEWJ3vA1COr2pYHx2jDpF3nQFByZFVu9NG4byam70IAZhWFWO2XFjESu3FNclC68byC0E368jNQnskeMNiXR4hdF8zpxjoP9qORJ+s33yfbe/X8pTnwAmDj2bysKdo0ReXoE9v6s5Egv1elfgcz8w9gDCcv2GEF3XrbrXGre0Z4FonGrzknSbQJ64A4h8Y5KuwcteBEur+9IyYEnDV9LYlGJKNjXcP4Y43zQWtVXMgQJbB3TaIOBrRBzityJLM9m60zyu53b595x8a8kzsQgR2mPROjwFInOCd1MdLT7V+pjayfG8wL7STDpUIcaJIAM0wO9GELzBAAHAwYBBz9MC+l2WsT0EcIgE2JUcRDFL3Lhy4TFSSCBqVdTtFJDf5GNn7ZAX8AlEMAahgHDNoEJMrBtcU1gPlMv4dfTyU62d6BpsaPpAQ46uzxACy5tQpiSRp04cLecM43WmcMiJC8oIDJHwBeAmPArUscQBBmPn5c8Hp2Yg/dytYxyU1i0hOk75UW2yus7QUjbuTdrFjIPGwjHo4JtEl3Hti07z/b8l7JR1jxanjgYAGUskWLOst5EgPfRWQ+M9b6EYykq/evdqJuvZr8vpObs7s2uQ3m8xIXhrv4SoRt4oVOz0PZ+lOEbJLW/Vlr2WjvYObjJ5fvWT8kl7nk/nV19r3Nzu8CA1Wmt7+azSWvpo5+bp/r3AOH9l1wZquAN0BvrvO345CxV8xzwn02caxMiFn7the7FBpeWIJlA2iuj0dtRmUL+eoFct+hDHabW+8zf2syHX9fPCJ9lYi/X9bOeZLZSioi7mOcopX1QawAukcS3rJsb6wl7XWbRAfh0UJIY5pUO2npVy7cu2GqoTHabrZE83DfZNQx7YeadhKRvxRMvxrKmvR7dQ41xlG5cjMfx0/b9sPa4KXhw3deDS8uFDTwbide6LMDl54cvLs195VHzpuDesr8xwuLULcAr7LdvRLlya67W6FADWJWb4piSiKnk3/C9jf18HHbyNgkmcyhr6w2/6njVipqJijoFJWZrp2vmAtfEulZrVjo5sYqj8tKbsor2/HpOcJ8fPNTjCmJaxyfzH4lNGbxUgKxBwKJrQLiQO5lJqjZCp/PNPc+nOvyAib3D7kHOs6K8goIxGMFFznoG5q54eJ8hCgHBZ8b2h4UQZR7edFnE6ePFtfQjDzFx5qzfJg0agTmgYn9+XN8zFAS1xvE8EpbDMRUQz/q71z+gR5D+pwJhwtmcrYxf8ia9zBRVCio4idB7JWaSU+Ew7marRKzruln0Ox5CisCuQGW2ZLMNd8/s2yZZniqe9xtEhng7v9JMaWKQZ0RW6m+j2f1G22rkLfmZlC0zxFZD20bPbAhYcX+qnCri72SDMPi/RwC2BPFMFRadlnfh/n7x7bjRCq23jBj/0tynzm7oj0XlCwLBQZIrYFiuYT0fLvbFC3Qejze12YSIebjm5/p6/gBO0Eah6mqnKZx6wYu80mDWXIGT2GrVSCcaF6/v+OUTqsOmF4LPU5zRiaVJsX1jCE1QRd2YN4XWPFlf+0gaSvVJDse1UjzofBQnkX6+rafbo6rm+jHrHMryNAkNLBScbPDVnp/rqnj93lNvjR60yGlDMbKs7wZz+hhdPlaK5LkxHx886sB/Dglj+gWplVId3XwTJOSvpYyjopba/XYCffdNHFysoBPYK9nwicfuXC8ArpfMTpXyIW6+TbZLGmjT1fS3T9ykX7WiF8Jb+0kolKzWUz6ZQK/P0PAtXPOs4b8tJ2nse91Pv9neFOf2yumpaGfve+0axfz8c0vRMssSiuL0ZfcaKfW9arSXWUoTbDy3QV2NUb1p/Iz8XCqhXfq/a4ke004L1b78bNrvZ+dM5MNcrJpTzbDiQ7G7pq06k19Kc9/xUnqrrlqoNPG5jmpJNlh1ZQn+uuVxs9KftmKgdOhjZN1q+OoGKFHpwFQvb0A1iHPLMUcz4FBWs88RnmhOUuRSOAC46G4VJ2jGc/8O5034+Q99ffm3pSwOq2uZBO373F98x7JyBDQF9kMF0RC4gq9s5EKGcYShjdfCOsTBRBrYLZ6+GJv8gX+YAXwCSvljJq68+54GC9C8SodoM8YNJPnlIYtzjOOoaSScIzEIv00kSHZYc33FIu3/WqUsQaOVvkpPOhZ9pIdzrSTJHNHt2NS1A2TfdgRMAggUHCJViSRzCAs9hyZUM04J9sPgaSi2UHZMQ1OLBTEhFdZZT6JKmPpoyThJmNVRHNHOFkb/FqeaImSgPUpa1f9p9jrGiZNPb/AfK6eK7D9UQ8FByKZawwexze/AGa4lSztHVjeXHfAiPVKS30JwkoO8plikyx7xEQ0tcq74w2FZ9Y3IJtw6g0/5Z1WbfiFkJ9RpjxKSlnwgjrEgTb70z8Q6tOXQ4U0D1OtqtStlvlN2WI7lGYKx6/Y6ztzqDxuce6s8FR0aE22369k3E9CWDsssd2LfRgK9+SiFRyFBRShRNcFMzhRg84TH8c3vyafhRnszyT7sFIc9OfcmaZYt93oHDEHPW2buUvksx5tpqN+RqR3zi6hw2bCao1vr4WePz9qKzKZsCjpKKozivrOZhVnevf+eijD+m4nDufhPrSDKSphism47mHeu491tjHKco5tGrNl/f2tdrjjD2Aps4azzWLa1ui58z5AcwXPqay9bbY6p31hr3Vna98Z6vU891neMTMdz0vUdrZdfNZ3zLrWc69ra9s3OvM+a2/gOxLuH8PkcT03h8oHXLGgxx+HDG+blU0ua56S65GrIKh04LFxatcD23b6s7v/yWXo53PWfh7nHvodzQfbXmg++QQ9Pw7x9QRIg6CKAL0H6DYTZ38wqPCyVS3YcETn3XMp7gnzz6ndz9VnfHzz9psFi39VE2DCFU9moZnkFpxlDDNFtc/yLldjqkx7BuU0Jp23z73Q0LDvgLqbCFg8d5P9nkUhVrkQci8WZ/tOGRJxn/synLkXJ0XbZ1nYXSy2zzPBffuaeYU33Ukseie2bTexhkccrDPegZgITD9LVoM2ohetXINrze5XkKclJW7r9f0T1ce47tn+nkSKJtHbZ34m11xXAPSGfbZGNO3Lxzdvv6Wvo2xjZyNegdBXoWKiNUKBKcy4Qnn7iuz5j8icnxowU0h4sjnKwsR9lvXt1SQdr6hG+aiQyWSjfcaYnSaV7YYcP4ow6GsgItrpx6kEeTcPVzPrdxL3vmSbTgkwiGahqxXmxpV1sWtDor4SIj3/NABetQCtlpqtKHER0ZjdqiuVezo295WgCs+Ws00GOi1O/CkSsVJnvxPTe6b/phtdT7j7mrk0YfZbiYHTcE6+CqH5krSsvPg30TxGvWNgdWOW6Pn49ddgrOxwh0wcI3qi3VfWsB3lx4kR+Yr+fdWaRnx88+3vKCRnm7nAkVWOOSaNX8+Pkovdtco9J3mOCbLJghNMZYcQYpKgtGI5r3hJqxve12plv8KLXSnRWVm8p6VrRGtkQZPy0p0+elWy5is2UVowJncRlkmp38SrXZH0febZvvR8mZbKTjzglXEwRUxW0LpdYrDVDfoj+mQqGT41hlYF9bq+sJVUDwPgsz3UxXpVxPYnU/ma1cXzswk4vpT3M+239fhU73Vmk2ILxhp64aMJ8QUW9h2FzSkMv8uHvbKBrrA1yuI4+ExDc9o/q1UQHRvohC1xuhFPx/XKmP9IXouPmFfVWjEd2zQ03DuvlDb3kk9rVz7evv2d0UV7v70o/bVsmHllPKuihnjCiSzv950dHyeDzQBFWbgouUrSjF84XIqMYM1FbTNIKc1Ofv/bcmLjzHR9nZjZ/X6dmDFqM1L1c0nKIS4yK3ny/NmYL51AVYTPHE4zTl27xr7Ijq+y8TOpcpxJLK7agwH3tuOMJ/TgiKKBkhf0pc8ATSPBut2+LPy633kcagSiQBtAMo9gLNl0gI4j3ae0PoNE+g8pFnSoUU+YhoIRNQNos2tQaOSR1DWKzdJXjvjngFQIqK0rTfcFYGvFCZxyCwmoDg/LGNKJyUrCkvf0NAhhCDDQoyBc3o+uoelddJ8LeL6pbtbK/t5yADmdkkzPBFIFAK2Y1LZzlYKPxf14+/b3ja35GmtkZTPOFgJbftN5juswDK4uiD3pS0NwhmY+Q1HpzRNG3Ob5szhclm3aZwuv8MY/G6KJpVXrcKPXtJvGyCehIFnrF8SNNQo1VLCp5x1a6YMVZK24d2ZteG6dURjma1MH3MmRotrzD94FNZxRU3Y4sB4a7rbVteeVScsfhPSEQ3egdaK15GekH+M58lbq/1fW/VFuFB9v3/7By9Q5vN2wGfnP1Ztwsgoak0+ZcIGxCcYosDxeZ2Yblrgh01ubOJCsSBULnCDWN8oqr+PIqZj9BCVkMHaPOGPkIsyUh84VwKwoSA4y2SkEtJFnneuwbfZ9OrUCy8xQDEpcVdeuo97fkd3OJTmEzHwfw9rMPMeOPNyY90Yy54kT2n18dvfb45jzuo/Pzntd36n7s3o3BMz456lAmet+6hrMXBDbDMrA3e+6HRLg6rqmlcx07UJktOFY943qWyJdJKu00x7HmN/1+7v3ZP9Mum99/2UOSnKNclMFfZhp4hU0EHG8u/6yhDJqXLs5YvoxmW/m3PP51fgN93Zjk93fotqBXD+L6gd4Lb/s6D6ogEjf7m4sCmpzBIYSWJcQDUZCGWLeHc2L8zhmYv7m7ds/LmAZEwtxu/xpl8ZqMS7UrU3BIhNHE0xYI3Ua02RPCZntTZLgVxxZFHeUvr7W+B20tBNKaer2d70Bqk1hinPvqgR+bsPNS8WtcZ+3xUpeQjpNz0VmhkzEez/OJ5pxU5j+0sbORlvi9en+jorv03Yf9NM092NnvVth8iOaqzu2607y3isiWHostOvXLnVCszaIW1Pi6W58iBhDcmVuTqvhqEF8+hjUbQBwMxjbCj4XzxG31xm68UxX3cUrUip0ilTXRloAOYoApAiU545+exxzQ/T2NKMCGItaNfHWbO762JePiwXZA09BnjFMOjpzCBpQpBZH/SaAWl73JbmYHbnz4N4PqPdFZvtPZ//CdVRiu/qYG/MM2SMCNp5YiQZB9PpojDnK9mxAswOcJFlUUFUQOaDKg4YC4rNlzmGSF7HaX6v5cF0/kyRU/smDoHf249bHdA0g6t5bP2BKS48eqVif/LUNSDuwc6f2HYHxT4P1MMtHCEC12mc8sOwp/UmSyjW0D3C+bwWA03UGJ6GV8I4cpWzSvb6YC9RFCoK/yN+8ffcXeEaEOGQVL/pIqcXP9j4nfASJRZRp0EsWIaHEqV3xxlZ5zldLoT6TPOcjkJ0s/jf1ZpBeT/c8xWoMozqrPOkvCpe2TuVuBUjzfaoBQ4nWDuivbk5l91rnnadUX6b0pL+0WmeSaMkrZZwrY5GH15qWw3JCnS/F0ELJht1Psb49IxdDBQDDVLRfc73ya5AAycl+Yg2Aj1jIV+utJ9DeyubcwWA7JEUTKP2ZiT81lJ5N/BuG3Mc11tM2nsBV0zKc6XjdIbl59ruNBeIpg+cVbb25mbdEXTvj/msyNKf9uQLXr0gkTx0WWpgLzzpkO3Pvs50CeXKMTxPJV6TMJ7D8irjUbn/eUPA3b9/95eKmOWmk1QHcbVRT/OlLoQrPUOJOUx8mNcM7saMJgkM0zzPYbf+viRZ0x5iabKorvOdE++RRvHjNj2b02yG04Rdcb0IaNK2imBiQr9An+Yya8R04aJUNccpJMXVQuv1i9+drqjJ5FoVb5hQ5DQBdvz/pRiYGDR+76WQUqJYnVTev7hjv+85W4GRWzJOw+SRe6cxeZdDx97+k7nT/LmBAxibn8Jw6Y5aTjVXAXe529t/iLbmzTyuwkobmGJ6mug/EMUEErSvzThTaPBtHug38tSW0k+WmyJZy/8wEezIoh4VjZWCb6/FUg36TLSo3LSSMbir9Ej96SbVblr5XrQDZDPC9T+Z7PdbjaNHPjFcicUwm2JTlsHrpVoujQ0ZbX+wvvZJUOJuAMadH5GyTzc7O35TDG0fznxULBh5htqfqjXMSbMFtyclIXSvZl8VnYDBP8Iim0E7i+gSNIgarTvat3RcYrGkMypcFvKOeazdTzTfffvdXi3bHjkezAhPHbb2Hg/fhL4ED7jWQ+zr427ctHvBTDm0Z/k2Dz1e9xnW4MLYAvgZuqY+34Os5Qltzw25mvVmAFumZgA7Rag5I3MCn7fwCFcFyLg0rfZ+YmXtMStn6stJGzzBZzsKRUjiA+/2z1ubeTYv7wbRK4RVuUNd2u+g0La5v83kjwAgdnMXffPvdX6lS2JMe7Wx5fhgdJwOPnJ8/jArBaxfBde1xjrlHdT4yfCgYSgwMME7/d/d7ZGRx9gyi3hU4P+b54IDX7Xe+t3PpVWr+nQEN3H4+j0ne9+qfx730NYFlJeE9KDE4cyM0b5M4G9i0ZTVGQD+Lpj90bcHuWV3J5dX25zNc7QXa0PTZ43fxfeLnhhtDou9LgLLOZSw7HY5nwpi7a6T5XFM7qM9QBUpavaPvIZE9UQabK0sCGaJqHonUH4FOxD2HoAohSAVaV4/U+39tX5X2RPI8hhaDZtWR/poVe6KvOiHGFWKizyXKq6rIVvKYsQ3Y/IgA059dAtNNcRrJXIkUCZhw7KuSVZtw0Y/hWMGJeqaiTj3IVTFAkYqFJLKKoiotU+0j/Pbt93+9Z/Bdiy1cnSzP6ov95FlyYJu1rTYB8cYPrYnChNFTGUOf4YN6Q2ajjVEfT/JApm002Z0Ybeq0GUtVbTJKsnkcX11n1B9S9l/J+tft6ogzquJ7pQ0vcrqLrfx8DQl909jqBMlZCZ4la0tq1EnCrWX9DFhJFKbojm7D7s/GNcoqhS6gxcNrVxzxk+CEKykeee6TKjmi55A0XXI7Po/fvv3+b4aNu1KOtiLpOHF5qo3l1SppKwlGOwpkE9GJafVCV8WwsBe1MORqdcKXWOSfNSZXwjNpW4AiYONaRSPHXhMIBWSFxtnKol0sGjBn+kLxrtN8HbBlTssnLaofNm4RWfeRgPsUYIVsjgCm0iCi4KCGQGjhx0kySVmimIAMFybUV+Y6YDIFEgJqrOkVJahkceoIONgRdaWwVkZuILidA3wkNWzDDhqCbZ4QIJb9Q+D43Q1nWHoWoDfALuvnkLdw0jCfAAPgS1riqypbEzx0pRytMlgmFQ2r2fFfs9rgqo76xIqebLoTfHTaVyvoTWdIvrw/X1AbuOIppUXImfsJdLUD62XC5tWta0SvKa+kxf6lzmhbKb4uoJtndBZWSpzN+xc66NNYUovkefpuqtVmiD6m6uFVDsHunqJx/al66U5lVrUmdQ7deI3kt2+//1tjE922kTg7iZ2ynf5MMV+L/f3KSmSOdlOwqWKDnve4FfEICAJpFTdrD+r7ezZspF6n1e5OxcH7eFaiM5S+j7cx/b2QsI4914sGKTXENE1shepzGjp5ReLRiuzyl4SGVwWlVg3VDomZGC8Dp2Gse7/Sx18bRP9Mnf0ENVvRbl81TCfP+kpE86NRtRVnYaW2njfbeyKVvbIpr5QH7iTEfkbfpn3Ab9/98O/QXpb2s5zoSabxApEzOjY/322XQoCpuci2VkZINkC0dDEpUJO3NdE5qVfYtay3dRo+cCHpDJFu4vDivTqvcbddXq2b/pGb8TNhrmoj3DGeuvDWKg8tPbHAfqmNdmccd+jmFB2qUIvpBvkRe8IrrvclDaNdY2j63YTnQzqj6jQAPsoin8Sjp8xlKynSq17qZHF5fGY0CWToUAOu+0ybr5Bgy5AUTpKXcxTGFScxQZQFozkZOqQqWc25uN1jjqi45+dgXMHq7iCVZZEbhPJg9Gn2WURtJCBk/p7xXHHIlEeKxLy/KD23qFNHFGWR9Tn6+d/b/e4/Bm2RS1ZH6bEZMX9mpJ8GM0Lm4nFJ1DZB3rL+tqiinVumuprFIm9qjtzPbVE7EU6eR1xbIsRTj4msndDY9888c45EpSig8WrRU0qR0G7edPPBj1M/p9CcQQhxHMOsxjupNYGNVLvue/s+9jM7N1iNAzIOop5fur/jfIxrW0Sc98Z5PvbDep8ZAM+yVq3ETp+9xwc6QFvMcNgQyRGHGpay5+0y9CGEZRVy3IP6d6W5eji383qmbQJESceowUQ9kxpPKz4LCnPFfqOF5/gaNNn70Emmn2bHkG03bGiuhlRoc9y+kkXu1RTsr3TU+hCGrtSdK2zWa2Psg91wI0V09tOTk73xh8ZXX+Fg58hKJQtlCMA/oD+9nwm3027y60S7gBaO2ZFq/NKxV3oC3lqFF3cIZSbw1kfQFT/bb9MS1Y/anFeIu1aqXIhmCZRdSdzXNhdWDLjZAr4vu9wt7kTzstwJwdeEXGBXcvGjxvQqQUZ3jeka06HKE1lYojUir5fkSvHbdz/8ww0PTGguJJM1xDNCO/QVLxqrCd5dFcETFAGOAAAgAElEQVRK5cJK4szqorwiVvGquOsruOd3ec9X1c2mBuozXP8TBGJibH2txufqnFrdLHkwH2hh/VqJUb9qnn1WP+3mdEzWlukxO2v/BJHZyef52pIzX4KmBgPAs9GRZbMz32Xsb4410FxbAkk1ekrMWKf+VqUu1/eG2MeRvpjnZEc2oVn8TrY4CjXFV/q9IacRU/5LJgDt3vdsN30f1iQ3SduY66nj9LvCwV6x/nl2RcTAiI7LzlXMgwyOLxeThFHxGm+633y/OqbCFAU6n0GPY4Elt1lpubms03NnoF1PlJRw05wzZHePh3azLs3mGpQwv4tldUM3MN/boWs/90F8dx/Tfr78GbVRpcNOlsVvbIv5wPaiX6QPMHrw5FjZOttXLFteYOqjWNWp2eWuawCKCMRMp/ObAqOdo1JQ5KXxM/9e+hige0+uzdN9FvXv6v67g7yt8OCsHFchapNjVg1ZuGjw23c//B0Tpwuzp2KtLEK9GVNkxvM0sFP96RIFcGx+EwtcnIHjN8AV2D79LmGLSz2WBebEp6x3wBBo3kMbJc5AmdQ273gzbXsiRj7wbNI3ymp0YwnM6Vj9PGPfAMoN11vllxVLnaspQsdyzBVytFo1JM+BZsX0WedLXmWaU0aO5xFaKRNLOV0GXv+I5Q38XbLWfQJYI4DPp9hGMJ8URWOmRKanxsDKur5SiTRFe74oFwx/+/2Pf0dWEUvfps7G14pEVGgYUap2F9W+vMaYGHUjq33Eg/8JSJfsb0m2qC9uc0jvLFNH8662VeGiREGOjJoXA4UxDkprsV3YtTATNWqDExNopYp2tcqXgdxF7BNxYxFSaz22QHGJyTdDljtG+yj8DkOc35W1yKxaWWxe83lddvd5t8rVPczyaa8VuyJZhqpk+uw79xyknof9MyXXFfVcJ6xmCfpdfzzaHjH6aTdTHIE9JdZNKMMhAMEwcJOBKEHgWXXE9yOPg2hdTL6zunxtRBKU9m3BFJnvuLIcnQCDJ7AXAIdBd9+T1rNjTWTrrGgk9UQFDTrtm9VrdRDQVWnQZarQbYDEIkRUgNaI+cyhwYmjYu6l9WQgCp08uygEWt9DmJj42+9//EcfFGPAClGZHs2e5TaJS3uJxs6i6+bd6xJfrBDy3nVyzcA8CStRRgJCstWWjGN1fk717xnlYWdx09Y8URs70QdxoC8UOejNUzgX7V2hgp6YWwgumyS6ltwV6r0vo4l54OFIGsdYyVCc9hNi8NvNvJwgB1RBuM37eQUZ4XUOec/YuGLSM/UqOKgdN3B4yUTHKrRy5CYkqPXK3KqQ1BWEbNWF6quDhign92gPTwyAKYd9t4GN4PjdF/4oaGQRHtwhd5hyy0+TZDpIbEpZ3Bkhk5Krlc31M4iHVpLDJmGpdoNs+mvC3rdKefzSENbLXYLYClbkdS5NFFEej8JZNM2fi67C5jyPYiKpaSmQM2q3lOzJZJkSaVpD4E3t7G160yauCxzQzuhYZAr1Ue6XgRtZIYNsnHEKLoWYtyR3DpsWWHftpogmPheP4YhfW1RYEhHhTPCe3W/qyvzt9z/+u4NF4Utlo06ts53rTDnrp1wH86VvncHpS/7sChhNN+YOLV3Nnl69104ZzopRSk/24WrFwuS8KYfC1Btezd/Jl8BIdD3Nxl5p54+YVyjo2M2b/DpY311AmDRf1zzyhkORU26RKTrJDfK3slqga+2tWv35M8poCVj7pHKLXNs3UZ0t4bXpWmsv+u33P/5jh1AJFvcqEzYoZqBSkVGaCRwF7QqkeUwUtafdc6vQh0mACtrKqjGDkBv1lVerGdtWiGm9ZPQEXzX6ZtFl3Gdek9voRCd63uRCgPqCSN87iLZlLIkcxdZ0tjwnbIsT1Gy7P9D/Pgysx7LXUz/bnrH+d4UIB136zH0Qe0ygVkv0e7wwHcyodqFgRLlndcTVuJB5+3pRwmWtJTf/S/AFaNcQ6Fu9BvmJp7PdTSY8g/XShcLRJPZsgFn4XpLGDCJ6DQjlQ/cTm3sXFCS0tjkterRRmXUfaE2Fa5DdC8QJB0oyodPKHLCAMOoHmVXbZOO89A2z/vdjn9eY08uIyYkA/PSPqa9Faqzn0LdgRAlSj8yygsHAXfGK8tDluh0ZnrXwUEOW7sQD2IH/V1IXv5b676ka1hC1McquXhUTGEPVKhh0yKeEL11W+zPeanL9TEX1ZeGRpD9giZgUFQ0Tvv+VcFiyewWDtlppd1UGaWMN3ABzCGyC/oRyrK7MtWk8fFdJcKGdhJM12qvbSr7XwAqJVbigyegxVR99sGROpuT3SrLOLuoPYzRNxhlci/jb73/695JUnSmAMhUumMDmq9BMB9d3VJFTk+5rzUlYCXesMl3tsutN1NO6ifFsgt7XQn/7Uefuxvangi+yOPYneQur82bynivGI9FMJVAWvqdmc5wqD06Nn1fMga8prPjM+USzkORuocU8K+V1P5/eN+8GwNqAXLWQdwbtZ8fDd9S0iPaKl6fGzXq1wwzHo4VFbNqvX0Li8lWLSrcwy2b7riBpqyQhrzBQX93G0+LOSR31NH+GBoboLmvpq8bxl1rDXjEHujFJNK+iomZ9mToZE0d1yuj40XNnmru2ovpItFI83RiP/N0PP/+TKPpG/BB8Ov/Q3zkMwYp5RQGnZnYwi4hwco/zi0epkRE6E5HAgEfMiiVQHW9wY/sZ+8+BQNmjPvv63j40vTeVfgd97HXA9cosSPdERMKgfVznun8OHGLBON2mWGfFtCXpfj/HgbuOb2/dtL423tfSXzXkj79J//3+jgEMNQu6rhN3JX6MmsJPbr4Lcn0tu69RF31//Q5Jjbsb1xbQBeCiLp9L24QZH6/bIo3a2/p+cVP55CAI9fvs8rj1kEJtp56X1TWQSBmrEkjf94YTgTmUTPr3Ys/lYOdy7NdMOA2B8P67x2e+bcL0ctcXz4GQ8U4wxwVfjStWnBB6bEfaPb7e2Y8d/zk0qFTfgbXV9IHXw3w/jlXSG7ncfCo4XHos0Obs4xTJFbxwUnY8CWusoKwTo5hojf6zMyzL6/N3P/z8T/Tm6ka2MFBpUhvbTlbcBHL+2iCr3tS726+08JChMLTgbYD77ps7q8x+Zv7Wxshwiqg+kR1IjPVm3PT/l/SCViDd3WcZKdW5WvquxM8v7npTIXVNvRmjvliGJJ8XeHy6omQ3JJl5TNog2hWk6kIr6fUSDgW4+L+g7ZP1KxghqdFKMfA88TanTKJ1CDHSujl1yGUUexfFW13DVsTCPg194O9++PnfX4T26SuDe6dprdRYUCsQLzVw1W7t+MSQWjSSVkv+Vx4/HSoS+d6xfUAhUztkr5PjRU/aOVR1aL+WIpHZ9ZyEM3ehP084i31qhD+T7rBzrm/LUN1AoBqHIi+/sO0znZCl+0Tc72E8SVeVZL/0/clFP5fREp/FT30EC1WgZASFNNhvuuqvsw+IAeGgmlPo7/RdJCFGJIJ6AgIy6e/zpYHqT8Y+p9lBAqpFtLYKAVp2oItykdcI2Wka6DU1tSb4LkFML6dJI58exfbIs0Z43X39tfz1L9QVLdqPc9g9t7jrXyi5QmfVrSNar5z992O/++Hn/+AFmzHRGunKShxzYnFPY0hVHGgqm7lTp/kRRs+UtXACaanPYJZtYkiFbPcVy79oQ1N58Vnx7VeM/13VOlCCO0IAKs745Pw0W3pCPERNFcKkcuHVc2OHJ0FXjQwRA3FlqkSDyieioLsB+f+L/hZJ5tjq2kS0lhS41EeIRld9vtJHK7z+Jco8QFuXpXvdhswOkA3HOpQWhmhX0Lgq1LszP/i7H37+D4febxfzoEGM5GtZsCclUCtxnm5wThI5aDBJV0MsUwjza9lEJ4bkrgQsFQuMLLZTZ2StQoNEe5nHH82i+Ezb0sAIXdkEZHFtmfbD6tx6BuL9CAPnVf04zZx/JnF51ah/1d7xkYmez8omr/TxaoVXu1d7A+AzvNSduAUNG3ClznVlMe4WfvqKjJxV5rGdc1drYScoxcQr6sqznvFudjTCP3rh3vF0Vxf9ztjYST6aeqe7uu9fg4G6u1ivXoMWEcoVhHNnnD+Tt/WZTsezpesdajkhYabFOfXpOXBvdAoFvaOGtwATkYSU/vfjblEi/9DMhwu2oIBLlCO7sjtd8EZUvDKTM3u//mE64IRn3o+/73s/T33NOzajSErZZ/DR1Ubnc9rv/DP6d+6TYeJzZZ+f9xESOa5+ZOZUAs621f2MNpWZk7Ryny1qN4W7TY7rfe7rnN/rcXP3V7wvu3Z8H3++L/04eb+novAUhu9m21TfV8xnIniCx/a773cf4NjjTFw+iZcHLXl3QIiDH3HQkbtWYE9jt9BkjJxEVspW53cAnR79HYNnCDkIyWJsGEOp0Q2a5v50mxhanKe8I/raB3gOXvRw9fFHsXFNDApuDHNa2NzQNSl53xVNjomhTzQrkT020Ff0TtN25sW/KRkbqK0+LCmWv/vxV/+Rabg8zTQ2JDq2SlPNv1v3NE+DZU1RrbPmOuhRv/u9EWljYB1i/ih4se6nPRTHfmcEtyZXvoyQyUTss+Fug0zKe+bjkYl51bu17RvKsTqWy/EczmLJE2+eQPzZUaxy5bUMyXPKfALXJtqQSOlzdxJdVzzWCQr4CrRyFwYmmpETTdaYZ8vOqPFgp4ymnaf7JbRPXoF0Tvp2QkjVoTQTvpVtIjttAPBG40xg8VWIfrop05PwyZeMsT47EHcJWSYe1AqpBA/7eDWZ75l2/9jkSy+a3I9EpDn2MBgt3kNWbOQ8hmGhEwUR8lxrLd+atZqbuM/0c5G5FheLUUc9FY3BiJglJAPGeNQZ1FWBv4AKlRsZE4c83WiVR340Anif65+Rr2fU6GOOYAl8bo+OZY4WQjGz985Rw/y8DL1EfWbP1ShwvtaIqjawaOX9t27P934QZ7zjcXKfx+p8cojjZB9h05+6z7Jx54/V5deAfybtd+TAVPfO+sw6Sxrt59MAWIknrViIXzLO8xHXnaqkddDP1HtYie2tWpa7ntRqe/CL+mIHzhslwtAsuca2P1YDW+H977Lu789tK87mVhQUfe2cwq0f+0YtNmbj89/7UI1eMF3G9RAmJncfcRsG+ixHjvSivoO2raOf02s5UhzAYtSjkDsQffcZIJgPbWgR1dv40s9fqB0ut/XecSuITY+KzhwkPw/seJ2yg6L5Y56fv//xV/8xUV2HNNQhhLVHvtZGrNKPALvfF6aG2yYSdrp4Fxa8enko1RJS7LJecgrtGuywTjRDUryTBtha0uOSyR2qe8MCendPo/TilHXEF8sTkBdM2k/3jSR9KEB2EBWO63dJd/GsSVf0zty10v6aZCwSzVgWgAQiJ9fzxdpmLiA/2BEgZP1LoADc970f89Jh6hzlCGGfVJZRl6JOA6u7gfeg+pjuG8pVhjJ5TRj3YCxxitbA61wJNfRQglEQkYUn0qDXJ7t+huP2rCT2iu7DtAqrdxKeq4b7lGqt0wBYLWUym2dhPobFpunNr4FTHo2qrTKNZKRMuOen4Y3q/gS0SdPrgMwv3YeZpnP63Ehf9cX9shviqLyaVZ4JoTyLbxRm8swr7mEnY6MaK9uLyAugm/YS4mTgkgUI9htwFiaIzwq3wpQhaxR6TOCqauy8dL5sbJxEs/LnKRvsRFF1l353V0TslSx+RLNQ7TRvbaLCODF4SoSHv//xl/9ktvd3c6czhtJnFOD4NQ1b7p9ZQKxb4LWjrtdgSdYHwIaGnGVk+Huilx22vp01f9pPmc63BwG6vcqz+ZGTbYWs6+ScFnBhBoloHkxCDYroq4UStsAu6sIA4AAdMeUamfRJWmKPABR3UQiueb11sg57Br4wIGsS1856PlYOflZtYBj7gKNcRrr08VnbJUx/fi0hnmnhhL0cAB/EkXhImg0FVnA4yWDDmGnWLFHPlMhWGDY+x8J3Bs9bWduEvQ+8kMDv/blCMubD9EhzhuB0O20yMwOSQ4AS1DFsIWQ2fMZYP16kmCicO2+U0DgGRFyfzN//+Ms/bSyRSSyIaLTSQS1r8O6cIXAy9E1e4gXh51xN/l31jrYTUifSpwVXuXChMy5As5tAuZoUbZZYN1nW/DO69y9PDZnOiabeW49jhOrDSNzIiqa9LO4d4IQX5uGus5qxJHLjYHXt1s0VYAWINOOQAcCXzY8MxMoqM2Q4DEfzI2PrSzZn9XDiNmYGi3o4l/z5OgOW1oiHysiQC1tLglpygnK2bbdAbgORH37R6vSKhKvwLt//+Ms/BY58lsccjxOw6L8uynRnQbMZSTUwG58b5TjbrGydg31+p/8Vl/vMYV7ENiDw7OjJdA443q4Z6mixy7rm5Ig+CsbhDYZmwwCkENcOjdNVblc2bx2X4uE+tyMKGys+2c6uWPFvMrn6eKWTZG5MI440OG4lKIA+YaCsZt+GVLv78W/lWeK9pTRP7B10izH5uoNss44KdHGk9cLD9fq1A3JPCvPQ2hLXGbSi+F29WlcXqKh7iHUG2aMygcygyXQhDOoohX6E9K8DNzJnE5joKefHpM3h9RooamsQOkYisiPuGRCiGHg0gF4EOYSaDCLL3//0y3/6pNPk842nPPScoD8d3mkLpPxGt+fx83g7C5mtwSR5nZdZ90ktM+nL1Wbmoh2oAjA5uwRNdRcqc00WW4eD2dS/W8MV0LYzL/TXLhumOAOlXnT70ZKbbfUbvSYOjedFvkX6/n21ezRBoa1B6aso1hwsCUWWBApIV3TpV8uWvXPWed0fDJSVKOmqOmTlkkz4HlCoDoRnRhTlla5ElWMKkH9Ong/lQ0/7rR62pwGwo1jXPcwzPM5fWmFwAvHu0HlOJvuz7f6Zbfk1CvV0Gb4r4a0dHvRndBomc+qrSZLdmD+dYzDdGF6lFUA0S7pdSYhadyKeaWdvCmdIKXKhIiuERRpzIV6PrWEzx17L/yXuf3JsFAzuqluwdrwEMmMIGDGRv2KFASWu7pK0HCVmIFRPCm4uAxFkjF1KgQSH0cHf//TLf/YBk51pppI28bKI5tnbtLDQjPS3aU2X/UszXK303zyAUm92lTexsomuZCfSYNF+hWH6USIir+YpX2GMq9p3gs+uaAjI4rz6jLanwbrAC+vTzvmTSqBV6fUcjfL0UtN+WMOyuESX9tCaKe4iSeZhDNbODdWJU4b4QKb7R+c09GO8CtsP5w1//9Mv/4yCkXBfXpqsfBeIfmR0MSnqJmWovt/TZaOav29u1ofWcUJoRld2jc10JaA7rc/nQKA2/3uSQCNtpSO+Lr1n4aYLgToGd6TT4rYdzg5KIpSkapsVljND2oFsXwZJriie11UHoWqDJSJIX83hEsrEH0sxRkcKgtMJjbDtsvL8JCNcuLl3klzs/4al9nG62DYTnDFPrp9WWGXLdTOr+PHUHIXDH66NKO0koTxw513vqd/Lx38pqSxB4wK1kUtuDtfL9gbXLxOAamJbpZVGSbWvPgnl1CEzwbR1Y/CzDO16jv3BCY0GkWtfv54hKgt/rO83V4lSJTOvsCbD/kCJ/Jz4XqBCjpK+ifsA//DTr/9ZsWKoWTHKHC2MsTUbb5J5iq712ARXrt/VLBLNOZ5XLckUWXhQSo09J8m13geW4UsdIbDaptnQSZuGioTVtt9VrCO7aXOxIqX8R4Oy65UKh7G7hLLldxQCi7Ysqz6mCNNEzbHiQlqJezYwfJVVn+kcdHIjSGMhGBarE7ChJEmv2aAxiNYjXcMGaJDI3HBchQKeQYLS/IMNLCJQUAgYM0kFG1xHGFQvuvaH47noj67q6roN8w8//fqfg9SRyARux71nIcczhENMhlw0AjOIs4s1EYx/SMgX9nEjC/xI6oLHDGD8dwW3TAIfUuSgoxgeArJi/IgUy/M5PG8zXb2jsiVFsSW8r+j6fFczS0AGToCr4l1ZsNMhtxO5m55cgUAhdIvPyfD7ycpSuArdLqLdep8u7Gc5asNqV5SkzTUMEywwl1oNCQsQLMCE04qrdqcNGT+iGcd1tlDzgLWPoksIiQfAXED1yqHOnLAFAMNark+Q+7cT/nhl2PEjaj4nQka7+TsTWH1S9dDBjKsCU1+DTLK98Q8///qf05w1iYKcCX/gg38M0z9eg1DaS34mTpXB+dmrSlix0GfABPSAPkgJL9MDCpGSMhvjqTLoginbX6nHt+gSdFnMXPhnE1bZqZpWh/p08Yh0PopzzUCjfLrORuF+Cnj26bWyBX41j2PCMIpqr4b2RMr4OF6unqn7/oz+bebWZB72rk+Pia/km3yG0fPKnWolM2JiiBDN8q2o8334h59//Z/jOVG6qVltZBZv9u/oYxrNGgcdS1BLqR3SspA9ozHPqLzRGE2c1iwOOzVqVyoXM7ZUpNrKYhTU3v1DUQpU9WT3WaueySDWllsjUXMaUEizIFNtrlEgr8OHzSCbDztZQmooANeRT6f0VOeSgkndPbPXCIy0aQwZKhi8Ly5My82beiFi0NfZ8Vz0FUHELTPfML/Cqq+WT03EQ0BEgbuDM7ma5gl4sLMi9CBL3GCHCmX0iOFa9RCdQw6dhYHQmsYin8Y1EaNYi+RUxmtB4xBY/whQa0qCHnIkMVqRV4WF/lV/lIbpDz//5r9oUDb3TCg+6+McGXvYsqZ1hfJ9lKU3NNjLuNskE5uS2tHCEQiskryw0NwG0o6obfd9Vnv/utryQjUNICZZOGXNi5mua5PIw4rOQOuNAlIiGnlL0m5nte+3P3MwrjWPDDBA3lC4UqABMfOaEMnObCxLu9Z1qNLTijeDsbm11iWaDWjxGtOkJrSOnddUra8rSAI8NskybgflM+tZkaVaJbKtaFuE0/UfpwHwWSVrE7naaQnhIPy4TShBL168V2NFUwhAZk29qu1gUH5y3O6UZ1Kv7KlI+CzoBxDQBlBfBD2GzKDOeORdIk4IxxKlLGMVckq0VumIjHturoeE+Yx4HNeRCJhJ7fqc9PWycSCYnz+wsqKqE0BZng3GkE4igzZSz00y1Dfrok1nFg1eX05p41wn/mFaONlYKaay1nS/EBe2Err3deKEj3Kwd5GWvtb97HcgkRlJdjyCjOAZw6gWJSlAYBpmpIFUH5N9B10RvttbwLxj5nC9u58UzmgKDAB7Jev3Pe93fgeq9yW7psQ2lYicVtyXHLgi8ND64eff/JebcYqphzi13FYstk5N6gW86B9iCD1BINQah0kMKQgU+kUUcJinXPGMwz1o10IL8AB8x4jeZ0uUSmyfkUEL+mOE8hTGsDhDh6esZ4nAEaMMe4SoZgq5RLUa9aIP8PJu9AjsxCHo6F5yVPjclO9FP8+hsnruKoQjUm6i9TXi6zPnf3ef2+9m7XWGFhlOGUnegdW9El5S950+r/Ka7zYimiUaUtiQ0fPf7zbhqODLgJgsIa9g4sXspAgBvS36H37+zX9F64Qde8QFr91kd5psVdaXFhaLachjgiDskKCsSMd+tKEzbfMJafcEAqQFt3xMFD6E2iYo0c5c2O2XV4zx1b+nYREauN676FwLsX/Qz0fNn1UdmVX4iV80V6cw1zMsi1/y5xmJ3wKZlmQtSoe7LrHkOhfXoGvK2QsQC70NzXEuPuPBZJ5MoJXqoO6+srjY+EF3FAOdwXGT9uFhe07acvIdD9t6hRVwJVOVB8biURzbtRmDvqLivOra1TnTPpv0qWyMgZUqBC5QFnQN/Vk2ln1fobHfJZIejZHLwz6kF/TLlEdiZWOlZn2igUPgf6/m20RqiEA/T47dWVdocc7u9FmHHk7Ug3fyCw7Qx/66B9n8uMOhZL56+nDHsUU8YbOxNRJSe4SxGiaCIfjdAOAIq5CICDNfE9eiNkLMzI9jFEIi57VEf+Yb9nHq1MC4nk9EwrFXzRuRQoeILbJmn1Gf6577fG+SO2NeHg+swmLqPMtc+OhxZswmuJsD6VnlNNuZ0VQHCcC+PflwMWRUAk0uRg42asSKR5TIVjPIJWD3nYKe4eB3SdHoWn4ym4oUyhN3AzVBJrvtFhp2xCCVgcG6HfWkFFylQj4XgZvoW3Kcf3/IgOiVyJK+MuPIXxtU/qB2h2v1Ko3DpIacCqSMh5tvZrzQ0JDccQh4Y8PsDIwOaVkNT1UozapWTGdwTN5j4nh27V4ZtEPDiMF92M2JbLzw5F1AP7QEUCWaxj/8/Jt/wdxn1NvwC/5MGQQ8vBbOEH0kRHBMnFB172Fzf9z+bvDiOmbTH8L8BIiD2kw6GbOSlXMNsLF9OOTVwPI+sbRk+Rt4r2XMuVqAG1RCvAUt603xiuPEUdYi6ttRaCgbsohprmLX42GycAHjosorNJ5bCHgVqv/SYauVDXVVv6HySolmidGdd78aJqSFfvuaNVB2Qysr/ULU63B04czVsb+tq8E//uq3//VgQHeDoJokU5YnemGDrC0UAiuLa2APKWqptI8b7biIeqy/eHMWi2Pyi5gOh8/l8Tlr7mMBRXkuH0j0ZyL1RsusDaaQ48OP8wUlCldJ0ChPqexgr5Btt1LD/Ry2WYIgmCZP0v+fx119ottdMymq99f9cTIrwo2CbX61b1927yb6Wp7UST+fFoBA767eDY5slxzNDMi9PHLmkbDYZzFvy7z8jayp9mVKHIELkXP3jiUkEnnsNbinHAKDEKL30c+qkcsTEczWO4Mg6sz6u4N0Fv2ZiY+z7t87/F5Z0ISqJlGQSSCcNX9mrLOqcEDZ8fZ3xSVhkiBZTVZUKYEGqSQVAwwy5DlcW3Oa3BUSaoVXn9lqh7uN9djhJGzuFyLfNnlb5YsgDM8LufeiiNK19kBLwc0//uq3/2LDsv5TSNSIzxwzIj3BMQ25AJOsVVhfz26TmtaaT6CxMLeRNyGC14Ee9Zkfi9pJbUpcXG8aE72WJ28kgs0TXsM9j4B3LY1Pff+TeXHTaB23d9MHsSREGRCLUNFKKbwDGgUAACAASURBVO5KMtckAe3avBM0ciqf3a5ZEyTzmXVO5h28koMwq4S6s+a70Mm0DnLq6c/3iTigC84KVVVReQ/8TDW+2fTncF9mHKzvV7j/pITxiVY4QywaatnsfvzVb/8bmiUXTbMfiWbZ1hM4sBt800E+pzqeLTJfKvN3SvgzIQPZ1VTv+nECTe7AhJPn+iyjdLdKZCVTflLVUMHJNGzzVcrRj0HhPg7GXSVumvKGwGuBmk1DcODdt4QtDrp1QEsjyM/5pCCiccmW10DwLxzonDtLsftct4dEqcT0b4o1woZV73Fd7iwZxlKhiOp2J3s1EIoYQxSwM3KBnFZoqh+jGs3sUFVdBZC919HA/ZkFycPPdzPi+cn7rnv4fShjuuFW74TGU5bUo5NWqmtmc69qoy7cwwvt2i3W03jqZJPrrO0Vg4aHfYcSiLK2ycbXtP3QccfwWrwwx3aqezrDfrp5d5v0AT7P+vho7n2A66Dsbxqci1K1cfp1NAiyjFX98MwUk0cYJw2hJCufzcnJ3uDFjYyfrbJ3ffKP/91fM+vowxkYrDLcNEkAez1edvOPsY5wNlAZ9Rf6u5oQzaLjn0dnTsesa45rUQUyOERShzHTJNEztCjybgBwkqXLg3UZ0BzTBC1EfPtILI4LGxPoEQgwsBjiPe6+/l4g09nTansDL9Mo8AsKM9b6Jn1vYMhDLROXtW3mXbJRhqx7iu1shPfc+iPF5lrpZmsJWTkANbcfT4yrHehIMs+zn8MJ4J2PizLy9TsfTl+CIhPe6obZZcNDh7Arx1w1WLuNmGhemsv5OC9LAqUxUo/CgHimBHAV4VwhgVpBwKgxEGHfJ6U14XzGJT1Zf2WGrH64I3sHnvcNNx3CxYnZJixg4ZWiPwyTFi+goLwm0nIudlk1ASdGpz8+q0C58rDozuPhZOOP40OtZm82Q50n8GPR58j7Me/uPFbPAMVFuURQRgVUrd7oDu1feEbsDWeOY5cpMZDEnsueEc+9kzf2g5EPED0zhxxLHDvFXF/e4isROCklgZ9XZScckQgWPE9RW0viiDDj4wNaidpsuFlWZTcM0Dyiuq2qsIpHLL0SLSmDttzQ/UA/BgvM1CB4dnNdhdEn15hkVU+Mkyo0g/gkjkFYhRtjaWpIrCKqk/7gItTTGSuo3Z9gMB33wZQ8qkOnOyZahJwSzXhCVsKVK2hc9d1qRUqH2prv364XCyDxtd5rUIKTrmEjuGEfQdRn7B7LX4+B6PBtPDBxcMbQsxvJFCanGQaag/UbComxvHQZv3obYz+yeQP9XAJK0ExeuP7sSnG7B6E+n522m1x2ID+eQR/HEJS4W5ihYc7EITVSXBtzAnHHPta56XFgeroEnYjjde/IK9zx410YaeRpL/J4fwPWbXQvIKz03O66Dduz9v3dAmQyiQ+XSe1QXtdeNgvYLhqa6/3+GwX+dGazzn7GG1OVeUxEhmoWU9dqHnvLKf/+n0O6TGRTI64o7OoRMD1wj6imbIbV4VCojA8CINaSLNz+PMqiGz59O0NCtW6PQ7YlMV48RwUU9isML8MRcrbxkSMYZx8a1VbG6GkQHuRmPzoiOisZbwYXmQOcIMzgmpw5IVI/Q5rakTmmUmQKMLZpjIig5iNhiz4ySHMIQI/kzszZ53Gj5B9/+d1/SxPxTAmbgzjBAQpb4SR5CStsRSs0t4PqeHAUW+2vWSuIzWxgHqmfrdQd4AqGeN0pLKmvJEpGdtL++fd6yy4w8EH/9Tbwql8yy/E1phPVXOG25MmsFUDwZVq/bbOf2WWOTzOpO7apOkMbZWCb/n628VONhIULl4cikTz37sLJ5xTJlEImtUd3qFjnBuGAdqq6fEK9qa/WgW9r2nl9i8abXdLMHtJ9h3EzzN0J4WZH4GVCuwzI16p+Ahoo5fih1/5A7o8RpTP/+Mvv/iWSEqvMvAwnIhyUrajagpm6QiNV6ab5BAHB5ipLnPW78MoKJ321MU5JhqalPfJRI+3JY5dWh2aRoAGMOElSnnw2GYITWPtr/8ELamYiksWylCkYUTRrZnncSAD25q8b21ccNoN7u67mmdQI0d5itLCgRVPam+BcgumeuIzBPcUhu8EUBH1ne4MoSkiTwxHReLA9LmX78WjmMxwTzwoIW1yTF2pipsJSRPPKrUl+yYoI3/2KP/3yu38pMRA5ojVLnkiKDMhpY0CDgt101pl7kmB0KJPQ6b6usDV1G83KQv/sZvCk9zQu/SSaVTxUz/OM+NFk6VyxHbtjXrlJ7xg5u/ehhbFMaZ+IC/SJC2zlTx+3sL3+fE1LT5fQ+bMizJOh/trKPKjRN2vcrBqVTly2QObm/bSi2rLWb7glrdHHRd9oo2R108ROnYzNvY6n4TMVZ5d+3shxq8S0ehN0PPfNgwuoi0PGPKH4jD9VCyqwZ1pgwEuuEGlPXgYSGMzz8WPemf+V6XolVfrPbwzw5vdRn1OksjL3VUjLpSOgryPKdH687P08J+563lsdc14zYTNhOd9FnevNdU0od+jjVOidnRtQZIPaRGK7zjF6VoeZaRcinseR18ng7hLjzvCavj9dP049Y9L9c7a5f1b3+6GO02PhGqM3emVEyalpS5TAht6HgWtn/ML3lBsJx98z7hqPpMcfs+VcEpus48pIwhgTP/fUGM/GrtwD7nFv1ngvi7B7TwJBTbh4X+P4LLKyFWTsaZHh3pILufDjHCZQGRY2tTikq1gMO29/rXIEb2II/2FnruTGaI2sIBThPqrCTQ6QncYD9FTPl8wtYZeB5U0pDv964873gg+nSmKwsDPCKUHDUH5dRI5gsJ1/+uX3/13v6C2hs5JolnsAgdcdp0juVtv1YveGx2LKKXjRAj2ptwg29DBYzw24s7KxhHNvLbrsLOeumL/1M7L/LmsbzTpM80xVv2HpDa9BgSzLLwIG1QYizgggZ2wJaNcRq1bSH+13r76m+twF/a5+77gRxhnFypjRSQha48JXHPl+HWllTNrnFe0/v15q64G2S7HqBBkbxd4Tg0Q65GsSiPhoieTPkmBeQTWFerIsblEJzPLabV0YDdDhKi76bZ63ZPXm+nNvR+enX37/3w9iFx0k3k14KiJoHazeHdNK6X3ggFxVi1mRdqXxgJ31EzXt3rVlBSN/aShrRdFsF0rv5si0P7K5wAvPtNrPrwh3rPbxs1TERLMyy85jaH1Nt8MyyARUKEjIk9LQqEJPINub+vxCqi6nQJryKgllTwRRsokxlKFt6N5in5XcM4cx7RHD7N00uuPewztpIlaiJDNWSUt7KBTJo7Muk/JGDDWiC9CrzKmB/ZP9XbU5QLcoQ/8ytFejiF227huYIBU5RQ6d1CxyE9Bnte61MyIytrkJ9DUxSirt9eyZJqx5WVtOIK2pjj0177HaR6va6lOjaeceldHUxcIPcE1UNyw0Y03kxfacbrw7/SwL82xlE+027qn3eSSfZex9RJh9kYpwSNbA7PF7Lt45IQvRm7++BgP04Sor0xsdY6bdsFkmG7VHgdghQzp8GcYX57wW50Zybbz+mbWmlrumDzlpFI4dgqef+YiGl9lsTZ+7NmHQpib8i2MpHNBDh9hqA+hqL23EefTLI2QcSneyYaTHodV7Q0YjA74W9XyHeqewRr65mmUX1wDfoTpkrcQUDKrH71bViYz6lRZXeP9O1xzf51rFKAbP49ICzDH6+aw6lxWa4OR67wuKlUU73HU4LB8XhBTUobhU8sLtTEqpyype3c8vTgnL+S+k7ynQYNXxJzJ1+DbyFPNvUbSMXC6yj2nhOKOkGzYyk/1WwyFtykfWUE75zSKA85UZGAKRo6D2tzOGg/icAmJ7/t4c+Bp8XJChrj3DXGwOGc/3++qzmBAHBrtrIX4PXChMhHLF/ZhCfYVS04D6HBEYDxrUtfny8R0E4A2WFvJmpghXY+ErmszCDLg1YnQCtAMD7j8m9uwi7DZCMm1w990RYG0BPC0XdRVIZ9EXf383PYpMJQIgqhPlzZ9nvW+SScUDI6JkgRwrfqQSzRKZHaENNCzOjRy1c+e8TrVT0H2hUYNCmuD4FMnkn379h/+hieWoJenasO9NZKaixaOlcTd+VJOaJME+o/9Jw3rt2qOKal+ncSNOcxSdK8bQSeu0R23KRSyLXOLT1wXUd0cLefqoWeJK3KL9dlfFDutwiYRksmqM5wgESgNCfTSt/5gsNd32qTfLeizNMZ4YA7VGT4yP9rHlSSCmR4nwWhapsKhAkWbrIc7sn86MPokBcMqDuY9Sxpgw7RsPn6erkMrbRUB0g5uyaBmJvMmLV67dcuhnhNumRsykFPr6/Y2JuAj42nRTv5k+NqrkbhkXtEgxeVRtvj+OktgcOwlM5PHGxtYMZ3hT7mKusbk4SS7kB6TFnFO2nt+x5/eXGIG0br9v3tiSmvCEiQEDljRsVTcKhvUPxNJD+AzoR+UlsyRVIBIpyK3E+nUMe5Y1we3p/CSFtt1aDFyFrC4HjynQhnvWPt+nDgkMOi1mLQDeP7skVvcSTLE6lkPiqzhkOM/fYFXtY/CGq2L2cczFSqa07R3rXsgS50jEwmJy9B3iSe47x0onACJjkHdHgN0b9e9AmIjL0Ffl+Uk6NmuDojZjuLg/3uBZfXczZCLqY27Dv3WiwkAwKXU4m9qHgKHZczkwlwrEjKogbTzjRks06nQEw8byW0gwoe6jFMurQ93sqoTQQU7cjZzJNVYHaJPqnQrYjRZPX6TJd+ECK3a17CwxH1/Lav+Zq66a8Z9PhEGmOQ8r31X3c3SgGTzDPm/I2WSC9BQEPIK28Q51juuSS79CitfyIj6JEFlY3TnqKcCwamLc6GO8oeCFoWDVSaFf4YXPiBskD9i7kDpD6I5lgnPYazeAXAQoFIV2PN8ewLBhNL3Pvw+COh9eM4GrEDmH8GXd/rGkzhqDun0E+CQI8gO4h1QA3iRPpEKYJvlOHULV6TdM1xsp1iAp1tDVyv0VueQK8ep46rM2PP86YOiQXEhKb3p9Jg6HwAMDEyWaK1GTgwvzMb8aQ3qkK0ACgjlcoG/1aBMilQSYrXpMfSyW+9vSxALkdaEQ5rijFeFFcvGnMOIkW119HDXZJQNxkbhrgghekP2Li8sVc+K78Jf9akgEdkBJdmMf8vQJKWAVZcIWSXDtJbhnEaLy3KS6HZSrq5MqHjs1B2J0upUDkca3lmfQWdmKs95YU55c++F+slFFkxhj87KYfD8HQwtCgEKTtmaspcCEIBvAZysWbfNk/uzmAZN26YF8o82QcTsthUx3O6YVxJbVCYP1hYPFYQU4cohK1/pzKLGG+0xizEhipApQKCWkjOsBUY/8AMPQGL3iaGupUefkaHxKI1HNciMsPpYqmfYAMPo1hW6Y8uy0CID+AlRhTXzRTO1XDTEm6ySxNzqRD5uShHITWRBTjs5Czli5lwL/HaW+kF7m9TsIVnQ2iRpg+SXQno/H+/nXf/gfB/GLVXa7qQrVSrlUZ20iFY7w3M8Ec5pGgpfyJNbPxp8cUmPQl2yGEHbXPfNiwLcLeCKN7/n7gLYpmenQJqNXlYzxcRISrlyhrA8BMpYRb7fVJYAgY4WodIeW2KvPpDKU6LqV8k6xe8Hd7ZmA6zC2GjZCgcOVB0sAGrqQ/BT0WdAd8CjIYC0VzuWyKWEv32nxkhNIFtdhAm3d3qSPZzt7tuUPgSSvFfuoI3IaccEgH8lXgg780JfMiAF5r1A00N6XBP75N3/8n+gWNRGLwDbZ/nc2eq4yJsgI9kYK4+PC+akZkWdhozN82glSv8uuFEsxUcZxHCAMyCAqGC6yqFtnNt8K8jfIw/uRdbwz6eas0+Kghir9iJMloatWYJj8JFCaCGWJC8wmFki8V/OGrdHw/qlqA1RonlCd8DhNAJ5mcIcFWoCLX3SUpwaHdIAZEw/SPGmyQIMhmFhw6btywk4kAMl0u6jfpSAS4qTnoMtd5HpNmPzRks5ZbKbZOYPWTLdE0eABi0EqArTEdwhpuvGR6dtIEsdi4Mi5eHKwkt5OQ+A9ws9ZEp1OuIvvxVpO1ymhMTDc2Dt4AtQXQ46wTaXASTEEubp9K2WsGTEaE/sY39Vv3jEk4rdwHmirx4hSHs9iDzvBEe5TSAjEqpCRwaFtYytJKAxkIwNtSTXtW+q3EpgMhMvCiGyCEx4XiPg1vjMVscn7qaQMaXV5JtPzqPCyqPN8h+e0iBpF7XUPKXfo3eT3nfZMr4MSGZoTBSWouHAMzOYEyA8711fAqsfgWUJmLWPt+jJE6tMdtc6sQ4RGeQdc5FtlKJIQJBRow8MIdawSwbOkHo5JLlVyioEZENqHMpYZhp7IxR2sQcoxeYt8Wyp3uOTMdwkzqB253ljucfBGMYse/X6ARQJsQ+LSKR7GEidi5swHDqmaucMuK5phxjsBgqf7VLYRV7JFpXZ4OcOAbZiamXOEOCDy+t5qY8rQeRPJEDg3GMAm95Q7osF/bl+PjGpTqaCzqIlCBIHTRzkohuGZTFGIjksF5JnDuXE9pKQ8l97bgC2zcQilu5DznSXC6vZ5hEIMw7PWvVeGFnMwbj2/hDaSLe/FPbcsd0MFiXL62Xn9ezlSppkA4yjhv9A8FfodvTNyf87mnvYaEs73bXYfL4Hvw1Tcu5Le851su97Tw96vYtY87BxR7aWn23kt68PrNtCbAQc+Dl1kod6d9XXvKcnAwbLS0GgKmEIOXBHFgvQJXCWUf+4LhxM/F6JB9HhvjhEjwrFrazOwdYAPNnoQyAv1ce00enZwyHWwqx/F5IUpiRo1hhm6V9iwuTHyK8OW65CYZIYB//ybP/7PtEcr2kRYR94MD2JRE2SyoLMNuWkUURQUV/JaA0hTXCQmwrQDRpLrFdfYYVWlnfigi6UR9czL3AQUJctv4xhXRVoPkmTLw33StW9wuCRpi3rMxw2rUGAzm4Ngn4OSEBevdBZQT5NooFoDhYGhglFSLSuh2ylyWVBlhY9Q3E4aZGspSvrp+XvV/XNff3ocDkvZUOosUx/d2/bXc7LVqO2CUM0K0apJcKTXZY3I6sY0YXydoGs0CG9NqbynQVx6JozIP//mj/8LzeRvq92Ahi9FwxeiwcvTk433qphotTBMeM2ng/FV9Lk1a9q+fOWzmvc74+UVfTiZqDRcHKabXpcLMBFcnbR714+76vWf/bMy12Sxfafa6by5Jk03EBkYUtP+6I5ZpZKqnz6aAzijiF1mk+VzjPXv7LKywpGu8OZmnSWAOoljo7WioRYpQsgRXUg5zo3DwYITNUGGVH6OQ4sTZ+F+dgnoW33e5Si8YSh/mZff/16ZdJPknu4ZOm78BCVZQSXaYz1f9dFs2FmNsX9mdN1uUcva+6A5N0LF3T7lnOfBoteZ+9Pa5CkrFg0WtkkMm5p+Q+3dEcgcT74rDZ55Rcui6p+J2mBnsE5FxrpnqNoga9OjcWrQGrbav7Tx3SR3okus7MaBUM5vQE2bIIHceI7P8OFERcdm5jCiaDN3YsozdCLxGqcb4E20Zt/P5KaFHDiPsN15bfd1fe6bRdwYVJTfahGiros3fXReRCWPx3N5xFEzy6I1jN4ICEEozeyrPlxrwQOVIqPTbZWYdCKqrgUlX9ualK+HGlJfS+rqQI2p4xIjUaWbvvdElDDT7YaEKIjLyFEXoKo6lPdABCr9OCF28aYmgTCIPoZcDa8Om6h6YpPbhIiAXIKxyW9xjG7EsXQ+I+ORzIDSeU5iwzmiFuy09hvkXZW5TZTUL1MsmSeOs/YKT3BSK915692mScNjOu8x24inBv3UQJyScE0NUBmgBZ2RyoNNdkUvvfPWjwYp6gzwlTj1K2LauG3xv4iEOWNaRIZG54zgtmfONs5OIrlGa/B1Ub7GRJCOyOfPrMxTa7jk/YXCf+r4Ny1scGY8eQUi/XCMU+CPuPkTRcY2v2ET4YQ+8m+nk+0q9jmUR1HxFPFwvBeZzmkisoCqGx3PPoDBA5KT2KEBjJjkqDZEOPHyUXKzPz4QPLJ6fomxd7jmJKMVJu8gVkCfJ0FxLFgGELVh+2dKYH92hlaWcMcFbHyN6QMv6AKMPZnQrnbqkCsb60pIhqgvY+xCB/2CPUO1On4RHqCExyDMxEMkgobv292z659X0ylMKte4nivXux7UsyDK8N12q0d2DdApsvlMwshk/HTqsyvHHrmDhA2gNwXDGNUhpTzFKpmbM/Ce5SI8Y5ArwifSoRd0NvACn+eZifewRN4pze4k3Ot440bdYREsa5lwaLu8+ndDx0MfdH2nIkp8ClWf9xciOu5z+PHc7y30OOdOfxWwa9/3Cn+za1+dVOzoF+SBejEON2VVPmGjfCQ0k4gw+/DTu6V4GbEs4qw4ptA+osRG7u/ZtykBRjqHNBo+TM6yKzVLoSQT2u7q7DUwUIapYfmzlphoidRUex1pfdvVWy4VNa3HTl5FzS0Up1Solm/NtNTP6/kgppNmZVUKERY2dY/DK5OpNtAyskbCVLH2sXvn8Lk1IAPKBFwkAca68DASycBwT7iihAOJZUTUXIWcgL8DGpXA+zDqgui9CTgTCUIF00gAgmZY33mg9rxbAtvlR3Uy1FNDiBbPnaBBKyHlg2pJ89VQXxVWjHzrv/rtX/wrv/KAWE4eh5LHaLdVRaw3IiL7NzYO7DWa+KPZRKdJvTg0hL9rrDAe3quK3aMKHjsl72dKBxlMzBVTeKmPy+Kvl6HVWbHqOFvn80ixGfcD8DYmuOoKS5yncktW+4USCaPjXCXBThaNlYUoXaHVZitog310WfZ3976j47Ln7s4Xp4NLQDNd0tmL7g1Z+Bhwt7hNOCN3pKxaSBKDoYH/JUMgNRons/1vxemfcjhV14UfTFlcO8+3QiRWECQqQjedlz79+1U/z9I4Tq7R3oN/9du/+Nf0dbCRTZKHPuJaO2Qq3SSoBuJOhj1tDOQv0Vf5JhiVulzczrVn7BVOlOw5KIDFFsH9GiVEIociA+X4yKCIrojvyIAnsssndzsh0BDzbIlRyjd7glkuu83SFqC9lh1HQOCXQga4v+edUMG3gWrcWzbGp0ahTqTJo1LmjbIkbI9yVZ8jstME+YIOhw+IJdcJoyVSOBhkTUMoHkZISfztY94olpoCjiDfGpsKsRGXQyYSKTV916g4HuscNKlQMzxkMccbLkaIRoTK5vPonMlzc23AyJA90ThtpHsk0LWvmS+qD8RmGV7fB+ROHe9JTNj1IzHxJQY04WruYnMTx636/xhAPNONL4NTptUGWYZwl3G7Ametxpw6i7njkp9Aa1Nt7Swh70ieFsli+ndgGFtkuFV7Tj+GWHo+cjLeP26ESSURZM1IjIkIbsycZkkjUVFv6NxX1CYPQ5Hi2FZaTU2gEcPOpLEckAfkw+RkHvDjPgJyuTkZzyq8daJZipOHmUPYzG+oOn/7CjWh8wCKRWJ3Mx1W06E+dJ17Y+WY3KfZcZihURKzVV1fqRCleV8Tynq/woFUVQUn4ZgcMDSVOJB1kUFs3MatxcUo29g4ycdSYSVWOWeiI6LZnqQ2XR2y8siS2SBV+MwbAiKh+27o/ryXRtfU7xp1O9/B5Ew4I6pgXYT9kH1PmZHhzpdHCOAv/7UNtRqhNxc7YyDOEFYvJE3rSXNoreQ/KGwlmvIZsZAgSVQfpwO6M8y53g38zInBZepMAtAE31bhEHY05xkFtPrev7ugeJ4M/CEaUC0A8RTP+FUlXULFs4mRsiNARTSvt14l2/hTqK3fxZJXIjMyhHer0rxXiSXtDOgvjcDlfSBJe0f9eQF7DTLq5gmcHHCyfn7U+iQIHUI6HPF4a07bd5VIUTRyXyNyptuS2xFgW5Sdxgx2QJCWTYbcMSFtFDv2I8po/+UbSnijWGLmM57BpgJsVLuRIXG1Itscbd5+U7i06jONdZ+VTpb62ifzBCdeZ41rCV6JBrNRa9XvhlgfmWAlQqCs7toZfQ7K2cwwkkiLDZNffTYEeC7ESMau/aFTzoAtUbENiju/DeEchG+0wy8/yTCexCI74H61nGk1Tjgh6qIm1JWVG2bIlz52gsLp/tPXPCivKsi+q8oTJ2V+k/7uDJiqbn61xCwzYvB1pqjW+1ZgUXGEt3C6VWZvzrDAr8Pmc7w1R4fY3dEXEPo7CNgyc90UpA6CcL6IXEZNEbstMwhhcoJKY56DeCUO5twpGMwpl4J+djv6mR8GQLbp+Dx/MJDTBJiDQomaLnHjYvKE4ygpY0s2Qu4+b8IdXRlioKVFpWOorVB7JosDTxLMOjYxsCim9bBei4OHCx1qY0efDA0ssoYZMxYcY4DWhAhttqh7JKvqGwH8EE50TUB0NiBEzmAVz1VAzsjM/ibQRkeCIoHnICq0RBDyxpFLIivdRPrz4dwiAhfGpKefFlBC64Tt4HXZUX1z1NWAbUixlFTA3BVllOjx4tBtWDGQqnQzGEuJToaZJ1yDXenmA9RJq+x9X1mr3os970dAjbkGBtTc4tDXEpFkOYLhqQt2WMASFHg+xI0Vb2S+/85wPLOt1fJLv4uezIoF9BqVqGsXbceqfTiUmdvzIyu2kEUABsDGXllCd3xHPdtBuUR9JnUmAEID2JfzzbJU7OJmc66O48brnbTvildM+caeOpIFKY8pP3UkUL4POQmFiCL4ufgPQEkXJ16ZcOwzdv0UdD84fz6vRcBgAWXEOQGES6CoV9beYhd+aKyCBYOzsY8MV/RuCZyOeOUFhJMYjJNKy8QYGmwRyWtzcOMgtUeZsLhfsXl6Z8VXBphNgfFzQOPGhmvr4wsgid1zMFjvgkow0qyfOE7J/GY9J71YW4NcooqIc23TBGcMnAPoBBKlpZEehSZwXT/esrWRk72HgUOow56hnNprlKixHFR+mSCXTBgroo515waJXeh4vxVAjjjSRwmwS9Rs7yI/SL1egyfnGQcJTDCTIO3qO8YLZwhYIgAAIABJREFU0nqwS4C4LAZj7rfO+Q8YZJmjuJmveEJyvD6H3B4jTqEeA1BZG6M4lIeXzqsetkfVgsohO59dTA6F8dkoMEqyAVx81mENZpjJf6r6CYANb+fsnpCegVzMcyGcRVcW4A3UxAnBQhEy0NlHBn0VAhsyTgNHsutj9v1PhJ26AxT0suqaw0QVJYFiCUYZ2ZF53hu5dYy5yNTw/cuuf+1Gy+A92O1t4lagkITJBOLKbn6wnzsUvsMhwsxwl3xt5CaHgDuIPUFjYIhwhb44M9SpCH1Mrg1Ckwid5JWwWoKUcuo6J+tlFg4ZJJG3bZT0D1OOrHOVFwOMXKYCDQ3fvRGB1JEAebilADcDyoPOIyLo3Dxyw3Ar5RTwoiTKIzABJmZ2s+siMYujACV5STiyI7c1am+bux6fscrNPsKmgkvwKI0foixySfLhY2920cAYY8vNdtsWbHojM8FyY1Wb4nhJRONdM5CjOGGVI8/uXSt9CB61KCfzBM8zADSAVCBfhilFvFQAy3s1din0A7vKBm9O4P7QQC9B18L3mY/UCig8xG0WmaVwu3exd0nNfzwr8nAaLSCURDNlObRBTmrxK4ZFpjyXY0ptnBlN3bs0oeCxkbPyGQ37qUOip0g1MiIXcpGuw4+IjL5f7u1i6LHxSj32JTCBcSijuOsT2dRA6nRIXUcJax1vf8GwnpnAi/BVGqLLNHzNqD5WbnBVjlAarBbpx3UPYUuqYv0zJuFA33o9s6uJVRivZ7+53pFTnzw61I/2NQEzAuXDvpEDxuQX1LSGwOFl4nxBjzuCoLYPsLKAhebCyDhgainnsbrAof3+QZo5e/wdmNyCsHyJm0fwPaVYdCvWGdKDGK86t8axzZqwJR6R9ZvF958uH+Pre18y4r+7+kL3E8C8HZxx+fN2LOPllIdbYR8O49IozYxJzFffhyRj2lwtZ8SjegiCHA4afUPbZB36Y2ce6s2GodmHeTMEOE7WTZOArkTGj7qHZbD5Rh4QBln0Hl3N6gWy6oOIhMZcflTZoHGlw7Umwfx9Dn3D115l368xtRi0pwUs3izWRZr8QS3yZrO/4HhdU+jqE0NNp98QvXXjv2MMV4XaUUTGgO6n2dAQWcT53t7YQYQS7jxx1/f1nQKuxc4ZRpRkkH8TYVmgfhOpB8FMQK6zxnRAS7pgJTd/EwjwAgOBOAbV0YomAHdj8BkSD3D2UcjkYhCYNwZCYo4fhLN53g1Ly5UgKBORKQlOFfjheX1e461H+CNPAtKMs2BFIq9sFeCuvKDM2+0YHRE0n/FVTFT0svye7Jz3awsMalR+aoeTcoIEokWHgmmBiJ8YYkoRh42hlAz90aVrPntf80eE4B8IvqGMd2x+kAtz+fAywo3IcGhwkWfPSR9ygWMLwAU5xbut6eLRpMhphEKinKA7nuIMUH+9FRssJ288EhrJroMWI25jYH39r3ZiAVWr4UAnR9jgerxywrRjrO4rMAP2Jq/oUDGf6WKzs9lm/mYBdY5BVJQxLCDAifZsmBWMuMSrNRlwAbDbZMT1L4tNZEH2jyBT1/W/IKVHIEAVOOMZj2EJAXFO7YfocvhApxsXygDyVLYwMzzb+xjwUhgmMQ6ZwDpz3ickyEMFRNDz+1lyOLdXgxKPTmU3GISY+HB6CZrlDK0hh9Y4UAikVysFilTmc8art8Dj/TUV2YxnYqOC//hib9NMcYiq2aCe57uxXOucRiEd6nmedyeTBOKiiLqS1WAIjpKw+ETkwyHBYUB49PS6Jqd6AQwQVlNchxxVU2DPZtyYfvGO3UNSxlN8k9PcgOyDjr0vYylk7+CGa7P4Z7naEenNuhUL1VeHzFPKcWbmX373V/9rsdlOhQ8mZCyT2BQV16Ym9lV9v0rSIQSzt6vjkYpde+3sPPR5Fweq4ksLBDmBnwC1xTMkKgVRzi4l9lIcrjuWqCe18UBFBxV3Aibe0Oi83NU2ppqHfrtJQdsiOep+HuiNthrPziWyeha26H3CPlrFd8Pa46ldM2t0sTFX1yhQzyUpBe6zc8cbJ41T51Vkuzi+FrESrscKufHikVj/nNXe8Cwd+xNzB73W6p4xUtAU6cNYrgrAx6d4kOUpDmqR2uJIXg0xOeUATP5dlqyFWNLz7UFULOyO8mKjQsiTcpo8cyKQO586hRpK5sz4OWhG8btZMhgWV67R/nRSbSTi8Eg8iWbcXhXpiwyeayjvyislnRl65kvl6jE931iIYNpD2RcDo5sLwiAuuC/SnyNRNwQQFYo+XCFJPdU7wqgV6ViqwpLF37LZZ1OjnzFeDcd4K3+IxhvX6wGAoHiH9pwbw6ULBWeG42rlgtC6LO/k3MK4Z1BSGx79UMa0ezd5lBT6VKP7WplhJST0RsyeMEAuZAXqwLv3ZOc1crY4i4Z4SekGnuvGYVjoWNdpi0uV8PIahr2O7fPo3DAjY6neMw4v05BMBOQ9VWThoWF7GUQKGj4lTfzjXkef+rdB4YONYWzTs1RpmBO1eP9et9XZVKKEjB+GiYPJr1I8kff+uM5TBlU457y+QpnlfLe7m+yx9l30eZzU+xpJE+ZHG4BErKut2T23fdYmKGWucT8vw/PPdq02A438mninoGMJfK8Z7uV6f9t2Hs2kG22+7h3b4jyPXYqBfm87djm0JWrr+3+2LPspWkeh3iAY2i6pK08uk6BygESJfLJav3mvKDt2npo2Kqt7e2PoGKCcuzwhE+PTGwMdr8gEBZoai502zXRjz4zDioFyIttblQlWfzepMpkBH7hHMoM1PCsTC//y+7/+3wbwxi4USQ0M9FF86Dtc55WM64QidHfAUgFTTqzNz2jPV7X9KzH+Dtrt2ryD+KkJm6zw/c80956bTx/dp52Xqn5H7I36eC/8feWHkC0gEaqRnqBh4UlSKHpbok0EbWiTMWTEOQZWtu82vpCURni9QlYQyQECfW9wvihDVIxjYI1YUUaYJMbv6TxYI9U7C9qBEJVDwKyNUmWkubbV97DvaT+774GuQcEov0XncbtVUifou9ivylEDhax5QMEblp1kMs45tziyNWIFmMr1KmHjgL/8/q//d7zCMEkp4jLO3kVPoFVp0Kz3ZPmC2DIy1Rzn8k/gKHlBnCddsRauCbvsidU+hbI8FZ77jGimGkjZtRojZpovEuhXihRxTt5BPmIXHZy7mnvACCccQMFo7nQGrW+3ibHPAwN4KuxD9PnG6orRv2PATuLOtNCeXR7WpIa/88pluCYRzTkHXumUTdCYicO60k9um2qVcBcM4zYPBRi/L17CxBo9b5xa2EKOWNuY3SdMoh4TxtwEk1czSmtmC3dRjMFBUz+4ET5AsRF7g98LaiT3WD5jjrE6Upc1hnhdxSkZXZd1nACaXDpAh0lZoIEjQSo5KlH0DbRDE41EDzzXKcpcC4EuMONLURghKPzQwryClY0koR4Lm6MviwAwI3KdGUC/aG7ocXUAknHEMZyOeTCHTPYfRal7ljncvCKUMzKEmuMP6mm+TZkmrZP0EOEcnR069XkRYT/uJmhih06uiGhRcr40hki2YVbJnFX/HkPYXm/6CE7feXcGdj3jClnUj+ynaRXyyOdADPmyQpBOJkAXg3VxPi2KzScs8ziG2a3PLubN+vp+wOlrRUjMlkyJuNo4HZ4/lbxVXZlNKhXzfKHUyg9OxN1y85sWZOJi5bkD42+YaLbu71305f1E0aIjV4kYR6DDlNSx45R1txHGpf/sgq9NcArORcT5r51ywD3vs7UNZ6xQkJG+3vtQkO7hcCtAbxD47o+7ceBeclgA6dbxVu3jkkGQvoAZeuyo5phyVVfA3y5wXDkgTBvvqtPYVZ3A1ScjqBewOSKlp6D9DW8a55vmRfAJPV6lSZc6sTe8BBvS2qiChPEgdhAM0MTgqYLL8NnEKeewJXVPNcyl4OGQ6Gj4Z/ROkYAMLgZKbILadQqMOWJ8yXY1wAPM3tkBxqp3vHwbeCcDys8iGlMkoIA4QUAttOs/zddlqvQCQyjof9iHyrgXwWie7Qdmp/9nlwX+9R/+5v9o4JEKQqqsSmpiolM4bAIr1lY5UnZGzPTTqC5uoRqmmoB59nMJFRU+ySm+hSf7QExWXixToOCoPS+qJeQa11jxe9qjSH17qiafBaImTN8+8oaY6sSNKEtd4vUauqJVX7slKYmthPaM2g94N2IXD71jveFpmhg2c57M6eOnZukaxmTRNe09hWKiKEBp4brs9v9gVLokYZORzVSK7VTKjkJ5AJq7PJJCQGdaDSzN0l2CBG5PmkYtMpCrij4QxbyRwCMiMUoW+LmIIr8BDVfxV+bVvDrnbRSq6jZXIqCU9us//M3/uRgbeXVjfVR8b3JsV+5RHVPFhzqjpeP07jiwP6LWeKdPJ6sJv6gvd9UfKxhXGth0pZ74VXPiM+bWZNzvxmEnY3clsdIrsIsFfMo+JEgGK+7sKPj02p8VZyJS8dqSd+8cdO2KHB9v0AsY877YmYgg2W7vFM74F3BfRvbyWC2VJ/ht9xdnhihKgNTVOngPRs96J1RqNNxXfYk6Npkvhi4IAGNEVTrcW2me2azRPvEhdsbKYh5L0kSmG98xRB4IxPj8C1AT45nEw1YFKwA3gHATT5su9JPYVZeKUJXRFOju6FkFSa3hdk/Xj6xkalKmVH2+W3+/usHKxv1WuBAmSm1TPoVEAnrMV9DJYSdrSxLz5EHfRspdJAA1dlOLeZkbhYgOlAOGFwlwCVLociqElvcFkms7KDK35MS4sSem69yAACu0kWtLtiW1Gt5GiNa6k+UMI/al5yCiFkp3j3Rc38+st5tYvsyMrqdKeJNUOKvyyXjtjD9vIU5w154z2Xpf+8C31XM/nP3dvsAFJl/X6SYWCHddeuDZHCwWA89eljH3Bed14t00hk64VrWYE5WkOEjXWYeKzKMcMRwLGQ5B24uXKvV4bjaoeBGM4cE66y3aAmnwlP4daiagrQWEhEP/H3YDNP1yOHiYI2Sc1nV3oTNpFtyJATPpIB4YrDwwgDIUpkuwmxBBHTQNA9aGVlYHPpW7RTooA/nYkSG6WqnQoUirxEUTY1KKjZ8IJ0hW/blJYracbHkUzz4xZKf3mbRzNXcImFySGJSVYx0IFN98Fp88EvsCznCnZyn7h70bh1TBdEIPEfP7imsRHQZhx/NRTvoQ/aisOCffXVRR4nkxd1HH/I6HDXInazyqPNV1yVcdKrDmIJN2aN9FX+N+L9bPhcp9z2te5N/ePtQ8Leq423zkuPk+3pMd+sS2xPZ+F3Vfzzpl2p1UHubj2iJilN/N4BUFMdp+5se9/UbL5jzme2HQcpCict3uIWt5bHz5tgOpzvfQbWSmhO5n1QbXeAHzW70Uk4jw7VDcekfi0C19Uz24qgVHRISVp2JzYfXXbrV+fPH4/7Z0dGcAJE/NGZZYq40QOZ9QzOoF6RKOsYYXiCEjj8YnRXZ7mrj5kdrzHPNzkZEcKKCRMeqcmIwaWVyiWLYJBpsIbLIlpQjb/EK/zumc1rBKcb7BS9JfiMmeigIwcv05sQvv4R6dD+HYRybB2OPz3sHQDpZ7aJ2DF5wKB9Ffz6KdT59zwtE5dfI1gR2QkG4KYUdN+JI20FP6N3/82/9r0NqdJV3FBFciZF9bbsHqzxQi3Lku0Zqud9VnqwQ104SZXe2Fr7Xvutpk2vSYJuGqSfu/KkdnKWmp45Ot4kXK0DJGLibDLHbcS/0GiBzwbbSTKy05zY/zOHEMg8q4FGUYBgNXG/n6vgJyCdQ7Xo6A6Ohupud9twsrY1g7HQK3amBeuLbV7xG2fNCG/j18Hxnnxf0fzlV/i3Yq9LNZ560O87v2utpUPcfV3mg+qnc1bdGlGXQ5st7ky/Jis5zaBRGcSd4VnLb8mz/+7f/tYGfCMvOUZLvSk+vMDTzU6J8Alds5+VDmEgxgxuLhTaUT5fpNgbUsYztzIMrKXjBq8+Tgacp8xe6G9gD9/v4l4N6FFPzcfdlB61nOSTjOqw0ODBXjtaxusoW3Ncla2tnb/TypqnXMsT7fg3KVaEflja+p+zhbUziiPrDybdpQ5EpMd5kZCc/Rat4tacgo7zMock8cLIpjOvSZWs/9+GVKuNJ280g6h2+lHudLGvrUt3l5zCrTqKL1pioJEiVtCinj0xuoIq3jfs2yN2eTcISFIIkCJeWhg8blAW91UE19CB6EY47BJJ8Kq2Qw5mRwcHNZlJzRcD8Tz/knuLEAuZuQjHlfCMCAPLE2mXB59pEYUUVM10LnoE2L+Btse8Yc3JNFu4xFJgshc9Geg4UKKS9WinnMuB/gpnu4zQ4QtoS1QCuOcu2PUdJnWViDO6Es6echmnftJGrEXjLeqooDrMyEJxBiE5u701r1Hp73CXN+PnN09EJi7TSPBKyjaeJyN9eeQUQ7NAwZpgflMSMeGj4LzqdpF/z+OKlSP2tUeieXFqlCkomyEnzGN1OhHqfXUZR6UDO5usxmXnRtaHB+u1MOUIHJwjDYUEfV6ztweldmdRRIhz/+aBZVHk7mFeW/acLTjjbD5JiJTGylSlctBN1idtCcdpo327br89XkJWrG29TbmarTVQvxQfNyVl5w132/dP1UvcNkM12dJ7LQ7l3JazJfQmKxRnsMapyvb1x4nJLlOEy1PBx6YgxTFQ/PnJ3wDpk90eU8gL6UIrcEbilTx1mSPAaJPBKPGH8MWnBkbb+v8cZksrHiAzA5Ej46E4h0KaP4BKLHdzpxSMV88L1cYpRJUKL7APbPou6pk6FMcpS7rn4GEVXqaLUl7GAH7XBd+3zfyxwTOdA7GLfSJm2h5C+VeHa3M6mcMXHBRPW/ybDzg821F0wWc++tDxI0OdV1zO/1hifuPU3SXdg0QBztcM97kE3cNMmIKr54xievTeVM8rwTQU2clJM4ppndcie2+dgzZXHSx3dRA0MlWaJF0lQR37Hn6756aOj2I7JJquqd/HtbcfcZWDs1ECsa3onhMjF2uvtlm8yKIt0Kp//U8KTEAK2OO4YGKqhAYUkQlKNgd544AI3y3ciRrJAPShA/yb16RvLW05BGYhgyCMNw4sAxU18VQxFt0/dHFMWevphHaBv/9i/+wf9TQCwrQh5Tb5cWrklfQczomZjSKiHOlCSIaI0p8RW6Nx3pUdFHMhgO9x5KQXraf69LB0NWL7qv2CxwOHx1bDbp33CuFJ5Fwj4naAECzHNMebZwlUvi5bP1dVZBk/fPJGMJzDKcRPK50TH+GR5D9gpzviz5LC3WJSmWP0Q7IJpVUJcw+/N1Y0RVQOMhqGNcSZaiVLf15XEo+999+/h209HjwA4O2n0qEXReE/FyWgaFuD5Zzk8KXJhRxJncFSPTKJlvIqlRRK/RM5ERfMZ0RzMsij5ohX1+35nqVYT95W0Ttl2Fsp6th6XGuFhR2VuFHidQZhcGmdZ5d3Wwq+IUHaw7kcklWqtHRvHOAH7k04sPirFyfy2fs8D42ogavMtD4Ul+CmgPVJLFYAUvta3Q+YDmvZRqkEZ3nCK/AYzl3xYJs88eYgeBXPWE6vNK613uCt+7FhNMkONRxRoaTjRRyu30sHte621pWNDIplunyG/4SVq/KeGENVjvJc8imecLgrjxO7F7GvNF1CLsEvj4tPYufV7Wqq6Pc5VVeB13anKQsBwqj4zBSOWH1ZQbGqG/3p/18SxMimz82u/Zkb4x6eNTWqjrWTggJkRWHMXTHYm6vgSydobv5TkZrze5bIwbAY2LhkJw9TVcKchd4/mo1IUWu2UHPIKRaRkH0332bdFqmMamhGaqRTSI7yEvesWooAF0yM1xK+pXKzBotslwkR3fSeuits68eKY63nsQEG1x5xOGrkZo0Up+CBpPK7SzUty36mPUfhlsXKFiEyN1IjfakWhNSgSJZpUzSG0QJmDxGgzPBHBKTtoeFLhnmXje2oFrBq9J+mZWYEi5z9ZDHqKcmFITUf6dFggfVORaub2P3b7mj9PfozwyBjvwWN7XPQuQ+uaEVYy7dc1fs5vTTu6P/d5TOX04Z4q1qRg5a/T5zPh9stBvCIMbg4/zea/Dr5yqD8pbXjrClHilFY2nuPWglTG1f3ulWjNWEi/JT6wAl9JMFh15WmgdQuJbqWiWgASTROUu9ZpBZqj4jOFqLefYxttMYd3CLgsIUIdSTLJpZHhvopl8ZhUbrgyPY2gQVoYLlYvMHHGrDAIZGig8cAAmbC0r4yQzbJFcbPdu2Zg9aKbzsMKyx0/OnWn4rTVSaKjyQ31YsRtLO6jiJDG8M4xX0ONVmu9pkjpv9FknhT3VT/E15uzUH4/GEA/xyzdjzIkxxrTsBKATc8zNmokOaI0RAR05BpueVaiLqpyi+ZExGPP47IYHgb3pzrcAkRihEH6kYam7sDZrOQp5alAu0BtwMPkExtDIVGB4O81/dsUjYX9ZJTUND11H+JQyIECh0VAbB7ZJXD7Wqq91Houkn+/Y6r1YnzHgW4QjxnXP77TuNbJ6I6uHha0tq52NG1v47b6PpkTU13FUide5vh1ifBqfb2Pe9nnve5z9bHU8NDVKYNvz6FtqQLMbgEmdPFONSEimFjcoHxQCjG3AeBOApDFwVMg5754bwVwDcdMnzsJT+pU0QGwyREwaD3iSHPkKJPMZMrTOWdhBOlfQbdQ/xwBdWzEQvLFfIRCVUSFVjW1jzL3f7Ld/+Q//X3C0Ie5CrrpYvWjpMtQy+LDTBc4YZtA9J9cpzGfD1ejTnBz7CTculCGkb/BYcSwsQfRdQFYXFew2k9UGjBTICtKdu0SBko+NoIsuCQTj4ZMCShHHqOSz4dIhBrDXoBPrWH4YQGC+b9CYNaw6oI3hLtnV5CGWOVTBUDGXCQ22r4mMtZdQppBQ5l/AE6NwcDeiNI42ff19sonnxbK9cI9tBK+JoqmQfSvABk1o5sJE4byTMrrEXLlOG/3RWNUG7W00UhDCQYbwlT7gjHLtNNxtpg1SSdtLIDJrowRalS9QSyfJqfYaEj4PbdKtfoiGGFI8Ux/5Nop+2SBBOUdEgWTL0xobSWeIBvHvlAHQL9+TcvVldlm3hhqt56GAdbpkTV+qgCPh3gridEEXvDim3TtfnVO6Qmk7TOwbMV814Zo2Rr4qgbxKRTyVv/6sn1WqaBlM1K6mHx4ndX/S4hxb9bj+FH92+m6Fv6KD9it4efLdR/58bRThcR2TkS9p38Ubm1Y0OeLlSFQZH9PtWAs0lAnr6cNWeMNMZdnk5aQz2W1+jBxrtaFaM9Jt5gqWowLig5nN6PjVRQpMFB7ElHzbsAIDiBNHboVnfhK/Jaoz99ECcCT3RNc/BnFBD20RLTG4tYRS0/5cjdl1Y6JbSKcLd2cQrZBHZTHtg9Zi9tmLrsj8ThbclXjr1OOo+nCiYNe5aAO2RyLK6+yzn4PmsfIV2H4Cx3fjnJ/o4wp4nbznVJFwYvhm/RcLKTlNBK8SADkIGWt8yW7tua4fwWvUq48kdQqhvThva2Z6g2BdvqjnhR8+om+Fofo4k4BGkXBlnY8H5Q3BM/k6Tw5HoWsIEfHyRgDaUhkmGoazsVoyMBwuGzxcbBtLNKNM/1wWj0GsvE+sw/fNnuseERY+RTCj/1zfD1jtIl4i0bEhHe5YuxickKSXw64WYV/bzVkc2sGT9l3A+C8+N0a2SZj1f2fv0GyAQrG8+n6Os0zs5C/KFlxRA+rx+/m54RN6fH+XgN3JMiIkh+JGOuzEtNKCep6o6ym8m1gKTwE0zOGw0qiUat4XThQebGoC9Kt1AwUpQicggKovIEqHpBWbqBAXUB80bCTqph+cG44sWAM8y8QOfMuUc2kzuhYlfUZELBwnkkv+KCsJCkv/Pp8BoRkFGUwYDrzwewYhrJ5gpdt3hX/3V3/3b+xzmVA45XXbiIjFt0FGkWhiE/reFMWGjBSi+BBGnE88pQiVFiaZQ/Ld96tEQJknPyF/eIVK3TRLdVctsIPhV5TyPjJ0Qo1RNA2J7F1bnK9g92kqx4QlWLF+SIzSe2iRXfqvOPoWUrBpD0Zn/bOiPq/NckLbHNUSC6LWVGsoovMELLnnPQQYg6QMSQFJmuIMfEvb+X5dn5CLtmZPTmQ4DoyRjeaBjXvbZNksjK2/q/IZdBvrZ/Gx+7ziT9mNJtmVwf17Y946W4/vkTibZ+wLqV76c7DGGFnqTEODEkplWV32TS66SXphlxyDPdy7gR/X+d1f/aN/M4jVjOXiqC+z2YkjyvPrNyFjehI+Q4pdPr8LvbZna9O5aT7DmHBOhCyw8ME92+eWZSqEHNUH/YicimF1qG2FbpcheSR8oyaez41EEzuu5urZdUINgdxBAup5QkF1zSgmSlwcQr4nFfki5FgCaU2VbtVOgiF5n4xULQdIjbEZKF7rHKl+lnk4HdzbhQa+1M9KNvyq6umOjPUE3aQi1FhN9ilsv7sv5ANanu7jFVroSThjJ6Qxaf9pGa+5zxvIuIaxI2AGiYN+GDJ2rdXCTuLX6JnQLqZ2MkZZEGH1EavAdtLFH3Fh05+xw2SuHAa9ih/q2k4nlQlYjdqKQyxjRR/B8lbQBwzalzUkEjhQiwGv3AD2cA1ACTlTiLwZyeIQOlx/c3y2wC9zJM+Phig725kl560JamzKPWbM4aBjIt7AYiB/yaYOnk0MhJO0dYQ3YqQS4ZIEudLPMAofwPjy7XpQzliIQmVo71FhLGFrlBEX8ABjY2ocAwdUzajgBh5LNhs8ZIiT4y/y3P0CilwOd0+unZXw7pm1d+Qb53VPiutCV7Lp66zDO3NTCEYReYaGcs2Can0AAeeQQWwiPbQuOfZ5TBrt0QiQLrf1Y50hpbUe55b+WON0B/kEwqnIXlwc4Dx4QzMnsyYYu096pjPARSbC5iiWkNWwekawjHULTRfOMhvJxp+8osJU2Us4ZyZDBkxn4WXZhxPGsonCXJeRzVxOkjH8AAAgAElEQVQzyVH1e6F33FIWD3SXJxY5IpCprOuwoxQ7iI+PCeftSG4Fa9UGHQGGh2fEWT+IJa8NTVRzgWpCohHLH40TV5nWvKAwTV2fcAdVIanvRGgFhp0PChwISBJckiVEEgGeVB4ZHBPy2aSYOlUyJwdyvBpkKapmuPqbo6FDgqdZkPFG0thx3uqQxkWWyDXEhSih9fnBKIXn2s+uMIzc2wKncyCnUmbj13GxpiRlk22w7UEFrC0eThSf3kMHLoaXCFhYyypab5LkRVKq6MIuTqndelx9LM4asle7nsPzY9I7LXUeQoEWJ56RlNO7+qhmTptk7+ETH3mApfDoupGq6bTGuMRnsoRKnyzqj/OTUlxlNhEmSrItR+A3rgxGVbZzqDGjr8PaBud6/OhlHzOGU4SdOsNpYPiYRBmaZ7pPpI8zDv/Oq0YLUae93sGcWZsNPOOR1/+MPgkXwKTzaCnxCbJKDR5IWXP23hO5bQHPSX1YxMyGI9lc0P2PZgwkFRE8cbrUJsk7zJnTMMk89MIpwgnaSrzRmuXhuXFyfe5IhARl/rt5eCcMvwEhDMxuxcDRNS8qFrFmcpGCE0I8Ezgyjhxx1q+Ov7JC8y+Ihx9ovYVzzd/iLan3e7Mg1TlPV83KCI205AydMm2pC07sPFsIOPq3CK1+TrnakoljLoJL2mQQdzaZ9JeV+uhLkWR6MlhzFDqetF3AAXx8PpzHWK2T7vY3/+v38NEcT78swGrXlQqinl5dhwPnkL0XQ+hSHvOT3b0IVDM8jCb5/4h7lx1Zll1JjBbIL2gI6gcgSIIAoYH+qZ70tAGN9PnUIDPCSaOR7lH73KszOLtWVWY8PDzcSaPRjNQ3XbnoVfXDVOskghlnLrlb4lZZvATOCuF/c1Ur7HIZCLOtoHfBYjmn7B710K3kFtEOmayRbwtlhiSLlfFzyNAfYks/k62VpzpqynPSDFvXm/pcgiW1xXG4ragHU0WIe4CgDCJYST/XkBbrdb7qF4DzQNR1aKC23WARnq4BYt54ODbis+Z54S7Z4HExUYo3gKjDuGCQE/rMrPzLy2ZUyElocgJwh0NEOCgSxC8XQcjNMOQDrsuh03MNk+c//Kf/47/bOz6u2Tkj/l9BAnwXff39WDvTx13mNELztifyncpc/iv+928tuvKvYMTvng9ePBc7fD5m5yI1J8d5I/b0V/GifzK+zbj5C0lxKItiq6RW3i4NVCPnLNi0KKMidbZES9OiYl23ExsPnvhMSXCEKFMSNfeGBKwedTe2as+L+x6hCq1YmgqchWeJ9ETxer9P4uYvdIqEuKafrFI7G+Y2Utu8B/XdAalX+gZ3zZ0r3qDGGVmMaObvjDE4DUGhU8qWB399ppbl1+3756Cu8Bfb3t1bs4NbdpvnXwOPnfGMElKJEMobu95T6+C3oh5/DXSmmqO/GL8T5bZr2DCnTpE346agw2sTSLwVR3mjnb7TYd+Nv23m6/250+Dnr/d5QLPQJMcNZGwavp5skqeatvx1IwwGm2F4iHpzBioaeN8O7KhN1K6D7TU6Mmj8nZgn6f6a547T8VTTBcOYmlWBNOiK7rikqVIGRJXlHZkT6LtCbqQt659gYwC51n6EwBQjwZJLmZfc5hOO4rnI+TtXQGkcsOsOYAmoAwXOBSmqowx8DjabqQ5nhwv2G+veKbM6FUuc6nunAc2GOHNUO5rsCiZUYEJhruFYdngfnYqZbcYP9rfaLZoA6s0z2bhQjq5xbxGkaf5NWcNuznTvjVJOPHTQPDrX7hj/BL15O9anqm/WIDInltjdc7qs5+bsgte/chbsxfyww+flL85/gjDaBv09Rd2mdenEKXRaG09Ry8706LLqVmuHwRGGQBkzV75csxg374IqtoZhpdnNtPGOjPlcyweNp/APdwh1r2/EEfAI3EUeOoaL32VLv2w8B2FKN26wv+/E8/j9Ox4VJ2cU8RkfFoCS8cf7/500nue6Qzaqmd7nX21d6xjPdfNY7DZK8Xm+vvve5fXH57Uixvu2hAHkOh6PiYf7M+GF7cMckwvJ71hO13GF7zpwThL6XXv07I7XG6/nyTmqRGRiCd4KIwiKd3fPj2WCQBLsgJPt5sFGymp3NsP1rVWy/J3r4MlfLtB+sGlNAeGOFe+2Y2WfdyecbIKn0sEngWV3/pOyozrOVO5SmSv/fKLnggE5fRu4vEkU3h7n1AVwY/k+1nbo96JsP79v6v2a0CSRyBzH5CzRP76bH2skQ+NCGRdO2jziYs/fbaP4uHDThszHlw/j95krbB5q4/SCgQCnk6xdVEAXH35O8KzaQcWGFT8nA5jNOFSv07ChQhA7VYBB4xI3STIchkRp7j80f+/x19pqUw45fPeV8QqqNPGa437T/4j9uehb/q0c13n94HD+ZaJ+d/jU6HcfxwnTY/+8KFqNIvXpST0gROKyg4ejQiQ75RWR3v8NYhZgxV2U7p4IsXogZSo1Of77vS5F+es4Z1b0DA2TPpEoK+lxfZdd6qJCHbdsaQU9da+L5Q1ywuMuKKbroXGy4/5xApBhwlJbf3+NT7bIZgXlaiPN8yQ+J5YLdxoj7nPnY0oN+vx7Fs8yMmZlsa20p1wCGX2DRJ8gviaCTxvKl/802JwQsbdI5tjB83kBtZ7exF89p3eDfgIh7Rzodu5yO/esCeKC7Vv/dpDVDmLbjc9ppnP9AcI/mbQ77sgJWe+Nitju+OeiGSG1//18hfrjJWp+mYuA0sCYu04wjCvov+o+a6mU/9aPN0o5V/0e4tg3RLKYeJQYpO4FlA7QG6Z5NmmE77mtcMkpCCDpRST2HrAY2eva/InXBGqEFRnf31mIVwZj1JgjjENG9UJaaLlYy7vmHYAgpWj3nv0dGwVPrmtf51/s9KdCHFhlQIbPwhjDAkPs97kQ4ae7/V3zff2XYmmG88s163fNy5/WzcNDXgYTK/a4CGi+bpCRE4TQ1gGRXAnFYIlsx+QGAg6lmDmjluHczuhs97qyCnS3fj6o6pI/zvLSvPZ3QX4OnpPU8udgU57JZKzz3MNZRp8/0VOvm7vOEHYsTthMNqubd/bI3vX3Ow04mnvtIzuOorW6FI+hiYe9q8lZWrznSdg/86j1veOKrIl5//sasryowgW6Vp7sb+DeU5iRmdZTEHp4fG4T3aI7p7XuKWg8KY2oP0oyLPoAsrxPE8PPmr81WCdQi6OYzjGp2AiFoJ2hTvkvGkq8kMLLSB+VO5pJwv2x9/diEbjj0BQRqEFZpxTCd0zLhu2J4b8unw8WEz38N8ZBHj7nhORKRJI2eYXCukJtFSrLcVth2uXvXwItbZFWRqUFYiraNIEQPFoIchOLtUsUUg+qGTzzb/Gh0ES7rs2b6U41qS4YndhQZx/r1Ptd4d9Tu9IgCONK+0Bn9sD5RsMiELXGnaGrBbGxs5zOsrTYBJ8LcoFmN8H8HbM9e74GECfI0Bprp2foLVwtrWTgBCWr3ngWCNqYF8k9oHOXYX8BBU2KcfNdcN0R0U5RtusFUvcWRtwhRJNw0FgKtD1JdgowR+MI2xM030C4E6qGQ3h5t06ddOmcInYngeZ7K6a90ZhKkKZn2REzJ4TzBInGP3gXTlRf33Acdt1otnt3oNsz1CIj3yNQb2b82kfE5P+KusVJTeW01ctoEz2FgbvsSsk4anYwsGNh+4sJqFWv+lI2/rCIzIsHWj1/tRGdkJJ2bYQoG/XuHnXAlBeLNU8zIpA3/t28wjDMm3nvKik9qPaUYRPf5cQr9WGzl8KmJBbVilWgk9HZcE1NH3tx6jzpGBLJYLeB+kZdT1ganJ1jF3w5fV+YfNkwjgwKtPukNy17v7ntrp3o7CIZXtRjFfVq1+x0to2WBmDkwcCgQXKvtXXtQWQtncvfbLAnAc6uA+HEkWz3sv6lG2XqSJqImna4z5wYCNmQiJfzf1BlzNIgRKMcCFUNsUNE6y7wSiHSsaI370OWJDyCi6IG6fR1WEypqoomW3SuN96sRr6Prs2E3Vv8LrFiIIzbkwqHkWNJA6myZd19fxDnhYvrjDtG08AMb6BZF+PZhL5o4GM0guDgJbbDmncveuN2mqj3gU8V1enC56CEO2LA4QHsCGRVu9wRP/uUrJdyHZ5e4FU7TQp7KcC8j/f9fo43Y8PGzylV9OMPCZBn9yuSR0brbNDxQJwQMCXA/dQuE9difVcv714kpJ04Gf4IsMVljPbAcCMe7nzNDoT2a2XLnCsGUCLmmRCQ5cwpMM2zCuE68YwRu0R8r5dGA8O2kvkdkS6b75df7aRQzQ6awztY3FRJLbZYzwuJ21TxiUunUs2m1kAnYyT2mivVJBwkCBwYDroH7bYB8uGj9/RRIFVWMMqN9vk8/pf/8n/9D4ooxR7/1lVzam8/ERRs7XWVz4nnAefBUA5TYF1kFzO/8SUyYqe2kdwBYFBeGp+RTxffPUVMD+W+D102q4a17/TiGzEVtjwuqnC9QlhVN2Or5Q38/4/U+Mz+riz41/+dqFie/L58xvdwtB9kZXaIGp2+O28+a5vywr9S9fJMOe6dd8Lp8/M/ILJ+MI/tYCFhH5NsQO/bMo+PW0d9M4Wa3+EMmO86uoA42cVy4MnqfuQKGMJQNU4IZ1M+KU7XwA4trPaXLV99uNc43tEfJ30idAEkPot4iDAbLGCbTVMkfph6G4XIvnSp+g0YgjJ5iMjzOS86HpPvzHxbZol/+ZnIAM3U3CttCV/i4Fyc0eACrijAJU0QmENJgxKAMtWdECYfmgVVKnhtW/8q7AkBjUGUZlJm2iiiMVy8dyw8rLt2i/GOP2IiKFF/OpF6FnX25/QXSZrvapi7OuuONCsubukb5EmRVrGjmmrznXIeLFK5RNjE+ScouQvabotqiONAXEf3zFzc17YmPI3Fi6DyqnXh6H9bxwnkheXi+QEUOKKd+4IrVX7D1mOPg4kIINqgKxnAoA3yQeqCIDu0tBJSU+QloX8M7ypKt5EeM+RajHfHVR1FOMjmxGc+wxfVi38VeC4/wovAv+4x68mbXe5inObjsDWD2A55z+U+U6sCQZD6RZv0/kHLTZWVxGbj8tR6BvIIHF6rsTYUl4kkSnmQZZz8vQsRyBxH5BMzecsbcykW6fDG1AnCVvUSVaVJDe7qM35XcDoHz3Q8F8GOWnzYuRkvMtIyrUPE6Q6Bxg8BhRApShtoFDJqBInuR54+l+oDNL3jHtTWllFd+U4JdXE84rmhAp3pGDFA6MYyjDMHILbbVMV327fudy9evXJj770XqE2pPGyynfs7J2iMco4sk/xk7REvllL/6Tylq65+mU9bbgD/4QQxSgccoJ+JmzWpk8qg8aMXjI7YgiaWSO8/hjEREU0oPYBY01FEoxovTaUFzpidPJugRdBuAlRyrjPdQWTTuDWSt8qVLl1P866gsslB1wXT30cb23QbZ6hsW3BMLIixmAOmrCgtUUnQyQKX+8SDuDDAVm2UdXdYDrXQND+BHs+1sgeooDHvhzrAojFGH2ihMVN2gM5qIrhzpfAtpuV3vPl44bWmzeDeHH7N0bhDMhTZIk4MMlhpedeECcvl8EbA1L2i5QA24bsn2BOtKTiPqRcGw/O5KrkpnqYX7/YHKseTziLDt7HX5zvO3/HURJn7Ci+Ci1l2AGR+XayQ1j0HsSP36xGytKcRPST8Ys1v8534Hd5DvFPkw1whccEVUJtdIrXEjIYTgGTpGda2i1xAEexMzbQdb1znf7Jh5X5xEgOg2VdWYOMQQXUKNpFzQg4yEQKANuDyPugpDl+X2p1MyyRyrftqgjONiLVBn+KfjUYVpoO/FBzydzvdgClA3f1dlTsamcnObIThdKUn0mUoUhe7Gbf0HARnYWs/iR6uDwF3IWN5mMe3JbIzsciLUxkSH/UeFvoeRDXFagAYLaEDjy+Qoob32QVsHwMYDoDt+hmirvcqmpCsKY8jQ0kwCYrzH++efwYiEfdjrxFm2OGtE/QEPacUPHk0QbHSYgle+Ik/AlBY8Vhe8/jgQcEje/7RxaE1CaIbA1YpozUI1xBw3BDRABXgje9n3Y1UIcVsU97A28nWG2Q+Y6t53AtCpdZYwQGW/GrU/06lKXST1XSJN6KbsM1+pPYtSoSAeW2bELGynmvA51jfN5fY4wIE0VUSgGBXpbo43h8ji8DGszsNiYu8Q3hQR4Z0+Vs87qbuamRtGNnPkb0dPaTl95q6bYa6FqP7Ct7d0T/88fJWdUS+XzFmY/vGrYaV6nWoXusuWt3C5zA9G/X5woEV3uzx59uDXHzPle83ebenFTLAAh6hjbj7pkSpuKRBvOn3dxCTntvnm5tUuLKE3FtYFjjrIsOpZuQEofmIKCUFEqXv4vEexWJBXSkxgzDStE3pvLBTV7co4f5mSNAFj425ikJmZdDflSv5ue0c7U4W9UFXZ1M9aINlLk/JY93OgTbYygsuVmnPE2vt83Zez7TwoClxi5Pl1pEocvZDlhAlq6dGn074KwQevhP5qvuZ+zvBrygBve4rHs/kGDhZM8+/uwMs3ZoU948lMaitjL/CaVUCOt9P1dpxhwb419byCeqcjpxReJ76i50dliZfipTFxzuoPBW2t3p1doIdd1x6hSAiqDV5wpvKSjqLeGTeBVypViFtQT3ka+J8EZCuYBz5dAPVHx3ImWtzr05qrFHhUyIWwOok6KrH8Zj3fQDyObrZV8qTzmtA35+/Cbm34fewM6B5SDthE8MZCVCKbVjTt9P179hQIxRtL/mdaH5vg3IchMKfCEimn203flN2Q+m0TJ285XpsVUpPjIt2/IgTwZtmcy/P6zLt7mgUqF22N1c65PJgtGkuGEF8XaATRixZ53JoNJvFwfsTF+hbkrkTOlPJ261ud0TmzPUAEBIUi1ekEZMthIuSoFfdmvw88jjpZ0aSztYfk/MD3SbKSE+jFvihFvp4jRe1y1n2gpjWaDTrox/ApaWWYsNE2K03J4pbiuEujChUW+QEexcxD1SuQRqbZu1LuXjjnS7tJAcnKLe9X3oZtknSts8y/Ij8snNa26mW7Z71GFg25zwRnrqsV5fDJgPifuaTkuBfLGh318SEJ7N9C+epaVV7LvSLOk+yy2rPqSSE/vTqifCWN9jJIs4GNVMf6mHWW8y9Eu/CXnHOXbeS2Obd6gLcAgW0IFYm8/GzAfZzA16b05n0v3OCdIZBCErp4Jjxd16TDyaUwZqG/Z0iEQf56Pce8z7gT2PhWgdhIp13rpv+EeOm2Ml2QMTsGNibsZ8kPXGygF0nUebBgjpAiGrAS6KGpkYmEjl1X5hq5z5s1C4CEZ83UZwY7oiEzQVH5Alc8trry/wukIyq49oNwe3kltnpjSNlrlPc0Nk6b/ws2uQoH0crGbIrm7t2o8sQqpMvBIprWgeHdhtxhDErxHdnNllyWrvPRQ9DkIsKyy/3i8AaL8j6URx/dqZb46h9A1xIUJHLIer1+aOk1DgSgp9bfQbLPYbHJRu1dIw4C74XHuaMk+kSshS7y+D2eQH78DgG3yzQlDvU9eJ0sk52ualvsjEWdTvpuirnHzKZE/0RhbL5dF7RvH2ZzlS9Qe+me5z01C87U/ybNukRWf80cPjkDb7JnrdR6Vsf79NI9/QzJ+fZQZu7lpZTJ8Jdn/ZJS8dkatRN+qu5hqZlBJe1bPbm3cz+BnXDm5zuVJAIWXLVx5ic85j4xM8we07o94Ahx/t4655X5J3vv4elcYTeXtZ7cPQQpDo+hq4WQJlS2RY6V5LPPcc0Ple3amesYcs8Pi4g3Jr5kAFKuQ5MlAH04xJJc9MiDDS/I8ADUYIYrtXrvEL1SCx59b75Q0ovuBiq14rxoYQviaqLA7kVNls+C/2VUnv39P7UoC9aK3uyP+b6OwfQ6xouy+ZtLt6TPvhZ1+TF6jlfj8n3VBDqLMoy8DVx4Jrj0ju+9BirRodDdjNc8WgIAMhaUUd54SaEDSPcfQftxova1YjiZ++fPdygrfsMkZr43VTni/cQzxPvJ3zmPvZ0D8nnnpwl77HdBUvd2HfPJp032lCG9yiJlrr/KaiKNX8PxMtJda0EikoyuJsDvx+uTOVPMIYf2OSpTAcMhzT1xcsrhT+NiZBPTgRGFSGpFg9RV0o9qk2vAteNWv1ygQ+6GKNTlTkOjDCX58bnHDMqn1G1cW7ujHx2x9jJd7+B2A+txqEEvsKYgAmCO0G2IVkZKn1jI1CzRnVW0ipo3AeqecFatXn+nPI1sSbJcBHM17Hh5GBXqtT2xybOa8P54j3WzV4ZpQmXv7I5A7xXu3IljL/70JeVtWKZwOFEbJPIm8AlYBMHjgw72NIx2j8qy8Vy8ycwCR9TDRINbAmIWmiJPgOg2yz34kN5jBu0wklLPtq5L65BRivHejFLE9896hd+vH7UUozb3shosm1ta6ONhSqfoBPxUMQHt8b1hYKQeH5+Lg5d8+nq7UXIQhw3nu+ia5n6K0c9gq63k44HPxdb3QaLm8DhFJHrPuoNVD69ZzvuyA51G4b1yG7cmjLm0Xsj/n3ZXrr5TzwBO3MM3JV0zfbES5tLsafPY/tcO+7NztHyzdw8mdtvHAdPnBenZzhysD5DNLyrH2zrC4eLhR3cqG1KEX9dSHb2l9PL5Jtx8U3JY7InPa3HUekm9oqrIOuY/Ef1d1kSi0XcZozK/JzIZMMCLV3t6ODP77uN95ozzNAKJZ1lOu2H0nXXNByoZ8fxhSpp8ri/ehXYWS7gu+iO56FBfheUclE+bMrFQS8suBLcOFkrms8Bw+bNsSAqF7DEd5jjyue+sLnO3bt7uv5NRK9u7Wrm6+CQ2pPHVBnqGp7bZfsg8rIzC2V7iersApndJnkSpO6CoYkk2+0Ju+/sAr4dP866AOD05k89408iRDt86H4waSZXoh0Md22irhP/ZmwyidON3V5Mch5n7sPu9PtPJnDo6SXPt9U07hGjIeVtL/tbhlSQdP2gVP2ezy3Ble+1XCmISEp/mJrAkDTe2FXihgg9QKwo/e9CETf4UahnumIJl+fu4gMnbkH2qfMbRwv7llv2n4sUr8oUjg52z509rWCyXedXRgKVfx5cKpRAQVxKcGl5cepQWmZDidSF3ggofEmBRryu+H2AFY8eh0XWt/DAN/T7vkNLtYfaK+57uUuSTwTlfv3+feVS8XOhEU30u5x4I3yZU2hPOZHKsMhcS4+km6j8FpW04sMfs9cgXYws/+ghYop+ARWMoxfGrcoW3/4KSeAmGF0aXzdJHkd2bZGdjq8/n4uu+fZySPfF0sp0Pz+07A6YkzpfaLONyyV+XRNO6B3Mi7Vilbj2LA1jXsxf0ZXVVbD/HfP/9X/7v/+njiK5NY0d2JIfNLW6WVfaVMGxcNGdrKLkvuraW313DOUmzMdlSF1pyyuJaRPe63+yUJzQiZ1F4ynT/9/yf/8kIDwJVk7G8vRcu4Bthwh1geZoq3hw7/+Wz+4ETfunz/4NtHwyzicOfydOd6e2pPbv9P74y+dQ7ZGjq10cBz1Loxddl3OyT0n0xKtmy7n1N9ubcRrBSYbTOGf/O5TrqiFvdcs7eZvmbWJ+JkX0uaYIZYx1iuX0tJQMeI1DPGzGkE48Lt7w544/txA43SjSXm/JW/oOjkDND7VF7HkYCBkQnHTCw5SgtlqA1KyRCS3+i+yrA16V130mHAK7rxBoIrM7qmJ5vr7f71d+kZtrlDLVar3qM/zcnoUDVKKP4uOxdNtXYPBy/5zFwE/Z9/LbMkFhQj8g8fzYO7xbe7GvoSa5XFiRRd66ngoTeG9ee6lJoo61gSiTbbHyumBP8gYa5s+RjG5hlVt8bqht70k2l5+nH8Shja6TH5S9eEzTml/94uZYCc1zhLjWE9OWN/V0f/Hdrl97CoDY9W5tOGgQyd5djjfnGXVF8T1gZzxBHBTrGaSjHtorbFwfm8/1SVHvsJE3T/Q99GbFlvcqYUrnkWj0ecgSpZo1KE/C0m5UBXIGw79P+PpFsIIRaOrikcVTqPpqnlwIbPVI3oGciFeZ3NbcOttINtaka+u7935mXhMUg/Ly6DZJiMBJDrnUC3Hxma4umup7yLumsM0Mx0LrpRC5YclQ2T2XFL64HNobm0scR52erY5EiGE2fb4YyjFoghR5XtgohRsht2J9bTUQpd1xdSyBrqsLYhVhbLJoFk6C8Ga8zaSHRImDmh5FsId5x9sU49NteMjWTy45K+LZEWqaYwVG7fLPt+RqXyM/qR3vNvsOVbgOatW7UqNVj4v2uxOyeHLtTQ4txcJOyIR+kI93W+lOtGtan7BBUk/0EIbnLp/DgXX4EWctFls5Yj/iFnyEAgtuBZfoHESuQ28iYzmQsS6jrDRvO9LGQnSMugcXJI4YnGpWv1qZt1oFvzTqci3+sKtfxBe97HKnjkh8XdhOwiar0TLRqd0vjY+bkiCWZc40Zvl77QJ6d5daFXdKG6fNTO2VOq/Jg6D5AmC76MkMlbSGAIyaFtkaNI+Rqj/LxVmMbbdAwWsIkurZVuv68W9jKcq1ZbYap4sYCwrEBW/t1jvDe8g41ZzY83SyjiCy7T2JPsXAWXEliwegQ/bQ67azs2PUPvJc5k7jkFRFKSDDgEZ456WgUAwVdIpx6YxsG/fYjLYp9eyTtTA58JnU5sEUhDRj9Byvsc8+QXuK2CK9s/J410CY3j2rOKZlv1HP42OFloToKiQJE/aOITkyTmG6bQ8xYe8DDjX4F7kgJRKMXvg94I0+BjSYrZ66jWBSmDrFFncB0Em9dVvTbDa1/FAooIHWGmP/gOlFVh4KyjvilBlcjofe+xCHUGv2NkX7/W7s2kUD6AWbmsCpRRWafFvqzAPz+MUFROD+uwwLDbq3Byhx/FqcEGa9qE8C9T2oWuxdj3hec1RrLmB2xkH4wcDU2y/bhdEEaNiNSxMgHSdzu/kx/bqZL2PyrBxNd0QuMf+Bj6sAACAASURBVD7lsq8N2kG/g1g3cXojtMxjQAe6stTRumRmhiYmhp4zuWv5Q77ZTOlQy9YlFd59fLVBJA316teqjA8AvIkcIm6EaAYvS8nWAb+jd/eq3LYyAmdJ0YBRe6m5R4WouMBkKdGcDbBbVZaNzdemcXl2iYKeZLIzZSMNniaSUQ18IsUhEzYTmTRqF7ilmn6UwE6t/Q0k9lRGLrpGz+WOpK7m9rB3CymUW9+MLMu6koNRkInhhY+Zz0WVncETqDuW0ybRerKbkOj3iioGk68H2HG1OKVdkJG8wJq2pSOV4zsuQ8bPEfOcK56KRHIh67l7Z6NHE/USJIqSCAiNbvfeD92ddU5Men2DH5wQ7yvBSWnszIObSmixy4HLfsrh80bUxPHiG8KOrGzK5gKBYgXmZN4W0TEWMGNIOnR2oDEV5ID+vl52ry0dJxGJY1SNvudhHFKAr9XKlzBfPHcYa9BnINBBD2rYa51V+y8tk/iP//t//X8a3wvX0YWbhpt40SnBh1CvatHyHfOW/dV3rO8dA98Ofn/CPP63+t+ps5YTxHlUP9pEmL6psR1E52Mf88n//srA/vd6dn5Qc/vL93dmRm9Y9t21vWHA7/qXJ9jb//48XZAjX08Txf0guNmtBqrluM21QFT2WE53JFbSvXadV8ZBmW/GAQfaTofv5ckj76D2zriyxE1TpdCbBKCZ5ympMHqmpPkxXqebDHbHYTuY+4W07P1Y/21R2n3kM0Al1xCcNlkPppsZhMxaMliziLpqO3xjkvBWFOgEOzu1onyzUNoAVdXNzdt6z1Q/ujZlgq7m5IclkBNI8WQR+SdtahNByw82ux3cf43llt4TfAcjXrYXnDI7cy40O2Ni9qpre+/1fyKiNdwnNqTNkpDs5j8J2UAoTXeGc1FL3ojv1rmiSrSng4UbwcZOwAtNMI/u3zvxsoMWY6WkbWjLJHpMB0KqEuBKUsg8D6YgGY2oKDmvluv05himf39cUtmRlk8SsSOb6sBybZ/p53VNb7+AYFhk/7Kgk+JcgY03C40LdrMc1KtC4Ec64jvpyeZFaBO1wefbp5rSqrZWwwlsDHfYqAKlvJCNcfQiX93cKEDxVd90RZqna8pkquiAUSc142ukTnOwWc5Bir7ejsyV7yGOBZup6HN7IoZVR70eMajPyweXvXhvbkvxRhHg1rOvnu/55+hqp58FBzgrE+9LfbFUadLpzsy0WJN1vAKMn+tZN7WfPeNvfbAcP52b0pLM0+E62QXrXRD3Rn3vGq5jktC1F2unvdsDxuTjdMzc9tbYJ62Y14DeTYnEtUn2hjbmW8WyI5g6Bzm/D1dSvP1I7x/TOp4Ri+fCrsItGGspoaIIexBTeIVj5Z0/l22IntCtytddomHMjF00wtsMxSJhzdnfGLgP4TWpKlk9DlSdz8OY0EqbiOhFbSi4HOVJWI0Lkq92KDa5ckxC1Y4F4ZzR2IIxu/XMbwU1s0TFb1/48Pnf9cFqqvZ81o0KnIvR6JaJbDZEj676/8L1sqpTKI7DyrgQ+9DZ+KMREUisQSClqcipK3LoBpClXDfWi9T3swKOheT7uRsbIuW5pE2dsgkLmaD4vFnE1xptkMufUz3sTZPwUKbhTpa+g5v15HlJ6pMiRPJfVM08lqqdEg8cIJ5vhLGOCbLiWnfdUKdiZ/y83sqkq425G8/duJ1K8J6inX+QfseAYMrEFR2BH4bHDOgb0XypBCkzQRSvwb1FhETx6z/jdjeJE2Pi1vxMS1iODiJDaOpmR6I3rL87auNQkpoNYBj3n6CJBHJ/YmhoCqN3UeRR+lnu/A3rBc+hGAkiJckik0AfRDGGTWU6qmmZwKJZG80bwISNDq9TeGgpjdAxu4XFG/xNsdcUwy3ek7ru9BJieMMIvywOMJZbMn1CcfBuAek+gAY37iAiJfw/YskQzEAbMNdNVnZxL56Ie1i8CFVt1Lt+90YcKBI8rTlvC6hgiBnQW7+n6SnqxUbxW+EfOJ0epE0QRbwgNLwUCdkfBG0SIIs6Jdnmd9npdmJlN3G62vmyRXB2nWNSNlv71rITpG7ZugcwqzBcT+9amO2NI2IXMJtC0I42raecm/p7llJ3EbzAlGJj3KMuUi7UDpNI6pH4WG2PoSi4LDUusrT8fSDX5xGTZ+PWoFvjffE+UVSrkAA0RHtL4TQLoRonm42Yuxp4oRBnR1Kkq0rlvbtekFgPCwWaSFy2jCWsxOu6PKnJyb3OxXdDbc0JIHBURrqfwHFX8+8JohRjWJTtVCwxxEC+y7DMWnetuBF16noxIfambprce1leunm2iazWZEbPaa4KUpU578LBrplLZSOTWVzTd+W5EF168cIF1fp2eJkZ8Yfn1B41Zj6ty8PrOWGu28ycr2sALoPJe6zHQrwTa82MqE2KRBYyd/laly9ja/N0cqiNrg82uRz1zRvhnIGY9pi9LR7yW4L6AvM1gMDTWOIDytRBRtFydMj7T0C2noEMAXrqysBSnyVJW3AuHdLZn+5rq96GKq0qlTAzcoUtOnaL30ZRu/Tt0GljXpUx/bYt+FjTIywWa99llBViwUnNhzYIoNk4GugDopWqFWtoaj2Y9HdUv+kgxzqRAEvnENeSRF3eRNag4C00G6u0oFef6ZJGaDRLCpOcQHE7a8/J/hUN5OUC0Z+qMCc+ARDBoiAeKYIrmncIwo4UPoAPE0DT6UahqV5178fWDL6v5K3gYNBZtkHhhe2Qy/Ugf0YZFSk0Y1c39gnixawA10Uack3bNYGLaD2Xb3KE29pbixf3rx4cLbRxr1URYnH9nGQbBPZoFxqof7Kvlkhfh7oNqFdnB171SAaoaEOEiMSfHXdj54Nxt9F2An2+MtbK2flFAPj8g1rPX2pIdrjg7pi8uxrSBL9MVpnTsXdkmhMHwV3Nrn4WbUCgFLKVe9wQ+LQTL1tYOEFTLLLY37eyF83XkQWm67FcaH2vZ9ABa7WS4SKW9gKtYbN0siwPhqddY3q3XqPd2mdXx1TRz7wdw3luu5To6RanK0HEt+J2VcKDzEArEbD+XpEPKwly+jvNCUmmxKs1iaHoqhPC187EVBAE7p3rYi5puQjO3SnYD8+lIExh3UoBe/xd7Uw/XrdcuQAOcZkPVS4XgbwkcHtW/XOvpnJGbOBiHU70nWJoxy2i0NfjItH101r/idIr9HOW9X074B+AEJmfGVDqjTQFp3pzMWZz3/K0GZ8w6HfayCdkl7fByanNL49PFyz5HmI+6pmvQqZdqLC2tWuD0lg7MWEw7QGBWt/dkmP6wAebz8B2LH6zXmfOh79ZMiKeXx3lrOYzSFfCg+qaVt8ltGGCetIo47Tzaa+oBI7fDeV3kWukOa9CAyzUeY+WZeDieD4AFp3CnxMEPqEBStmPrxPUXeLyvmu3xP27EEhJaTQIaZ+HndnMhwo2sF02FXdD9QRF5NtlOFz392qujcLIeQJXgEJ6reT3pCC/1r/iOHgHdEkLSlA9JS3q+lVwLmJ1hTcUKHNr3RPHPOsDvis5bwqmejeojjT5szlJq9hBZsZF3puZfX5Vb9x+1h4IJ8u3+6kBXl/7a1+mPoFYQSbXUcKo9LCTt3WUNErSR/EcuA25Y51xXWN47Lj9sj381/gXSWIp1tuWP7cFb26P4yDOZdkr/DkPnzdlsDTuaZVpPLmjp7T1sOvycMgrmVb/jT7b5E0dj2VBHhoMCZBa231s99w0IhfxcA3RY9tVpCsU6KKqnJKedrpHkCe3c60s+pAPAS7fbxmLcO3peYRnUfzUXaCw5Mke1fTKd+hvHlX47rEK45ibPn7/8QpzuteOGBOZAyhN802wOZmxqDLgZXsb4DPHzLNMbJcsuO3Z51PQqpsP0SQG2AQr+bP9e4dmjLvQnJ8VZCJ3Wd/PgBLSd+OGcobuiPPxsJGu7hpG0boHZnePTFSFqDx7bipyNm62FZiG4yHQZ+BqLDxUNknwvOk5+0pOO2tN4j//n//t/x3gsJ0H/eTfbbuF8+D4tsmMzc4U6v7/+t95Zu99HepgDNYEdoodvckhXWSxXry4899QrpOBdf+D1qJ2/f73eHqdVc3uOSi2LYqjN0tUQ/iL+4t3xeQ4myjRWGIH95tQvHN/MeCzsFH5nM/HyAQw97kbf7HN9+9bPZ4T+zxmGbrcohni3VqprLfFe7sVQtx8DgIirxYT+3VwVzHqlP6qBLOVDo9iE04XrySrtzwNz6qIRUnZhJOSDXbVXlUTQxx+vgi9VZf999pztv/7NBstrBd9uTaw/y7aPhVhmW6q2xBPLC3/VYN6Kqm76zWdQexZgAMN4CMiRhkCzNfQu7b35RHU4qAJkK2B+6fMyA5KTvxkXIGTzXhN16YypUq6BLnbaWPpHUSPowUHh5kQhqeYvot3C4qC/tV9fZnYSjc1t3rdcxvo3h+pkdA8oyhadClESMD1Q6bYO0nJd4HHxpW7HQ7XuK0Xkup8OFkL2RJBEWU7KRehlCen8HVQiX3HiUrXLC3O8aKi1Y2xMGr1Xen2LYdtQsamPWZnnfxKrvtjvVjDCYS2qzXu5GK7m1KD65uN9C8iE5PyEw6vf94q58Vip1jVjRUOZ3g3Hjt/bhuCi11vKwcqCr6FHbt8HSy4fL2QgKafrKaHz82HDXV3/WanenNnPJF9VtrPy1PSoG3GfILsi3AQNhuv6x0SA/yVTHYUG811q0/yirXeoMRCSgsMstHRdMhSVXZtiqxhvkmSpgwEEEYrNtjqhdQ5PSvPLPp4jNJmRfrJw+4227jTd9mkScm3FsMAQSKQxg4Cl1f3ekMnlx7WkgBfA0QS57tKnI8iFPVvb6IXZREpIpkUYX9M94jmAc2sXnaoqwzXLGLRyb+ydCkzaSsDt5d3tSIgsX5me04kgYjetc8F6zefK2cyc38r+41XxJH9uq+8NrkwWOrYqfE7SsPHhSGF6nKRax2avUn9Hps9CrW/XkX1apykrk9j7NGOn+X1B6xrI4QtHVb76ZsxSs+G1kvlvFjYzM2i4Zcorw+aDW2GcIK+dev2pDo30b03+4Cmk1vfbnUP+NgphE2g2hiUSH31ZkNQggO1vBSqu5Iiuop3ZtAruCn5UpULuxyrbPntd0t5Qcb8LqIYUc5KH52TXWW+Xl2SWgIQHkTOEmGNj2m3JCxSoOBUOkTEvVhlINy/UnIBubxilBd3qWrJXuHZJVa+UYHylEWZErHMVCtt5L6JfQzRUTYKef44cJ+GsauVlyoshuZ3blooSECZNLWBWlOLQUU3iBF2i1a56v7y35Voj2L9GsGHHaSo2gdXy5Bb51/UeU83phHS4KKBD7kFVh5rEBCUJiCcDHCmMyUJ8VqE4VQL10WL3yZblZ4F3vuFP5Bmx0qmzWAc9+5VEpskmqThpF1ItjSrfdEbgG0QjortYS5EjIoLHSWWHCSpIChpulwBYsUgusSBLfubD0Eyw+9KnDIlhj6jasouuklIoRCoYP8NA5nwIos9E1wPiW8ZKZzfjyQT0HLrbF63kAJ+hMenxMu6clSt9oCUFxHGDq3VNSu9IxHe+L2Biy4poJorewZzgKrsnYWIzIoeLfq9qkGFfsfsA+91bN6/apKt9x2zTuGxQ9p+//6YeLsOIMqdfSm6Rk1bPtvJiF0skqp2Z6al7YTi0ohz7loMjwpvPmdRol9Z+2iTH/SOMFn+HZsmbO/WV7Iuaoao+oa+b98Mn+vEpJ7/8vnYqzyOC/33r1wR9jjHVMtrnpGHv5WfYyaTQanHa9yb4z9jszpyyt/lfBDJCU6m41LwrvdKwRnWcWGbWuuvE8aimnhUEpcue+H4TpewRLT7ungUFL+bF8ruKd0EE6GVi/xQjVX3dy4x/RoxLem2aaGP38p5ayDrJyWC5ZbXVl82pURG/IvUqlmjKa/fI4jAFmK74cAXO66Ab4JpiATEagLzBI9dOXmnPTOt9Z3p0l8MkP6iw3OiUfMVAhLYbxEbEMYvRzVCMeImUtEJJ56oqQwbUjtTXwfCDFNunQNdC4LvGZ9xeTFztZQOyg5T0HIFqE7eG0mKQG2Qtnv1dupooXWJJKpuFyM+nw/n96y8KT1tXEDm39v1cg4e90s8u8uy9498LuJnDOMG+k7pNE6rNepYbiB4Q9chXp+Dq/MjF1kdxGOYjSRLMMnP8A5M+J7L8T2uP2vLnfg/efwwLnYCCWwTDv4rNkt4pxxxmmSckpnnTqJ2Mx7tf62pb0/chFOy9zWc8621NTYb224jpfLmUZJ1sud1a1G3h5jNlr/dWHSJlbrWTrSumFh9dHksCxyg1BaPSUuOLAmuojhkM7xtp4B24ko3nw3d0BMLhWWydeqQiP5BDZzYlBrle4x5jrEKmAvvaql0xWWiW4K7gapcQfXNIpMM/saFGfCLsk5X4AXNK1Hfj3NOxX2qxBt8A2WG4NPzQD8PmIvgqjwjHnwye7QMo2PzHONFuIlFdSQkAa1qpbze8Pmd3enJIgwOhKZaSerB2glE7RfobhM9Rcl2rO5u0bfS/ikw7sPNbdqgd2TYS6AQ6vnb7rm8yGD/iTPe6diffG5j5XujJU7mtpjU94R3hw1rbzG+EmVXV2sTl0OHMS3lE2heVhz7HK9/shUMogRrdMe9laNcDG/UKFmdzo/zEKlGCoJLWkAnCQulhKQewr1PK2PQNV0yLUeeD5a7uZF7vm8vkrw/OClUdbXWrv7LkF7U+qf7xbBwBJdHSai9FxRMC4ryA9g52XWtNYPfAiirbU/BWvtdLV0RoL2BVxkqVNfr4v47X271LMPiLe9nZz/ajGshQnaS/HR85ap33+ck4Spr7CzNyuutU7VP+XmEgOrnGaM5EZ7l5B4QpvicT2Camy+kJ5wniDTdvDYn3WsEMSUL4ApNwkeCACxwlktEqQ4WRcOKoNj34x5KLV+C160vpl4aDycAjjgmaa1i8TIQXyv83n/nQxRro9+n71h2lvY4HjRm6r7itYCuJ4q5pdnvnuzegrktSikym9nGfxfF6oRyPlClABnukiEeX/fEYXf67oNCxtvNpcTvLT9qa78SXLDeva/TFwJ7f+f7oU98rh4XBIzwWpRqdCKHBBJLIWI4ccdq9wdcqyb18WONtHI1l5D7Z2+oTOk81UIokggswZHw5qW6INQ8QQBytlgCUsGSnJj03uyQLGgBa4QyrFZHrCF08WabGPZdAqR0tqmPtnQvXVaMixzNJhECl0QAU8jQVV0E06ZHrmwtCIUGIMFQ+VFjjgYNZVfAJmCTSZVbazjVlbSm2qgg8lYWFVfyuqAomiht6rXS2KsgHpiFCzD8jY8hEAiEqErW4FNA0LS5Pbv+wMFimAphI83w1bLTTSje7zMXNPnYwncn05kRbQ33oa2tiYC2OGyA+L38TnO8sS7ZBTzx2EAFB35mgKGUCEMkEBqceH2BOZ90/3+hQ3ZEpcct+Cj+eybuHL/EZwUiZD5MfnMxttH4UJo6xikZfv4e8sO8K14gfK67x84M5NQCjSPielRekL9Fc/XeZKlIN/kompEXKeSdnQTuKk7kNQvciXWsRTAH+GkxXpEgmGTmIcrE1H4bwqcSPeZFN2ezv/M6YJd3zgLCujR0qPyiS0XqyS/k7/hXjFbv78ZoXCEITPz7RbAhQi7dOI22OwSWlKJyTthYbM7jRkbENQxueWGhMXNHJF1Saey3ysBBhM6YwTwLizvVnirJMd5bKSx5aIlShMxkjG3yuCdwezluWmyI/CrIoG6LHBmTAQjANzPBq796VcCE1K7kEiHo8/mb2WN9qmWfQOwnveJvIfSd2MypJsXuvDtTsNO6+a5U0wUvw7nbzh0RkOK0C6tDRYfn1UlVlHMpqQUTlDqILqoOTeZr8F8AMNaVgOFvKkXBi4mD4dd4Qa5AX6uUaa94ct70xDFhEBviRXeDZZEkghuTxOLvxp5wrq8C23FPpDTg+KW9rxdU1x9ZqpHMFhGvcP5JrEaR5by551MiEIsUPQRKQcZsVTDDOWGHZCFBgqTpKwmDpu4TwuWxJmrFK7QQK9WxxJx0QjAUsXDWpRdzMz77MB9k7Tp+N7zEq6xQtQ1jws8iUXud+elN5m8W91sopO5k0202Spa9VZtoak3s+AYnYlDNnrr9w06Y7Q1fgLef02DoDWHvZJ3cWfL6wdw5Fdryg2B6GtuThLnsJ5+DgZxYirYZFD+M6KbB3ynfua5ty79dTUBxNcHGiVTxqZwrXj78A13scfJNIl1me6dGNZ7dBN1lOpf1DNZdRnT6otmLz5wsQJNK5NvnfJglQQgStZlOs5iXVq1OWtd6MaUax1nfooV/MB5vlBmfkg9C43tFeIomjyKWmtbQn9amxI3oymKKfzJNB9hop7vTnOB3CfRvh84w5fMloq8LrY7uGSUyK+k9oGHCu0AOvSkzpeMTqTXqXUgF0l0XyYQetMqWO2T6H7wLp3vdTv11Chienz+rYuFV4CazMurALQWjrNK3sL1fS0+ITNmbm73Du9/HG4rGHawKWFWXsmqSqkHdyn98X8WH3YMxXlJtIqXAouoH4iGAnKK4V95ITKVbtAXHgX+vdMjT/nbll84HEIYXraJeNwi9qQVafoU6E5yyGwhfcMVXmBANZt2XDQE62CliKbGDpGnLKQI8zVhtCYFvFg07W+TajSGKypwe+0TGeZcZbRZIsKTl8x3XUG2814sgYUzlqwa+nQBOkOYdxrB8TSlopDCaghYb6viTC8vYuNbGz7PTYMTxIvR9/Qwm0SAgSyMh2vYyJpgoOonYfWsPolBtpAtIejfU9f7I2LRuZ0U9S4qt856D8t1Yt8rfdWFzHY9b95m1d3jaQ/R3PezFlynl7HzfkPet5rQ7PpYZK6nPa+kI6gn9MFXvAahqSayox4pLZiCxj+ozXqMedGpvxn7bVxoowOT3To1BqjIgK0RtFglMZhYdi35XLzK9UE9iG7UWZDKbkgtmFTUde3jhL5G/S5wDs6EHdplxU79TmwaGjQ7iGWCqW+6y5r8YhOwgzxP7XbO9T8BfEZfrBRI4ZSqvsiToCBIiMuEo0RvVHTdNYOLfe2LOovUVuKldtMZmfXsPa9bTpwZjybxIjL4cFJGivPzl9ynCQPOi9swqOJWOWIDlPoLXNw7pbxDwC0Zo0WXvVaGNcaENWdHPkgiJOyn/oVOwzd93Ay6Wt3wW5LsLItfa4t4Bp2PGWutTovyyBq/GjxI3cYzqc6DaWd0QAPtA64TKVLJbOAgrmqL563AR2Yk9nCnvnf0bhwvrm4UXZNKq6EfKqpXdop2ISovwlO17f05qdESzSyiZ6c0hG9t2kXvRz041VOWmfQrJ1/vaVeYg7Xz1NXrKLKJquG+ec6aVratEyb9IOojmOh4/CF0KydkJZAYRM47od7E0w83cr21ZhzOhjNwJl8iAehF70ipr8s5qIlo2y5R6ksi80UQvGpX1Hpx8OGKf3JMsILTPkT76ki+MkoffLO16Nt18HWA26mJVPg+D9tmoH+KIN2mjWHrSo2LdEIQXjGAIA/dbYzDoCGrFpJ9WvDHCmp+uw4XGWSjXuCLhOkr3EBxk04s2EO+6obQehioPdFv8YQmR98nOzwIvYFH1e4ZAOm/jsmdDny+9T588Fw82Z93kKANAC/2cLQhWP+NyQPJa8PSZOr38akP9fY4CrOd48fip71VlbL+/d8fNb9TTHoHll7FWmHsp4f5jPkbVwF5LUPDhWJ+MBu/fJcRRtmtr4b3SDnmf7nfNfXCE9B1zPL3UT292uE+puvZtaPFQdH2+y0FHhDMvE62ifF4Kga61MsK8JzrVQKd7NvHZ9ggSy1eDon7lU1GyHHAm89vebPUnzYFqZH+GHiL/Zhwpk36CTCBJeyeUjsuEq3cKXtmJl6Wmf4DLdk/bjNZRzxBk6Otykal1GVzx/NDeHz0qmP1BQN2etTUz6oZYZ+FT2jq9BtMd6td5ZUARmVG7J+6pS8hkpmxmFDFSgz2+dhKg6fgqlesgvayeYYN5GxTWIHXaH1hzvC9TUWJQ9sEMANQgG/UZlc9NAgJIBnXSiVS3MD2lcvfy+U9sJLRT0hOkRjesUw9BMXMpZLemP/QSx8mYOtCx9MEwScGOa7wN9WEW8ej7TalmlyIveC0YJqQMjJodIBCO1qRcCzPYTGpR0G1wTINCcYbujNQzfeXouzfI4D7t6bM7uBozyY2fx84m+YhMiaz618HgaIgdp0hVK229kbouGVLHRIM4d2OrO17jJHmJDcKHw5IEya9JspQrpG5vIb7HrXQAOqA9473o54zt53b1NWwC2/ovXahRrr/eBOb8HnnEwwybUhjU+yc6yXnjreXiXDrJ/DKE8kCjVNusmdg0uHHgWRG9E8O8rtSs3js2MZqEFZ42QAyb7qlHuA8LzV/getvUB08m927Bts3GF3f5SWYSB/Xdabwu22s8dxvRpJ+9a9M5QXxOxnVjMnL8PxzUwHceDtgEJrsuCwUfCoKmHPuJPGaVPKn2SGtQxBbVc3vPHmagruEhsF1yPGj5mw8bKo8RJQKF8CmIma/mbPN5D45B6AIiaAnV0XcFBOqwa+Em2HZW7mzHfpjuJ3Odflby00RSxjbgvcT0iVbVXCdazzr5PJRxEmUs/1d1ZGHjgOuH+9HpOlRLaYP+u836BtYkHWpcjjqJPtC2TYXizCL3guGUpNpMm8THHhPjzcLnwXSb2zJcRuX9RPHNgNkfJhrLldQ4Gakq3ayrzCZN4icYpmK9LxJJtiqbUjeLerxpk4zVeyXAXEVSyBw1CbXw9dQz5fN4M97qDoyeAe8N6txogic1kmDGdhSEQmQuw7rts+45woo5Vw7SmTVrpCr/uShnfI/BksUw3gru78MuYkSYTS2KXoo4iJpM2WqDGOFu2IQBmJfiZ2/Pkov8jB2Z9eLmQlV4jXYEXeL87CH+ASQxCECmQShgR1lqi6oqWB4YFIo4HwAAIABJREFU0tBmDeysxaVKZLNy4SSYn9qkzeauEj9AO98kG29b/MwOBbMOErg3+9IuUXuUAEGr4V10uEy2T3mqIFrRhim+3lfGMfSzQkHQd1lQeo68yAl01DsVv9BupibHcW1oXR9Cf2ra9sgHnGtyRbo2hmismx47Hzz42nsd1KQKGH2SuMdFMA7ml9+yQqrqPZbh5coIYSYkh1Hb2i203BB3OWtT5qwDoeUSyd/egpRzDThR5Hzd0nBafCbhuQtSp1oA0NAuNdw6Q8YIRFANwaKtEE0/1fDURahWN0gNNyt6aVx4+u/gVUbG46rCziKC5FkWHbHGRgdHeMujnQqCvzmbPvimvaYbQHCa7INes2q+Z1jCGqOO+AI6NfMJwxLZCwuCGMy0i5fVCKAkZOs4fv24Upco1WH1wT3Rryo3UtVh8adUdIumvdl1WS95SMRr9JUvO5U4jTwrPF4Xng3Eg+6FS84YHS9dO3lm3P9+9vVPWISdTNhQ2M0I+3vcnUBRZDEdnbyzq+e0EJ2v5by0hGDJcnIP8/1MOItilr7uH17EKx+jrAVpZRafggBVJ84pOYb/3ZBXgRmSH3tc3F7bWEI9ru7vm35tm7q3xGdGB2qWymwkQHFQQ21bBTcRNzhINeEDAaFwLTIHCIjYybRIeSh47S234lFBEH0K5gYRoSpBbyk5SN4PNqjkbZjeXYleeWrsyiJdo7rRQrdY6ZziU0yRP58dZ8w8abrnyJh70N3XwGZd5mBV/RzTEbmuD3MyGy6JntdA+lscXWI2pT510DZSNoGoVy0WFiLCRcH7TNwLf7/v5bZ0QWp8SKXtX2p1d77Bi8a7pe+vjZcVFRjuof4t5Kl8cbcWdTUCdTnn84jFHk9Aj4DWLZcfPPuM4HqlTJp6Oe/vPq/Ph2Qy1c/Y5CE1ejvLQnb16tY9xRNrPOXGEC40YJ5kYgxD77YlAkcP52T2cec4mN1wxHn44H5Q6+m8lLf+36nXZl9330JdELuxSNF2/AK148L7rIXH75V3d5MVpZYZn2FF4fYTYZ4E01g9LlTaLzcyrB7xVLu9E9SgiieCOHRjKYPQbPvZBjbR0Yu7KSd9BalbDjmHIVC99bq7cIUcnqnNCbjmJtLztGqdDQqSihaKElLLLPSMvrPmCT1CU/9WGiUdH8dlPVwJn2mtFoy1bMCs41OhUakEeq5S3ku0C0QuZTEx0RrkS6FoaEu6vRy0tzhYV6bGaHGvCpDC2eiAJN6VY8OYfjaLMTYkglebxAGUOUnwTpJyMcXq0gJWEGuhKaEr6oMiDHMdMirgc1CDRrYSodbujZJPY83mOCRbYv8cT2ppkrXWbLinnSaFdzDUfZRstNM4+aGa0n0uP0j5G7XADAl36e1fi4jNu4EXbPne/tW0B4aLuo4I1Lq5YlR/Ts/Zw1zfdSDQMXiee1eD6hGVfpg7WHCDMHTn3em8n9asG1RfvjedjPaOMzV1Vak1+hqSFNicZJwoRx51mjTHPq3Hn+5VJ0mAbZ6Zeu5Kiv4axmpMQqwnn5f9/JPX5VLrhNjjBi92bxLBxPS1xn+9m0zDC+wgxintM2k9Y/iUmam2X0B8iCMk9H7avvOLy7xG9rZMqQmcWteZ5YhZvphlIbN0ZJaKdCmVuc6/amvrGJ3wRn6uHmv+QQZz2ljdg+JBkF9e8ph5vMK/dzUVui8VLOrFhsdrnTsWGKuE5p4Kll9CN7b70dJKme2hs94qg1QXGQ/m1bT4wESFfxEA47vrqaK/7wXJMLEmrJ4xCviZdW1mqsFsDmZddfALZlBeXJ0cA/WmrBbnXXByahZzknCdbLLHiNpm45uChN0eTLQCBaa2AVd8xVSJUiQcqltVdiu8YN6rbcWvpmx6EOx4F89zLC7i97V/fQL+41UXd73/noRZsktDqJFBFSKzcLNWmGTzZJzXV1HffS7/JIbYUNtt27noslDFOvYIhpqYkHCgmkhA39a1YLxaIFUiKNWo3Ask2IlMZDjv3KJUm33PbmFa2tOHa9pJ65qAObsylF5Y8+Z/ZbiUtI5y8CjYim6VH9bIO0CBViZ0vr3GPdhVh5xbo1yea80pz1u8EnUCJQSq3Y2SBnQide7yscKZbBy5P5qvgEjkxBCDhUW2zLNc4fRaUQrQugthIMcArKLp+BLzd1pCSzLE9yW4NW4ELhKXz+KSTxsf+4k8k5OUcgtYw0L7Vr/DLzxOg5sT4E18Hgfg2RFqcLKl7RwNm/ZmWRE9tTJeZkBRUWe9a0kWNLbO/BppluEOssnC/TuIdd+RVZqSSRDY/J1FHUgF0JYa01qUgkJfkPd8/vYokmVzotpmGM0aOqUllgddN4tkSBRNlpw7GZxe+tS5IJJYF4tEQW6EERDXLF0kyXFhALmJGXtOm4isG9lQ8KLTIMcq6JJcpqsqTrfdqqgK40zLgM0Lpg8ovqx+uIYKVQAHhRxNQamLRbCLCNSNXKK3/uoD2LKOXjYaGSUU4MqbS+d7ceLDgMmToSN6WjNmqJnlq0qKiBzgOROApXYR7mfxW+TQAsgVXhKHyEyz5pg77cIBffIoiNyoMN9L7c3pI9+bKF0fAUhzD+qLmSgFBcita6vq1uE+7ZazDwAbSM15UeAR7zNJ7TuNS9QwzK2fMzeCOY2SSp9WAqeS8NodrngN7r29fcRF89iN5efUx7W28HVNdLw4dvYxgLNQHzK8q2ReS0kQ9LsKW+lsM2a5XA5wcUyITff7+fgZYdaDJrN0neV5IeSUQBTYA5tgjpfoFEin5822WdxhfdQaFfuUWAya+mHbWTDBhd6Y65xEuzvwoMt2MKCUPv+9/blhyk+oAsSG6Tub5WpSNbzcJsVz2gVhQlUu2/c1n1oZv8mAbKhR7qDjqd56cv1u7yxbdyiQ0hdJ9XKI6FDtv1b7r038rn0uGNQECfSTNeLZ66Y/JnS/1x3QsIdfCSyb7z9jmMwP0pLtUXQ49pil9wMLeVIEUtOCsipBSMs3aIss1DKUNmi5O/hSrnXRhr6+AxUDahfWewt+0LSgFs7zLDyH7+c/B3WH3YveEWz8ZU1qA6Ec1Zh2dapuV1KC0dPigM1xzXohInTi8xUEWbVBijwZMJmhdKtS17FTabgniChXJxTeLvjqmCd/O3WG883mWY5N1+vdeIjnsav7jRvhnZKRr8U7SdjN5hm8LHyoi2IY9/Jsftd7Ce+NU2VGz3P5uf9rUyPeEZ92E1L5iADao8TC/Z0GSuxVAjqOWiO49V0gPG6HgZMPdW80QSdsVnC04XPTOjjNT7zcQ04SiOH9mBT3JPLTojs50JfoG4dF03OKTWiM8DaETnhNxrhhRrrLHowX7GNnzMVpgtnmge8Wev/DQnjg3z1K4bYkwxNGymEKOy+MFdpxdwn5FPgmRNwtq/iGrpps4Ib0ugJhq6IoovYSIASYCc05cBwsWeI/+h+eiW6rQz1HW6nDmKF2yIQ3G4Ub4bk/EyqC9bL/xIvMmb93n+MSKUnnppbe1Xgtyo9DDs7aDNtgaPN+4zbnEuPh4v6Y2iJNx2oWxBloDg5Q9eHlvHXR6x/OSZ9Dw0eKqJ0q021JaFaN4UyUxrBZp70r2Zwsk5Mc+Ilct/V/dxuCkg7xmZKFE2QOdqY22wWubxLg026VN10tPgVnn4btrU/EJgqxvn3fuPsEjyub0/idzO4ODO0glLEKUJgaz7wnzi0Ge72uUPZK9x9tWLNd6zp+tEBN3niBfOR+yRKJB3SI6u0B9qLFgGH7oDmLoPonCDoZ2lKTq/4tk+WLvrfg7KXPx2MLkbAOLr7VLODULh4mvwvyi7tQqkzHjaWQoEvC9T0lbmZLOZJlAyS3AXWRt5qS6g3LXi4iU1BwApObNY6dh4GuNxv/lOlLn4A4LmKzVuP1V+lUCCDlNNCXAQ0qIRV0nalT3ftA0qzt/FXPAZtAcSIOSn7ETnrdmg1QfebE92S4xwyxHwb+f31v/tqJ8SZB7K7Pm7Jd90yuzXvVlrE+RZWj1seTkAPtTGkV9/rmJGaar4JOSSsj/uUgW/RvbefZDe9gIcqc8Y7kEEJQOY0VCijoSwDBetQilpygfXTfNdPs+YAIQAmkDZE3mheE4UZ06oN2AJWJySrhrwH2gvAQiM6A6MonAu5Cp5CnxmJiDGPmUHQvOTadgsr+a8yEeNw6qbvtJr1ZqKdjYpPFnCyUO0OlqXTy1v3wLeK2W8T9YFOzg7Ht5nD/zBGJ1SmMj/4ZV9CiI9VWi94P7Otgj68DfyY7QaAZQYRzWitFM4ckzECoDan5OOwrIb6VLHF3UB0njjHJdWN3QJXArcQPIfEUrbaBcreI6fW8da9YLdaZVF47uZy6dcrOV+51DpL8ywHo3iqVIioL0ueCm/6VbvX0Dj89fPPRPHZMxyI8SSi5nS3Y0I2YXSPp9G9Wr4p9xGZ5MXimT+oU55fHygufF+ZqpaMV6dfo9OQzlEUCdDcQveq5V1MvDHVqstmO7oHXn7H02dqx7mls1c9ejHY8PbtsZeG/QAep66RuDtXDHGWhiC/+Qt0oUnfVrRIXG5DkKnuN2+Bv/hsn0WbKXIaqy+ACtfMoMysCZrdci/d0rZF1FTtu4j0vWMfSsdZ9XolptXQu4th5OmcDqTzo6BlnBVQvKxojzy4ED63XbuVNSrPmoRWxCutq8MIjaIBAQVo6+gBHC9/eqTC1GW0Jf09a9mtBx/OOsaatw/lNQ0B7fpCHF50H4FpayHrJWnDhDR8CkRRiFlm/j5Jwqmg+ustJ7LlLEgMI6vE9ESUhAT8W2MmrDreHgX8koNMLUi2Du/3Yf/d7kwBbUSk0PBHWMG96VB1DkkJqtPwdpwzTG4gofd9rb2mCnOPXr1qzSr2p1MMcmfXesos1DR7wFhJWtbZoQUKSDKkHerVp2nrpQi+0V4ijNCA4NiCzCxohyiNcX/Tn2hCjXQ/kl2DY853Dyk9d1/Zywh0sZZ/2wCvcb6Dwee5XBrUAFquccm9Y9jBpmQANCUjFFgnwUBuD1jvI06d2vciaTpqPpVsNCnpcGzvxEI5gVaCHhe8OI9VZNBrPPR09lZcAUDArJXL7oESNt34G8W87a3G3gZ8gvwc0AQWeABZJPhqdOl+UoR7FaLJjV+YngF5WLO5xiZ3zwqWkpHX5pJrZb8cM0LbITsZybkQTWvdhMcKNw0K1yRK/xag7JY0oi4anoB5VyS8ZkMVrQd0+flLX3kKUv+9HG0pH2V9KS3iuOv4+9mnEbZhZ6AOcGmFmmuygbLMz3FHnkNB1Q+SLkxlTn7KIUcj9zdWGjC3WtIMfaSK792z42NesAisfxofgI7U4TyZCuxpWUUy8d1ilSlyNmWrQQ06S7TY51v2i9crQS259CaCzI4WArGSboHpGEKqy1pQFlE/DBJ97U3M9gcD/pB4n6MizJXbTszTUfdgoJ4o9ePD56B6ocqmzTRmkK53wM7qGMgOGGvhQYltBTFnMtObjiVy7nTzL4R5coHtvSi2+LZMwctYTBk/mqGpdVpyGS0T5OSqvgu+7duipjKlSGWi/qjZH3JQCUdeqjJBG4z433Wlgn8YHnYVFL6se8rsdBAIstuEcnZ83uwR3zE6zUyc7b6+SYWkGnnfVx/7Fd6vyituasxwTLjlcyk/Az1RNYAcrlQglGSbS2fpZPZvVfkoGs0m/QBHZrp3pIphNaWCfrJpbLXQtJAAibM4bGubIxE/eP3Wf06KulW7Lyloei+to+xkLkpdj+O4SUODFkOkmiprEItqNZGDKdaIQDKVM79FO+0B5jVhIWadnFW0hLZXX+hX1zfrtm0p/Jy2t1kRQytXpKbzR6J/3jD7I0V1o/Rty0kJb9yR2H8bOmOnZbyALPfvlAUMoJ5Iya9oAobYaObCbPaOddFPlmSffNE1PMp6rHY5Nuh6uY2ar4mCS6uBlZ8QjJHnD392U37LU3LQD9jcaj1dw3TpvCt5HxjJDnfqP1bhczfWcZrjtgqH4LTifV9tzo98szSRyMhlZPYQKF2iPWFCS8zWqR1EsteWgBGVPdFEb4WfpmFZQkOGfuremhe3+rmmqMvsVSYQOfRy7YGJRvnQBfa0SbFbAXKXV6ikidOzTIRkhinA5a9iHMmSSGLUgd5x2ofl1rQ7F9Rk4Diyw8xBh3OsiQdb7cjHzI0x1AuXv1p6KKfHQ2iE9G+odkRXvErCDXe28o2EO/qIUcNpRysvvjx82EH5+7IhjncoDgWW6lOzTkQgpEMde1scECIhaERFc7wLRoyIZCS7gzzvJ1d73Rp+J45EIMzxpfL3MzzmdxD+ivk+4B0BI9XrWk78ejfSs/QhpPxrljas3N8seV8ISN/orRmskNgk/dFvyyMn7PHzf6XxIktFSW6uwe/O1cH02Mn35evPva43cFbVEtqZGkpzYDVFJdNV0+iJCYRY21cU4tFUO3qNXuMd7sVezHJhkbqfcBk77EDG6IzmQl13k8hbnnqtDxglCLtpp5XUGkWod9Lo/FstXppDivgZGDrOEcyLippJ5Nkt62pLAZF0jP7GMFjr9zlPZdQI0PCgQhwgCtUyrfU3mJXzs25eW1AzcUVbK30Fj+NN2/HhT0QBN4i6fEAGki2BSdk6ylDrmqggHJUVKXTyPxHOzhhvHHhOiXJwCUP/k3QnGkxPrhbn5TfHnCJLnqHUwfYUh8alxLxh3pYTMMxDdN1zkIhwIZF69/45/3cd5GHbxPgId1Bar+7fs4HY/i2ScZFJNiyKea3HCd0ALoVCWhOueDB4XB1UTMLQQLiKW8ubutB/Ys7zz9r4DgezTwOdmUha309wsbH2tmqmqdUxZOhrNZ2z7+4k8tmSwvf0ecOLHzgtX8M0iA5uKwy10GoZa/YlAtXsqr9dhRVqHUSgcUfF9kS9xky+TpxieXEF6at0UkgR6XLn6HcB28PxhtMAreoeQXRZ/zUi0BcTC0iCgxZzHsjFRvJbkq/Ybc1wZ3fQADyP87J7uAcmLLbprujDYAbehVunBnLgxjE+9hbeFaEwKc3lblLRilIVa5Db6ezwPRGJGISPuROmO6p/rWtd+uROQ9pucqZIWJ3OGf5RHBjw3O0VuShUTgbbhBO1vxK9RkvhxEURkM68Lq0Gb4N4knO7XBVArDn5UyUeo36kmLlBj2JrxlzgW6FjNRrYtS5RlW96H2Y79zvfshiOFK99Wo/L4VcgJR3fy1EjVeMVe4jA7p3qeoqpfjEESOYvD/TiRJxLYDrBSx5w+d+qnnqzGiOevvKy72m3niW62Vyq70rYhznG7c9IujMF1UmVWAakqTp8IPX3eV0Z6rQPkFgvEfYYWJ0VUdSOWubfZHVMqFvk0P/uq2HcvzqTyXNo1nDJngptYLAMPYlCzTvbfSPiNSzJZ7moIYwdxvSEUAq3WBbSL3th32IbfjkjOYsHd0SuqahQwIDd8c1SadlWEvRyVV/ftIkx8onB7LpK60DGER2wSK9F7ZhdA5/QAk6FGvkS+zA9MtjzD9cOk6NTRyyoWjM5MYE51HV2UQi84GWTdzivfAG7+Geq2b2ueJwpNbmcyhrOF64rYvSWv6GPgYJHeEVwUt2HHEp7ILtyWMPWMNaFK0Q/P4S0FAv0xCyy2enMpOjZdLGRf0fI88ELHvDnmiXYDdudAzYxgwqbxff1NKzp1x6hYK+IidXIN2My9goEGjNFxpvam3cuG76EGPaMCHHqURN4vNI+jHHtsNmzcuJoPip5POVbtM8OsvS/xZPFiqtbYsi4BOSh9ChDYzCtkvL55pyp5WituqCRIE+92idk+Gc3dXO38KaqoioruAsc2GmsiSAKikWfysBAIThkpaiUUewZGXgIZ8Xkp5H16Zzi5Vu+0nImk4Zy1nDDf1aYtNKEPlI5kDUcFZc7tXAes/FYzqCMFi4keieeuyPQCPvZGe6gUp9XLmNse17E897Lys5aaR6o21m2MKkBSz3EiW24Y3ZLci9nRsJ1HTHgXrKb0OxfTheuC8XcRRkf+OY2/uB63b/bp6qZ3/7toQ77+EODbQSB0khj8KyVUh/VoS07erGdmTRIwemZMgdPw2VP997fB6eSWKL8zSEzixfPai5/Nz/dEJtjbIGVrGIYDMrbyX+Acouwh3fMiMJVhf989ip0Rk9ojVZz9/OFDI3HDhU/fpDdFt27SOhW+jKt4zRPgaiXNGGjsXKZ48Vq6+oDnpngYUaFLIbW2LYFb1Eoh2CNML2sGcF81tyR2T+ojHps9jSixVtIAQKx0oLQNWDIaII9uKkykmAq62YUILj5E7oxJmCi05O1N/Y7gMniyW16yZvfg3GBZkFaFivtFExWEXCqQtTzQ5OGkJbJKl3eiH3QdYQpqJNA0P03OsWai4rqL6ushHZ1s7iCJREZvCJ8dSdMFYfI+zvVc4z2dPQh4RXXB56klImb+L2Hj4by7ThkIWdX8omRXJzO82UuTkiKrKGZZWqV4uO5nEU6zWmIEk4WZDi4rXZ+VqCa6JEAItZfyudxAXelmgGRRQlCVgmOr3BYFROEgWFKIOd/y2ivqFnMUCzfBFoZuLEzB2Rupa8taK31Q9TFyckGWBc3L2s3cji92ftEe2Ul+8REXBB2mRDecH1/WLTHWI68s2GpF+7m4IEMxu38yo2xjF8TuYJUqGs+TFpV0ftJobtx00ngg25benqKx4LbcEVggjixHEdjqCOMG0rdGYN/D3e1aXQCgKqDd/M5IxDTWEuc2Jc+kpowQeMhivZa/PRIJf2cJqpjgkMDNMpszcD2NSrqe2fZQNZJuJ/cONM7qk4jlqbBAxb0OsfQay+XOBD1kO41UqnZShKyl/aj+pxXzqpId4K8zz8nrojeen4/D3hpa1bAGYN1/9XG6Ugpfp+rkqIEQsLPsrfAwoEsefF4A4lw89lF58SKoHbRXMgt/My5SPlHskiCcHeFtgYK3grg+lPGpWxAcW65gieEZ+1nTxumy1HVzbNLLGhJBBDq/lxYF3rGJyh9p+p7Ygxrr7zQkykpTNFw3NWaOWJTS36eVHd0xoRdDW0/++uJDvpD9i4hRLlS1hM1ynvHnqjGur09DW1VS1ZtFT3MN6kLo9Lc839BoxDSOY+XZ1OuLP18hW5AELMyqZOUCTVLblfKeNNcRC/L0TJSXt9ThIR7jVBvk69WU+bWAguBNeC57gH3AtUZQtbEYlM4AXRK3TbnG39gnd/N4B69PWRDOSolj9uMHtffpuk/h613WdaLr8U/KITs4319/Bq14Tmfyky2E6udyrY11ZT0pAMYVLXZ2xUSr4l9kKw6/3SJTSfMC1/KdGJQBmWSODfjzJtiWT6uCiBFvN1f3p6Hsl7hFWCEmwU4IFnvMWEmYc3u1h3AJiP7VMcHLCWnmOgEPCfCkXrTLCE5FCvxwkbHNYnEKh0yLxzXUoE6tKnEQiF2HtardomL/YMGZoU5dW1P6hqXYjmyRk1XJxtr6XPML4IxT6LLEE+rnCTzR4kLiXPcxJckTwe/rL/VZpqLf4+Y+b6D3wudL1YWsem/Gd37Owtsntz493/NOrVHN1dum9wdUtUS/qW7JFr/m7pfNLoWQ2fMP9VqgpIs04blWe7FukOrQs762AUFz/teyuckQxn23plXxqHodE3n5Pvtjv3zrlARzIViVMesUIZqU8ekTT2lKTnq85zToYhghgczR9EZHtXoCmHF4wHeSXgl/Ggxody5JV7b5ru5+8W8ZUdLJ6ZSsApcVbQyRCNO9fTYvvtlZK9TOmtSaxbdbHMxm9aYdS94PF+ddgPM2Uj8hrb2rEZ4HTTut804zfufNbqYlYPh15ll2HQRz28ARePV7b5ymT8YdUcrubptSm7HNnQxdlpqcpI2yiuGZXIFxoMiUHhjfJTiwKoGcVbc0CXMbdK5S9F3JcgcwEdNaUi2ADoo/CfyDYZskKhuAE0ldG94TB9CtP8GMbWvlPXVCmLjuk4RIBJuwYY1OAQZocyDtkm49GxjtedxCb76SK1cIIR0r1fp98IQhRA3du0SiO9glTIxCNt4o7i9QoROi51//fsoV8F8AsGVhpwQsDybVJ1OtdyR5biBKVVopxxmIGd6oSBmVipJjUkNc6SZ3kQG13p9kRDaah1bGQa4RLybdycRy8SyaQC+NoyrBdc/vAB1y23RSiBZKNc4OUXKEJvZY4icARXJXdTBMUqldtwoO1tDmeNw10I7BZuFQ722Z38PeFV7ke2fUtfKps2YH03eogNnYWdPovNd5fsLgn4JW/wdo6V8Tkt1Cz/d9Te84OqKn0iFxGSD5JnC8wsa/a/1M59Ndy/inm+ZJoLk7boOkoitBmXDBxWYBmAJfHJTNdtbUz3E+IXq/o8LACHdfPDWOpr8LZAgipV/G4qM9fDavCUSQz72lIezm8OEuYzzc61+ZJYtmxsnzO0bk9q1j3N9bEX00vV7k4gUJh0xKRY6ZEUYaeJtJ5UGg44GsSan3/nfJbnlyeOSXZ0bN/e/4dwtZLnroK2YMC/L/cUXT88480NXo4V4L3m2XwsLRTksWw6LYCq8MGRROPmdDS7/LSmjl5dCGB/Udqwt6AxX2SJS4aHQbLC+2gwaT/6U+fVLO8hfHedOGaBvERr1X/mJz2Tnh4bBE4gco5641DIcI7Hmgou/0JLCHnWvMKL2QDlI+MX6zXZnxoAQ0oigH8wNaVqEkDZelxq52KKyRKJ6SalsNfumWvhwABIZpgPE8RPfiQrGIGCmzKLBpWt0FrErwVYEw6+6wsQgSohdWr5Vq2Pk8UdnbDxcQ5+u0xoXOck07NRIA6TjYhMtXhXTX78UxrpwBjCULm2B3AV1LWmYcX2QSjjW7s6udeBfObiJn37zY06JyWtqaFsWryco62NlfoDhvCGQ75OjFMWTywt2yyEhQCcSE9oFfhBILAqRCVmLnhYOCHApaEAx1ZLw0ITAdwqmQHfR682r8Uy2cOrPL+A6BzG5KP2N2wI2lAAAgAElEQVTRrGeyqshdxnEIs/Q2e3p8f0d1fXj5PvuTLC+NROqJ9Z6nXifXw9ClEDu3Fi/EI3+OSlugz/tKRj2Wrfw+liXunseE+bmNlUCnDtZiLPnj+z3JwqPiiKf5i8p9Dz/QIxfqTna/vV73tayOrc+unnQQIakkbhddd9EJvWBK9S++4D7UxYvSI9eV7hf2qhsGeMEaPNjh1bnq+cqV74FLBnJI0fDkupccNrjDkFheN2Zmsh7Hi2q8XzUm8LqwcKeNWtBseRvGls/80nrpVV8Lh7nKaGObal5s4ltQLWm/f48/18GtBkhmiiimzIK0QVCsrIBWtmhgFHjUYhHP10UKwOGY9XzOrEE6R7dQB8siRDMg5JUJWsTbS7ubNsbxZnPOISPCKyQoayCDVtBz2gb53MGSu908vUIeQnk2Ocrm5l66v7L07c3NAy7SOMxBDopChtP4LjMlFG2LK2tsBFKbP0FThfwhHLSr30gls1UiG5puL+N3WjFld9Fp5cUhBQRdaYuT4Vj1CsdGTSrJzwY9h0AnTqm36kqJ1AEvquFClfN9hHvajvx3AktZWQDboOLWwr4jduiG66RTjS5Kp6gamw2ONlKIfNqphcbVzt3GUEH+JTmZLcc09mowIaqj77NpGb03ArvMyb78/l00SzLrY5Gqb87Xx3gHwuLLHiFoFtE4+n3f+GS6AyjZyp83a7B0jSIHKN1C5MdQjI80coDQn/zrvy461ZkhnFhv5dxA8JVFDVAQWgynnnaAtOWfMUjOQpsFmPUD/ElHYiouFrc41igGhs4rAttvZzuv7Kmi3vjqvQIiAmXlh6QYEtE7r0TLCVXiXvsUAjgv4BYUKLSMbed7AiUwreXoDV3T35NhIfeS+pKpuscuz0/o0oZyIipJoVdrPm/QOfL14Kz+YujiD+Wn6fmdl0P2n31zDIVcirZjByXETSVVOTB6VxZ5ugB2AiBK7WqnQa6c407qM6J+5rkr1McFYaoNmZig3NbCW1oOcrCFlRXRCA2wu5NivWRNkJfGbkmEirifv7lYgj181w/qXt1Z3ZQZktN55hci5iMYasMtISz7sRd4RRbGsWfttvU/FJevPaSOLmOZyxc8sTt5MaVf7zhrXZWkrvB9h2gR3CwgyyJG1ilTagvM5Yrd87+sMbYQ49WSRbrnJ67PVM2anZCwL2ON9Q/THhy7DpS4eV5UDzFUieiUAnj1ALmoHtE/8rjy+TZj2srsuVUF2cMynJnJ5sATpPp0Az+Vfe4Ie9gsHWr6drLU4Xd9ovyxWSdaZTzt5Hq9YexbWoSIjNyE6TvFKKg3O8LBZ/ZR3tnvcIyuTJud6scVUPDQHsgtZTwGaBf2UwaqjrzxKqLu/Rz5724Ha+ue/Yv3G/9uEzLbmx7tGOtjoN2Z+UCjc0qb4qQEuFukLjtvP8LJrzGXDFXtndS8WUk76lWzV4bqFpmfI9L3WALjDjQ9SFSyKaarTC11eECWHwuRS4ypDx4YvvsOcnyAqBMd4xDUzt+uvGsoelgHAZDFgjWrrd6fv92DFcC0SltLARZBsTQqxWqmXocgdIkx2qa1E+QglyhV2aSuPSx9zRm/k14CDf9nuNTLdR9Y6cv4/f1SzE3Mq+BlAxulkUsrbJWqNo70twe6zO4AFBku3p/4HPezIkMRzr+P/tSPxWteKZbIRvS0VpGhm18/Dgg5nT3nAP37/vlCUalbx3fh3Ey/BxWgJVZcfbgfb+84LuU6aJzvewVVWp6317L0p3WFDAaYYbIPfImePFKiXsWIvqsLbSyRdAQ3bUgU2/ZE0sW/u6WRebGBWLy32ueWeTLRnrYcI25iTRsmo7ej5rs3mxxBiK0eFG2W5T4s+94/43T1S0arVMlL2ksnTgwAApfKxkR3MqdpOlumsiC837C6chbX8luwg8escmjyMZkGviPnKgnk/pmoTZL1KABd4mKJ9LI+DIFJKVuBxX9OkR59PdgGSbkMmBJzVmJ2hXBbLAHwvurLkjSj7RV5vzeuyo6tpbm44gE1HHX6e/p3KKMB1mxeOczxqxbHUmtF8IhGgL3KRmwQ4SuyBg7EjLMenoacyRr3yeLxeZUH1Geb8/M5VWSLZtN2NO1uUXS/OT8257dmTEsQcpKxoprLQiyHPJ7Bx6LZLn5xjrM5UgFpQaQ5WlSTRCqMSHROxadgaPTro3BopCf9f6hKcCX4sXcohk9X+Fve25/XWPI3VrKbQjLhSOlQY2Fls6QxTy7oxa8lFp8EQTUaQqnNNT6PwgwYWssQipLpHtNRM/KmTXO/SBuIhuhC10BRB/MVxWX3SjwjDCVC5ZympYHV7yDGhJZ9GtlYyOWnVN/BN+jbThp6ysJZp4B9BYQEYOZibBLeEgV6gyowy92bcpUiglXVIojI63sLn5AAXGGCsh55WJgai8GIDJlo9orqz8yEzfe2YGgHO77lxaXGGV3XjcAXxcJsbXEhv9huXVDqco9zumMXHtQ+qvqZze5lyj/PhBee0WLEjOS8SK4FRJVN+CW9TG+LTexp1dnPyqJgZGPs7dMxy+6ELqLVzHvu+60h4fk686pnX1JLXIJqwzXzz6p2qv6i0kEYtgWs3eew6QFHsylCKEVCZEsQ6yParNfLOKAEPheH1qaFg6K/uhX7a3S0MgTDK16jPVyjyh+eTR055lRjHiVei1QEwfIqfnZ6Bo+pFOrCKEACKZurFEADMFlcQP16AFMwt4g2DySlFiNU7Xcv7Suam7UrbcF0maSIbVEbqrdRaT4A01pVE34dOmaxB7xfjNHj3kRt0WH8nwnlQI2GS/stROL4eV4KbF//XQXXt0sQjmvYOiaFTvuHOHaGmzDUOFGizCvHzRjkk92ahTvwKDKcH17UpkbbRzcHz0pvGkwLrDPAD55np9AnFvGiLXP//SrB1vrsJTYJDIFANRPR2gx9FvB00j6wPHRiMBOKGkjxRHnsVKOAFqHoNRzbi1OJyDRnQNkrtNd1UvOfMqzd9xHhE+tFixDLXrYhV+XPFsdxxpqTiYtrlNhMahucCkiVGkuyXycmeNm1M97LBlRJNCoEMrzj92qXqGQJTtS49CBLLkjtUKnXcWOKN5Y7qhmhc/ct89Vy80N9hk8u6+7YmC2t3nzTZG2hfYaGCwQ08H3e23MlBylZT/hS/PusnvixvfTgbCShhW7M9qIrl4jUp8zWTMtQ7skV8892vKHOJD9GYzodAZhupVNCHKyzMNXOvL+eBtfI93Ky0DdaCO4yyJROdauUM6jtYURwpNiK3HtP5DYhQdm4CBc8oyvQSSKaKvx2z+hGlEsbb90xXGq1Rz5D5G4Ej+SyYEUOx/B+U2FYCVNaOR9fb+SIDMcp0BtK3T4FL7ugI6bnCHwb0PmD2EX8vZsgIngzsU7EUFoBri46mQgAqJNyZMGLnY31u03u5OfBHkvacVFnx6q/xAtlA7p+T+51H/WLEPtPPElZG5TkAH1GidJtesIP9pxp15ySMPRM2q588gkvZWACZTcpGFxPJmccKi0olgl5TJqTg8ULgtdOnrZm7rksx6bwsh5Ei0v6vQnSWSSKhbELrTFr4eVJHUhn3YQa3nEvdGPU+pRaRKB21O5NEguBermlGbunHRnDJoxtbU+w0aJa8uOv/Uv3MyyvAwr3RVS9NsEuPBeZ1CRS5bnvHFiE3AflCXpBQro6C3Q0jq0ZTHZorCpBg4QVu0kzJyzgKle1IWvNoPOvs3s635WA2vsWHanwJN69qjl880KnBVYViiyUG1Nb4K0y9wi2FGgZtx1egLkRJh4XM1LvonCSsmVZuASWEpckcl2/ZDJ0SRm5+DzvXDzmOg49t69KH6Kg1GLEOzL73EnNz2N6XezGg3BVuvy8GyOJZ8XPmBUCX5F8yvcIqZ8OZJF6vg+zqk3GXKrW8d0ZIInibq7jMWdI+KrfwfNgRUNykt9PgF/tMPW9N986/0dF0IJsJrPOhl0tilN5ocHAUuVggz57DYu8ZzIgjsxAYGho1ZrZKwh/ejHVkOYJ/GsajeHzpP3WG8KfI2XbmagZa0WhbSlE7K7QB6EX6k4l8rgKXdSswaZCls2ZItEjl1SqWnK5Vn15z5jFZMQb/Xvn+huotibap2KMsawkkkQdjIynVoIEpaZGCAKWJIunuwk7lpU2P89JH0otOz7ja616aXO6flOE+BDupXaq93IQOIZaUxZl1rJspJa7algEUOwZNxmHtotVkr5POEZx5TN+8fgu0GR+FfN4LrY47QlgW1iexMpOtohI1fEwri5A/N0apjwfE+PxNWO/Ng1p5v6Jrksen6wzDyHeBZrbvCKv0ooiNOblTpUMqFyLxlQPQ0tvgv9LzZIcE3fmQ2ZSSqFH9j6NDOiVHijLqX4jWdXCgBIpKhEhd9EjD90H6U6SovRznJzcEBgn3/puhYHVvTj7P1u8FpdRaY3ynaRgiYhH0fqa5F6uf43r/bJdGeiAkqWlRo77eULVl6iljXIdH6C/FO2jQ2crgyPt/TcpU22GILIgotAQS67WF3iFiJFRz8Ksv/+SGwR3x0BUiGNkHQGu3CaOrIoIVSdUiC461ETQMy6vhGEuq0x1bN8sII365KhNxG1kU0mp+6yLurhpfykpjtdp9oh2thiktui8qh2jXoMM3jmw/UvpcmebbkOiNKIt9l6/5US/wpok7lS17wzYnsdq6uNnGrFEBV+WQU40X7b3xjrvTv27pKHPL4sL6NUjfPFJm04rxCL6EzHAuGgIFEBXWVKypC4iPojPMhLNUaaWj9XBi5J/veT1qQiXo+scmfZjpnSytS42RETcZQCKwZ5GS9A6G9tb0yxh9aJrRndKoal+df/mavoEYtCgRXdQ6npuO357dHiE+AQ2izEYNG6brLyVMuoW5ln5sON3mA1lG6stTdPCv6tATh0ptlnw/rLYn0isThvPm0X7LQHTD+q/zUZwJD5E11bMk4Z3OPJtWgvfrk5OPiyJu3Ppc0vKETY/g9E3iq6ZMCf0Jco5T1wYu/cIVIW/xONxMjGq+9CvpGLu17MWK9OilKzFFAm1cmDBo8CfpfOyRvkJMZlOMMM3sYZ9SYC7l8TEhNlJOp1ES745zl9MimyzYJz+7eSzUyndzdq2vin6nQiXnTLgNZwLw/d3UbENi5QITttI+zLVBnT2DIYOA6nqa4eb0PBZmC4nRBipLLQRMpoUJU+cBXVg5u1Cjc35dmQzV+nwYeZ1u5/Btd8H/vie6tLiclnzIWhtOwFu5/ODjaGdk8FJriYI831fZjOPgTygTuBd8J7TfP7kXWgQAYl0qGsRNtcKcVmoF9mee0VXSsmwsdlGYd6HJsOdNfLb/aMis9lXxK2KDyWktMBLsgS4ERXCNnjsPpsS3M8hVNK93KefPR3kUwjq5H9u59Kettmo7QDOmTKc7m9qs4Cdt1hdTQaCIZM+3iT2mynsIIBrtCqmY3sD75YAt0tkQ+82roN56FV9VY0bmmdbuAGwvVUFzmJKRieUFHx7vt1zZXnbSOjKddlFPPNm85LJwc9G9btqu0d71Gg7Xubhz301/ttpDe3U4xDOaZ7lXx8rWPQyq4gcu1XVe37nwtmtDrz7zqWufJ4DgU3CkH0D1ngdcozcNgnGNXz4ZA1kRn56hwUPcFzvqLqL6G5HQ42aROf46nc8h0Dvwnn8EDHwZoEAP17od22HxjhBRq3fwGbTgFUIBR96OcMAeYm42Qbx95nkiQy0faV8LBogr76MS9J5DUQ0Os5PXkFcFr/H/tCKAfy7DzTBF8RCgeZ6pwUBzYITr7UbP2te9KkVEGHs48Ja7j2Mq4u/m/g+aKFE/AwvttneO/vCgUUNF3k3vaAxwpckbnVIegTRWfgmRQuHX24nem4zP5dF8uucg4nk7BGVQ/FkRF9GIUGvQG5Oi8O6r/VZEcm2eq++Dvo9z3co+yb2PqvlDBfNJqeyYT7OkUNpXC/UexRfWbWpxXXu/nlIxiSfASrrGsoyAKZ23mtXhqGuk8u2bdIbSYmzwAXDOLA8a3YS3JuCWfd5NpcEekRNdN1gCDySieUfEWnoKSk+48doGU4eHOYgRSolfSKMRxM4bhaybSq+XAC28N8UdasXTEXQmYgqu9o0q58+2+7wdXPr661UZ1e+0uH8bdZLGzqgORRx471sNuDpFtRrs3COz4l3aDWevLCD9bZp8eVAkBcpekqefa1dbgjQAkWXcBp+nG07F2JeKIAancffAe1CtJnaR2QltWA1z7vNsPwBUXU/Jmt6u6l2LN3XXTYvn+10d1ojXVnLm4x16xA5ZFC+gerfbIZvUdBTRPQNQrcrLQ7oJ4bvuOKSGdnVipJaYnbHEkVshWMfCKepCJPCSqpkMpbyrCbUxZtDLuMkmRBfAbGuFmuceA5KX4IcR6tXwt047L9RxtWooxlLXA3JDtheRDSnL+ouKz2F4icRIGwW0R1paqqf7jZXBe+/XThOhIbePptTwtKupOGHx+tqab7Z1HYLbfd8uMfrpHwyjBO7BI8UiaZtcFqIjvB9sdgySli9Our9Mkl4ED5C+Sxf25WqI/M7hkrOignYM8aoKORanF3fN9WcOR5x9RmFlirCXEd+RGkNnDcYsSFwHFTaT6m+7k3ywO3MLspScQOSHdbEw+nmNduzJOMnGvtLba7g2JgeYavCmJ9fefTKSMiadaDpxY9/L7wGNtJB/26q9kqYyRZ1TM6XVGLBJQjFumPHy1hBIoePz4gG2cwWCVDCxiZ9pYUmT90EBqJWkldVLxbLr0Krx6kallw4LFtZ+sGmGt3RXMnAdhPR6sIm0VIQW1VMHBeLVuyn92nT7+rv13Dcq7q97bIY7sfuou6WLXwy54ZNI84xOLnpiZKXUaZRFiUjxznT7YXl5VdDhSFIntQI6bgSDbrCYsgObLbJKq35bLM5Au3C5IIwmh0vVmulMvyhe07YrCOtzlxxugEic8qwEL9byGJszJOlc9e1Y9iETZRqyKug8GNBIDNLt1OFuOlg8bCoF00a3sAkOqrbLPNrKzaw0JHl1snbWn3HyCTIVVIggubUSmvKIKtLCPWc18ZFVuT6vbxP1hgWxWvh452jNNUmClbNqfT4sLl8F9SiTdbNzPBJfXYY6xKHcqht37GK+JrFSUEhbafTjpjmeSFVIhRW3cDqi9QwYblGhy6F7KJGH6O91kYUpz7udB3t4sjH72p0PtQTXUfjmLJerlkOzFzYMJagzZLnmwgqO6Rp3Hynfu6DDfUYHj7YwFtY/bTL4wQe7pn6nb0TwkKK1Fp1grqVZVVE7UvvAAJRwojgTU2fnZfJKSFsuqt+C4L0QFE+evf4dnaraJ7/xHavToH1f5cVU6A/oJroki1xjKQZJ9topzZZk5utbE0v417fJYj3Aw1Ciq2+gvZaAc1VtGh7ndfKc9HPOuw+wstWAcAdfPtgWmbNFIkLu8tFQy9SSrbUs7xo8whFtsRCqdZ3k3szWfseAZSfu9KHD05uajF2q6rIEJ/34pp2QpZCYwEaF4RqcqHuwcvn++fo4tg8b5T5qQbTvfjLebE4QhlJvTT0L7t6mXMVPIvoolEHyGOVn+Mj5piOsNvAlbBKfNfqfKwz42oWKZ31eruYq+WPxUzR5iX7DZcNik/0A7bBEUX5HdaPYSm4VO1DrQMCW8ZAzPxTC/NJL57CxA9bsVTW5Q0sy+3Q8vBiofIMdQZydD6Q4nxE74kv7yeDSMFjwNFJ3BvJ0gedMOU78ba1Ob7kWPa7cHr5lUw+GY2uYSubBTyU4PIQx89+xm50GHtGK5jqQhWBkRu0zwb1xKgTuvcohRhPqkeQ0EScoPBaJXRlvBlu+WGeEnUkaw8iF28Jp4dTQVSkyOl7QqgUvDn5IqZdlhkiagGokxC10Z8YuwkzZHYYPVdm1sionc4ZAc20jXgFPnkausGuZ8yXL2bafsLv8pijhj23V4APqUkch3AshDmKFrije024bOxQga4xoEaFvenLI6DvqSE5xSrfn31JKVYSa1n8kq6nWBixFtfks/HI6XtUAb4XJI9mZnAgXLdbo60Qzouw4CcvjxBVPdLf+bq5prWX/OgL1xL4A09HejWi/LQLr5xssZFLX+icqJHr9t5EcVivG7jITOU1S1yD9R2Pm+yAaLooG0o4QUCcDg0iPUssalaWxPCY04Fmky1Ok/HdEVLuk+j+RHANMubc+oQOXfLhvWefaZbpV/cVSIDZtCNl0fEljovHatIyoxtZi46vxcWeGcTGOmsvRzLfcWmwvVgNKd0DkiY+kfMTxTMTt0NqquQ/LbxIv8UlxTpATYninoZ6nEy4XoWuXMiDTIETyzOsOqk4GI2xqPzh9PYs7fdlRM7nqC4dSDyCqJHvlDGB3FUNYn+8hMBONC5P+hqWfAu4LlPR4r7QDTGerl6ebgMQCF5cbEs85EyqQoGQzHihQQbaQBkABPksm+/QQoC00JfPKE8MXpj4+xy/XUjxbjmebc6RZ7cRelR9OOL6o+IwFaPx9XFQ3pXlfEAsbCaXJR6CqsvfHCvBu1KJ/Rj/XSSJzNr0m1ekE/9ROvijBfLAFThqk6TPQpX9mtKtNaXOAmToUkfmMm1Ezrp7PirPnpb+3nSUHDyPHwkQdjUko7RgmAqzGjjEkUQHWwle+j4dyzHxA55DOAfwe6SsIWChGcii3a7QM9d19lEEB9VgAtNxrCGZQeiTNxrzXU27fQ4N1wMnLqUdT6Cbu5ve2t2ipYGkIQq3qpIGfuF9GAtvrkkk7iASGsTm3Ulrv+F8YAdJ4sWCYxvC7El73wTDn2il5/cB7SKr4XomnS2Y4So13lAuAlJZykt5idFIb6F/HFT6USr8lXSmSyneFLRcFDU9OcbHdcipFOZNSdTbc8Mgc5V1f0jFPq97RjN6SFfEBVtvyo5qHFx6migiHQKR1Nuxj/9mtoCrDp34KSxfl8edmv4bFQXdrV3HlnBLxE7zUr28aJx9fD6HC4OZNiSZ+k9J2a2HQ0z1i0LFHLTQuwf7NrgwG0pNq8Ya+k6tMFVPs5PZ1fyCp2iCVdfNv/9qQ6vo8HvuaMJko/mRBJlxS8zUycPa0lo71Ju/IRybkLyig+2bczppnu7ERLwcm55xOLZuBczjdzX3qYUo6vmmsa/nq5rec41QjX0HRahNE6RVvtdFH9plsVOiyzBrNs1SkrzKBCyOcSejLFWa0jOp81HzFCC7iwIT5C4kWn6Plgu1FT4fQPB8wd1/Mn1PyeV2G679ANUz40EwnPMxUsxwIfoeHI0RasMGw+W5G+t+HIiW52HbvL4w5mpaiImcw+sGzPhNLQtGWNrdvAF35oAw1tKb8mNiBsXS2PqlT2yWQrr8fcfpudlttMzniGiXm2dAlWSDi1Lbqh03viSgp2FQTSjPcUNV7nNAWJg2d282wl2Gx99hy0Uc8Chg3DckjIoGcxS4kurs5TuXc2De5HjT8hIIZFOivgVSGxixEdLcx1/tPHPkWT/bsFmFk5zy+AbQBjTqUWolp3PVrfualZJc9glX2tfdhtlvcmzjqq8zPlv5Uopr6lsfAWw278t6GVHU0vMxrIgXv8diqkAFizQXfadrbtYJhXnpTFNzvXtP9HO9aQexa8cTetZZupqWii4SxdEeW6/01qqmShIzNiJwevFCh7qW+jOXj6yS+JRFOzJg4DZZojfBrDF/Y3MMNNd8kpzGe4io9RtJ9G78SmnMJcVp3wCE+r44zkoBUsjLKlnCLNgB15ctLyCVyoUT2DbpiqvfYY8emAVd8gGepsXAnTcsZz4ObRG6t9+LS9OzGXqf5Ux9qZ03QCfa0mVTZmftWthuqmd2ohRdo2P52mBicSoudGqepF/QvSZ6J0y0W7R2tcCdecib1s3p2b0xOLINgtAHNDtZUaCfMyUwbuWNbYsAoVsLD4PGPpCEzFrfmID1NtnUXivHv3+H5rE3m7tUdp936ztMTuaFNcFnF9T45p3t+Bsn/3trg3xaGsMetR7nLY/HiS+N12R4FK1T4xrkoLdIYlIC7G12+SaBXc+xtgFOfactC7P7PptTXOMD0plnrqdju9gHOM4VpIGhlYlTS2+IAFPkmkIysfIxcQnTCq5Ybb703vkYy0eAtC7DsS4jZSIiTcjTe1g4xASC0CJNKj3CcF2qkzRvaCFzsHm7cCVywTCCb3cuyQIsu6FrxqCBZOOQlaCixmfpmPFaWyv3HGXbSKpOkjzC2GOACblPqYNOYM2qyZE9dddojLw+rwdy7xb0H2xcmpNCT6aQ+3seyd0V8bRW3ZnlD/pNzOxQ+UL01HD3yWXx9tJgjxQE+nFAMNxS+ZBLWDsTo2U2Uswygv1tLYflc7o4bk724ue+A8N1cBOJGywb1HBZMZ7rkptuRm9jsnD/Df8fc/+S7cquK4FiCL7ZIBddctl1t8BtdQ/coA0XpEwCgQBIrfPs4XPHuHsuSZnJ5Ad/RIh7dQYPkgTlKHHM9UddR6xGxRDllGOeC01rT4Ql+3clJUd0xWZ/BMBcIOisP5yygo1+XxS8qG5LpaWXLmK5RlmdVCLKsQ1XzyMB7iB55SzzqOMbKf/nm8T+y78cTn0OM9ec+7vhoTYKHX6QNU40WZmCJoSlERlxjIr+I1OOEeFDZKEJwgY5FwvixkZgqHkPCYKQKdWJTOm1c6pJECEc5u/4vm0RX8HzPfzFgNpr8YaVkXPoSOQyIb+NKJhSOtgpP/zdj3yonTA9QyHP8+4gVh8iZAAL+mduDzSBANU/vPPnHhNo+1gEtjliZtqlvpHsizx49ML34RJG+HcNWu89+OwTaqlAlGFfzbmy0PQvDvrznp80+Er5XReFy7w7yNWw3LP7CWVT2WLs6UXmOBqjMYrtKp1pkR7z6ADt/07Fmc+bL0p9ybSqdWRkdayglFafBnycPI70ZmIOyAhjzqd7G6EAunFyqq+mmzpHUc2roABuvlPXQjjZPO/ByNAAACAASURBVB5rImTZqMlyRc3FpwZAgUVIouktkHb9yv7ewfnHWpH4BZP00FnoKlH4rUXxPFHuGc/3UTqcX9+WW1R8UBzoyMrGgzICvR+C4qmhK7La8DDRPkJ+rdcSY+Ilkbr7ipKFYt1lTBcfw/i8YepmrBso5sTr910u38W1cYMucT80B7OvJ7j9XNUwVBrZqQ6hrwVReeoqkPR6skCZ39eFgLQm0jUJjj58qeYP0DlpFbETXfTWobNpAb8olYBm/hRD09yCkufDimBUik2jG1r4XCHLWYJtsg1mYJ2zgDI/d8BFblM4mVt5TgiQiR7W7J9bzm5BmPqI8pyKvOU1Uff1Q3rLhhRuB9Sm7nUqep3rdTShlUyxXM7PdevhXxPO7wQSgrCH1cKbTknkQ18PYoPNVywbNGObBQhwu6lY4EJagoAmEYmfZ6XorfLIyrbLHcsoNbI1UDaLt/lpt8sDeSMMlGKd+mP/Jfc25Fiv89jWpIxunmd2Bvk41Srcstapwlq/+G5as/+F3tX+oZag21O/CvgbZTGtwbrcz6pA2Yb97Oc5vOJkgCY96jomKuIdzZb/VL/wVZJoOVQyAEcQSp46BXQdwmoMHFyc54RV4ubd+BPuhVutnXedaTRxb/x4Pm4NodiloOYyjpHf3V3Xu7gY+6nGQ/Im/P0g7HFQGvjhkN8cwtM9ZyzuuWBmKoKxQchM1dtrEIy/WNSdMJgtafRSh3yTJ6QA/005WNPOaXYu8pks744KtlNyNzTI8fsTeMdNceGve/hUiHmrjE6kQdPZmeYew7rdlpFMRo7ZmcnzV8OuW6/buf4Xw+i2UPMki4Z3BewOTEbInRAeRCz8IqfBb/aZ7FBxvCRhVpSrvTVCpWYCCQWydxQSmuOgQNuxRxRKSLBTTHwBCZjuYg/G+hGH4cZ43dFjg/LoTXQgqJBsB9LV6QRc6LjSBvgLh7QNitHsXPVolwL39CLdInTW/62VbP8geH8NXf0iMH4RxFp4IxdPYlYGYs6x0WhrwZqcG8EGhP4w7wQrQcw2xZUJ3cQDAIOR8LiiB2ahJe4zCSJr4Ddd/Da1dYV/K+NoRQFLz3EhDFUoUf3WBgFm4bmtoo3zHz2Z8Jmo6po90+jVcAW1SzbI1MbF+yLtiYwrP2LBj2OjPRUT/lEhxneP2POwXIRYFN3jXQfPEeQtfmGNl0TSTeitOriIiEXPlshbDPqp0EmlPe+ZT5WiuSwEoVbCXfTlJ57IsUreCXzJ6fOYTs2QRRAGo0uynchVo/r/vfPqR9lP0Ezv7108uaIWKIcOgilGISrHWXMxa2wA4KBg3VIyO1PzrsoFgaCAvXEyu9qkMW1E0PresMwRo0DVs+HmqfiaYfknDyk830X9oyzOfsanqFwlLUEjh1DLGOJ1qQ1UeEOl/KGxB0qI0jTaPRNO5zWBLjCsxs0jZT61EwrONYP/AN9yva9CxCY3wn5NFgosHGLgdOGDdR0LvpiUE0Ukve8JJ7jy1oBFZiywScm+3+cCskrHG7/T5Eopi51S1Egtr/F+eb6IyOiF1P3OGzaG3ltKidh9E2eI8ea4yC6v23pD1ZnAFkGhBO2JUmsTx/Y+2FtKVeXfQ7a4eR32M29vqf4uLUVuR4FAkv7O67OXHWlHQdEgEWVuKDj0QCyRZn4X9D5ruDlP3vPwKOlVEwJoHAVaQADC8XvIwBCNuybfjcYhwxDB6wi9jryTv0ZEB+cMza5Cq7b5VHgT5a0zYO2sLTlr4d5/Kuz0Jh/e4t2Pgfj97C3Ifdf4aYUJ3NyxyPxrTcaukue+z789FD4rFLKnrg9UuFwWH3i7bN5fxa4Z3/CRz28BpM6jWKyNR4ftd8o4x1Sc3AUOQtluKZYHlTrEIvswvlg8XxznsGaIhdbCwsLEa8+MGbFRIIFI+Ssw4LlTiOYCoQg7282PbfD1cvGW7Ye5pgN6KMDDcGR0nBCtWNECyA0+iZHuUHccebeC5eQfaJouRYVaAWcjJWwVPJBQvDnKludtNe+JPlk1tH7j2Kt/onRVV9c5wBBZm1dcR9yQhG8lS9Os9Oqtl3wPvYsjiPFpt+s17FH4kpXZYKdMKUJYhhsOn3nC380BiR5AysduarecXsm8H8QjR46tCoqYD0FtaJwdQ4PLs+i5Q3T5CEGAc4a1dOm+c/tH9XsgSw7U/QFL/F6ePFkG4ItdVw+aYe1OGcU4Kc+IYgjyXKVKsNhdVAvaY2fTniiAq0n25gAIWQl1jENo3h6us3fHQee8kXEOw1qoDs23bYHXgQ5VajWHUQhSMa4G4D2oJGCc79oplOeiKRp/xs5z+HTfiXb6d91347J7UzBHwGwp2+AH1lMXxXdowlWKtt7CPPtlqtxPueSbfK563ok7fcr339b3+JwOS1AITJbJe1VMDpy6DEcFkSNhRRCGyJmr317k70vOVbwbC3O/+Tft+RiZnPaB3NOH1CHPKWUKbISUXllhl0I3GvfrQq18PpEVc+TYSgSdZVJXt+88ESxVkjdJ5mhjdwl+zPhS9hPsgB2Yn2X6VWRXmScG6BV+eR//s8rgqkLqaEoE0NYnpHBwYcJjbA8bME2M8D1MMoNm+QTxmekxQLB1OcEjVLrJneIo7f+08VSKAF0q5FQkpuhCeS3A0YFKiZnYeBsMmC5NX95VfW6FwLlSi5Kg45RMQXtEvva1k7jdKyJgfE8+PAUbM2GSkpUQykJ5F9Z7IGx0jZFFxt4J8+beoOh1aTQXc+fVCIDP7yGfp1JUrlN7LrCgvOH2cDDrdL1P5xxApMdaAY1qtCkFzfT2cv+Lc+DBMUp7xquShpBfaZyK7CviifE7+0Hgr0yNkgjOxH3Lvib54mK/mtIJ0LXJoK6kUB8BlYoMLd41rWqsDJENSjSa1Q9G7E2R+QlfARdGdTfv02+W1U4X69KO1iMB8kZNlpz1oF9y09kgFIUXUawhV5jaFyx/Q+sNLk02hfXdCXN5TeMd4VAh3HF/T16NtDJNKLUlBBgpyaRsV1YY3SZCsxgtg+OqaQZ1jwNSWQUGtPlwIl8AJcwl4CCHAfK8OhqPGF0E6HDYO2RNuOnK4YniYlllLlTzC0HXbBfzfsiRojlDPzUCCaZMdf548C3j5tTRs8T5GRg8i7fF68hpNRWhuel9d1MsqZpW93KCR2qUpuodjcOkzlErDyfWSx94FlB0Qm7J5ucua6myv589aUeVCIsJNJ2YCUB9jlPEmlOjMj7lnD6eMRNC5PWBdaMUOMG97Xt7Td+mLoDH8zX2aoN16BR6P2L2QUTMfu2ldJv7q0849riw9k7XT/3bY7W15fZADMkcNRfXYB4HyXojdU/3PoWlJ8zs0zz/Mi83LYjoPdT3s3UIacdYdQca3YGpdDjx/9pme0UAcjgPNns5OLEOiuc4DmdtMn6634rwck2RibXsjK4OZOXkmd20WU5rc0OqdptCuUlJ3F7/S+uaNXNppju/Og8UdoaNvyWmOrVYz7KQayMUwFOGXkIxfxghmGvttxEQUsoyNVNS46EmrMyXu8G9PMNCnVgxQILJtmzX4j11bfh7CBKlB/3iJBeyI7e36rmNGGfGRc5bZPqoaesuqlJGRjhvt3itlLbCia3UbQNKZEQqaSY/4xplLjPibajVXq1erazeul8bpf5939MPZC9qjFVhaiWN1Gaj6sYzs/r8vHxM8x5Bu9p+Fbrr7t8Tu/Dsxn/tGIwa/1vtu4tqxfoyRnWw0CursMhX5GLVKATc/cqQXFSQa40wiZ7Gcq8dK8HLMPKEwmcu0J3JOcrFw8joymkeIcanlOorjGkeS80PX0/3fmpt3jW13RrnFQk6JWeSRybeOd7jWCrKeyIgRwsCRf1ZvJ3PBivEngB5lnIdv/vZifNXA9yQlzoZt9081eLyfG/bheWsTF/dFM5rKtoM7Ulc873wtu3m/IjryJU0VIicFJmpWZ+ZUEtl3xozdGvM9Vp/Qgnuyt9HTT//30vFLwpA5Z7SxfAzpUY1NkPg0mp92sOtKGBt1aKYJSDrzoXiVr2TuR0q5v1AzUkmVWH8/0gNTGax6RxFjXu6j6qGRlBhKOtSzaK+1kDXl0M0rqDNmNUq4t406tm+4xrimIVTQb3a16u9ZVAzVTZRnzGsZNR0NelNvX8ocowM6R7Ol5eD/kkAcMFp6yEBwuA1zSNL1R5RkQYWijFI7EJwRUWYwpIcbaBiWghDZ+clax96W5RKStlU8SPQeqDFwKVnEw2CPkdAX00TjaRGAaYQrZrv53tew9gx1Dw7GSxGPf1krFgwwlIn0rOeCaihJoyVoo77ArGzyF2wAn4Vq7te86S09d4ee4RiCJ4NIbW/nvJE93Lvl80ihslD6B1NnKWVnp55z25wX4xK5U+Nra8BAM7wuRU/d09CTXB1JJquIiauW3a8K9v2mo152ly3l0ON/z6F3CCScSA/tvrzptRaMH+hDnep1X8+h+i9g2UQG+xQS2g8fJwuqkZDLHvDoI67UF8ELvmGtAPdwqfGzhlW8xMAcjYf4ysl5jVCD0ukKF9yiW9n5dO0nZnXIoBO+L19CBzeZy7P4lle/8wVQ3EipDgVTOiXMCIIVOT7wBQ4TgIseseDBPLyIowJ40mBBsXxeY1XbB4eWmonWyx2g/izmSqNRK012Io9V/ZDnXaL3TSpAyB257CSIKTwznNK9AaiSK3vGBKV87Hl69sm5IJ3R3IeldBuNNLxTqo3xWOfNCygfPwXiyVwcqWCz+96OFXm7/Y1FFmmOqNiVGTTn5BSLhqjJ4h9jgnEftCREkbKoE6tIc372d/EdCVa+wrhSxybK6qi3AXn/FwK8ydajpXIPXWHVt6PT098+5voh06RmhaE9f39H0TvCSjv5qJsnZsUKV4jK+W4nyuteGXpgwt0Gte9M7Japst1+aa5jdfzqUHjFqjS6WLwq995LneWkB6gNo6NJPaMDbJqRhiraGAuS87wk89xIl+IJ6M4kpXuLOdpzT//lxxfQo4r+SZy5tRvjFDXgjiObjkk9SuVF/smooiOjDNkQIT+ZDs4PU80UMf17N4ZliL/yR5kxLhH+cd1KV7sEyILQZtv0N1JdZViNuRqfdXZJQXvcFRZCJdiY8vR0q6yWnYoTQCTIl2Fth2q1gZEsC40nQ6KQ82F8c3dE/wuRaSifq7Wqe1mEM6PnFZSiIqzgZB709kqkW6woUmeaWS5VnMNK51f6Xdm1d8jH/I5U6AokCw6VgWVuCg3ED36gChytty91nVYeZ5XAE0GM3RC+ACe8TgK73NFkeznu79Xljgjrnhn/CsQKNGDVi029JZPOFWIcGblwObm9Zfo2nIBo/dB2RDNUj3XeAMWnOT/YncR5j+efvkUgEg5CsnHrvOVIECJ10ZY0C4Q6jpARb6orUqmhagDRHtxYR7Ios4HHLVbgRX0TZFmOYnQXSkmUNoeg8Qsc76PREIND3yH1vcrlPSIc4/S/pq9fxX5Hu6ToG8VGXxzPhhUCLUtt1ThQIQdl4zCedt1Ea+ZCJNSFMJ6COtlc0W1zWdxuubYiaCPaVuAjCY9haG4j1sVT8q/8RV294/iHDGhoE2MW1yHgdPihpxNKVPpnzXK25p22G6+ZVdDN36+titkhpWOOfWOLf3lRM5nU+oKDVAeG7V/OTgtX1I8yKm3Gg1ZBbcZJWedIXfDJkxBh2U9mQsJAdnmsvqci4QwRpM9aAQHVLuO6uuOHoHrz1kIc2tk6S8ePCQMRDpxvbw7sLgQatAeBriDBBk6mYMY3gRufBLQ9sNnJ1Iou7yvHYwUaTxYX9neVbT7xXuc3vH0HlMLmhqviuotGyriXVdhn6rQuXj3pjvhXyvIzc6V8xNhlQ0Gz7Rnuj7tlhXPWpa3H5hO9Wvzs34FiZqefeJd8UGJTTmFdXopm8E3TtTDGNZ3Ws8bGWQX++0XGXQC5xrv8XexKTsLeDXJwc675aVC3/eNf5hM3AmW+lth6bUWltkZYAGNNboGj0BgHrQ5nQtsgXJYnKxNtxYMB9ZY+cP8A0MqSoTE2vCuXxgxp2iB1azL2KrZVRrfMOcpIf3rwf6Xtr8bemO7+E33zr8YGNbNF87UpBEPlfs4pnMXK4mWZIwFFfj2qhxHjtBJoN4gwCP1mUD0QlnbIaTLaLtOGqPPBzkRKd4HQhwv87lSeH9jw1Pn0peUyt3b85LbXBDus+g3KP0boi3GNg56bDVBcw1Mtdns/hM1Tr4XFTRT8NN9On+VOv5TbplKFMr18d746mH3J3Vgb4ogX7+/j3MM+B+01X4SuG533M5z21ivSCdvahKAehx+RavbWXpm5z5X+0dL86Y3eDKsbryjkwV/yxvehbTt4Pn+4mnfhm1x4W0rY+yGlvcWucZ/MwTcBjUz7f2b9TE7U0ZPniR7Vh2y2C+GD248Y9xFPPpz/7SNnbkE1L/YJeFmYFW/XfdB7Qhx69gOXPBLWNPcaw0TnoqjoKWFwbBzVgZktIlxITwFZBygn03djxB4ByLZEer87J6GqjAR0AF3AXzohJLfW+hxcSolysqS5Qy/J0IU9O0DAP/+Ubp4jSJ1FqPxUcs+IA0Qa+Y/9/rlMxp/6/62AarqhlM4JbppfgiJYLDkbwBx/iXEGY/xrULJwteTHzErT+5Yh5lsTMtPWEmI+AgKUrvWtceyku+ThRlKR71iu6tP7BWzwjrQbGVqLpQwVdQ12nZW/HImPD4rv1NULD2Fcv3LEqbCR5C6RYYz9s8cmopa4U9AqpY8Yy7rCqPVj8ELgvSC2Iv5CCW3wI6VvIrslcXPnbyP7KGxFxOfl72Vzth3jkCGBnjlLX0rMp+0ZXlfUkpROpFwzY32He/CaiOpsUsjdxJkNmi0Ec6XwE+QbeeOBQwgahk6/otkoeqouAsiRg7cNd+IjG0IdD/nNGIk24oN1N/3fqc1ol2GumgXHAqVmIRgw+9SfMCcTgJ6nQLg6OxB1CXI+s8hTqWN+9U6FcBLBzxMgh/zYvgxT+e9ku/Q5G4Uvh+MjOn+ykBZIQiHQ0SCVSboX7povmOnnss7taCq/iAGnxlHL8gPHg3DDXHAEjax9MX5jep5JTPKpDkQ73fD4W0NTa8Js0V5rGiMOSXc/TW0NLKCwAsrK96z76FY+V4Mg9I3l2lwA0H8t1A4hSw9GRVA5xlFryl6MR6u2c8oHe3UeK7YpDjceRLc2pOL99kFygPAgc9RSDZyXpLe6FWJIi0qfE/pRmHeBqVcZbHXbgZ4k7KLdTaLaM9FCq7wbrCy5ar6NTeJ8dgxpZRp/B03jeoAUPVWKvLHdayT8+hz1KcWqp4U8ASkdqrTURHqmyhxF/l7f/sXrHKvm7XkYTlXsg8551iA/MLbm8gsThk1I+aMlt1AW8bxuEcbGTL/xMIhewOgzhhYhdaCwlkU+ai9WT6NCi48rppqgVUPDtR6g9CZtveJp4L+tHaegzWQ7VvR0l+h29Blx2JSawz5DCJHsYEMyQQaAwQJlLHH5ZbYAjvruwOKYkKV8l1uV4rwPcnbCOfinbehbxnFFAhKm73KApNBbVbf3nDEeg7PgmJDnqB4WCDsfagAIKwy+CU5F2BXikeM4rlgZD7TqRDc8yenkPJZqFY68SzgrQjvaPAAaEKs7gUcKLnLcPbqi6sKqyxisTU0obDiHM6EMWuWNw5W1aBAtjwecEvIjhUnjR9sZ2JGQ/ydW2Ko2thQlq2Op5leRqkDGp+I6qVM0aICodi7WAB4yCxZniuelTUG0X8KtIo1BjWrRec59d4iBNEmL+x4XJn/p/3RpJSRlHhV9GiVYL4mKkB/iz7Y+ACGLJ0PHRPZKIS7b24bE3hZboHr9qUkfA2bOKZXcaZezd4DUV0L0XvJeSgliEDh3NzW9lybC+lRMOEUCUzWTRDsYEJgwnW4U7X2pKPC57CBxAR3hCiIh450hFkZ3fpCzM54FiRKyctQhEg4p8c69syb+gPVYx5foGx6t5aPPHl5nmRpaT2VR4+uLzINAgrkgktD7gvfYV6YHeuB/MaLsosU420K8iZ62UkpdmtbqlLTrTeEntSTOBSrtmp75S340D7B/OGL3X7LbVXLFE2fndmjvBFitPHHtcMcdfZuzgVqFoYDqnowXYQjXOwJh+zR/igttrQhatiq1+NyDlzQrD73+rPKsMTFFNp6h+A/hsSU4p5sCwUYHVGHNmjwQ3V+l5PZhRYJ0BEtxjxC/qmarkNcQqE4p/FRrB3FYoPgfQaaDGGxsFPvYHBFnt3gIpUPiB7FZ+2+OFtMkuNe+SfIg0kVNy5ifghosIsOVuKt9RY/oVbq6PaGUn1KgIyy/ACHfljvYu5bIOx352stJIE5mem1T5NbIyKKC1N7+sy6iNSnzNzBzcFTfN9RYCQ5441w73RrpVXIYaipiJ+FfVM6Au+NCDedAFcQfime7n0IqQCN2UWhK1m63oR12yIEvjdwLFjOzeDamGDebhvStN7E60//U/zPqk/4F+KkpdB9hi4Vjii091WehOnIhR1y8yfD86JwG92nXT1GLQLkCTjkvn/tC7XLF7zN/d9Uav/az20XdQgqbtyF4rpahFfoV2WYLDZCedNITE9oisaF7vfC3fMOwCCJW+iQoYrvu/B0eGzWW99vcR6EIHGiplTwYOhZ6SaOWVcQahDCzwne60dXXnmLC9pAUp7k64kp4Ar1XuTNnc5J54F24WZv+LMTeAVE3pRuyoreD3PcKhuiMG09p5CPKfVA0cD7hn5NePJd+OyaSzfYF0r5nfrw4fr3JgxKs7nLy02z0an/+qV8ZlaYk07BD/f+9X83vf9ufYfLbVfXpD9udNsv7cgddsKxq+rPyOvr3qaDRfJz73KB6VPVLzGc5Be5O9RqlvgOE9GHEYhJQadxEsheOQYmeKdixYsXQBcWa+KnKd8kwk6dNe6NAmk3EtrNC7MzFe+yBlko5ueqAeXaYQdj1acqSRAhHl7Z5QXnnreiUT5mOIyMuBbzJ509Vc5sW0yEaoeE6K5ChXPa/ryH8OSOmF4DOXKTUgApkIGSmklHV4oHiK0TytujPgNHxFEjqfQZI1hCOevCAHd+Djo5iv6IeJyveb/Aa0U8HmRQ5fw/hUsIATWrlfdPquvF+vfeGwfM/oMlGG+HnKB9i4AV4ssLJXyyg5UYVOKk2tFQ9heEfamoiFJHSu15f27ggdYkp7QVdkGObnNHC6e6Oc29x+BUw4bCCKW7cVZ4Bvfpo3muKGJ+2x1B48q1cQygax8ugBgicaG0j5BKFy43WPGiwey12lngjUeDASz8J4tRHY4GgLvoahwiDajVXFG5Ox0dNNRkEqrERU7KBZeDHQqf7IC0V4t3pMK/9wTqFNuwbS7Sr+RM51opQbhS2Ols8EoUyFFoRFT8Uyyb0RlNS1vxCIaSK+oHHIDAzkBc1SFtjgFEBLhdCLcee14ECTBFv6PR4GR8eeNMs9LyWmNmwt+RyJwdWiVE3QK2ckbTXYSOs0ApwA5mV/EIiKAbSGGrdGhXfsCVoKmy3ge/Q9VnUN9l8XVWL/qT4t099AB36ORsm+ql//x7y8KtsEN0wq1JYddcKxsCqoCZ76c6Q2qtncvf1fS6k1igLFx65piaf2oAEKynLGkKXwSvsWix5Mp50CF1Yt/6Wl/4WiuCeksRXW8wCHcm0FJoS9vS2tct0bOsyJQRrrUwZ3sj72JGfm9wlwPoO0H8nmi4CC3LTCV2E7lVIqo849FnsInSm41NC4YEorHvryznLWVjTzmPq66LlY2urXEXRZL9gYz72329h8AFe6I6mPE94zqsiP7Fe1+Wgu15rrh3KN3PBhWQ9Rz8OAQdM15C3Ak6pc4E35FricmzM+5cRpdM8xdQKCEQGrwJb8fClRjAUZBA6jdOgZU4Z0w8y2uS3gyZx7QEXd7yB9RQNzT8T4HeIU4ub4PtAVsQnhpVPRTtPuuW1+slGbWK/MH4JNZQpG/DJLb1ZsSMUHUv9rCwqNNcothxKG3SBYYeTmZBbRL2sC/jrHHJCMQaccSgKmfuXJnwY9wq7eYtFwao1GlKxa8hbWB/pTpdOfNZ6Of/dlbMDj/UnAQa69ZdFSTusE4U/jmKm7sJAPawKoMzR4Fn1D7viu8scz/mrpnnfQCtAKISQmm3hNxg9f1jCCnfOwOrgIwVVrTZcmZkrU/P+LakH3jObUhlJQ9grJGoVu/ybVRMqFgm9msFaolrs8dKEV4B21kLVM0qqE4yPoUw0OtE1vdHUCVnNpsEfO4iKFXygfxVSwWGykUrpJP4LmszuOjZQFjFrGAVD2NhW4GQun/dZGpjCh8CPw8lJ6F/F82RbhZqgIdpwzPkr46UuHhfEzPF3y5hMnbzKYCHyMDs8RGjytRv0mELoqCQ9JTkXkwwL7snBiPwTYWCwNM6JEyQkfJywJJeQJonJdmXxEFRb20EtHaPNDohw/5KOHb6nWcDoLIOdYKaw1rn8EZWZDOhC4bwIibs/K6XuvWJunGfii5uik7QhI+q0RQttAhfWa87bagMSRktSjRcC73F2r8T0HWEVOAYO1QXNHOOHMqy4YB0Vc8uuz8ycil3iuQ+fm0919bQt+8fE3fGuTg2GxpLvEsPBqTPKGEMDMq0826Up4oRGAqkiPVz4NakQqYK5544CTYhrPEbz8XAKEVT4gwcP8WgLDrZckpX+mD+dB5g/MzNBPaEYMw0BRyDIyR8dbTOKcHV7qHBcEJPqHSukBeyyW+ux0nGl29PZ4oaWlwQ3cXGlxiPg8gcQxHMmWjLNVVH83ctqM7WyYSNfiNsZsIEfV/RxoEbqOFOQJw2pVOm4IaM5yrPfpjzXyteb+ZRK9AZafEWXMVGJX3H0jWFsyb8hHa9Ma+L/Mzn73/B6j+tl/+2/0RQNc/Tze95HqsyQFGgPEZNJSs9IZzOjP1wNtAW9f9+39P+98GTsmYOu+8mha4MkNUoYBzOjwr/3nBt3ECmqAR1qgAAIABJREFUn/59NizveUwmo+kXeVX+jdk4jBWJEygdbGSrVXMOPhMNci3y9dmfY1ZcFCiKEkdiAwL4O7R8eLsRvd3c9o+baR0s3l8Z1H7hbT8pA9G6gtv7Tn2mEzSkKJIp+NwELlaaGZYlfHDZMRWTbWENJS641XspA13WR4JwQWJBlRHqXdzU0SIWG5qbMlS3GddHKkCjVIzlhJmMZjwrJCnxjbjTBL+5g28li7/V2a5BbJ7v4aKyGhTVt504Lgn5LDL63+ekpccxvMnicF9U1zkllPGkpsN4vXkHf8bzGdg7Jg95F3bVn2s8RG7jHKdipjBXTu+P8Ky3wh6ymM3WhvN0G8YWy9GZvAPT/Iexq/mV8inNd/1vbDV+83z7MBZ88rj+cb94GP93wlIhBs/rF4nv/ds8zKsYn9F5Kfub5hBhLRbtJZ7rUvRgOaeX1qhzSiDWW62th/Oj1g2mohAe946HMcX9yff0IEuCQbOQ5gLeRE7xvM8XCOjei+2zRtbkfM5W3S90pqeogQmCmVuLcqqWV5Wrk6XZWf1Tf+tU+FER/WrTw8B819pLXpWfqvJVmC5t44VrFEw1lgJtK7BeHgQmiQMDarAg1MLUpbpMV4+r7b30+6ZcBlS7PkQFfvwMEeepYNUQDlTFsjHx+Ss8JqUXP99sMpgONkzE7SEq9uN4kOfBu/ySyCH5U0NnCUUOLCSbnGFHBlDrRN6iH98K81lDL1WVnzOyC4XgJNClHIhKFwmHZtthZJR9D8CKyuExctAEWn3T88GjkkEF3XIzW3FfBKXD16fIKIiToDFskoI7/K2UNJTRE35f8KUh4BS+v3PxPBLazvsWZHhEwyaeFzbwU/fJMrDh5S4oIB9jaOXnLWhZy2ftNYKsAEPVuQ4GGeN02x9ZR0UZsgdT3f9dHSUG+z6chQFZL9H6dR7o93N0Fni0fD/L4GtKSUCHIkEWqmLna3qpYM1mLlZ//I2nEuj9/rSZQzN5TTtESzBaiDagP5HwjBZ1XLdo8aJZZxvmI3mUSJVaXgRJZJ5RlrMLL1XfS0d+RF8XJ+RKP1WuXSsIfOYD0JDoApZANaE/LT2e8cY5REi9a7Hn0UOdHgHgXEWtTiAsUw3GLXFXG/lQDokQ9DekKqeQ7RcYoBgSLgz+apDXvoVVqJkQxu6kNDaD5PfQlFBwPqcFFsHsyJxZ2qa5bcw+nUMJGrwp6lRmew76Of3eW21ORYBpfd9DnUQaUncFMWgih9FXqv5v0jifjiYGZYBMfiF2jZgsdNxI8V4ZUuGQUoKoM5h5VjUs533lu4y4pa56Q3rYnCGhN+KPFmCJHJLR98orGEPyQvCgscylB5xB7mEHS99glRBEWEDS6IljAFC8J+tRl9B4O/5d7DJW8iri/TWcp7AI2aCJHhRb1s18KIsaOsyDU+UqG0K8LkZGC8+5NXuhW+siQDDkd9V3IWyyglfguZna1cbGAY9zoWKO68brqr0whG5ifkT9u73fUJPBIZyTUVC8xCFadwKP+qVGQtUgtcxFP9zHDnnyrlp/+oYKe4UDiLH6m7/R3D55LNRW2ERXU2cI4j2q7HEivq4Mls/1G7fioR3PHRJMHN6nbeOdPXSaqD6HUwGflyucxq/J2MiQSwoVhmYX16ZL7g/Jz/FianF7JYbOkRi6Qmf27XV1cZ+/4VD4yfMdQ/F3B7Ozttchd24X35dwx6FWACJM2HrNh/qDLmrapTB+hbq8qSZGZ1CF9JBi7YZIiVWGek+btdDSwjElefC1qp9rVrR9v9eucnzrW4NgS/SR1mmr8ns4QOS6GUBOUQH3vmj0iQzRZ+RR+vcJcR6teBJZFE/Gx5uCt7gYTp4cN8XFgoe0HhX4sIxN9Yrz/UPEqU0Yok3IKUHKZNS8EmpnghRZDsJVlRv/Uiq0X5Ul5dvnWdzSt9KZ48bPKeWa9/qy7Ncu9nLFVbPswdgeKvQFupM4yaumXVYWxtpFOrlTmhFJ0drojhUzRPgwOrLQSn5cYfpPqXUb9NZJZ7Rsb389+JyaUFcshN+JlMRJMVK6hvz4pFRveI9vQoxmd1XZXVjxpqr9xvjBoPwnI6klBGnGicar0crw3GymBYMLy30K7kJazN0R6XhfVDuYCagbFuUVTkWZD3UuvNlpKL37so5Kej0Q77XMBGiPj7Or4XOYMqZfUxMGyXkt3TL4GwbfLivKXB3KQrYEVgkUF6kqmsws2cZW7yqDUm3POu/visPQi99JsczCHwlWR68Rrz7kFQI3RLZQZnnmbbTGDzLwjRRfpmpUJOeXyNXU2aCoyH/ljxl+7zfX33ZA3Bg3N/rnhPrKBkBOso4i0qCpIt4EivCsuL7DG7EKmUVCgTSx5jjk6fjm41x7VNrziE9fSTm5yIkp2zxb9kt4HjYGfmwQ/N4IDBe+gkslFb0rHRjTXmz17yoYjTcUIhqDDsU7nzZ7J1B6MJVeuJza3m4NSTtY8bftST2pSh/Onf3uGWxmCtF7ozS9NxXgdiYKY6V3Y8h6zASh7RTZydAoiKgOhiFrDzB7prpcPHMYjEEYz0SPknXXRK83dd1gZWLcN2MV1tYD8mLp1BHo4I937qJgmLguAHJYkoPHJS5osu2aV6wlcU08Cx0fgTW8X0xZLlrkKHNarFh2ZCMvQ9krnghR47pl+pjYWdWMgaHE3725MqRoKTMix94VWzGmAPwf2HvCqJJ60ZsPO9o8VzYTEgWuCDSbtGhdqjURF0BFy8JF8AUiEKcCx5Dbnc0G5Z9546WaAFzp750Eq1cP1uXcxWIQBUabFSTaHF3vNWMMmU0ZO+23/5v1rNIs3twbre3dd7HcekNTCqzrHXcZtelbZ09RsRtmt1tWThXNOnXa3P7tptl7iUKDOxwyL1eogxn2TulaEesIRRiZKLC111pKONT46bdFYVrtmEH3DuhJINV8KzLCiYDSTFCiKB4AkiGKDVkGOFXX0BK/B30fHfGuRRva0Ei/i9fSczv+CiYpLf6FNzQyZKhIglAXzv50JtS6eSXGrDx+f+ecwkSZnAaJhnG1mSQPBWhuOhNIRdwIxFzhnbzW/YW2KhYUqj88HlLnIm3enKBru1orToEQjLGjPv+1VoX1a9oDKp6J8teKHMMuQ02HY2D3Yiv6P9d9+opptoQ6GgXqJkP7JdxXxijIGR3EafW9XnCcKGUJRYzjvJcQ5iCwtb0tvdYQV1pdP+mdQDbmFCXl0AffrXqH3LzAXpPycCGEtQvhijDPJaDDjIcu633zfLNXK7y/5D1CM+l1toba1wVgSGJVNGEEdFFZN0Hw2AaBkvwxLSfkRQLVDwzCdAt4hsFVP0XZuqYbYfxiTpe0z8MpWTUZOTkZMhqlylgqJLhKGV9EDWF3aQ/YD+nxbn0laNrfmdDOqctI/VCyaVFYrLVSFTPw0rEiaaU+br6QWKq+oSxcjOEIYaRap07WMhtBECe+0MG7YEq2wVp3cbC7HJT4Xdchl5iHyduLVtaybBSpe6YlcmF1056ZCjVdCDnceHhW4a6V1T0pooIBYL1wDWcFxudG7Bs0tMtBsLiwemfDM/65Gk9BrdEwZ60Xa/qctEiuyAp8Angb5QV3Z5rwvAeNC3UWhJwqMiqMK7H/LZNs3pFGGK6NrjR/njcGrJdlYxvlFM0RCsR/AVe7ATczm2uZ/gUvZopmuZ1rDawYTDh2qcwRyt+jkj8hkV5EIe1i3a2zNv/oQChlp/KmPgjGixDUP333C6wqhxOPi4T+EA0bGkN4pHy3TgvoP7TZ/RBevYHNvFAmo7cwrF0Jg05FKn4Ylw8CrxEAMDH/3qylSsSdQJwmECxSDHIbnQU7roXH/yoopn2vWAFyZ3ZOilEaESElRWFhZn/LfeGL+ie4mmDy/xZxDsbCQVWbw3NN5YuWiZY4StQmBwPTLrNf5Booz1x6TUufAmqun8dV0crWv14HstFEBJyRA9QjWStgy13kCrArsDahaAjdPH3AubpgW8QB6IPuQX/nSNZzHyKwBROKZlJZEngZAlGaxw0aCkCrruYsxVOz9vRIDIuQek9VCf+VJPemDMuJh+e9nX77rhtg/icZ1brsvp2KtnxSorfViV3YaQ3368Ick3VoNvcXn0BvfsmdXilwzPnbK3Ii/61t8xalURLd200xW76vQkXserpvMNDtnMK6qsK9Zeu6re7FvVLGbburDevvd3vOf+mA0cajLl1Vili1HOq55zLXrhzxrlOlW9mbpjp9B2Y46Go+2DBSPAoQd83ttLunHuXsqPEqPIDTnL9FziqUIwg4wf9lxUg9YIlkGcJECzB5RfZE2B0g3cuzogWUq/p8T2hckXWQ410kvzzmemq+EW1KBM37V+zxmiABIAm+n+s/362qF5938oCbSuOMbk4ypP4ulI2CPVha2LesfSfB78WKNuv4qHra0fcYuLLmX18kA9AJq1r14Sog6OC/VA5w4QuwRc+oURZG6da3gCnPYFvNiz0JYf6sArktxFiw3Dexc93giy123rwv1igRHUeLVwkgD1gDxNr73A9sTYdDHi1/FjavIAlWskHMBlnlO1rj+mDHw03XPtc8HgGCN+NBAKTqAXqPd77Jg8DgrSA14Xj1QFhIi9+gEdIW13Z7Mv6SQTstenBX3D0K2vD92ihwz7080Ip//10w7mMhUMBMf9A905lRmOuQnXLfv1F4ER6wLUbhBOO6Mx694mqIsp7RPAVqaCi6cIWK2lgxGvNeoYmitFhl0K3Ct4A6f9GJz/U/mWU7qBuhJ0r9C9e+iGi0IvxUBXvFr0KyjzI0IIYIaaw5O0UKPykhlC4Nb1JmpjlXaqcJUsG+qMFBLqwEMhfArTd0yjO43XtU9ffo1FFR4S46q3cOD43XD1nh7sULAXmbkFXFe1IhDCOn8D9aUAlvzqtdV89LyD1X86PNGEEYKixU6c0C1SOg0NNj2eYdjnTfcqgAkUgGwU1rKzsZKGbF6geF4hZQ0jU+jN0wrBB5Ivw+0sMS14MNmhIxQlLI3VhczB97WrlEGpKn3ZQRT2v4QKqGZ4DWL1d0ozDOIxlYwMMqBASjND9D8y+EyJqaFgWoVg4H4+v39/FyqF4bSSBtdjwCjIxZ4HIbtE4npMweACynJiMXQNAwxQEtXSnYvqYLBFOrIkFW8g+BUFWv1Ndn5ZvBm/QhF0amDAJdwxX3dkgRWlP4J34LkT5/jQ0qdJa1N3FcTQG2TL2WWra/LFDehEK0zkuY8TmU398iWPoezmr0AJC0iBNjWoTcDYmT5zv6/QrX4etJhNt/rfp9H4ASJfHd4u+rIC73ku9Ac/A+T4GThPt4uFcus/7ePzKWEUa+JKSoTFhc7r29FnI2NwsatgcVmNU6jyXekyyK/5gRaxEbHiZmNavcD+Eke5HIxIRmmh0wLcfbr/3omCwsCithCDs6CQ7m0ki9w8FoSTzgbJ/yvZnoyLezzMyP3qTduBNHdS/EiuXC3MjxBDUnLMBIWsse++8+r897vK6PYcBdNxZ41+A6dFuDONRxIwo2fcrOiq6ctEfeWCFsCZqI0q2gskKwzT0y1fPcFKjdpCUhFPyUlr0FXbuldLdDqlVTUw9zgZ5YLdwP5BJfpWxhfeEh/of1wHDZDWR1hOSyoctjTIH+JW0dlB5wLuSLvwF6ohFWwOHmMJ2AAt07FIi4iTF393k9heh5AAJ7HmjR/8KYXLz7ojAmxP0WK3gavlfPFKDD2XEFoEuKomnDabgVlAc0Mm8VIRILhN6gR4aYJ8+sIz4qIUfhxQjtkpnRrPZku7CeUcFA2LEYyzSSovbclkm8GtESh5+8muHZoiPGMYcny/F18R4ESCO7ebp5UL2VEMXFwYiP/foFVnBlw6gzbKbOgzQ/wjjhPSKLmifPaoiYyp5s0bmQopZNTto6DhOzc2X+FLHtEPxMIAFOgE/BOfMJZvcX5XZrzNjF+55aVqbI9SlqPdZo+bl+q9M7Cg7/hDfSQRu3nRN/lFNRYxUezjWd7+sdA6q1ZoQwlJsaOPaz+mX64qZl5F87Fn7Z2Oq3pw32K3fA0QWxGSFOzVvHJXu6TtWGzPPn7bjRCKdf4aNvhOPF/2BoldPVGlKpws3ecKWcb+ZCCZh16d3Z/3AOfhXot+fqML84hG87w2lUhLdtbMs09DculfYoxJt5PQK3jDISPytdDoN39OwnHWCDcvQaiWrl3LRWv5xHNW8T/LANkYkrveNzgTl+PC/j58QFANW7DYHOhIPV0Si5sdfaBqXXbET/tYfytl/SbMb4v8Gt/mWzufXFkTftZrA7vGjVkvgvXAw3YcJfrpt7gvHP95mFvo+/m1oT/Ser4GzsmFU39ZLlDkXD2T0Hxo0SFJ/5jbDxizPpdu4guemSsEEmTWiKk4Lj9cLw7//V4McPe8kOUYFfjeFpn/jhd+f1w5Ez4Kw7fIr0/FO64rAe/uv98cO8njqviqK0c1fdlM7oHLqXDfDWKv9fyXcaOMJjaGUQWPgl5/SLVzZ5mrgQeL+Eo6b7/4/ekp/WbDIYTsr5l2vVNevC87KLSM/JW+yNSfzkbf2fETG4YdDUc+J3ghhaqNySS9mFEYQBM8F87vLpHAn8DwL912jPL55fJEEzSrNw4ZWqNbAspwT0R60cZ2AuTqc0Xn9Eo3zmV1WMv48gh09VyHfIoAqpslSeNxj1JrasD8YoZUFzoEzUfLjXgj138d6g7xn+mcYU0T0DlfJTv/X5e1/zyXvb+/ce9tNisF8DIlWbW3Hw3i+nr0EL8twz9O9Q2stzvejfhRDqLJBfwnxdrkmB5UwWu19YXv8atr+NDNhRWN+H5G/D+jeekookTddMz1umURlv4CWFAnb7QYjjIjpxArz5RfHiHxTDyVi8ARGavq/RA4z5145AycfQ/zm18mvUp8VcvYgQwc/n5RdDtbu2M3CGdGT7mqoKPBQv2lAzoWo51Fzj0gmDmF90z7IeubE8QtUtmK6OxwE5Mc2FMmxMy34IvcMAde8/ReSmfW/ouUOT6sRUZoWCqaPq4vizmhqvy74bBU5EXuF30JEhZAPnD4+FIR5eyD5dCPJiqIoXeKwOZ/h4afXARFGcPVX3n+ujBZWtsWyV7ZdPXewPicBrJVl5P1DOcI8d4VnxXTxZeOq+vEG2xbjx5z10Njmxcm1r0TNpldfi5TgH2erb87mtSiEyy5qB/ssN3iib3wO/Bs9bFM7uGX/fUx90AFGhQ//c81FseY9sqLB3Xb99xHF/5XEF3Afn9fIwv3n9gPj8anWr+RTWeBp/3h8m18q5BhJ7r+dzTYReqTLd03pVoeXfPW1hHSy3gcc9gapU+b587r6/QeZhqMrgWdO415CoCQNkj1trZOX10wI7ysTYWKP2Ocuvei8TsgJFLiS8PdR9kz1LhsKDkDUu9lGQjyG6VFlCGSdlmRX+VmbuiE3cfHfrQ/oD/2RexUwAx8yyGTfFC6kcE3xVU1K1nyuKZB5pZ55PSUZIJ8vliJlX9VcCL3RRTvxf/m//j//XZTjzJsTpB6/1Jn96Cv23OVnvPXH/H559+78bz/9/QUg8he9vxjDlDHG5hv/retnFPf9//b/Wo+eerstIwS/rMFV3n767RXH8/7Ppvpr/mzn85TtvFNAJWXGqAUEwxab1+vXc2JC++P+G7Po/Y35vQqb+Q6THfkjhNORvV+fODtG72zm/Lbr0/5PW4kbXHu/zl7xhoIYyo9dTvWATuY4azmfvKnv9ZLuJsMn2jLJ3ti3ljzWTPf/oKaN41iqC5m6m0eA64JQHtzqiuBkhM8Rk3xKUck/8CnYn+QutnojvmYCVUrG4iHaREncqvncYn2piddcJxzJmF2NsTosLVA5v4ozmlPRrpnYpJiaap+JNct8c0/4N1tYJ+rnjdS2hSWqAB79z3oMYtdgggV1Q3eVzYIk43up6p3CEqgfxAMNW2pK8Eqi3aReIgkjFOh/WTdGAltj3kIzH+gywO9/vkqreTBex9saKAGxsmVLvL8CAagEZU6DymTCrxWl05p3my+ne3PeqgGZ0TltFo797BZXIbWoTmzilzWoti5mUa96tYZELnQIWVl6ixyTKzRXPeTgLr14J30k6Wae0IF4DoIQF2xxHzUXkf/eeKQaCGbQEOByy3MJ3P58gi1FaGd5QWMx9QPeRW4NlAPS1Bg1us1MCDkOTNxduDU3dTsZZbVhuzGYoS1wlw0wj55QxUrXQQsXbBCkmx2Apoyc/nyhPM3anEBzY8z8W2k1N3WJ+zCrFXQrmmuDVheDI7vRw06Ps1iDriLlXbTewBmlIGItdQk8W8J2a7Wv+69g+ZaZpN9UcHs5AhX8XqEWg7wrAwsRVHOiMwIWYEB08qjBGZN8DMl8hZOE8TjyTLXatlTqfBESKDiBByr5mj3SyDj+uebSpMdRJQaFZasXO3NtKTk7Pe/joiwxs9qsPMrg7YzGnxAq7AwFBszfUe+YIALRFwnBpyrpkMvhCFK7QLkSpqyurW5zuts1JlHVaU5GABgoshacYhJr6n8oB935jqpaFNLfNBlqTkx0zqs7cYjksqcpun2dDWOkJJ9PnsORN2+BvRZYuhfovXSfkjFzhRNz0hhdv1e5Ih6JyVg7XhGMwFcOeQtKnsU7z+C8FsHaYi5u++V/Ti924mwDOSHT0y3youoJDEWyLAXAzyw3o0lHAQ9uPSk8WcW85oBXFQRBV/hZlmLWMmkV9uMDm94p6+dSd8DhUkAGLuiCsolSmrojuyEHbmCb8JVf6lp8BLYpvMh8cGOMuOkcPiBg7IqQ6e+fvb7JIhBWIEguoFhdUqJah9oPlSVb2Tulj8LiseqTWWetix6d7IyxkqLLovJx4zyU8285KVtbnLz3zE2Rca4BUQ1nCyk2S70Z4EwSu/t5ngRv4FCp5lhDAqxfoAEULLJGJ+I1Bw86yXAsFjTtsvyuch1OO9YdcYAmi3OQST3nLOD+dh7OoNOemSOmmPueXGpnBOBjX9ibli2p3X7UUqr1y02Hlg/HRRseqL/L8d7Htz/j4yyoCo3LQGaFUGJ4RvZQ7B2ClGtQZ616IMmn7FH9LzCLQ+yptUEA7DJ8lFN0+wW9KKu6U3cUp67NSYeNeU7W/pqBMWo8/WbXb50pPiIAHi1nB1ENghqPBIjfUFJeJXtRSwwV9gC1ifaNnjZJ6KIIRubYvutS1k6OusOqjkAVmU7FadrSXvFqSJVXIqdAY6BG4CzJqDB1dxsoTIJ1t4Q1Lgfv+24tFbyKYUknZDSrlx0hj43FoiieR64lTCu/dU2Euo73qrqPRHfoZVDo3CoGV+59hZv8JG/aFKLbNxpbmvYuwuuYQUAZPg9xc0VLR24g1LJzvz4iIHH2PZyBzQQxONff2W8Pc1tjizGIHhkEO33XnK4frmwyezVgyfFZ9OLdd6+IRv8aoFhvkiVre66lNJfhg734gb54VfMEq1lGdfcXaidPUoRBJ25RWY0LgrI9qRwRE4AWyc0JtGA/02HxdJX7rnYa8nTMHbsj6/EnKXE3GcPCAfu2/FylfH5mVTtkBq4dI1mmo2hO2DKfe12wBu7LIW0RIVVu3avgsvc8aQvCuw1PoLEurAqhNL3WW4zMsJJ1VMzWdJY4cZUxHK2x0iBosVP4Gb2sVhTBvM0fKiqfEK2LkIKdqMo00glPU95LHeZCGrvUBn6xzmjOh9voq1JiHoFImGvny9Aznz4WB0PSGy/kWa1bowi0QzEHYdwh7wkVq1HWKG42LCTGXyHrLO54MmAifD7LriHaHZh6t1r7F/QL/tvGJLOcxzWHhHjavZ5FDgT1NYRugwbuvnmrnYOAUbalvVlEKibVTEslbIW+HUPuaeRZkYEwooyiKnhv/OIeiZQYanZHHFIoAZZ1YySugeqdF0LioiRA8xWW/uQEUwkrPWllpeuOJYfD6TRwSX9WDY+Qv7wwXZuDBjMLY5b5lzzHIUGZKtPibT3FY7RWO4A9mjB8Q77Hv6zkwQYWHCjci4yZsxbg7MHIPP1JFU0UvxNdT2h0iEP3vCPKw9kBXbASk6/k9uMtlv9e3bxrcORzWrgCG+XvYctkwI/u5noPQg537nl2IFxeiIlr5UWVvl527mXOnMchTitaDl75rkHHpUojNDoKLXBmTcysBrZMpzzuomWX/yqm+zmleOmc6E1V+/r3SdzCz/5jbPnmUsV+9bwnWffd7zmE9AY8XFScwKmgN8+7Y94hAe8oz1i7beNqTd9s3ROOiwS4bCU5/OSliJ1r42et3UqLVt/ZG7XrBOFD4B0otopgZLrwJXkVlklRT4R3L35e1TXEWN6EgDGnm5wUxWCdocovCA9Jp1RgrqqUF5ZEOSv3h4N2yt6YgjEX0wLpuIWXlZ8+zdklk1CbNnuiJWK86KTpKM6NTVSMDYu7Qpub4WV1r54D7H2ug5XVkTEC9h4nuD0LKEoBT3TWQaTK+Jo5vSYsfbUGYNUJ/hy+3WEKjGqvfosR+Y7Y23ofJaz+oPRDK2Fshb4M46nxfHTBVJfEVmEWLY0hAaIzeI3t6O56N0XvLWfmJcAdXUVVVQDVdo9SyN7+xpBR10JtkkrGZptToatS3bGs4/N3XicCsRGFRTIhcuIc2UoBGRZuUWehEPbqApO6Ghvew+CjJB6Fnvo4s4KKEQEEswfBJAYC2CmgzKLubbS6XFmoXpVE5EcpNkG2eX8Dfkg5eQH+9lRhmfe61LW4WD3UT73GtcA0jNq1GbD+/WqZhR5aYPW0ZR8sRQsz+RBlhAy2EtGg5E6W8IBkC8+zBLvK4GKmrryGp87qSTW80FqTds8ijw3vQuoBcPQ+rhP6rV1hXxhty1+yZoyk1mDyDjNWG5ItaWTUvJ0/lMn+kLAWlk+wUSjbhof5C+GPW1xmd6o/MTmHiWUG68Hr8H+7dzfW/8kM04FB+o1ZVIaHajTfEZGPa1/v5+BlIyO7AbXBInUzgZ78As6n0R44OWu3TAAAgAElEQVQNVeeyg7tXcKwdMZX6DLpjtnOe9//+NoSNDGasNuxmxZ7OShRDi1bA7hHmhw6NvpEF99Fm74/LdlurY97bfGjsQoxzEVOZaGAslNrlWI83Pp03lnTexDVTWrPV1fN08d65ECpa3EjV4Mu46TrdJ1mjMFzY/hBFSXBag7SXID2yEDSSobPwS9dr6+2aIeYuHFQy4I3oXsLkUvvsuS/FbACHozEXNtgvRDFZSpe7XQrQUdCHe7UCGW/h5u+C/mO5eUyhJNtnMDzO2OlVOPOY7UKZ+g9KDGG/UMjMaySwnxOeTzR6lY2u6/ZcsUf8YOild9MVw2lOh9ZBubd0tPTcLSFB16xnJ5T7hOdc7mkc16rMH15MuWs+k9YIHc5FKY/8Ew9YzaL+wpA2HHLgxjLp1eVoKV0S8eAX68+sJw5RHlL3zlMYbPV+eiw+kzhB1GnIeCYQGD6tB0G/cwEX0LGDPX4/DqRFMezujVXuvE7I+94aiAKmgVW1KWBviSusHTKF5GLPMnOaqxojzF1e1jDN5Z5jCAMx2CUIwQAgBAdAobEsiMr3otwf3y/8pWXzN5TiwZrmlt+UXI+/Y0UAhPFb0PC7kvIpJnn+/V8q6QARw3yvDVVruy3UX2CZMi8PsUFpbVPyPF7nqSJzF2R6tenefL+bx+/jvJJgccpzvff2MFYPv+M1MjNbILiXOr9Jccc5CgQtXtpvwz3S3qJ3X4EE5CHe4PcEUmcPr5H6rLQggvZcurc4f6h5xK5VyxUT0DfMuHLcsygHf0LJzkG73c0UBck2ur5/x7PyrkE8f/G+vC+CgfE4FO97/hGdEVkOscVtxPYXPW8bIAIJLKI8Z+Sm3+Wz70T5bwaH/F9n6WEIs/ziId2GrzoGsDi3QSqAiy7JSm6zqdE7YAaZ5QVD+01spfakbyRfYSqxcXZJ74omnNgxpAmSqJaprVjucKl4S9ilAVFEV2fiTSvtN9VwFZX2oR33XbeNolI6G/ARLlsgk8JVCo3gc9EVraRrkEJbyFEfKnSlDJ2suUEtOUC9lotkFhpnywkq1MQ5QbZyyzydgIz4XR0CbVg8K6WVhOEUeW+jglUytwEg3TJrF/vAumhMY0CpOZK/q+v1KknlAUPtRfGMoltQHTZeJw+oicWZQ/Ie4YeII3WjlflNewa7399LV8N7QiPNFSggms7AuD7YXTjJ+ErrnTurUB0S5gKg8FN8ue8hWmRVv5YcWZvR4llmcBY6yvM4h/62Vb6CAoJMgYK/L5MQjJJkYbOxgmytQXk2cWNSj4wMC9I8wcz8P7JYM6Uh1iaZhrn5ihZhtHjJG+N/4/n39x6uDmg0sMJBKiEv8pSg3pEtZrLYnSzzuIcaC9rkWrD1y0boYylbCaEUhRs9nyMRjReEj+J9f+YciU5ChIbKHKE7G3Gv8vN8GAvPe9yzKmog9ip1MTifhfgsRx/Zc+Szwpj0DGRTmskVCIjCd4duQC/j8hqewyFsVXhyO0eIe2EZBZUSwBG/PY49wWl7n5e/pfy2Q3rkJJOHHDpuEC1PRbB2eA8MCV5cvP/gnHgbwp+jmtYX6EGnGQnGAMmM6QrOXQg+TgDm2rV4clfJC8DsD2gtM7acjASnFGJkEZuwtk9seFaFAFyE2F4lFa0++tuakGZ5R+EhPYoSKtksrHdrUgZjamhpgulowauxqjXi9+K8W36XUIhHVmmpPEj3ev1/dCFjVgLq3ZfB3hR2szc2xnp4FkR6FlTqylEe7GJ+tGAeHsLAGNqObN+K74VS1v1W5Mb9UQsXRfhYRRTCntjzQvNIY/HwzqXwCy9A03f+grqFY6odgDjr8e8RRbD3StPK9iGYTPgBPuWi4bxtQ0zIXVAiknJrofhUhoqCByke6MH5c2rrUvwan1//14cJSQl2LYVTtLZRlj7BVLPKQ1PTrxQlOjCKg1Hiao51JjAZjapLpbZ+qq2YC5XTWRVr3tVumKmeAwR0v1ybBfGuSn1A9quYJAzeUEg0qj9rlPUQvvUfQuQM23oDg3qy/hQMbG8Z9ve4eecG2Wy0qKc5Oz27e6cbamUMdQudZQppueJinXEFAjVTZKKdOxfbV3+P0aNR8B01YFHdvb5f5LmnD2zkaf7BYcp6ZC2ZBHxPCNsfbfy7ijrV24yjAlD989aItPdZjbi92eua4V11H2WPqTv5TnN4qg9Kve6iiczMynjUqu93zt0ZFXcB1q1XPIFuc8si7y6I96j+45nbPjGqmirztoJDEWed+/DrboLs1be2wVQ3q7oA5H1/6xyehGzIdYM0myokkCoGVmetQ0aImgQDSuBeUZerrMJwHTaAyf6677d//yC8GWgEo4kwCxhc186ObUnluJmd+J6R4DoO4S7oYr1sb3UWa19XEJHj9BzbIOKUatICTq/VDdRzPn5+bD3qjB5u2+P944NR6AdjhwX8Er/ip6FtvtTmEeQb3YVcpx4VMysqH5fXqQQ/i0ATb9A1H6JRb0rtac8G8DnglSuuvXZIrAvjL97/1E9+U5NiQjVbUfvmue87E8YKtu6S6KW1oSLbdK/3M+4OEgiVQqWhmL5Nd1SEiw4GK3eOFOmBsFtdm4VgQLYy2ygdPgiEivAaWOcyjPLeLcAhKWTKKCHSzaueebUeIXPDKrwloA4VzvvMQHZ9vWU5B69fnYP9jms6F25PCgDSJ2JL0ynx/mAoddhKbNmxyNltUAxEUTMdEceZ0cY8bdSKDKBNj93XL1oW/XyUnN5Cewco9i4jrK23SLQLPSk0+Op9ivKz955uHRiHQunK/fM5GQzjAgxeWBfGCVu6NZM4YR5AKgE/GEMq++bF0+RxMu4e2+NW/B6X/lRf1K4/h8QoV+MHIZjvExRDiP11FZ3MA17FEohqEKa/XXj72tThxLryUb1IHhMIIR48bWUyZv9Sh2wZHW4JlEAI1BF/kwbse+uSgxi1ZORRG+C3D4y7hZHpNgqq7mmizOGUPrChAJYzLfx9dz8FbazuSXEvKI6Np6tI8IsAQn6BOFUgDYHEqWBN51XrT6Gye0NEnDGsiczsCH6Tjsx3H7y/XfybrFaUlgY0IZgOaHIKdGrbzmXffFYPNJ5CX95BtFw8nypwwZa8CSteRAT2XtlwxUhWJEHiAp96SWQQj6oCAy94rDZ14S8lS9ZGAYDB/+1szvdz0R+MJrTYAId6gb6B76J3gdNtAl/bejxIsrBNppBApDKpsL7Y3sF7oWQ5VOGx9KJ27RdE0h0TQkXrHQnER/ecWCBv0953IEXBTREuEAo776pLU6FQaSSDpVdVq5TgCHQ+AVEfMExceefxSSt5vgilAaVESDUBJO/c7tKZzAiY2m2HaGQ1g3GC98rMjPsS9wOZG5jE6pc2cAxauzMkXMhzNV/8kwYUBw1xEk5SUJAzgaLBI1eNVc6FlkxLcXj4nEpmowqK+lq0QpcQCdcAiO6ywhOdNsbzG4Fk5C6sSWari4Wu3/u4WARfeTM+93BLxovFg//0rEKYS7L1H1Rw2xToxgPBhWuyxkYtrrAUTwApxaokek1pNRKoRuL7VmF8sTG5tz+VBoiwvejY2WOvg0yK1SO3tzYG82EWtSDKHVxKXqIyCBqoQxTifkRik7sx8vkIr1V5zHsksRa3xg/UoZyMLrSugh1vYnt2Xv/IlSGUg3wH2Fim0XUMKHY+xc3uLBxJvkSWS9eAW+W8lLF1pE5ePytYHZ1i9kzRDdGGy++hIgNJqYBkQ9iADyGn7/OOxLjXMJiWZ7DnbUPXJNDv5WENGm/YWzlqjRz2LHvcRKxd4ZGwVx27HCx/H3WDKUZWcT4SC+fSh0POaUPW1uHCyIhEeoc/QHalxIsSyY5Xtr7v5CVPgcJV8IYyk15oyZXWTHVTfzZbWUpwxEOseskLQBQpx29n3R6vALUBKd21MZvLM5cLtjCiDy1yZFXL1MiIkUyBYqMsZOUmwXQgupcU3TM693UODCuSgY5pTYYRve/j53th8AgkA6HX9y898Cb3KiRXufAyeK44HIqu6LYBHh/z39DPLntTaDfmbG+L4r0y8JXvTNYiSI4NsPfRCF8w0+Ay2WUCKwRLGfvCBJFYE6pneQQ/hOAPsrB811Twt9gYQhbD9DywQWMKb0TtAdOerGLnLHtmeoaeA8CH+WvmTZ9JzKkVGzhvcNA/kwxDNfyaCKee0wbADkO6RkUkdnf9X88x7XKCcAzngDm3jTi1UT2qSNvm0II4WUFOxglFE9jrsSYi5QHmtjAWcioEznMFm7xT7Hfn33QeEIY8Xlvo3qRCFH99mmvySDsDjYWeV0HnvLnNemo+sJUbozIUebAmd6as6sdSc9VurSxp2lcqr5jCxhjysMLz6Jgvx/OjlIa36a3Wsxw7VWi+bBAsshvEqnF67HQ5dfIYRXTGLh/UCNDUVYRDCqwzQhq5cdtGV2K5p+6fk3usi7P9upOKimTdD7/vQv7Len6HG+PzhkfAftjjJ5jnE/yzDc+wi3udAPJUMTiGML/ZGf/g13lvsRP+eiS1duMPkLnK40NjFbEnhtVYzny9W1+oYhpdrvNMb7i4ASo6GHJKjIXe4R6gwTRpN/dkVZcEtLg3hYIB/fkOZcTYWM6JlHlfT6e5yxbs7QKHMnHQvRDn18Veqc9GcX+c3G19sGOBQdYnoKSx8DK56sqjiTNEW7bFibeywIcsv3soiA1A4VApFPcrj/9dJ7ONERrTMC46iMX9+blVgMD5O3lWaS5a4Ucm5TMn7rU2/WUaOeTO09rRfIDuNbUrr7CmTuPshETpXgFsNev7A0R6+/6jo+YHICC+Z5z34LYh7Fm7MWre2vveOFXGiDAev1AX7guAu7uCbdc9EOFlyLgdPOr+Xq9wcW/2Mew7PsdnsEfD8LkmXGuT4UHv5JkF3ct6/H3zQDaEFnmRlg7T68Ta4TDictJPlqCqc58sw6n3/mQVYsjpqbz0tBlP1tsNFPGJpONemOgQBA4xfJkgtL4wwad8gLiPSgIbJZhVUn963/j7LhmtrHenAXYMFWvy4oAx5+3RYipKWuVmIAtrUpKQDaIAd+hGtFWonzsnVOn3RCSApwzRyerlfFECP6ED+OqXNwELqnoSzZnf99ohx0AeTZVKybBhI4hA1Fkhlvs8ivJJegNnGViwm/2d63fs0SCkZ3u43qOByTIsXOvR4MEuQ975ga9SApKBs40hN6ztGSRj6U1Ix1YzanMOxo6tlX5nbFAo2eSeG+gefua1EHXgDkG72OMRRApwZNB8nRP0tEdgeT7ZFIuGftwrD9zYIqPBw55DMq5gr62Ahbj+69kv7mGd/kt+1MrvDnhe7w8UcLAagoDIlsRz/XfnlRzF1/qKlo01YZCcW/g8Z6IMld4BW3uAZJh6Z4/G1SrG4XftdcI6ey0xmlsji85o/jAYVzVOvd+N169WcwLu/2VI3PDMLnSljMPJInaaQ55bc/fVGGDZratzWkKT3XNo/vHdX+1v7IxG9sz1WKhJZ8YGo1h4WovHoj2ymqvxJpnsjVGlDJ3390vPCWRIY0vTFRU43yOFnbJGBXLdiXJqo9R2URAEEZoo0I+smF5libca/tv7kUymbbAFKwKQBtJqlH/sU/86Kp4MK1qkqOCKgRl0RoroTKHjcG0xKCupALqolKV+dmRjGOhkVE3/ACm16jTGTvbxHLnY3NTU7mxIe/cMgNNhuSuDaumh3+2Tmn5MEETKgG8xO9A7mJrgIUyZeYpvAmnJPvDxi1OWNaIXZdvf2m+2yCIx5OIlqVRLOKxeb49l+dw/Ki0IhRksUdtg6p4UnhoHgmn8XkfKlf5+77utMI8nODzWJ+Vu4XExzJOUUBx3WNXXWkOOkFu8hgWdu38twOU0T899kJXRdzuF+f1cvsqBF2sbJ4SWNrlZmJSjsnq7vNyn2XHxOzvCqXJ3fAV2fd/9ri8cLo3TeTzCmIJY406Re5gb/1joziG8d+3pnhBrzZ/tdwZaYyK8wzh2tc/Dfufvn3+7MupUxIfukVDKPYuRFRyLeG4yBDICC1owdoMMCG2dn/OKUNMXDM+6V7Mh/Vm/zw33BD4lKkAOGbtvEBoXSOnullCcc04DhtGmDGiQvqP2z3X7v1HbwLzrVOO7f62ZPQ4PoZKAz+DPglrQQvysL6rJ68ozPwCnHb//LWyZoojNl1FfarV7fSgVSffujm+XtUETUIZI/douZOcC2BhwTNX5qutKBO9K6rjEtHIfc7avwu9TugP/1//7//P/rZI+aWa2ZtUBWxdQufXz0Zs9jOHlUjLtJYXoY9iotbdUFQFOKYupOET8LhumdqYJnm9Xf+M6Qt4Jj/TbrgjmhjBkSuX4ZLHboU/olDLofn8PIHm7Fj9xut+kt27eCZf3PM2fmV3lU6fisunefrFBcfH80zjPs/HbbX6Z427e7bCupyKzW0IeG/59c92vexo/3ut/Oi/++xrYj/v91+9oLR3/OPwJ/wL/cJ5+PQ//0zr+kSUZrb1oUW4FHC1XjxCKZua+Nm205fanbJWu17Jk98RdFI3HykUoK3Vbl/7G6E6tb9Xi44aE/A69MHuNkuQ2xfnjucsWbh2zvfVteQ6QLOx6T56X5A+na96xddbza7W6yCpAp/7Z0lYIV8o6ZzQvVZUPkSIXmd0ikHmcE2mbkaXsnYuhFF5XuT5BeAVGTZvSZvy/ZefCqZsq45NAm4y4DoALl0a/XYxFYUl6DbseOykm5d51MtyS4axBmOt18jkNaSMmwhG6/PS7Xwq7b7pMpjorTlN15+lkqNwQG6nxr0vlDZ/txNN9pjn/tTvixgGIVzBQwg3D4/vjv0A5DVm4rQa4EzYEESsZYtHoCR3+QlNI3rZuMjY27LAZbYwebEOHNpT31rqeK5QISswDqvi4mm80XZYIlMwqvCg3DDTIs3XPH/EXpnNw6C9vmVHNCiYFC3lW3qWIdQkFMZ2zVYtHAXEt/oe/j5/hTrhhEN4nQW4HL7Y7N4wP0UZ/fBbaU/uYXwheDMqg87R+IRnrFPFNhOA3BYArMjLV532KsGEwcE4KdZJheX79+K4Qingwzo8CRa0FbM4B4LCGKu7vdo723Bg9k+NwE5V797/fz4eJdAsO48UfgBtr+RRSUQvrh1DTKbR53wurN+NqrMzTRoK20nFjrf/akzltupuQcNmY/nuY0y4s7Nte1+5Z03pNAupkbdwyEs7pC/zkDU9pjCk0iPO1J9CZkdLVGyV5owQP/d/AxRw77vb+2PL3D9GH18w+nJ+pd9wu5kvJkhMrqf1osNjN3vfbPu85onDZLijJqS71wKn4Faf0iFKUXdRjDcp2Xegw/LhPl911tf2LQcoL/UsKT/3Wu33/Z7LrySByxjehwY7IYumJZwpsvl5geFcUpe6s3Rgg5MCEAg8kb3AoOrnOX3fGISG5+bpQsgE7wdPYUA84F9QMm5vD/Byip3nzlo9BrQcqrOkUzvUGP8Hj2bgFsIkwr5zzg50BeExATqMSbbT7Ec3cWy0o4nlsq3pP50F11V1EdRVcLthjGzzugjtvlFcLglPCEndodHEv1vMBjt4YI2sKuGATXaR+K6B/CfGK1KMLkKlizEjlil3nFOu7XEYlOZ3qCZLbL+R6rr36Fpu/EcVc5/WkgJfv39Xy9Vi8+EsaKpc05Yi0/5ejoLpjx8ffpPox02PMcym4Z8Dj643MnS7P88qRIiAXg6qoTUy9T/tzjxsGfFMA+iyLfGjChIdAjMOcivIO7tI1YlwpgKN7OB/o4AQrNDfOXaf063BoffVpWoUtr9IHo+MvBGzCWjfNuvWWJpNiXUZrx7wByMKdlTQE7aXkVXQdyY7CaPkQqgxARCyAUyCA5+CR+E8lMRlFRobEwyexCEGy66pTHA+NMV4OOoTh10EpeIFqdVnveKxm9oz/Ht/BhVGUcP55aQYv7TFQCx+F6fmGN95ew0CX1hRC7sT9aIILB010yyriqYJWBQ5ZQ6+cHEXHuGZmY6MEXLGNXv2/BGB1Cp45h6x632ROT40QeA05El6q4UEF7cgo8MWIhQGOrLCjMbIVWq4j+9xwGxd5EZ7fPXVMuw4KwRfy1JcYuxd2l0Ls4wR1T/h3mkHw/wgdE/Ztgnx+u9K4DVwvt0raV9ZpfVPx/p9K43L6fVnu2KgGUtmKQY8GQ+fvYy+vrLiSUAtwu7u3Z5lPYRlUiyq25KpCO48sd3itL7cBhfhBRtjjCwIZHhYfsmvUmsK7fd/vYoZNgcD7Ep//bEDptZMQ+MiQSIMK67DA92+FVU95tngIPBInSWpJb3DrTViaZh0mgHR+ExxJ5o3cv28ENDIVL7e+QOK3R9+JQKHYDuTnEIJi5h/aQhqGoJMCnAbi/t6AhT5hle8NbMRK+IjO/Y6oKYF3jQj58eXIAz8/h/K3rEenUXovAnG0lb535AcgjcOgtrLuA166vt9nRrsJjbdjvL6RvPw7044XFsdLXoijEW/noVlB/3vBVlTa8AtRUHr0ySEWCIhIMARcB7PFXALSCWIcbgm2AXV/K3yp4sxusYwAxBnG5PldCbURWBEw6fksXfcRqcjzY6n2KXwGWmpQFCTcZb8AfbzXC4CyVz8iH1ONFXjcpKKQEBVj6yzIEP3omsSmJJAYN3gRMHXEBdAsZH39vexvI18kC02EeyWAG9qis92AHK262iYYBaiwdl5T2j3twGTRRotqW3SrhEYYEqx2GWRrb/+bnE+QQeDcOI1k9ebTIzaSG4XIbCgcxAPNtfl7LO/qpwk6z5XqDwat1+Z6Xxo+LRmJELQO8dQUvLrXyXIx904h3YjwqEAHqsLy17PxhgoZFFl+3hfVo1L72rcXLIlJXGD4mQikyUCfxDo2MwbLhTC7kfjts/rmb7h2uFbv+0tf/JhiOrXCoCxM0rvNW9B78Ht6DHh+f7fE/bvkI9osdXxC3BkgA3J9v1sy6Q4mvS5IjeHNEvKb57eFWabG9q0Cv//1sM4epY09rpfnc+Ju/gKp63Ky9aCE8LjJSYQA2nndJ/eEVvcoTwgQIMZ8gqjtRjZqEhqiio9ppqumZpzQGaOihwuSXIKZfv8OBpNHtMjHgCFgHRPQGxKdUQAktXUDbBwG6OmE7EfQHRx+KetuHyhgykk06GNOCvaLdpLi6jkwHiy7DiQmWCjok4a5wyBXvT+GH/eqZTHFK8AwVsX/pfvtHesp4btDL+5d0UsTUU1MNKxgB8CZlwt5o9y4mNc49/7G4YEYP860XLsaNDspsiMizenmW/3O2/fz9ThDLyzrfnc4UGbFxd+c4EnjZA81zy0g4uchGOT4ToV/5mjX3KDpVqhdIuTRootxRcOgcLUaDP/l77ygvSN5Rc+9wzoXdVjUdGprwFDzAP3cNj+LNNoMsMHX68oG1DPRPiGZEZQk2nubS3rR1tRsA6VLACDkySALW9xRIKZfM95juAZFMTNyPMpbg/7VwESLYPygLpNy4m9LBIiSQ1x7we0KOw+Eto0h+d1hHXf+CokVjCau5ftgZMH3s5VNeRdxYMVDwfDdzgaMMfENdF2RnL88pDZPXJ6FAv2sUA9rdJsMkD8YlotKygYyCU11zsgbak0svAnStiD7DcOO4iZ1R6XeQ5+8jMUAHOpg0ozHXwhhiZQ8bIqw8uILPtoRDMNrfNWbOT4lnnHYhWBAeS60cJOVg0n4QSRrYwwGeR68SxK7JapAWR2NvgsBYhwQdI4rGbt5r6HjuRVFLR2HKDpC9+f+qzlnB65rSVBvptuavkUXTmcIyYgLMtdrcY2fxmUVyqzbzyh0iTCV90mFKuqcoSniFLzfhY9W8NOaKuSxyn8ey6uBofgKXsMljWxL9JQwDZXnTeEWz1GDcBPnlKlbDRT/swbvwpMO3ttNcZGLNXLs+xSjTNCIKlloojAn6QdvIKxJX7RuuFWOdRMFUmyEpmpbwQwXz1OaJ8+84R80UattdSXKbJPi17Lp+eMPBkem65W6QZf6JvkujGaL0TtB1JLmBIcKIa6AKmNGkLNhjA9F7OI1QZUVsOoMpEQnWlddyRwXupejTIUjWupzJPkaoh85PcTPVhXd8R7RThKLkIxMD0nVwjz4zYesPL9g4aCKRCxcF8690wFPsPfYTlfppABjxuh1biU2ctFCsm3edBayXDu1CzpkIapc11BiXYrGUj4OVS/zQFZ21njvvC0vK0ZEKDcTBHosLog0ziVcBMU/JPZZ2zkBOv6onSbFDo1kh6gdC8hOtic8VktVwW9OyCEKLr+fUVtQdUSRozNlE4e1ZjmJSSlVHoQnaDTZVHywvZwLZGVNlMiOoIogzgrxVW1/ASkgV2LArnTEG1Ss8qxth7HC29219LOB8gSMSoeJoFvwqH8ceezcKgZU+FpQLg9ETGkIajIWu6DtrLzWO8b2/N836+WyKGnu8V4cqdUWB05IWtYD0bRexhDWGumAbaIkRg1EsKGuPHtV7GfkVEDPFYSSLhaeD8VasJmOmXrsuaCypa61/popNz6t5U0Le/xwiQBNNDhXcCQk5a9YC650jjjcbxpazHUwxsEBDrXGyS8I/OtLbGEPQU0z0U1ic2U+F9y5cnqb61xcj8GLUPZDd745AFLAnyDjTKmrhYsCk+3OTrMAjPJBNuW6mmhTwQCt2B8ZCdVlEgJJT9ZNBeN5fY9+KCoUeHKcSfbgAlPkXbswRjTEbW8wPhgzJbsmuKns2e8rd3V95sD3bxG6c6zX7TAxLlbuA0z6yafls+VdADDIoze7qs5udORVV0iUqV6D0mG/e+nkIsfgiiD2zczGX/6FAy2iWR3xmPq3Cpy5EMze4V6Ldio30yQQIkrkHDVE7WkuKaUGqvVpS1NKNxSC6e+73uKmzzh5vyb7kKHuARcRa2XpoUYHGfO4sLEeeljBrXdeDHjZk7RYUbk22iDWsmAU6IxSltWqmwG7QyR5yt6lSr5L1P2by8PCTK0coMotOHZ/+m0AACAASURBVM+018xNoZTgzoKttqyU+qXqfpimCfYa8CJiWFcSGL47FIShzZUE+W/vDfRO8fEZhXa0o1M7dWDUEsZS56PfAwPaYokyuzC4nAJAqEUBzfs/nSr4FmemvVQKPpd5iDr818HsNuSQfD+XMOqryLyS/KP1j87tLgzxQtyTun9UtjeNiwrKeUyo5bN5/+RiSzEvbvQLNE47O3zdHswyR7UPr3zWke20LafQnKNc6ltjTcVx+EMmdKSUEybI1kauJDZZQeGOlS3LNrcRQD1SPzsajx4VedLUdw3ONivs1Xi6y0221plIW0oo3c6zFde3UQyt1IpSjLzQqZShg4oMytVz6Pud+9gg6xQ58i7C7jpi0DJ6qRQk7UtHhQwWXAwotcEeopLCC034EFx6w+1kEKxbnut2RS87UqRflaVwud4WkNKLiUEsRwpkhA4H7A6X0KHyHrXYadGw2hm4sUuWXkdhtD+H6Eum9XIUc84pf+Sv9lDHgnsMslcrKuwtdytkxfvAROcegEXXOo15yQhYLNHsCzZ7nEovhZAomY88VoSR5Ds65UKEORU+qU/mFYpliQQT1uR2+Ff+GjCvsg0G9n9UxBmfVkfPPTWLG4OpdRWvOdZxBboshVXrgmMMW79/7uMpVfFvK2xKKbmnTiFIxw1hf9YOnC8ZkIUt46KWCGIDepkI0yB/DTbQTu9woSzq9qQWPzeIlEdVzPz7/KRcuPrUFLsAvuHe77qUWRjUdKPL62KaB6V3fYAUlaku8rhQ06mcSqXyekqLxNVBSdvLcY4epKjTQT4G/6F6PuxVhfGEKvPYJKUOBEVqmA72ERQYUlrvWmVxoVJ4PnhZNXgWcCuiYoJq54LmWehqoIyNHP+y1nuwTWvYEvBCvwMw4hk4eU0lgyB7Dql18mFG33t0Rxj2nlhiJ3UcrV/5RU1yuQwkqmkUOdY1ObLwRGNu6DIGT7s0KvZqQnjq66jqR6Nc6k6HLsoKUjFo/jZ+Y1eIqrCuSU85WkvqFhVJisu8jg2g3Ugg4lO8F7zsDdZyGFBHuzlvYpLN+7NpAtOdQMkpQAfJjBBJsLelV77HH/Vb86N6jPccfkxBLdlxrF+0HiTIFh0OcFDosjzzCUYgbWlvNoun7a8tbgyQoF42GdviXa+7yzurbm2jsFJeNeVZuGWVQvZj+Jy9DZSwUrd2umZEb/EJv3oFW12PIL7VknEGtMcqeind348HOgMMezLX8n7sBXbt0fck1LIXVYzbiNBgLp/Eo8zKUDXoMBRPNiJrn76L8Rl5qAnWB7JRUvRxoEEmgIALQpvO5ndC2b9aic4YBT2mvWvTPaSPe7laVTCkwurmz0hWutg5In4lnbb4bG/iAB5cDRfn0ovv7VXZgCXDicTKjobMQKTjOhIzGSnqPlG+Cex/nzg0bjgHupTXFBu6Yfqzi7k1K2RA4GKDGNb0b6z6i/5kG+cZ375zhxO8BuC5sjLK3jex9ekf99zrnOC9HhQLf5C4njRkOT45RZn+7eG+sVLd/U3dfMfhdsvYFVKEwQt5Jy7iNaR6iZXSork24eun5+TfhokTwaM49v3OeNbge/ag7ewH56oAU58CWdz18c7rp//fX1IFL10eeKqtS4o4/n7Xw/qeT3j5TazapvkOmBWuzARGicN3niPuepy7AHC2gWqe961ranXdUPd32avs80N6FrbLhV8c1Xw/vJ9nTY4Yp0/nzuK7fErj0rz5k1wO++SDM/vijaW9XlVKGLPvPeBpTj5ThrAOvJd28BCvLIHDPc3rnoI4BxBrtZ5zHNaXA74BU/eBHrE870n2rbQeZezPGUErXzycw84teeYgdi985gMxy/E9F/tcfs4gbMVrGoNGmQvPOf/g8eJbD0Vy+JMvDXP6DraJBlRFKjlkQBhJPP9I+YAj46CW6dQx9OSdXNQ+hT0PCN8jfE57K8m9dG7w5hzdSBeC9Fc8Qyx73De3DISMwR/lxJ0qaRU/MGqs5oUQ5JqjmEyknnzEdsHYQhIqehYlPGNrCUDY3yEOjaKcRFVdCFwiGyiIsMSdS9NFJfOGRsJt+A8xSFAxeAlOM88NOzKwHi0lbMS4NjqEuMvB12sAElxjtHhFLUjEZUE8CGEdK248UoIcrtYjrtdHcC+jaw17rdY+SAiHA0Vo6FRfQjINB3Al5wWUIvIUPpL1D/zcqPBeVCSvEUoPxrJ7bgl6v9sjW9EIklYD79UMwo4Iku/4zmcIUnwVxqLWwGCsvZF7iwJMzjloXj7BnRUScmjKmVVIym3ZQrgHn6U072Q85me3EWFuca73poCO05kM5fwfowU1EBTXMDkAVimUSzvk9xoX8qCcuVrEwfs+AhY64w0FvVDSvIh7IZ5bNljjvoaAsvACmrflwGNcNGcrOTN0nhoueq5iRkl3hPtFNshFMut9Jo190R6wtd8DSkbpwGB6J6V/3nlaX5nusogE9kde0CJ3FOrQmkXY4wxozFDW3KPC31kpBU2xuQLE4EWAaQJ5oe00o4pXZjnUOgzUAllZRVg0cwJDeKcXKsYleRUyYwgYK72AlfCGzniyqe8kAPuAIi+xVzUmbsFrV+0daqZlkCx16BRYDwOi2LnFKb7D07TPaV8XfVScHGWD8PU+qZcwIGFCI3+J1LEXxhqkqICw5MGG4GTcKi/kJgQphA6UkpsMKGHoFOUo/+fl2jbM2cx16NvHCRxFjS/Omdd5dv8hhKvu2f2mW7fu7zFUDNm+3I8XTdK63ispsi5MXyIHUQkLGefCKFH7Lvbsrrg+aPHnqjzoHL4S9fdxztvzIYyHiVUKg3IXJ0NACes5k0ZQcFqMDdi/lULNyToliwty8/hY0FpKJMlryp5MTf06bzxVUmgRhAIyrdrnWxwuLagGnS4BNalN4iHVvl1oX7Kki6rAhFyE+L4Fs+lI562W1buwONoGf0gvrM/pey63ZC5l1wcmhQDfBloa54m6l+atwhgrhLDQGsCQptPcGA4N3IQ052SA6eSllZ5O9zMyoImWhKxbdQhLtHk6U0tOKaDV5BhjGPCUq7ShyvxExWuH352Utg1pviYSOh43pYS4Bt2b597mbe08XjtRXduc1jum/+zHdZmuvR3XiYbxZswKZLYrKrTD/Lec2l73yM2Y7JDjX+Na5hOPQ33DRgJ88p7RuxdhQhe3gSF2a6RHue3EYK2+/CSkLBQrSQszWW65tG0FCyKOYT3PRwGhrQnE9FzCnjXd2/wWxXSejQgbPeOLEUejJJY80FB857kE7TNPnipSMtygiwrfQA5KpUS1qFJtRhEiyXNTcN9X7aWlSgYjVAkvGOVo18WEi8311qEwCZ7fGTz+mPP0RtBW7e3UM8IwgYlNEShchDFxmdYdnowiE/XL8Z1AoaPn0yXKQKsT+GBDOmWBlADPzJH1O6aug2BCfj7/z0ehapXLnfYkjLjpkfjW928iOJuLnHM915ESNp3JQP1itgpHfCThQp2bMMZVvWkUGkBB7YrRCCIQusSnsWFfwhgTGCLPW1WAe4zZ+MvX+jsn8bn7HghrwaUl9rLPbpZaJIK3us5IY+tB6HYG5D+H3J8oTA1eKBIzaRwSoxHRPDbrw620k60vMEd8N0S6PxgnmVCOifTCmv6VaLSLhhhTbXcSmqQmLpwmflauTb+rSIH3LRMu65ZLxbdxs4anLgBI/jUvqtRE/atqOHquXODSmic9Viv+VVuLJg15RglRvFhnStukbGSZ6MCov4esoNl/QY79A1KCPM9gBatawGKtOErHOFvQK//2Ld7jtqiiBq3jmfNgzOR9u0RaWlVyLxMtVF4NGYztlGx46VPiTdFj38KUMaeQ4DqyAecZDJDm7WmbRQqJeYkrvZ0doSxAZ7lJeGPVxmFUDzxjeOF9DjFsll0sQSslY2nAOrBMp43SNqmQk40MgsbghDKCmOZVQ21+3xUesC8yo+n+nGh20++3UgwcewNDrIcM2cvOQv7SgyBeURk/f36eF6lyVaaJ213r2F5WVIKI/rAasJHGxF/BKDBdHvX5rcIeMVvBEQ680ebuX55GL0bJzEpLhhYq6V7cH+l+K+2/v1LYgYIlTMUN4YgX7OlcePa9wiuvA6PlBq4UFI4YE8hyKNAaGciI06b+TQsL5zrFM2KAGJn7BDU9OClojlijrSAUEdr/mi6EyMdTcb/zBo8M1KF5A/l0bj8x0lmISDhcpCu9LOR3aJG/R/GfwJYL8KPHC+ModETZaniGHi8BrwsrECyJ6wrHeoK+yoJVO0TUP5KH7tCE9GpFRWUtf4kZLiiBTy4iEhQh/wZWKTp8F+iH9O/HPQclUFZgUjetGHMtmhf6CnH2DL5rUItM4v33jDW03zICqDWJnVSNTTxHTzyFeXdY2IVsGqDKQsI6pPPuhecSCwU5NfHkhWciNCQUGD4GmIugUwsFTj/DORAunAndYJl0tqY4dJUBoFFFUXLeCRwK1cjocureRnASg2cuyqP35XsvMdaIsZHu5ZU9VEgNTAYlK3H0VRvf32LgIuG5RS2q/QskiS60kjFve2J1cv+SCdbgUJ3wDhglgMK8zwIy38m6y/f5w2uiUuRvOMk0fKcJ0hV0fAApRzvniPpqYrKJgvX4f7jM43wsuHDt2jC/b3hsBWv39U52ATdoPTwUcqucmKoGqOucA/51HUTzGgsSNAI27bfX5XS5Ri83QFcT5A0ZYjHzKza9Uw8yzCp4yqrpWcBSzeASWMFdkReHVwWvTWFGrpJ3JnUr46NzaWb2fwTDc6GWHbQRy7g2T+cOOwlCWSf3quk8ec/kEgShCuHSspJfBJG9hGx5uktGnjIRSRh5MVj2IGzfptym6FvXMjQ6BqtLvSdGMCv5gkKgGowjSdqpQaozmukp1w9d2uDQZ6NFHL2tRWj2rCyTUdwN0GG49BuhK4SBVu/j9NwGRfX5ewV283Izb4yjt3bnryG5iYXXsoKzWCvS2hqLXVzmRPLffi7iKHJv4C1HV2CyrGeq4aKKKadkTdGGLrbR1uBk0SlLkkNrEaUtzwsUtjZ8OEQC+lZalKd5roYRCvGUHw8uZHhFsUmTy4ce6awdPIaX8mm+2IXy4d7eTJZXJWGURZNjc4pJeGNwq4VCS0bVMqqqeqOWj5xD+IqQKpzFifRK3lPNoeJEn97Zzspp+t6F0zDKQKPGpxIWrPcCrK14B4Z3Kt5t1VRY2QngDh78MEdIseLLOVX1ziJihmipDwolvbjX0pjYsZSMG69Jf8VwL0MTjVG468OcnEkKY4Hyc9DocTGclEBe0R10F5P7B42S9TAHdQoVkwlj1vIWDhaae+M+36Aq4ahsZ+vzprr0IOBawwR2pvzqKqn1u3hX7H+sdm7G510lNAaD5ojGdSEscC8ULgyEs6dxM/8D2+PbzjmhfnV7dmWP8zi2bt/4QHGDIT11q9Bu1uv2vESUxdPapH3ndV/5YW/wGfl1v6INH88yw/MROe5pTt3hH87Kv6yjMkRuCs46GWWkV/t9gfF8ncalgIFUd5Q3E1K6B3Rnj4wyF3x2QebTWZOt7oEEUiueCuXGJbg++o3lzMCnQoH4i14lg3KYMeapMxKgReAII0SvikMrAUjK/OB5b1fxsIA4t6PJqe8xocBlVLuE9BXKR3OFdgDjsI1Axgu66LuMElcVaQK9UQhVEeAhzi+hXpE/mK6xHwXz9x8rgsdEPvQWSUsgKiJjD7/lxNTCkK5N7+c618rz44x6aBlhqyAL5ph3gk+IaI1mZvhPzGEGyHHe82ap2s3SZ/Ga3OpaAVc8d2e2QjiihhFqmZG3oe7Jv4tALGl+0j0KyEfb5+zfwvjFntO37qltdftA1b0c8i/OnI6Ffc+6v2CP+W+1jt/n0zjK9xRwe8YU6v2+yJmhEyHWxrm7zQZOC8q10Rv3vTzMiwwIPuN40AmdOiS+QwW/zxsJ+D4nL+u7mO/v/Iv66p5qfyxenwzVd07eZyaExjiv4X0hnByEd804AfVze54d5kLtPWn4UY3jJ5f6+be77yMR5/L9Lm7O+m5xXVoME6OCpRXqR+g+KyzgbkF0L9E9hEJKPlN/tpGjosCOyeII2KAEXFS0VJ2z0fwiLO62ShJCFJUac3eirAJ6BNUSgg2e1EBGxfK3pFMWqtmndx+sxBpEM5CH1iMzKeAREzC5aNrKMZbvpzl+lbkJdL0wnhd1jAyg+G+LhtW3oD6BlQR0LEaF4/tI8I+PxbceBb92v2Q1Avi9+ZkCka/8zhKMK4IfgDFsKwBjFEQpVa+CEePUGQKG0G9YI4u4F2IuI7HZBAqUgFI+Z8UXg6a875mgJR2doYgHIZb2vCcG4mL8RNjmbKDhMP6MVP8I7WKg+Eav/cLiLp10RkJ6S0qUdfSjPEnppHcIijcqlpNnH++FkG2TkYvvA5KSp3k7jeH5gSujiT1csSie4KV9d0DTnBgZfKbW+Vv7GGyf9/aeSStfY87WWnutaR78ee+10KVp4zoFpb2iso9GVp4fTwbN98XN/3PkhonXuAMbjAC6SHs0lLr5V4a5qXn7fPZGqvxvrYVctB8mZrcPxKrG9bnLW2z29GgWbysJyM/UIZtEVnpM8c6e1x7kt51Fhg1fWRjwjyqDmXsyanZKCLG38wtD/kUzyC0Y3vaX7uJ45KI+e7gbb9ImBVwFmuPdEsXP299fSkVXptBJwu55W9XwGOXPU1jvKWIWklKoDHvAroeJ0ZzIF4fnj3AfhMu9NHV+i2nwcoDn5sWEzwCzQgFraTxGv8/0OQ4MgfalsAYQbUKXRKG6wTE/B0xXg1RbBEVlM2WQ4zNFTtUf9MR8T27s+7aafnVkOt/jenyx/V9F6mQo54ZRF4RE/B6By3PXkiC3fSUOgvB2Cw4v8x3Fj+cIMwrK+VeaZHgvbTCSI9ZgbuR349NYYbTAzWyP3nok7A7C5aZtLNQ6kdpQ7YLiyBRVRcx9WO5wrvOx+Q6N2kMTssLTiv46FAuy4fyVX+uhnPnqHVoXWCmor6h8peAeSrk2qafHCqAKysXpIk/GUjAMRuAn1A4KNP9dFM3g1MkC1Xz9JcWYWyIa1i8CiIhRUk/IsmIDgGeS4ajDNkRuPWFFmcdceyyjMq185Cibd7+DF0ezBhd0/UHs5YUoYIvAEGTKEigEym8Y2v/t8aTf7t9FmKB4xKPpaV/qV9VtXVkGax/5ssz77hQn5ba51NuqmmSsowuFSLUlHIAvRL3TXgU6UHydd0/zfJFvRZN3j4RSfl8F4k7ch1NumtEGKjukyloytUtXtKRpUiuZakR+WKYpVxVt67KOORJjXY8ifq1Ns0kupJFVzr8xu+56LrLInVrT8pxu3A80sE4rmMrRNEpnDnUdncxyE7TXuQ5I7V2MFSRoMBC9PVFcM7EldUUniRBZMYynWGqdsCyellRv9n6FU2MXwUd0GktnLf+dZyTutOddVgg2TnVttTDa5e/VNTjUQcm04l+J0ajq+9R1BWsLHQDO/e1BurAnRVW+z0cyjhWyL1IK9Q7RU0QSgK5DYUIpy0ZLVzRTedFfu9wYdAJo6EujEZV6+4nBS1ZRmzCuJkrLzmLW31UAEWsTl/9W+GRtDm8X2LswUO8Q5mrXg5kiP1XKvwq6ffBxLMbaOHxoe5k1PXWGhrotlKxqx4qxcFdk1gtN0SoV28pglb8w9vGn+qcOotb/P+19XZrrOqglyydT7Hn0eHqY/Xq/b6/7UImNECDkOIlTZT+cs6sqkSWEAPGzMGF1p6ZfenCvvj+80zbEwMd3yW5Np5JFWpcl/PwzKoRwsTCq7TUfLSKTyXPTWBM07GJvnDoPjD1mAD3Mi+bG2r6TfS8s0KsO26K8Fk9hM9UXfTtqL10al8KpnFjr3w3GDDRug8ai0BgNXUqNQ2dYmq6xz/49HeYE1mZ/LtZM8w5KZu+ioZ1FEn94RK1r0KKQt/B/iog3ybsijW9A44xeBgLFdWsgx9mWUODGwrzyLOZdGe4yA4W5OO4YSl49ITLOWl/i9afNMNIYo+zDTc/ViKiwdLxvDA3IfB6jW1a0l1X6D2OzrNGnhl/PcH4iOc787HnM3IfS3bFkpBzHmO2Oe1R/VQE9YYHbaMeWowkcfneyxLvGU7M9BDysEq8M0ibzde5TG8YVsb3NwuZWdCvI2rH0+iL8Dr/kkzBjdX3UOnq3ADHe3CJvKVqDx/f7SUK3qIkYHBgPi+9v3HiA6TEmfR+yVfzTYWsHxQqB/oFzW9eXNGJ7hy6Hhsb1SC5kXMTNVVrHhcg/actkobxOm3F5u79fW+bG8mbUX8azuMXBC1p6IOsOUWbpLFsTSlOWjAPu4aEFdtUSaMFHOBBg+nMWjStCKLR9KwRR3o7oFt6+HnRq3BMUwJb2Xh8aVYrlgn44dECgnJkoykV8RmXRuAwrOtG/v8em6vmGSR17p9vMzUmCUC09xdAi9W38o2lgvDB0rXLZengbQ1Mj+7k4VMYlueGstvMD+pu5/b2nHOE68pwblxXSCYZCA7R0b+JoZQQHgDpEy9/WeGnKrKXvLdOBP4lBpjQyrpFTPYJfp8zpIMu5N1XHc9ItyQEGEosECMd7ID22VtzESbzkElc2eXKp01t6HyKjxmlC68pNugqY3cVLLMjJRoBH4jeMTINWympNoC/rLQZEakhKYMiOjCH4NI/2bG09QtdwRGv03LBxxdKg8vlN6hAfwkyQY3Dj9RrDecqggTE1QhvBLREeyh8c5Dka5a2xNKXvTNxUYjy+q2noMGrTEM7kE9hEEK0Emr48MJebBBLWgtJ4aHGQwT47hhtGGAgOoyLxBtAroe07524oaI7FTYkBSxrkLiU0ultQcLht+1AEt2XvYLtnyWAvdPMTCdvu2i7bQaWge+50K3gP4IR08GG6Mlx/DxHsMwKeoFGEi+pFtlBiEKIAPVDDgXthKojTL8t14bK7sXVgU0ZRA75ClsHZMqAypOTdbT3Hom66uKDHx+kQMBPeyi4AXjNQSG+IL+jfZ8MOrqGOmjMSfrNSiPO+NHmHKtQgfYPQZqIBGiU9+UafB4LQpVkMGXjq3O9QDEwuY96ka3jcVGkEqTJx79UTsPYWVe2YdvSYwnY9zrooVXMmbFHpQ5d/U13RjrVxP5vWCls5FImm/pBbbjfpMT2i7q96HdK7dH6MJ939QFpgg7Uxmm3ItM31Uff8+H+TfMoW16GZxWOfmjk+9kpUVYu0map6rqLLX9UeLRu9VlcVmqgenXWyxar0JJneDxU2xMYLW0O5x5xpKxyg3Q0eMrTIT93yg18gTUl3360C3l1DN/gST32139ftVMgetKkpgfajG8iu2T+dFFR600YfFRxF52u70xaQ9iqmaP0QJrBn26qMx/tEVGYx2XeJMGdC7R2QNBl8vBP2rOj9U3TXfKmqZ9r9Vftvz4iWYcAgXLbeENjQh+38uMoj9o54C75wT8mN9XJf4KA078/e3SveAP0ZryOLoWeTlWBkAtoiLM3/sLwv5hzr36sa+65JYbfvWt6usgu9onzQVkX1m+8bj3EDGLLRfa3Uo1m7piEcem5QHG1mQaP4DT+qssMWMgJOQqGp4bV7iM7qMWf1UQVIdRrsebypIR7KE1bxNf4n+JND1urGKdg2qL9NvINtOt16iODbe4iuWirXDY2Sk84Ioe92N0EmhHFPU7bXoMuwNQI2pR3QVf9uaYwAMy/qfmxoCtfAtq+X3ltrnKC736MTCnaf4exfE6zpNJpRCGrNcO/q3Fo8PQ55Px+KobPXuljPj866NsN0scA0xrJG93c0+720ORvUpU3KPb82OF0NN2SIlY9s4MXwizaAXfogiMhG1xNN+6bTKPwbjC2SdFJAO/42hoybcX33Q7gGa3t2fsDCFjSGl83IfvgYwr136AM/BNMJaB1kQUvDFWqg+ay+s1o/DZDnPa2AHR7Iebz3jUFqCxrhZKYYPmEg0xt6oykaZLP/9sxrg8kxbmH4aWnHbuZt/2b2F568W6xMXuDLRLs3JqMA9HVCa3j7jdM3/bN0F16YcexecatGb+TjYvTHuieN0YCWH26m45TDgE2nVsQIhzZ/IL7AKLeXOJ22XGMCsIkfquYPVMwNCWKxnaULCJ08AideY2NmNtauBQXux1/T7oc2GkvExLK7eCAQxWk3l9O9gJ9e+ARt4fhDWNKPi2sgCg857vGuLga+AmH4SUQ2IV9nFTeZrextty0eiCb4rr+zAGtRd3/nBRoa8wdYq0HG1Ehu6GPDnUDT+2PWxx6y11UoGkuEbAFAKGHeRifYFPJmXzBCJ8Zt8z7MO7Z9xIr0pN3LTYIH29h7E9agk12+tM193PyD9W+Ktkhye4A2NSjYP4OU3ucwOSGmMKvaem3YAvRQnX8Y3tHtNEjH+Akw/7fciI2fNlnLxlv0Lwhd2NASTYfJZg9bOQciyfdwstrNEUCfm9ACEbkywObioK/NJJy8A8Z5V4q2tMVd2xiAshXR6Chl5EBE/iljs8kjUQBHrU0cy/iG343cs3nxCq6jqar3cm80lgXdedw2dApkWe8mDu4l90CXdUifXIKk3WoJB9/YefDyEKTtCCfI8xS85hONEIBDCiSxNBtvg/ICPeblxcipzgPyMk49j65bmhFGi70NL9IDRoSeG/GJk+SChLGvQh5Jl+Q0qE7xyt0XdDlYfVe0KGM7yHGwY+gcBY39jlEzKPMzEGQ+G18KgmxPeNUqbPkC7O4xzXqa3B/xPyNBhzo/gUfyqgrPOOxAnoL8g/v4/2C64em7NNcjtMWk6cR2raK19IjkVhQPNntlk8hsLglQOwuR7Nqcnmg+/1+WwyN+pQDZGzbI9p4tbYmByGDLS1pZdjkVbAxNhsaZSswEfLp28+WacY8mUdDZU+sAWRy6LmKSDBHkCU32zBDTftrmJjjBvU6XSNZ0rLmo3cziRsrXEi5RpqmQiJQxZdikwjvIcEpo4kSLwMXG4dOZeQAAIABJREFUVrC6rYJHm+cKflM+sgQ09tpqBgYRRgoZvYCiDAS0yLgxyKiTXpT0UigjcxPyklbLGp9f6He8gwSWQIF+MujbAxTmOTA4SwZS9A4vmTZqjhVlJdNXanDqwDHLL8x5qANois6dkQVLdIZsOJCDbOukfC2jcdr+u1p22H6+L0jyqg2a66+My3m9REqvdHIJZBwC41a3SF6cZOogsNT8Lt0/8xOcSG+2f/Q9K0BywZWgJNPzRjT0hHtGA2OT6UUXidFp5QcGsgxBK2YFe3vPAXAQ7zKL3rPms65OFeE2W6vt9TYOmNuuh0tRyXnKeWzF0RXa3mHFQFEiyEuodhV0jC2MupxV9r/SATGba6Xj3kgod3/DnOAt3lDFq5GPupqNcA8idDEv7FShowzOqNdZr+rpsUJ3kdnvU2TyjM0qTykowBGmwmhvRnLQeC2Gho/l9SWhVIoO15d/oGK8VM5ExbAZyc9YbjDs+Cgy1ZGVHPG81Dp8ZvI+qDQpdaf1/42pbqZVw7N6fpxfUm5YlkVI5hZJE2L1GAsNhO7WrahHEHTSgQ2ErxEmXQptC//6COSQXUqpyr/VXRr0dx0ISz2W6ndi0it1AEkeGRmLgfftD6/uqWDUDL0SJtW3yElj7o1tmDFburGLt23BIQ8u2YaO254Idn/6lGV/rhEcsmrO2PCGzpftBfeWrkt371V3NTW3LoNGLPzyAyaZjPqvo+EHjdfd0qRN+dKd1OyZ8FPV0aVM+2nU/jl3UpjVO9m8Y1uv/b2CYGXbf0LolLY0sqBFF23H7+Gve3hwnXJOl99b3qVZo52fB2mO7jvhrbR5531uiz3HNb7XZx5G1mhe7WXeT3+bR/CXNPT6J+5+t3xDI2O8nik9XX/ehQa+3Ar5bT/afihodQX0WW3fKYnsaGV9fxbQ8VXPR3Ztnm7qL0QrtLeldwdzQ7O3vpxs9ao0ukPLtZ9/L2ZvrByxcPhi6bQaXKtu+kECFAc2tj98PkO1ELo/aa5bXqW4LTScm1bgOmbT6M+Df/WIoIVIbN0hRFryehFY5UoFe9wLrNbaq1t9CPASNHMtqFqAvcEEMLx1b+vs0dnbfRYldNhjOum+BIg9GxGMs20zu8Ek94bnNofeMLEdDS3Ecw/LbKGMxVHysWC3UKjtfCg9VKqFHdZnxKdNGtwiu3lo5dKfjcZwYXvGF2eftv3fBLncz3oEY63/Bpcn9fyAjI8zeOmI38XwfiRzPPjo3KPTjAc6Z641ksQ0B+tpu/GFJyMf50q9Fx5/6D3xZAFMKHJtFqovN/BSnXx5aC8L/Tqii0pDc9p1APEtGx5uDts9at9hDBGVP6P3q/+OH6LxzycduizOfOylwYvkQRk7y5q8HZ1RfXlJUtRgz6wIblDlgfQyzR4p9pHCaHwDW4VHd3dsFTBqMSC4iCKe69eBCOx+Dr63lQmwSdGl+BlYVCUJOkhkfEyw2Suh75Am5ZMGKHoNDKHzSVuX2ioCxE+PXYz/rHNdNpiiQBcga4r0ncxRmjocSpxhw0CUO3sGN3ZxT72npxweJTP9HCGO/wItXJ+GxRSsty3SBulMCv1i6tVoxn70SITDrzpTlAa9ir113AlBLb2WIIu1PeOA9W32rUil9+OZVnf0zpzt5xvSduOjDjXMScf3YOOsFmYPLbjuDaUt2ddzgZPyH7qp131S+2liEyqhwuvME8q1ztC955ZbXvLihTrFHhLEaZs5Ol3wTGkAu/sq+3IfomvqsKhrabP30mPwNmnrbHF6dazdJknQSxhQMmyxoWEjlzTtN5wTe8bhZ+OaOK2bkS2tHNlkuwZtALyyjdUwR5sNCU9mKbniwpiu2eibnllE7s2AHHvKg3nKbrPGRwAZtd9JgLDTmBN6jEkv5TLFzTSE2T6ne2ixr70bxMq1cUFLsyDIjQjSzArDrITC7hF8BoB2Bnl4y55FsAwCq/b+HwBhu7i7AeYu4MdnxSjJiF8pPYYDo3KPKPANl6bw9hIJvmeWZaazCBmcp/B7o+QI5BCBEc6/2GRRBEA4jDMOuxpX82/Ar2vtEM2QwHjS7bQT0tCcK2j6e7WI3h66cdYMOMDyGH1DxpNblhSNYbj0+QD0FD5kmFTjYopH8JUPxe/URmFJA9nQWbvw+Bh59jh8F7DvC4vKJqTpo+1D44l0tYW2Bt4aghY+FksMkwhzPiI8efN7ZLrAv9zSySFBv6e3HvMA7M8fmRjaYuA9HaENw5ePZtVbLTE6DIqupleVclB3c7eduBwlvY6pMlgJH9qSaF18GieecDpmeT17PZ5SJTuWWd2cQOcSGOUuNXkOQW1p3y6+X5PtE9PjFT2+A8dhxEd9q5M00ctaK3+6GnF7tiyPWxdrZKBt1xyyzfPYpte6/2x+gNPKAi0knW+02lwENlmibNpWb7FD5ZK0ve1XdyubHAmbK9IdB2ndkX1egmLhpc93WboYaWtk9hBkffgkiuf2cdSWeR/xYrMetHHeFvqup0MfetloCpN30Xo52xbXTd4JDUY8dL6Kk88BwweweT7Wu8pORy3Q4RZyWeWUgXuzkKDo+YLoc7DEzfGBTgDqcioITUvdEl7F3GFzrNqzYWmrsB43dzn8PYahQevS76AfTcj6Qfs7quX6nj4XQ9Npcc61hgVcdNvzu4iBUeV+vptefw/f6LVdb+XF47NLdw4Aex5E5HaPB0RNBbTx7TWLUF7PtPYR/iXLu/R2ONOIgn3O77PEqMyZwd7zYw02cT05qsuSMZIYlHR4fQGiy2FUOIBBySMir3uvG9NkYTDBDY86OUqLCR4D1hd/9oCO7hehh0EYRYLUxQhNS9ClSeDcYitwYtJJCwVIk6fgh7FMtndQdbPFT0E/RwZWk3S5Edu8M19B39vBtk1u49R0MCHpqXP1bwZ/c+KrvNuSCwO6RDHzKH7rHbmeuf18AYT5LHY+axjQySGxc6bBNu1/Byfhj/1d266hA8OwEaK24+Oj3BJBUinW+7019ZRC7Yw3qNa4cPKFopg5mv30vmcdbw2GWeqgc/gnhCv4ocqiSvVgo7iP/KvVCcOALzdDZFnQsWCbp7NZeI/f21yWNi8ryzFqc6ho8lQsYpCSSTcs2Fp89Q2g8pIZOAqVTeAHTsCEDXFbpzzN5yEPHHyoUpJWVaD5r/2JYkAQ3dUuzVvs9vfHDGoVq+3YNVm1Hcj18cwa4dImcW1XbLXq1ujoKSPdGHTSFDSN229sGa8epVvxgnYGsHzUYhysilZhJ+g1o+vudbfUTQkVOiBTi5gnGhlmBYTzxSK3IFDTfUklPjogx+I6TeDVl2wH05yrduVr0FjNSwwfoePXjY/bkfXuemq53dWlGXHl1YeDbqXA0pyibE4RfR6jLdicglGBVR/0trzul1kBnrni7Q4bfhDJC4r7KBibUyjdqdzounE8ulNMATUmApsQuKYtnZW0J7eV4srQeHRcNKtb0KelWimJcNxB1GpYSju4uDV6I0i1cj8vfZRtADKHKIoBg9DohtGQBukQXFzhh5UZR3+9FHN0HF4AdLspdGitQq0aEMmBVDyxgmCL4f4UV0nCWLMxWATc3/VmjU8+pCTzRRnNzacXV+gwSf1/67ynFrGP7eFtZtwK3XaHluQI96uGq9iD26dEnR+QHGcM/gV3XhLyh5d36SYtNXsARy1vIlk6AwvhvO358HjWVlS0+0qzqzBmbF5LorsB+L1b4Z4gcdYPk2CD0FHUn0N2Zw1dLEmMykBwdryzRveUIsVi8A1g36VGIxmYcG4c5m6EL31ZQ1ceIel72OdwwsAGw8GyiGVk75FD4KlBcNpb+VWpr18hAyWHOKV/VWQfy84MB7ragBOgT9Jxa8mrXcLPGRk4be+ZscHSGoi9dyii8xoOvGFZHla+4+x8RK1p/Te8y0ZoGUmLNodt4JaL19oT+2+oq6kKgNmrKkjngn8fu2td+vO77T1yN4F/KLeOqQJx2/cefV5kLXhe16nnrMdZNgciOx8NdcxQzeUxFuS/ZnxReKnuWEroPvpTsJcBWOlEQI3V1Lax7Y1i1xAkleFRE9js38/g6zyoaS6ql8aDHwwtmt/bebHr/7Hx5ONnRQMonkEfdH2kxf5zTU/DCxGPN3Ok6DrJx97+Y8qnXC/sbfcyp8e95QvIf9R0Ueu2e9TQQuf/PPZmaflBzDld+safDf2dJl3N2V3U2d3WR+ska967qDWbv688BvpIl+sWeudH74PjNFmB3Wn6Y2h6qu+sMulRBm35+sf/pN15GpRi3VuQtjeOdOeatveH4ht2rtP1e4uI8J/q/aF4Rp+hRba5e+cOwToanUD+04kgpkaQnUnZ8SmwOkI0T3v8ZmWO2e9VlkuTxLXOyddR6myve7P2N4Qa559uiLsY/rMNJ7UcofQy18rJUP9uMer/aHSnPn/4p86Y+Rxuix9nMshTPfSsCuSsBxqq4yIEIcofVAK0HhtNuQwcvx1lWZseNT9bI7bt/iamZt9PRrDdhtRn+IBQtEkKxMqIsBl+CDKou5i3yZr2Cr9p6El76KXJePcavYFtyhb1ezTNqRWe915HyC7ee0E0AsIqZk8ge/+G2zDMoy1g9rzhCb0+dIHJZVB94jqgtFIwXVJWmtz35D+bFdx1q5FNSHXg6Z5HR5+H+79NVxAdTIVHC3HOYeDQQdcIzTMGxcUIt+82bhu0ytLbOyN7NI8xOPdWBniu24Zn7gMs6iwubSRGy6ru/GbNFzsZZHi15Q0fv8SVifHnmmB2s1+Lwxf9z0Di4KMjM1SDvLtNjf+8a7fJmmfTRws9fZt9goIu3pShNoYXejxq+MPKKzhxIve7aPNhsDn2foxjP6GrbzSIBKY6qmZxglsmRnGvHGwumz/xpwdTaHkOAW9NXx2qWGIbnTQJESaFpG2mp5scBc0QPeHX5QPY5piNgbCu6V8SMxQV35UgF6CLwilDgRuIDGx8TbnhXYVEpxJme8vSudPEmHqt2FsaitBJufKcwDCO1HbPbBZDE5oAoWmF0DHIxrzsZtfIMqpydYp0MU0XOOqxg7BRP5h9WlQdaXAJMPExb8Y2FMYO4Fn/DuKnx9kQDhJnNfQNKOgG4Z0QAXVdD+z6oph/j1A+gpReqUdRuQJiQiT2RPnJavoki+GTGEQ2jtq3+2Rj5V5gCGlgoj+7bS++KIfHQsf0uT8aT0XCfJomosw+pwqt16i7okMhYLT5PzDv9H6ScEU25OAXC2WpoG74Feqa3QRsmhRdo0+Mbbq1ybnruDYPg44u6YNYbZhFTN6ZzXIRiaC99bv+dQEJdtlqbayfXYaWn0nk8g3Qyg+0FTJwgtLLDTpbEUlMt1fN7H6Go+L7mChMmo2fnINOCC2uh+K/MP6nmbjHM29HRPL/HhUKw2iqHzFzp2iSwSpJKXASY6jEsp9H0cas0UUprcLychbYRcnRVZdCuy0cYYMuQyHLvKCb/RAnf6mc1/DChI6fPYUep2siaT6CAV9E8VQbnevyB9j3vchzZsQ1iX0Bn6W7qVsTrNmA4M0IuTg6PR5V4UTnEVwt8iwVdom4cFXBumNsUzBFFjKN/Ee5G1qOoLmqwuEMI0thcwlgTBmRGjb9+Pf/uhyi6MInnWkDo+TcKxxFspTK3m2RSeYkTwNidIXXSQaJKaC7/CxhroqEp2/bk/9GvVCoY3lxJlSS/dPJEjjGvC5xNjr6tqV/dn3I0ZezNVgi6pYD9rgfbs+UxfQkl3YswMeJgWUkOLgxTole1NpSi+WuV7rFO2CDQ4AOtGobY2VOWu+7Ela6QFNaADTQA/qSNtGj2V9VYkbtiYQBk9tojK61McNIROdxUnvc9KqWzP3SevVA9tgl9NxQNPhaTuveBuhQDE+wBR+zIGHumo24a/jBtCRNk4da6Y1Hn3ayBz1T70I3X/GTl1Z3nxj+kODceaDw4uACmTJWk47gR6nYu1A7ezwCNES/fw+IkOb3upjd6RxI3QHN4F44uBMrD8rSAmCuSmpZXchQvwpss9aNrOA69ec6wd7gc7HHJbM06rznjgpECzvcQxXDnDeu1tzSjNHK6o0vFc3/Oc131v2JjsbSt1r32hGLGAwzxnhrnRzto6dNGMlEgNwz1gABVJqrKZr+s/vmgTspXfBQzFbv2hbIFrjQa71OKxvYyzhd4k/eAJt02KAkIkBkZQKKZcdQB8wLcdi2na6JzWAO3r+Xfg3iAYpZEztghgadFuID+C3xaW/m7LSmdPKm3BMUYhxEII32cJom01ErTSB2C9u/wTo9s1CW2SeNSY7gHc2/nUZVdsz+KiD+WgdgWuKkiVBiXAXrkbEHcBnwWPdqp21oI8SgLjkK6dZr32qVB5Je4Sk+h9j+CmYvKOm1rFlX3BrY0qHDHnLPyOov6IEAPFC4DixTgQt6pV0WoChqxw1TueDtY9RiVwt3eBn7dIA/Hd+Su0eL+H3idQE9XdDQkBcW9EY0xCkBlt4IiXRKpzNEXARcr2YCDZx5KDcQth1PdAIzL5mh0cKe3u68vT0xf4PWZ75cbco5YXNFPCT9xiD+gQIGSBIwDXXuvyNVRzSgnzzvnYoeHxaRZWvCRgGwULVjW/sLmHEfc1CTeXwfZAv7rj77+LsGSoKOgajP6t9D/82s2Tayesxl44x2jLAWFabxBdsX/ph4P3N//NtkqkozH7UHzVoVDdX2Qs97pbtsgGUw31uRoRVdafjikaXcjvkQwPfPm/0wU+qxUew+6TmpPV/32sAAwI6pmHel7UrTOyi22mPSdEo0NL5jZ6x77cynyXfQoHBtpLGlDRQPNGfgx+lMinRJYdD7pt6lux4CelFqr2MDUpqz4eyPHb85p/YsmL2/78U/mjOp6S6aPrL+v2vmtO6pmuPyePei5IY9B4aGek+agICir+ZpTecQb+Mh77TssnRz6CmRfNJnUf+8+Ra7dbrf0Xyi5ZXmYy0EDU/Q4dlGXmu9gcWVQ2LOmD479syBbJxGzfm+b7PHO2uDowdttG5QtLbywo6PvhFpM19z1UJHEyMvaWUBHOApo/e6MwGnwZEFBbXyUdNXnOR4/J//+//+vyeMldJzmzpFv7efcZRh+FmrOIxLdtRrHb1+DRObXF+eo+yiXhqRr1MbT9Z4sArVW3/zLsOwbpOHjPyeYmyCCuO9pRFE7PVR2jt9lZ3J3olSDE6Pu/ZQRoaTI+BpBVbE0xVe9j7L4ucGfE6HXuk4DpNnNfFwlDIDYz87c0l/dcIxbPto9ZhnZ3jTM06Y7GN09iKZ4Rr1fZdpdkatMRjS8+nwwd0nzkyWdfOQuAYfWS5It+/lHUrBcOqjTJ4/G3IKvkvpkJnh0S+SEZ7sqoAZ+bKoP+P3MsnG0IiwFOjLLe4+U1ov36Aufd5B7Q51e1PIlLM4AiVyY68EcDZz4E5xbzASEDP0UYpbfSNpDXwSBwaClq7RibY3g4AWkjBjNK9WijROVbiHGbZNaXtTQrDv6OPRog9Q6EJD10qk30/vNooIU1viUip7UXK8GJIYmQ3NEAtYa/Swsh4zl+1nivUiLMke9Mkv9mUObQAk6GzNTcsBZEF32wwSkmycIDQMI6PRkUeS3aoc2nsNCz3l5dLYKoSGH2DRgjOlRjQtPrt4CbL7Usg/iXyTgYw23mM3II+BLKrIXnuH9s6KSN/wkU74TwIF3YzbNqRcnSfRGuzeZuBFpaRLBHrG/H907pwjFtLevRisnX8VvR9AQMHBdv8/EP7pTXnvZ0YKeMSUKHgSpOJhyISDxC2EBeP2xzmaGTtDaASnWWFSSg+gggL9M3oi7lGQd1YrChEW/6bpugRKAxO8u8gIRjSnea0Fdl6Lg+K5cdDJiIGxyHh/4ZVrRgpCJ0B0e4Q+Nu2dQRR4AsE+srAn3qVicda2DGjL4GgX5B3oFGaKZFm1Y6OfQ1nHqbEl2CsxsrBzM7Pjew1ck56jqKF90HyyrKCR7BAKsjWjja0rcfQHR3zh7CNG8i317iTnaG3gc1P+zNGCURD+Mrhx15C+s7pw/7AvgwMLGcNPZgJyislQN2IKh6BRAigoa/MOZi46J6FRhq6oQCCg4OrNeGjkwsQTRsRIMEMGm1Nwreq/sSjIvRfNnClk7lHpE1OXhN5IBQyGhk2HfYDiLVTqnxsJ6NmLxCiM4jSzCrBepKkWbz5MX+YsT1yKqka/J0c4aTzO0pJth9QA5FiGnoYk5JTqCn1pGoVykfBSY/CzN3YSw8K7VCErteXgAr6Ht9O/P87mDS3IVJQ9mllKBYYoT3w07iLjeuWRK7c6TxQstZHAFvq32dHh5uDGbV1FjG/NruBHQpPIdbfsVLozQm7kYvR5jyMjqOxRYuTGCN7PAo9K4jViANs04T3xShJR2Zsj99K9JHB8jrLLgEieX9LzK8M1xjBCQ1537fR8r5BeCPCM4B7IpKpLmEU3fsbn3bbptMrAoyO5HHM9bkvB++P/G2WjZvj7eA+Dkt66dzpbT38eWDJam31jcrHXQEC740gF5bhXucYGBIduMUv0ZfKQZYQ1t4MuNXS1FDF2YXlLK7p1XVfZHldx5TbFCSZmgemXIs+MQzlIEyQXqSdzVoUxCjzCPETA+dsxvXej4jXgwM3JurAv8bCuadLADp7Xriprxn9DeV+rxhSD1m4VF3xLYz5t/GRG61IwTqNckcyz4oU5nL3fwFmJslKtGpaVcG7bqzLei+r+WVInn0emXzjwYHmGp6T7gpD/O9A7p76+W9+tr8MMXRwcCAgWbu6o3WgLbj9M3d4jZlsKAm+g8CiJkKiO5VmbLNB+FPfM3Poy8KxkAqLqiYnousg8elnVS5R5W0Y8SwccNcs16MZmzLMmuQkV3vBN3TnjDgWX5wwtZ43HCBiiogRY8AglSpP+OWPkdu2SxZbCeVkS71SkDlPQhKJsOuLiVrlsIcrxDqwm36BkGjquyMrIa9ljRdbd5cP8qB5XopRnNXsuc/3Fsh72etkknmTKzck+H1na1WSmqruxeuvIXMJj4TnOXcis5kShILgJEQMlssdSnmG+SODsYdaRwMkVBIfJlbMuy6pHopLHQGNhR2tGIPQbNydyeplbJat7UAk7VT05UqRp5gmKEuU44RmhRwKOjf9R7gKCZXr5DFVayZOfoyOcK7HuiqFVTYp1/saHQcTc6EDGY6knR2EMeh4IKYQfnpFJM0m+0tHFx2+POmpU5RiKMtDvjBCHYl2eZM8Di0LNlbYXQD7ZahggYk6vRnh0MxsZGkvyjuzmOXP7GbnvR4IZ/cV+yCj656oRkybyIY79jTwT1bBAFPddgpZQKLiSq8xedR3vKekZvbdy68gEgJE7ofdnVIUSKeNov1E815lxMOM58uk9CK4mY+iKm7yZkV8zjQnPQiybWJJdS3JzzT4ze2HaEUKhhJ025pRy0CEyllPMLnUcyseRMk10Fwdns8uXG8ldhDMee91mPBVe/pOVI8g8Mkrt3nMAUljJpJlOMQ4oPZDziGDTt9vJ78/mH1RdN54AdgQKBhY+Rx6RkRFTUYB7XfdDixPj/eRA+Fas45nPj0JNbYOj/IZcMcJm986wRmco7sr45tzttuKJEaln34+SviIDVIKbTlgPnpTXqkxweDRlhY5D2TKfdyBl128sa6Ky42p41kCjc3TLzZUw0yx6BEaN27AloOvekuf5/ZyrvIgAf0Yl3ZUKutFF8/HbZeayjtaDKTcBMuU/Q9wwJrGMa7xl4CIRqQHgVBM+9gh3bwWoKDlOlS8tRaZlVSm2y2VqSY+UAQfKroIEtnSfZSfsl4GR2VnV9LON5w42pgzLauIkZBIo5U4mh6Ze4qBtbvXzi6WeuzMSjg+B9fDwWCN3GRhXufzgtHEzVxrV9c5qm6Mo629UB14xJFGYVeaF8d/HwIt6p/3Sn4vsDDzOm8JpWByZwroBiTBXYhTnzmUN2k5JA0PKP0eua35R+ahEwUXft3d3StKXASDXaihgurxzwNf6p0dzv2HDMooIHiGAKqOzuHlZkoIUXVgRgEdGuFFmceYeqggbGuE1TOgLvJyVDN/BDRlRHSkGFmNGkyzjdySw7Fh1TABM3Zx81K55y38koCuuYXsTq3oGvJh25n2Iyvsi78VDoO+Ng0bCBphDhBsbmRgK8tHtaAaXpGusg/QSEHphXPnGiIvim3El/o3Ey1BxIUdNyp3s8AgOea1yGlUWZDrDAxLKysxX+YraZcWrOIk8zaaZ2GMerISqZjw8SG5vszkBGcaBeddacBPnoN1BqG4D6F0kbp6qu6riat/zjBihAjZUsVzjWCyGZRvZ3DNFsRQVbcUFNhP2wNh+adxdnsuak/slUs/29oy8JXnvLLBIxeUe/g0jrxmnx2Z5b71u932Fj/UKVZAUJfBoUMYJwpFxs4y8ExznHlS9PDO/Y5ub5J0DhnIhODWcnEc1HCMFD2k1tDEIY9kseDbtLsP1sCSTkHjkZuVe1wpUZCY5Dww8ICOay8B1H3liUPEqJnlVkntVNAaM39Hwhs0tllslSyigMiVZEeDRYmea3ywFAV5xL8qMwJ+wwmXgFmVxXpwYOyovzCzwslCCL8SR3Hg9Q5gDgR7Tm2X4VbcVM6M9ZflmkxmW/r4su2632fiuAuB+vl2ckEMyFlN+RyeLB2dS0R51l69X3jeFVdKE6JbwPAxgwZl4Flnx6oS134zPRl1GJcWkad4Oc88C+pvz9sLFhbcNPT6DPhEzJYR7vNJQBouRLjRyUv3Mrh22NUJiz9hSMwhR8DJ7NPMrv9jk2d6wAIVbT+WmvPf2FP2h6lHIbk2ZC3QmJjqrAGZc5t4csySSzAJNa4c55zWY2efYA8PMFYtqjNAD/5HCbd7ZL0KCAKd7n27puoTeoDxbfRkYtAhux3M3prz+t3rThPiKe8SbYjyFSrEyMoqW7tvjnAJLC5i75jIwFLrxUcuRGOQlYCRvRrDNI5lofQoVbAZKnKzOFC1JAAAXeUlEQVSo3UBx3gqGXqJFwYlnPBuhlq77U0RMrOkSlmQ9PLe4EUwMMPnh2G8wdJ3pWVMpFx9VOTS8D4agTevvb4LlyIY+FQU2SHrhjFt/xlUqE38f5RHklmRdeVZcg1XAJQ4MJYbwtpzKQahkJi9GKI/KzkYJQvBvqCVgG3EE9Z4QFAaZ+RVAnGqc3PXGsd6zQQZnbhxmYnhuc4CaLSFs2QiGYvIXn4ZsLZyjqtyYRbeMLgLuHNcEPCLxrNI/Nxga8MvAi5UZjEfJq4DOCAwJjlH8xqWB1pgUaUtFMwRGCegVeUkNTeEY4hx5cSGzpZyc4H2Mz8Zt+UkCrGZwZgK8erucc7lzl0t+RtlXvQnB9ygyhjCuCOiRqzH1AjCuDfe+Z28HkFo9txT2+Yi93/vOqhFTofEoh4P1Wz5nBGuI3Gd8ezjgXMR0QxqDB2tGdHW/q4JZEnd7tSOeZ6hG+9mOz0wBlC4C7G71GMqfhG7MlGBHH+YGUOUiNwIb8kIye/A0jCFD3V46UqAZHPtsp9OSfCmAq3nFWtVeHP6FF6XqlKrMgsYBSIys3Ulm1cMeW3R596oR0li1VjxzNyMnMjIrMXMnVzwJ5cQd5LfNapnnwA3FSqe6iqemkt8x8iCNIHqzvAIEN6WKUVKJIzLw3lYBZ2xMFIXT5vAuOWHMjwy/Zg+R014k75cwMi4HfI8ZAV4zgshxyBKpYdLxPuueg5HQDvJtUGm4A+ViR+LVmlOMLLTQRWk/C8ZByWuH3kvGqmen6ulp1oscOtw2+7KeguIZYHYpGMmwjO9wDwG0cVjkN4NR34CKYB5ByY56QM8hjdUFA3aMWTFqKo1Y9tSvV98zulXIQDHONB2ahe7cY0COAGcCnmUknOsZ8EzfqW/Os4mfrhJHraLF27f7/7G33esMOqYnsERqIDd7MuQjD2FonHKMWYHOvxLfMEetq2GkNpya7JkkNq9s9Bkv2cDj3+TvILmJRh6JDJioElodNUjK0C4X9PKqetly/k5djujzMIaXqkxWY7QRSWfPwfnhSI/wEQLILPbIxVnJtB+5i2YVQBofLb6n4qipKhUOXKLeoY0stwq8Z8VtHW34soMmKNJjpr3oM5m9FSMwg9rVSVSPG2yGnSCSg7tUjCEWhTQL+zjqjjhU8Kx43OZAorxGR1KQI7n7mUNBZ3HSUyMC/RlwjKWyUpXiOa3qeLD2fhnKP5bDWZUqLnHczYP50XaBnLkwZGiC5QsH+zj5bHOxHkANU/kDlbOyyDhUReTyNZMhP19n/3lbvq2TAKuKvapgy12LanIqRYmrMMqMV4IFCzHLYJ3xZmQHQhxQnhGwUub6r9YMZyEV7wAsya2vCHLTHfxsXd6e5/zbN2aO5pS5NTP+t/Sk456UfNwU3TGNyQ+8cvYL2flbpJrw57ofUfUmIDzxSAWp8zdK4iGp9J6PPg/nIFZCl2aMPGUCNaO6/x2NixhT3hSZuHwUPGzd19PEbcZnzrvBUvI2wC0tMZRzmSJXPI1RXtTg8sNMhgw90oy9XQUEUnhogV0YyAIBZa6aCvqTDIT7s4l7My7nUbILBoZHdR7VusxKEx/Hc4CIaZeCNyEzjBbZj8g44x4+quPaozYdhUNsOxGSKJXYSHLLrrRnTev0kQtfiTOkU6WNibM1MnKC9zI7W3sqKlp4VaSKfpTUKtzK0DzPW2WuWSOeAP2QM+el0nZ3dNlSSr/xb1RDiZmRlBj/fNwaPYN7Gci7qFlU1DUzzaqXDSGwHQ+hfIWEt4BpOTa8BPfNjcDCTT80rkATvsQwfyarynL3+1EFsEcJc8fnZ/Hnqxmr3oGv9DWPmHUpegg8wT9SuLM40Ei8pKPv5JbzfIJmJjwq5Z5JQlO1OoKYmO+i4ESloGCkoCCkKLir3i7Pa5CFSUY3/crfOvwIpi2UOfLozAKzeM7lJThbQwWOfReNiswbu4drsikzMjkIA7QIhUgNpZGnbtaox91KmyorLLyjErZi6CWCl/Dnzs2GATlx/kdeBA9PIrtEFLw5hkfQGC4VnTDdO+MGLLLzwRMHbO8NsDo2xW9PW03Sm8mqrPSlT5Qaqx6FZp6F3sJIvDFVBECRHIUuM4Ke6eWdfB4zfMgxDEp6yCulkKMytMRAYtQXIFw/589EtUtYIrBS124VJ6L9nb61Mb29eP3aK9gHMjCiZg1BSxMGhnhkPKY8jmE/BkbQurOJuBU5R2fvZ/q+lGDQ2brIJfTgtLA7NF6ErD25yDiJeba7JRKPwj702D6QhSAakOovDC9SfRXXLWzg+t0Poh0vGjJHubsLjDVE5sz6iM/Wv4/c51WQJEzQpKIwRWqIfh6m/ejGG+c1YBqUwwrh1CXPIf+gKjgoeS1U5h3IkCZZ5IWsrBAylxvUu9uRtI11jTSMBHQpQZbzl5pO+KNWpVH1NCXnGOxQAxjeVDNDJ0OzlMDD4dKUsaG5yLg+XQepc/6He/Yq7nkJSgGlKENnch70F0eXSteLd7eJPdqN+p3Y/weysleHugrges5tzOz9PA54B56Yz+z8SgYVfas2S2Lck+wqkiPkSXLQI4s8/Y6I2997RPNl4AqtGoQDWGriyb11BSszdEmWBXIUcgq/g7qgdpQZK+GJTDhXb9Px9xgaNSMI98I5G/fawLg7oEhevVP1RkSw4iLD5FiKY5BXsEkqHUC7n1Hzbibofqx+r3yxZXwGecNlANQfnnawv0ZCoP/nVA7FbmMG5YSvAQQwo45g2Y12tsNmBeAkClU4v0emYEc19xGdLN5BOzbKCZhyL32qoldWvHiJ4QiROXe77OXJoKmLmzyJNgF2xhtn/o0Rr41KmKP8KqerIyueG5qC3C0owmwPgeJhn0GFtR6x6JxXqg6aHgQ/OZfDOZLjS0Xrqtpo3OyX1w74eo5TF+8a7OUaml+7ap6Uc9CbE897aJAsvVx+FNwgoli81YjVZlwyMY9inBYerLVIPfdHTNvzzGiyN0zvJrlkHgXmyJgaUMgx2DBqPARzb868TY+bqI4XjxKbn8lF8cCICp3s3LwVNgrUO/z0PQIFL8zAOETkiePAAxPmYBGaXmRwnoG6nEhbvN+W5b9LsX/hjf3ds8HvJOOv5xse8AXMscQB4SI+y34zaIczJbAaIc/Ge6fHazHqWb19jkIOlDF+BKWW3CvKOJDEm2P+RusJEqlVkFgFx8Jas/BK3sXW9ZCw4tlxacXaGUi9Y8jX6OEfYHDa03DT5QE44d2Vp5rNwcoM557e9/MNn3s7zkB3nI45GN+pcMwrS/0NKrPcE/oYfyfAw2R3w24cWzPoif6tt2YMVY1QA//sKWTo7qiu8mWw0aiX7070mnExXizwExM78tFQyaXTlQPwxKnli4TgeU0ynHuGy4s0El/wRR4/LbREeN8ZWY4kD1+0H0vpjDGl7eQEliIReBQvLofta1Ra49JldO5YECzrZ5bZaqyqARQJMBj3BhQZWzQ+mq6c61cWJLZ34PHgJNBcEYxr6ZKQ70hZPW+QVxXA37iEHj75s68Spx7uqG3x/Y/8HvriA1Rkjab4Ov7iAce0x93BEVPFs5xeXQ+ephxyv0w1XCCxkyD1+DzbQr0Zi8oxEA18hQA+KBr5tZN/E8/wdAN9dFtY2hK8kWT8PioGHVbml8rzH15MLo+upjqPAEJxgzi3brxqvu5HX5tlzcxecZ4rCfBMyoXve+trs/p5qhv0Ltco38grfM0+dnlbOHpblhfTki/al54eHLwCz/AU38kb3L3BvK+r3JpwNoSzhw44lhebLl18fGuv56GeMfuULHq8i/nbKT+Y3sOJqznesFwegPfd+b/9rb/xosg3EhifHZHv2BYeuGy8bevxNAvzyWXgQ4czmgHHQ+AN6+CxX/D67R4655cJRIQlAtOroDYAcOUA/DpPwtkMEZyUAjz48J+dB3Z6AHgqen4m2zZF03nJuj9cccO4iQZPvQaUX4s5c+d4gXiAcYM9lNYegOW/ywC4bILft0hee/z2CfDracTPjvjFBOTLXse3bzvPOE8+87H4y7fl8gCcVybh1LP79CKfH5Un4B18el/x2pF47MB8KX1wuFDAQa9/7oaKQ9ZSfsNE4gCPmjuP23ZMDMp3zRO1gTD4rf3WlQNwKrX1N2Z3mpsTPjNrnHhfebSdgXfSDoduHT+81n7oY5UMP7IW1F8zAwnxkvmOB8WO5R9jxGLXMtF5AC4cgOv5qwbAZ2d9XrrzD9KO75zRmd3FJ1rLSzChPg8SxnfMrzjMZQD8KvH9ex7MbA7Osov4Lr6LXNb4xMzxnjex/vrXzegg9GA+x4Y4ZE2oT43HHyccPCj5qiNfDRZgSDceNi/KBQX8tPi+TKJzTQvfsoo38d1xcMT84Ik5DCwP8wvnG3dtKncFR9+LX5APwr2Lq8772LwNvCAnZ4q2BRAKHEZDXB6A6/ltBsDXrOLzxPprdNwJl8yv43+e56TztV/g2+e31wB450bUB7ktVxLg9XzobvougYRTSHCeZg/3YpV8Ozd0Tlie9RQUss957IzxqnVMu6/xvnl3OMCztRY47lOsfJhFTqlT5fIAXM9HlSJfcbBPqYPOo0Zw5KJPVg/Lo3aAH1usiGD/Wj5Yg18JEb3HGJ+shjelBB9r4L2j2dGzc70MgB3CghcxXm4AnI7I35dbeEBG/4cNgB2dtV6bLMjXreWoKoRDm3zMTeptsOBDeMK9BsBB85nsqsqj5zExzm357woBnP8u96WK6xlK4gumf+je8KUk5hk5/QVxHn6CX18EdoRXEI5PrhfxcE/XwBxWWOF7UI7J7+OBbDLwOByCb5KHDS4PwPWcXEHy+CH/ilnJd3zlLPX7ONFMj/WcfKz6YsILwnfx/VN0O9BS25FAe1jobYcRFxlqt/+uXgDX80IJyYsgh7+Ov5bn+H3r5NH7xC+Z5+tfzo/vI983l90243Mzuy340hAAvklKfIkqwlcMeY5b+dNG+v40e5ycMfd7mfHkOnnoWp4FXMErT0w3V755njM0nH35QagEM7w5aG2MA1/GnZuAmd0LDJquF8DVDfAyF84+3d9p4x187nhEDPy8uA98OU15+HfIM/MTJ+f3Bj8B96/lqM/t37PlufnyVSGLZI68QgDXcxDPfaHz9tR039su5isYhmfkENRX+9H0/KPmh7fwA9+yfBy8b3zxnuDl56+63u8NAVzPa8QPjjiC+NTsT2cY7ZXH33Mq26SoUugD51wfqwneeP6E7OGWilDHG5nHV+6BJHhhv46KkTFHF5Tfevy7Z9eLwjuZGADGA3CZA1+jV66nSl1WdwB/b+94xvVy4m8of5XfsBU8kjbPS/TPdIfMvAjvhQ7b78Hgjr855Ysvpv3tvwsH4Hp+rWUzm7rDP0VPnnZ9E+74T67iIzhJs0mCJ+DwF8MBz1h+71v/HmV+YAZPvR3wZQBcSvojuvcUS8G37AE+OuTr17kj+b2HUXmzlTTu3Pp6Gg8uxOxc8nz7XPiW8BY6DehBRODF6073H3tOZFxd8Ny7Hh6AVwMBXfaFv4GQy/9/sLThWZiVZ6PMd72Uuz+Jt82dJ6ctXzn7T7eImA7zvI4534kPwBe87QoBXM+Xqhw8PzNeu3JWetQgWPCRdfBER2Zfu57j6MYPEHdfhcz+WmN+gIlqXf72I4dxMwAu9XU9J7k5H3HyZpLafmMFbAY+MqLN8sEJhp9G/BV+ch0TSLl87RyHt17PF37QnJ6CEtg5h2mjh/vX/m/vVo3WurR/4jNbMXgXl3h8txfA5RO47uHXgs4+Rb50Qq9bFw6fzNmSGXkCSnOk8D5xHg52nbDKb0+8d5H3wD7sC9nU+xJEH7ndrhDA9XyrsP0y1X1sEjC+k3r8wh3m8yPzVft4lv4RT0FC8zm+fxOw1GvL87LW6HjZWbhdQIDX8zdv0Tj1xP9mI5z3UOv52na8ftZny2N40nrls/T8BF7FIfxdtdDwlq23YFe/uh2wTf3Ajv3/Yz2HLlNj5pP87VT4/PrLbt43zZ3vWhXPw3I1g+nFRhGPG/WViMC7Wze/q7LCbObtdiUBXs9v0W9vElK/gn78LXzANzfdOeKijPPwGj/J3zX86JeV9/I9/H18PwQ+aSxt9Lj991eAgPBGCXDV+P8tw+MVK+X30uG9TebwGb7iiXmb0yrjQwoPr9sCfmCLi0kChxg0PGbc0yMB4nQDHWsAXPbCFxl5T8cEJ4Br+Dm6vbVp2qtqz/HieR1poGHH1PZAze8kymo8YPKdfNO+Ft99eNoHsz3BIe8K+yAcYYDiCgFcz2+6wb/6xThmAH75hvHdRvUTa+JeAuCN5OXxvPiSHgRZXgLexKKUl+zVsLhw53sPKyHEC+QHT1cFcJUk/iJ1fK30xRP7tp0lz7ot+AjR+WF+45tmyU8niz5ZXvuK/Aq+kgYTZS5fCwX8m0wF/mJK8dM8cWKBzRPs7DO3U75hvi8Dg+S+qqAjP4fyeDwsSxzT88f8jbzwHh65lh1JhDxkX2SqNwCe5B/7PqQjoDTe53GArkv/5QB45bLx+xfJLzufPANP44NHZDqUi/f2qeLz/HGcm5pvP+NTgD+vcB7xWb6tT+q1VQBvFr7fKut5Tejar7dNll+5nrM0NuKHFswz0pvvoOU+DctP0OaJ8pejwwzV8a4kwOu5FPOXa/25qeHjk+Rv5Bt+D2vxTS/dXXp4AnjjV9CIM+fwTcBAt+VywV/P9YwPGr5hkidWPHjr0t7vAcBr95Zv3o/jbqT4GC2fVuLD8MZxaFo8mAZVLIZf4AG4LJivvbrKd/esf8fceHa2f3Wm895BlvPe+N2vc99adr+TL9r/5T00PoeLH+8VDy8IC93+w6VAf/eDP7OcP5W6wJOsH09M+N3zPhL+GKeZ6r4v4XP7UDZ+8EbaVQbDi8v3Rh/C8eu/QgDX86dNnaNLuz652N1lRm+Jz2P3vvGofcGTH+XB85l6/9jx/FTX2KQskgevFcEvpt8zWYK4ax3YOTafLwflBI3C8QZn+2oH/C0G0JWZf5H/TOvktVfVyRwzH5yLFh/uVvhqDwlfNu/jCffMXG//XR6Ay1C5nkv5z64Z5yPeGfdp96387GWMR7ij3w3SdWQiKo8j3CuSjKvoi5cBcD2Xch/8bbnosf/L+KL5n2leL+gQxrOtG8dPlO9a04sM4FcYaNmYt+WvhwCu5zIArgke8zpc+/nsjezV9ORZ94THrZtn4rOTGTPsDIAXMeXlWLgU6u/SxB96cJHvm7pLnq1sk2fZtwMhdc+w3nIPDZxvHXrsKwRwPV+l6P7U7f+vKuSzeD3wh2g+OQl+8HyfBhaZx66XH1jHVQZ4PZciu55z0e0TeQO8eHVmX/hBIpzGAMCJ9ngndPBlAFzP9bxL2PKi4WmfXxhq4Qk38NM5JqfJgeDx/LtnyBvOca6u51IG36YL/tRh4G9c6o6mM/gr5w8nn98LXvjJ3hif8mq83ANwGQDXc7nav5/4v3IP/0iCJX/x/DAzxiAx74hCDb6YBkdVTm4GwCUir+dbb9SX0H0b8fGH6YyTbDS/eO/44vnhiQ/x3fPYu788/r2364Z+Pddz/LNMHvzLS/I55fYt2AdHv4pvHOhVZOIJ6bp3fnjxRP0kwEuGXM/1fPzgX4b47/ck/Fo64NrT08xzcrCb4BI+13MJ8rPf1i5N9VrSXTLw9z34kmNzKCLyJCPflkumXM8vPPT47Qv8YwbV2129/K4t40HfwS9hff6yI/7vVe/6H5KX9Xs9lyfgeq7n4sVfTUde/NJ5AC7lfz3XRfl6LqF48eLZ9wtfvhG7S/1eyPyXAXA913M9p1cil5z6u0YPT8SHz9ADbyRmdc63i1Wv53qu57o5Xzfsiw9e936edM6XB+B6rucSttdzKcXrzP3B/bo8ANdzPddN9HoupXmduT/4XAbA9VzP9VzPpTQv4+YyAK7neq7neq7nei7j5i8YLlcOwPX8+ee6XVzP9VzPXzRcLg/A9VyH9CLBZYBdz/X8wecyAK7neq7nMsAuA+h6/uDzvyYcj31tUGDLAAAAAElFTkSuQmCC"})},
"esri/views/webgl/Program":function(){define(["require","exports","dojo/has"],function(m,h,d){m=function(){function c(a,b,d,f,g){void 0===g&&(g={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};
a||console.error("RenderingContext isn't initialized!");0===b.length&&console.error("Shaders source should not be empty!");this._context=a;this._vertexShaderSource=b;this._fragmentShaderSource=d;if(Array.isArray(g))for(a=0;a<g.length;a++)this._defines[g[a]]="1";else this._defines=g;this._id=c._nextId++;this._locations=f}Object.defineProperty(c.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glName",{get:function(){return this._glName},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});c.prototype.getDefine=function(a){return this._defines[a]};c.prototype.dispose=function(){if(this._context){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null);this._context=null}};c.prototype.initialize=
function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,b=a.createProgram();a.attachShader(b,this._vShader);a.attachShader(b,this._fShader);for(var c in this._locations)a.bindAttribLocation(b,this._locations[c],c);a.linkProgram(b);a.getProgramParameter(b,a.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+a.getProgramParameter(b,
a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(b));this._glName=b;this._initialized=!0}};c.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};c.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};c.prototype.getAttribLocation=function(a){this.initialize();void 0===this._nameToAttribLocation[a]&&
(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};c.prototype.setUniform1i=function(a,b){var c=this._nameToUniform1[a];if(void 0===c||b!==c)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),b),this._nameToUniform1[a]=b};c.prototype.setUniform1f=function(a,b){var c=this._nameToUniform1[a];if(void 0===c||b!==c)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),
b),this._nameToUniform1[a]=b};c.prototype.setUniform1fv=function(a,b){var d=this._nameToUniform2[a];void 0!==d&&c._arraysEqual(b,d)||(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(a),b),void 0===d?this._nameToUniform2[a]=new Float32Array(b):d.set(b))};c.prototype.setUniform2f=function(a,b,c){var d=this._nameToUniform2[a];if(void 0===d||b!==d[0]||c!==d[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),b,c),void 0===d?this._nameToUniform2[a]=
new Float32Array([b,c]):(d[0]=b,d[1]=c)};c.prototype.setUniform2fv=function(a,b){var d=this._nameToUniform2[a];void 0!==d&&c._arraysEqual(b,d)||(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(a),b),void 0===d?this._nameToUniform2[a]=new Float32Array(b):d.set(b))};c.prototype.setUniform3f=function(a,b,c,d){var f=this._nameToUniform3[a];if(void 0===f||b!==f[0]||c!==f[1]||d!==f[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),
b,c,d),void 0===f?this._nameToUniform3[a]=new Float32Array([b,c,d]):(f[0]=b,f[1]=c,f[2]=d)};c.prototype.setUniform3fv=function(a,b){var d=this._nameToUniform3[a];void 0!==d&&c._arraysEqual(b,d)||(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(a),b),void 0===d?this._nameToUniform3[a]=new Float32Array(b):d.set(b))};c.prototype.setUniform4f=function(a,b,c,d,g){var e=this._nameToUniform4[a];if(void 0===e||b!==e[0]||c!==e[1]||d!==e[2]||g!==e[3])this._context.bindProgram(this),
this._context.gl.uniform4f(this.getUniformLocation(a),b,c,d,g),void 0===e?this._nameToUniform4[a]=new Float32Array([b,c,d,g]):(e[0]=b,e[1]=c,e[2]=d,e[3]=g)};c.prototype.setUniform4fv=function(a,b){var d=this._nameToUniform4[a];void 0!==d&&c._arraysEqual(b,d)||(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(a),b),void 0===d?this._nameToUniform4[a]=new Float32Array(b):d.set(b))};c.prototype.setUniformMatrix3fv=function(a,b,d){void 0===d&&(d=!1);var f=this._nameToUniformMatrix3[a];
void 0!==f&&(9===f.length?c._matrix3Equal(f,b):c._arraysEqual(b,f))||(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(a),d,b),void 0===f?this._nameToUniformMatrix3[a]=new Float32Array(b):f.set(b))};c.prototype.setUniformMatrix4fv=function(a,b,d){void 0===d&&(d=!1);var f=this._nameToUniformMatrix4[a];void 0!==f&&(16===f.length?c._matrix4Equal(f,b):c._arraysEqual(b,f))||(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(a),
d,b),void 0===f?this._nameToUniformMatrix4[a]=new Float32Array(b):f.set(b))};c._padToThree=function(a){var b=a.toString();1E3>a&&(b=("  "+a).slice(-3));return b};c.prototype._addLineNumbers=function(a){var b=2;return a.replace(/\n/g,function(){return"\n"+c._padToThree(b++)+":"})};c.prototype._loadShader=function(a){var b=35633===a?this._vertexShaderSource:this._fragmentShaderSource,c="",d;for(d in this._defines)c+="#define "+d+" "+this._defines[d]+"\n";b=c+b;c=this._context.gl;a=c.createShader(a);
c.shaderSource(a,b);c.compileShader(a);c.getShaderParameter(a,c.COMPILE_STATUS)||(console.error(c.getShaderInfoLog(a)),console.error(this._addLineNumbers(b)));return a};c._matrix4Equal=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};c._matrix3Equal=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&
a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};c._arraysEqual=function(a,b){if(a.length!==b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0};return c}();m._nextId=0;return m})},"esri/views/3d/environment/RealisticAtmosphere":function(){define("dojo/text!./materials/RealisticAtmosphereMaterial.xml ../../../core/watchUtils ../../../core/HandleRegistry ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/OffscreenRenderingHelper ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q){var n=l.earthRadius,t=a.vec3d,u=a.vec2d,x=a.vec4d;a=.02*Math.PI;l=.004*Math.PI;var r=t.createFrom(1/Math.pow(.65,4),1/Math.pow(.57,4),1/Math.pow(.475,4)),z=t.create(r);t.scale(z,a);t.add(z,t.createFrom(l,l,l));var B=(1- -.99999*-.99999)/(2+-.99999*-.99999)*1.5;c=c.createSubclass({declaredClass:"esri.views.3d.environment.RealisticAtmosphere",properties:{view:{},planar:{value:!1,set:function(a){a=!!a;a!==this.planar&&this._update();this._set("planar",a)}},needsRender:{value:!1}},
constructor:function(){this._handles=new d;this._lowerElevationBoundRadius=0;this._earthRadius=n;this._renderer=this._skyPlanarProgram=this._skyProgram=this._hazePlanarProgram=this._hazeProgram=null;this._renderData={texDepth:u.create(),v3CameraPos:t.create(),v3CameraUp:t.create(),v3CameraRight:t.create(),v3CameraDir:t.create(),v3CameraCenter:t.create(),halfSizeNearPlane:u.create(),v2CameraCenterOffset:u.create(),v4SphereComp:x.create(),v4AtmosParams1:x.create(),v4AtmosParams2:x.create(),v4AtmosParams3:x.create(),
v3InvWavelength:r,v3InvWavelengthScaled:z,v4Radii:x.create(),fScale:0,fScaleDepth:.25,fLowerAlphaBlendBound:0,fScaleOverScaleDepth:0,fOneOverScaleDepth:0,fScaleDepthBlue:.05,fOneOverScaleDepthBlue:20,fScaleOverScaleDepthBlue:0,g:-.99999,g2:-.99999*-.99999,fMiePhaseCoefficients:B,showTest:0,nearFar:u.create()};this._updateRadius(n);this._hazeSlot=g.POSTPROCESSING_ATMOSPHERE;this._skySlot=g.BACKGROUND},destroy:function(){this._handles&&(this._handles.destroy(),this._handles=null);this._hazeProgram&&
(this._hazeProgram.dispose(),this._hazeProgram=null);this._hazePlanarProgram&&(this._hazePlanarProgram.dispose(),this._hazePlanarProgram=null);this._skyProgram&&(this._skyProgram.dispose(),this._skyProgram=null);this._skyPlanarProgram&&(this._skyPlanarProgram.dispose(),this._skyPlanarProgram=null)},setup:function(a){var c=k.createSquareGeometry(),d={faces:c.getFaces()[0],vertexAttr:c.getVertexAttr()},c=this.renderContext.rctx;this._renderer=new b(d,v.Pos3Tex,null,c);var e=this._update.bind(this);
this._handles.add(h.on(this,"view.navigation","currentViewChanged",function(a){e(a.camera)},function(){e()},null,!0));var d=this._updateElevation.bind(this),f=this._updateVisibleElevationBounds.bind(this);this._handles.add(h.on(this,"view.basemapTerrain","elevation-change",d,d));this._handles.add(h.on(this,"view.basemapTerrain","elevation-bounds-change",f,f));a.shaderSnippets.fsRealisticAtmosphere||a.shaderSnippets._parse(m);this._hazeProgram=new p(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,
q.Default3D,["HAZE"]);this._skyProgram=new p(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,q.Default3D);this._hazePlanarProgram=new p(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,q.Default3D,["HAZE","PLANAR"]);this._skyPlanarProgram=new p(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,q.Default3D,["PLANAR"])},render:function(a){if(!(a.slot!=this._hazeSlot&&a.slot!=this._skySlot||a.pass!=f.MATERIAL||
a.slot==this._hazeSlot&&a.options.earlyOcclusionPixelDraw)){var b,c=this.renderContext.rctx,d=c.gl,e=a.offscreenRenderingHelper,g=!1;if(a.slot==this._hazeSlot){b=this.planar?this._hazePlanarProgram:this._hazeProgram;c.bindProgram(b);c.setBlendFunctionSeparate(d.ONE,d.ONE_MINUS_SRC_COLOR,d.ZERO,d.ONE);e.detachDepthTextureFromBuffer();var g=!0,l=e.getDepthTexture();c.bindTexture(l,0);b.setUniform1i("tDepth",0);b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp)}a.slot==this._skySlot&&(b=this.planar?
this._skyPlanarProgram:this._skyProgram,c.bindProgram(b),c.setBlendFunctionSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA),b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp),b.setUniform4fv("v4AtmosParams3",this._renderData.v4AtmosParams3));b.setUniform3fv("v3InvWavelength",this._renderData.v3InvWavelength);b.setUniform3fv("v3InvWavelengthScaled",this._renderData.v3InvWavelengthScaled);b.setUniform3fv("v3LightDir",a.lightingData.direction);b.setUniform3fv("v3CameraPos",
this._renderData.v3CameraPos);b.setUniform3fv("v3CameraUp",this._renderData.v3CameraUp);b.setUniform3fv("v3CameraRight",this._renderData.v3CameraRight);b.setUniform3fv("v3CameraDir",this._renderData.v3CameraDir);b.setUniform2fv("nearFar",this._renderData.nearFar);b.setUniform2fv("halfSizeNearPlane",this._renderData.halfSizeNearPlane);b.setUniform2fv("v2CameraCenterOffset",this._renderData.v2CameraCenterOffset);b.setUniform4fv("v4Radii",this._renderData.v4Radii);b.setUniform4fv("v4AtmosParams1",this._renderData.v4AtmosParams1);
b.setUniform4fv("v4AtmosParams2",this._renderData.v4AtmosParams2);b.setUniform1f("showTest",this._renderData.showTest);c.setDepthTestEnabled(!1);c.setBlendingEnabled(!0);this._renderer.render(b);c.setBlendingEnabled(!1);c.setDepthTestEnabled(!0);c.setBlendFunctionSeparate(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA,d.ONE,d.ONE_MINUS_SRC_ALPHA);g&&e.restoreDepthTextureToBuffer();return!0}},_setEnableTestImage:function(a){this._renderData.showTest=a?1:0;this.needsRender=!0},_adjustRadiusForTesselation:function(a){return a*
Math.cos(Math.PI/Math.pow(2,4)/16)},_normalizeRadius:function(a){a=this._adjustRadiusForTesselation(a);return Math.max(n-1E4,Math.min(a,n))},_updateElevation:function(){if(this.get("view.basemapTerrain.ready")){var a=this._adjustRadiusForTesselation(n+this.view.basemapTerrain.rootTiles[0].elevationBounds[0]);a!==this._lowerElevationBoundRadius&&(this._lowerElevationBoundRadius=a,this._earthRadius=-1,this._updateVisibleElevationBounds())}},_updateVisibleElevationBounds:function(){var a=this._adjustRadiusForTesselation(n+
this.view.basemapTerrain.getElevationBounds()[0]);return 0>this._earthRadius||a<this._earthRadius?this._updateRadius(a):!1},_updateRadius:function(a){this._earthRadius=a;var b=a*a,c=a/10*10.25,d=c*c,e=1/(c-a),f=e/.25,g=e/.05,l=.3*(c-a)+a,k=1/(c-l),n=this._renderData;x.set4(e,.25,f,4,n.v4AtmosParams1);x.set4(-.99999,.05,g,20,n.v4AtmosParams2);x.set4(-.99999*-.99999,B,l,k,n.v4AtmosParams3);x.set4(a,b,c,d,n.v4Radii);n.fScale=e;n.fLowerAlphaBlendBound=l;n.fScaleOverScaleDepth=f;n.fScaleOverScaleDepthBlue=
g;this._update();return!0},_update:function(a){if(a=a||this.get("view.navigation.currentCamera")){t.negate(a.viewForward,this._renderData.v3CameraDir);t.set(a.viewUp,this._renderData.v3CameraUp);t.set(a.viewRight,this._renderData.v3CameraRight);if(this.planar){var b=this.view.renderCoordsHelper;this._renderData.fCameraHeight=b.getAltitude(a.eye)/b.unitInMeters+n}else this._renderData.fCameraHeight=t.length(a.eye);this._renderData.fCameraHeight2=this._renderData.fCameraHeight*this._renderData.fCameraHeight;
this._renderData.fC=this._renderData.fCameraHeight2-this._renderData.v4Radii[3];this._renderData.fCSur=this._renderData.fCameraHeight2-this._renderData.v4Radii[1];this._renderData.v4SphereComp=x.createFrom(this._renderData.fCameraHeight,this._renderData.fCameraHeight2,this._renderData.fC,this._renderData.fCSur);t.set(a.eye,this._renderData.v3CameraPos);t.set(a.center,this._renderData.v3CameraCenter);u.set2(Math.tan(a.fovX/2)/(a.width/a.fullWidth),Math.tan(a.fovY/2)/(a.height/a.fullHeight),this._renderData.halfSizeNearPlane);
u.set2((a.padding[3]+a.width/2)/a.fullWidth-.5,(a.padding[2]+a.height/2)/a.fullHeight-.5,this._renderData.v2CameraCenterOffset);u.set2(a.near,a.far,this._renderData.nearFar);this.needsRender=!0}}});c.isSupported=function(a){return e.supportsDepthTexture(a.rctx.extensions)};return c})},"esri/views/3d/webgl-engine/lib/OffscreenRenderingHelper":function(){define("require exports ./Util dojo/text!../materials/internal/offscreen.xml ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Program ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){var q={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},n={target:3553,pixelFormat:6408,dataType:32819,samplingMode:9729,wrapMode:33071,width:0,height:0};return function(){function l(a,b){this._hudVisibilityTexture=null;this._enabled=!1;this.height=this.width=0;this._programRep=a;this._rctx=b;this.height=this.width=null}l.prototype.enable=function(){if(!this.getEnableState()){var b=this._rctx;this._enabled=!0;this.framebuffer=
a.createWithAttachments(b,q,{colorTarget:0,depthStencilTarget:b.extensions.depthTexture?4:3});this.quadVAO=this.createQuadVAO(b)}};l.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this.framebuffer.dispose(),this.quadVAO.dispose(!0),this._depthStencilTextureCached=this.quadVAO=this.framebuffer=null)};l.prototype.createQuadVAO=function(a){var b=new Float32Array([-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1]);return new k(a,v.Default3D,{geometry:p.Pos2Tex},{geometry:f.createVertex(a,
35044,b)})};l.prototype.setEnableState=function(a){a?this.enable():this.disable()};l.prototype.getEnableState=function(){return this._enabled};l.prototype.getColorTexture=function(){return this.framebuffer.colorTexture};l.prototype.getDepthTexture=function(){return l.supportsDepthTexture(this._rctx.extensions)?this.framebuffer.depthStencilTexture||this._depthStencilTextureCached:null};l.prototype.getHUDVisibilityTexture=function(){return this._hudVisibilityTexture};l.supportsDepthTexture=function(a){return!!a.depthTexture};
l.prototype.initializeFrame=function(a){d.assert(this.getEnableState());var b=this._rctx,c=b.gl;a=a.fullViewport;this.width=a[2];this.height=a[3];this.framebuffer.resize(this.width,this.height);b.bindFramebuffer(this.framebuffer);b.setStencilWriteMask(255);b.setClearStencil(0);b.setClearColor(0,0,0,1);b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT)};l.prototype.renderHUDVisibility=function(a){var c=this._rctx,d=c.gl;this._hudVisibilityTexture||(this._hudVisibilityTexture=new b(c,
n));this._hudVisibilityTexture.resize(this.width,this.height);var e=this.framebuffer.detachColorTexture();this.framebuffer.attachColorTexture(this._hudVisibilityTexture);c.bindFramebuffer(this.framebuffer);c.setClearColor(0,0,0,1);c.clear(d.COLOR_BUFFER_BIT);a();d.flush();this.framebuffer.detachColorTexture();this.framebuffer.attachColorTexture(e)};l.prototype.bindFramebuffer=function(){this._rctx.bindFramebuffer(this.framebuffer)};l.prototype.getFramebuffer=function(){return this.framebuffer};l.prototype.detachDepthTextureFromBuffer=
function(){this._depthStencilTextureCached=this.framebuffer.depthStencilTexture;this.framebuffer.detachDepthStencilTexture()};l.prototype.restoreDepthTextureToBuffer=function(){this.framebuffer.attachDepthStencilTexture(this._depthStencilTextureCached);this._depthStencilTextureCached=null};l.prototype.drawQuad=function(a){d.assert(this.getEnableState());a=this._rctx;var b=a.gl,c=this._programRep.get("offscreenProgram");a.bindFramebuffer();a.setDepthTestEnabled(!1);a.clear(b.COLOR_BUFFER_BIT);a.bindProgram(c);
c.setUniform1i("tex",1);a.bindTexture(this.framebuffer.colorTexture,1);a.bindVAO(this.quadVAO);a.drawArrays(5,0,e.vertexCount(this.quadVAO,"geometry"));a.setDepthTestEnabled(!0)};l.loadShaders=function(a,b,d,e){a._parse(c);a=new g(e,a.vsOffscreenRenderer,a.fsOffscreenRenderer,v.Default3D);d.add("offscreenProgram",a)};return l}()})},"esri/views/3d/environment/SimpleAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../../../core/watchUtils ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n){var t=v.earthRadius,u=a.vec3d,x=a.vec2d,r=a.mat4d,z=f.VertexAttrConstants,B=(t-1E4)/t,C=(t+3E5)/t,A=-1E4/3E5,D=1-A;return c.createSubclass({declaredClass:"esri.views.3d.environment.SimpleAtmosphere",properties:{view:{},needsRender:{value:!1},slot:{value:l.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:x.create(),silCircleCenter:u.create(),silCircleV1:u.create(),silCircleV2:u.create()};this._textureRep=
this._texture=null},initialize:function(){this._textureDfd=new h;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._currentViewChangedHandle&&(this._currentViewChangedHandle.remove(),this._currentViewChangedHandle=null);this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),
this._textureDfd=null)},initializeRenderContext:function(a){this._textureRep=new g({SimpleAtmosphere:new k(p,"SimpleAtmosphere",{wrapClamp:!0})},a.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),a.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var c=this._createRibbonGeometryData();this._renderer=new b(c,[{name:"position",
count:3,type:5126,offset:0,stride:12,normalized:!1}],null,a.rctx);this._currentViewChangedHandle=d.on(this,"view.navigation","currentViewChanged",function(a){this._update(a.camera)}.bind(this),function(){this._update(this.get("view.navigation.currentCamera"))}.bind(this),null,!0);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(m);this._program=new q(a.rctx,a.shaderSnippets.vsSimpleAtmosphere,a.shaderSnippets.fsSimpleAtmosphere,n.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==
e.MATERIAL)return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;b.bindProgram(d);d.setUniform4f("color",1,1,1,1);d.setUniformMatrix4fv("proj",a.camera.projectionMatrix);d.setUniformMatrix4fv("view",a.camera.viewMatrix);d.setUniform3fv("silCircleCenter",this._renderData.silCircleCenter);d.setUniform3fv("silCircleV1",this._renderData.silCircleV1);d.setUniform3fv("silCircleV2",this._renderData.silCircleV2);d.setUniform2fv("texV",this._renderData.texV);b.bindTexture(this._texture,0);d.setUniform1i("tex",
0);d.setUniform3fv("lightDirection",a.lightingData.direction);b.setDepthFunction(c.LEQUAL);b.setBlendingEnabled(!0);b.setDepthWriteEnabled(!1);this._renderer.render(d);b.setBlendingEnabled(!1);b.setDepthWriteEnabled(!0);b.setDepthFunction(c.LESS);return!0},_update:function(a){var b=u.create(),c=u.create(),d=u.create(),e=this.view.renderCoordsHelper.getAltitude(a.eye);u.scale(a.eye,(t+50)/u.length(a.eye),d);this._computeSilhouetteCircle(d,a.center,a.up,t);u.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,
b);u.scale(b,C,c);var d=this._computeScreenRimWidth(d,a.up,b,c),g=0,l=1,k=1;50>e?(g=.001953125,l=.1015625):500>e?(k=(e-50)/450,g=.001953125*(1-k)+.001953125*k,l=.1015625*(1-k)+.21875*k):5E3>e?(k=(e-500)/4500,g=.001953125*(1-k)+.001953125*k,l=.21875*(1-k)+.51171875*k):5E4>e&&(k=(e-5E3)/45E3,g=.001953125*(1-k)+.001953125*k,l=.51171875*(1-k)+.4140625*k);e=A+g*D;k=A+d*l*D;50<u.length(a.eye)-t&&(this._computeSilhouetteCircle(a.eye,a.center,a.up,t),u.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,
b),u.scale(b,C,c),a=this._computeScreenRimWidth(a.eye,a.up,b,c),a=f.clamp((a-1.5)/(d-1.5),0,1),e=A+a*g*D,k=A+f.lerp(1,d*l,a)*D);x.set2(e,k,this._renderData.texV);this.needsRender=!0},_computeSilhouetteCircle:function(a,b,c,d){var e=u.length(a),f=d*Math.sqrt(e*e-d*d)/e,g=this._renderData.silCircleV1,l=this._renderData.silCircleV2;u.scale(a,Math.sqrt(d*d-f*f)/e,this._renderData.silCircleCenter);u.cross(a,b,g);1>u.length2(g)&&u.cross(a,c,g);u.scale(g,f/u.length(g));u.cross(g,a,l);u.scale(l,f/u.length(l));
return f},_computeScreenRimWidth:function(a,b,c,d){var e=r.create();r.lookAt(a,c,b,e);a=this.view.navigation.currentCamera;f.project(c,e,a.projectionMatrix,a.viewport);f.project(d,e,a.projectionMatrix,a.viewport);return u.dist(c,d)/a.height},_createRibbonGeometryData:function(){for(var a=new Float32Array(768),b=new Uint32Array(768),c=0;128>c;c++){var d=6*c;a[d+0]=c;a[d+1]=B;a[d+2]=0;a[d+3]=c;a[d+4]=C;a[d+5]=1;var e=2*c,f=127===c?0:e+2;b[d+0]=e;b[d+1]=e+1;b[d+2]=f+1;b[d+3]=f+1;b[d+4]=f;b[d+5]=e}c=
{};c[z.POSITION]=b;b={};b[z.POSITION]={size:3,data:a};return{faces:{type:"triangle",indices:c,positionKey:z.POSITION},vertexAttr:b}}})})},"esri/views/3d/environment/Stars":function(){define("dojo/text!./materials/StarMaterial.xml require ../../../request ../../../core/watchUtils ../../../core/promiseUtils ../lib/glMatrix ../support/ExternalRenderer ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Util ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../../webgl/Util".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n){var t=b.mat4d;b=b.mat3d;var u=g.VertexAttrConstants,x="9bb2ff;9eb5ff;aabfff;bbccff;ccd8ff ;dae2ff;e4e9ff;eeefff;f8f6ff;fff9fb;fff5ef;fff1e5;ffeddb;ffe9d2;ffe6ca;ffe3c3;ffe0bb;ffddb4;ffdaad;ffd6a5;ffd29c;ffcc8f;ffc178;ffa94b;ff7b00".split(";"),r=b.toMat4(b.createFrom(1,0,0,0,.9174771405229186,.39778850739794974,0,-.39778850739794974,.9174771405229186)),z=b.toMat4(b.createFrom(1,0,0,0,.9174771405229186,-.39778850739794974,0,.39778850739794974,.9174771405229186)),
B=null;return k.createSubclass({properties:{view:{},numBinaryFloats:{value:2},numBinaryUInt8:{value:1},bytesPerStar:{value:9},needsRender:{value:!1},slot:{value:p.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={model:t.identity()};this.slot=p.BACKGROUND;this._vertexBufferLayout=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:20,normalized:!1},{name:"size",count:1,type:5126,
offset:16,stride:20,normalized:!1}]},initialize:function(){this._loadDataPromise=this._loadBrightStarCatalogue();this.addResolvingPromise(this._loadDataPromise)},destroy:function(){this._loadDataPromise.isFulfilled()||this._loadDataPromise.cancel("Atmosphere has been removed.");this._dateHandle&&(this._dateHandle.remove(),this._dateHandle=null);this._program&&(this._program.dispose(),this._program=null)},setup:function(a){this._numStars=this._starData.byteLength/this.bytesPerStar;var b=new Float32Array(this._starData,
0,this._numStars*this.numBinaryFloats),d=new Uint8Array(this._starData,this._numStars*this.numBinaryFloats*4,this._numStars*this.numBinaryUInt8),b=this._createStarGeometryData(b,d);this._renderer=new f(b,this._vertexBufferLayout,this._fillInterleaved,a.rctx);this._renderer.enablePointRendering(!0);this._dateHandle=c.init(this,"view.environment.lighting.date",this._update.bind(this));a.shaderSnippets.vertexShaderStar||a.shaderSnippets._parse(m);this._program=new v(a.rctx,a.shaderSnippets.vertexShaderStar,
a.shaderSnippets.fragmentShaderStar,q.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==l.MATERIAL)return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;b.bindProgram(d);d.setUniformMatrix4fv("view",a.camera.viewMatrix);d.setUniformMatrix4fv("proj",a.camera.projectionMatrix);d.setUniform4fv("viewport",a.camera.fullViewport);d.setUniformMatrix4fv("model",this._renderData.model);b.setDepthFunction(c.LEQUAL);b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,
c.ONE,c.ONE_MINUS_SRC_ALPHA);b.setDepthWriteEnabled(!1);this._renderer.render(d);b.setBlendingEnabled(!1);b.setDepthWriteEnabled(!0);b.setDepthFunction(c.LESS);return!0},_fillInterleaved:function(a,b,c,d,f,g,l){var k=n.getStride(f);c=k/4;var p=e.fill,t=a.faces.indices[u.POSITION],q=a.vertexAttr[u.POSITION].data;d=l+n.findAttribute(f,"position").offset/4;for(var v=0;v<t.length;++v){var h=3*t[v];p(q,h,g,d,b,3);d+=c}b=a.faces.indices[u.COLOR];t=a.vertexAttr[u.COLOR].data;d=l+n.findAttribute(f,"color").offset;
q=new Uint8Array(g.buffer);for(v=0;v<b.length;++v)h=4*b[v],p(t,h,q,d,null,4),d+=k;k=a.faces.indices[u.SIZE];a=a.vertexAttr[u.SIZE].data;d=l+n.findAttribute(f,"size").offset/4;for(v=0;v<k.length;++v)g[d]=a[k[v]],d+=c},_computeDayDuration:function(a){var b=new Date(a.getFullYear(),0,1,11,58,56),c=new Date(a.getFullYear()+1,0,1,11,58,55);return(a-b)/(c-b)},_update:function(a){if(a){var b=a.getHours()/12,c=a.getMinutes()/60*(2/24),d=a.getSeconds()/60*(2/1440),b=(b+c+d-.9972222)%2;a=2*this._computeDayDuration(a);
c=t.create(z);t.rotateZ(c,-a*Math.PI);t.multiply(r,c,c);t.rotateZ(c,-b*Math.PI);this._renderData.model=c;this.needsRender=!0}},_hexToRGB:function(a){return[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)]},_unpackUint8Attributes:function(a){return 192<=a?[2.9,a-192]:160<=a?[2.5,a-160]:128<=a?[2,a-128]:96<=a?[1.5,a-96]:64<=a?[1,a-64]:32<=a?[.7,a-32]:[.4,a]},_createStarGeometryData:function(a,b){for(var c=new Float32Array(3*this._numStars),d=new Uint8Array(4*
this._numStars),e=new Float32Array(this._numStars),f=new Uint32Array(this._numStars),g=0;g<this._numStars;g++){var l=2*g,k=3*g,n=4*g,p=a[l+0],l=a[l+1];c[k+0]=-Math.cos(p)*Math.sin(l);c[k+1]=-Math.sin(p)*Math.sin(l);c[k+2]=-Math.cos(l);k=this._unpackUint8Attributes(b[g]);p=this._hexToRGB(x[k[1]]);d[n+0]=255*p[0];d[n+1]=255*p[1];d[n+2]=255*p[2];d[n+3]=255;e[g]=k[0];f[g]=g}a={};a[u.POSITION]=f;a[u.NORMAL]=f;a[u.UV0]=f;a[u.COLOR]=f;a[u.SIZE]=f;f={};f[u.POSITION]={size:3,data:c};f[u.COLOR]={size:4,data:d};
f[u.SIZE]={size:1,data:e};return{faces:{type:"point",indices:a,positionKey:u.POSITION},vertexAttr:f}},_loadBrightStarCatalogue:function(){return B?(this._starData=B,a.resolve()):d(h.toUrl("./resources/stars.wsv"),{responseType:"array-buffer",failOk:!0}).then(function(a){if(a=a.data)this._starData=B=a;else throw Error("no data received");}.bind(this)).otherwise(function(a){console.error("Failed to load star data:",a);throw a;})}})})},"esri/views/3d/webgl-engine/lighting/Lightsources":function(){define(["require",
"exports","../../lib/glMatrix"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});var c=d.vec3d;m=function(){return function(a,b,d){void 0===a&&(a=c.create());void 0===b&&(b=c.createFrom(.57735,.57735,.57735));void 0===d&&(d=!0);this.intensity=a;this.direction=b;this.castShadows=d}}();h.MainLight=m;m=function(){return function(a,b){void 0===a&&(a=c.create());void 0===b&&(b=c.createFrom(.57735,.57735,.57735));this.intensity=c.create();this.direction=c.create();this.intensity=a;this.direction=
b}}();h.FillLight=m;m=function(){return function(a){void 0===a&&(a=c.create());this.intensity=a}}();h.AmbientLight=m;m=function(){return function(){this.sh={r:[0],g:[0],b:[0]}}}();h.SphericalHarmonicsLight=m})},"esri/views/3d/constraints/SceneViewConstraints":function(){define(["../../../core/Accessor","./SceneViewAltitudeConstraint","./SceneViewClipDistanceConstraint","./SceneViewTiltConstraint","./SceneViewCollisionConstraint"],function(m,h,d,c,a){return m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewConstraints",
properties:{tilt:c,altitude:h,clipDistance:d,collision:a},getDefaults:function(a){var b={};a.tilt||(b.tilt={});a.altitude||(b.altitude={});a.clipDistance||(b.clipDistance={});a.collision||(b.collision={});return b},scale:function(a){this.tilt.scale(a);this.altitude.scale(a);this.clipDistance.scale(a)}})})},"esri/views/3d/constraints/SceneViewAltitudeConstraint":function(){define(["../../../core/Accessor","../support/earthUtils"],function(m,h){h=4*h.earthRadius;m=m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewAltitudeConstraint",
properties:{mode:{value:"auto"},min:{value:-Infinity,set:function(d){this._set("min",d);this._get("max")<d&&this._set("max",d);this.mode="manual"}},max:{value:h,set:function(d){this._set("max",d);this._get("min")>d&&this._set("min",d);this.mode="manual"}}},autoUpdate:function(d,c){"auto"===this.mode&&(this._get("min")!==d&&this._set("min",d),this._get("max")!==c&&this._set("max",c))},scale:function(d){this._set("max",this._get("max")*d);this._set("min",this._get("min")*d)}});m.MIN_DEFAULT=-Infinity;
m.MAX_DEFAULT=h;return m})},"esri/views/3d/constraints/SceneViewClipDistanceConstraint":function(){define(["../../../core/Accessor"],function(m){return m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewClipDistanceConstraint",properties:{near:{value:0,cast:function(h){return Math.max(1E-8,h)},set:function(h){this._set("near",h);h>=this._get("far")&&(this.far=h+1E-9);this.mode="manual"}},far:{value:0,cast:function(h){return Math.max(1E-8,h)},set:function(h){this._set("far",h);
h<=this._near&&(this.near=h-1E-9);this.mode="manual"}},mode:{value:"auto"}},autoUpdate:function(h,d){"auto"===this.mode&&(this._get("near")!==h&&this._set("near",h),this._get("far")!==d&&this._set("far",d))},scale:function(h){this._set("near",this._get("near")*h);this._set("far",this._get("far")*h)}})})},"esri/views/3d/constraints/SceneViewTiltConstraint":function(){define(["../../../core/Accessor","../support/mathUtils"],function(m,h){m=m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewTiltConstraint",
properties:{mode:{value:"auto"},max:{value:.5,cast:function(d){return h.clamp(d,.5,179.5)},set:function(d){this._set("max",d);this.mode="manual"}}},autoUpdate:function(d){"auto"===this.mode&&this._get("max")!==d&&this._set("max",d)},scale:function(d){}});m.MAX_DEFAULT=.5;m.MIN_DEFAULT=179.5;return m})},"esri/views/3d/constraints/SceneViewCollisionConstraint":function(){define(["../../../core/Accessor"],function(m){return m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewCollisionConstraint",
properties:{enabled:!0}})})},"esri/views/3d/input/SceneInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/Accessor ../../../core/HandleRegistry ../../../core/accessorSupport/decorators ../../input/InputManager ../../input/BrowserEventSource ../../input/ViewEvents ../../input/handlers/PreventContextMenu ./handlers/pinch/PinchNavigationGlobal ./handlers/pinch/PinchNavigationLocal ./handlers/DoubleClickZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/DragZoom ./handlers/KeyPan ./handlers/MouseWheelZoom ./handlers/SingleKeyResetHeading ./handlers/SingleKeyResetTilt ./handlers/PointerDownCancelAnimation ./handlers/TwoFingerTilt ./NavigationHelper".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E){m=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._handles=new k;return a}d(c,b);c.prototype.initialize=function(){var b=this;this.viewEvents=new l.ViewEvents(this.view);this._handles.add([a.whenNot(this.view,"ready",function(){return b._disconnect()}),a.when(this.view,"ready",function(){return b._connect()})])};c.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect()};
Object.defineProperty(c.prototype,"primaryDragAction",{get:function(){return this._get("primaryDragAction")},set:function(a){"pan"!==a&&"rotate"!==a||a===this._get("primaryDragAction")||(this._set("primaryDragAction",a),this._updateMode())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"mode",{get:function(){return this._get("mode")},set:function(a){"default"!==a&&"pro"!==a||a===this._get("mode")||(this._set("mode",a),this._updateMode())},enumerable:!0,configurable:!0});c.prototype._disconnect=
function(){this.viewEvents.disconnect();this._source&&(this._source.destroy(),this._source=null);this._inputManager&&(this._inputManager.destroy(),this._inputManager=null)};c.prototype._connect=function(){var a=this.view;this._source=new e.BrowserEventSource(this.view.canvas);var b=new g.InputManager(this._source);this._inputManager=b;b.installHandlers("prevent-context-menu",[new p.PreventContextMenu]);this._modeDragPan=new t.DragPan(a,"primary");this._modeDragRotate=new u.DragRotate(a,"secondary",
"center");this._modeDragZoom=new x.DragZoom(a,"tertiary");this._pinchNavigation="global"===this.view.viewingMode?new v.PinchNavigationGlobal(a,new E.NavigationHelper(a.navigation.picker)):new q.PinchNavigationLocal(a,new E.NavigationHelper(a.navigation.picker));b.installHandlers("navigation",[new A.PointerDownCancelAnimation(a),new n.DoubleClickZoom(a),new r.KeyPan(a,{left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j"}),new z.MouseWheelZoom(a),new C.SingleKeyResetTilt(a,
"p"),new B.SingleKeyResetHeading(a,"n"),this._pinchNavigation,new D.TwoFingerTilt(a),new u.DragRotate(a,"primary","eye",["b"]),new u.DragRotate(a,"secondary","center",["b"]),new t.DragPan(a,"tertiary",["b"]),this._modeDragPan,this._modeDragRotate,this._modeDragZoom]);this.viewEvents.connect(b);this._updateMode()};c.prototype._updateMode=function(){var a=this.primaryDragAction,a=H.get(this.mode).get(a);this._modeDragPan&&(this._modeDragPan.pointerType=a.pan);this._modeDragRotate&&(this._modeDragRotate.pointerType=
a.rotate);this._modeDragZoom&&(this._modeDragZoom.pointerType=a.zoom)};return c}(f.declared(b));c([f.property()],m.prototype,"view",void 0);c([f.property({value:"pan"})],m.prototype,"primaryDragAction",null);c([f.property({value:"default"})],m.prototype,"mode",null);c([f.property({readOnly:!0,aliasOf:"_inputManager.latestPointerType"})],m.prototype,"latestPointerType",void 0);c([f.property()],m.prototype,"_inputManager",void 0);m=c([f.subclass("esri.views.3d.input.SceneInputManager")],m);var H=new Map;
c=new Map;f=new Map;c.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"});c.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"});f.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"});f.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"});H.set("default",c);H.set("pro",f);return m})},"esri/views/input/InputManager":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/now ./keys ./recognizers ../../core/Logger ./handlers/LatestPointerType".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){Object.defineProperty(h,"__esModule",{value:!0});var p=e.getLogger("esri.views.input");m=function(a){function b(b,c){b=a.call(this)||this;b._pointerCaptures=new Map;b._nameToGroup={};b._handlers=[];b._currentPropagation=null;b._sourceEvents=new Set;b._keyModifiers=new Set;b._activeKeyModifiers=new Set;b.primaryKey=f.primaryKey;b.latestPointerType="mouse";b._installRecognizers();return b}d(b,a);b.prototype.normalizeCtorArgs=function(a,b){this._browserEvents=a;this._browserEvents.onEventReceived=
this._onEventReceived.bind(this);this._recognizers=b;this._recognizers||(this._recognizers=g.defaults.map(function(a){return new a}));return{}};b.prototype.destroy=function(){for(var a=0,b=Object.keys(this._nameToGroup);a<b.length;a++)this.uninstallHandlers(b[a])};b.prototype.installHandlers=function(a,b){var c=this;if(this._nameToGroup[a])p.error("There is already an InputHandler group registered under the name `"+a+"`");else if(0===b.length)p.error("Can't register a group of zero handlers");else{var d=
{name:a,handlers:b.map(function(a,b){return{handler:a,active:!0,removed:!1,priorityIndex:0,eventCallback:null,uninstallCallback:null}})};this._nameToGroup[a]=d;a=function(a){var b=d.handlers[a];e._handlers.push(b);b.handler.onInstall({updateDependencies:function(){c.updateDependencies()},emit:function(a,d,e,f){c._emitInputEvent(b.priorityIndex,a,d,e,f)},setPointerCapture:function(a,e){c._setPointerCapture(d,b,a,e)},setEventCallback:function(a){b.eventCallback=a},setUninstallCallback:function(a){b.uninstallCallback=
a}})};var e=this;for(b=d.handlers.length-1;0<=b;b--)a(b);this.updateDependencies()}};b.prototype.uninstallHandlers=function(a){var b=this._nameToGroup[a];b?(b.handlers.forEach(function(a){a.removed=!0;a.uninstallCallback()}),delete this._nameToGroup[a],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):p.error("There is no InputHandler group registered under the name `"+a+"`")};b.prototype.hasHandlers=function(a){return void 0!==
this._nameToGroup[a]};b.prototype.updateDependencies=function(){var a=new Set,b=new Set;this._handlersPriority=[];for(var c=this._handlers.length-1;0<=c;c--){var d=this._handlers[c];d.priorityIndex=c;this._handlersPriority.push(d)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(c=this._handlersPriority.length-1;0<=c;c--){d=this._handlersPriority[c];d.priorityIndex=c;var e=d.handler.hasSideEffects;if(!e)for(var g=0,l=d.handler.outgoingEventTypes;g<l.length;g++)if(a.has(l[g])){e=
!0;break}if(e)for(g=0,l=d.handler.incomingEventMatches;g<l.length;g++){var k=l[g];a.add(k.eventType);for(var n=0,k=k.keyModifiers;n<k.length;n++){var p=k[n];f.isSystemModifier(p)||b.add(p)}}d.active=e}this._sourceEvents=a;this._keyModifiers=b;0<this._pointerCaptures.size&&this._sourceEvents.add("pointer-capture-lost");0<this._keyModifiers.size&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up"));this._browserEvents&&(this._browserEvents.activeEvents=this._sourceEvents)};b.prototype._setLatestPointerType=
function(a){this._set("latestPointerType",a)};b.prototype._onEventReceived=function(a,b){"pointer-capture-lost"===a&&this._pointerCaptures.delete(b.native.pointerId);this._updateKeyModifiers(a,b);this._emitInputEventFromSource(a,b,b.native.timestamp)};b.prototype._updateKeyModifiers=function(a,b){var c=this;if(b){var d=!1,e=function(){if(!d){var a=new Set;c._activeKeyModifiers.forEach(function(b){a.add(b)});c._activeKeyModifiers=a;d=!0}},f=function(a,b){b&&!c._activeKeyModifiers.has(a)?(e(),c._activeKeyModifiers.add(a)):
!b&&c._activeKeyModifiers.has(a)&&(e(),c._activeKeyModifiers.delete(a))};if("key-down"===a||"key-up"===a){var g=b.key;this._keyModifiers.has(g)&&f(g,"key-down"===a)}a=b.native;f("Alt",!(!a||!a.altKey));f("Ctrl",!(!a||!a.ctrlKey));f("Shift",!(!a||!a.shiftKey));f("Meta",!(!a||!a.metaKey));f("Primary",this._activeKeyModifiers.has(this.primaryKey))}};b.prototype._installRecognizers=function(){var a=this;this._latestPointerTypeHandler=new l.LatestPointerType(function(b){return a._setLatestPointerType(b)});
0<this._recognizers.length&&this.installHandlers("default",this._recognizers);this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler])};b.prototype._setPointerCapture=function(a,b,c,d){a=a.name+"-"+b.priorityIndex;b=this._pointerCaptures.get(c.pointerId)||new Set;this._pointerCaptures.set(c.pointerId,b);d?(b.add(a),1===b.size&&this._browserEvents&&this._browserEvents.setPointerCapture(c,!0)):(b.delete(a),0===b.size&&(this._pointerCaptures.delete(c.pointerId),this._browserEvents&&
this._browserEvents.setPointerCapture(c,!1)))};b.prototype._garbageCollectRemovedHandlers=function(){this._handlers=this._handlers.filter(function(a){return!a.removed});this.updateDependencies()};b.prototype._emitInputEventFromSource=function(a,b,c){this._emitInputEvent(0,a,b,c)};b.prototype._emitInputEvent=function(a,b,c,d,e){d=d||(this._currentPropagation?this._currentPropagation.timestamp:k());b=new v(b,c,d,e||this._activeKeyModifiers);this._currentPropagation?this._currentPropagation.addedEvents.push(b):
this._doNewPropagation(a,b)};b.prototype._doNewPropagation=function(a,b){for(a=this._currentPropagation={events:[b],addedEvents:[],currentHandler:this._handlersPriority[a],needsHandlerGarbageCollect:!1,timestamp:b.timestamp};a.currentHandler;){if(a.currentHandler.removed)a.needsHandlerGarbageCollect=!0;else{b=a.events;var c=[];a.addedEvents=[];for(var d=0;d<b.length;d++){var e=b[d];a.currentHandler.active&&a.currentHandler.eventCallback(e);e.shouldStopPropagation()||c.push(e)}a.events=c.concat(a.addedEvents)}a.currentHandler=
this._handlersPriority[a.currentHandler.priorityIndex+1]}a.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers();this._currentPropagation=null};b.prototype._compareHandlerPriority=function(a,b){if(a.handler.hasSideEffects!==b.handler.hasSideEffects)return a.handler.hasSideEffects?1:-1;for(var c=0,d=a.handler.incomingEventMatches;c<d.length;c++)for(var e=d[c],f=function(a){if(e.eventType!==a.eventType)return"continue";var b=e.keyModifiers.filter(function(b){return-1!==a.keyModifiers.indexOf(b)});
if(b.length===e.keyModifiers.length!==(b.length===a.keyModifiers.length))return{value:e.keyModifiers.length>a.keyModifiers.length?-1:1}},g=0,l=b.handler.incomingEventMatches;g<l.length;g++){var k=f(l[g]);if("object"===typeof k)return k.value}return a.priorityIndex>b.priorityIndex?-1:1};b.prototype._sortHandlersPriority=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e=0;e<b.length&&0<=this._compareHandlerPriority(d,b[e]);)e++;b.splice(e,0,d)}return b};return b}(a.declared(b));c([a.property({readOnly:!0})],
m.prototype,"latestPointerType",void 0);m=c([a.subclass("esri.views.input.InputManager")],m);h.InputManager=m;var v=function(){function a(a,b,c,d){this.type=a;this.data=b;this.timestamp=c;this.modifiers=d;this._stopPropagation=!1}a.prototype.stopPropagation=function(){this._stopPropagation=!0};a.prototype.shouldStopPropagation=function(){return this._stopPropagation};return a}()})},"esri/views/input/keys":function(){define(["require","exports","../../core/sniff"],function(m,h,d){Object.defineProperty(h,
"__esModule",{value:!0});h.primaryKey=d("mac")?"Meta":"Ctrl";var c={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(m=48;58>m;m++)c[m]=String.fromCharCode(m);for(m=1;25>m;m++)c[111+m]="F"+m;for(m=65;91>m;m++)c[m]=[String.fromCharCode(m+32),String.fromCharCode(m)];var a={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown"};h.eventKey=function(b){if(void 0!==
b.key)return a[b.key]||b.key;var d=c[b.keyCode];return Array.isArray(d)?b.shiftKey?d[1]:d[0]:d};h.isSystemModifier=function(a){switch(a){case "Ctrl":case "Alt":case "Shift":case "Meta":case "Primary":return!0}}})},"esri/views/input/recognizers":function(){define("require exports ./recognizers/Drag ./recognizers/PointerClickHoldAndDrag ./recognizers/SingleAndDoubleClick ./recognizers/VerticalTwoFingerDrag".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});h.defaults=
[c.PointerClickHoldAndDrag,a.SingleAndDoubleClick,d.Drag,b.VerticalTwoFingerDrag]})},"esri/views/input/recognizers/Drag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../InputHandler ./support ../../../core/now".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});m=function(c){function f(){var a=c.call(this,"recognizers.Drag",!1)||this;a._startStateModifiers=new Set;a._activePointers=[];a._activePointerMap=new Map;a._isDragging=!1;a._drag=a.registerOutgoing("drag");
a.registerIncoming("pointer-drag",a._handlePointerDrag.bind(a));a.registerIncoming("pointer-down",a._handlePointerDown.bind(a));a.registerIncoming("pointer-up",a._handlePointerUpAndPointerLost.bind(a));a.registerIncoming("pointer-capture-lost",a._handlePointerUpAndPointerLost.bind(a));return a}d(f,c);f.prototype._createPayload=function(a,b){return{action:a,pointers:this._activePointers.map(function(a){return a.data}),startState:this._startState,previousState:this._previousState,currentState:b}};f.prototype._fitCircleLSQ=
function(){var b=this._activePointers.map(function(a){return a.data.currentEvent});return a.fitCircleLSQ(b)};f.prototype._createDragState=function(){for(var a=this._fitCircleLSQ(),c=0,d=0,f=this._activePointers;d<f.length;d++){for(var k=f[d],q=this._pointerAngle(k,a),q=q-k.lastAngle;q>Math.PI;)q-=2*Math.PI;for(;q<-Math.PI;)q+=2*Math.PI;q=k.lastAngle+q;k.lastAngle=q;c+=q-k.initialAngle}c/=this._activePointers.length;return{angle:c,radius:a.radius,center:a.center,timestamp:b()}};f.prototype._updateMultiPointer=
function(a){var b=a.startEvent.native.pointerId,c=this._activePointerMap.get(b),d=!c;d?(c={data:null,initialAngle:0,lastAngle:0},this._activePointers.push(c),this._activePointerMap.set(b,c),c.data={startEvent:a.startEvent,previousEvent:a.previousEvent,currentEvent:a.currentEvent},a=this._fitCircleLSQ(),c.initialAngle=this._pointerAngle(c,a),c.lastAngle=c.initialAngle):c.data={startEvent:c.data.startEvent,previousEvent:a.previousEvent,currentEvent:a.currentEvent};d&&this._isDragging&&this._updateInitialAngles();
return c};f.prototype._pointerAngle=function(a,b){a=a.data.currentEvent;return Math.atan2(a.y-b.center.y,a.x-b.center.x)};f.prototype._updateInitialAngles=function(){for(var a=this._createDragState(),b=0,c=this._activePointers;b<c.length;b++){var d=c[b];d.initialAngle=this._pointerAngle(d,a)}};f.prototype._emitStart=function(a){this._updateInitialAngles();var b=this._createDragState();this._previousState=this._startState=b;this._startStateModifiers=a.modifiers;this._isDragging=!0;for(var c=0,d=this._activePointers;c<
d.length;c++){var f=d[c];f.data={previousEvent:f.data.currentEvent,startEvent:f.data.currentEvent,currentEvent:f.data.currentEvent}}this._drag.emit(this._createPayload("start",b),a.timestamp)};f.prototype._emitUpdate=function(a){a=this._createDragState();this._drag.emit(this._createPayload("update",a),void 0,this._startStateModifiers);this._previousState=a};f.prototype._emitEnd=function(){var a=this._createDragState();this._drag.emit(this._createPayload("end",a),void 0,this._startStateModifiers);
this._startState=this._previousState=null;this._isDragging=!1};f.prototype._handlePointerDown=function(a){a=a.data;this._isDragging&&this._emitEnd();this._updateMultiPointer({startEvent:a,previousEvent:a,currentEvent:a})};f.prototype._removeMultiPointer=function(a){var b=a.native.pointerId,c=this._activePointerMap.get(b);c&&(this._isDragging&&(this._updateMultiPointer({startEvent:c.data.startEvent,previousEvent:c.data.currentEvent,currentEvent:a}),this._emitEnd()),this._activePointerMap.delete(b),
a=this._activePointers.indexOf(c),this._activePointers.splice(a,1),this._isDragging&&this._updateInitialAngles())};f.prototype._handlePointerUpAndPointerLost=function(a){this._removeMultiPointer(a.data)};f.prototype._handlePointerDrag=function(a){var b=a.data;switch(b.action){case "start":this._isDragging||this._emitStart(a);break;case "update":this._isDragging||this._emitStart(a),this._updateMultiPointer(b),this._emitUpdate(a)}};return f}(c.InputHandler);h.Drag=m})},"esri/views/input/InputHandler":function(){define(["require",
"exports","./EventMatch","../../core/Logger"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});var a=c.getLogger("esri.views.input");m=function(){function c(a,b){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;this._name=a;this._hasSideEffects=b}Object.defineProperty(c.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(var a in this._incoming)for(var b=
0,c=this._incoming[a];b<c.length;b++)this._incomingEventMatches.push(c[b].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"incomingEventTypes",{get:function(){this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(a){return a.eventType}));return this._incomingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"outgoingEventTypes",{get:function(){this._outgoingEventTypes||(this._outgoingEventTypes=
Object.keys(this._outgoing));return this._outgoingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},enumerable:!0,configurable:!0});c.prototype.onInstall=function(b){var c=this;this._manager?a.error("This InputHandler has already been registered with an InputManager"):(b.setEventCallback(function(a){return c._handleEvent(a)}),b.setUninstallCallback(function(){return c._onUninstall()}),this._manager=b)};c.prototype.onUninstall=
function(){};c.prototype.registerIncoming=function(a,c,f){var e=this;"function"===typeof c?(f=c,c=[]):c=c||[];a="string"===typeof a?new d.EventMatch(a,c):a;var g=function(){e._incomingEventTypes=null;e._incomingEventMatches=null};c=function(a){var b=e._incoming[a.match.eventType];b&&(a=b.indexOf(a),b.splice(a,1),g(),e._manager&&e._manager.updateDependencies())};f=new b(a,f,{onPause:c,onRemove:c,onResume:function(a){var b=e._incoming[a.match.eventType];b&&-1===b.indexOf(a)&&(b.push(a),g(),e._manager&&
e._manager.updateDependencies())}});c=this._incoming[a.eventType];c||(c=[],this._incoming[a.eventType]=c);c.push(f);g();this._manager&&this._manager.updateDependencies();return f};c.prototype.registerOutgoing=function(a){var b=this;if(this._outgoing[a])throw Error("There is already a callback registered for this outgoing InputEvent: "+a);var c=new k(a,{onEmit:function(a,c,d,e){b._manager.emit(a.eventType,c,d,e)},onRemove:function(a){delete b._outgoing[a.eventType];b._manager.updateDependencies()}});
this._outgoing[a]=c;this._outgoingEventTypes=null;this._manager&&this._manager.updateDependencies();return c};c.prototype.startCapturingPointer=function(a){this._manager.setPointerCapture(a,!0)};c.prototype.stopCapturingPointer=function(a){this._manager.setPointerCapture(a,!1)};c.prototype._onUninstall=function(){this._manager?(this.onUninstall(),this._manager=null):a.error("This InputHandler is not registered with an InputManager")};c.prototype._handleEvent=function(a){var b=this._incoming[a.type];
if(b)for(var c=0;c<b.length;c++){var d=b[c];if(d.match.matches(a)&&(d.callback(a),a.shouldStopPropagation()))break}};return c}();h.InputHandler=m;var b=function(){function a(a,b,c){this.match=a;this._callback=b;this._handler=c}a.prototype.pause=function(){this._handler.onPause(this)};a.prototype.resume=function(){this._handler.onResume(this)};a.prototype.remove=function(){this._handler.onRemove(this)};Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},enumerable:!0,
configurable:!0});return a}(),k=function(){function a(a,b){this.eventType=a;this._removed=!1;this._handler=b}a.prototype.emit=function(a,b,c){if(!this._removed)this._handler.onEmit(this,a,b,c)};a.prototype.remove=function(){this._removed=!0;this._handler.onRemove(this)};return a}()})},"esri/views/input/EventMatch":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function d(c,a){void 0===a&&(a=[]);this.eventType=c;this.keyModifiers=
a}d.prototype.matches=function(c){if(c.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;c=c.modifiers;for(var a=0,b=this.keyModifiers;a<b.length;a++)if(!c.has(b[a]))return!1;return!0};return d}();h.EventMatch=m})},"esri/views/input/recognizers/support":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.manhattanDistance=function(d,c){return Math.abs(c.x-d.x)+Math.abs(c.y-d.y)};h.fitCircleLSQ=function(d,c){c?(c.radius=0,c.center.x=
0,c.center.y=0):c={radius:0,center:{x:0,y:0}};if(0===d.length)return c;if(1===d.length)return c.center.x=d[0].x,c.center.y=d[0].y,c;if(2===d.length){var a=d[0];d=d[1];var b=[d.x-a.x,d.y-a.y],k=b[0],b=b[1];c.radius=Math.sqrt(k*k+b*b)/2;c.center.x=(a.x+d.x)/2;c.center.y=(a.y+d.y)/2;return c}for(var f=0,g=0,e=0;e<d.length;e++)f+=d[e].x,g+=d[e].y;for(var f=f/d.length,g=g/d.length,l=d.map(function(a){return a.x-f}),p=d.map(function(a){return a.y-g}),v=a=c=0,q=0,n=k=0,e=b=0;e<l.length;e++){var t=l[e],h=
p[e],x=t*t,r=h*h;c+=x;a+=r;v+=t*h;q+=x*t;k+=r*h;n+=t*r;b+=h*x}e=c;l=v;p=a;q=.5*(q+n);k=.5*(k+b);b=e*p-v*l;n=(q*p-k*l)/b;k=(e*k-v*q)/b;return{radius:Math.sqrt(n*n+k*k+(c+a)/d.length),center:{x:n+f,y:k+g}}}})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(b){function c(a,c,d){void 0===a&&(a=300);void 0===
c&&(c=1.5);void 0===d&&(d=500);var e=b.call(this,"recognizers.PointerClickHoldAndDrag",!1)||this;e.maximumClickDelay=a;e.movementUntilDrag=c;e.holdDelay=d;e._pointerState=new Map;e._modifiers=new Set;e._pointerDrag=e.registerOutgoing("pointer-drag");e._pointerClick=e.registerOutgoing("pointer-click");e._pointerHold=e.registerOutgoing("hold");e.registerIncoming("pointer-down",e._handlePointerDown.bind(e));e.registerIncoming("pointer-up",e._handlePointerUpOrLost.bind(e));e.registerIncoming("pointer-capture-lost",
e._handlePointerUpOrLost.bind(e));e._moveHandle=e.registerIncoming("pointer-move",e._handlePointerMove.bind(e));e._moveHandle.pause();return e}d(c,b);c.prototype.onUninstall=function(){this._pointerState.forEach(function(a){0!==a.holdTimeout&&(clearTimeout(a.holdTimeout),a.holdTimeout=0)});b.prototype.onUninstall.call(this)};c.prototype._handlePointerDown=function(a){var b=this,c=a.data,d=c.native.pointerId,f=0;0===this._pointerState.size&&(f=setTimeout(function(){var c=b._pointerState.get(d);c&&
(c.isDragging||(b._pointerHold.emit(c.previousEvent,void 0,a.modifiers),c.holdEmitted=!0),c.holdTimeout=0)},this.holdDelay));1===this._pointerState.size&&this._pointerState.forEach(function(a){0!==a.holdTimeout&&(clearTimeout(a.holdTimeout),a.holdTimeout=0)});this._pointerState.set(d,{startEvent:c,previousEvent:c,startTimestamp:a.timestamp,totalMovement:0,isDragging:!1,downButton:c.native.button,holdTimeout:f});this.startCapturingPointer(c.native);this._moveHandle.resume()};c.prototype._createPointerDragData=
function(a,b,c){return{action:a,startEvent:b.startEvent,previousEvent:b.previousEvent,currentEvent:c}};c.prototype._handlePointerMove=function(b){var c=b.data,d=this._pointerState.get(c.native.pointerId);d&&(d.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",d,c),void 0,this._modifiers):(d.totalMovement+=a.manhattanDistance(c,d.previousEvent),d.totalMovement>this.movementUntilDrag&&(d.isDragging=!0,d.previousEvent=d.startEvent,this._modifiers=b.modifiers,0!==d.holdTimeout&&clearTimeout(d.holdTimeout),
this._pointerDrag.emit(this._createPointerDragData("start",d,d.startEvent),d.startTimestamp),this._pointerDrag.emit(this._createPointerDragData("update",d,c)))),d.previousEvent=c)};c.prototype._handlePointerUpOrLost=function(a){var b=a.data,c=b.native.pointerId,d=this._pointerState.get(c);d&&(0!==d.holdTimeout&&clearTimeout(d.holdTimeout),d.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",d,b),void 0,this._modifiers):d.downButton===b.native.button&&a.timestamp-d.startTimestamp<=
this.maximumClickDelay&&!d.holdEmitted&&this._pointerClick.emit(b),this._pointerState.delete(c),this.stopCapturingPointer(b.native),0===this._pointerState.size&&this._moveHandle.pause())};return c}(c.InputHandler);h.PointerClickHoldAndDrag=m})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(b){function c(a,
c,d){void 0===a&&(a=250);void 0===c&&(c=10);void 0===d&&(d=35);var e=b.call(this,"recognizers.SingleAndDoubleClick",!1)||this;e.maximumDoubleClickDelay=a;e.maximumDoubleClickDistance=c;e.maximumDoubleTouchDistance=d;e._pointerState=new Map;e._click=e.registerOutgoing("click");e._doubleClick=e.registerOutgoing("double-click");e.registerIncoming("pointer-click",e._handlePointerClick.bind(e));return e}d(c,b);c.prototype._pointerId=function(a){a=a.native;return"mouse"===a.pointerType?a.pointerId+":"+
a.button:""+a.pointerType};c.prototype._handlePointerClick=function(b){var c=b.data,d=this._pointerId(c),f=this._pointerState.get(d);if(f){clearTimeout(f.doubleClickTimeout);f.doubleClickTimeout=0;var k="touch"===c.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;a.manhattanDistance(f.event.data,c)>k?(this._doubleClickTimeoutExceeded(d),this._startClick(b)):(this._doubleClick.emit(c,void 0,f.event.modifiers),this._pointerState.delete(d))}else this._startClick(b)};
c.prototype._startClick=function(a){var b=this,c=this._pointerId(a.data);this._pointerState.set(c,{event:a,doubleClickTimeout:setTimeout(function(){return b._doubleClickTimeoutExceeded(c)},this.maximumDoubleClickDelay)})};c.prototype._doubleClickTimeoutExceeded=function(a){var b=this._pointerState.get(a);this._click.emit(b.event.data,void 0,b.event.modifiers);b.doubleClickTimeout=0;this._pointerState.delete(a)};return c}(c.InputHandler);h.SingleAndDoubleClick=m})},"esri/views/input/recognizers/VerticalTwoFingerDrag":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function b(b,c){void 0===b&&(b=20);void 0===c&&(c=40);var d=a.call(this,"recognizers.VerticalTwoFingerDrag",!1)||this;d._threshold=b;d._maxDelta=c;d._failed=!1;d._active=!1;d._vertical=d.registerOutgoing("vertical-two-finger-drag");d._artificalDragEnd=d.registerOutgoing("drag");d.registerIncoming("drag",d._handleDrag.bind(d));return d}d(b,a);Object.defineProperty(b.prototype,
"failed",{get:function(){return this._failed},enumerable:!0,configurable:!0});b.prototype._handleDrag=function(a){if(2===a.data.pointers.length)switch(a.data.action){case "start":this._handleDragStart(a);break;case "update":this._handleDragUpdate(a);break;case "end":this._handleDragEnd(a)}};b.prototype._handleDragStart=function(a){this._failed=!1;this._dragStartCenter=a.data.currentState.center};b.prototype._handleDragUpdate=function(a){this._failed||(this._active?(this._vertical.emit({delta:a.data.currentState.center.y-
this._thresholdReachedCenter.y,action:"update"}),a.stopPropagation()):(this._failed=!this._checkDeltaConstraint(a.data),!this._failed&&this._checkThresholdReached(a.data)&&(this._active=!0,this._thresholdReachedCenter=a.data.currentState.center,this._artificalDragEnd.emit({action:"end",currentState:a.data.currentState,previousState:a.data.previousState,startState:a.data.startState,pointers:a.data.pointers}),this._vertical.emit({delta:a.data.currentState.center.y-this._thresholdReachedCenter.y,action:"begin"}),
a.stopPropagation())))};b.prototype._handleDragEnd=function(a){this._active&&(this._vertical.emit({delta:a.data.currentState.center.y-this._thresholdReachedCenter.y,action:"end"}),a.stopPropagation());this._active=!1};b.prototype._checkDeltaConstraint=function(a){var b=Math.abs(a.pointers[0].startEvent.x-a.pointers[1].startEvent.x),c=Math.abs(a.pointers[0].startEvent.y-a.pointers[1].startEvent.y),d=Math.abs(a.pointers[0].currentEvent.y-a.pointers[1].currentEvent.y),l=Math.abs(a.pointers[0].currentEvent.x-
a.pointers[1].currentEvent.x);return Math.abs(a.currentState.center.x-a.startState.center.x)<this._threshold&&Math.abs(l-b)<=this._maxDelta&&Math.abs(d-c)<=this._maxDelta};b.prototype._checkThresholdReached=function(a){return Math.min(Math.abs(a.pointers[0].currentEvent.y-a.pointers[0].startEvent.y),Math.abs(a.pointers[1].currentEvent.y-a.pointers[1].startEvent.y),Math.abs(a.currentState.center.y-a.startState.center.y))>=this._threshold};return b}(c.InputHandler);h.VerticalTwoFingerDrag=m})},"esri/views/input/handlers/LatestPointerType":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function b(b){var c=a.call(this,"LatestPointerInteraction",!0)||this;c._onChange=b;c._value="mouse";c.registerIncoming("pointer-down",function(a){c._setValue("touch"===a.data.native.pointerType?"touch":"mouse")});c._moveHandler=c.registerIncoming("pointer-move",function(a){c._setValue("touch"===a.data.native.pointerType?"touch":"mouse")});c._moveHandler.pause();
return c}d(b,a);b.prototype._setValue=function(a){a!==this._value&&("touch"===a?this._moveHandler.resume():this._moveHandler.pause(),this._value=a,this._onChange(a))};return b}(c.InputHandler);h.LatestPointerType=m})},"esri/views/input/BrowserEventSource":function(){define(["require","exports","./keys","../../core/libs/pep/pep","dojo/sniff"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});var b=a("trident"),k=a("edge"),f=a("chrome"),g=a("ff"),e=a("safari");m=function(){function a(a){this._active=
{};this._activePointerCaptures=new Set;this._keyDownState=new Set;this._element=a;c.applyLocal(a);a.getAttribute("tabindex")||a.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointerDown,"pointer-move":this._handlePointer,"pointer-up":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};this._initialCssTouchAction=a.style.touchAction;a.style.touchAction="none"}
a.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._element.releasePointerCapture(b)});this._activePointerCaptures=null;this._element.style.touchAction=this._initialCssTouchAction};Object.defineProperty(a.prototype,"onEventReceived",{set:function(a){this._callback=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeEvents",{set:function(a){var b=this,c;for(c in this._active)a&&a.has(c)||(this._element.removeEventListener(l[c],
this._active[c]),delete this._active[c]);a&&a.forEach(function(a){if(!b._active[a]&&l[a]){var c=(b._eventHandlers[a]||b._handleDefault).bind(b,a);b._element.addEventListener(l[a],c);b._active[a]=c}})},enumerable:!0,configurable:!0});a.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),this._activePointerCaptures.add(a.pointerId)):(this._element.releasePointerCapture(a.pointerId),this._activePointerCaptures.delete(a.pointerId))};a.prototype._updateNormalizedPointerLikeEvent=
function(a,b){var c=this._element.getBoundingClientRect();b.x=a.clientX-Math.round(c.left);b.y=a.clientY-Math.round(c.top);return b};a.prototype._handleKey=function(a,b){var c=d.eventKey(b);c&&"key-up"===a&&this._keyDownState.delete(c);b={native:b,key:c,repeat:c&&this._keyDownState.has(c)};c&&"key-down"===a&&this._keyDownState.add(b.key);this._callback(a,b)};a.prototype._handlePointerDown=function(a,b){b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0});this._callback(a,b)};a.prototype._handlePointer=
function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0});b.preventDefault();this._callback(a,c)};a.prototype._handleMouseWheel=function(a,c){c.preventDefault();var d=c.deltaY;switch(c.deltaMode){case 0:if(b||k)d=d/document.documentElement.clientHeight*600;break;case 1:d*=30;break;case 2:d*=900}b||k?d*=.7:f||e?d*=.6:g&&(d*=1.375);var l=Math.abs(d);100<l&&(d=d/l*200/(1+Math.exp(-.02*(l-100))));c=this._updateNormalizedPointerLikeEvent(c,{native:c,x:0,y:0,deltaY:d});this._callback(a,
c)};a.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures.delete(b.pointerId);this._handleDefault(a,b)};a.prototype._handleDefault=function(a,b){var c={native:b};b.preventDefault();this._callback(a,c)};return a}();h.BrowserEventSource=m;var l={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu"}})},
"esri/core/libs/pep/pep":function(){define(function(){function m(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);a=2;for(var d;a<e.length;a++)d=e[a],c[d]=b[d]||l[a];c.buttons=b.buttons||0;a=0;a=b.pressure?b.pressure:c.buttons?.5:0;c.x=c.clientX;c.y=c.clientY;c.pointerId=b.pointerId||0;c.width=b.width||0;c.height=b.height||0;c.pressure=a;c.tiltX=b.tiltX||0;c.tiltY=b.tiltY||0;c.pointerType=b.pointerType||"";c.hwTimestamp=b.hwTimestamp||
0;c.isPrimary=b.isPrimary||!1;return c}function h(){this.array=[];this.size=0}function d(a,b,c,d){this.addCallback=a.bind(d);this.removeCallback=b.bind(d);this.changedCallback=c.bind(d);A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function c(b){return"body /shadow-deep/ "+a(b)}function a(a){return'[touch-action\x3d"'+a+'"]'}function b(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; touch-action-delay: none; }"}function k(){if(G){E.forEach(function(d){String(d)===d?(H+=a(d)+
b(d)+"\n",J&&(H+=c(d)+b(d)+"\n")):(H+=d.selectors.map(a)+b(d.rule)+"\n",J&&(H+=d.selectors.map(c)+b(d.rule)+"\n"))});var d=document.createElement("style");d.textContent=H;document.head.appendChild(d)}}function f(a){if(!u.pointermap.has(a))throw a=Error("InvalidPointerId"),a.name="InvalidPointerId",a;}function g(a){if(!a.ownerDocument.contains(a))throw a=Error("InvalidStateError"),a.name="InvalidStateError",a;}var e="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),
l=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],p=window.Map&&window.Map.prototype.forEach?Map:h;h.prototype={set:function(a,b){if(void 0===b)return this.delete(a);this.has(a)||this.size++;this.array[a]=b},has:function(a){return void 0!==this.array[a]},delete:function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var v=
"bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),q=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],n={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},t="undefined"!==typeof SVGElementInstance,u={pointermap:new p,eventMap:Object.create(null),
captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b=this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.register.call(d,a)},unregister:function(a){for(var b=this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.unregister.call(d,
a)},contains:function(a,b){try{return a.contains(b)}catch(aa){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1;this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",
a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&this.eventMap[b])&&b(a);a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,
this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new m(a,b);b.preventDefault&&(a.preventDefault=b.preventDefault);a._target=a._target||b.target;return a},fireEvent:function(a,b){a=this.makeEvent(a,b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b=Object.create(null),c,d=0;d<v.length;d++)c=v[d],b[c]=a[c]||q[d],t&&("target"===c||"relatedTarget"===c)&&b[c]instanceof
SVGElementInstance&&(b[c]=b[c].correspondingUseElement);a.preventDefault&&(b.preventDefault=function(){a.preventDefault()});return b},getTarget:function(a){var b=this.captureInfo[a.pointerId];if(!b)return a._target;if(a._target===b||!(a.type in n))return b},propagate:function(a,b,c){for(var d=a.target,e=[];!d.contains(a.relatedTarget)&&d!==document;)e.push(d),d=d.parentNode;c&&e.reverse();e.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b){this.captureInfo[a]&&this.releaseCapture(a);
this.captureInfo[a]=b;var c=new m("gotpointercapture");c.pointerId=a;this.implicitRelease=this.releaseCapture.bind(this,a);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)},releaseCapture:function(a){var b=this.captureInfo[a];if(b){var c=new m("lostpointercapture");c.pointerId=a;this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",
this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)}},dispatchEvent:function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};u.boundHandler=u.eventHandler.bind(u);var x={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);if(this.canTarget(a))return a},olderShadow:function(a){var b=
a.olderShadowRoot;!b&&(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var d=a.elementFromPoint(b,c),e;for(e=this.targetingShadow(d);e;){if(a=e.elementFromPoint(b,c))return d=this.targetingShadow(a),this.searchRoot(d,b,c)||a;e=this.olderShadow(e)}return d}},owner:function(a){for(;a.parentNode;)a=a.parentNode;a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==
Node.DOCUMENT_FRAGMENT_NODE&&(a=document);return a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);a.elementFromPoint(b,c)||(a=document);return this.searchRoot(a,b,c)}},r=Array.prototype.forEach.call.bind(Array.prototype.forEach),z=Array.prototype.map.call.bind(Array.prototype.map),B=Array.prototype.slice.call.bind(Array.prototype.slice),C=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,D={subtree:!0,childList:!0,
attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};d.prototype={watchSubtree:function(a){this.observer&&x.canTarget(a)&&this.observer.observe(a,D)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){r(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},
addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(B(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=z(a,this.findElements,this);b.push(C(a,this.isElement));return b.reduce(this.concatLists,[])},
mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var E=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],H="",G=window.PointerEvent||window.MSPointerEvent,J=!window.ShadowDOMPolyfill&&
document.head.createShadowRoot,I=u.pointermap,F=[1,4,2,8,16],N=!1;try{N=1===(new MouseEvent("test",{buttons:1})).buttons}catch(ga){}var L={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var d=0,e=b.length,f;d<e&&(f=b[d]);d++){var g=Math.abs(a-f.y);
if(25>=Math.abs(c-f.x)&&25>=g)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=this.POINTER_ID;b.isPrimary=!0;b.pointerType=this.POINTER_TYPE;return b},prepareButtonsForMove:function(a,b){var c=I.get(this.POINTER_ID);a.buttons=0!==b.which&&c?c.buttons:0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=I.get(this.POINTER_ID),c=this.prepareEvent(a);N||(c.buttons=F[c.button],
b&&(c.buttons|=b.buttons),a.buttons=c.buttons);I.set(this.POINTER_ID,a);b&&0!==b.buttons?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;I.set(this.POINTER_ID,a);u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=I.get(this.POINTER_ID),c=this.prepareEvent(a);if(!N){var d=F[c.button];c.buttons=b?b.buttons&~d:0;a.buttons=c.buttons}I.set(this.POINTER_ID,a);c.buttons&=
~F[c.button];0===c.buttons?u.up(c):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;I.set(this.POINTER_ID,a);u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;u.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);u.cancel(a);this.deactivateMouse()},deactivateMouse:function(){I.delete(this.POINTER_ID)}},
M=u.captureInfo,K=x.findTarget.bind(x),ba=x.allShadows.bind(x),X=u.pointermap,T,V={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){T.enableOnSubtree(a)},unregister:function(a){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),ba(a).forEach(function(a){a._scrollType=c;u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;u.unlisten(a,this.events);ba(a).forEach(function(a){a._scrollType=
void 0;u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),d=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);d&&b?(a._scrollType=d,ba(a).forEach(function(a){a._scrollType=d},this)):b?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;if("none"===a)return"none";if(a===
b.XSCROLLER)return"X";if(a===b.YSCROLLER)return"Y";if(b.SCROLLER.exec(a))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){if(0===X.size||1===X.size&&X.has(1))this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount()},removePrimaryPointer:function(a){a.isPrimary&&(this.firstXY=this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=
function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;if("touchstart"===a||"touchmove"===a)b=1;return b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=M[d]||K(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=a.radiusX||a.webkitRadiusX||
0;c.height=a.radiusY||a.webkitRadiusY||0;c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var e=this;c.preventDefault=function(){e.scrolling=!1;e.firstXY=null;b.preventDefault()};return c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;a=0;for(var d;a<c.length;a++)d=c[a],b.call(this,this.touchToPointer(d))},shouldScroll:function(a){if(this.firstXY){var b;
b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}this.firstXY=null;return b}},findTouch:function(a,b){for(var c=0,d=a.length,e;c<d&&(e=a[c]);c++)if(e.identifier===b)return!0},vacuumTouches:function(a){var b=a.touches;if(X.size>=b.length){var c=[];X.forEach(function(a,d){1===d||this.findTouch(b,d-2)||c.push(a.out)},this);c.forEach(this.cancelOut,
this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){X.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});u.enterOver(a);u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=X.get(a.pointerId);
if(b){var c=b.out,d=b.outTarget;u.move(a);c&&d!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=d,c.target=d,a.target?(u.leaveOut(c),u.enterOver(a)):(a.target=d,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a);u.leaveOut(a);
this.cleanUpPointer(a)},cleanUpPointer:function(a){X.delete(a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=L.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};T=new d(V.elementAdded,V.elementRemoved,V.elementChanged,V);var P=u.pointermap,W=window.MSPointerEvent&&"number"===typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,U={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),
register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;W&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]);return b},cleanup:function(a){P.delete(a)},MSPointerDown:function(a){P.set(a.pointerId,a);a=this.prepareEvent(a);u.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);u.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b);this.cleanup(a.pointerId)},
MSPointerOut:function(a){a=this.prepareEvent(a);u.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);u.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b);this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){a=u.makeEvent("lostpointercapture",a);u.dispatchEvent(a)},MSGotPointerCapture:function(a){a=u.makeEvent("gotpointercapture",a);u.dispatchEvent(a)}},Y,S;window.navigator.msPointerEnabled?(Y=function(a){f(a);g(this);0!==u.pointermap.get(a).buttons&&
this.msSetPointerCapture(a)},S=function(a){f(a);this.msReleasePointerCapture(a)}):(Y=function(a){f(a);g(this);0!==u.pointermap.get(a).buttons&&u.setCapture(a,this)},S=function(a){f(a);u.releaseCapture(a,this)});var ca=window.PointerEvent||window.MSPointerEvent;return{dispatcher:u,Installer:d,PointerEvent:m,PointerMap:p,targetFinding:x,applyGlobal:function(){k();window.PointerEvent||(window.PointerEvent=m,window.navigator.msPointerEnabled?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,
enumerable:!0}),u.registerSource("ms",U)):(u.registerSource("mouse",L),void 0!==window.ontouchstart&&u.registerSource("touch",V)),u.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Y},releasePointerCapture:{value:S}})},applyLocal:function(a){ca||(window.PointerEvent||(window.navigator.msPointerEnabled?u.registerSource("ms",U):(u.registerSource("mouse",L),void 0!==window.ontouchstart&&u.registerSource("touch",
V)),u.register(document)),window.Element&&!Element.prototype.setPointerCapture&&(a.setPointerCapture=Y.bind(a),a.releasePointerCapture=S.bind(a)),a.getAttribute("touch-action")||a.setAttribute("touch-action","none"))}}})},"esri/views/input/ViewEvents":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./InputHandler","../../geometry/ScreenPoint"],function(m,h,d,c,a){function b(a){return!!f[a]}function k(a){for(var c=0;c<a.length;c++)if(!b(a[c]))return!1;return!0}Object.defineProperty(h,
"__esModule",{value:!0});var f={click:!0,"double-click":!0,hold:!0,drag:!0,"key-down":!0,"key-up":!0,"pointer-down":!0,"pointer-move":!0,"pointer-up":!0,"mouse-wheel":!0},g;(function(a){a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]="Right"})(g||(g={}));m=function(){function a(a){this.handlers=new Map;this.counter=0;this.view=a;this.inputManager=null}a.prototype.connect=function(a){var b=this;a&&this.disconnect();this.inputManager=a;this.handlers.forEach(function(a,c){return b.inputManager.installHandlers(c,
[a])})};a.prototype.disconnect=function(){var a=this;this.inputManager&&this.handlers.forEach(function(b,c){return a.inputManager.uninstallHandlers(c)});this.inputManager=null};a.prototype.destroy=function(){this.disconnect();this.handlers.clear();this.view=null};a.prototype.register=function(a,c,d){var f=this;a=Array.isArray(a)?a:a.split(",");if(!k(a))return a.some(b)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;var g=Array.isArray(c)?
c:[];d=Array.isArray(c)?d:c;var l=this.createUniqueGroupName();c=new e(this.view,a,g,d);this.handlers.set(l,c);this.inputManager&&this.inputManager.installHandlers(l,[c]);return{remove:function(){return f.removeHandler(l)}}};a.prototype.removeHandler=function(a){this.handlers.has(a)&&this.handlers.delete(a);this.inputManager&&this.inputManager.uninstallHandlers(a)};a.prototype.createUniqueGroupName=function(){this.counter+=1;return"viewEvents_"+this.counter};return a}();h.ViewEvents=m;var e=function(b){function c(a,
c,d,e){var f=b.call(this,"esri.views.input.ViewEventHandler",!0)||this;f.view=a;for(a=0;a<c.length;a++)switch(c[a]){case "click":f.registerIncoming("click",d,function(a){return e(f.wrapClick(a))});break;case "double-click":f.registerIncoming("double-click",d,function(a){return e(f.wrapDoubleClick(a))});break;case "hold":f.registerIncoming("hold",d,function(a){return e(f.wrapHold(a))});break;case "drag":f.registerIncoming("drag",d,function(a){return e(f.wrapDrag(a))});break;case "key-down":f.registerIncoming("key-down",
d,function(a){return e(f.wrapKeyDown(a))});break;case "key-up":f.registerIncoming("key-up",d,function(a){return e(f.wrapKeyUp(a))});break;case "pointer-down":f.registerIncoming("pointer-down",d,function(a){return e(f.wrapPointer(a,"pointer-down"))});break;case "pointer-move":f.registerIncoming("pointer-move",d,function(a){return e(f.wrapPointer(a,"pointer-move"))});break;case "pointer-up":f.registerIncoming("pointer-up",d,function(a){return e(f.wrapPointer(a,"pointer-up"))});break;case "mouse-wheel":f.registerIncoming("mouse-wheel",
d,function(a){return e(f.wrapMouseWheel(a))})}return f}d(c,b);c.prototype.wrapClick=function(b){var c=b.data.x,d=b.data.y;return{type:"click",button:"touch"===b.data.native.pointerType?0:b.data.native.button,x:c,y:d,native:b.data.native,timestamp:b.timestamp,screenPoint:new a(c,d),mapPoint:this.view.toMap(c,d),stopPropagation:function(){return b.stopPropagation()}}};c.prototype.wrapDoubleClick=function(a){var b=a.data.x,c=a.data.y;return{type:"double-click",button:"touch"===a.data.native.pointerType?
0:a.data.native.button,x:b,y:c,native:a.data.native,timestamp:a.timestamp,mapPoint:this.view.toMap(b,c),stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapHold=function(a){var b=a.data.x,c=a.data.y;return{type:"hold",button:"touch"===a.data.native.pointerType?0:a.data.native.button,x:b,y:c,native:a.data.native,timestamp:a.timestamp,mapPoint:this.view.toMap(b,c),stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapDrag=function(a){return{type:"drag",action:a.data.action,
x:a.data.currentState.center.x,y:a.data.currentState.center.y,origin:{x:a.data.startState.center.x,y:a.data.startState.center.y},native:a.data.pointers[0].currentEvent.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapKeyDown=function(a){return{type:"key-down",key:a.data.key,repeat:a.data.repeat,native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapKeyUp=function(a){return{type:"key-up",
key:a.data.key,native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapPointer=function(a,b){return{type:b,x:a.data.x,y:a.data.y,pointerId:a.data.native.pointerId,pointerType:a.data.native.pointerType,native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapMouseWheel=function(a){return{type:"mouse-wheel",x:a.data.x,y:a.data.y,deltaY:a.data.deltaY,native:a.data.native,timestamp:a.timestamp,
stopPropagation:function(){return a.stopPropagation()}}};return c}(c.InputHandler)})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function b(){var b=a.call(this,"PreventContextMenu",!0)||this;b.registerIncoming("context-menu",function(a){a.data.native.preventDefault()});return b}d(b,a);return b}(c.InputHandler);h.PreventContextMenu=
m;h.default=m})},"esri/views/3d/input/handlers/pinch/PinchNavigationGlobal":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ../../util ./PinchNavigationBase ./MomentumNavigationGlobal".split(" "),function(m,h,d,c,a,b,k){Object.defineProperty(h,"__esModule",{value:!0});var f;(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]="Vertical"})(f=h.PanMode||(h.PanMode={}));var g=c.vec3d.create(),e=16/180*Math.PI;m=function(b){function l(d,e){var g=
b.call(this,d,e)||this;g.view=d;g._rotation={axis:c.vec3d.create(),valueSmooth:new a.ExponentialFalloff(.05)};g._panning={axis:c.vec3d.create(),plane:{distance:0,normal:c.vec3d.create()},planarCenterScene:c.vec3d.create()};g._scaling={valueSmooth:new a.ExponentialFalloff(.05),centerScreen:c.vec2.create()};g._beginScenePoints={points:[],center:c.vec3d.create()};g._panMode=f.Horizontal;g._navigationSphereRadius=0;g._tmpN=c.vec3d.create();g._tmp2d=c.vec2.create();g._tmpPickPointScreen=c.vec2.create();
g._tmpPickPointScene=c.vec3d.create();g._tmpCurrentPoints=[];g._tmpCurrentCenter=c.vec3d.create();g._tmpD=c.vec3d.create();g._horizonPointScreen=c.vec3d.create();g._horizonPointScene=c.vec3d.create();g._momentumNavigation=new k.MomentumNavigationGlobal(g,e);return g}d(l,b);Object.defineProperty(l.prototype,"momentum",{get:function(){return this._momentumNavigation},enumerable:!0,configurable:!0});l.prototype.onNavigationBegin=function(a){var b=this._tmpPickPointScreen,d=this._tmpPickPointScene,g=
this._helper;this._rotation.valueSmooth.reset();this._scaling.valueSmooth.reset();c.vec2.set2(a.data.currentState.center.x,this.view.height-a.data.currentState.center.y,b);g.picker.pickPointInScreen(b,d)?this._navigationSphereRadius=c.vec3d.length(d):(this._navigationSphereRadius=Math.max(c.vec3d.length(this.beginCamera.center),.9*g.earthUtils.earthRadius),this._helper.spherical.makeRenderCoordSpherePoint(this._navigationSphereRadius,this.beginCamera,b,d));this._panMode=f.Horizontal;3E4>this.view.renderCoordsHelper.getAltitude(this.beginCamera.eye)&&
(this._navigationSphereRadius>c.vec3d.length(this.beginCamera.eye)?this._panMode=f.Vertical:(c.vec3d.normalize(d,this._tmpN),Math.abs(.5*Math.PI-Math.acos(c.vec3d.dot(this.beginCamera.viewForward,this._tmpN)))<e&&(this._panMode=f.Vertical)));if(this._panMode===f.Horizontal)this._computeSpherePoints(a,"startEvent",this._navigationSphereRadius,this.beginCamera,this._beginScenePoints.points),g.spherical.computePointCenter(this._beginScenePoints.points,this._navigationSphereRadius,this._beginScenePoints.center);
else{c.vec3d.set(this.beginCamera.viewForward,this._panning.plane.normal);c.vec3d.normalize(this._panning.plane.normal);c.vec3d.negate(this._panning.plane.normal);var l=c.vec3d.dot(d,this._panning.plane.normal),k=this._horizonPointScreen;c.vec3d.set3(b[0],this.view.height,0,k);var p=this._horizonPointScene,h=c.vec3d.length(this.beginCamera.eye),v=this._navigationSphereRadius;this._helper.spherical.makeRenderCoordSpherePoint(h<v?h-100:v,this.beginCamera,k,p);this.beginCamera.projectPoint(p,k);b[1]=
Math.min(b[1],.9*k[1]);g.picker.pickPointInScreen(b,d)&&(l=c.vec3d.dot(d,this._panning.plane.normal));this._panning.plane.distance=l;c.vec2.set2(a.data.currentState.center.x,this.view.height-a.data.currentState.center.y,this._tmp2d);this._helper.planar.intersectPlaneFromScreenPoint(this._panning.plane,this.beginCamera,this._tmp2d,this._panning.planarCenterScene)}};l.prototype.onNavigationUpdate=function(a,b){var d=this._helper,e=a.data.pointers.length,l=1<e;if(this._panMode===f.Horizontal){var k=
this._navigationSphereRadius;if(l){var p=a.data.startState.radius/a.data.currentState.radius,q=.001875*Math.min(Math.max(a.data.currentState.radius,40),120);this._scaling.valueSmooth.gain=q;this._scaling.valueSmooth.update(p);d.spherical.applyZoom(k,this.view,b,this._scaling.valueSmooth.value);c.vec2.set2(a.data.currentState.center.x,this.view.height-a.data.currentState.center.y,this._scaling.centerScreen);this.momentum.addScaleValue(a.timestamp,this._scaling.valueSmooth.value)}p=this._tmpCurrentPoints;
q=this._tmpCurrentCenter;this._computeSpherePoints(a,"currentEvent",k,b,p);d.spherical.computePointCenter(p,k,q);var p=this._panning.axis,h=d.spherical.rotationFromPoints(k,this._beginScenePoints.center,q,p);d.applyRotation(b,g,p,h);h=this._tmp2d;c.vec2.set2(a.data.currentState.center.x,this.view.height-a.data.currentState.center.y,h);this.momentum.addPanValue(a.timestamp,h,q,p);if(l){l=this._rotation.axis;p=this._tmpCurrentPoints;c.vec3d.normalize(this._beginScenePoints.center,l);this._computeSpherePoints(a,
"currentEvent",k,b,p);k=0;if(2===e)k=d.rotationFromPointsAroundAxis(p[0],this._beginScenePoints.points[0],l);else{for(q=0;q<e;q++)k+=d.rotationFromPointsAroundAxis(p[q],this._beginScenePoints.points[q],l);k/=e}e=this._rotation.valueSmooth.value;k=d.normalizeRotationDelta(k-e);q=.00125*Math.min(Math.max(a.data.currentState.radius,40),120);this._rotation.valueSmooth.gain=q;this._rotation.valueSmooth.update(e+k);e=this._rotation.valueSmooth.value;this.momentum.addRotationValue(a.timestamp,e);d.applyRotation(b,
g,l,e)}}else e=this._panning.plane,l&&(p=a.data.startState.radius/a.data.currentState.radius,q=.001875*Math.min(Math.max(a.data.currentState.radius,40),120),this._scaling.valueSmooth.gain=q,this._scaling.valueSmooth.update(p),this.momentum.addScaleValue(a.timestamp,this._scaling.valueSmooth.value),this.momentum.setVerticalParameters(e,this._panning.planarCenterScene),d.planar.applyZoom(e,this.view,b,this._panning.planarCenterScene,this._scaling.valueSmooth.value)),q=this._tmpCurrentCenter,c.vec2.set2(a.data.currentState.center.x,
this.view.height-a.data.currentState.center.y,this._tmp2d),this._helper.planar.intersectPlaneFromScreenPoint(e,b,this._tmp2d,q),e=this._tmpD,c.vec3d.subtract(q,this._panning.planarCenterScene,e),c.vec3d.subtract(b.eye,e),c.vec3d.subtract(b.center,e),b.markViewDirty(),h=this._tmp2d,c.vec2.set2(a.data.currentState.center.x,this.view.height-a.data.currentState.center.y,h),this.momentum.addPanValue(a.timestamp,h,q,e),l&&(l=this._rotation.axis,c.vec3d.set(this._panning.planarCenterScene,l),k=a.data.currentState.angle,
e=this._rotation.valueSmooth.value,k=d.normalizeRotationDelta(k-e),q=.00125*Math.min(Math.max(a.data.currentState.radius,40),120),this._rotation.valueSmooth.gain=q,this._rotation.valueSmooth.update(e+k),e=this._rotation.valueSmooth.value,this.momentum.addRotationValue(a.timestamp,e),d.applyRotation(b,g,l,e));b.markViewDirty()};l.prototype.onNavigationEnd=function(a){this._panMode===f.Horizontal?this.momentum.setParameters(this._navigationSphereRadius,this._scaling.centerScreen,this._beginScenePoints.center,
this._panMode):this.momentum.setParameters(this._navigationSphereRadius,this._scaling.centerScreen,this._panning.planarCenterScene,this._panMode)};l.prototype._computeSpherePoints=function(a,b,d,e,f){f.length=a.data.pointers.length;for(var g=this._tmp2d,l=0;l<f.length;l++){var k=a.data.pointers[l];g[0]=k[b].x;g[1]=this.view.height-k[b].y;void 0===f[l]&&(f[l]=c.vec3d.create());this._helper.spherical.makeRenderCoordSpherePoint(d,e,g,f[l])}return f};return l}(b.PinchNavigationBase);h.PinchNavigationGlobal=
m})},"esri/views/3d/input/util":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function d(c){this._gain=c}d.prototype.reset=function(c){this._value=c};Object.defineProperty(d.prototype,"gain",{set:function(c){this._gain=c},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"value",{get:function(){return void 0===this._value?0:this._value},enumerable:!0,configurable:!0});d.prototype.update=function(c){this._value=void 0===
this._value?c:this._gain*c+(1-this._gain)*this._value};return d}();h.ExponentialFalloff=m})},"esri/views/3d/input/handlers/pinch/PinchNavigationBase":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../input/InputHandler ../../../lib/glMatrix ../../../webgl-engine/lib/Camera".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});m=function(c){function f(d,e){var f=c.call(this,"esri.views.3d.input.handlers.PinchTest",!0)||this;f.view=
d;f._helper=e;f._lastEndTimestamp=0;f._dragNavigationActive=!1;f._beginCamera=new b;f._tmpvec2d=a.vec2.create();f.registerIncoming("drag",function(a){return f._handleDrag(a)});f.registerIncoming("pointer-down",function(a){return f.stopMomentumNavigation()});f.registerIncoming("two-finger-drag-vertical",function(a){return f.stopMomentumNavigation()});return f}d(f,c);f.prototype.stopMomentumNavigation=function(){this.momentum&&this.momentum.stop()};f.prototype.destroy=function(){this.momentum&&this.momentum.destroy()};
f.prototype.applyNavigationConstraints=function(){var a=this.view.navigation;a.fixTargetUpVector();a.constrainTargetEyeByElevationAndMoveLookAt();a.targetAndCurrentChanged()};Object.defineProperty(f.prototype,"beginCamera",{get:function(){return this._beginCamera},enumerable:!0,configurable:!0});f.prototype.computePlanePoints=function(b,c,d,f,k){k.length=b.data.pointers.length;for(var e=this._tmpvec2d,g=0;g<k.length;g++){var l=b.data.pointers[g];e[0]=l[c].x;e[1]=this.view.height-l[c].y;void 0===k[g]&&
(k[g]=a.vec3d.create());this._helper.planar.intersectPlaneFromScreenPoint(d,f,e,k[g])}return k};f.prototype._handleDrag=function(a){if(1!==a.data.pointers.length||"mouse"!==a.data.pointers[0].currentEvent.native.pointerType){var b=a.timestamp-this._lastEndTimestamp,b=this.momentum&&this.momentum.active&&40>b;switch(a.data.action){case "start":if(b)break;this._navigationBegin(a);break;case "update":if(b)break;this._dragNavigationActive?this._navigationUpdate(a):this._navigationBegin(a);break;case "end":this._dragNavigationActive&&
(this._lastEndTimestamp=a.timestamp,this._navigationEnd(a))}a.stopPropagation()}};f.prototype._navigationBegin=function(a){var b=this.view.navigation;this.stopMomentumNavigation();this._dragNavigationActive=!0;this.beginCamera.copyFrom(b.currentCamera);b.begin(this);this.onNavigationBegin(a)};f.prototype._navigationUpdate=function(a){if(!(.002>(a.data.currentState.timestamp-a.data.previousState.timestamp)/1E3)){var b=this.view.navigation.targetCamera;b.eye=this.beginCamera.eye;b.center=this.beginCamera.center;
b.up=this.beginCamera.up;this.onNavigationUpdate(a,b);this.applyNavigationConstraints()}};f.prototype._navigationEnd=function(a){this.onNavigationEnd(a);this._dragNavigationActive=!1;this.momentum&&this.momentum.initiate();this.view.navigation.end(this)};return f}(c.InputHandler);h.PinchNavigationBase=m})},"esri/views/3d/webgl-engine/lib/Camera":function(){define(["require","exports","./Util","./gl-matrix"],function(m,h,d,c){function a(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function b(a,
b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}var k=c.vec3d,f=c.vec4d,g=c.mat4d;m=function(){function c(a,b,c){this._viewUp=k.create();this._viewForward=k.create();this._viewRight=k.create();this._viewport=f.create();this._padding=f.create();this._fov=55/180*Math.PI;this._near=0;this._far=1E3;this._viewDirty=!0;this._viewMatrix=g.create();this._projectionDirty=!0;this._projectionMatrix=g.create();this._viewInverseTransposeMatrixDirty=!0;this._viewInverseTransposeMatrix=null;this._frustumPlanesDirty=
!0;this._frustumPlanes=[f.create(),f.create(),f.create(),f.create(),f.create(),f.create()];this._fullViewport=null;this.aboveGround=!0;this._eye=k.create(a);this._center=k.create(b);this._up=void 0!==c?k.create(c):k.create([0,0,1]);this._padding=f.create()}Object.defineProperty(c.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"center",{get:function(){return this._center},set:function(a){this._compareAndSetView(a,
this._center)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"up",{get:function(){return this._up},set:function(a){this._compareAndSetView(a,this._up)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"viewMatrix",{get:function(){this._ensureViewClean();return this._viewMatrix},set:function(a){g.set(a,this._viewMatrix);this._viewDirty=!1;this._frustumPlanesDirty=this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"viewForward",{get:function(){this._ensureViewClean();return this._viewForward},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"viewUp",{get:function(){this._ensureViewClean();return this._viewUp},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"viewRight",{get:function(){this._ensureViewClean();return this._viewRight},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"near",{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=
a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"far",{get:function(){return this._far},set:function(a){this._far!==a&&(this._far=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=a[0];this.y=a[1];this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"width",{get:function(){return this._viewport[2]},
set:function(a){a-=this._padding[1]+this._padding[3];this._viewport[2]!==a&&(this._viewport[2]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){return this._viewport[3]},set:function(a){a-=this._padding[0]+this._padding[2];this._viewport[3]!==a&&(this._viewport[3]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fullWidth",{get:function(){return this._viewport[2]+
this._padding[1]+this._padding[3]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=f.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=this.fullWidth;this._fullViewport[3]=
this.fullHeight;return this._fullViewport},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"padding",{get:function(){return this._padding},set:function(a){if(this._padding[0]!==a[0]||this._padding[1]!==a[1]||this._padding[2]!==a[2]||this._padding[3]!==a[3])this._viewport[0]+=a[3]-this._padding[3],this._viewport[1]+=a[2]-this._padding[2],this._viewport[2]-=a[1]+
a[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=a[0]+a[2]-(this._padding[0]+this._padding[2]),f.set(a,this._padding),this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,b=this.height,c=this.near*Math.tan(this.fovY/2),d=c*this.aspect;g.frustum(-d*(1+2*this._padding[3]/a),d*(1+2*this._padding[1]/a),-c*(1+2*this._padding[2]/b),c*(1+2*this._padding[0]/
b),this.near,this.far,this._projectionMatrix);this._projectionDirty=!1}return this._projectionMatrix},set:function(a){g.set(a,this._projectionMatrix);this._projectionDirty=!1;this._frustumPlanesDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fov",{get:function(){return this._fov},set:function(a){this._fov=a;this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fovX",{get:function(){return d.fovd2fovx(this._fov,
this.width,this.height)},set:function(a){this._fov=d.fovx2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fovY",{get:function(){return d.fovd2fovy(this._fov,this.width,this.height)},set:function(a){this._fov=d.fovy2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"distance",{get:function(){return k.dist(this._center,
this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"angleOfElevation",{get:function(){k.subtract(this._center,this._eye,e);k.normalize(e);var a=k.dot(this._center,e)/k.length(this._center);return Math.acos(d.clamp(a,-1,1))-.5*Math.PI},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"frustumPoints",{get:function(){return this.computeFrustumPoints()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"frustumPlanes",{get:function(){this._frustumPlanesDirty&&
(this._frustumPlanes=this._computeFrustumPlanes(this._frustumPlanes),this._frustumPlanesDirty=!1);return this._frustumPlanes},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=g.create()),g.inverse(this.viewMatrix,this._viewInverseTransposeMatrix),g.transpose(this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=
!1;return this._viewInverseTransposeMatrix},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"perPixelRatio",{get:function(){return Math.tan(this.fovX/2)/this.width},enumerable:!0,configurable:!0});c.prototype.copyFrom=function(a){k.set(a._eye,this._eye);k.set(a._center,this._center);k.set(a._up,this._up);f.set(a._viewport,this._viewport);f.set(a._padding,this._padding);this._near=a._near;this._far=a._far;this._fov=a._fov;this.aboveGround=a.aboveGround;a._viewDirty?this._frustumPlanesDirty=
this._viewDirty=!0:(g.set(a._viewMatrix,this._viewMatrix),k.set(a._viewRight,this._viewRight),k.set(a._viewUp,this._viewUp),k.set(a._viewForward,this._viewForward),this._viewDirty=!1);a._projectionDirty?this._frustumPlanesDirty=this._projectionDirty=!0:(g.set(a._projectionMatrix,this._projectionMatrix),this._projectionDirty=!1);return this};c.prototype.copy=function(){var a=new c;a.copyFrom(this);return a};c.prototype.equals=function(c){return a(this._eye,c._eye)&&a(this._center,c._center)&&a(this._up,
c._up)&&b(this._viewport,c._viewport)&&b(this._padding,c._padding)&&this._near===c._near&&this._far===c._far&&this._fov===c._fov};c.prototype.almostEquals=function(a,b){b=k.dist(this.eye,this.center)*(b||5E-4);b*=b;if(b=k.dist2(a.eye,this.eye)<b&&k.dist2(a.center,this.center)<b&&.001>Math.abs(a.fov-this.fov)){var c=a.padding,d=this.padding;a=d[0]-c[0];b=d[1]-c[1];var e=d[2]-c[2],c=d[3]-c[3];b=.5>a*a+b*b+e*e+c*c}return b};c.prototype.markViewDirty=function(){this._frustumPlanesDirty=this._viewDirty=
!0};c.prototype.computePixelSizeAt=function(a){return 2*k.dist(a,this._eye)*Math.tan(this.fovX/2)/this.width};c.prototype.computePixelSizeAtDist=function(a){return 2*a*Math.tan(this.fovX/2)/this.width};c.prototype.computeDistanceFromRadius=function(a,b){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(b||1)))};c.prototype.copyFrustumPlanes=function(a){if(!a){a=Array(6);for(var b=0;6>b;++b)a[b]=f.create()}for(var c=this.frustumPlanes,b=0;6>b;b++)f.set(c[b],a[b]);return a};c.prototype.computeFrustumPoints=
function(a){if(!a){a=Array(8);for(var b=0;8>b;++b)a[b]=k.create()}d.matrix2frustum(this.viewMatrix,this.projectionMatrix,a);return a};c.prototype.setGLViewport=function(a){var b=this.viewport,c=this.padding;a.setViewport(b[0]-c[3],b[1]-c[2],b[2]+c[1]+c[3],b[3]+c[0]+c[2])};c.prototype.applyProjection=function(a,b,c){void 0===c&&(c=!1);a!==l&&k.set(a,l);l[3]=1;c&&(b[2]=-l[2]);g.multiplyVec4(this.projectionMatrix,l);k.scale(l,1/Math.abs(l[3]));a=this.fullViewport;b[0]=d.lerp(0,a[0]+a[2],.5+.5*l[0]);
b[1]=d.lerp(0,a[1]+a[3],.5+.5*l[1]);c||(b[2]=.5*(l[2]+1));return b};c.prototype.projectPoint=function(a,b,c){void 0===c&&(c=!1);g.multiplyVec3(this.viewMatrix,a,l);return this.applyProjection(l,b,c)};c.prototype.unprojectPoint=function(a,b,c){void 0===c&&(c=!1);if(c)return console.error("Camera.unprojectPoint() not yet implemented for linear Z"),null;g.multiply(this.projectionMatrix,this.viewMatrix,p);if(!g.inverse(p))return null;c=this.fullViewport;l[0]=2*(a[0]-c[0])/c[2]-1;l[1]=2*(a[1]-c[1])/c[3]-
1;l[2]=2*a[2]-1;l[3]=1;g.multiplyVec4(p,l);if(0===l[3])return null;b[0]=l[0]/l[3];b[1]=l[1]/l[3];b[2]=l[2]/l[3];return b};c.prototype.computeUpOnSphere=function(){k.subtract(this.center,this.eye,v);var a=k.length(this.center);1>a?k.set3(0,0,1,this.up):Math.abs(k.dot(v,this.center))>.9999*k.length(v)*a||(k.cross(v,this.center,this.up),k.cross(this.up,v,this.up),k.normalize(this.up))};c.prototype._compareAndSetView=function(b,c){a(b,c)||(k.set(b,c),this._frustumPlanesDirty=this._viewDirty=!0)};c.prototype._computeFrustumPlanes=
function(a){if(!a){a=Array(6);for(var b=0;6>b;++b)a[b]=f.create()}d.matrix2frustumPlanes(this.viewMatrix,this.projectionMatrix,a);return a};c.prototype._ensureViewClean=function(){this._viewDirty&&(g.lookAt(this._eye,this._center,this._up,this._viewMatrix),k.set3(-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10],this._viewForward),k.set3(this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9],this._viewUp),k.set3(this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8],this._viewRight),
this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)};return c}();var e=k.create(),l=f.create(),p=g.create(),v=k.create();return m})},"esri/views/3d/input/handlers/pinch/MomentumNavigationGlobal":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ./MomentumNavigationBase ./PinchNavigationGlobal".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});var k=c.vec3d.create();m=function(a){function f(b,d){b=a.call(this,
b,d)||this;b._panAxisOrDirection=c.vec3d.create();b._centerOnScreen=c.vec2.create();b._centerOnSphere=c.vec3d.create();b._tmpSphereCenter=c.vec3d.create();b._tmpScaleAxis=c.vec3d.create();b._verticalPlane={distance:0,normal:c.vec3d.create()};b._verticalCenter=c.vec3d.create();return b}d(f,a);f.prototype.setParameters=function(a,b,d,f){this._radius=a;c.vec2.set(b,this._centerOnScreen);c.vec3d.set(d,this._centerOnSphere);this._mode=f};f.prototype.addPanValue=function(a,b,d,f){this.pan.estimator.add(b[0],
b[1],d,.001*a);c.vec3d.set(f,this._panAxisOrDirection)};f.prototype.addRotationValue=function(a,b){this.rotation.estimator.add(b,.001*a)};f.prototype.addScaleValue=function(a,b){this.zoom.estimator.add(b,.001*a)};f.prototype.setVerticalParameters=function(a,b){c.vec3d.set(b,this._verticalCenter);c.vec3d.set(a.normal,this._verticalPlane.normal);this._verticalPlane.distance=a.distance};f.prototype.onUpdate=function(a,d,f){var e=this._radius,g=this._centerOnScreen,l=this._centerOnSphere;if(this.zoom.momentum){var p=
this.zoom.momentum.valueDelta(a,d);this._mode===b.PanMode.Horizontal?(this.helper.spherical.applyZoom(e,this.view,f,p),this.helper.spherical.makeRenderCoordSpherePoint(e,f,g,this._tmpSphereCenter),e=this.helper.spherical.rotationFromPoints(e,l,this._tmpSphereCenter,this._tmpScaleAxis),this.helper.applyRotation(f,k,this._tmpScaleAxis,e)):this.helper.planar.applyZoom(this._verticalPlane,this.view,f,this._verticalCenter,p)}this.pan.momentum&&(this._mode===b.PanMode.Horizontal?(e=this.helper.spherical.rotationFromPoints(this._radius,
this.pan.momentum.dataOldest,this.pan.momentum.dataNewest,this._panAxisOrDirection),e/=this.pan.momentum.dataTimeDelta,e*=this.pan.momentum.velocityFactor(a),this.helper.applyRotation(f,k,this._panAxisOrDirection,e*d)):(e=c.vec3d.dist(this.pan.momentum.dataOldest,this.pan.momentum.dataNewest),e/=this.pan.momentum.dataTimeDelta,e*=this.pan.momentum.velocityFactor(a),c.vec3d.normalize(this._panAxisOrDirection),c.vec3d.scale(this._panAxisOrDirection,e*d),c.vec3d.subtract(f.eye,this._panAxisOrDirection),
c.vec3d.subtract(f.center,this._panAxisOrDirection),f.markViewDirty()));this.rotation.momentum&&(a=this.rotation.momentum.valueDelta(a,d),this.helper.applyRotation(f,k,l,a))};return f}(a.MomentumNavigationBase);h.MomentumNavigationGlobal=m})},"esri/views/3d/input/handlers/pinch/MomentumNavigationBase":function(){define(["require","exports","../../../../../core/tsSupport/extendsHelper","../../../../navigation/Momentum"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function a(a,
d){this.pinchNavigation=a;this._helper=d;this.zoom={momentum:null,estimator:new c.ZoomMomentumEstimator(.05),enabled:!0};this.rotation={momentum:null,estimator:new c.RotationMomentumEstimator(.05,3,.05,.95),enabled:!0};this.pan={momentum:null,estimator:new c.ScreenspaceMomentumEstimator(.05,600,6,.82),enabled:!0};this._elapsedTime=0;this._active=!1}a.prototype.destroy=function(){this.stop()};Object.defineProperty(a.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0});
a.prototype.doFrameUpdate=function(a){this._onUpdate(.001*a)};a.prototype.stop=function(){this.pan.estimator.reset();this.rotation.estimator.reset();this.zoom.estimator.reset();this._active=!1};a.prototype.initiate=function(){this._active||(this._elapsedTime=0,this.pan.momentum=null,this.zoom.momentum=null,this.rotation.momentum=null,this.zoom.enabled&&(this.zoom.momentum=this.zoom.estimator.evaluateMomentum()),!this.zoom.momentum&&this.rotation.enabled&&(this.rotation.momentum=this.rotation.estimator.evaluateMomentum()),
this.zoom.momentum||this.rotation.momentum||!this.pan.enabled||(this.pan.momentum=this.pan.estimator.evaluateMomentum()),this._active=null!=(this.zoom.momentum||this.rotation.momentum||this.pan.momentum))};Object.defineProperty(a.prototype,"helper",{get:function(){return this._helper},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"view",{get:function(){return this.pinchNavigation.view},enumerable:!0,configurable:!0});a.prototype._onUpdate=function(a){this.active&&(this.zoom.momentum&&
this.zoom.momentum.isFinished(this._elapsedTime)&&(this.zoom.momentum=null),this.rotation.momentum&&this.rotation.momentum.isFinished(this._elapsedTime)&&(this.rotation.momentum=null),this.pan.momentum&&this.pan.momentum.isFinished(this._elapsedTime)&&(this.pan.momentum=null),this.zoom.momentum||this.rotation.momentum||this.pan.momentum?(this.view.navigation.targetCamera.copyFrom(this.view.navigation.currentCamera),this.onUpdate(this._elapsedTime,a,this.view.navigation.targetCamera),this.pinchNavigation.applyNavigationConstraints(),
this._elapsedTime+=a):this.stop())};return a}();h.MomentumNavigationBase=m})},"esri/views/navigation/Momentum":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./ValueHistory","../3d/lib/glMatrix"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});var b=function(){function a(a,b,c){this._initialVelocity=a;this._stopVelocity=b;this._friction=c;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}
Object.defineProperty(a.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0});a.prototype.isFinished=function(a){return a>this.duration};Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0});a.prototype.value=function(a){a=Math.min(a,this.duration);var b=1-this._friction;return this._initialVelocity*(Math.pow(b,a)-1)/Math.log(b)};a.prototype.valueDelta=function(a,b){var c=this.value(a);return this.value(a+
b)-c};return a}();h.Momentum=b;m=function(){function a(a,b,d,e){void 0===a&&(a=.05);this._minimumInitialVelocity=b;this._stopVelocity=d;this._friction=e;this._history=new c.ValueHistory(1E3*a)}a.prototype.add=function(a,b){void 0!==b&&(b*=1E3);this._history.add(a,b)};a.prototype.reset=function(){this._history.reset()};Object.defineProperty(a.prototype,"stopVelocity",{get:function(){return this._stopVelocity},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},
enumerable:!0,configurable:!0});a.prototype.evaluateMomentum=function(){var a=this._evaluateVelocity();return null!==a?new b(a,this._stopVelocity,this._friction):null};a.prototype._evaluateVelocity=function(){var a=this._history,b=a.oldest,a=a.newest;if(b&&a){var c=(a.timeStamp-b.timeStamp)/1E3;if(0<c&&(b=(a.value-b.value)/c,Math.abs(b)>=this._minimumInitialVelocity))return b}return null};return a}();h.MomentumEstimator=m;var k=function(a){function b(b,c,d){return a.call(this,b,c,d)||this}d(b,a);
b.prototype.value=function(b){b=a.prototype.value.call(this,b);return Math.exp(b)};b.prototype.valueDelta=function(b,c){var d=a.prototype.value.call(this,b);b=a.prototype.value.call(this,b+c);return Math.exp(b-d)};return b}(b);h.ZoomMomentum=k;var f=function(a){function b(b,c,d,e){void 0===b&&(b=.05);void 0===c&&(c=4);void 0===d&&(d=.01);void 0===e&&(e=.95);return a.call(this,b,c,d,e)||this}d(b,a);b.prototype.add=function(b,c){a.prototype.add.call(this,Math.log(b),c)};b.prototype.evaluateMomentum=
function(){var a=this._evaluateVelocity();return null!==a?new k(a,this.stopVelocity,this.friction):null};return b}(m);h.ZoomMomentumEstimator=f;m=function(a){function b(b,c,d,e){void 0===b&&(b=.05);void 0===c&&(c=4);void 0===d&&(d=.01);void 0===e&&(e=.95);return a.call(this,b,c,d,e)||this}d(b,a);b.prototype.add=function(b,c){var d=this._history.newest;if(d){d=d.value;for(b-=d;b>Math.PI;)b-=2*Math.PI;for(;b<-Math.PI;)b+=2*Math.PI;b=d+b}a.prototype.add.call(this,b,c)};return b}(m);h.RotationMomentumEstimator=
m;var g=function(a){function b(b,c,d,e,f,g){b=a.call(this,b,c,d)||this;b.dataOldest=e;b.dataNewest=f;b.dataTimeDelta=g;return b}d(b,a);b.prototype.velocityFactor=function(a){a=Math.min(a,this.duration);return Math.pow(1-this.friction,a)};b.prototype.valueFromInitialVelocity=function(a,b){b=Math.min(b,this.duration);var c=1-this.friction;return a*(Math.pow(c,b)-1)/Math.log(c)};return b}(b);h.ScreenspaceMomentum=g;m=function(){function b(a,b,d,e){void 0===a&&(a=.05);this._minimumInitialVelocity=b;this._stopVelocity=
d;this._friction=e;this._entryPool=[];this._history=new c.ValueHistory(1E3*a)}b.prototype.add=function(b,c,d,e){void 0!==e&&(e*=1E3);var f;0!==this._entryPool.length?(f=this._entryPool.pop(),f.x=b,f.y=c,a.vec3d.set(d,f.data)):f={x:b,y:c,data:a.vec3d.create(d)};this._history.add(f,e)};b.prototype.reset=function(){for(var a=0,b=this._history.values;a<b.length;a++)this._entryPool.push(b[a].value);this._history.reset()};Object.defineProperty(b.prototype,"stopVelocity",{get:function(){return this._stopVelocity},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0});b.prototype.evaluateMomentum=function(){var a=this._evaluateVelocity(),b=this._history.oldest,c=this._history.newest;return null!==a?new g(a,this._stopVelocity,this._friction,b.value.data,c.value.data,.001*(c.timeStamp-b.timeStamp)):null};b.prototype._evaluateVelocity=function(){var a=this._history,b=a.oldest,c=a.newest;if(b&&c&&(a=.001*(c.timeStamp-b.timeStamp),
0<a)){var d=c.value.x-b.value.x,b=c.value.y-b.value.y,b=Math.sqrt(d*d+b*b)/a;if(Math.abs(b)>=this._minimumInitialVelocity)return b}return null};return b}();h.ScreenspaceMomentumEstimator=m})},"esri/views/navigation/ValueHistory":function(){define(["require","exports","../../core/now"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function c(a){this._maximumAge=a;this._values=[]}Object.defineProperty(c.prototype,"values",{get:function(){return this._values},enumerable:!0,
configurable:!0});c.prototype.reset=function(){this._values=[]};c.prototype.add=function(a,b){b=void 0!==b?b:d();this._values.push({value:a,timeStamp:b});this._cleanup(b)};Object.defineProperty(c.prototype,"newest",{get:function(){var a=this._values.length;if(0<a)return this._values[a-1]},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"oldest",{get:function(){if(0<this._values.length)return this._values[0]},enumerable:!0,configurable:!0});c.prototype._cleanup=function(a){for(;0<
this._values.length;)if(this._values[0].timeStamp+this._maximumAge<a)this._values.shift();else break};return c}();h.ValueHistory=m})},"esri/views/3d/input/handlers/pinch/PinchNavigationLocal":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ../../util ./PinchNavigationBase ./MomentumNavigationLocal".split(" "),function(m,h,d,c,a,b,k){Object.defineProperty(h,"__esModule",{value:!0});var f;(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]=
"Vertical"})(f=h.PanMode||(h.PanMode={}));var g=20/180*Math.PI,e=c.vec3d.createFrom(0,0,1);m=function(b){function l(d,e){var f=b.call(this,d,e)||this;f.view=d;f._rotation={valueSmooth:new a.ExponentialFalloff(.05)};f._scaling={valueSmooth:new a.ExponentialFalloff(.05)};f._planeHorizontal={normal:c.vec3d.create(),distance:0};f._planeVertical={normal:c.vec3d.create(),distance:0};f._beginCenterHorizontal=c.vec3d.create();f._beginCenterVertical=c.vec3d.create();f._tmpPoints=[];f._tmpPickPointScreen=c.vec2.create();
f._tmpPickPointScene=c.vec3d.create();f._tmpBwd=c.vec3d.create();f._tmpUp=c.vec3d.create();f._tmpD=c.vec3d.create();f._tmpC3=c.vec3d.create();f._tmpC2=c.vec2.create();f._momentumNavigation=new k.MomentumNavigationLocal(f,e);return f}d(l,b);Object.defineProperty(l.prototype,"momentum",{get:function(){return this._momentumNavigation},enumerable:!0,configurable:!0});l.prototype.onNavigationBegin=function(a){var b=this._helper,d=this._tmpPickPointScreen,l=this._tmpPickPointScene;this._rotation.valueSmooth.reset();
this._scaling.valueSmooth.reset();c.vec2.set2(a.data.currentState.center.x,this.view.height-a.data.currentState.center.y,d);this._planeHorizontal.distance=0;c.vec3d.set(e,this._planeHorizontal.normal);b.picker.pickPointInScreen(d,l)||b.picker.pickFreePointInScreen(d,l);d=this._tmpBwd;c.vec3d.negate(this.beginCamera.viewForward,d);var k=this._tmpUp;c.vec3d.set(e,k);var p=c.vec3d.dot(d,k);this._mode=Math.asin(0>p?-p:p)>=g?f.Horizontal:f.Vertical;this._planeHorizontal.distance=c.vec3d.dot(this._planeHorizontal.normal,
l);0>c.vec3d.dot(this._planeHorizontal.normal,this.beginCamera.eye)-this._planeHorizontal.distance&&(c.vec3d.negate(this._planeHorizontal.normal),this._planeHorizontal.distance*=-1);this._mode===f.Vertical&&(c.vec3d.scale(k,p),c.vec3d.subtract(d,k,this._planeVertical.normal),c.vec3d.normalize(this._planeVertical.normal),this._planeVertical.distance=c.vec3d.dot(this._planeVertical.normal,l),this.computePlanePoints(a,"currentEvent",this._planeVertical,this.beginCamera,this._tmpPoints),b.planar.computePointCenter(this._tmpPoints,
this._beginCenterVertical));this.computePlanePoints(a,"currentEvent",this._planeHorizontal,this.beginCamera,this._tmpPoints);b.planar.computePointCenter(this._tmpPoints,this._beginCenterHorizontal)};l.prototype.onNavigationUpdate=function(a,b){var d=this._helper,e=1<a.data.pointers.length,g=this._mode===f.Horizontal?this._planeHorizontal:this._planeVertical,l=this._mode===f.Horizontal?this._beginCenterHorizontal:this._beginCenterVertical;if(e){var k=a.data.startState.radius/a.data.currentState.radius,
p=.001875*Math.min(Math.max(a.data.currentState.radius,40),120);this._scaling.valueSmooth.gain=p;this._scaling.valueSmooth.update(k);d.planar.applyZoom(g,this.view,b,l,this._scaling.valueSmooth.value);this.momentum.addScaleValue(a.timestamp,this._scaling.valueSmooth.value,g,l)}p=this._tmpC3;this.computePlanePoints(a,"currentEvent",g,b,this._tmpPoints);d.planar.computePointCenter(this._tmpPoints,p);g=this._tmpD;c.vec3d.subtract(p,l,g);c.vec3d.subtract(b.eye,g);c.vec3d.subtract(b.center,g);b.markViewDirty();
k=this._tmpC2;c.vec2.set2(a.data.currentState.center.x,a.data.currentState.center.y,k);this.momentum.addPanValue(a.timestamp,k,p,g);e&&(e=this._planeHorizontal.normal,c.vec3d.set(this._planeHorizontal.normal,e),p=a.data.currentState.angle,g=this._rotation.valueSmooth.value,k=d.normalizeRotationDelta(p-g),p=.00125*Math.min(Math.max(a.data.currentState.radius,40),120),this._rotation.valueSmooth.gain=p,this._rotation.valueSmooth.update(g+k),p=this._rotation.valueSmooth.value,this.momentum.addRotationValue(a.timestamp,
l,e,p),d.applyRotation(b,l,e,p))};l.prototype.onNavigationEnd=function(a){};return l}(b.PinchNavigationBase);h.PinchNavigationLocal=m})},"esri/views/3d/input/handlers/pinch/MomentumNavigationLocal":function(){define(["require","exports","../../../../../core/tsSupport/extendsHelper","../../../lib/glMatrix","./MomentumNavigationBase"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function b(b,d){b=a.call(this,b,d)||this;b._scaleState={plane:{distance:0,normal:c.vec3d.create()},
center:c.vec3d.create()};b._rotationState={center:c.vec3d.create(),axis:c.vec3d.create()};b._panState={direction:c.vec3d.create()};b.pan.enabled=!1;return b}d(b,a);b.prototype.addPanValue=function(a,b,d,l){this.pan.estimator.add(b[0],b[1],d,.001*a);c.vec3d.set(l,this._panState.direction);c.vec3d.normalize(this._panState.direction)};b.prototype.addRotationValue=function(a,b,d,l){this.rotation.estimator.add(l,.001*a);c.vec3d.set(b,this._rotationState.center);c.vec3d.set(d,this._rotationState.axis)};
b.prototype.addScaleValue=function(a,b,d,l){this.zoom.estimator.add(b,.001*a);this._scaleState.plane.distance=d.distance;c.vec3d.set(d.normal,this._scaleState.plane.normal);c.vec3d.set(l,this._scaleState.center)};b.prototype.onUpdate=function(a,b,d){if(this.zoom.momentum){var e=this.zoom.momentum.valueDelta(a,b);this.helper.planar.applyZoom(this._scaleState.plane,this.view,d,this._scaleState.center,e)}this.pan.momentum&&(c.vec3d.normalize(this._panState.direction),e=c.vec3d.dist(this.pan.momentum.dataOldest,
this.pan.momentum.dataNewest),e/=this.pan.momentum.dataTimeDelta,e*=this.pan.momentum.velocityFactor(a),c.vec3d.scale(this._panState.direction,e*b),c.vec3d.subtract(d.eye,this._panState.direction),c.vec3d.subtract(d.center,this._panState.direction),d.markViewDirty());this.rotation.momentum&&(a=this.rotation.momentum.valueDelta(a,b),this.helper.applyRotation(d,this._rotationState.center,this._rotationState.axis,a))};return b}(a.MomentumNavigationBase);h.MomentumNavigationLocal=m})},"esri/views/3d/input/handlers/DoubleClickZoom":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(b){function c(a,c){var d=b.call(this,"esri.views.3d.input.handlers.DoubleClickZoom",!0)||this;d.view=a;d.registerIncoming("double-click",c,function(a){return d._handleDoubleClick(a)});return d}d(c,b);c.prototype._handleDoubleClick=function(b){var c=b.data;a.eventMatchesPointerType(c.native,"primary")&&
(this.view.navigation.zoom.stepScreen(Math.log(.5)/Math.log(.6),[c.x,this.view.height-c.y]),b.stopPropagation())};return c}(c.InputHandler);h.DoubleClickZoom=m})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.eventMatchesPointerType=function(d,c){switch(c){case "primary":return"touch"===d.pointerType||0===d.button;case "secondary":return"touch"!==d.pointerType&&2===d.button;case "tertiary":return"touch"!==
d.pointerType&&1===d.button}}})},"esri/views/3d/input/handlers/DragPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","./support"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(b){function c(a,c,d){var e=b.call(this,"esri.views.3d.input.handlers.DragPan",!0)||this;e.view=a;e.pointerType=c;e.registerIncoming("drag",d,function(a){return e._handleDrag(a)});return e}d(c,b);c.prototype._handleDrag=function(b){var c=
b.data;if(!(1<c.pointers.length)){var d=c.pointers[0];if(a.eventMatchesPointerType(d.startEvent.native,this.pointerType)){var d=[d.currentEvent.x,this.view.height-d.currentEvent.y],f=this.view.navigation.pan;switch(c.action){case "start":f.begin(d,b.timestamp);break;case "update":f.update(d,b.timestamp);break;case "end":f.end(d,b.timestamp)}b.stopPropagation()}}};return c}(c.InputHandler);h.DragPan=m})},"esri/views/3d/input/handlers/support":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,
"__esModule",{value:!0});h.eventMatchesPointerType=function(d,c){switch(c){case "primary":return"touch"===d.pointerType||0===d.button;case "secondary":return"touch"!==d.pointerType&&2===d.button;case "tertiary":return"touch"!==d.pointerType&&1===d.button}}})},"esri/views/3d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ./support ../../navigation/NavigationConstants".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,
"__esModule",{value:!0});m=function(c){function f(a,d,f,k){var e=c.call(this,"esri.views.3d.input.handlers.DragRotate",!0)||this;e.view=a;e.pointerType=d;e.pivotPoint=f;e.registerIncoming("drag",k,function(a){return e._handleDrag(a)});switch(f){case "center":e._navigationPivot=b.Rotate.PivotPoint.POI;break;case "eye":e._navigationPivot=b.Rotate.PivotPoint.EYE}return e}d(f,c);f.prototype._handleDrag=function(b){var c=b.data;if(!(1<c.pointers.length)){var d=c.pointers[0];if(a.eventMatchesPointerType(d.startEvent.native,
this.pointerType)){var d=[d.currentEvent.x,this.view.height-d.currentEvent.y],f=this.view.navigation.rotate;switch(c.action){case "start":f.begin(d,this._navigationPivot);break;case "update":f.update(d,this._navigationPivot);break;case "end":f.end(d)}b.stopPropagation()}}};return f}(c.InputHandler);h.DragRotate=m})},"esri/views/3d/navigation/NavigationConstants":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.Pan={Direction:{LEFT:1,RIGHT:2,
FORWARD:4,BACKWARD:8,UP:16,DOWN:32},Mode:{HORIZONTAL:0,VERTICAL:1},Momentum:{DURATION_SHORT:1,DURATION_LONG:3,DURATION_LONG_VEL:8,INPUT_FILTER:.2,BUFFER_SIZE:5,MINIMUM_VELOCITY:300},Vertical:{ELEVATION_THRESHOLD:3E4,ANGLE_THRESHOLD:8/180*Math.PI}};h.Rotate={PivotPoint:{POI:1,EYE:2}}})},"esri/views/3d/input/handlers/DragZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","./support"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",
{value:!0});m=function(b){function c(a,c,d){var e=b.call(this,"esri.views.3d.input.handlers.DragZoom"+c,!0)||this;e.view=a;e.pointerType=c;e.registerIncoming("drag",d,function(a){return e._handleDrag(a)});return e}d(c,b);c.prototype._handleDrag=function(b){var c=b.data;if(!(1<c.pointers.length)){var d=c.pointers[0];if(a.eventMatchesPointerType(d.startEvent.native,this.pointerType)){var d=[d.currentEvent.x,this.view.height-d.currentEvent.y],f=this.view.navigation.zoom;switch(c.action){case "start":f.begin(d);
break;case "update":f.update(d);break;case "end":f.end(d)}b.stopPropagation()}}};return c}(c.InputHandler);h.DragZoom=m})},"esri/views/3d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../navigation/NavigationConstants"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});var b=a.Pan.Direction;m=function(a){function c(c,d,f){var e=a.call(this,"esri.views.3d.input.handlers.KeyPan",!0)||this;
e.view=c;e.keys=d;e._keyToDirection=(g={},g[d.left]=b.LEFT,g[d.right]=b.RIGHT,g[d.forward]=b.FORWARD,g[d.backward]=b.BACKWARD,g[d.up]=b.UP,g[d.down]=b.DOWN,g);e.registerIncoming("key-down",f,function(a){return e._handleKeyDown(a)});e.registerIncoming("key-up",f,function(a){return e._handleKeyUp(a)});return e;var g}d(c,a);c.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};c.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};c.prototype._handleKey=function(a,b){var c=
this._keyToDirection[a.data.key];null!=c&&(b?this.view.navigation.pan.beginContinuous(c):this.view.navigation.pan.endContinuous(c),a.stopPropagation())};return c}(c.InputHandler);h.KeyPan=m})},"esri/views/3d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function b(b,c){var d=a.call(this,"esri.views.3d.input.handlers.MouseWheelZoom",
!0)||this;d.view=b;d.registerIncoming("mouse-wheel",c,function(a){return d._handleMouseWheel(a)});return d}d(b,a);b.prototype._handleMouseWheel=function(a){var b=a.data;this.view.navigation.zoom.stepScreen(-1/60*b.deltaY,[b.x,this.view.height-b.y]);a.stopPropagation()};return b}(c.InputHandler);h.MouseWheelZoom=m})},"esri/views/3d/input/handlers/SingleKeyResetHeading":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./SingleKey"],function(m,h,d,c){Object.defineProperty(h,
"__esModule",{value:!0});m=function(a){function b(b,c,d){d=a.call(this,"esri.views.3d.input.handlers.SingleKeyResetHeading",c,d)||this;d.view=b;d.key=c;return d}d(b,a);b.prototype.activate=function(){this.view.goTo({heading:0})};return b}(c.SingleKey);h.SingleKeyResetHeading=m})},"esri/views/3d/input/handlers/SingleKey":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});
m=function(a){function b(b,c,d){var e=a.call(this,b,!0)||this;e.key=c;e.registerIncoming("key-down",d,function(a){return e._handleKeyDown(a)});return e}d(b,a);b.prototype._handleKeyDown=function(a){a.data.key===this.key&&(this.activate(),a.stopPropagation())};return b}(c.InputHandler);h.SingleKey=m})},"esri/views/3d/input/handlers/SingleKeyResetTilt":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./SingleKey"],function(m,h,d,c){Object.defineProperty(h,"__esModule",
{value:!0});m=function(a){function b(b,c,d){d=a.call(this,"esri.views.3d.input.handlers.SingleKeyResetTilt",c,d)||this;d.view=b;d.key=c;return d}d(b,a);b.prototype.activate=function(){this.view.goTo({tilt:0})};return b}(c.SingleKey);h.SingleKeyResetTilt=m})},"esri/views/3d/input/handlers/PointerDownCancelAnimation":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function b(b,
c){var d=a.call(this,"esri.views.3d.input.handlers.PointerDownCancelAnimation",!0)||this;d.view=b;d.registerIncoming("pointer-down",c,function(a){return d._handlePointerDown(a)});return d}d(b,a);b.prototype._handlePointerDown=function(a){this.view.navigation.stop()};return b}(c.InputHandler);h.PointerDownCancelAnimation=m})},"esri/views/3d/input/handlers/TwoFingerTilt":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../navigation/NavigationConstants"],
function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(b){function c(a,c){void 0===c&&(c=!1);var d=b.call(this,"esri.views.3d.input.handlers.TwoFingerTilt",!0)||this;d.view=a;d._invert=c;d.registerIncoming("vertical-two-finger-drag",function(a){return d._handleTwoFinger(a)});return d}d(c,b);c.prototype._handleTwoFinger=function(b){var c=this.view,d=[0,-b.data.delta*(this._invert?-1:1)];switch(b.data.action){case "begin":c.navigation.rotate.begin(d,a.Rotate.PivotPoint.POI);
break;case "update":c.navigation.rotate.update(d,a.Rotate.PivotPoint.POI);break;case "end":c.navigation.rotate.end(d)}};return c}(c.InputHandler);h.TwoFingerTilt=m})},"esri/views/3d/input/NavigationHelper":function(){define("require exports ../lib/glMatrix ../support/earthUtils ../webgl-engine/lib/Util ../support/mathUtils".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function a(a){this.picker=a;this.earthUtils=c;this._axisTmp1=d.vec3d.create();this._axisTmp2=
d.vec3d.create();this._axisTmp3=d.vec3d.create();this._tmpTransform2=d.mat4d.create();this.spherical=new f(this);this.planar=new k(this)}a.prototype.normalizeRotationDelta=function(a){for(;a>Math.PI;)a-=2*Math.PI;for(;a<-Math.PI;)a+=2*Math.PI;return a};a.prototype.rotationFromPointsAroundAxis=function(a,b,c){var e=this._axisTmp1,f=this._axisTmp2,g=this._axisTmp3;d.vec3d.set(a,f);d.vec3d.set(b,g);a=d.vec3d.dot(f,c);b=d.vec3d.dot(g,c);d.vec3d.scale(c,a,e);d.vec3d.subtract(f,e);d.vec3d.normalize(f);
d.vec3d.scale(c,b,e);d.vec3d.subtract(g,e);d.vec3d.normalize(g);a=d.vec3d.dot(f,g);d.vec3d.cross(c,f,e);c=d.vec3d.dot(g,e);return Math.atan2(c,a)};a.prototype.applyRotation=function(a,b,c,f){var e=this._tmpTransform2;d.mat4d.identity(e);d.mat4d.rotate(e,f,c);d.vec3d.subtract(a.eye,b);d.mat4d.multiplyVec3(e,a.eye,a.eye);d.vec3d.add(a.eye,b);d.vec3d.subtract(a.center,b);d.mat4d.multiplyVec3(e,a.center,a.center);d.vec3d.add(a.center,b);d.mat4d.multiplyVec3(e,a.up,a.up);a.markViewDirty()};return a}();
h.NavigationHelper=m;var k=function(){function a(a){this._helper=a;this._tmpForward=d.vec3d.create();this._tmpP0=d.vec3d.create();this._tmpP1=d.vec3d.create()}a.prototype.applyZoom=function(a,b,c,f,g){a=this._tmpForward;g=1-g;d.vec3d.subtract(f,c.eye,a);var e=d.vec3d.length(a),l=e*(1-g);0<=g&&4>l&&(l=4);l=b.navigation.limitAltitude(l,f,a,e);1E-6>Math.abs(e-l)||(g=-(l-e)/e,d.vec3d.scale(a,g),d.vec3d.add(c.eye,a),d.vec3d.lerp(c.center,f,g),b.navigation.fixTargetUpVector(),c.markViewDirty())};a.prototype.intersectPlaneFromScreenPoint=
function(a,b,c,f){var e=this._tmpP0,g=this._tmpP1;this._helper.picker.createPickRay(c,null,b.viewMatrix,e,g);d.vec3d.subtract(g,e);b=d.vec3d.dot(a.normal,g);if(0===b)return!1;a=d.vec3d.dot(a.normal,e)-a.distance;d.vec3d.add(e,d.vec3d.scale(g,-a/b,f),f);return!0};a.prototype.computePointCenter=function(a,b){d.vec3d.set3(0,0,0,b);for(var c=0;c<a.length;c++)d.vec3d.add(b,a[c]);d.vec3d.scale(b,1/a.length)};return a}(),f=function(){function c(a){this._helper=a;this._tmpForward=d.vec3d.create();this._tmpP0=
d.vec3d.create();this._tmpP1=d.vec3d.create();this._tmpAxis=d.vec3d.create();this._tmpTransform=d.mat4d.create()}c.prototype.applyZoom=function(a,b,c,f){var e=this._tmpForward;d.vec3d.subtract(c.center,c.eye,e);a/=d.vec3d.length(c.center);var g=1-a,l=d.vec3d.length(e),k;k=b.navigation.limitAltitude(l*f,c.center,e,l);f=k/l;1E-6>Math.abs(l-k)||(d.vec3d.scale(c.center,a+g*f),d.vec3d.scale(e,f),d.vec3d.subtract(c.center,e,c.eye),c.markViewDirty(),b.navigation.applyConstraints(c))};c.prototype.makeRenderCoordSpherePoint=
function(a,b,c,f){this._helper.picker.createPickRay(c,null,b.viewMatrix,this._tmpP0,this._tmpP1);d.vec3d.subtract(this._tmpP1,b.eye);this.intersect(a,b.eye,this._tmpP1,f)||this.closestPointOnSilhouette(a,b.eye,this._tmpP0,f)};c.prototype.intersect=function(b,c,d,f){return a.raySphereClosestPositive(c,d,b,f)};c.prototype.closestPointOnSilhouette=function(a,c,f,g){var e=this._tmpAxis,l=this._tmpTransform;d.vec3d.cross(c,f,e);d.vec3d.cross(e,c,g);d.vec3d.scale(g,1/d.vec3d.length(g)*a);a=-b.asin(a/d.vec3d.length(c));
d.mat4d.identity(l);d.mat4d.rotate(l,a,e);d.mat4d.multiplyVec3(l,g)};c.prototype.rotationFromPoints=function(a,b,c,f){d.vec3d.cross(b,c,f);return-Math.acos(1-d.vec3d.dist2(b,c)/(2*a*a))};c.prototype.computePointCenter=function(a,b,c){d.vec3d.set3(0,0,0,c);for(var e=0;e<a.length;e++)d.vec3d.add(c,a[e]);d.vec3d.normalize(c);d.vec3d.scale(c,b)};return c}()})},"esri/views/3d/support/cameraUtils":function(){define("dojo/_base/lang ../../../geometry/SpatialReference ../../../config ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../Camera ../lib/glMatrix ./mathUtils ./earthUtils ./projectionUtils ./cameraUtilsPlanar ./cameraUtilsSpherical".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p){function v(a,b){return"global"===a.viewingMode?p[b]:l[b]}function q(a,d,g){var l=a.renderSpatialReference,k=z.set(d.viewForward,A),k=x(a,d.eye,k,d.up,D);a=a.spatialReference||h.WGS84;e.vectorToVector(d.eye,l,B,a)||(a=h.WGS84,e.vectorToVector(d.eye,l,B,a));return g?(g.position.x=B[0],g.position.y=B[1],g.position.z=B[2],g.position.spatialReference=a,g.heading=k.heading,g.tilt=k.tilt,g.fov=f.rad2deg(d.fov),g):new b(new c(B,a),k.heading,k.tilt,f.rad2deg(d.fov))}function n(a,
b,c){var e=a.navigation.currentCamera,g=e.fovX,e=e.width/2;"global"===a.viewingMode&&null!=c&&(b*=Math.cos(f.deg2rad(c)));b/=a.renderCoordsHelper.unitInMeters;return e/(39.37*d.screenDPI/b)/Math.tan(g/2)}function t(a,b,c){var e=a.navigation.currentCamera;b=39.37*d.screenDPI/(e.width/2/(b*Math.tan(e.fovX/2)));"global"===a.viewingMode&&(b/=Math.cos(f.deg2rad(c)));return b*=a.renderCoordsHelper.unitInMeters}function u(a,c,d,f,g,l){var k=a.renderSpatialReference;c=r(a,f.heading,f.tilt,c,d,g);a=e.vectorToPoint(c.eye,
k,a.spatialReference||h.WGS84);if(!a)return null;if(!l)return new b(a,c.heading,c.tilt,f.fov);l.position=a;l.heading=c.heading;l.tilt=c.tilt;l.fov=f.fov;return l}function x(a,b,c,d,e){return v(a,"directionToHeadingTilt")(b,c,d,e)}function r(a,b,d,f,g,l){var k=z.create(),p=a.renderSpatialReference;if(f&&f instanceof c){var n=f;e.pointToVector(n,k,a.renderSpatialReference);null==n.z&&("global"===a.viewingMode?a._pickRay([0,0,0],k):a._pickRay([k[0],k[1]-1,k[2]],k),null!=a.basemapTerrain&&(n=a.basemapTerrain.getElevation(n),
null!=n&&a.renderCoordsHelper.setAltitude(n,k)))}else f?z.set(f,k):z.set(a.navigation.currentCamera.center,k);f&&f instanceof c||(f=e.vectorToPoint(k,p,a.spatialReference||h.WGS84));g=Math.max(g,a.navigation.minPoiDist);p=d;d=g;if(!(n=l&&l.noReset))var t=f,n=a.engineToScreen(a.navigation.currentCamera.center),q=a.toScreen(t),t=n.x-q.x,n=n.y-q.y,n=!(Math.sqrt(t*t+n*n)>5*Math.max(a.width,a.height));n?(p=v(a,"eyeTiltToLookAtTilt")(k,d,p),p=a.navigation.constraints.tilt.apply(p,d),p=v(a,"lookAtTiltToEyeTilt")(k,
d,p)):(b=0,p=a.navigation.constraints.tilt.min(d));d=p;b=v(a,"eyeForCenterWithHeadingTilt")(k,g,b,d);b.center=k;return l&&l.noReset||"global"!==a.viewingMode||(k=a.renderCoordsHelper.fromRenderCoords(b.eye,E,a.spatialReference)?a.basemapTerrain&&(a.basemapTerrain.getElevation(E)||0)>E.z-1:!1,!k)?b:(k=a.navigation.constraints.tilt.min(g),r(a,0,k,f,g,m.mixin({},l,{noReset:!0})))}var z=k.vec3d,B=z.create(),C=z.create(),A=z.create(),D={heading:0,tilt:0},E=new c,H=new f.Cyclical(-2.0037508342788905E7,
2.0037508342788905E7);return{externalToInternal:function(a,b){var c=a.renderSpatialReference,d=v(a,"headingTiltToDirectionUp"),g=z.create();return e.pointToVector(b.position,g,c)?(c=d(g,b.heading,b.tilt),z.add(c.direction,g),a=a.navigation.getCameraIntersectTerrain(g,c.direction,c.up),a.fov=f.deg2rad(b.fov),a):null},internalToExternal:q,scaleToDistance:n,distanceToScale:t,fromExtent:function(d,f,l,k,p){k instanceof b&&(p=k,k={});var n="global"===d.viewingMode,t=d.renderSpatialReference,q=d.spatialReference||
h.WGS84,v=h.WebMercator,u=f.spatialReference||v,x,B=0;null!=f.zmax&&null!=f.zmin&&(x=(f.zmax+f.zmin)/2,B=f.zmax-f.zmin);if(n){var n=new c(f.xmin,f.ymin,u),m=new c(f.xmax,f.ymax,u),n=a.project(n,v),m=a.project(m,v);if(null===n||null===m)return;f=new c(H.center(n.x,m.x),(m.y+n.y)/2,v);null!=x&&(f.z=x);x=g.getGreatCircleSpanAt(f,n,m);v=x.lon;u=x.lat;H.diff(n.x,m.x)>H.range/2&&(v+=g.halfEarthCircumference);v=Math.min(v,g.halfEarthCircumference);u=Math.min(u,g.halfEarthCircumference)}else a.canProject(f,
q)&&(f=a.project(f,q)),v=f.xmax-f.xmin,u=f.ymax-f.ymin,f=new c({x:f.xmin+.5*v,y:f.ymin+.5*u,z:x,spatialReference:q});x=d.navigation.currentCamera;l=r(d,l.heading,l.tilt,f,Math.max(1/Math.tan(x.fovX/2)*v*.5,1/Math.tan(x.fovY/2)*u*.5,1/Math.tan(x.fov/2)*B*.5)/1,k);t=e.vectorToPoint(l.eye,t,q);if(!t)return null;p||(p=new b);p.position=t;p.heading=l.heading;p.tilt=l.tilt;p.fov=d.camera.fov;return p},toExtent:function(a,b,c,d,f){var k;k=a.renderSpatialReference;b||(c||(c=a.navigation.currentCamera),b=
q(a,c,f));if(c)f=e.vectorToPoint(c.center,k,a.spatialReference||h.WGS84),k=c.distance;else{f=a.toMap(a.screenCenter);if(!f)return null;k=g.computeCarthesianDistance(b.position,f)}c||(c=a.navigation.currentCamera);b=2*k*Math.tan(c.fovX/2)*1;c=2*k*Math.tan(c.fovY/2)*1;return"global"===a.viewingMode?p.toExtent(a,f,b,c,d):l.toExtent(a,f,b,c,d)},fromCenterScale:function(a,b,c,d,e,f){c=n(a,c,b.latitude);return u(a,b,c,d,e,f)},fromCenterDistance:u,directionToHeadingTilt:x,eyeHeadingTiltForCenterPointAtDistance:r,
scaleToZoom:function(a,b){return(a=a.get("basemapTerrain.tilingScheme"))?a.levelAtScale(b):void 0},zoomToScale:function(a,b){return(a=a.get("basemapTerrain.tilingScheme"))?a.scaleAtLevel(b):void 0},computeScale:function(a,b,c){var d=a.renderSpatialReference;b||(b=a.navigation.currentCamera);var f;f=h.WGS84;b.center?(e.vectorToVector(b.center,d,C,f),f=C[1],b=b.distance):(f=b.position.latitude,e.pointToVector(b.position,B,d),e.pointToVector(c,C,d),b=z.dist(B,C));return t(a,b,f)}}})},"esri/views/3d/support/projectionUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Point ./mathUtils ./earthUtils ../lib/glMatrix ../webgl-engine/lib/BufferVectorMath".split(" "),
function(m,h,d,c,a,b){var k=a.vec3d,f=a.mat4d,g=b.Vec3Compact,e=k.create(),l=k.create(),p=k.create(),v=d.deg2rad(1),q=d.rad2deg(1),n,t,u,x,r=new m({wkt:'\r\n      GEOCCS["Spherical geocentric",\r\n        DATUM["Not specified",\r\n          SPHEROID["Sphere",'+c.earthRadius+',0]],\r\n        PRIMEM["Greenwich",0.0,\r\n          AUTHORITY["EPSG","8901"]],\r\n        UNIT["m",1.0],\r\n        AXIS["Geocentric X",OTHER],\r\n        AXIS["Geocentric Y",EAST],\r\n        AXIS["Geocentric Z",NORTH]\r\n      ]\r\n    '}),
z=c.earthRadius,B=function(a){return a===r?1:a.isWGS84?2:a.isWebMercator?3:0};m=function(a,b,c,d){c[d++]=a[b++];c[d++]=a[b++];c[d]=a[b]};var C=function(a,b,c,e){var f=.4999999*Math.PI,g=v*a[b+1],g=d.clamp(g,-f,f),f=Math.sin(g);c[e++]=v*a[b]*z;c[e++]=z/2*Math.log((1+f)/(1-f));c[e]=a[b+2]},A=function(a,b,c,d){var e=z+a[b+2],f=v*a[b+1];a=v*a[b];b=Math.cos(f);c[d++]=Math.cos(a)*b*e;c[d++]=Math.sin(a)*b*e;c[d]=Math.sin(f)*e},D=[void 0,A,m,C],E=[void 0,function(a,b,c,e){var f=g.length(a,b),k=d.asin(a[b+
2]/f);a=(0<a[b+1]?1:-1)*d.acos(a[b]/(Math.cos(k)*f));c[e++]=q*a;c[e++]=q*k;c[e]=f-z},m,function(a,b,c,d){c[d++]=q*(a[b++]/z);c[d++]=q*(Math.PI/2-2*Math.atan(Math.exp(-1*a[b++]/z)));c[d]=a[b]}];return{SphericalRenderSpatialReference:r,vectorToVector:function(a,b,c,d){2===a.length?(e[0]=a[0],e[1]=a[1],e[2]=0,a=e):a===c&&(k.set(a,e),a=e);return this.bufferToBuffer(a,b,0,c,d,0,1)},pointToVector:function(a,b,c){e[0]=a.x;e[1]=a.y;var d=a.z;e[2]=void 0!==d?d:0;return this.bufferToBuffer(e,a.spatialReference,
0,b,c,0,1)},vectorToPoint:function(a,b,c,d){"esri.SpatialReference"===c.declaredClass?(d=c,c=new h({spatialReference:d})):d=d||c.spatialReference;return this.bufferToBuffer(a,b,0,e,d,0,1)?(c.x=e[0],c.y=e[1],c.z=e[2],c.spatialReference=d,c):null},xyzToVector:function(a,b,c,d,f,g){e[0]=a;e[1]=b;e[2]=c;return this.bufferToBuffer(e,d,0,f,g,0,1)},bufferToBuffer:function(a,b,c,d,e,f,g){g=g||1;n!==b&&(t=B(b),n=b);u!==e&&(x=B(e),u=e);g=c+3*g;if(t!==x||0===t&&!b.equals(e))if(0<t&&0<x)if(2!==x){var k=D[x];
if(2!==t)for(e=E[t];c<g;c+=3,f+=3)e(a,c,l,0,b.wkid),k(l,0,d,f);else for(;c<g;c+=3,f+=3)k(a,c,d,f)}else for(e=E[t];c<g;c+=3,f+=3)e(a,c,d,f,b.wkid);else return!1;else if(d!==a||c!==f)for(;c<g;c++,f++)d[f]=a[c];return!0},computeLinearTransformation:function(a,b,c,d){var e=B(a),g=B(d);if(e===g&&(0!==e||a.equals(d)))return f.identity(c),f.translate(c,b),!0;if(1===g){if(d=E[e])return d(b,0,l,0,a.wkid),A(l,0,p,0),d=v*l[0],b=v*l[1],a=Math.sin(d),d=Math.cos(d),e=Math.sin(b),b=Math.cos(b),c[0]=-a,c[4]=-e*d,
c[8]=b*d,c[12]=p[0],c[1]=d,c[5]=-e*a,c[9]=b*a,c[13]=p[1],c[2]=0,c[6]=b,c[10]=e,c[14]=p[2],c[3]=0,c[7]=0,c[11]=0,c[15]=1,!0}else if(3===g&&(2===e||1===e))return E[e](b,0,l,0,a.wkid),a=v*l[1],C(l,0,p,0),f.identity(c),f.translate(c,p),a=1/Math.cos(a),f.scale(c,[a,a,1]),!0;return!1},mbsToMbs:function(a,b,c,d){var e=B(b),f=B(d);if(e===f&&(0!==e||b.equals(d)))return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],!0;if(1===f){if(d=E[e])return d(a,0,l,0,b.wkid),A(l,0,c,0),c[3]=a[3],!0}else if(3===f&&(2===e||1===
e))return E[e](a,0,l,0,b.wkid),b=v*l[1],b=Math.abs(b)+Math.asin(a[3]/(z+a[2])),C(l,0,c,0),c[3]=b>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(b)*a[3],!0;return!1},extentToBoundingBox:function(a,b,c){if(null==a)return!1;var d;e[0]=null!=a.xmin?a.xmin:0;e[1]=null!=a.ymin?a.ymin:0;e[2]=null!=a.zmin?a.zmin:0;d=this.bufferToBuffer(e,a.spatialReference,0,b,c,0,1);e[0]=null!=a.xmax?a.xmax:0;e[1]=null!=a.ymax?a.ymax:0;e[2]=null!=a.zmax?a.zmax:0;d=d&&this.bufferToBuffer(e,a.spatialReference,0,b,c,3,1);null==
a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.zmin&&(b[2]=-Infinity);null==a.xmax&&(b[3]=Infinity);null==a.ymax&&(b[4]=Infinity);null==a.zmax&&(b[5]=Infinity);return d},extentToBoundingRect:function(a,b,c){if(null==a)return!1;var d;e[0]=null!=a.xmin?a.xmin:0;e[1]=null!=a.ymin?a.ymin:0;e[2]=null!=a.zmin?a.zmin:0;d=this.bufferToBuffer(e,a.spatialReference,0,e,c,0,1);b[0]=e[0];b[1]=e[1];e[0]=null!=a.xmax?a.xmax:0;e[1]=null!=a.ymax?a.ymax:0;e[2]=null!=a.zmax?a.zmax:0;d=d&&this.bufferToBuffer(e,
a.spatialReference,0,e,c,0,1);b[2]=e[0];b[3]=e[1];null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.xmax&&(b[2]=Infinity);null==a.ymax&&(b[3]=Infinity);return d},webMercator:{x2lon:function(a){return a/z},y2lat:function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/z))},lon2x:function(a){return a*z},lat2y:function(a){a=Math.sin(a);return z/2*Math.log((1+a)/(1-a))}}}})},"esri/views/3d/support/cameraUtilsPlanar":function(){define(["../../../geometry/Extent","./mathUtils","./projectionUtils",
"../lib/glMatrix","./cameraUtilsInternal"],function(m,h,d,c,a){function b(a,b,c){a=f.create();var d=f.create();g.identity(p);g.rotateZ(p,-h.deg2rad(b));g.rotateX(p,h.deg2rad(c));g.multiplyVec3(p,l,a);f.scale(a,-1);g.multiplyVec3(p,e,d);return{direction:a,up:d}}var k={headingTiltToDirectionUp:b,directionToHeadingTilt:function(b,c,d,f){return a.directionToHeadingTilt(c,d,f,l,e)},eyeForCenterWithHeadingTilt:function(a,c,d,e){var g=b(a,d,e);a=f.add(f.scale(g.direction,-c,f.create()),a);return{up:g.up,
eye:a,heading:d,tilt:e}},lookAtTiltToEyeTilt:function(a,b,c){return h.rad2deg(c)},eyeTiltToLookAtTilt:function(a,b,c){return h.deg2rad(c)},toExtent:function(a,b,c,e,f){var g=a.renderSpatialReference;a=a.map&&a.spatialReference||b.spatialReference;d.pointToVector(b,v,g);d.pointToVector(b,q,g);v[0]-=c/2;q[0]+=c/2;v[1]-=e/2;q[1]+=e/2;d.vectorToVector(v,g,v,a);d.vectorToVector(q,g,q,a);f?(f.xmin=v[0],f.ymin=v[1],f.xmax=q[0],f.ymax=q[1],f.spatialReference=a):f=new m(v[0],v[1],q[0],q[1],a);return f}},f=
c.vec3d,g=c.mat4d,e=f.createFrom(0,1,0),l=f.createFrom(0,0,1),p=g.create(),v=f.create(),q=f.create();return k})},"esri/views/3d/support/cameraUtilsInternal":function(){define(["./mathUtils","../lib/glMatrix"],function(m,h){var d=h.vec3d,c=d.create(),a=d.create();return{directionToHeadingTilt:function(b,k,f,g,e){var l=c;d.normalize(b,l);var p=Math.abs(d.dot(l,g));.99<p&&(p=Math.abs(d.dot(k,g)),.99>p?d.set(k,l):l=null);k=0;l&&(d.scale(g,d.dot(g,l),a),d.subtract(l,a),k=d.dot(l,e)/(d.length(l)*d.length(e)),
d.cross(l,e,a),k=(0<d.dot(a,g)?1:-1)*m.rad2deg(m.acos(k)));b=m.rad2deg(m.acos(-d.dot(g,b)/d.length(b)));return f?(f.heading=k,f.tilt=b,f):{heading:k,tilt:b}}}})},"esri/views/3d/support/cameraUtilsSpherical":function(){define("../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ./mathUtils ./earthUtils ../lib/glMatrix ./cameraUtilsInternal".split(" "),function(m,h,d,c,a,b,k){function f(a,b,d){var e=p.create(),f=p.create();p.cross(a,q,x);0===p.dot(x,
x)&&p.cross(a,n,x);v.identity(u);v.rotate(u,-c.deg2rad(b),a);v.rotate(u,-c.deg2rad(d),x);p.cross(x,a,f);p.normalize(f);v.multiplyVec3(u,f);p.normalize(a,e);v.multiplyVec3(u,p.negate(e));return{direction:e,up:f}}function g(a){var b=a[1];a[1]=-a[2];a[2]=b}function e(a,b){b=f(b,a.heading,a.tilt);a.up=b.up;return a}var l={headingTiltToDirectionUp:f,directionToHeadingTilt:function(a,b,c,d){var e=x,f=r;p.normalize(a,e);p.cross(e,q,r);0===p.dot(r,r)&&p.cross(e,n,r);p.cross(r,e,f);return k.directionToHeadingTilt(b,
c,d,e,f)},eyeForCenterWithHeadingTilt:function(a,b,d,f){var k={eye:p.create(),tilt:f,heading:d},l=x;l[0]=a[0];l[1]=a[2];l[2]=-a[1];d=c.deg2rad(d);var n=c.deg2rad(f);f=Math.sin(d);d=Math.cos(d);var t=Math.sin(n),h=Math.cos(n),q=p.length(l);if(1E-8>Math.abs(n))n=b+q;else var r=q/t,v=c.asin(b/r),n=r*Math.sin(Math.PI-n-v);var r=t*b,h=h*b,v=d*r,u=n-h,B=u*u,m=b*b*t*t,t=d*d*m,m=f*f*m,z=l[1]*u,C=t*(t+B-l[1]*l[1]);if(0>C)return p.scale(l,n/q,k.eye),k.tilt=0,k;var A=Math.sqrt(C),C=t+B,z=0<d?-A+z:A+z;if(1E-8>
Math.abs(C))return 1E-8>q?(k.eye[0]=0,k.eye[1]=0,k.eye[2]=b):p.scale(l,n/q,k.eye),k.tilt=0,g(k.eye),e(k,a);k.eye[1]=z/C;C=k.eye[1]*k.eye[1];b=1-C;z=Math.sqrt(b);v=t*C+m-2*v*k.eye[1]*z*u+b*B;if(1E-8>Math.abs(v))return p.scale(l,n/q,k.eye),k.tilt=0,g(k.eye),e(k,a);k.eye[0]=(b*(n*l[0]-h*l[0])-r*z*(l[0]*k.eye[1]*d+l[2]*f))/v;k.eye[2]=(b*(n*l[2]-h*l[2])-r*z*(l[2]*k.eye[1]*d-l[0]*f))/v;p.scale(k.eye,n);g(k.eye);return e(k,a)},lookAtTiltToEyeTilt:function(a,b,d){a=p.length(a);b=c.asin(b/(Math.sqrt(b*b+a*
a-2*b*a*Math.cos(Math.PI-d))/Math.sin(d)));return c.rad2deg(d-b)},eyeTiltToLookAtTilt:function(a,b,d){d=c.deg2rad(d);a=p.length(a);return c.asin(b/(a/Math.sin(d)))+d},toExtent:function(b,e,f,g,k){var l;l=e.latitude;e=e.longitude;var p=a.getLonDeltaForDistance(e,l,f)/2;f=e-p;e+=p;l=c.deg2rad(l);p=a.earthRadius;l=(1+Math.sin(l))/(1-Math.sin(l));var n=(l+1)*Math.tan(g/p/2);l=1.5*Math.PI-2*Math.atan(.5*(n+Math.sqrt(4*l+n*n)));g=l+g/p;p=function(a){var b=Math.PI/2;a=c.cyclical2PI.normalize(a,-b);a>b&&
(a=Math.PI-a);return a};l=p(l);g=p(g);g<l&&(p=g,g=l,l=p);l=Math.max(c.rad2deg(l),-90);g=Math.min(c.rad2deg(g),90);e=t.monotonic(f,e);180<e-f&&(p=(e-f-180)/2,f+=p,e-=p);k?(k.xmin=f,k.ymin=l,k.xmax=e,k.ymax=g,k.spatialReference=m.WGS84):k=new h(f,l,e,g,m.WGS84);b.spatialReference&&b.spatialReference.isWebMercator&&d.geographicToWebMercator(k,!1,k);return k}},p=b.vec3d,v=b.mat4d,q=p.createFrom(0,0,1),n=p.normalize(p.createFrom(1,1,1)),t=new c.Cyclical(-180,180),u=v.create(),x=p.create(),r=p.create();
return l})},"esri/views/3d/support/viewpointUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Geometry ../../../geometry/Point ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ../../../core/Error ../../../core/promiseUtils ../../../Camera ../../../Viewpoint ../../../Graphic ../lib/glMatrix ./mathUtils ./projectionUtils ./cameraUtils ./aaBoundingBox ./aaBoundingRect ./intersectionUtils".split(" "),function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u){function x(a){return 360-
p.cyclicalDeg.normalize(a)}function r(a){return p.cyclicalDeg.normalize(360-a)}function z(b,c,e){if(!c)return null;var g=b.spatialReference||m.WGS84,k;if(c.camera){k=c.get("camera.position.spatialReference");if(!a.canProject(k,g))return null;c=c.camera.clone();k.equals(g)||(b=a.project(c.position,g),c.position=b);return c}if((k=c.get("targetGeometry.spatialReference"))&&!a.canProject(k,g))return null;var l=b.navigation.currentCamera;k=q.internalToExternal(b,l);var p={noReset:!1};null!=c.rotation&&
(k.heading=x(c.rotation),p.noReset=!0);null!=e&&(k.tilt=e);if(c.targetGeometry instanceof d){var n=c.targetGeometry;e=c.targetGeometry.clone();c=null!=c.scale?q.scaleToDistance(b,c.scale,n.latitude):l.distance;c=q.eyeHeadingTiltForCenterPointAtDistance(b,k.heading,k.tilt,e,c,p);b=v.vectorToPoint(c.eye,b.renderSpatialReference,g);return new f(b,c.heading,c.tilt,k.fov)}return q.fromExtent(b,c.targetGeometry.extent,k,p)}function B(a,b,c,d){var e=c.scale;null==e&&null!=c.zoom&&(e=q.zoomToScale(a,c.zoom));
null==e&&null!=c.distance&&(b=b.center||b,e=q.distanceToScale(a,c.distance,b.latitude));null==e&&d&&(e="function"===typeof d?d():d);return e}function C(a,b,c,e,f){if(!(b&&c.position||b&&c.direction||c.position&&c.direction))return!1;var g=a.spatialReference||m.WGS84,k=a.renderSpatialReference,l=c.direction;b&&c.position&&(l=null);c.position&&v.pointToVector(c.position,T,k);b&&v.pointToVector(b,V,k);if(l){var p=new d(c.position||b);p.x+=l[0];p.y+=l[1];2<l.length&&(p.z+=l[2]);v.pointToVector(p,P,k);
K.subtract(P,c.position?T:V)}c.position&&l?(f.camera.position=new d(c.position),q.directionToHeadingTilt(a,T,P,e.up,f.camera),K.add(T,P,V),a.navigation.getCenterIntersectTerrain(T,V,V),f.targetGeometry=v.vectorToPoint(V,k,g),f.scale=q.distanceToScale(a,K.dist(T,V),f.targetGeometry.latitude)):b&&l?(f.targetGeometry=new d(b),f.scale=B(a,f.targetGeometry,c,function(){return q.computeScale(a,e)}),b=q.scaleToDistance(a,f.scale,b.latitude),K.scale(P,b/K.length(P),T),K.add(T,V),f.camera.position=v.vectorToPoint(T,
k,g),q.directionToHeadingTilt(a,T,P,e.up,f.camera)):(f.targetGeometry=new d(b),f.camera.position=new d(c.position),K.subtract(V,T,P),q.directionToHeadingTilt(a,T,P,e.up,f.camera),f.scale=q.distanceToScale(a,K.dist(T,V),f.targetGeometry.latitude));f.rotation=r(f.camera.heading);return!0}function A(a,b){var c=!1;null!=b.heading?(a.heading=b.heading,c=!0):null!=b.rotation&&(a.heading=x(b.rotation),c=!0);null!=b.tilt&&(a.tilt=b.tilt,c=!0);null!=b.fov&&(a.fov=b.fov);return c}function D(a,b,c){var d=a.spatialReference||
m.WGS84;b=b||q.externalToInternal(a,c.camera);c.targetGeometry=v.vectorToPoint(b.center,a.renderSpatialReference,d);c.scale=q.computeScale(a,b);c.rotation=r(c.camera.heading);return c}function E(a,b,c){if(b){var e=[];if(!b.hasZ&&a.basemapTerrain){var f;f=b.isInstanceOf(d)?b:b.centroid||b.center;U[2]=f?a.basemapTerrain.getElevation(f)||0:0}aa[b.declaredClass](b,function(a){e.push(a[0],a[1],a[2])},U);var g=e.length/3;if(0!==g&&(f=Array(e.length),v.bufferToBuffer(e,b.spatialReference,0,f,a.spatialReference,
0,g)))for(b.hasZ&&(c.hasZ=!0),a=0;a<f.length;a+=3)b.hasZ?(U[0]=f[a+0],U[1]=f[a+1],U[2]=f[a+2]):(U[0]=f[a+0],U[1]=f[a+1]),n.expand(c.boundingBox,U)}}function H(a,b,c){return a.whenViewForGraphic(b).then(function(a){if(a&&a.whenGraphicBounds)return a.whenGraphicBounds(b)}).then(function(a){var b=a.boundingBox;n.expand(c.boundingBox,b);a.screenSpaceObjects&&a.screenSpaceObjects.forEach(function(a){c.screenSpaceObjects.push(a)});isFinite(b[2])&&(c.hasZ=!0)}).otherwise(function(){E(a,b.geometry,c)})}function G(a,
b,c){if(Array.isArray(b)&&2===b.length&&"number"===typeof b[0]&&"number"===typeof b[1])ea.x=b[0],ea.y=b[1],ea.z=void 0,ea.spatialReference=m.WGS84,E(a,ea,c);else{if(b&&b.forEach)return k.eachAlways(b.map(function(b){return G(a,b,c)}));if(b instanceof h)E(a,b,c);else if(b instanceof e)return H(a,b,c)}return k.resolve()}function J(a,b,c,d){if(b.camera)return I(a,c,b.camera,d);d.scale=b.scale;d.rotation=b.rotation;d.targetGeometry=b.targetGeometry?b.targetGeometry.clone():null;d.camera=null;null!=c.heading?
d.rotation=r(c.heading):null!=c.rotation&&(d.rotation=c.rotation);b=B(a,d.targetGeometry,c);null!=b&&(d.scale=b);d.camera=z(a,d,c.tilt);return d}function I(b,c,d,e){e.camera=d.clone();e.camera.fov=b.camera.fov;c=b.spatialReference;d=e.camera.position.spatialReference;if(!a.canProject(d,c))return null;d.equals(c)||(c=a.project(e.camera.position,c),e.camera.position=c);return D(b,null,e)}function F(a,b,c,d){if(!c)return null;d.targetGeometry=c.clone();var e=a.navigation.getCameraIntersectTerrain();
if(C(a,d.targetGeometry,b,e,d))return d;q.internalToExternal(a,e,d.camera);var f={noReset:!1};A(d.camera,b)&&(f.noReset=!0);d.scale=B(a,d.targetGeometry,b);null==d.scale&&(v.pointToVector(c,U,a.renderSpatialReference),u.frustumPoint(e.frustumPlanes,U)?d.scale=q.distanceToScale(a,K.dist(e.eye,U),c.latitude):d.scale=q.computeScale(a,e));return q.fromCenterScale(a,d.targetGeometry,d.scale,d.camera,f,d.camera)?d:null}function N(a,b,c,d){d.targetGeometry=c.clone();var e=a.navigation.getCameraIntersectTerrain();
q.internalToExternal(a,e,d.camera);e={noReset:!1};A(d.camera,b)&&(e.noReset=!0);return q.fromExtent(a,c,d.camera,e,d.camera)?d:null}function L(a,b){if(!b||!a.spatialReference)return null;a={};if(null!=b.declaredClass||Array.isArray(b))a.target=b;else{for(var c in b)a[c]=b[c];b.center&&!a.target&&(a.target=b.center)}return a}function M(a){a&&(a.rotation=r(a.camera.heading));return k.resolve(a)}var K=l.vec3d,ba=l.mat3d,X=l.mat4d,T=K.create(),V=K.create(),P=K.create(),W={heading:0,tilt:0},U=K.create(),
Y=X.create(),S=ba.create(),ca=n.create(),ga=t.create(),ea=new d;l=function(a,b,c){for(var d=a.hasZ,e=0;e<a.rings.length;e++)for(var f=a.rings[e],g=0;g<f.length;g++)c[0]=f[g][0],c[1]=f[g][1],d&&(c[2]=f[g][2]),b(c)};var aa={"esri.geometry.Point":function(a,b,c){c[0]=a.x;c[1]=a.y;a.hasZ&&(c[2]=a.z);b(c)},"esri.geometry.Polygon":l,"esri.geometry.Circle":l,"esri.geometry.Polyline":function(a,b,c){for(var d=a.hasZ,e=0;e<a.paths.length;e++)for(var f=a.paths[e],g=0;g<f.length;g++)c[0]=f[g][0],c[1]=f[g][1],
d&&(c[2]=f[g][2]),b(c)},"esri.geometry.Multipoint":function(a,b,c){var d=a.points;a=a.hasZ;for(var e=0;e<d.length;e++)c[0]=d[e][0],c[1]=d[e][1],a&&(c[2]=d[e][2]),b(c)},"esri.geometry.Extent":function(a,b,c){a.hasZ?(b(K.set3(a.xmin,a.ymin,a.zmin,c)),b(K.set3(a.xmax,a.ymin,a.zmin,c)),b(K.set3(a.xmin,a.ymax,a.zmin,c)),b(K.set3(a.xmax,a.ymax,a.zmin,c)),b(K.set3(a.xmin,a.ymin,a.zmax,c)),b(K.set3(a.xmax,a.ymin,a.zmax,c)),b(K.set3(a.xmin,a.ymax,a.zmax,c)),b(K.set3(a.xmax,a.ymax,a.zmax,c))):(b(K.set3(a.xmin,
a.ymin,c[2],c)),b(K.set3(a.xmax,a.ymin,c[2],c)),b(K.set3(a.xmin,a.ymax,c[2],c)),b(K.set3(a.xmax,a.ymax,c[2],c)))}},R={create:function(a,e){var l=L(a,e);if(!l)return k.reject(new b("viewpointutils-create:no-target","Missing target for creating viewpoint"));var p=new g({camera:new f({fov:a.camera.fov})}),h=null!=l.scale||null!=l.zoom||null!=l.distance;if(l.target instanceof g)return M(J(a,l.target,l,p));if(l.target instanceof f)return M(I(a,l,l.target,p));if(l.target instanceof c)return e=l.target.xmin===
l.target.xmax||l.target.ymin===l.target.ymax,h||e?M(F(a,l,l.target.center,p)):M(N(a,l,l.target,p));var r={boundingBox:n.create(n.NEGATIVE_INFINITY),spatialReference:a.spatialReference,hasZ:!1,screenSpaceObjects:[]};return G(a,l.target,r).then(function(){if(isFinite(r.boundingBox[0])){n.center(r.boundingBox,U);ea.x=U[0];ea.y=U[1];ea.z=U[2];ea.spatialReference=a.spatialReference;var b;isFinite(ea.z)&&r.hasZ?b=n.isPoint(r.boundingBox):(ea.z=void 0,b=t.isPoint(n.toRect(r.boundingBox,ga)));if(h||b)return F(a,
l,ea,p);b=r.boundingBox;var c;c=r.screenSpaceObjects;var e=R.DEFAULT_FRAME_COVERAGE;if(c.length){for(var f=Number.NEGATIVE_INFINITY,g=0;g<c.length;g++)var k=c[g].screenSpaceBoundingRect,f=Math.max(f,Math.abs(k[0]),Math.abs(k[1]),Math.abs(k[2]),Math.abs(k[3]));c=e-f/Math.min(a.width,a.height)*2}else c=e;g=ea;e=c;p.targetGeometry=g.clone();c=a.navigation.getCameraIntersectTerrain();f=0;g.hasZ?f=g.z:a.basemapTerrain&&(f=a.basemapTerrain.getElevation(g));K.set3(g.x,g.y,f,U);v.computeLinearTransformation(a.spatialReference,
U,Y,a.renderSpatialReference);X.toMat3(Y,S);ba.transpose(S);n.set(ca,n.NEGATIVE_INFINITY);g=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(k=0;k<g.length;k++){var u=g[k],m=b[u[2]];isFinite(m)||(m=f);K.set3(b[u[0]],b[u[1]],m,U);v.vectorToVector(U,a.spatialReference,U,a.renderSpatialReference);n.expand(ca,ba.multiplyVec3(S,U))}b=n.width(ca);f=n.height(ca);g=n.depth(ca);k=1/Math.tan(c.fovY/2);b=Math.max(.5*Math.sqrt(b*b+g*g)*Math.max(k,1/Math.tan(c.fovX/2))+.5*f,.5*f*k+.5*Math.max(b,
g))/e;q.internalToExternal(a,c,p.camera);c={noReset:!1};A(p.camera,l)&&(c.noReset=!0);p.scale=q.distanceToScale(a,b,p.targetGeometry.latitude);b=q.fromCenterScale(a,p.targetGeometry,p.scale,p.camera,c,p.camera)?p:null;return b}b=a.navigation.getCameraIntersectTerrain();C(a,null,l,b,p)?b=p:l.position?(K.set(b.viewForward,P),q.directionToHeadingTilt(a,b.eye,P,b.up,W),p.camera.position=new d(l.position),b=p.camera,c=W.heading,e=l.heading,null==e&&null!=l.rotation&&(e=x(l.rotation)),null==e&&c&&(e="function"===
typeof c?c():c),b.heading=e,b=p.camera,c=W.tilt,c=null!=l.tilt?l.tilt:null!=c?"function"===typeof c?c():c:void 0,b.tilt=c,b=D(a,null,p)):(b=v.vectorToPoint(b.center,a.renderSpatialReference,ea,a.spatialReference),b=F(a,l,b,p));return b}).then(function(a){return M(a)})},rotationToHeading:x,headingToRotation:r,toCamera:z,fromCamera:function(a,b,c){c||(c=new g);c.camera=b.clone();return D(a,null,c)},fromInternalCamera:function(a,b,c){c||(c=new g({camera:new f}));q.internalToExternal(a,b,c.camera);return D(a,
b,c)},DEFAULT_FRAME_COVERAGE:.66};return R})},"esri/views/3d/support/intersectionUtils":function(){define(["../lib/glMatrix"],function(m){function h(a,b,d,e){e.clip[0]=0;e.clip[1]=d?e.len:Number.MAX_VALUE;for(d=0;d<a.length;d++){var f;var g=a[d],k=b;f=e;var h=c.dot(g,f.dir),k=-c.dot(k,g)-g[3];0>k&&0<=h?f=!1:-1E-6<h&&1E-6>h?f=!0:!(0>k||0>h)||0>k&&0>h?(k/=h,0<h?k<f.clip[1]&&(f.clip[1]=k):k>f.clip[0]&&(f.clip[0]=k),f=f.clip[0]<=f.clip[1]):f=!0;if(!f)return!1}return!0}function d(b,d,g,e){b?(g&&e&&(a.len=
c.dist(d,g)),c.set(b,a.dir)):e?(a.len=c.dist(d,g),c.scale(c.subtract(g,d,a.dir),1/a.len)):c.normalize(c.subtract(g,d,a.dir));return a}var c=m.vec3d;m=m.vec2d;var a={dir:c.create(),len:0,clip:m.create()},b={planeSphere:function(a,b,c){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]<c},frustumSphere:function(a,c,d){for(var e=0;6>e;e++)if(!b.planeSphere(a[e],c,d))return!1;return!0},frustumRay:function(a,b,c,e){c=d(e,b,c,!1);return h(a,b,null,c)},frustumPoint:function(a,b){for(var d=0;6>d;d++){var e=a[d];if(0>
-c.dot(b,e)-e[3])return!1}return!0},frustumLineSegment:function(a,b,c,e){e=d(e,b,c,!0);return h(a,b,c,e)}};return b})},"esri/views/3d/webgl-engine/Stage":function(){define("require exports ./parts/Model ./parts/View ./lib/Selector ./lib/Camera ./lib/gl-matrix ./lib/Util ./lib/ModelContentType ./lighting/Lightsources".split(" "),function(m,h,d,c,a,b,k,f,g,e){m=k.vec2d;h=k.vec2;var l=k.vec3d;k=function(){function k(b,f,g){this._intersectTolerance=a.DEFAULT_TOLERANCE;this._viewContent=[];this._externalIntersectionHandlers=
[];this.container=f;this.viewingMode=b;this.model=new d;this.view=new c(f,this,this.model.getDirtySet(),g);this._validateHUDSelector=new a(this.viewingMode);this._validateHUDSelector.enableHUDSelection=!1;this.view.setLighting({lights:[new e.MainLight(l.createFrom(.7,.7,.7)),new e.AmbientLight(l.createFrom(.3,.3,.3))],groundLightingFactor:.5,globalFactor:.5})}k.prototype.setNeedsRender=function(){this.view.setNeedsRender()};k.prototype.dispose=function(){this.view.dispose();this.model=this.view=null};
k.prototype.frame=function(a,c){void 0===c&&(c=0);var d=Math.max(1E-6,a.getBSRadius());c=Math.max(2,c+2);c*=d;var d=this.getCamera(),e=l.create(d.viewForward);l.scale(e,-(1.5*c/Math.tan(d.fov)));l.set(a.getCenter(),d.center);l.add(d.center,e,d.eye);d=new b(d.eye,d.center,d.up);this.setCamera(d)};k.prototype.beginMod=function(){k.DebugSettings.fineGrainedContentValidation&&this.model.validateContent()};k.prototype.endMod=function(a){void 0===a&&(a=!1);k.DebugSettings.fineGrainedContentValidation&&
!a&&this.model.validateContent()};k.prototype.add=function(a,b){this.model.add(a,b);"function"===typeof b.addParentStage&&b.addParentStage(this)};k.prototype.remove=function(a,b){a=this.model.remove(a,b);"function"===typeof a.removeParentStage&&a.removeParentStage(this);return a};k.prototype.notifyDirty=function(a,b,c,d){this.model.notifyDirty(a,b,c,d)};k.prototype.processDirty=function(){var a=this.model.getDirtySet(),b=a.getDirtyMaterials();if(a.hasDirtyGeometryRecords()||b){k.DebugSettings.endFrameContentValidation&&
this.model.validateContent();k.DebugSettings.logDirtySet&&console.log("Dirty set: "+this.model.getDirtySet().formatDebugInfo(!1));var c=a.getAddRemoveUpdateListFilteredByLayers(this._viewContent,!0);(0<c[0].length+c[1].length+c[2].length||b)&&this.view.modify(c[0],c[1],c[2],b);k.DebugSettings.logDirtySet&&(console.log("RGs add: "+c[0].map(function(a){return a.uniqueName})),console.log("RGs remove: "+c[1].map(function(a){return a.uniqueName})));a.getAddRemoveUpdateList(!0);a.clearDirtyMaterials();
this.view.setNeedsRender()}};k.prototype.processDirtyLayer=function(a){var b=this.model.getDirtySet(),c=b.getDirtyMaterials();a=b.getAddRemoveUpdateListFilteredByLayers([a],!0);(0<a[0].length+a[1].length+a[2].length||c)&&this.view.modify(a[0],a[1],a[2],c);b.clearDirtyMaterials();this.view.setNeedsRender()};k.prototype.get=function(a,b){return this.model.get(a,b)};k.prototype.getAll=function(a){return this.model.getAll(a)};k.prototype.addTextureListener=function(a){this.view.addTextureListener(a)};
k.prototype.removeTextureListener=function(a){this.view.removeTextureListener(a)};k.prototype.getContainer=function(){return this.container};k.prototype.getCamera=function(){return this.view.getCamera()};k.prototype.setCamera=function(a){this.view.setCamera(a)};k.prototype.getViewParams=function(a){return this.view.getViewParams(a)};k.prototype.setViewParams=function(a){this.view.setViewParams(a)};k.prototype.getLayers=function(){return this.model.getAll(g.LAYER)};k.prototype.setLighting=function(a){this.view.setLighting(a)};
k.prototype.getCanvas=function(){return this.view.getCanvas()};k.prototype.setRenderParams=function(a){this.view.setRenderParams(a)};k.prototype.getRenderParams=function(){return this.view.getRenderParams()};k.prototype.has=function(a){return this.view.has(a)};k.prototype.getViewContent=function(){return this._viewContent.slice(0)};k.prototype.setViewContent=function(a){var b=f.array2object(this._viewContent),c=f.array2object(a),d=f.subtractObjects(c,b),b=f.subtractObjects(b,c);this.processDirty();
c=this.model.getDirtySet();d=c.getResidentRenderGeometriesFilteredByLayers(f.object2array(d));b=c.getResidentRenderGeometriesFilteredByLayers(f.object2array(b));this.view.modify(d,b,[]);this._viewContent=a.slice(0)};k.prototype.addToViewContent=function(a){for(var b=[],c=0;c<a.length;c++)-1===this._viewContent.indexOf(a[c])&&b.push(a[c]);0<a.length&&(this.processDirty(),a=this.model.getDirtySet().getResidentRenderGeometriesFilteredByLayers(b),this.view.modify(a,[],[]),this._viewContent.push.apply(this._viewContent,
b))};k.prototype.removeFromViewContent=function(a){this.processDirty();for(var b=this.model.getDirtySet(),c=this._viewContent,d=[],e=0;e<a.length;e++){var f=c.indexOf(a[e]);-1<f&&(c[f]=c[c.length-1],c.pop(),d.push(a[e]))}a=b.getResidentRenderGeometriesFilteredByLayers(d);this.view.modify([],a,[])};k.prototype.getViewFrustumObjects=function(){return this.view.getFrustumObjects()};k.prototype.getLocalOrigin=function(a,b,c){return this.model.getOrigin(a,b,c)};k.prototype.getFrameTask=function(){return this.view.getFrameTask()};
k.prototype.requestScreenCapture=function(a,b){this.view.requestScreenCapture(a,b)};k.prototype.getAllTexturesLoaded=function(){return this.view.getAllTexturesLoaded()};k.prototype.getTextureLoaded=function(a){return this.view.getTextureLoaded(a)};k.prototype.addExternalRenderer=function(a,b){"function"===typeof b.intersect&&this._externalIntersectionHandlers.push(b);return this.view.addExternalRenderer(a,b)};k.prototype.removeExternalRenderer=function(a){var b=this._externalIntersectionHandlers.indexOf(a);
-1<b&&this._externalIntersectionHandlers.splice(b,1);return this.view.removeExternalRenderer(a)};k.prototype.getContentDebugStrings=function(a){return this.model.formatDebugInfo(a)};k.prototype.getRenderStats=function(){return this.view.getCombinedStats()};k.prototype.getRenderStatString=function(a){var b=this.getRenderStats(),c="";if(a){var c=c+"\x3ctable\x3e",d;for(d in b)c+="\x3ctr\x3e\x3ctd\x3e"+d+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Math.round(b[d])+"\x3c/td\x3e\x3c/tr\x3e";c+=
"\x3c/table\x3e"}else for(d in b)c+=d+": "+b[d]+"\n";return c};k.prototype.pick=function(a,b,c,d){var e=l.create(),f=l.create();this.view.getPickRay(a,e,f);return this.pickRay(e,f,a,a,b,c,d)};k.prototype.pickRayWithBeginPoint=function(a,b,c,d,e){this.view.pickRayWithBeginPoint(a,b,c,d,e)};k.prototype.pickRay=function(b,c,e,f,g,k,n){f=this.view.getCamera();e||(e=p,f.projectPoint(c,e));var h;if(g){h=Array(g.length);for(var t=0;t<h.length;t++)h[t]=this.model.get(d.ContentType.LAYER,g[t])}else{h=[];g=
this.getViewContent();for(var r=this.model.getAll(d.ContentType.LAYER),t=0;t<g.length;t++){var u=r[g[t]];u&&"VISIBLE"===u.getState()&&h.push(u)}}n?n.init(h,b,c,e,f,this._intersectTolerance,k):n=new a(this.viewingMode,h,b,c,e,f,this._intersectTolerance,k);for(t=0;t<this._externalIntersectionHandlers.length;t++)this._externalIntersectionHandlers[t].intersect(n,b,c,e);if(n.getHudResults().length){t=n.getHudResults();t.sort(function(a,b){return b.dist-a.dist});c=t[t.length-1];e=v;f.projectPoint(c.center,
e);e[0]=Math.round(e[0]);e[1]=Math.round(e[1]);g=q;this.view.getPickRay(e,b,g);r=l.dist(c.center,b)/l.dist(b,g)*.99;this._validateHUDSelector.init(h,b,g,e,f,this._intersectTolerance,k);for(t=0;t<this._externalIntersectionHandlers.length;t++)this._externalIntersectionHandlers[t].intersect(this._validateHUDSelector,b,g,e);if(null==this._validateHUDSelector.getMinResult().dist||r<=this._validateHUDSelector.getMinResult().dist)n.getMinResult().set(c.target,c.name,c.dist,c.normal,c.priority),n.getMinResult().setIntersector("stage")}return n};
k.prototype.getIntersectTolerance=function(){return this._intersectTolerance};k.prototype.setIntersectTolerance=function(a){void 0===a&&(a=1E-5);this._intersectTolerance=a};k.prototype.getTextureGraphicsRenderer=function(){return this.view.getTextureGraphicsRenderer()};return k}();k.DebugSettings={fineGrainedContentValidation:!1,endFrameContentValidation:!1,logDirtySet:!1};k.ModelContentType=g;var p=m.create(),v=h.create(),q=l.create();return k})},"esri/views/3d/webgl-engine/parts/View":function(){define("require exports ../../../../core/Logger ../lib/GLTextureRep ../lib/GLMaterialRep ../lib/ShaderSnippets ../lib/GLSLShaderRep ../lib/TextureRenderer ../lib/gl-matrix ../lib/webgl-utils ./Model ./Viewport ../materials/repository ../lib/SSAOHelperObscurance ../lib/HighlightHelper ../lib/OffscreenRenderingHelper ../lib/tracer ../../../webgl/RenderingContext ../lib/ProgramRepository ../lighting/Lightsources ../../../support/screenshotUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B){var C=g.vec3d,A=g.vec4d,D=d.getLogger("esri.views.3d.webgl-engine.parts.View");return function(){function d(b,d,e,g){var k=this;this._backgroundColor=A.createFrom(1,1,1,1);this._lightDirection=C.createFrom(0,1,0);this._didRender=!1;this._idleSuspend=this._needsRender=!0;this._shouldRender=!1;this._screenCaptureQueue=[];this._container=b;this._stage=d;this._initializeContext(g);this._initializeShaders(g);this._textureRep=new c(d.getAll(l.ContentType.TEXTURE),
this._programRepository,function(){return k._viewport.getCamera().viewport},this._rctx);this._materialRep=new a(this._textureRep,this._programRepository);this._viewport=new p(this._programRepository,this._materialRep,this._textureRep,this._rctx);this._initializeViewportCamera();this._textureRenderer=new f(this._rctx,this._canvas,this._programRepository,this._materialRep,this._textureRep,e);this._initializeFrameTask()}d.prototype._initializeFrameTask=function(){var a=this;this._frameTask={preRender:function(){u.begin();
a._stage.processDirty();a.needsRender()?(a._shouldRender=!0,a._viewport.getCamera().setGLViewport(a._rctx),a._rctx.setClearColor.apply(a._rctx,a._backgroundColor),a._rctx.clear(16640)):a._shouldRender=!1},render:function(){a._shouldRender&&(a._didRender=!0,a._viewport.render(a._lightDirection,null))},postRender:function(){u.end()},update:function(){a._performScreenCaptures();a.resetNeedsRender()}}};d.prototype._initializeViewportCamera=function(){var a=this._container.getBoundingClientRect(),b=this._viewport.getCamera();
b.viewport[2]=a.width;b.viewport[3]=a.height;this._viewport.setCamera(b)};d.prototype._initializeContext=function(a){this._canvas=a.canvas;this._canvas||(this._canvas=document.createElement("canvas"));this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");var b=e.setupWebGL(this._canvas,{alpha:a.alpha||!1,antialias:!1,depth:!0,stencil:null==a.stencil?!0:a.stencil});this._gl=u.instrumentContext(b[0]);this._rctx=new x(b[0],{disabledExtensions:a.deactivatedWebGLExtensions});!a.alpha&&
this._rctx.contextAttributes.alpha&&D.error("WebGL context has alpha channel even though no alpha channel was requested");this._container.appendChild(this._canvas)};d.prototype._initializeShaders=function(a){this._shaderSnippets=new b({fsprecisionf:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\nprecision highp sampler2D;\n#else\nprecision mediump float;\nprecision mediump sampler2D;\n#endif\n",vsprecisionf:"\nprecision highp float;\nprecision highp sampler2D;\n",viewingMode:"global"===
a.viewingMode?"#define VIEWING_MODE_GLOBAL 1 \n":" #define VIEWING_MODE_LOCAL 1 \n"});this._shaderRep=new k;this._programRepository=new r;v.initializeShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);n.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);q.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);t.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx)};d.prototype.dispose=
function(){this._viewport.dispose();this._viewport=null;this._textureRenderer.dispose();this._textureRenderer=null;this._programRepository.dispose();this._programRepository=null;this._container.contains(this._canvas)&&this._container.removeChild(this._canvas);this._gl=this._canvas=this._container=null};d.prototype.getCombinedStats=function(){return this._viewport.getCombinedStats()};d.prototype.setNeedsRender=function(){this._didRender=!1;this._needsRender=!0};d.prototype.resetNeedsRender=function(){this._didRender&&
(this._didRender=this._needsRender=!1);this._viewport.resetNeedsRender();this._textureRep.resetNeedsRender()};d.prototype.needsRender=function(){return this._needsRender||!this._idleSuspend||this._viewport.needsRender()||this._textureRep.needsRender()};d.prototype.getFrameTask=function(){return this._frameTask};d.prototype.setLighting=function(a){C.set3(0,0,0,this._lightDirection);for(var b=0,c=a.lights;b<c.length;b++){var d=c[b];if(d instanceof z.MainLight){C.negate(d.direction,this._lightDirection);
break}}this._viewport.setLighting(a);this._needsRender=!0};d.prototype.getMainLightDirection=function(){return this._lightDirection};d.prototype.getViewParams=function(a){var b=this._viewport.getViewParams(a);if(!a||a.backgroundColor)b.backgroundColor=this._backgroundColor;return b};d.prototype.setViewParams=function(a){this._needsRender=!0;a.backgroundColor&&(this._backgroundColor=a.backgroundColor);this._viewport.setViewParams(a)};d.prototype.setRenderParams=function(a){this._needsRender=!0;void 0!==
a.idleSuspend&&(this._idleSuspend=!!a.idleSuspend);this._viewport.setRenderParams(a)};d.prototype.getRenderParams=function(){var a=this._viewport.getRenderParams();a.anisotropicFiltering=this._textureRep.getMaxAnisotropy();a.idleSuspend=this._idleSuspend;return a};Object.defineProperty(d.prototype,"renderingContext",{get:function(){return this._rctx},enumerable:!0,configurable:!0});d.prototype.has=function(a){return"s3tc"===a?!!this._rctx.extensions.compressedTextureS3TC:"standardDerivatives"===a?
!!this._rctx.extensions.standardDerivatives:"shaderTextureLOD"===a?!!this._rctx.extensions.shaderTextureLOD:"angleInstancedArrays"===a?!!this._rctx.extensions.angleInstancedArrays:!1};d.prototype.getFrustumObjects=function(){return this._viewport.getFrustumObjects()};d.prototype.modify=function(a,b,c,d){this._viewport.modify(a,b,c,d)};d.prototype.setCamera=function(a){this._viewport.setCamera(a)};d.prototype.getCamera=function(){return this._viewport.getCamera()};d.prototype.getPickRay=function(a,
b,c){this._viewport.getPickRay(a,b,c)};d.prototype.pickRayWithBeginPoint=function(a,b,c,d,e){this._viewport.pickRayWithBeginPoint(a,b,c,d,e)};d.prototype.getCanvas=function(){return this._canvas};d.prototype.getTextureGraphicsRenderer=function(){return this._textureRenderer};d.prototype.requestScreenCapture=function(a,b){this._screenCaptureQueue.push({settings:a||{},callback:b});this._needsRender=!0};d.prototype.getAllTexturesLoaded=function(){return 0===this._textureRep.getLoadingCount()};d.prototype.getTextureLoaded=
function(a){return this._textureRep.getIsLoaded(a)};d.prototype.addTextureListener=function(a){this._textureRep.addTextureListener(a)};d.prototype.removeTextureListener=function(a){this._textureRep.removeTextureListener(a)};d.prototype.addExternalRenderer=function(a,b){return this._viewport.addExternalRenderer(a,b)?(b.initializeRenderContext({rctx:this._rctx,gl:this._rctx.gl,shaderSnippets:this._shaderSnippets,shaderRep:this._shaderRep,programRep:this._programRepository,textureRep:this._textureRep}),
!0):!1};d.prototype.removeExternalRenderer=function(a){return this._viewport.removeExternalRenderer(a)?(a.uninitializeRenderContext({rctx:this._rctx,gl:this._rctx.gl}),!0):!1};d.prototype._performScreenCaptures=function(){if(0!==this._screenCaptureQueue.length){for(var a=0;a<this._screenCaptureQueue.length;a++){var b=this._screenCaptureQueue[a],c=0,d=0,e=this._canvas.width,f=this._canvas.height,g=this._canvas.width,k=this._canvas.height,l=b.settings.area;l&&(c=l.x,d=l.y,e=l.width,f=l.height);void 0!==
b.settings.width&&void 0!==b.settings.height?(l=b.settings.width/b.settings.height,f*l<e?(l*=f,c+=Math.floor((e-l)/2),e=Math.floor(l)):(l=e/l,d+=Math.floor((f-l)/2),f=Math.floor(l)),g=b.settings.width,k=b.settings.height):(g=e,k=f);var p=this._canvas,l=null;if(0!==c||0!==d||e!==this._canvas.width||f!==this._canvas.height||g!==this._canvas.width||k!==this._canvas.height){this._resizeCanvas||(this._resizeCanvas=document.createElement("canvas"));this._resizeCanvas.width=g;this._resizeCanvas.height=k;
var n=this._resizeCanvas.getContext("2d"),l=new Uint8Array(e*f*4);this._gl.readPixels(c,this._canvas.height-(d+f),e,f,6408,5121,l);c=n.getImageData(0,0,g,k);B.resampleHermite(l,e,f,c.data,g,k,!0);n.putImageData(c,0,0);p=this._resizeCanvas;n=null}e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"}[b.settings.format?b.settings.format.toLowerCase():"png"];f=1;void 0!==b.settings.quality&&(f=b.settings.quality/100);e={dataURL:p.toDataURL(e,f),x:0,y:0,width:g,height:k};b.settings.returnByteBuffer&&
(e.data=l);b.callback(e)}this._screenCaptureQueue=[]}};return d}()})},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define(["require","exports","./Util"],function(m,h,d){var c=function(){function a(a){this.refCnt=0;this.glMaterial=a}a.prototype.incRefCnt=function(){++this.refCnt};a.prototype.decRefCnt=function(){--this.refCnt;d.assert(0<=this.refCnt)};a.prototype.getRefCnt=function(){return this.refCnt};a.prototype.getGLMaterial=function(){return this.glMaterial};return a}();return function(){function a(a,
c){this.textureRep=a;this.programRep=c;this.id2glMaterialRef={}}a.prototype.aquire=function(a){return this.aquireExt(a,"color")};a.prototype.aquireDepthShadowMap=function(a){return this.aquireExt(a,"depthShadowMap")};a.prototype.aquireDepth=function(a){return this.aquireExt(a,"depth")};a.prototype.aquireNormal=function(a){return this.aquireExt(a,"normal")};a.prototype.aquireHighlight=function(a){return this.aquireExt(a,"highlight")};a.prototype.aquireExt=function(a,d){var b;b=a.getId()+"_"+d;var g=
this.id2glMaterialRef[b];null==g?(a=(g=a.getGLMaterials()[d])?new g(a,this.programRep,this.textureRep):void 0,g=new c(a),this.id2glMaterialRef[b]=g):a=g.getGLMaterial();g.incRefCnt();a&&this.increaseProgramReferences(a);return a};a.prototype.release=function(a){this.releaseExt(a,"color")};a.prototype.releaseDepth=function(a){this.releaseExt(a,"depth")};a.prototype.releaseNormal=function(a){this.releaseExt(a,"normal")};a.prototype.releaseDepthShadowMap=function(a){this.releaseExt(a,"depthShadowMap")};
a.prototype.releaseHighlight=function(a){this.releaseExt(a,"highlight")};a.prototype.releaseExt=function(a,c){a=a+"_"+c;c=this.id2glMaterialRef[a];c.decRefCnt();if(0===c.getRefCnt()){if(c=c.getGLMaterial())this.decreaseProgramReferences(c),void 0!==c.dispose&&c.dispose();delete this.id2glMaterialRef[a]}};a.prototype.updateMaterialParameters=function(a){var b=this.id2glMaterialRef[a+"_color"];b&&b.getGLMaterial()&&this.updateParamsForMat(b.getGLMaterial());(b=this.id2glMaterialRef[a+"_depth"])&&b.getGLMaterial()&&
this.updateParamsForMat(b.getGLMaterial());(b=this.id2glMaterialRef[a+"_depthShadowMap"])&&b.getGLMaterial()&&this.updateParamsForMat(b.getGLMaterial());(b=this.id2glMaterialRef[a+"_normal"])&&b.getGLMaterial()&&this.updateParamsForMat(b.getGLMaterial());(a=this.id2glMaterialRef[a+"_highlight"])&&a.getGLMaterial()&&this.updateParamsForMat(a.getGLMaterial())};a.prototype.updateParamsForMat=function(a){a.updateParameters&&a.updateParameters()};a.prototype.increaseProgramReferences=function(a){if(a.getAllPrograms){a=
a.getAllPrograms();for(var b=0;b<a.length;b++)this.programRep.increaseRefCount(a[b])}else this.programRep.increaseRefCount(a.getProgram())};a.prototype.decreaseProgramReferences=function(a){if(a.getAllPrograms){a=a.getAllPrograms();for(var b=0;b<a.length;b++)this.programRep.decreaseRefCount(a[b])}else this.programRep.decreaseRefCount(a.getProgram())};return a}()})},"esri/views/3d/webgl-engine/lib/ShaderSnippets":function(){define(["require","exports","./Util","dojox/xml/parser"],function(m,h,d,c){return function(){function a(a){var b=
d.VertexAttrConstants,c;for(c in b)this[b[c]]=d.VertexAttrConstants[c];if(a)for(var g in a)this[g]=a[g]}a.prototype._parse=function(a){a=c.parse(a).getElementsByTagName("snippet");for(var b=/\$[a-zA-Z0-9]+[ \t]*/,f=/[\$\s]+/g,g=0;g<a.length;g++){var e=a[g].getAttribute("name");d.assert(null==this[e]);for(var l=a[g].textContent,p=void 0;null!==(p=l.match(b));){var h=this[p[0].replace(f,"")];d.assert(void 0!==h);l=l.replace(p[0],h)}this[e]=l}};return a}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel",
"dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(m){m.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(h,d){var c=m.doc,a;d=d||"text/xml";if(h&&m.trim(h)&&"DOMParser"in m.global){a=(new DOMParser).parseFromString(h,d);h=a.documentElement;if("parsererror"==h.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==h.namespaceURI){if(c=h.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0])c=c.firstChild.data;
throw Error("Error parsing text "+h.firstChild.data+" \n"+c);}return a}if("ActiveXObject"in m.global){c=function(a){return"MSXML"+a+".DOMDocument"};c=["Microsoft.XMLDOM",c(6),c(4),c(3),c(2)];m.some(c,function(b){try{a=new ActiveXObject(b)}catch(f){return!1}return!0});if(h&&a&&(a.async=!1,a.loadXML(h),h=a.parseError,0!==h.errorCode))throw Error("Line: "+h.line+"\nCol: "+h.linepos+"\nReason: "+h.reason+"\nError Code: "+h.errorCode+"\nSource: "+h.srcText);if(a)return a}else if(c.implementation&&c.implementation.createDocument){if(h&&
m.trim(h)&&c.createElement){d=c.createElement("xml");d.innerHTML=h;var b=c.implementation.createDocument("foo","",null);m.forEach(d.childNodes,function(a){b.importNode(a,!0)});return b}return c.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(h,d){if(1<arguments.length)return dojox.xml.parser.replaceChildren(h,(h.ownerDocument||m.doc).createTextNode(d)),d;if(void 0!==h.textContent)return h.textContent;var c="";h&&m.forEach(h.childNodes,function(a){switch(a.nodeType){case 1:case 5:c+=
dojox.xml.parser.textContent(a);break;case 3:case 2:case 4:c+=a.nodeValue}});return c};dojox.xml.parser.replaceChildren=function(h,d){var c=[];m.isIE&&m.forEach(h.childNodes,function(a){c.push(a)});dojox.xml.parser.removeChildren(h);m.forEach(c,m.destroy);m.isArray(d)?m.forEach(d,function(a){h.appendChild(a)}):h.appendChild(d)};dojox.xml.parser.removeChildren=function(h){for(var d=h.childNodes.length;h.hasChildNodes();)h.removeChild(h.firstChild);return d};dojox.xml.parser.innerXML=function(h){return h.innerXML?
h.innerXML:h.xml?h.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(h):null};return dojox.xml.parser})},"esri/views/3d/webgl-engine/lib/GLSLShaderRep":function(){define(["require","exports","./Util"],function(m,h,d){return function(){function c(){this.shaders={}}c.prototype.add=function(a,b){d.assert(null==this.shaders[a]);this.shaders[a]=b};c.prototype.get=function(a){d.assert(void 0!==this.shaders[a]);return this.shaders[a]};return c}()})},"esri/views/3d/webgl-engine/lib/TextureRenderer":function(){define("require exports ./Renderer ./Camera ./Util ./gl-matrix ../materials/internal/TexOnlyGLMaterial ./ModelDirtyTypesTs ./RenderPass ./HighlightUtils ./ComponentUtils ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/Texture ../lighting/Lightsources ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z){var B=b.vec3d,C=b.vec4d,A=b.mat4d;m=function(){function b(a,b,c,e,f,g){var l=this;this._acquiredTextures={};this._clearColor=C.createFrom(0,0,0,0);this._id2origin={};this._uniqueIdx=0;this._rctx=a;this._canvas=b;this._programRep=c;this._materialRep=e;this._textureRep=f;this._modelDirtySet=g;this._renderer=new d(c,e,f,this._rctx,!0);this._renderer.onHasHighlightsChanged=function(a){if(l.onHasHighlightsChanged)l.onHasHighlightsChanged(a)};this._renderer.setLighting({lights:[new u.AmbientLight(B.createFrom(1,
1,1))],groundLightingFactor:1,globalFactor:0})}b.prototype.dispose=function(){for(var a in this._acquiredTextures)this._acquiredTextures[a].fbo.dispose(),this._textureRep.release(a);this._acquiredTextures=null;this._renderer.dispose();this._renderer=null};b.prototype.addRenderGeometries=function(a){var b=this;a.forEach(function(a){null==a.origin&&(a.origin=b.getOrigin(a.center,a.bsRadius));a.idx=b._uniqueIdx++});this._renderer.modify(a,[])};b.prototype.removeRenderGeometries=function(a){this._renderer.modify([],
a)};b.prototype.updateRenderGeometries=function(a,b){a=a.map(function(a){return{renderGeometry:a,updateType:b}});this._renderer.modify([],[],a,{})};b.prototype.updateRenderOrder=function(a){0<Object.keys(a).length&&this._renderer.modifyRenderOrder(a)};b.prototype.setBackgroundColor=function(a){this._clearColor=a};b.prototype.addRenderGeometryHighlight=function(a,b){var c=a.instanceParameters,d=e.generateHighlightId();c.componentHighlights=l.addHighlight(c.componentHighlights,null,b,d);this.updateRenderGeometries([a],
32);return d};b.prototype.removeRenderGeometryHighlight=function(a,b){var c=a.instanceParameters;c.componentHighlights=l.removeHighlight(c.componentHighlights,b);this.updateRenderGeometries([a],32)};b.prototype.isEmpty=function(){return this._renderer.isEmpty()};b.prototype.processDirtyMaterials=function(){var a=this._modelDirtySet.getDirtyMaterials();a&&this._renderer.modify([],[],[],a);this._modelDirtySet.clearDirtyMaterials()};Object.defineProperty(b.prototype,"hasHighlights",{get:function(){return this._renderer.hasHighlights},
enumerable:!0,configurable:!0});b.prototype.draw=function(a,b){return this.drawPass(g.MATERIAL,a,b)};b.prototype.drawHighlights=function(a,b){return this.drawPass(g.MATERIAL_HIGHLIGHT,a,b)};b.prototype.drawPass=function(a,b,c){if(this.isEmpty())return!1;this.processDirtyMaterials();if(a===g.MATERIAL_HIGHLIGHT&&!this.hasHighlights)return!1;var d=b.getId(),e,f=this._rctx,l=f.gl;if(this._acquiredTextures[d])e=this._acquiredTextures[d].fbo;else{e=this._textureRep.aquire(d).getGLTexture();e=p.createWithAttachments(this._rctx,
e,{colorTarget:0,depthStencilTarget:0});var k=Object.keys(this._acquiredTextures).length;this._acquiredTextures[d]={texture:b,fbo:e,idx:k}}b=c.width;k=c.height;if(e.width!==b||e.height!==k)e.resize(b,k),e.colorTexture.setSamplingMode(9729);H.near=1;H.far=1E4;f.bindFramebuffer(e);f.setDepthTestEnabled(!1);f.setBlendFunctionSeparate(770,771,1,771);f.setClearColor.apply(f,this._clearColor);f.clear(l.COLOR_BUFFER_BIT);this._renderer.setPixelRatio(c.pixelRatio||1);for(l=0;l<c.views.length;l++)e=c.views[l],
H.viewport=e.viewport,A.ortho(0,e.extent[2]-e.extent[0],0,e.extent[3]-e.extent[1],H.near,H.far,H.projectionMatrix),A.identity(H.viewMatrix),A.translate(H.viewMatrix,[-e.extent[0],-e.extent[1],0]),H.setGLViewport(this._rctx),D&&this._drawTestTexture(b,k,E[this._acquiredTextures[d].idx%E.length]),this._renderer.renderGeometryPass(a,H);f.setDepthTestEnabled(!0);f.setBlendFunctionSeparate(770,771,1,771);f.bindFramebuffer(null);f.setViewport(0,0,this._canvas.width,this._canvas.height);return!0};b.prototype._drawTestTexture=
function(a,b,c){var d=this._rctx,e=d.gl;if(!this._testPatternMat){for(var f=new Uint8Array(a*b*4),g=0,l=0;l<b;l++)for(var p=0;p<a;p++){var h=Math.floor(p/10),u=Math.floor(l/10);2>h||2>u||10*h>a-20||10*u>b-20?(f[g++]=255,f[g++]=255,f[g++]=255,f[g++]=255):(f[g++]=255,f[g++]=255,f[g++]=255,h&1&&u&1?f[g++]=p&1^l&1?0:255:f[g++]=h&1^u&1?0:128)}a=new t(d,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:a,height:b},f);this._testPatternMat=new k(this._programRep,a,[1,1,1,1],!0,e.ALWAYS);
this._testPatternBindParams={proj:A.identity(),view:A.identity(),nearFar:[-1,1],origin:[0,0,0]};e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);this._quadVAO=new v(d,z.Default3D,{geometry:r.Pos3Tex},{geometry:q.createVertex(d,35044,e)})}this._testPatternMat.setColor([c[0],c[1],c[2],1]);this._testPatternMat.bind(d,this._testPatternBindParams);this._testPatternMat.bindView(d,this._testPatternBindParams);d.bindVAO(this._quadVAO);d.drawArrays(5,0,n.vertexCount(this._quadVAO,"geometry"));
this._testPatternMat.release(d)};b.prototype.getOrigin=function(b,c){var d=0;c=10*c/1E4;1<c&&(d=Math.ceil(a.logWithBase(c,2)));c=1E4*Math.pow(2,d);var e=Math.round(b[0]/c),f=Math.round(b[1]/c);b=Math.round(b[2]/c);var d=d+"_"+e+"_"+f+"_"+b,g=this._id2origin[d];null==g&&(g={vec3:B.createFrom(e*c,f*c,b*c),id:d},this._id2origin[d]=g);return g};return b}();var D=!1,E=[[1,.5,.5],[.5,.5,1],[.5,1,.5]],H=new c;return m})},"esri/views/3d/webgl-engine/lib/Renderer":function(){define("require exports ./IntervalUtilities ./ModelDirtyTypesTs ./Float32ArrayList ./InstanceBufferData ../lighting/SceneLighting ../materials/internal/SimpleGLMaterial ./LinearDepthTextureHelper ./NormalTextureHelper ./HighlightTextureHelper ./RenderPass ./RenderSlot ./RenderContext ./ExternalRendererContainer ./StencilRenderingHelper ./Util ./gl-matrix ./ComponentUtils ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ./FxaaRenderPass ./SmaaRenderPass ../../../webgl/enums ./DefaultVertexAttributeLocations ../../../webgl/Profiling".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J){var I=u.assert,F=u.objectEmpty,N=u.getFirstObjectValue,L=u.setMatrixTranslation3;m=x.vec2d;var M=x.vec4d,K=x.mat4d,ba=u.VertexAttrConstants,X=K.identity();u=function(){function c(a,b,c,d,p){this._lighting=new k.SceneLighting;this._mat2dataMerged={};this._mat2dataInstanced={};this._renderOrder=[];this._externalRenderers=new n;this._renderContext=new q;this._framesRendered=0;this._isRendering=!1;this._highlights=[];this._pixelRatio=1;
this._threshold=1535;this._needsRender=!0;this._fallbackDepthStencilTexture=null;this._stats=new T;this.ssaoEnabled=!1;this.renderOptions={antialiasing:"smaa",earlyOcclusionPixelDraw:!1};this._programRep=a;this._materialRep=b;this._textureRep=c;this._orderedRendering=p;this._rctx=d;b=d.gl;this._fxaaPass=new D(d);this._smaaPass=new E(d);this._selectionMaterial=new f(a,M.createFrom(.1,.2,.9,.4),b.EQUAL);this._selectionMaterialLines=new f(a,M.createFrom(.1,.2,.9,.4),b.EQUAL,b.LINES);this._renderContext.lightingData=
this._lighting.getOld();d.setDepthTestEnabled(!0);d.setFaceCullingEnabled(!0);d.setBlendingEnabled(!1);d.setBlendFunctionSeparate(770,771,1,771);this._bindParameters={view:null,proj:null,viewInvTransp:null,nearFar:null,lightingData:null,viewport:null,framebufferTex:null,shadowMappingEnabled:!1,ssaoEnabled:!1,origin:null,pixelRatio:null,instanceParameters:null,depthFBO:null,normalFBO:null,extensions:{angleInstancedArrays:d.extensions.angleInstancedArrays}};this._linearDepthTextureHelper=new g(d);this._normalTextureHelper=
new e(d);this._highlightTextureHelper=new l(d);this._stencilRenderingHelper=new t(d);this._initializeFramebufferTexture()}c.prototype._initializeFramebufferTexture=function(){var a=this._rctx.gl,a=this._rctx.contextAttributes.alpha?a.RGBA:a.RGB,b=new z(this._rctx,{target:3553,pixelFormat:a,dataType:5121,samplingMode:9728,wrapMode:33071,width:4,height:4});this._framebuffer={format:a,texture:b}};c.prototype.dispose=function(){for(var a in this._mat2dataMerged){this._releaseMaterials(a);var b=this._mat2dataMerged[a],
c;for(c in b.origin2data)b.origin2data[c].vao.dispose(!0)}this._mat2dataMerged=null;for(a in this._mat2dataInstanced)for(c in this._releaseMaterials(a),b=this._mat2dataInstanced[a],b.origin2data)b.origin2data[c].vao.dispose(!0);this._mat2dataInstanced=null;this._framebuffer.texture.dispose();this._framebuffer.texture=null;this._linearDepthTextureHelper.getEnableState()&&this._linearDepthTextureHelper.disable();this._normalTextureHelper.getEnableState()&&this._normalTextureHelper.disable();this._highlightTextureHelper.getEnableState()&&
this._highlightTextureHelper.setEnableState(!1);this._stencilRenderingHelper.getEnableState()&&this._stencilRenderingHelper.setEnableState(!1);this._fallbackDepthStencilTexture&&(this._fallbackDepthStencilTexture.dispose(),this._fallbackDepthStencilTexture=null)};c.prototype.setLighting=function(a){this._lighting.set(a)};c.prototype.setPixelRatio=function(a){this._pixelRatio=a;this._needsRender=!0};c.prototype.getPixelRatio=function(){return this._pixelRatio};c.prototype.addExternalRenderer=function(a,
b){this._externalRenderers.addRenderer(a,b);return!0};c.prototype.removeExternalRenderer=function(a){this._externalRenderers.removeRenderer(a);return!0};c.prototype.getExternalRenderers=function(){return this._externalRenderers};c.prototype.resetNeedsRender=function(){this._needsRender=!1;this._externalRenderers.resetNeedsRender()};c.prototype.needsRender=function(){return this._needsRender||this._externalRenderers.needsRender()};c.prototype.getCombinedStats=function(){this._stats.VBOallocatedSize=
0;this._stats.VBOoptimalSize=0;this._stats.VBOusedSize=0;for(var a in this._mat2dataInstanced){var b=this._mat2dataInstanced[a],c;for(c in b.origin2data){var d=b.origin2data[c];this._stats.VBOallocatedSize+=d.buffer.getArray().length;this._stats.VBOusedSize+=d.buffer.getSize();this._stats.VBOoptimalSize+=d.optimalCount}}for(a in this._mat2dataMerged)for(c in b=this._mat2dataMerged[a],b.origin2data)d=b.origin2data[c],this._stats.VBOallocatedSize+=d.buffer.getArray().length,this._stats.VBOusedSize+=
d.buffer.getSize(),this._stats.VBOoptimalSize+=d.optimalCount;this._stats.VBOallocatedSize*=.00390625;this._stats.VBOusedSize*=.00390625;this._stats.VBOoptimalSize*=.00390625;return this._stats};c.prototype._addHighlight=function(a){var b=this._getInstance(a,!0)||this._getInstance(a,!1);if(null===b)console.error("No instance found for RenderGeometry {name: '"+a.name+"', uniqueName: '"+a.uniqueName+"'}");else if(this._highlights.push(b),this._orderedRendering&&this._sortHighlightsByRenderOrder(),this._needsRender=
!0,this.onHasHighlightsChanged)this.onHasHighlightsChanged(this.hasHighlights)};c.prototype._removeHighlight=function(a){var b=this._highlights.length;this._highlights=this._highlights.filter(function(b){return b.uniqueName!==a.uniqueName});if(b!==this._highlights.length){if(this.onHasHighlightsChanged)this.onHasHighlightsChanged(this.hasHighlights);this._needsRender=!0}};Object.defineProperty(c.prototype,"hasHighlights",{get:function(){return 0<this._highlights.length},enumerable:!0,configurable:!0});
c.prototype._renderHUDVisibility=function(a){var b=this;a.offscreenRenderingHelper.renderHUDVisibility(function(){b._renderInternalSlot(v.OCCLUSION_PIXELS,a)})};c.prototype.renderGeometrySlots=function(a){this._externalRenderers.render(v.INTERNAL_MATERIAL,a);this._renderInternalSlot(v.STENCIL_MATERIAL,a);this._externalRenderers.render(v.OPAQUE_TERRAIN,a);this._renderInternalSlot(v.OPAQUE_MATERIAL,a);this._externalRenderers.render(v.OPAQUE_EXTERNAL,a);a.ssaoHelper&&a.ssaoHelper.bindAll(this._programRep);
this._renderInternalSlot(v.TRANSPARENT_MATERIAL,a);this.renderOptions.earlyOcclusionPixelDraw&&(this._renderHUDVisibility(a),this._renderInternalSlot(v.LINE_CALLOUTS,this._renderContext));this._externalRenderers.render(v.TRANSPARENT_EXTERNAL,a);a.ssaoHelper&&a.ssaoHelper.bindAll(this._programRep);this._externalRenderers.render(v.TRANSPARENT_TERRAIN,a)};c.prototype._renderHighlights=function(a,b,c){var d=!!c&&c.getEnableState()&&(this.hasHighlights||this._externalRenderers.needsHighlight());this._highlightTextureHelper.setEnableState(d);
if(d){d=null;c.profilingCallback&&(d=J.startMeasurement(this._renderContext.rctx));this._highlightTextureHelper.setupFBOs(a);this._highlightTextureHelper.prepareHighlightPass();this.renderGeometryPass(p.MATERIAL_HIGHLIGHT,a,null,null);this._rctx.clear(this._rctx.gl.DEPTH_BUFFER_BIT);this._renderInternalSlot(v.LINE_CALLOUTS_HUD_DEPTH,this._renderContext);this._renderInternalSlot(v.HUDMATERIAL1,this._renderContext);this._renderInternalSlot(v.HUDMATERIAL2,this._renderContext);this._highlightTextureHelper.finish(b);
var e=this._highlightTextureHelper.getHighlightFBO();c.render(a,b,e);null!==d&&c.profilingCallback&&d.stop(function(a){c.profilingCallback&&c.profilingCallback(a)})}};c.prototype._renderUnordered=function(a,b,c,d,e,f){var g=this._rctx;this._isRendering=!0;this._stats.reset();this._updateGlobalUniforms(a.projectionMatrix);this._renderContext.pass=p.MATERIAL;this._renderContext.camera=a;this._renderContext.shadowMap=b;this._renderContext.ssaoHelper=c;this._renderContext.offscreenRenderingHelper=e;this._renderContext.stencilRenderingHelper=
this._stencilRenderingHelper;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.highlight=this._highlightTextureHelper.getHighlightFBO();this._renderContext.options=this.renderOptions;this._renderContext.rctx=this._rctx;this._renderContext.lightingData=this._lighting.getOld();e.setEnableState(!0);e.initializeFrame(a);this._externalRenderers.render(v.BACKGROUND,this._renderContext);this.renderGeometrySlots(this._renderContext);
this._externalRenderers.render(v.POSTPROCESSING_ATMOSPHERE,this._renderContext);this.renderOptions.earlyOcclusionPixelDraw||(this._renderHUDVisibility(this._renderContext),this._renderInternalSlot(v.LINE_CALLOUTS,this._renderContext));switch(this.renderOptions.antialiasing){case "none":b=a.viewport;b=K.ortho(b[0],b[2],b[1],b[3],-1,1);e.drawQuad(b);this._fxaaPass.disable();this._smaaPass.disable();break;case "fxaa":this._smaaPass.disable();this._fxaaPass.render({colorTexture:e.getColorTexture()},null);
break;case "smaa":this._fxaaPass.disable(),this._smaaPass.render({colorTexture:e.getColorTexture()},null)}g.bindFramebuffer(null);this._renderContext.framebufferTex=e.getColorTexture();this._renderInternalSlot(v.LINE_CALLOUTS_HUD_DEPTH,this._renderContext);this._renderInternalSlot(v.HUDMATERIAL1,this._renderContext);this._renderInternalSlot(v.HUDMATERIAL2,this._renderContext);this._renderHighlights(a,d,f);this._framesRendered++;this._isRendering=!1};c.prototype._renderGeometryPassOrderedHighlight=
function(a){this._renderInternalHighlights(this._highlights)};c.prototype._renderGeometryPassOrderedMaterial=function(a){for(var b=null,c=0;c<this._renderOrder.length;c++){var d=this._renderOrder[c][1];if(d.instanced){var e=d.instanced||d.merged,f=e[a.pass];!f||f.isVisible&&!f.isVisible()||(this._renderInternalInstanced(e,f,this._bindParameters,Infinity),b=null)}d.merged&&(e=d.merged,!(f=e[a.pass])||f.isVisible&&!f.isVisible()||(d=f.getProgram(),d!==b&&(d.setUniformMatrix4fv("model",X),d.hasUniform("modelNormal")&&
d.setUniformMatrix4fv("modelNormal",X)),b=d,this._renderInternalMerged(e,f,this._bindParameters,Infinity)))}};c.prototype._renderGeometryPassOrdered=function(a){var b=a.camera;this._bindParameters.view=b.viewMatrix;this._bindParameters.proj=b.projectionMatrix;this._bindParameters.viewInvTransp=b.viewInverseTransposeMatrix;P[0]=b.near;P[1]=b.far;this._bindParameters.nearFar=P;this._bindParameters.lightingData=this._lighting.getOld();this._bindParameters.viewport=b.fullViewport;this._bindParameters.framebufferTex=
this._framebuffer.texture;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();this._bindParameters.normalFBO=this._normalTextureHelper.getNormalFBO();a.isHighlightPass?this._renderGeometryPassOrderedHighlight(a):this._renderGeometryPassOrderedMaterial(a)};c.prototype._renderOrdered=function(a,b){this._stats.reset();this.renderGeometryPass(a,b);this._framesRendered++};c.prototype.render=
function(a,b,c,d,e,f){this._orderedRendering?this._renderOrdered(p.MATERIAL,a):this._renderUnordered(a,b,c,d,f,e)};c.prototype.renderAuxiliaryBuffers=function(a,b,c,d,e){e=this.ssaoEnabled;this._linearDepthTextureHelper.setEnableState(e);e&&(this._linearDepthTextureHelper.setupFBOs(a),this._linearDepthTextureHelper.prepareDepthPass(),this.renderGeometryPass(p.MATERIAL_DEPTH,a,b,c),this._linearDepthTextureHelper.finish(d));this._normalTextureHelper.setEnableState(this.ssaoEnabled);this.ssaoEnabled&&
(this._normalTextureHelper.setupFBOs(a),this._normalTextureHelper.prepareNormalPass(),this.renderGeometryPass(p.MATERIAL_NORMAL,a,b,c),this._normalTextureHelper.finish(d));this.ssaoEnabled&&c.computeSSAO(a,d,this._linearDepthTextureHelper.getDepthFBO(),this._normalTextureHelper.getNormalFBO());c.bindAll(this._programRep)};c.prototype.renderGeometryPass=function(a,b,c,d){this._isRendering=!0;this._updateGlobalUniforms(b.projectionMatrix);this._renderContext.pass=a;this._renderContext.camera=b;this._renderContext.shadowMap=
c;this._renderContext.ssaoHelper=d;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.rctx=this._rctx;this._orderedRendering?this._renderGeometryPassOrdered(this._renderContext):this._renderGeometryPassUnordered(this._renderContext);this._isRendering=!1};c.prototype._renderGeometryPassUnordered=function(a){this.renderGeometrySlots(a)};c.prototype._renderInternalHighlights=function(a,b){void 0===
b&&(b=null);for(var c=0;c<a.length;++c){var d=a[c],e=d.matData[p.MATERIAL_HIGHLIGHT];!e||null!==b&&!e.beginSlot(b)||e.isVisible&&!e.isVisible()||this._renderInternalHighlight(d,this._bindParameters,p.MATERIAL_HIGHLIGHT)}};c.prototype._renderInternalSlotMaterial=function(a,b){for(var c in this._mat2dataInstanced){var d=this._mat2dataInstanced[c],e=d[b.pass];e&&e.beginSlot(a)&&(!e.isVisible||e.isVisible())&&this._renderInternalInstanced(d,e,this._bindParameters,a)}for(var d=this._programRep.getProgramsUsingUniform("model"),
e=this._programRep.getProgramsUsingUniform("modelNormal"),f=0;f<d.length;f++){var g=d[f];g.setUniformMatrix4fv("model",X);-1<e.indexOf(g)&&g.setUniformMatrix4fv("modelNormal",X)}for(c in this._mat2dataMerged)d=this._mat2dataMerged[c],(e=d[b.pass])&&e.beginSlot(a)&&(!e.isVisible||e.isVisible())&&this._renderInternalMerged(d,e,this._bindParameters,a);a===v.STENCIL_MATERIAL&&this._stencilRenderingHelper.finish()};c.prototype._renderInternalSlotHighlights=function(a,b){this._renderInternalHighlights(this._highlights,
a)};c.prototype._renderInternalSlot=function(a,b){this._bindParameters.view=b.camera.viewMatrix;this._bindParameters.proj=b.camera.projectionMatrix;this._bindParameters.viewInvTransp=b.camera.viewInverseTransposeMatrix;this._bindParameters.cameraAboveGround=b.camera.aboveGround;this._bindParameters.fovY=b.camera.fovY;this._bindParameters.poiDistance=b.camera.distance;P[0]=b.camera.near;P[1]=b.camera.far;var c=this._renderContext.offscreenRenderingHelper;this._bindParameters.nearFar=P;this._bindParameters.lightingData=
this._lighting.getOld();this._bindParameters.viewport=b.camera.fullViewport;this._bindParameters.framebufferTex=c?c.getColorTexture():null;this._bindParameters.shadowMap=b.shadowMap;this._bindParameters.shadowMappingEnabled=!!b.shadowMap&&b.shadowMap.getEnableState();this._bindParameters.ssaoEnabled=!!b.ssaoHelper&&b.ssaoHelper.getEnableState();this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();
this._bindParameters.hudVisibilityTexture=c?c.getHUDVisibilityTexture():null;b.isHighlightPass?this._renderInternalSlotHighlights(a,b):this._renderInternalSlotMaterial(a,b)};c.prototype._renderInternalInstanced=function(a,b,c,d){var e=this._rctx,f=e.gl,g=!1,l=b.getDrawMode(e),k=this._bindParameters.extensions.angleInstancedArrays,p;for(p in a.origin2data){var n=a.origin2data[p];c.origin=n.origin;d===v.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());
var h=!1;if(b.instanced)for(var t in n.perGeometryDataInfo){var q=n.perGeometryDataInfo[t];g||(b.bind(e,c),g=!0);e.bindVAO(q.vao);var r=b.getProgram();A.assertCompatibleVertexAttributeLocations(q.vao,r);h||(b.bindView(e,c),h=!0);var r=q.to-q.from,u=q.refCount;l===f.TRIANGLES&&(this._stats.trianglesRendered+=u*r/3);k.drawArraysInstancedANGLE(l,q.from,r,u);this._stats.drawCallsAngleInstanced++;this._stats.instancesDrawnAngle+=u}else{var q=n.instances,x;for(x in q)r=q[x],u=r.displayedIndexRange,u&&0===
u.length||(g||(b.bind(e,c),g=!0),h||(e.bindVAO(n.vao),b.bindView(e,c),h=!0),b.bindInstance(e,r),this._stats.drawCallsInstanced++,l===f.TRIANGLES&&(this._stats.trianglesRendered+=(r.to-r.from)/3),u?this._drawArraysFaceRange(u,r.from,l):e.drawArrays(l,r.from,r.to-r.from))}}e.bindVAO(null);g&&b.release(e,c)};c.prototype._renderInternalHighlight=function(a,b,c){var d=this._rctx,e=d.gl;c=a.matData[c];var f=c.getDrawMode(d),g=a.instance,l=g.highlightedIndexRange,k=this._renderContext.offscreenRenderingHelper,
k=(k?k.getDepthTexture():null)||this._getFallbackDepthTexture(),p=c.getProgram(),n=this._bindParameters.extensions.angleInstancedArrays;b.origin=a.originData.origin;if(c.instanced&&"instanced"===a.type){var h=a.instancedVAO;c.bind(d,b);d.bindVAO(h);A.assertCompatibleVertexAttributeLocations(h,p);c.bindView(d,b);for(a=0;a<l.length;a++){var q=l[a],h=q.range?q.range[0]+g.from:g.from,q=q.range?q.range[1]-q.range[0]+1:g.to-g.from;d.bindTexture(k,5);p.setUniform1i("depthTex",5);p.setUniform4f("highlightViewportPixelSz",
0,0,1/this._bindParameters.viewport[2],1/this._bindParameters.viewport[3]);n.drawArraysInstancedANGLE(f,h,q,1);f===e.TRIANGLES&&(this._stats.trianglesRendered+=1*q/3);this._stats.drawCallsHighlight++}}else if("merged"===a.type||"instanced"===a.type&&!c.instanced)for(h=a.originData.vao,c.bind(d,b),d.bindVAO(h),c.bindView(d,b),"instanced"===a.type?c.bindInstance(d,g):p.setUniformMatrix4fv("model",X),a=0;a<l.length;a++)q=l[a],h=q.range?q.range[0]+g.from:g.from,q=q.range?q.range[1]-q.range[0]+1:g.to-
g.from,d.bindTexture(k,5),c.getProgram().setUniform1i("depthTex",5),p.setUniform4f("highlightViewportPixelSz",0,0,1/this._bindParameters.viewport[2],1/this._bindParameters.viewport[3]),d.drawArrays(f,h,q),f===e.TRIANGLES&&(this._stats.trianglesRendered+=q/3),this._stats.drawCallsHighlight++;else console.error("_renderInternalHighlight: incompatible istance type");d.bindVAO(null);c.release(d,b)};c.prototype._drawArraysFaceRange=function(a,b,c){for(var d=this._rctx,e=0;e<a.length;e++){var f=a[e];d.drawArrays(c,
f[0]+b,f[1]-f[0]+1)}this._stats.drawCallsFragmented+=a.length-1};c.prototype._renderInternalMerged=function(a,b,c,d){var e=this._rctx,f=e.gl,g=!1,l;for(l in a.origin2data){var k=a.origin2data[l];c.origin=k.origin;d===v.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());if(!k.displayedIndexRange||0!==k.displayedIndexRange.length){g||(b.bind(e,c),g=!0);var p=b.getProgram();e.bindVAO(k.vao);A.assertCompatibleVertexAttributeLocations(k.vao,
p);b.bindView(e,c);this._stats.drawCallsMerged++;p=b.getDrawMode(e);p===f.TRIANGLES&&(this._stats.trianglesRendered+=k.vao.vertexBuffers.geometry.size/3);k.displayedIndexRange?this._drawArraysFaceRange(k.displayedIndexRange,0,p):e.drawArrays(p,0,A.vertexCount(k.vao,"geometry"))}}g&&b.release(e,c)};c.prototype._updateGlobalUniforms=function(a){for(var b=this._programRep.getProgramsUsingUniform("proj"),c=0;c<b.length;c++)b[c].setUniformMatrix4fv("proj",a);if(this._lighting){b=this._programRep.getProgramsUsingUniform("lightingMainDirection");
for(c=0;c<b.length;c++)this._lighting.setUniforms(b[c]);b=this._programRep.getProgramsUsingUniform("lightDirection");for(c=0;c<b.length;c++)this._lighting.setUniforms(b[c])}};c.prototype.print=function(){var a=Object.keys(this._mat2dataMerged).length,b=Object.keys(this._mat2dataInstanced).length;console.log("number of materials (merged/instanced): "+a+"/"+b);var a=0,c;for(c in this._mat2dataMerged){var b=this._mat2dataMerged[c],d;for(d in b.origin2data)a+=Object.keys(b.origin2data[d].instances).length}var e=
0;for(c in this._mat2dataInstanced)for(d in b=this._mat2dataInstanced[c],b.origin2data)e+=Object.keys(b.origin2data[d].instances).length;console.log("number of instances (merged/instanced): "+a+"/"+e)};c.prototype.isEmpty=function(){for(var a in this._mat2dataInstanced){var b=this._mat2dataInstanced[a],c;for(c in b.origin2data)if(!F(b.origin2data[c].instances))return!1}for(a in this._mat2dataMerged)for(c in b=this._mat2dataMerged[a],b.origin2data)if(!F(b.origin2data[c].instances))return!1;return!0};
c.prototype.modify=function(a,b,c,d){this._isRendering&&console.warn("Renderer.modify called while rendering");var e=[],f=[];this._mergedOrInstanced(a,e,f);a=[];var g=[];this._mergedOrInstanced(b,a,g);var l={};c&&this._performUpdates(c,l);c=[];this._modifyMerged(e,a,c,l);this._modifyInstanced(f,g,c);this._updateMergedFaceranges(l);this._releaseMaterials(c);e=this._highlights.length;if(b&&0<b.length&&0<e&&(this._highlights=this._highlights.filter(function(a){return!b.some(function(b){return b.uniqueName===
a.uniqueName})}),e!==this._highlights.length&&this.onHasHighlightsChanged))this.onHasHighlightsChanged(this.hasHighlights);this._updateHighlightVAOs();this._modifyMaterials(d);this._needsRender=!0};c.prototype._isInstanced=function(a){var b=!1,c=N(a.data.faces.indices).length,b=(b=(b=b||!1===a.material.canBeMerged)||a.material.instanced)||a.material.isBackdrop;return a.singleUse?b:b=b||c>this._threshold};c.prototype._mergedOrInstanced=function(a,b,c){for(var d=0;d<a.length;++d)1>N(a[d].data.faces.indices).length||
(this._isInstanced(a[d])?c.push(a[d]):b.push(a[d]))};c.prototype._performUpdates=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.renderGeometry,f=this._isInstanced(e),d=d.updateType;d&2&&this._updateFaceranges(e,f,b);if(d&32){var g=this._getInstance(e,f);g&&this._updateHighlightFaceranges(e,g.instance)}d&4||!f&&d&16?this._updateVertexAttributes(e,f):f&&d&16?this._updateInstanceTransformation(e,f):d&8&&this._updateColorAttributes(e)}};c.prototype._updateFaceranges=function(a,b,c){var d=a.material.getId(),
e=a.origin.id,f=(b?this._mat2dataInstanced:this._mat2dataMerged)[d].origin2data[e],g=f.instances[a.uniqueName];g&&(g.displayedIndexRange=r.generateVisibleIndexRanges(a.instanceParameters.componentVisibilities,a.componentOffsets),b||(c[this._modifiedMergedFacerangesKey(d,e)]=f),this._updateHighlightFaceranges(a,g))};c.prototype._updateHighlightFaceranges=function(a,b){if(b){var c=b.highlightedIndexRange,d;d=r.generateHighlightedIndexRanges(a.instanceParameters.componentVisibilities,a.instanceParameters.componentHighlights,
a.componentOffsets);(b.highlightedIndexRange=d)&&!c?this._addHighlight(a):!d&&c&&this._removeHighlight(a)}};c.prototype._updateMergedFaceranges=function(a){for(var b in a){var c=a[b];c.displayedIndexRange=[];var e=c.instances,f=!0,g;for(g in e){var l=e[g];l.displayedIndexRange?(c.displayedIndexRange.push.apply(c.displayedIndexRange,d.offsetIntervals(l.displayedIndexRange,l.from)),f=!1):c.displayedIndexRange.push([l.from,l.to-1])}c.displayedIndexRange=f?null:d.mergeIntervals(c.displayedIndexRange)}};
c.prototype._updateVertexAttributes=function(a,b){var c=a.material,d=c.getId(),d=(b?this._mat2dataInstanced:this._mat2dataMerged)[d].origin2data[a.origin.id],e=d.instances[a.uniqueName],f,g;b||(f=a.origin.vec3,L(W,-f[0],-f[1],-f[2]),K.multiply(W,a.transformation,U),K.inverse(U,Y),K.transpose(Y),f=U,g=Y);b=A.getStride(c.getVertexBufferLayout());var l=b/4;I(e.from+c.getOutputAmount(N(a.data.faces.indices).length)/l===e.to,"material VBO layout has changed");c.fillInterleaved(a.data,f,g,a.instanceParameters,
d.buffer.getArray(),e.from*l);d.vao.vertexBuffers.geometry.setSubData(d.buffer.getArray(),e.from*b,e.from*b,e.to*b)};c.prototype._updateInstanceTransformation=function(a,b){var c=a.origin.vec3,d=(b?this._mat2dataInstanced:this._mat2dataMerged)[a.material.getId()].origin2data[a.origin.id];b=d.instances[a.uniqueName];L(W,-c[0],-c[1],-c[2]);K.multiply(W,a.transformation,b.transformation);K.inverse(b.transformation,b.transformationNormal);K.transpose(b.transformationNormal,b.transformationNormal);c=d.perGeometryDataInfo[a.data.id];
if(d=c.instanceBufferData)a=d.getSlot(a.idx),d.fill(a,0,b.transformation),d.fill(a,16,b.transformationNormal),a=4*d.getOffset(a),b=A.getStride(c.vao.layout.instance),c.vao.vertexBuffers.instance.setSubData(d.getArray(),a,a,a+b)};c.prototype._updateColorAttributes=function(a){var b=a.material,c=b.getId(),d=a.origin.id,c=(this._isInstanced(a)?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[d],d=c.instances[a.uniqueName],e=(f={},f[ba.COLOR]=!0,f[ba.SYMBOLCOLOR]=!0,f),f=A.getStride(b.getVertexBufferLayout())/
4;I(d.from+b.getOutputAmount(N(a.data.faces.indices).length)/f===d.to,"material VBO layout has changed");b.fillInterleaved(a.data,void 0,void 0,a.instanceParameters,c.buffer.getArray(),d.from*f,e);c.vao.vertexBuffers.geometry.setSubData(c.buffer.getArray(),d.from*f*4,d.from*f*4,d.to*f*4);var f};c.prototype._modifyMerged=function(b,c,d,e){var f=this._rctx;b=this._compMat2delta(b,c,!1);for(var g in b){c=b[g];for(var l in c){var k=c[l],n=k.optimalCount,h=k.material,q=h.getVertexBufferLayout(),t=A.getStride(q)/
4,v=this._mat2dataMerged[g];if(null==v){I(0<n);var u=h.getRenderPriority(),v={origin2data:{}};v[p.MATERIAL]=this._materialRep.aquire(h);v[p.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(h);v[p.MATERIAL_NORMAL]=this._materialRep.aquireNormal(h);v[p.MATERIAL_DEPTH]=this._materialRep.aquireDepth(h);v[p.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(h);this._mat2dataMerged[g]=v;this._orderedRendering&&this._insertIntoRenderOrder(v,u,"merged")}u=v.origin2data[l];null==u&&(I(0<
n),u={instances:{},vao:new B(f,G.Default3D,{geometry:q},{geometry:C.createVertex(f,35044)}),buffer:new a(n),optimalCount:0,origin:k.origin},v.origin2data[l]=u);if(0<n){var q=u.buffer.getSize(),x=u.buffer.getArray(),v=n<k.sparseCount/2,m=u.buffer.resize(v?n:k.sparseCount),z=k.toRemove;if(v||m){for(var q=0,D=u.buffer.getArray(),v=0;v<z.length;++v)m=u.instances[z[v].uniqueName],u.optimalCount-=(m.to-m.from)*t,delete u.instances[z[v].uniqueName];var v={},E;for(E in u.instances)m=u.instances[E],I(null==
v[m.from]),v[m.from]=m;for(var H in v){var m=v[H],F=m.from*t,J=m.to*t;D.set(x.subarray(F,J),q);m.from=q/t;q+=J-F;m.to=q/t}I(q===u.optimalCount)}else for(v=0;v<z.length;++v)m=z[v].uniqueName,I(void 0!==u.instances[m]),F=u.instances[m].from*t,J=u.instances[m].to*t,u.buffer.erase(F,J),delete u.instances[m],u.optimalCount-=J-F;L(W,-k.origin[0],-k.origin[1],-k.origin[2]);x=k.toAdd;k=!1;for(v=0;v<x.length;++v)z=x[v],F=z.data,K.multiply(W,z.transformation,U),K.inverse(U,Y),K.transpose(Y),m=q,h.fillInterleaved(F,
U,Y,z.instanceParameters,u.buffer.getArray(),q),F=h.getOutputAmount(N(F.faces.indices).length),D=m+F,I(null==u.instances[z.uniqueName]),J=r.generateVisibleIndexRanges(z.instanceParameters.componentVisibilities,z.componentOffsets),m=new V(z.name,m/t,D/t,J,void 0,void 0,z.idx),u.instances[z.uniqueName]=m,this._updateHighlightFaceranges(z,m),J&&(k=!0),u.optimalCount+=F,q+=F;I(u.optimalCount===n);n=new Float32Array(u.buffer.getArray().buffer,0,u.buffer.getSize());u.vao.vertexBuffers.geometry.setData(n);
if(k||u.displayedIndexRange)e[this._modifiedMergedFacerangesKey(g,l)]=u}else I(0===n),u.vao.dispose(!0),u.vao=null,delete v.origin2data[l],0===Object.keys(v.origin2data).length&&(d.push(g),delete this._mat2dataMerged[g],this._orderedRendering&&this._removeFromRenderOrder(v,"merged"))}}};c.prototype._modifyInstanced=function(c,d,e){c=this._compMat2delta(c,d,!0);d=this._rctx;for(var f in c){var g=c[f],l;for(l in g){var k=g[l];if(0===k.optimalCount)k=this._mat2dataInstanced[f],k.origin2data[l].vao.dispose(!0),
delete k.origin2data[l],0===Object.keys(k.origin2data).length&&(e.push(f),delete this._mat2dataInstanced[f],this._orderedRendering&&this._removeFromRenderOrder(k,"instanced"));else{var n=k.material,h=this._mat2dataInstanced[f];if(null==h){var q=n.getRenderPriority(),h={origin2data:{}};h[p.MATERIAL]=this._materialRep.aquire(n);h[p.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(n);h[p.MATERIAL_NORMAL]=this._materialRep.aquireNormal(n);h[p.MATERIAL_DEPTH]=this._materialRep.aquireDepth(n);
h[p.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(n);this._mat2dataInstanced[f]=h;this._orderedRendering&&this._insertIntoRenderOrder(h,q,"instanced")}var t=n.getVertexBufferLayout(),v=h[p.MATERIAL].instanced?n.getInstanceBufferLayout():void 0,u=v&&A.findAttribute(v,"instanceColor"),m=v&&A.findAttribute(v,"instanceFeatureAttribute"),x=A.getStride(t)/4,q=h.origin2data[l];null==q&&(q={instances:{},vao:new B(d,G.Default3D,{geometry:t},{geometry:C.createVertex(d,35044)}),buffer:new a(k.optimalCount),
optimalCount:0,perGeometryDataInfo:{},origin:k.origin},h.origin2data[l]=q);var h=q.buffer.getSize(),z=q.buffer.getArray(),D=k.optimalCount<k.sparseCount/2,E=q.buffer.resize(D?k.optimalCount:k.sparseCount),H;for(H in k.perGeometryDelta){var F=q.perGeometryDataInfo[H];if(F&&F.instanceBufferData){var J=k.perGeometryDelta[H].removeCount;0<J&&F.instanceBufferData.prepareFree(J)}}var P=k.toRemove;if(D||E){for(D=0;D<P.length;++D){E=P[D];delete q.instances[E.uniqueName];H=E.data.id;var Y=F=q.perGeometryDataInfo[H];
0===--Y.refCount&&null==k.dataId2refCount[H]?(q.optimalCount-=(Y.to-Y.from)*x,delete q.perGeometryDataInfo[H]):F.instanceBufferData&&F.instanceBufferData.free(E.idx)}var h=0,D=q.buffer.getArray(),E={},S;for(S in q.perGeometryDataInfo)Y=q.perGeometryDataInfo[S],I(null==E[Y.from]),E[Y.from]=Y;for(var ca in E)Y=E[ca],J=Y.from*x,F=Y.to*x,D.set(z.subarray(J,F),h),Y.from=h/x,h+=F-J,Y.to=h/x;for(var T in q.instances)J=q.instances[T],J.from=q.perGeometryDataInfo[J.dataId].from,J.to=q.perGeometryDataInfo[J.dataId].to}else for(D=
0;D<P.length;++D)E=P[D],delete q.instances[E.uniqueName],H=E.data.id,F=q.perGeometryDataInfo[H],0===--F.refCount&&null==k.dataId2refCount[H]?(J=F.from*x,F=F.to*x,q.buffer.erase(J,F),q.optimalCount-=F-J,delete q.perGeometryDataInfo[H]):F.instanceBufferData&&F.instanceBufferData.free(E.idx);L(W,-k.origin[0],-k.origin[1],-k.origin[2]);for(H in k.perGeometryDelta)(F=q.perGeometryDataInfo[H])&&F.instanceBufferData&&(D=k.perGeometryDelta[H].addCount,0<D&&F.instanceBufferData.prepareAllocate(D));z=k.toAdd;
for(D=0;D<z.length;++D)if(E=z[D],J=E.data,H=J.id,F=q.perGeometryDataInfo[H],null==F?(n.fillInterleaved(J,void 0,void 0,void 0,q.buffer.getArray(),h),P=n.getOutputAmount(N(J.faces.indices).length),J=h/x,h+=P,F=h/x,q.optimalCount+=P,F={refCount:1,from:J,to:F,vao:null,instanceBufferData:null},v&&(J=A.getStride(v)/4,F.vao=new B(d,G.Default3D,{geometry:t,instance:v},{geometry:q.vao.vertexBuffers.geometry,instance:C.createVertex(d,35044)}),F.instanceBufferData=new b(J,k.perGeometryDelta[H].addCount)),q.perGeometryDataInfo[H]=
F):++F.refCount,I(F.from*x<=q.buffer.getSize()&&F.to*x<=q.buffer.getSize()),J=K.create(),K.multiply(W,E.transformation,J),P=r.generateVisibleIndexRanges(E.instanceParameters.componentVisibilities,E.componentOffsets),J=new V(E.name,F.from,F.to,P,J,E.instanceParameters,E.idx,H),q.instances[E.uniqueName]=J,this._updateHighlightFaceranges(E,J),F=F.instanceBufferData)P=F.allocate(E.idx),F.fill(P,0,J.transformation),F.fill(P,16,J.transformationNormal),u&&F.fill(P,u.offset/4,E.instanceParameters.color),
m&&F.fill(P,m.offset/4,E.instanceParameters.featureAttribute);I(q.optimalCount===k.optimalCount);n=new Float32Array(q.buffer.getArray().buffer,0,q.buffer.getSize());q.vao.vertexBuffers.geometry.setData(n);for(H in q.perGeometryDataInfo)if(t=q.perGeometryDataInfo[H],t.vao&&(n=t.vao.vertexBuffers.instance))v=k.perGeometryDelta[H],0<v.addCount+v.removeCount&&(t=t.instanceBufferData.compact(),n.setData(t))}}}};c.prototype._compMat2delta=function(a,b,c){var d={};this._updateMat2delta(a,!0,c,d);this._updateMat2delta(b,
!1,c,d);return d};c.prototype._updateMat2delta=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e],g=f.origin,k=f.material,l=k.getId(),p=c?this._mat2dataInstanced[l]:this._mat2dataMerged[l],p=p&&p.origin2data[g.id],n=d[l];null==n&&(n={},d[l]=n);l=n[g.id];if(null==l){l={optimalCount:null==p?0:p.optimalCount,sparseCount:null==p?0:p.buffer.getSize(),material:k,toAdd:[],toRemove:[],perGeometryDelta:null,origin:g.vec3};if(c){var h={};if(void 0!==p)for(var q in p.perGeometryDataInfo)h[q]=p.perGeometryDataInfo[q].refCount;
l.dataId2refCount=h;l.perGeometryDelta={}}n[g.id]=l}g=k.getOutputAmount(N(f.data.faces.indices).length);c?(k=f.data.id,p=l.perGeometryDelta[k],p||(p={addCount:0,removeCount:0},l.perGeometryDelta[k]=p),b?(p.addCount++,null==l.dataId2refCount[k]&&(l.dataId2refCount[k]=0),1===++l.dataId2refCount[k]&&(l.optimalCount+=g,l.sparseCount+=g),l.toAdd.push(f)):(p.removeCount++,0===--l.dataId2refCount[k]&&(delete l.dataId2refCount[k],l.optimalCount-=g),l.toRemove.push(f))):b?(l.optimalCount+=g,l.sparseCount+=
g,l.toAdd.push(f)):(l.optimalCount-=g,l.toRemove.push(f))}};c.prototype._modifiedMergedFacerangesKey=function(a,b){return a+"_"+b};c.prototype._insertIntoRenderOrder=function(a,b,c){for(var d=a[p.MATERIAL].getMaterialId(),e=this._renderOrder.length,f=0;f<e&&this._renderOrder[f][0]>=b;){var g=this._renderOrder[f][1];if(g.id===d){I(!g[c],"matData for type already exists");g[c]=a;return}f++}d={id:d,instanced:null,merged:null};d[c]=a;this._renderOrder.splice(f,0,[b,d])};c.prototype._removeFromRenderOrder=
function(a,b){var c=a[p.MATERIAL].getMaterialId();for(a=0;this._renderOrder[a][1].id!==c;)a++;c=this._renderOrder[a][1];c[b]=null;c.instanced||c.merged||this._renderOrder.splice(a,1)};c.prototype._sortHighlightsByRenderOrder=function(){this._highlights.sort(function(a,b){a=a.matData[p.MATERIAL].getRenderPriority();b=b.matData[p.MATERIAL].getRenderPriority();return a>b?-1:b>a?1:0})};c.prototype._updateRenderOrder=function(a,b){for(var c=b.length,d=0;d<c&&b[d][1].id!==a;)d++;if(d<c){a=b[d][1];a=(a.merged||
a.instanced)[p.MATERIAL].getRenderPriority();var e=b[d][0];if(a!==b[d][0])for(b[d][0]=a,e=a>e?-1:1,d+=e;-1<d&&d<c&&e*b[d][0]>e*a;){var f=b[d];b[d]=b[d-e];b[d-e]=f;d+=e}}};c.prototype._modifyMaterials=function(a){for(var b in a)this._materialRep.updateMaterialParameters(b)};c.prototype.modifyRenderOrder=function(a){if(this._orderedRendering){for(var b in a)this._updateRenderOrder(b,this._renderOrder);this._sortHighlightsByRenderOrder();this._needsRender=!0}};c.prototype._releaseMaterials=function(a){if(Array.isArray(a))for(var b=
0;b<a.length;b++)this._materialRep.release(a[b]),this._materialRep.releaseDepthShadowMap(a[b]),this._materialRep.releaseNormal(a[b]),this._materialRep.releaseDepth(a[b]),this._materialRep.releaseHighlight(a[b]);else this._materialRep.release(a),this._materialRep.releaseDepthShadowMap(a),this._materialRep.releaseNormal(a),this._materialRep.releaseDepth(a),this._materialRep.releaseHighlight(a)};c.prototype._getInstance=function(a,b){var c=a.material.getId(),c=(b?this._mat2dataInstanced:this._mat2dataMerged)[c];
if(!c)return null;var d=c.origin2data[a.origin.id];if(!d)return null;var e=d.instances[a.uniqueName];return e?{uniqueName:a.uniqueName,instance:e,matData:c,originData:d,type:b?"instanced":"merged",instancedVAO:null,instancedVAOBaseInstance:null}:null};c.prototype._createBaseInstanceVAO=function(a){var b=this._rctx,c=a.instance;if("instanced"===a.type&&a.originData.perGeometryDataInfo){var d=a.originData.perGeometryDataInfo[c.dataId],e=d.instanceBufferData;e&&(d=d.vao,c=e.getSlot(c.idx),a.instancedVAOBaseInstance!==
c&&(e=A.setBaseInstanceOffset(d.layout,c),a.instancedVAO=new B(b,d.locations,e,d.vertexBuffers,d.indexBuffer),a.instancedVAOBaseInstance=c))}};c.prototype._updateHighlightVAOs=function(){for(var a=0;a<this._highlights.length;++a)this._createBaseInstanceVAO(this._highlights[a])};c.prototype._getFallbackDepthTexture=function(){this._fallbackDepthStencilTexture||(this._fallbackDepthStencilTexture=new z(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,
255,255,255])));return this._fallbackDepthStencilTexture};return c}();var T=function(){function a(){this.reset()}a.prototype.reset=function(){this.VBOusedSize=this.VBOoptimalSize=this.VBOallocatedSize=this.instancesDrawnAngle=this.drawCallsHighlight=this.drawCallsFragmented=this.drawCallsMerged=this.drawCallsAngleInstanced=this.drawCallsInstanced=this.trianglesRendered=0};return a}(),V=function(){return function(a,b,c,d,e,f,g,l){this.name=a;this.from=b;this.to=c;this.displayedIndexRange=d;this.transformation=
e;this.instanceParameters=f;this.idx=g;this.dataId=l;null!=e&&(this.transformationNormal=K.create(),K.set(e,this.transformationNormal),K.inverse(this.transformationNormal,this.transformationNormal),K.transpose(this.transformationNormal,this.transformationNormal))}}(),P=m.create(),W=K.identity(),U=K.create(),Y=K.create();return u})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require","exports"],function(m,h){return function(){function d(){}d.copyIntervals=function(c){for(var a=
[],b=0;b<c.length;b++){var d=c[b];a.push([d[0],d[1]])}return a};d.convertFaceToIndexRange=function(c,a){for(var b=0;b<c.length;b++){var d=c[b];d[0]*=a;d[1]=d[1]*a+(a-1)}};d.sortIntervals=function(c){return c.sort(function(a,b){return a[0]===b[0]?a[1]>b[1]?1:a[1]<b[1]?-1:0:a[0]>b[0]?1:a[0]<b[0]?-1:0})};d.intersectIntervals=function(c,a){if(0>=c.length)return[];for(var b=[],d=0;d<c.length;d++){var f=c[d];f[1]<a[0]||f[0]>a[1]||(f=[f[0],f[1]],f[0]<a[0]&&(f[0]=a[0]),f[1]>a[1]&&(f[1]=a[1]),b.push(f))}return b};
d.mergeIntervals=function(c){if(0>=c.length)return[];var a=[];c=this.sortIntervals(c);a.push(c[0]);for(var b=1;b<c.length;b++){var d=a[a.length-1];d[1]+1<c[b][0]?a.push(c[b]):d[1]<c[b][1]&&(d[1]=c[b][1],a.pop(),a.push(d))}return a};d.invertIntervals=function(c,a){for(var b=[],d=0,f=0;f<c.length;f++){var g=c[f];g[0]>d&&b.push([d,g[0]-1]);d=g[1]+1}d<=a&&b.push([d,a]);return b};d.offsetIntervals=function(c,a){for(var b=[],d=0;d<c.length;d++){var f=c[d];b.push([f[0]+a,f[1]+a])}return b};return d}()})},
"esri/views/3d/webgl-engine/lib/Float32ArrayList":function(){define(["require","exports","./Util"],function(m,h,d){return function(){function c(a){null==a?a=16:65536>a&&(a=d.nextHighestPowerOfTwo(a));this.array=new Float32Array(a);this.size=0}c.prototype.resize=function(a,b){void 0===b&&(b=!1);this.size=a;var c;if(this.size>this.array.length){for(a=this.array.length||1;a<this.size;)a*=2;c=new Float32Array(a);b&&c.set(this.array);this.array=c;return!0}if(this.size<=this.array.length/2){a=this.array.length;
for(c=2*this.size;a>=c;)a=Math.floor(a/2);c=new Float32Array(a);b&&c.set(this.array.subarray(0,a));this.array=c;return!0}return!1};c.prototype.append=function(a){var b=this.size;this.resize(this.size+a.length,!0);this.array.set(a,b)};c.prototype.erase=function(a,b){for(;a<b;++a)this.array[a]=0};c.prototype.getArray=function(){return this.array};c.prototype.getSize=function(){return this.size};return c}()})},"esri/views/3d/webgl-engine/lib/InstanceBufferData":function(){define(["require","exports",
"./Util"],function(m,h,d){return function(){function c(a,b){null==b&&(b=4);var c=d.nextHighestPowerOfTwo(b*a);this.array=new Float32Array(c);this.zeroItem=new Float32Array(a);this.endSlot=0;this.perInstanceDataSize=a;this.emptySlots=[];this.emptySlotsIdx=0;this.id2slot={};this.slot2id=Array(b)}c.prototype.prepareFree=function(a){this.emptySlots.length+=a};c.prototype.free=function(a){a=this.id2slot[a];null!=a&&(this.emptySlots[this.emptySlotsIdx++]=a,this.slot2id[a]=void 0)};c.prototype.prepareAllocate=
function(a){a-=this.emptySlotsIdx;0<a&&this._resizeArray((this.endSlot+a)*this.perInstanceDataSize)};c.prototype.allocate=function(a){var b;b=0<this.emptySlotsIdx?this.emptySlots[--this.emptySlotsIdx]:this.endSlot++;this.id2slot[a]=b;this.slot2id[b]=a;return b};c.prototype.getSlot=function(a){return this.id2slot[a]};c.prototype.getOffset=function(a){return a*this.perInstanceDataSize};c.prototype.getArray=function(){return this.array};c.prototype.fill=function(a,b,c){this.array.set(c,a*this.perInstanceDataSize+
b)};c.prototype.compact=function(){if(0<this.emptySlotsIdx){this.emptySlots.length=this.emptySlotsIdx;for(this.emptySlots.sort(function(a,b){return a-b});0<this.emptySlotsIdx&&this.emptySlots[this.emptySlotsIdx-1]===this.endSlot;)this.emptySlotsIdx--,this.endSlot--;for(;0<this.emptySlotsIdx;){this.emptySlotsIdx--;var a=this.endSlot-1,b=this.emptySlots[this.emptySlotsIdx],c=a*this.perInstanceDataSize,d=b*this.perInstanceDataSize;this.array.set(this.array.subarray(c,c+this.perInstanceDataSize),d);this.array.set(this.zeroItem,
c);c=this.slot2id[a];this.slot2id[a]=void 0;this.slot2id[b]=c;this.id2slot[c]=b;this.endSlot--}}this._resizeArray(this.endSlot*this.perInstanceDataSize);this.emptySlots.length=0;return this.array};c.prototype._resizeArray=function(a){var b;if(a>this.array.length){for(b=this.array.length||1;b<a;)b*=2;a=new Float32Array(b);a.set(this.array);this.array=a}else if(a<=this.array.length/2){b=this.array.length;for(a*=2;b>=a;)b/=2;a=new Float32Array(b);a.set(this.array.subarray(0,b));this.array=a}};return c}()})},
"esri/views/3d/webgl-engine/lighting/SceneLighting":function(){define(["require","exports","./SphericalHarmonics","../../lib/glMatrix"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});var a=c.vec3d,b=c.vec4d,k=a.create();m=function(){function c(){this._renderLighting={main:{intensity:a.create(),direction:a.createFrom(1,0,0),castShadows:!1},sphericalHarmonics:{sh:{r:[0],g:[0],b:[0]}}};this._shOrder=2;this._oldDirection=a.create();this._oldSpecular=b.create();this._oldDiffuse=b.create();
this._oldAmbient=b.create()}c.prototype.setUniforms=function(a,b){void 0===b&&(b=!1);b||a.getDefine("GROUND_NORMAL_SHADING")?a.setUniform1f("lightingFixedFactor",(1-this._info.groundLightingFactor)*(1-this._info.globalFactor)):a.setUniform1f("lightingFixedFactor",0);a.setUniform1f("lightingGlobalFactor",this._info.globalFactor);a.setUniform3fv("lightingMainDirection",this._renderLighting.main.direction);a.setUniform3fv("lightingMainIntensity",this._renderLighting.main.intensity);a.setUniform1f("ambientBoostFactor",
.4);b=this._renderLighting.sphericalHarmonics.sh;0===this._shOrder?a.setUniform3f("lightingAmbientSH0",b.r[0],b.g[0],b.b[0]):1===this._shOrder?(a.setUniform4f("lightingAmbientSH_R",b.r[0],b.r[1],b.r[2],b.r[3]),a.setUniform4f("lightingAmbientSH_G",b.g[0],b.g[1],b.g[2],b.g[3]),a.setUniform4f("lightingAmbientSH_B",b.b[0],b.b[1],b.b[2],b.b[3])):2===this._shOrder&&(a.setUniform3f("lightingAmbientSH0",b.r[0],b.g[0],b.b[0]),a.setUniform4f("lightingAmbientSH_R1",b.r[1],b.r[2],b.r[3],b.r[4]),a.setUniform4f("lightingAmbientSH_G1",
b.g[1],b.g[2],b.g[3],b.g[4]),a.setUniform4f("lightingAmbientSH_B1",b.b[1],b.b[2],b.b[3],b.b[4]),a.setUniform4f("lightingAmbientSH_R2",b.r[5],b.r[6],b.r[7],b.r[8]),a.setUniform4f("lightingAmbientSH_G2",b.g[5],b.g[6],b.g[7],b.g[8]),a.setUniform4f("lightingAmbientSH_B2",b.b[5],b.b[6],b.b[7],b.b[8]));a.setUniform3fv("lightDirection",this._oldDirection)};c.prototype.set=function(b){this._info=b;d.combineLights(b.lights,this._shOrder,this._renderLighting.main,this._renderLighting.sphericalHarmonics);a.negate(this._renderLighting.main.direction,
this._oldDirection);b=1/Math.PI;this._oldAmbient[0]=.282095*this._renderLighting.sphericalHarmonics.sh.r[0]*b;this._oldAmbient[1]=.282095*this._renderLighting.sphericalHarmonics.sh.g[0]*b;this._oldAmbient[2]=.282095*this._renderLighting.sphericalHarmonics.sh.b[0]*b;this._oldAmbient[3]=1;this._oldDiffuse[0]=this._renderLighting.main.intensity[0]*b;this._oldDiffuse[1]=this._renderLighting.main.intensity[1]*b;this._oldDiffuse[2]=this._renderLighting.main.intensity[2]*b;this._oldDiffuse[3]=1;b=a.set(this._oldDiffuse,
k);a.scale(b,.4*this._info.globalFactor);a.add(this._oldAmbient,b)};Object.defineProperty(c.prototype,"globalFactor",{get:function(){return this._info.globalFactor},enumerable:!0,configurable:!0});c.prototype.getOld=function(){return{ambient:this._oldAmbient,diffuse:this._oldDiffuse,specular:this._oldSpecular,direction:this._oldDirection,helper:this}};return c}();h.SceneLighting=m})},"esri/views/3d/webgl-engine/lighting/SphericalHarmonics":function(){define("require exports ./Lightsources ../lib/LongVectorMath ../../lib/glMatrix ../../support/mathUtils".split(" "),
function(m,h,d,c,a,b){function k(a){return(a+1)*(a+1)}function f(a){return b.clamp(Math.floor(Math.sqrt(a)-1),0,2)}function g(a,b,c){var d=a[0],e=a[1];a=a[2];c=c||[];c.length=k(b);0<=b&&(c[0]=.28209479177);1<=b&&(c[1]=.4886025119*d,c[2]=.4886025119*a,c[3]=.4886025119*e);2<=b&&(c[4]=1.09254843059*d*e,c[5]=1.09254843059*e*a,c[6]=.31539156525*(3*a*a-1),c[7]=1.09254843059*d*a,c[8]=.54627421529*(d*d-e*e));return c}function e(a,b){a=k(a);b=b||{r:[],g:[],b:[]};b.r.length=b.g.length=b.b.length=a;for(var c=
0;c<a;c++)b.r[c]=b.g[c]=b.b[c]=0;return b}function l(a,b){for(var d=f(b.r.length),e=0;e<a.length;e++){var l=a[e];v.negate(l.direction,r);g(r,d,u);c.elementwiseProduct(u,z);c.scalarProduct(u,l.intensity[0],x);c.add(b.r,x);c.scalarProduct(u,l.intensity[1],x);c.add(b.g,x);c.scalarProduct(u,l.intensity[2],x);c.add(b.b,x)}return b}function p(a,b){g(r,0,u);for(var c=0;c<a.length;c++){var d=a[c];b.r[0]+=u[0]*z[0]*d.intensity[0]*4*Math.PI;b.g[0]+=u[0]*z[0]*d.intensity[1]*4*Math.PI;b.b[0]+=u[0]*z[0]*d.intensity[2]*
4*Math.PI}return b}Object.defineProperty(h,"__esModule",{value:!0});var v=a.vec3d;h.numberOfCoefficients=k;h.numberOfCoefficientsInBand=function(a){return 2*a+1};h.orderFromNumberOfCoefficients=f;h.computeCoefficients=g;h.initSHCoefficients=e;h.projectFillLights=l;h.projectAmbientLights=p;h.combineLights=function(a,b,f,g){e(b,g.sh);v.set3(0,0,0,f.intensity);var k=!1,h=q,r=n;b=t;h.length=0;r.length=0;for(var u=b.length=0;u<a.length;u++){var m=a[u];m instanceof d.MainLight&&!k?(v.set(m.direction,f.direction),
f.intensity[0]=m.intensity[0],f.intensity[1]=m.intensity[1],f.intensity[2]=m.intensity[2],f.castShadows=m.castShadows,k=!0):m instanceof d.MainLight||m instanceof d.FillLight?h.push(m):m instanceof d.AmbientLight?r.push(m):m instanceof d.SphericalHarmonicsLight&&b.push(m)}l(h,g.sh);p(r,g.sh);for(a=0;a<b.length;a++)m=b[a],c.add(g.sh.r,m.sh.r),c.add(g.sh.g,m.sh.g),c.add(g.sh.b,m.sh.b)};var q=[],n=[],t=[],u=[0],x=[0],r=v.create(),z=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,
.785398]})},"esri/views/3d/webgl-engine/lib/LongVectorMath":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.dotProduct=function(d,c){for(var a=0,b=0;b<d.length;b++)a+=d[b]*c[b];return a};h.elementwiseProduct=function(d,c,a){a=a||d;a.length=d.length;for(var b=0;b<d.length;b++)a[b]=d[b]*c[b];return a};h.scalarProduct=function(d,c,a){a=a||d;a.length=d.length;for(var b=0;b<d.length;b++)a[b]=d[b]*c;return a};h.add=function(d,c,a){a=a||d;a.length=
d.length;for(var b=0;b<d.length;b++)a[b]=d[b]+c[b];return a}})},"esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial":function(){define("require exports dojo/text!./SimpleGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),function(m,h,d,c,a,b,k,f){return function(){function g(a,b,d,f){void 0===f&&(f=4);this.id=c.__GLMaterial_id++;this.program=a.get("simple");this.color=b;this.depthFunc=
d;this.drawMode=f}g.prototype.getId=function(){return this.id};g.prototype.beginSlot=function(b){return b===a.INTERNAL_MATERIAL};g.prototype.getProgram=function(){return this.program};g.prototype.bind=function(a,b){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",c.IDENTITY);this.program.setUniformMatrix4fv("proj",b.proj);this.program.setUniform4fv("color",this.color);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);
a.setDepthTestEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)};g.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);a.setBlendingEnabled(!1)};g.prototype.bindView=function(a,b){c.bindView(b.origin,b.view,this.program)};g.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)};g.prototype.getDrawMode=function(a){return this.drawMode};g.loadShaders=function(a,c,g,k){a._parse(d);a=new b(k,a.vertexShaderSimple,
a.fragmentShaderSimple,f.Default3D);g.add("simple",a)};return g}()})},"esri/views/3d/webgl-engine/lib/LinearDepthTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(m,h,d,c,a){return function(){function a(a){this._rctx=a;this._depthFBO=void 0;this.height=this.width=this.viewportToRestore=null}a.prototype.setEnableState=function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};a.prototype.getEnableState=function(){return void 0!==
this._depthFBO};a.prototype.getDepthFBO=function(){return this._depthFBO};a.prototype.enable=function(){d.assert(!this.getEnableState());this._depthFBO=c.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};a.prototype.disable=function(){d.assert(this.getEnableState());this._depthFBO.dispose();this._depthFBO=void 0};a.prototype.setupFBOs=function(a){d.assert(this.getEnableState());this.viewportToRestore=
a=a.fullViewport;this.width=a[2];this.height=a[3];this._rctx.setViewport(0,0,this.width,this.height)};a.prototype.prepareDepthPass=function(){d.assert(this.getEnableState());var a=this._rctx,b=a.gl;this._depthFBO.resize(this.width,this.height);a.bindFramebuffer(this._depthFBO);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};a.prototype.finish=function(a){var b=this._rctx;b.bindFramebuffer(a);b.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],
this.viewportToRestore[3])};return a}()})},"esri/views/3d/webgl-engine/lib/NormalTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(m,h,d,c,a){return function(){function a(a){this.rctx=a;this.normalFBO=void 0;this.height=this.width=this.viewportToRestore=null}a.prototype.setEnableState=function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};a.prototype.getEnableState=function(){return void 0!==this.normalFBO};
a.prototype.getNormalFBO=function(){return this.normalFBO};a.prototype.enable=function(){d.assert(!this.getEnableState());this.normalFBO=c.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};a.prototype.disable=function(){d.assert(this.getEnableState());this.normalFBO.dispose();this.normalFBO=void 0};a.prototype.setupFBOs=function(a){d.assert(this.getEnableState());this.viewportToRestore=
a=a.viewport;this.width=a[2];this.height=a[3];this.rctx.setViewport(0,0,this.width,this.height)};a.prototype.prepareNormalPass=function(){d.assert(this.getEnableState());var a=this.rctx,b=a.gl;this.normalFBO.resize(this.width,this.height);a.bindFramebuffer(this.normalFBO);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};a.prototype.finish=function(a){var b=this.rctx;b.bindFramebuffer(a);b.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],
this.viewportToRestore[3])};return a}()})},"esri/views/3d/webgl-engine/lib/HighlightTextureHelper":function(){define(["require","exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(m,h,d,c,a){return function(){function a(a){this._rctx=a;this.height=this.width=this.viewportToRestore=this.fbo2=this.fbo=null}a.prototype.setEnableState=function(a){a!==this.getEnableState()&&(a?this.enable():this.disable())};a.prototype.getEnableState=function(){return null!==this.fbo};
a.prototype.getHighlightFBO=function(){return this.fbo};a.prototype.getBlurFBO=function(){return this.fbo2};a.prototype.enable=function(){d.assert(!this.getEnableState());this.fbo=c.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:32819,samplingMode:9729,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})};a.prototype.disable=function(){d.assert(this.getEnableState());this.fbo.dispose();this.fbo=null};a.prototype.setupFBOs=function(a){d.assert(this.getEnableState());
this.viewportToRestore=a=a.fullViewport;this.width=a[2];this.height=a[3];this._rctx.setViewport(0,0,this.width,this.height)};a.prototype.prepareHighlightPass=function(){d.assert(this.getEnableState());var a=this._rctx,b=a.gl;this.fbo.resize(this.width,this.height);a.bindFramebuffer(this.fbo);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};a.prototype.finish=function(a){var b=this._rctx;b.bindFramebuffer(a);b.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],
this.viewportToRestore[2],this.viewportToRestore[3])};return a}()})},"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports","./RenderSlot","./RenderPass"],function(m,h,d,c){return function(){function a(){this.normals=this.lightingData=this.highlight=this.depth=this.camera=null;this.pass=c.MATERIAL;this.shadowMap=null;this.slot=d.BACKGROUND;this.options=this.rctx=this.framebufferTex=this.stencilRenderingHelper=this.offscreenRenderingHelper=this.ssaoHelper=null}Object.defineProperty(a.prototype,
"isHighlightPass",{get:function(){return this.pass===c.MATERIAL_HIGHLIGHT},enumerable:!0,configurable:!0});return a}()})},"esri/views/3d/webgl-engine/lib/ExternalRendererContainer":function(){define(["require","exports","./RenderSlot"],function(m,h,d){return function(){function c(){this.renderersChanged=!1;this.renderers=[];this.slots=[];for(var a=0;a<d.MAX_SLOTS;++a)this.slots[a]=[]}c.prototype.addRenderer=function(a,b){this.renderers.push(b);for(var c=0;c<a.length;++c)this.slots[a[c]].push(b);this.renderersChanged=
!0};c.prototype.removeRenderer=function(a){this.renderers=this.renderers.filter(function(b){return b!==a});for(var b=0;b<this.slots.length;++b)this.slots[b]=this.slots[b].filter(function(b){return b!==a});this.renderersChanged=!0};c.prototype.render=function(a,b){b.slot=a;var c=0;for(a=this.slots[a];c<a.length;c++){var d=a[c];d.render(b)&&(d.didRender=!0)}};c.prototype.needsRender=function(){if(this.renderersChanged)return!0;for(var a=0,b=this.renderers;a<b.length;a++)if(b[a].needsRender)return!0;
return!1};c.prototype.needsHighlight=function(){for(var a=0,b=this.renderers;a<b.length;a++)if(b[a].needsHighlight)return!0;return!1};c.prototype.resetNeedsRender=function(){this.renderersChanged=!1;for(var a=0,b=this.renderers;a<b.length;a++){var c=b[a];c.resetNeedsRender?c.resetNeedsRender():c.didRender&&(c.needsRender=!1,c.didRender=!1)}};return c}()})},"esri/views/3d/webgl-engine/lib/StencilRenderingHelper":function(){define(["require","exports","./Util","../../../webgl/enums"],function(m,h,d,
c){return function(){function a(a){this._enabled=!1;this._rctx=a}a.prototype.enable=function(){this._enabled=!0;this._rctx.setStencilTestEnabled(!0)};a.prototype.disable=function(){this._enabled=!1;this._rctx.setStencilTestEnabled(!1)};a.prototype.getIsSupported=function(){return!!this._rctx.contextAttributes.stencil};a.prototype.setEnableState=function(a){a?this.enable():this.disable()};a.prototype.getEnableState=function(){return this._enabled};a.prototype.prepareStencilWritePass=function(){d.assert(this.getEnableState());
var a=this._rctx;a.setClearStencil(0);a.setStencilFunction(519,1,255);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255)};a.prototype.finish=function(){if(this.getEnableState()){var a=this._rctx;a.setStencilFunction(519,0,0);a.setStencilOp(7680,7680,7680);a.setStencilWriteMask(0)}};a.prototype.enableStencilRead=function(){this.getEnableState()&&this._rctx.setStencilFunction(517,1,255)};a.prototype.disableStencilRead=function(){this.getEnableState()&&this._rctx.setStencilFunction(519,0,0)};
return a}()})},"esri/views/3d/webgl-engine/lib/FxaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums".split(" "),function(m,h,d,c,a,b){return function(){function b(a){this.isEnabled=!1;this.vertexAttributeLocations={position:0};this.vertexBufferLayout=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}b.prototype.enable=function(){if(!this.isEnabled){var b=this.rctx;
this.program=new d(b,"\n      #version 100\n      precision highp float;\n\n      attribute vec2 position;\n\n      varying   vec2 fCoordinate;\n\n      void main() {\n        fCoordinate \x3d (position + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(position, -1, 1);\n      }","\n      #version 100\n      #ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      #else\n      precision mediump float;\n      #endif\n\n      /**\n       * @license\n       * Copyright (c) 2011 NVIDIA Corporation. All rights reserved.\n       *\n       * TO  THE MAXIMUM  EXTENT PERMITTED  BY APPLICABLE  LAW, THIS SOFTWARE  IS PROVIDED\n       * *AS IS*  AND NVIDIA AND  ITS SUPPLIERS DISCLAIM  ALL WARRANTIES,  EITHER  EXPRESS\n       * OR IMPLIED, INCLUDING, BUT NOT LIMITED  TO, NONINFRINGEMENT,IMPLIED WARRANTIES OF\n       * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO EVENT SHALL  NVIDIA\n       * OR ITS SUPPLIERS BE  LIABLE  FOR  ANY  DIRECT, SPECIAL,  INCIDENTAL,  INDIRECT,  OR\n       * CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION,  DAMAGES FOR LOSS\n       * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY\n       * OTHER PECUNIARY LOSS) ARISING OUT OF THE  USE OF OR INABILITY  TO USE THIS SOFTWARE,\n       * EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\n       */\n\n      #define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n      #define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n      #define FXAA_SEARCH_STEPS        16\n      #define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n      #define FXAA_SUBPIX_CAP          (3.0/4.0)\n      #define FXAA_SUBPIX_TRIM         (1.0/4.0)\n      #define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n\n      uniform vec2 uRcpFrameDimension;\n      uniform sampler2D uColorTexture;\n      varying vec2 fCoordinate;\n\n      // Return the luma, the estimation of luminance from rgb inputs.\n      // This approximates luma using one FMA instruction,\n      // skipping normalization and tossing out blue.\n      // FxaaLuma() will range 0.0 to 2.963210702.\n      float FxaaLuma(vec3 rgb) {\n        return rgb.y * (0.587 / 0.299) + rgb.x;\n      }\n      vec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\n        return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n      }\n      vec4 FxaaTexOff(sampler2D tex, vec2 pos, ivec2 off, vec2 rcpFrame) {\n        float x \x3d pos.x + float(off.x) * rcpFrame.x;\n        float y \x3d pos.y + float(off.y) * rcpFrame.y;\n        return texture2D(tex, vec2(x, y));\n      }\n\n      // pos is the output of FxaaVertexShader interpolated across screen.\n      // xy -\x3e actual texture position {0.0 to 1.0}\n      // rcpFrame should be a uniform equal to  {1.0/frameWidth, 1.0/frameHeight}\n      vec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\n        vec3 rgbN \x3d FxaaTexOff(tex, pos.xy, ivec2( 0,-1), rcpFrame).xyz;\n        vec3 rgbW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 0), rcpFrame).xyz;\n        vec3 rgbM \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 0), rcpFrame).xyz;\n        vec3 rgbE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 0), rcpFrame).xyz;\n        vec3 rgbS \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 1), rcpFrame).xyz;\n        float lumaN \x3d FxaaLuma(rgbN);\n        float lumaW \x3d FxaaLuma(rgbW);\n        float lumaM \x3d FxaaLuma(rgbM);\n        float lumaE \x3d FxaaLuma(rgbE);\n        float lumaS \x3d FxaaLuma(rgbS);\n        float rangeMin \x3d min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\n        float rangeMax \x3d max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\n        float range \x3d rangeMax - rangeMin;\n        if (range \x3c max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\n          return rgbM;\n        }\n        vec3 rgbL \x3d rgbN + rgbW + rgbM + rgbE + rgbS;\n        float lumaL \x3d (lumaN + lumaW + lumaE + lumaS) * 0.25;\n        float rangeL \x3d abs(lumaL - lumaM);\n        float blendL \x3d max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\n        blendL \x3d min(FXAA_SUBPIX_CAP, blendL);\n        vec3 rgbNW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1,-1), rcpFrame).xyz;\n        vec3 rgbNE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1,-1), rcpFrame).xyz;\n        vec3 rgbSW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 1), rcpFrame).xyz;\n        vec3 rgbSE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 1), rcpFrame).xyz;\n        rgbL +\x3d (rgbNW + rgbNE + rgbSW + rgbSE);\n        rgbL *\x3d vec3(1.0/9.0);\n        float lumaNW \x3d FxaaLuma(rgbNW);\n        float lumaNE \x3d FxaaLuma(rgbNE);\n        float lumaSW \x3d FxaaLuma(rgbSW);\n        float lumaSE \x3d FxaaLuma(rgbSE);\n        float edgeVert \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\n          abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\n          abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\n        float edgeHorz \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\n          abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\n          abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\n        bool horzSpan \x3d edgeHorz \x3e\x3d edgeVert;\n        float lengthSign \x3d horzSpan ? -rcpFrame.y : -rcpFrame.x;\n        if(!horzSpan) {\n          lumaN \x3d lumaW;\n          lumaS \x3d lumaE;\n        }\n        float gradientN \x3d abs(lumaN - lumaM);\n        float gradientS \x3d abs(lumaS - lumaM);\n        lumaN \x3d (lumaN + lumaM) * 0.5;\n        lumaS \x3d (lumaS + lumaM) * 0.5;\n        if (gradientN \x3c gradientS)\n        {\n          lumaN \x3d lumaS;\n          lumaN \x3d lumaS;\n          gradientN \x3d gradientS;\n          lengthSign *\x3d -1.0;\n        }\n        vec2 posN;\n        posN.x \x3d pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\n        posN.y \x3d pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\n        gradientN *\x3d FXAA_SEARCH_THRESHOLD;\n        vec2 posP \x3d posN;\n        vec2 offNP \x3d horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\n        float lumaEndN \x3d lumaN;\n        float lumaEndP \x3d lumaN;\n        bool doneN \x3d false;\n        bool doneP \x3d false;\n        posN +\x3d offNP * vec2(-1.0, -1.0);\n        posP +\x3d offNP * vec2( 1.0,  1.0);\n        for(int i \x3d 0; i \x3c FXAA_SEARCH_STEPS; i++) {\n          if(!doneN) {\n            lumaEndN \x3d FxaaLuma(texture2D(tex, posN.xy).xyz);\n          }\n          if(!doneP) {\n            lumaEndP \x3d FxaaLuma(texture2D(tex, posP.xy).xyz);\n          }\n          doneN \x3d doneN || (abs(lumaEndN - lumaN) \x3e\x3d gradientN);\n          doneP \x3d doneP || (abs(lumaEndP - lumaN) \x3e\x3d gradientN);\n          if(doneN \x26\x26 doneP) { break; }\n          if(!doneN) {\n            posN -\x3d offNP;\n          }\n          if(!doneP) {\n            posP +\x3d offNP;\n          }\n        }\n        float dstN \x3d horzSpan ? pos.x - posN.x : pos.y - posN.y;\n        float dstP \x3d horzSpan ? posP.x - pos.x : posP.y - pos.y;\n        bool directionN \x3d dstN \x3c dstP;\n        lumaEndN \x3d directionN ? lumaEndN : lumaEndP;\n        if(((lumaM - lumaN) \x3c 0.0) \x3d\x3d ((lumaEndN - lumaN) \x3c 0.0)) {\n          lengthSign \x3d 0.0;\n        }\n        float spanLength \x3d (dstP + dstN);\n        dstN \x3d directionN ? dstN : dstP;\n        float subPixelOffset \x3d (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\n        vec3 rgbF \x3d texture2D(tex, vec2(\n          pos.x + (horzSpan ? 0.0 : subPixelOffset),\n          pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\n        return FxaaLerp3(rgbL, rgbF, blendL);\n      }\n\n      void main() {\n        vec4 color;\n        vec2 screenCoord \x3d fCoordinate;\n        // if (screenCoord.x \x3c 0.5) {\n          color.rgb \x3d FxaaPixelShader(screenCoord, uColorTexture, uRcpFrameDimension);\n        // } else if (screenCoord.x \x3c 0.501 \x26\x26 screenCoord.x \x3e 0.499) {\n        //   color.rgb \x3d vec3(1,0,0);\n        // } else {\n        //   color \x3d texture2D(uColorTexture, fCoordinate);\n        // }\n        color.a \x3d 1.0;\n        gl_FragColor \x3d color;\n      }",
this.vertexAttributeLocations);var g=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new c(b,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new a(b,34962,35044,g)});this.isEnabled=!0}};b.prototype.disable=function(){this.isEnabled&&(this.program.dispose(),this.program=null,this.vao.dispose(),this.vao=null,this.isEnabled=!1)};b.prototype.render=function(a,b){this.enable();var c=this.rctx;c.bindVAO(this.vao);c.bindFramebuffer(b);var d=0,f=0;null!=b?(d=b.descriptor.width,f=b.descriptor.height):
(d=c.gl.canvas.width,f=c.gl.canvas.height);c.bindProgram(this.program);c.bindTexture(a.colorTexture,0);this.program.setUniform1i("uColorTexture",0);this.program.setUniform2f("uRcpFrameDimension",1/d,1/f);c.setFaceCullingEnabled(!1);c.drawArrays(4,0,3)};return b}()})},"esri/views/3d/webgl-engine/lib/SmaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/FramebufferObject ../../support/imageUtils ../../../webgl/enums".split(" "),
function(m,h,d,c,a,b,k,f,g){return function(){function e(a){this.isEnabled=!1;this.vertexAttributeLocations={vPosition:0};this.vertexBufferLayout=[{name:"vPosition",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}e.prototype.enable=function(){if(!this.isEnabled){var b=this.rctx;this.programEdgeDetect=new d(b,"\n      #define SHADER_NAME SMAA::EdgeDetect\n      precision highp float;\n      precision highp int;\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n\n      void SMAAEdgeDetectionVS( vec2 texcoord ) {\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n        fOffset[2] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n        SMAAEdgeDetectionVS( fTexCoord );\n      }",
"\n      #define SHADER_NAME SMAA::EdgeDetect\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_THRESHOLD 0.05\n      #define SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR 2\n      #define SMAA_USE_COLOR_EDGE_DETECTION 0\n\n      uniform sampler2D tColor;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n\n      vec4 SMAALumaEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        // Calculate the threshold:\n        vec2 threshold \x3d vec2(SMAA_THRESHOLD, SMAA_THRESHOLD);\n\n        // Calculate lumas:\n        vec3 weights \x3d vec3(0.2126, 0.7152, 0.0722);\n        float L \x3d dot(texture2D(colorTex, texcoord).rgb, weights);\n\n        float Lleft \x3d dot(texture2D(colorTex, offset[0].xy).rgb, weights);\n        float Ltop  \x3d dot(texture2D(colorTex, offset[0].zw).rgb, weights);\n\n        // We do the usual threshold:\n        vec4 delta;\n        delta.xy \x3d abs(L - vec2(Lleft, Ltop));\n        vec2 edges \x3d step(threshold, delta.xy);\n\n        // Then discard if there is no edge:\n        if (dot(edges, vec2(1.0, 1.0)) \x3d\x3d 0.0) discard;\n\n        // Calculate right and bottom deltas:\n        float Lright \x3d dot(texture2D(colorTex, offset[1].xy).rgb, weights);\n        float Lbottom  \x3d dot(texture2D(colorTex, offset[1].zw).rgb, weights);\n        delta.zw \x3d abs(L - vec2(Lright, Lbottom));\n\n        // Calculate the maximum delta in the direct neighborhood:\n        vec2 maxDelta \x3d max(delta.xy, delta.zw);\n\n        // Calculate left-left and top-top deltas:\n        float Lleftleft \x3d dot(texture2D(colorTex, offset[2].xy).rgb, weights);\n        float Ltoptop \x3d dot(texture2D(colorTex, offset[2].zw).rgb, weights);\n        delta.zw \x3d abs(vec2(Lleft, Ltop) - vec2(Lleftleft, Ltoptop));\n\n        // Calculate the final maximum delta:\n        maxDelta \x3d max(maxDelta.xy, delta.zw);\n        float finalDelta \x3d max(maxDelta.x, maxDelta.y);\n\n        // Local contrast adaptation:\n        edges.xy *\x3d step(finalDelta, float(SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR) * delta.xy);\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n        vec2 threshold \x3d vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n        // Calculate color deltas:\n        vec4 delta;\n        vec3 C \x3d texture2D( colorTex, texcoord ).rgb;\n\n        vec3 Cleft \x3d texture2D( colorTex, offset[0].xy ).rgb;\n        vec3 t \x3d abs( C - Cleft );\n        delta.x \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Ctop \x3d texture2D( colorTex, offset[0].zw ).rgb;\n        t \x3d abs( C - Ctop );\n        delta.y \x3d max( max( t.r, t.g ), t.b );\n\n        // We do the usual threshold:\n        vec2 edges \x3d step( threshold, delta.xy );\n\n        // Then discard if there is no edge:\n        if ( dot( edges, vec2( 1.0, 1.0 ) ) \x3d\x3d 0.0 )\n            discard;\n\n        // Calculate right and bottom deltas:\n        vec3 Cright \x3d texture2D( colorTex, offset[1].xy ).rgb;\n        t \x3d abs( C - Cright );\n        delta.z \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Cbottom  \x3d texture2D( colorTex, offset[1].zw ).rgb;\n        t \x3d abs( C - Cbottom );\n        delta.w \x3d max( max( t.r, t.g ), t.b );\n\n        // Calculate the maximum delta in the direct neighborhood:\n        float maxDelta \x3d max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n        // Calculate left-left and top-top deltas:\n        vec3 Cleftleft  \x3d texture2D( colorTex, offset[2].xy ).rgb;\n        t \x3d abs( C - Cleftleft );\n        delta.z \x3d max( max( t.r, t.g ), t.b );\n\n        vec3 Ctoptop \x3d texture2D( colorTex, offset[2].zw ).rgb;\n        t \x3d abs( C - Ctoptop );\n        delta.w \x3d max( max( t.r, t.g ), t.b );\n\n        // Calculate the final maximum delta:\n        maxDelta \x3d max( max( maxDelta, delta.z ), delta.w );\n\n        // Local contrast adaptation in action:\n        edges.xy *\x3d step( maxDelta, float(SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR) * delta.xy );\n\n        return vec4( edges, 0.0, 0.0 );\n      }\n\n      void main() {\n        #if SMAA_USE_COLOR_EDGE_DETECTION\n          gl_FragColor \x3d SMAAColorEdgeDetectionPS( fTexCoord, fOffset, tColor );\n        #else\n          gl_FragColor \x3d SMAALumaEdgeDetectionPS( fTexCoord, fOffset, tColor );\n        #endif\n      }",
this.vertexAttributeLocations);this.programBlendWeights=new d(b,"\n      #define SHADER_NAME SMAA::BlendWeights\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_MAX_SEARCH_STEPS 8\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n      varying vec2 fPixCoord;\n\n      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n        fPixCoord \x3d texcoord * uResolution.zw;\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );\n        fOffset[2] \x3d vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * uResolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n        SMAABlendingWeightCalculationVS( fTexCoord );\n      }",
"\n      #define SHADER_NAME SMAA::BlendWeights\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_MAX_SEARCH_STEPS 8\n      #define SMAA_AREATEX_MAX_DISTANCE 16\n      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )\n      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )\n\n      #define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * uResolution.xy, 0.0 )\n\n      uniform sampler2D tEdges;\n      uniform sampler2D tArea;\n      uniform sampler2D tSearch;\n      uniform vec4 uResolution;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[3];\n      varying vec2 fPixCoord;\n\n      vec2 round( vec2 x ) {\n        return sign( x ) * floor( abs( x ) + 0.5 );\n      }\n\n      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n        e.r \x3d bias + e.r * scale;\n        return 255.0 * texture2D( searchTex, e, 0.0 ).r;\n      }\n\n      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 0.0, 1.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -\x3d vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x \x3e end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.x +\x3d 0.25 * uResolution.x;\n        texcoord.x +\x3d uResolution.x;\n        texcoord.x +\x3d 2.0 * uResolution.x;\n        texcoord.x -\x3d uResolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n        return texcoord.x;\n      }\n\n      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 0.0, 1.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord +\x3d vec2( 2.0, 0.0 ) * uResolution.xy;\n          if ( ! ( texcoord.x \x3c end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.x -\x3d 0.25 * uResolution.x;\n        texcoord.x -\x3d uResolution.x;\n        texcoord.x -\x3d 2.0 * uResolution.x;\n        texcoord.x +\x3d uResolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n        return texcoord.x;\n      }\n\n      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 1.0, 0.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord +\x3d vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y \x3e end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.y -\x3d 0.25 * uResolution.y;\n        texcoord.y -\x3d uResolution.y;\n        texcoord.y -\x3d 2.0 * uResolution.y;\n        texcoord.y +\x3d uResolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );\n        return texcoord.y;\n      }\n\n      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n        vec2 e \x3d vec2( 1.0, 0.0 );\n        for ( int i \x3d 0; i \x3c SMAA_MAX_SEARCH_STEPS; i ++ ) {\n          e \x3d texture2D( edgesTex, texcoord, 0.0 ).rg;\n          texcoord -\x3d vec2( 0.0, 2.0 ) * uResolution.xy;\n          if ( ! ( texcoord.y \x3c end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0 ) ) break;\n        }\n        texcoord.y +\x3d 0.25 * uResolution.y;\n        texcoord.y +\x3d uResolution.y;\n        texcoord.y +\x3d 2.0 * uResolution.y;\n        texcoord.y -\x3d uResolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );\n        return texcoord.y;\n      }\n\n      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n        vec2 texcoord \x3d float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n        texcoord \x3d SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n        texcoord.y +\x3d SMAA_AREATEX_SUBTEX_SIZE * offset;\n        return texture2D( areaTex, texcoord, 0.0 ).rg;\n      }\n\n      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n        vec4 weights \x3d vec4( 0.0, 0.0, 0.0, 0.0 );\n        vec2 e \x3d texture2D( edgesTex, texcoord ).rg;\n        if ( e.g \x3e 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.x \x3d SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n          coords.y \x3d offset[ 1 ].y;\n          d.x \x3d coords.x;\n          float e1 \x3d texture2D( edgesTex, coords, 0.0 ).r;\n          coords.x \x3d SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n          d.y \x3d coords.x;\n          d \x3d d * uResolution.z - pixcoord.x;\n          vec2 sqrt_d \x3d sqrt( abs( d ) );\n          coords.y -\x3d 1.0 * uResolution.y;\n          float e2 \x3d SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n          weights.rg \x3d SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n        }\n        if ( e.r \x3e 0.0 ) {\n          vec2 d;\n          vec2 coords;\n          coords.y \x3d SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n          coords.x \x3d offset[ 0 ].x;\n          d.x \x3d coords.y;\n          float e1 \x3d texture2D( edgesTex, coords, 0.0 ).g;\n          coords.y \x3d SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n          d.y \x3d coords.y;\n          d \x3d d * uResolution.w - pixcoord.y;\n          vec2 sqrt_d \x3d sqrt( abs( d ) );\n          coords.y -\x3d 1.0 * uResolution.y;\n          float e2 \x3d SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n          weights.ba \x3d SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\n          // for some reason the following lines are necessary to prevent\n          // texture lookup precision issues on some Intel integrated graphics chips\n          vec4 dbg \x3d (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);\n          weights.r +\x3d 0.00000001 * dot(vec4(0,1,0,1),dbg);\n        }\n        return weights;\n      }\n\n      void main() {\n        gl_FragColor \x3d SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );\n      }",
this.vertexAttributeLocations);this.programBlur=new d(b,"\n      #define SHADER_NAME SMAA::NeighborhoodBlending\n      precision highp float;\n      precision highp int;\n\n      uniform vec4 uResolution;\n      attribute vec2 vPosition;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[2];\n\n      void SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n        fOffset[0] \x3d texcoord.xyxy + uResolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );\n        fOffset[1] \x3d texcoord.xyxy + uResolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );\n      }\n\n      void main() {\n        fTexCoord \x3d (vPosition + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(vPosition, 0, 1);\n\n        SMAANeighborhoodBlendingVS(fTexCoord);\n      }",
"\n      #define SHADER_NAME SMAA::NeighborhoodBlending\n      precision highp float;\n      precision highp int;\n\n      #define SMAA_DEBUG_SPLIT_VIEW 0\n\n      uniform sampler2D tBlendWeights;\n      uniform sampler2D tColor;\n      uniform vec4 uResolution;\n\n      varying vec2 fTexCoord;\n      varying vec4 fOffset[2];\n\n      vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n        vec4 a;\n        a.xz \x3d texture2D( blendTex, texcoord ).xz;\n        a.y \x3d texture2D( blendTex, offset[ 1 ].zw ).g;\n        a.w \x3d texture2D( blendTex, offset[ 1 ].xy ).a;\n\n        if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) \x3c 1e-5 ) {\n          return texture2D( colorTex, texcoord, 0.0 );\n        } else {\n          vec2 offset;\n          offset.x \x3d a.a \x3e a.b ? a.a : -a.b;\n          offset.y \x3d a.g \x3e a.r ? -a.g : a.r;\n\n          if ( abs( offset.x ) \x3e abs( offset.y )) {\n            offset.y \x3d 0.0;\n          } else {\n            offset.x \x3d 0.0;\n          }\n\n          vec4 C \x3d texture2D( colorTex, texcoord, 0.0 );\n          texcoord +\x3d sign( offset ) * uResolution.xy;\n          vec4 Cop \x3d texture2D( colorTex, texcoord, 0.0 );\n\n          float s \x3d abs( offset.x ) \x3e abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n          //C.xyz \x3d pow(C.xyz, vec3(2.2));\n          //Cop.xyz \x3d pow(Cop.xyz, vec3(2.2));\n          vec4 mixed \x3d mix(C, Cop, s);\n          //mixed.xyz \x3d pow(mixed.xyz, vec3(1.0 / 2.2));\n\n          return mixed;\n        }\n      }\n\n      void main() {\n        gl_FragColor \x3d SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );\n\n        #if SMAA_DEBUG_SPLIT_VIEW // split the view in the middle and display the unprocessed image on the right\n          // test stuff\n          if (fTexCoord.x \x3e 0.5) {\n            if (fTexCoord.x \x3c 0.5 + uResolution.x) {\n              gl_FragColor \x3d vec4(0, 0, 1, 1);\n            } else {\n              gl_FragColor \x3d texture2D(tColor, fTexCoord);\n            }\n          }\n        #endif // DEBUG\n      }",
this.vertexAttributeLocations);var e=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new c(b,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new a(b,34962,35044,e)});this.tmpFramebufferEdges=k.createWithAttachments(this.rctx,{target:3553,pixelFormat:6407,dataType:5121,samplingMode:9729,wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0});this.tmpFramebufferBlend=k.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,
wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0});this.textureArea=this.loadTextureFromBase64("data:image/png;base64,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\x3d",
9729,6407);this.textureSearch=this.loadTextureFromBase64("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII\x3d",9728,6409);this.isEnabled=!0}};e.prototype.disable=function(){this.isEnabled&&(this.programEdgeDetect.dispose(),this.programEdgeDetect=null,this.programBlendWeights.dispose(),this.programBlendWeights=null,this.programBlur.dispose(),this.programBlur=null,this.vao.dispose(),
this.vao=null,this.textureArea.dispose(),this.textureArea=null,this.textureSearch.dispose(),this.textureSearch=null,this.tmpFramebufferBlend.dispose(),this.tmpFramebufferBlend=null,this.tmpFramebufferEdges.dispose(),this.tmpFramebufferEdges=null,this.isEnabled=!1)};e.prototype.render=function(a,b){this.enable();var c=this.rctx,d=0,e=0;null!=b?(d=b.descriptor.width,e=b.descriptor.height):(d=c.gl.canvas.width,e=c.gl.canvas.height);c.bindVAO(this.vao);c.setFaceCullingEnabled(!0);c.setCullFace(1029);
c.setFrontFace(2305);c.setBlendingEnabled(!1);c.setDepthTestEnabled(!1);c.setViewport(0,0,d,e);this.tmpFramebufferEdges.resize(d,e);c.bindFramebuffer(this.tmpFramebufferEdges);c.setClearColor(0,0,0,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programEdgeDetect);c.bindTexture(a.colorTexture,0);this.programEdgeDetect.setUniform1i("tColor",0);this.programEdgeDetect.setUniform4f("uResolution",1/d,1/e,d,e);c.drawArrays(4,0,3);this.tmpFramebufferBlend.resize(d,e);c.bindFramebuffer(this.tmpFramebufferBlend);
c.setClearColor(0,0,1,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programBlendWeights);this.programBlendWeights.setUniform4f("uResolution",1/d,1/e,d,e);c.bindTexture(this.textureSearch,1);this.programBlendWeights.setUniform1i("tSearch",1);c.bindTexture(this.textureArea,2);this.programBlendWeights.setUniform1i("tArea",2);c.bindTexture(this.tmpFramebufferEdges.colorTexture,3);this.programBlendWeights.setUniform1i("tEdges",3);c.drawArrays(4,0,3);c.bindFramebuffer(b);c.setClearColor(0,1,0,1);
c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programBlur);this.programBlur.setUniform4f("uResolution",1/d,1/e,d,e);c.bindTexture(a.colorTexture,0);this.programBlur.setUniform1i("tColor",0);c.bindTexture(this.tmpFramebufferBlend.colorTexture,1);this.programBlur.setUniform1i("tBlendWeights",1);c.drawArrays(4,0,3);c.setBlendingEnabled(!0);c.setDepthTestEnabled(!0)};e.prototype.loadTextureFromBase64=function(a,c,d){var e=new b(this.rctx,{pixelFormat:d,dataType:5121,wrapMode:33071,samplingMode:c},
null);f.dataUriToImage(a).then(function(a){e.resize(a.width,a.height);e.setData(a)});return e};return e}()})},"esri/views/3d/support/imageUtils":function(){define(["require","exports","dojo/Deferred","../../../core/urlUtils","../../../request"],function(m,h,d,c,a){function b(a){var b=!1,c=new Image,e=new d(function(){b=!0;c.src=""}),l=function(){b||e.reject()};c.onload=function(){b||e.resolve(c)};c.onerror=l;c.onabort=l;c.src=a;return e.promise}Object.defineProperty(h,"__esModule",{value:!0});h.dataURItoBlob=
function(a){var b=atob(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];for(var c=new ArrayBuffer(b.length),d=new Uint8Array(c),l=0;l<b.length;l++)d[l]=b.charCodeAt(l);return new Blob([c],{type:a})};h.dataUriToImage=b;h.requestImage=function(d){return c.isDataProtocol(d)?b(d):a(d,{responseType:"image",allowImageDataAccess:!0}).then(function(a){return a.data})}})},"esri/views/webgl/Profiling":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});
h.startMeasurement=function(c){if(!c.extensions.disjointTimerQuery)return null;var a=new d;a.start(c);return a};var d=function(){function c(){}c.prototype.start=function(a){this._rctx=a;a=a.extensions.disjointTimerQuery;this._query=a.createQueryEXT();a.beginQueryEXT(a.TIME_ELAPSED_EXT,this._query)};c.prototype.stop=function(a,b){void 0===b&&(b=50);this._cb=a;this._checkInterval=b;a=this._rctx.extensions.disjointTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT);this._checkQueryResult()};c.prototype._checkQueryResult=
function(){var a=this._rctx.extensions.disjointTimerQuery,b=a.getQueryObjectEXT(this._query,a.QUERY_RESULT_AVAILABLE_EXT),c=this._rctx.gl.getParameter(a.GPU_DISJOINT_EXT);b&&!c?(a=a.getQueryObjectEXT(this._query,a.QUERY_RESULT_EXT),this._cb(a/1E6)):c?this._cb(null):setTimeout(this._checkQueryResult.bind(this),this._checkInterval)};return c}()})},"esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial":function(){define("require exports dojo/text!./TexOnlyGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../lib/gl-matrix ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g){var e=b.vec4d.createFrom(1,1,1,1);return function(){function b(a,b,d,e,f){this.id=c.__GLMaterial_id++;this.program=a.get("texOnly");this.color=d;this.depthFunc=f;this.blend=e;this.texGLName=b}b.prototype.getId=function(){return this.id};b.prototype.beginSlot=function(b){return b===a.INTERNAL_MATERIAL};b.prototype.getProgram=function(){return this.program};b.prototype.setColor=function(a){this.color=a};b.prototype.bind=function(a,b){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",
c.IDENTITY);this.program.setUniformMatrix4fv("proj",b.proj);this.program.setUniform4fv("color",void 0!==this.color?this.color:e);this.program.setUniform1i("tex",0);a.bindTexture(this.texGLName,0);this.blend&&(a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA));a.setDepthTestEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)};b.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);
this.blend&&a.setBlendingEnabled(!1)};b.prototype.bindView=function(a,b){c.bindView(b.origin,b.view,this.program)};b.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)};b.prototype.getDrawMode=function(a){return a.gl.TRIANGLES};b.loadShaders=function(a,b,c,e){a._parse(d);a=new k(e,a.vertexShaderTexOnly,a.fragmentShaderTexOnly,g.Default3D);c.add("texOnly",a)};return b}()})},"esri/views/3d/webgl-engine/lib/HighlightUtils":function(){define(["require","exports",
"./IdGen"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});var c=new d;h.generateHighlightId=function(){return c.gen("highlight")}})},"esri/views/3d/webgl-engine/lib/webgl-utils":function(){define([],function(){var m=function(h,d){for(var c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=null,b=0;b<c.length;++b){try{a=h.getContext(c[b],d)}catch(k){}if(a)break}return a};return{create3DContext:m,setupWebGL:function(h,d){function c(a){var b=h.parentNode;b&&(b.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
a+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return c('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];d=m(h,d);return d?[d]:(c('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'])},detectWebGL:function(){var h;try{h=window.WebGLRenderingContext}catch(c){h=[!1,0]}var d;try{d=m(document.createElement("canvas"))}catch(c){d=[!1,1]}h?d?(h=d,h=[!0,{VERSION:h.getParameter(h.VERSION),SHADING_LANGUAGE_VERSION:h.getParameter(h.SHADING_LANGUAGE_VERSION),VENDOR:h.getParameter(h.VENDOR),RENDERER:h.getParameter(h.RENDERER),
EXTENSIONS:h.getSupportedExtensions(),MAX_TEXTURE_SIZE:h.getParameter(h.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:h.getParameter(h.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):h=[!1,1]:h=[!1,0];return h}}})},"esri/views/3d/webgl-engine/parts/Viewport":function(){define("require exports dojo/has ../lib/PerformanceTimer ../lib/Camera ../lib/Util ../lib/gl-matrix ./Visualizer".split(" "),function(m,h,d,c,a,b,k,f){var g=k.vec3;m=k.vec4d;var e=
k.mat4d,l=[0,0],p=e.create(),v=[m.create(),m.create(),m.create(),m.create(),m.create(),m.create()];return function(){function c(b,c,d,e){this._content={};this._frustumCullingEnabled=!0;this._maxFarNearRatio=2E4;this._stats={renderGeometriesTotal:0,renderGeometriesVisible:0,visualizerRenderTimer:null,viewportRenderTimer:null};this._needsRender=!0;this._rctx=e;this._gl=e.gl;this._visualizer=new f(b,c,d,this._rctx);this._camera=new a(g.createFrom(0,100,-100),g.createFrom(0,0,0))}c.prototype.getCombinedStats=
function(){var a={},b=this._visualizer.getCombinedStats(),c;for(c in b)a[c]=b[c];a.renderGeometriesTotal=this._stats.renderGeometriesTotal;a.renderGeometriesVisible=this._stats.renderGeometriesVisible;void 0!==this._gl.getUsedTextureMemory&&(a.textureMemory=this._gl.getUsedTextureMemory());void 0!==this._gl.getUsedRenderbufferMemory&&(a.renderbufferMemory=this._gl.getUsedRenderbufferMemory());void 0!==this._gl.getUsedVBOMemory&&(a.VBOMemory=this._gl.getUsedVBOMemory());if(void 0!==this._gl.getUsedTextureMemoryStats){var b=
this._gl.getUsedTextureMemoryStats(),d;for(d in b)a["texMem type: "+d]=b[d]}return a};c.prototype.dispose=function(){this._visualizer.dispose();this._visualizer=null};c.prototype.setLighting=function(a){this._visualizer.setLighting(a)};c.prototype.getViewParams=function(a){var b=this._visualizer.getViewParams(a);if(!a||a.frustumCullingEnabled)b.frustumCullingEnabled=this._frustumCullingEnabled;if(!a||a.maxFarNearRatio)b.maxFarNearRatio=this._maxFarNearRatio;return b};c.prototype.setViewParams=function(a){void 0!==
a.frustumCullingEnabled&&(this._frustumCullingEnabled=a.frustumCullingEnabled);void 0!==a.maxFarNearRatio&&(this._maxFarNearRatio=-1===a.maxFarNearRatio?2E4:a.maxFarNearRatio);this._visualizer.setViewParams(a);this._needsRender=!0};c.prototype.setRenderParams=function(a){this._visualizer.setRenderParams(a)};c.prototype.getRenderParams=function(){return this._visualizer.getRenderParams()};c.prototype.getFrustumObjects=function(){var a={},b;for(b in this._content)a[this._content[b].name]=1;return a};
c.prototype.modify=function(a,b,c,d){this._visualizer.modify(a,b,c,d);this._content=this._visualizer.getContent()};c.prototype.getContent=function(){return this._content};c.prototype.setCamera=function(a){this._camera.copyFrom(a);this._updateNearFar();this._needsRender=!0};c.prototype.getCamera=function(){return this._camera};c.prototype.getPickRay=function(a,b,c){return this.pickRayWithBeginPoint(a,void 0,this._camera.viewMatrix,b,c)};c.prototype.pickRayWithBeginPoint=function(a,b,c,d,e){return this._visualizer.getPickRay(a,
b,this._camera,c,d,e)};c.prototype.addExternalRenderer=function(a,b){return this._visualizer.addExternalRenderer(a,b)};c.prototype.removeExternalRenderer=function(a){return this._visualizer.removeExternalRenderer(a)};c.prototype.getExternalRenderers=function(){return this._visualizer.getExternalRenderers()};c.prototype.render=function(a,b){this._updateNearFar();this._visualizer.render(this._camera,a,b)};c.prototype.resetNeedsRender=function(){this._needsRender=!1;this._visualizer.resetNeedsRender()};
c.prototype.needsRender=function(){return this._needsRender||this._visualizer.needsRender()};c.prototype._updateNearFar=function(){if(this._frustumCullingEnabled||0<this._maxFarNearRatio)l[1]=0,this._computeFrustumCullingAndNearFar(this._camera.eye,l),0<this._maxFarNearRatio&&0<l[1]&&(this._camera.far=l[1],this._camera.near=Math.max(l[0],this._camera.far/this._maxFarNearRatio))};c.prototype._computeFrustumCullingAndNearFar=function(a,c){e.perspective(this._camera.fovY,this._camera.aspect,1,10,p);
b.matrix2frustumPlanes(this._camera.viewMatrix,p,v);this._stats.renderGeometriesTotal=0;this._stats.renderGeometriesVisible=0;a=-Number.MAX_VALUE;var d=-Number.MAX_VALUE,f=v[0][0],g=v[0][1],l=v[0][2],k=v[0][3],n=v[1][0],h=v[1][1],q=v[1][2],t=v[1][3],m=v[2][0],G=v[2][1],J=v[2][2],I=v[2][3],F=v[3][0],N=v[3][1],L=v[3][2],M=v[3][3],K=v[4][0],ba=v[4][1],X=v[4][2],T=v[4][3],V=v[5][3],P;for(P in this._content){var W=this._content[P];this._stats.renderGeometriesTotal++;if(!W.material.isBackdrop){var U=W.center,
Y=U[0],S=U[1],U=U[2],W=W.bsRadius;if(f*Y+g*S+l*U+k>W)continue;if(n*Y+h*S+q*U+t>W)continue;if(m*Y+G*S+J*U+I>W)continue;if(F*Y+N*S+L*U+M>W)continue;S=K*Y+ba*S+X*U;Y=S+W;S=-S+W;Y>a&&(a=Y);S>d&&(d=S)}this._stats.renderGeometriesVisible++}P=a!==-Number.MAX_VALUE;0<this._stats.renderGeometriesVisible&&P&&(c[0]=.99*Math.max(1-(a+T),2),c[1]=1.01*Math.max(10+(d+V),c[0]+1))};return c}()})},"esri/views/3d/webgl-engine/lib/PerformanceTimer":function(){define(["require","exports","./Util"],function(m,h,d){return function(){function c(a){this._filterSampleIndex=
0;this._lastTime=NaN;this._numMeasurements=this._totalTime=0;this._filterSamples=Array(a);this.reset();this._filterSize=a}c.prototype.reset=function(){for(var a=this._filterSampleIndex=0;a<this._filterSize;a++)this._filterSamples[a]=NaN};c.prototype.start=function(){this._tsStart=d.performance.now()};c.prototype.stop=function(){this._lastTime=d.performance.now()-this._tsStart;this._totalTime+=this._lastTime;this._numMeasurements++;this._filterSize&&(this._filterSamples[this._filterSampleIndex]=this._lastTime,
this._filterSampleIndex=(this._filterSampleIndex+1)%this._filterSize);return this._lastTime};c.prototype.getLast=function(){return this._lastTime};c.prototype.getLastFiltered=function(){for(var a=0,b=0;b<this._filterSamples.length;b++)a+=this._filterSamples[b];return a/this._filterSamples.length};c.prototype.getAverage=function(){return this._totalTime/this._numMeasurements};c.prototype.getTotal=function(){return this._totalTime};c.prototype.getNumMeasurements=function(){return this._numMeasurements};
return c}()})},"esri/views/3d/webgl-engine/parts/Visualizer":function(){define("require exports ../lib/Renderer ../lib/SSAOHelperObscurance ../lib/ShadowMap ../lib/NearFarCalc ../lib/Util ../lib/gl-matrix ../lib/RenderPass ../lib/HighlightHelper ../lib/OffscreenRenderingHelper".split(" "),function(m,h,d,c,a,b,k,f,g,e,l){var p=f.vec3d,v=f.mat4d,q=k.assert;return function(){function f(f,g,k,p){this._drawSSAOMapDebugQuad=this._drawShadowMapDebugQuad=!1;this._needsRender=!0;this._content={};this._rctx=
p;this._renderer=new d(f,g,k,this._rctx,!1);this._programRep=f;this._shadowMap=new a(f,this._rctx);this._ssaoHelper=new c(f,k,this._rctx,this.setNeedsRender.bind(this));this._nearFarCalc=new b;this._highlightHelper=new e(f,k,this._rctx);this._offscreenRenderingHelper=new l(f,this._rctx)}f.prototype.getCombinedStats=function(){return this._renderer.getCombinedStats()};f.prototype.dispose=function(){this._renderer.dispose();this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(!1);this._shadowMap.dispose();
this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(!1);this._ssaoHelper.dispose();this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!1);this._offscreenRenderingHelper.getEnableState()&&this._offscreenRenderingHelper.setEnableState(!1)};f.prototype.setLighting=function(a){this._renderer.setLighting(a)};f.prototype.getViewParams=function(a){var b=a||{};if(!a||a.pixelRatio)b.pixelRatio=this._renderer.getPixelRatio();return b};f.prototype.setViewParams=function(a){null!=
a.pixelRatio&&this._renderer.setPixelRatio(a.pixelRatio)};f.prototype.setRenderParams=function(a){void 0!==a.shadowMapResolution&&!1===this._shadowMap.getEnableState()&&this._shadowMap.setTextureResolution(a.shadowMapResolution);void 0!==a.shadowMap&&a.shadowMap!==this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(a.shadowMap);void 0!==a.shadowMapMaxCascades&&this._shadowMap.setMaxNumCascades(a.shadowMapMaxCascades);!0!==this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!0);
void 0!==a.ssao&&a.ssao!==this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(a.ssao);void 0!==a.ssaoAttenuation&&this._ssaoHelper.setAttenuation(a.ssaoAttenuation);void 0!==a.ssaoRadius&&this._ssaoHelper.setRadius(a.ssaoRadius);void 0!==a.ssaoFilterRadius&&console.error("The property ssaoFilterRadius is no longer supported as a render parameter.");void 0!==a.ssaoSamples&&this._ssaoHelper.setSamples(a.ssaoSamples);void 0!==a.drawShadowMapDebugQuad&&(this._drawShadowMapDebugQuad=a.drawShadowMapDebugQuad);
void 0!==a.drawSSAODebugQuad&&(this._drawSSAOMapDebugQuad=a.drawSSAODebugQuad);this._ssaoHelper.getEnableState()?this._renderer.ssaoEnabled=!0:this._renderer.ssaoEnabled=!1;void 0!==a.offscreenRendering&&a.offscreenRendering!==this._offscreenRenderingHelper.getEnableState()&&this._offscreenRenderingHelper.setEnableState(a.offscreenRendering);void 0!==a.antialiasingEnabled&&(this._renderer.renderOptions.antialiasing=a.antialiasingEnabled?"smaa":"none");void 0!==a.earlyOcclusionPixelDraw&&(this._renderer.renderOptions.earlyOcclusionPixelDraw=
a.earlyOcclusionPixelDraw);void 0!==a.defaultHighlightOptions&&this._highlightHelper.setDefaultOptions(a.defaultHighlightOptions);this._needsRender=!0};f.prototype.getRenderParams=function(){var a={};this._shadowMap.getIsSupported()&&(a.shadowMap=this._shadowMap.getEnableState(),a.shadowMapResolution=this._shadowMap.getTextureResolution(),a.shadowMapMaxCascades=this._shadowMap.getMaxNumCascades());this._ssaoHelper.getIsSupported()&&(a.ssao=this._ssaoHelper.getEnableState(),a.ssaoAttenuation=this._ssaoHelper.getAttenuation(),
a.ssaoRadius=this._ssaoHelper.getRadius(),a.ssaoFilterRadius=this._ssaoHelper.getFilterRadius(),a.ssaoSamples=this._ssaoHelper.getSamples());return a};f.prototype.modify=function(a,b,c,d){this._renderer.modify(a,b,c,d);for(d=0;d<b.length;++d)delete this._content[b[d].uniqueName];for(d=0;d<a.length;++d)this._content[a[d].uniqueName]=a[d];for(d=0;d<c.length;++d)q(this._content[c[d].renderGeometry.uniqueName]===c[d].renderGeometry)};f.prototype.getContent=function(){return this._content};f.prototype.getPickRay=
function(a,b,c,d,e,f){p.unproject(p.createFrom(a[0],a[1],0),d,c.projectionMatrix,c.fullViewport,e);p.unproject(p.createFrom(a[0],a[1],1),d,c.projectionMatrix,c.fullViewport,f)};f.prototype.getProjectionMatrix=function(a,b,c,d,e){b=k.fovx2fovy(b,a[2],a[3]);v.perspective(180*b/Math.PI,a[2]/a[3],c,d,e)};f.prototype.addExternalRenderer=function(a,b){return this._renderer.addExternalRenderer(a,b)};f.prototype.removeExternalRenderer=function(a){return this._renderer.removeExternalRenderer(a)};f.prototype.getExternalRenderers=
function(){return this._renderer.getExternalRenderers()};f.prototype.resetNeedsRender=function(){this._needsRender=!1;this._renderer.resetNeedsRender()};f.prototype.needsRender=function(){return this._needsRender||this._renderer.needsRender()};f.prototype.setNeedsRender=function(){this._needsRender=!0};f.prototype.render=function(a,b,c){var d=a.viewport,e;if(this._shadowMap.getEnableState()){e=this._nearFarCalc.calculateSceneNearFar(a,this._content);this._shadowMap.prepare(a,b,this._content,e);b=
this._shadowMap.getCascades();for(e=0;e<b.length;++e){var f=b[e];f.camera.setGLViewport(this._rctx);this._renderer.renderGeometryPass(g.MATERIAL_DEPTH_SHADOWMAP,f.camera)}this._shadowMap.finish(c);a.setGLViewport(this._rctx)}this._shadowMap.bindAll(this._programRep);this._renderer.renderAuxiliaryBuffers(a,this._shadowMap,this._ssaoHelper,c,this._offscreenRenderingHelper);this._renderer.render(a,this._shadowMap,this._ssaoHelper,c,this._highlightHelper,this._offscreenRenderingHelper);this._drawShadowMapDebugQuad&&
this._shadowMap.getEnableState()&&(a=v.ortho(d[0],d[2],d[1],d[3],-1,1),this._shadowMap.drawDebugQuad(a));this._drawSSAOMapDebugQuad&&this._ssaoHelper.getEnableState()&&(a=v.ortho(d[0],d[2],d[1],d[3],-1,1),this._ssaoHelper.drawQuad(a))};return f}()})},"esri/views/3d/webgl-engine/lib/SSAOHelperObscurance":function(){define("require exports ../../../../core/Logger ./Util ./gl-matrix dojo/text!../materials/internal/ssao.xml ../../../webgl/Program ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../support/imageUtils ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t){var u=a.vec3d,x=a.vec4d,r=d.getLogger("esri.views.3d.webgl-engine");m=function(){function a(a,b,c,d){this._enabled=!1;this._BLUR_F=2;this._attenuation=.5;this._radius=3;this._samples=16;this._viewportToRestore=x.create();this._rctx=c;this._programRep=a;this._textureRep=b;this._requestRender=d;this._emptyTexture=new f(c,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:4,height:4},null)}a.prototype.dispose=function(){this._emptyTexture.dispose();
this._emptyTexture=null};a.prototype.getIsSupported=function(){var a=this._rctx,b=-1!==a.parameters.versionString.indexOf("WebGL 0.93"),c=-1!==a.parameters.versionString.indexOf("WebGL 0.94");return a.extensions.standardDerivatives&&!(b||c)};a.prototype.setEnableState=function(a){a?this.enable():this.disable()};a.prototype.getEnableState=function(){return this._enabled};a.prototype.enable=function(){var a=this;if(!this.getEnableState())if(this.getIsSupported()){this._enabled=!0;var b={target:3553,
pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},c={colorTarget:0,depthStencilTarget:0};this._ssaoFBO=g.createWithAttachments(this._rctx,b,c);this._blur0FBO=g.createWithAttachments(this._rctx,b,c);this._blur1FBO=g.createWithAttachments(this._rctx,b,c);v.dataUriToImage("data:image/png;base64,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\x3d\x3d").then(function(b){a._noiseTexture=
new f(a._rctx,{target:3553,pixelFormat:6408,dataType:5121,hasMipmap:!0,width:E,height:E},b);a._requestRender()})}else r.warn("SSAO is not supported for this browser or hardware")};a.prototype.getQuadVAO=function(){if(!this._quadVAO){var a=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this._quadVAO=new e(this._rctx,t.Default3D,{geometry:n.Pos2},{geometry:l.createVertex(this._rctx,35044,a)})}return this._quadVAO};a.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this._quadVAO&&this._quadVAO.dispose(!0),
this._noiseTexture&&this._noiseTexture.dispose(),this._blur1FBO.dispose(),this._blur0FBO.dispose(),this._ssaoFBO.dispose(),this._ssaoFBO=this._blur0FBO=this._blur1FBO=this._noiseTexture=this._quadVAO=null)};a.prototype.setAttenuation=function(a){this._attenuation=a};a.prototype.getAttenuation=function(){return this._attenuation};a.prototype.setRadius=function(a){this._radius=a};a.prototype.getRadius=function(){return this._radius};a.prototype.getFilterRadius=function(){return 4};a.prototype.setSamples=
function(a){this._samples=a};a.prototype.getSamples=function(){return this._samples};a.prototype.computeSSAO=function(a,b,d,e){if(this._noiseTexture){c.assert(this.getEnableState());var f=this._rctx,g=d.width,l=d.height,k=g/this._BLUR_F,n=l/this._BLUR_F;this._ssaoFBO.resize(g,l);this._blur0FBO.resize(k,n);this._blur1FBO.resize(k,n);k=1*g;n=1*l;f.bindFramebuffer(this._ssaoFBO);x.set(a.fullViewport,this._viewportToRestore);f.setViewport(0,0,g,l);var h=this._programRep.get(8>=this._samples?"ssao8":16>=
this._samples?"ssao16":32>=this._samples?"ssao32":"ssao64"),q=this._programRep.get("blur"),t=a.projectionMatrix;z[0]=-2/(k*t[0]);z[1]=-2/(n*t[5]);z[2]=(1-t[2])/t[0];z[3]=(1+t[6])/t[5];t=0===t[11];h.setUniform2f("rnmScale",g/E,l/E);h.setUniform3fv("pSphere",8>=this._samples?B:16>=this._samples?C:32>=this._samples?A:D);f.bindProgram(h);h.setUniform1f("numSpiralTurns",this._samples<H.length?H[this._samples]:5779);h.setUniform4fv("projInfo",new Float32Array(z));g=1/a.computePixelSizeAtDist(1);h.setUniform1f("projScale",
1*g);h.setUniform2f("screenDimensions",k,n);t?(h.setUniform2f("nearFar",a.near,a.far),h.setUniform2f("zScale",0,-1)):(h.setUniform2f("nearFar",a.near,a.far),h.setUniform2f("zScale",1,0));var r=2*this._radius,l=u.dist(a.eye,a.center),r=20*a.computePixelSizeAtDist(l),r=Math.max(.1,r);h.setUniform1f("radius",r);h.setUniform1f("intensity",4*this._attenuation/Math.pow(r,6));h.setUniform1i("rnm",0);h.setUniform1i("normalMap",1);h.setUniform1i("depthMap",2);f.bindTexture(this._noiseTexture,0);f.bindTexture(e.colorTexture,
1);f.bindTexture(d.colorTexture,2);d=this.getQuadVAO();f.bindVAO(d);f.drawArrays(5,0,p.vertexCount(d,"geometry"));f.bindTexture(this._ssaoFBO.colorTexture,0);f.setViewport(0,0,k/this._BLUR_F,n/this._BLUR_F);f.bindFramebuffer(this._blur0FBO);q.setUniform2f("screenDimensions",k,n);q.setUniform1i("tex",0);q.setUniform1i("normalMap",1);q.setUniform1i("depthMap",2);q.setUniform2f("blurSize",0,1*this._BLUR_F/n);q.setUniform1i("radius",4);q.setUniform1f("g_BlurFalloff",.08);q.setUniform2f("nearFar",a.near,
a.far);5E4<l&&(g=Math.max(0,g-(l-5E4)));q.setUniform1f("projScale",g);t?q.setUniform2f("zScale",0,-1):q.setUniform2f("zScale",1,0);f.drawArrays(5,0,p.vertexCount(d,"geometry"));q.setUniform2f("blurSize",1*this._BLUR_F/k,0);f.bindFramebuffer(this._blur1FBO);f.bindTexture(this._blur0FBO.colorTexture,0);f.drawArrays(5,0,p.vertexCount(d,"geometry"));f.bindFramebuffer(b);f.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])}};a.prototype.setUniforms=
function(a){var b=this.getEnableState()&&this._noiseTexture,c=this._rctx;c.bindTexture(b?this._blur1FBO.colorTexture:this._emptyTexture,6);c.setActiveTexture(0);a.setUniform1i("ssaoTex",6);b?a.setUniform4f("viewportPixelSz",this._viewportToRestore[0],this._viewportToRestore[1],1/this._ssaoFBO.width,1/this._ssaoFBO.height):a.setUniform4f("viewportPixelSz",-1,-1,-1,-1)};a.prototype.bindAll=function(a){a=a.getProgramsUsingUniform("viewportPixelSz");for(var b=0;b<a.length;b++)this.setUniforms(a[b])};
a.prototype.drawQuad=function(a){c.assert(this.getEnableState());var b=this._programRep.get("showDepth");this._debugQuadVAO||(this._debugQuadVAO=new e(this._rctx,t.Default3D,{geometry:n.Pos2Tex},{geometry:l.createVertex(this._rctx,35044,G)}));var d=this._rctx;d.setDepthTestEnabled(!1);b.setUniformMatrix4fv("proj",new Float32Array(a));b.setUniform1i("depthTex",0);d.bindTexture(this._ssaoFBO.colorTexture,0);d.bindVAO(this._debugQuadVAO);d.drawArrays(5,0,p.vertexCount(this._debugQuadVAO,"geometry"));
d.setDepthTestEnabled(!0)};a.loadShaders=function(a,d,e,f){c.assert(null==a.samples);a._parse(b);d=new k(f,a.vertexShaderShowDepth,a.fragmentShaderShowDepth,t.Default3D);var g=a.createFsSSAOSrcObscurance,l=new k(f,a.vsUVQuad,g,t.Default3D,{NUM_TAP_SAMPLES:"8"}),p=new k(f,a.vsUVQuad,g,t.Default3D,{NUM_TAP_SAMPLES:"16"}),n=new k(f,a.vsUVQuad,g,t.Default3D,{NUM_TAP_SAMPLES:"32"}),g=new k(f,a.vsUVQuad,g,t.Default3D,{NUM_TAP_SAMPLES:"64"});a=new k(f,a.vsUVQuad,a.fsBlurEdgeAware,t.Default3D,{RADIUS:(4).toString()});
e.add("showDepth",d);e.add("ssao8",l);e.add("ssao16",p);e.add("ssao32",n);e.add("ssao64",g);e.add("blur",a)};return a}();var z=x.create(),B=new Float32Array([.186937,0,0,.677503,0,0,-.782832,.128424,.557187,.248064,.460317,-.659755,.062892,.918659,.312829,-.241031,-.814826,.224206,-.642866,.132138,-.45016,.145727,-.590568,-.626141,.005017,-.002234,.012668]),C=new Float32Array([.186937,0,0,.700542,0,0,-.864858,-.481795,-.111713,-.624773,.102853,-.730153,-.387172,.260319,.007229,-.222367,-.642631,-.707697,
-.01336,-.014956,.169662,.122575,.1544,-.456944,-.177141,.85997,-.42346,-.131631,.814545,.524355,-.779469,.007991,.624833,.308092,.209288,.35969,.359331,-.184533,-.377458,.192633,-.482999,-.065284,.233538,.293706,-.055139,.417709,-.386701,.442449,-.301656,-.836426,.408344]),A=new Float32Array([.837372,0,0,.723531,-.467287,.034157,.169582,-.31169,-.881801,.696236,.455215,-.204568,-.304514,.528086,.626381,-.053116,.222507,.037523,.199755,.311291,.916799,-.681552,-.516264,.501792,-.37127,.021088,.737477,
-.029503,.209188,-.95298,-.573731,.009962,-.154202,-.257345,-.905958,.282747,.370779,.527867,-.669424,-.601758,-.191278,-.708243,.271796,.782684,.535565,-.006867,-.015312,-.017276,.419958,.265628,.233036,-.543898,.554747,-.174055,-.079242,.053475,-.099539,.372042,-.339267,-.357362,.015781,-.011352,.042707,-.340564,-.272507,-.067725,.799249,-.127948,.586808,.450015,.01965,-.416454,-.506524,.323229,.206546,-.087316,-.311097,.466049,.146374,-.34528,-.045904,-.152614,-.926686,-.287529,-.665726,-.032904,
.246643,.248703,.637193,-.062541,-.073706,.495925,-.315143,.05946,-.116042,.075586]),D=new Float32Array([.186937,0,0,.605726,-.313457,-.097616,.003541,.781245,.283011,-.225029,-.373279,.274442,-.047511,.04992,-.226365,.627629,-.623617,-.463628,.133094,-.318299,.528128,.262035,.100234,-.09012,.178335,-.426972,-.666048,-.27306,-.207352,.05514,-.613649,-.063395,.060608,-.283391,-.41382,-.087565,.136768,.506126,.484137,-.593808,-.344603,.453164,.675326,.124799,-.697865,-.33502,.411337,-.09337,-.15271,
.002908,-.063582,.366733,-.699739,.401148,-.519536,-.585625,-.508413,.106482,-.428709,-.260221,.012847,-.118806,.016962,-.188182,.49945,.452364,.586617,.722539,-.23302,.111295,.202827,.066695,-.036503,.315842,.896467,-.039109,-.270116,-.080062,.613435,.508787,.538656,-.352275,.566869,-.666275,.887876,-.138341,-.434135,-.444711,.269156,.119506,-.029457,-.077316,.754474,.274125,-.13876,-.37082,-.73268,.332723,.568545,-.203992,.878922,-.430778,.541154,-.546752,.11786,-3.93E-4,-.083318,.059333,-.341406,
-.117017,-.318568,-.262425,-.457913,.848753,.89229,-.30157,.322416,.742328,.032262,.643827,.048091,-.078044,-.49908,.064858,.549944,-.796252,-.230688,.88978,-.010153,.397241,-.27645,.405666,-.46593,.131187,-.600166,.333834,-.078219,.73837,-.870169,-.411658,-.222175,-.492421,.741454,.293757,-.591244,.389112,-.388324,.792346,.578552,.088459,-.121858,-.437241,-.472535,-.374835,.302427,.721264,.057485,.204085,-.126575,.510325,.481492,-.579888,-.29411,-.82136,.156404,-.819717,-.042466,.456573,.079884,
.07019,.179002,.220279,.970222,-.088025,-.299911,-.234627,-.820794,.912112,.243306,.317869,.241336,.161841,-.721568,.301135,-.635993,-.0939,-.514731,-.089673,.850964,-.905087,.314604,-.098397]),E=64,H=[1,1,1,2,3,2,5,2,3,2,3,3,5,5,3,4,7,5,5,7,9,8,5,5,7,7,7,8,5,8,11,12,7,10,13,8,11,8,7,14,11,11,13,12,13,19,17,13,11,18,19,11,11,14,17,21,15,16,17,18,13,17,11,17,19,18,25,18,19,19,29,21,19,27,31,29,21,18,17,29,31,31,23,18,25,26,25,23,19,34,19,27,21,25,39,29,17,21,27,29],G=new Float32Array([0,0,0,0,512,
0,1,0,0,512,0,1,512,512,1,1]);return m})},"esri/views/3d/webgl-engine/lib/ShadowMap":function(){define("./Camera ./Util ./gl-matrix ../../../../core/Logger ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(m,h,d,c,a,b,k,f,g,e,l){var p=d.vec2d,v=d.vec3d,q=d.vec4d,n=d.mat3d,t=d.mat4d,u=d.mat4,x=c.getLogger("esri.views.3d.webgl-engine");
return function(c,d){function r(a,b){v.set3(a[b],a[b+3],a[b+6],wa);return wa}var z=d.gl,A,D=4096,E,H=new a(d,{target:z.TEXTURE_2D,pixelFormat:z.RGBA,dataType:z.UNSIGNED_BYTE,samplingMode:z.NEAREST,width:4,height:4}),G=1,J=2,I=[0,0,0,0,0];this.dispose=function(){H.dispose();H=null};var F=function(){this.camera=new m;this.lightMat=t.create()},N=[],L,M,K;for(L=0;4>L;++L)N[L]=new F;this.getIsSupported=function(){return d.extensions.standardDerivatives};this.setTextureResolution=function(a){D=a};this.getTextureResolution=
function(){return D};this.setMaxNumCascades=function(a){J=h.clamp(Math.floor(a),1,4)};this.getMaxNumCascades=function(){return J};this.setEnableState=function(a){a?this.enable():this.disable()};this.getEnableState=function(){return void 0!==A};this.getDepthTexture=function(){return A};this.enable=function(){this.getEnableState()||(this.getIsSupported()?(A=new a(d,{target:z.TEXTURE_2D,pixelFormat:z.RGBA,dataType:z.UNSIGNED_BYTE,wrapMode:z.CLAMP_TO_EDGE,samplingMode:z.NEAREST,flipped:!0,width:D,height:D}),
E=b.createWithAttachments(d,A,{colorTarget:0,depthStencilTarget:1,width:D,height:D})):x.warn("Shadow maps are not supported for this browser or hardware"))};this.disable=function(){this.getEnableState()&&E&&(E.dispose(),A=E=void 0)};var ba=t.create(),X=t.create(),T=q.create(),V=Array(8);for(L=0;8>L;++L)V[L]=q.create();var P=v.create(),W=v.create(),U=p.create(),Y=p.create(),S=p.create(),ca=p.create(),ga=p.create(),ea=t.create(),aa=v.create();this.prepare=function(a,b,c,e){h.assert(this.getEnableState());
t.multiply(a.projectionMatrix,a.viewMatrix,ba);var f=e[0],g=e[1];2>f&&(f=2);2>g&&(g=2);f>=g&&(f=2,g=4);G=Math.min(1+Math.floor(h.logWithBase(g/f,4)),J);c=Math.pow(g/f,1/G);for(e=0;e<G+1;++e)I[e]=f*Math.pow(c,e);t.inverse(ba,X);t.lookAt([0,0,0],[-b[0],-b[1],-b[2]],[0,1,0],ea);c=a.viewMatrix;a=a.projectionMatrix;for(e=0;e<G;++e){var l=N[e],f=-I[e],g=-I[e+1],f=(a[10]*f+a[14])/Math.abs(a[11]*f+a[15]),g=(a[10]*g+a[14])/Math.abs(a[11]*g+a[15]);h.assert(f<g);for(M=0;8>M;++M)for(q.set4(0===M%4||3==M%4?-1:
1,0===M%4||1==M%4?-1:1,4>M?f:g,1,T),t.multiplyVec4(X,T,V[M]),K=0;3>K;++K)V[M][K]/=V[M][3];v.negate(V[0],aa);t.translate(ea,aa,l.camera.viewMatrix);for(M=0;8>M;++M)t.multiplyVec3(l.camera.viewMatrix,V[M]);v.set(V[0],P);v.set(V[0],W);for(M=1;8>M;++M)for(K=0;3>K;++K)P[K]=Math.min(P[K],V[M][K]),W[K]=Math.max(W[K],V[M][K]);P[2]-=200;W[2]+=200;l.camera.near=-W[2];l.camera.far=-P[2];f=1/V[0][3];g=1/V[4][3];h.assert(f<g);var k=f+Math.sqrt(f*g),n=Math.sin(Math.acos(c[2]*b[0]+c[6]*b[1]+c[10]*b[2])),k=k/n,f=
V,u=k,m=n,n=U,x=Y,B=S,C=ca,k=ga;p.set2(0,0,ka);for(var A=void 0,A=0;4>A;++A)p.add(ka,f[A],ka);p.scale(ka,.25);p.set2(0,0,Q);for(A=4;8>A;++A)p.add(Q,f[A],Q);p.scale(Q,.25);p.lerp(f[4],f[5],.5,va[0]);p.lerp(f[5],f[6],.5,va[1]);p.lerp(f[6],f[7],.5,va[2]);p.lerp(f[7],f[4],.5,va[3]);for(var H=0,F=p.dist2(va[0],ka),A=1;4>A;++A){var ja=p.dist2(va[A],ka);ja<F&&(F=ja,H=A)}p.subtract(va[H],f[H+4],na);A=na[0];na[0]=-na[1];na[1]=A;p.subtract(Q,ka,ya);p.lerp(na,ya,m);p.normalize(na);H=m=void 0;m=H=p.dot(p.subtract(f[0],
ka,w),na);for(A=1;8>A;++A)F=p.dot(p.subtract(f[A],ka,w),na),F<m?m=F:F>H&&(H=F);p.set(ka,n);p.scale(na,m-u,w);p.add(n,w,n);for(var ja=-1,L=1,A=u=F=0;8>A;++A){p.subtract(f[A],n,ia);p.normalize(ia);var za=na[0]*ia[1]-na[1]*ia[0];0<za?za>ja&&(ja=za,F=A):za<L&&(L=za,u=A)}h.verify(0<ja,"leftArea");h.verify(0>L,"rightArea");p.scale(na,m,ra);p.add(ra,ka,ra);p.scale(na,H,oa);p.add(oa,ka,oa);Ba[0]=-na[1];Ba[1]=na[0];x=h.rayRay2D(n,f[u],oa,p.add(oa,Ba,w),1,x);B=h.rayRay2D(n,f[F],oa,w,1,B);C=h.rayRay2D(n,f[F],
ra,p.add(ra,Ba,w),1,C);f=h.rayRay2D(n,f[u],ra,w,1,k);h.verify(x,"rayRay");h.verify(B,"rayRay");h.verify(C,"rayRay");h.verify(f,"rayRay");B=U;f=Y;n=ca;C=ga;k=l.camera.projectionMatrix;p.scale(p.subtract(n,C,sa),.5);Z[0]=sa[0];Z[1]=sa[1];Z[2]=0;Z[3]=sa[1];Z[4]=-sa[0];Z[5]=0;Z[6]=sa[0]*sa[0]+sa[1]*sa[1];Z[7]=sa[0]*sa[1]-sa[1]*sa[0];Z[8]=1;Z[6]=-p.dot(r(Z,0),B);Z[7]=-p.dot(r(Z,1),B);B=p.dot(r(Z,0),n)+Z[6];x=p.dot(r(Z,1),n)+Z[7];A=p.dot(r(Z,0),C)+Z[6];C=p.dot(r(Z,1),C)+Z[7];B=-(B+A)/(x+C);Z[0]+=Z[1]*B;
Z[3]+=Z[4]*B;Z[6]+=Z[7]*B;B=1/(p.dot(r(Z,0),n)+Z[6]);x=1/(p.dot(r(Z,1),n)+Z[7]);Z[0]*=B;Z[3]*=B;Z[6]*=B;Z[1]*=x;Z[4]*=x;Z[7]*=x;Z[2]=Z[1];Z[5]=Z[4];Z[8]=Z[7];Z[7]+=1;B=p.dot(r(Z,1),f)+Z[7];x=p.dot(r(Z,2),f)+Z[8];A=p.dot(r(Z,1),n)+Z[7];C=p.dot(r(Z,2),n)+Z[8];B=-.5*(B/x+A/C);Z[1]+=Z[2]*B;Z[4]+=Z[5]*B;Z[7]+=Z[8]*B;B=p.dot(r(Z,1),f)+Z[7];x=p.dot(r(Z,2),f)+Z[8];A=-x/B;Z[1]*=A;Z[4]*=A;Z[7]*=A;k[0]=Z[0];k[1]=Z[1];k[2]=0;k[3]=Z[2];k[4]=Z[3];k[5]=Z[4];k[6]=0;k[7]=Z[5];k[8]=0;k[9]=0;k[10]=1;k[11]=0;k[12]=Z[6];
k[13]=Z[7];k[14]=0;k[15]=Z[8];l.camera.projectionMatrix[10]=2/(P[2]-W[2]);l.camera.projectionMatrix[14]=-(P[2]+W[2])/(P[2]-W[2]);t.multiply(l.camera.projectionMatrix,l.camera.viewMatrix,l.lightMat);f=D/2;l.camera.viewport[0]=0===e%2?0:f;l.camera.viewport[1]=0===Math.floor(e/2)?0:f;l.camera.viewport[2]=f;l.camera.viewport[3]=f}la=void 0;I[G]=100*g;d.bindFramebuffer(E);d.bindTexture(null,7);d.setClearColor(1,1,1,1);d.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT);d.setBlendingEnabled(!1)};var R=[];this.getCascades=
function(){for(var a=0;a<G;++a)R[a]=N[a];R.length=G;return R};this.finish=function(a){h.assert(this.getEnableState());d.bindFramebuffer(a)};this.bind=function(a){var b=this.getEnableState();d.bindTexture(b?A:H,7);d.bindProgram(a);a.setUniform1i("depthTex",7);a.setUniform1f("depthHalfPixelSz",b?.5/D:-1);a.setUniform1i("shadowMapNum",G);a.setUniform4f("shadowMapDistance",I[0],I[1],I[2],I[3])};this.bindAll=function(a){a=a.getProgramsUsingUniform("shadowMapDistance");for(var b=0;b<a.length;b++)this.bind(a[b])};
var da=u.create(),fa=new Float32Array(64),la;this.bindView=function(a,b){if(this.getEnableState()){if(!la||la[0]!==b[0]||la[1]!==b[1]||la[2]!==b[2]){var c;la=la||v.create();v.set(b,la);for(M=0;M<G;++M)for(u.translate(N[M].lightMat,b,da),c=0;16>c;++c)fa[16*M+c]=da[c]}a.setUniformMatrix4fv("shadowMapMatrix",fa)}};F=new Float32Array(16);F[0]=0;F[1]=0;F[2]=0;F[3]=0;F[4]=256;F[5]=0;F[6]=1;F[7]=0;F[8]=0;F[9]=256;F[10]=0;F[11]=1;F[12]=256;F[13]=256;F[14]=1;F[15]=1;var ja=new k(d,g.Default3D,{geometry:e.Pos2Tex},
{geometry:f.createVertex(d,z.STATIC_DRAW,F)});this.drawDebugQuad=function(a){h.assert(this.getEnableState());var b=c.get("showDepth");d.setDepthTestEnabled(!1);d.bindProgram(b);b.setUniformMatrix4fv("proj",a);b.setUniform1i("depthTex",0);d.bindTexture(A,0);d.bindVAO(ja);l.assertCompatibleVertexAttributeLocations(ja,b);d.drawArrays(z.TRIANGLE_STRIP,0,l.vertexCount(ja,"geometry"));d.setDepthTestEnabled(!0)};var ka=p.create(),Q=p.create(),va=[p.create(),p.create(),p.create(),p.create()],na=p.create(),
ya=p.create(),w=p.create(),ia=p.create(),ra=p.create(),oa=p.create(),Ba=p.create(),wa=v.create(),sa=p.create(),Z=n.create()}})},"esri/views/3d/webgl-engine/lib/NearFarCalc":function(){define(["require","exports","./Util","./gl-matrix","./ComponentUtils"],function(m,h,d,c,a){m=c.vec3d;var b=c.vec4d,k=c.mat4d;c=function(){function b(){this._context={content:[],near:[],far:[],nearSpecial:[],farSpecial:[],bestNear:0,bestFar:0,bestNear2:0,bestFar2:0};this._boundingInfoHelper=new f}b.prototype._resetContext=
function(){var a=this._context;a.content.length=0;a.near.length=0;a.far.length=0;a.nearSpecial.length=0;a.farSpecial.length=0;a.bestNear=Number.MAX_VALUE;a.bestFar=-Number.MAX_VALUE;return this._context};b.prototype.calculateSceneNearFar=function(b,c){var d=this._resetContext(),e=b.viewMatrix,f=e[2],g=e[6],k=e[10],p=e[14],n=0,h;for(h in c)if(e=c[h],!a.isAllHidden(e.instanceParameters.componentVisibilities,e.componentOffsets)&&e.castShadow){var q=void 0,v=void 0;e.hasShaderTransformation?(q=e.getBoundingSphere(e.getShaderTransformation(),
null,l),v=l):(q=e.bsRadius,v=e.center);var m=f*v[0]+g*v[1]+k*v[2]+p,v=m-q,q=m+q;d.content[n]=e;d.near[n]=-q;d.far[n]=-v;++n}if(0===n)return[d.bestNear,d.bestFar];for(c=0;c<n;++c)d.near[c]>d.bestFar&&(d.bestFar=d.near[c]),2<d.near[c]&&d.far[c]<d.bestNear&&(d.bestNear=d.far[c]);d.bestNear2=Math.max(.5*d.bestNear,2);d.bestFar2=2*d.bestFar;for(c=g=f=0;c<n;++c)d.near[c]<d.bestNear&&(d.near[c]>=d.bestNear2?d.bestNear=d.near[c]:d.nearSpecial[f++]=c),d.far[c]>d.bestFar&&(d.far[c]<=d.bestFar2?d.bestFar=d.far[c]:
d.farSpecial[g++]=c);if(0===f&&0===g)return[d.bestNear,d.bestFar];d.nearSpecial.length=f;d.farSpecial.length=g;d.nearSpecial.sort(function(a,b){return d.near[a]<d.near[b]?-1:d.near[a]>d.near[b]?1:0});d.farSpecial.sort(function(a,b){return d.far[a]<d.far[b]?1:d.far[a]>d.far[b]?-1:0});this._boundingInfoHelper.init(b,d);for(c=0;c<f;++c)d.near[d.nearSpecial[c]]<d.bestNear&&(e=d.content[d.nearSpecial[c]],b=e.boundingInfo,this._boundingInfoHelper.includeNearBoundingInfoRec(b,e.getShaderTransformation()));
for(c=0;c<g;++c)d.far[d.farSpecial[c]]>d.bestFar&&(e=d.content[d.farSpecial[c]],b=e.boundingInfo,this._boundingInfoHelper.includeFarBoundingInfoRec(b,e.getShaderTransformation()));return[d.bestNear,d.bestFar]};return b}();var f=function(){function a(){this._clippingHelper=new g;this._planes=[b.create(),b.create(),b.create(),b.create(),b.create(),b.create()];this._viewProj=k.create();this._view=k.create()}a.prototype.init=function(a,b){this._context=b;k.set(a.viewMatrix,this._view);k.multiply(a.projectionMatrix,
this._view,this._viewProj);a.copyFrustumPlanes(this._planes);this._clippingHelper.init(b)};a.prototype.includeNearBoundingInfoRec=function(a,b){var c=a.getBSRadius(),d=a.getCenter();k.multiplyVec3(b,d,l);var d=l[0],e=l[1],f=l[2],c=c*Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]));if(!(this._planes[0][0]*d+this._planes[0][1]*e+this._planes[0][2]*f+this._planes[0][3]>c||this._planes[1][0]*d+this._planes[1][1]*e+this._planes[1][2]*
f+this._planes[1][3]>c||this._planes[2][0]*d+this._planes[2][1]*e+this._planes[2][2]*f+this._planes[2][3]>c||this._planes[3][0]*d+this._planes[3][1]*e+this._planes[3][2]*f+this._planes[3][3]>c||(d=this._view[2]*d+this._view[6]*e+this._view[10]*f+this._view[14],e=d+c,2>-(d-c)||-e>=this._context.bestNear)))if(-e>this._context.bestNear2)this._context.bestNear=-e;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(a=0;8>a;++a)void 0!==c[a]&&this.includeNearBoundingInfoRec(c[a],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,
b,a.getBBMin(),a.getBBMax())}};a.prototype.includeFarBoundingInfoRec=function(a,b){var c=a.getBSRadius(),d=a.getCenter();k.multiplyVec3(b,d,l);var d=l[0],e=l[1],f=l[2],c=c*Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]));if(!(this._planes[0][0]*d+this._planes[0][1]*e+this._planes[0][2]*f+this._planes[0][3]>c||this._planes[1][0]*d+this._planes[1][1]*e+this._planes[1][2]*f+this._planes[1][3]>c||this._planes[2][0]*d+this._planes[2][1]*
e+this._planes[2][2]*f+this._planes[2][3]>c||this._planes[3][0]*d+this._planes[3][1]*e+this._planes[3][2]*f+this._planes[3][3]>c||(d=this._view[2]*d+this._view[6]*e+this._view[10]*f+this._view[14]-c,-d<=this._context.bestFar)))if(-d<this._context.bestFar2)this._context.bestFar=-d;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(a=0;8>a;++a)void 0!==c[a]&&this.includeFarBoundingInfoRec(c[a],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,b,a.getBBMin(),a.getBBMax())}};return a}(),
g=function(){function a(){this._clipP=Array(8);for(var a=0;8>a;++a)this._clipP[a]=b.create()}a.prototype.init=function(a){this._context=a};a.prototype.intersectFrustumAABB=function(a,b,c,d){k.multiply(a,b,p);for(a=0;8>a;++a){b=this._clipP[a];var f=0===a||3===a||4===a||7===a?c[0]:d[0],g=0===a||1===a||4===a||5===a?c[1]:d[1],l=4>a?c[2]:d[2];b[0]=p[0]*f+p[4]*g+p[8]*l+p[12];b[1]=p[1]*f+p[5]*g+p[9]*l+p[13];b[2]=p[2]*f+p[6]*g+p[10]*l+p[14];b[3]=p[3]*f+p[7]*g+p[11]*l+p[15]}for(a=0;12>a;++a){c=this._clipTriangle(this._clipP[e[a][0]],
this._clipP[e[a][1]],this._clipP[e[a][2]]);d=!0;for(b=0;b<c.length;++b)if(f=c[b][3],2<=f){d=!1;break}if(!d)for(b=0;b<c.length;++b)f=c[b][3],f<this._context.bestNear&&(this._context.bestNear=f),f>this._context.bestFar&&(this._context.bestFar=f)}};a.prototype._inside=function(a,b){if(0===b)return a[0]>=-a[3];if(1===b)return a[1]>=-a[3];if(2===b)return a[0]<=a[3];if(3===b)return a[1]<=a[3];d.assert(!1)};a.prototype._intersect=function(a,c,d){var e=0;0===d?e=(-a[3]-a[0])/(c[0]-a[0]+c[3]-a[3]):1===d?e=
(-a[3]-a[1])/(c[1]-a[1]+c[3]-a[3]):2===d?e=(a[3]-a[0])/(c[0]-a[0]-c[3]+a[3]):3===d&&(e=(a[3]-a[1])/(c[1]-a[1]-c[3]+a[3]));return b.lerp(a,c,e,b.create())};a.prototype._clipTriangle=function(a,b,c){a=[a,b,c];for(b=0;4>b;++b){c=a;a=[];for(var d=0;d<c.length;++d){var e=c[d],f=c[(d+1)%c.length];this._inside(f,b)?(this._inside(e,b)||a.push(this._intersect(e,f,b)),a.push(f)):this._inside(e,b)&&a.push(this._intersect(e,f,b))}}return a};return a}(),e=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,
7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],l=m.create(),p=k.create();return c})},"esri/views/3d/webgl-engine/lib/HighlightHelper":function(){define("require exports ./Util ./gl-matrix dojo/text!../materials/internal/highlight.xml ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations ../../support/debugFlags".split(" "),function(m,h,
d,c,a,b,k,f,g,e,l,p,v,q){var n=c.vec4d;return function(){function c(a,b,c){this._grid={coverageMipmap:null,vao:null,verticalCellCount:0,horizontalCellCount:0,cellPixelSize:0,mipmapLevels:0,viewportWidth:0,viewportHeight:0};this.blur1Fbo=this.blur0Fbo=this.quadVAO=null;this._rctx=c;this.viewportToRestore=n.create();this.programRep=a;this.defaultOptions={color:new Float32Array([1,0,1,1]),haloOpacity:1,fillOpacity:.2,haloOpacityOccluded:.25,fillOpacityOccluded:.05}}c.prototype._gridUpdateResources=function(a,
c){var d=this._rctx,e=this._grid,l=!1;null===e.coverageMipmap&&(e.coverageMipmap=[a],l=!0);if(e.viewportWidth!==a.width||e.viewportHeight!==a.height)l=!0,e.viewportWidth=a.width,e.viewportHeight=a.height;e.coverageMipmap[0]=a;e.cellPixelSize!==c&&(e.cellPixelSize=c,l=!0);if(l){for(c=1;c<e.coverageMipmap.length;c++)e.coverageMipmap[c].dispose();e.mipmapLevels=Math.ceil(Math.log(e.cellPixelSize)*Math.LOG2E);e.coverageMipmap.length=e.mipmapLevels+1;for(c=0;c<e.mipmapLevels;c++)l=e.coverageMipmap[c],
l=b.createWithAttachments(d,{target:3553,pixelFormat:6407,dataType:33635,samplingMode:9729,wrapMode:33071,width:Math.ceil(l.width/2),height:Math.ceil(l.height/2)},{colorTarget:0,depthStencilTarget:0,width:Math.ceil(l.width/2),height:Math.ceil(l.height/2)}),e.coverageMipmap[c+1]=l}var l=Math.ceil(a.height/e.cellPixelSize),k=Math.ceil(a.width/e.cellPixelSize);if(!e.vao||e.verticalCellCount!==l||e.horizontalCellCount!==k){e.verticalCellCount=l;e.horizontalCellCount=k;a=l+1;c=k+1;for(var l=1/l,k=1/k,
n=new Float32Array(24*a*c),h=0,q=0;q<a;q++)for(var t=0;t<c;t++)n[h+0]=(t-.5)*k*2-1,n[h+1]=(q-.5)*l*2-1,n[h+2]=t*k,n[h+3]=q*l,n[h+4]=(t+.5)*k*2-1,n[h+5]=(q-.5)*l*2-1,n[h+6]=t*k,n[h+7]=q*l,n[h+8]=(t-.5)*k*2-1,n[h+9]=(q+.5)*l*2-1,n[h+10]=t*k,n[h+11]=q*l,n[h+12]=(t-.5)*k*2-1,n[h+13]=(q+.5)*l*2-1,n[h+14]=t*k,n[h+15]=q*l,n[h+16]=(t+.5)*k*2-1,n[h+17]=(q-.5)*l*2-1,n[h+18]=t*k,n[h+19]=q*l,n[h+20]=(t+.5)*k*2-1,n[h+21]=(q+.5)*l*2-1,n[h+22]=t*k,n[h+23]=q*l,h+=24;e.vao&&e.vao.dispose(!0);e.vao=new f(d,v.Default3D,
{geometry:p.Pos2Tex},{geometry:g.createVertex(d,35044,n)})}};c.prototype._gridComputeMipmap=function(){var a=this._rctx,b=this._grid,c=this.programRep.get("conservative-downsample");a.bindVAO(this.quadVAO);for(var d=0;d<b.mipmapLevels;d++){a.bindFramebuffer(b.coverageMipmap[d+1]);a.bindTexture(b.coverageMipmap[d].colorTexture,0);var f=b.coverageMipmap[d+1].width,g=b.coverageMipmap[d+1].height;a.bindProgram(c);c.setUniform1i("tex",0);c.setUniform2f("invFramebufferDim",1/f,1/g);a.setViewport(0,0,f,
g);a.drawArrays(5,0,e.vertexCount(this.quadVAO,"geometry"))}};c.prototype.createQuadVAO=function(){var a=this._rctx,b=new Float32Array([-1,-1,1,-1,-1,1,1,1]);return new f(a,v.Default3D,{geometry:p.Pos2},{geometry:g.createVertex(a,35044,b)})};Object.defineProperty(c.prototype,"profilingCallback",{get:function(){return q.HIGHLIGHTS_PROFILE_TO_CONSOLE?function(a){return console.log(a)}:null},enumerable:!0,configurable:!0});c.prototype.getIsSupported=function(){return!0};c.prototype.setEnableState=function(a){a?
this.enable():this.disable()};c.prototype.getEnableState=function(){return null!==this.blur0Fbo};c.prototype.enable=function(){this.quadVAO=this.createQuadVAO();var a={colorTarget:0,depthStencilTarget:0,width:0,height:0},c={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0};this.blur0Fbo=b.createWithAttachments(this._rctx,c,a);this.blur1Fbo=b.createWithAttachments(this._rctx,c,a)};c.prototype.disable=function(){this.getEnableState()&&(this.quadVAO.dispose(!0),
this.blur1Fbo.dispose(),this.blur0Fbo.dispose(),this.blur1Fbo=this.blur0Fbo=this.quadVAO=null)};c.prototype.getHighlightFBO=function(){return this.blur0Fbo};c.prototype.render=function(a,b,c){var f=!q.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED,g=q.HIGHLIGHTS_VISUALIZE_BLOCKS,l=this._rctx;d.assert(this.getEnableState());n.set(a.fullViewport,this.viewportToRestore);a=Math.ceil(c.width/1);var k=Math.ceil(c.height/1);this.blur0Fbo.resize(a,k);this.blur1Fbo.resize(a,k);l.bindVAO(this.quadVAO);l.setDepthWriteEnabled(!1);
l.setDepthTestEnabled(!1);l.setBlendingEnabled(!1);var p=null,h=p=null,t=null;if(f){var r=this._grid;this._gridUpdateResources(c,32);this._gridComputeMipmap();h=r.vao;t=4;p=this.programRep.get("highlight-blur-grid-5");l.bindProgram(p);l.bindTexture(r.coverageMipmap[r.mipmapLevels].colorTexture,1);p.setUniform1i("coverageTex",1)}else h=this.quadVAO,t=5,p=this.programRep.get("highlight-blur-5"),l.bindProgram(p);l.bindVAO(h);l.bindFramebuffer(this.blur0Fbo);l.setViewport(0,0,a,k);l.setClearColor(0,0,
0,0);l.clear(l.gl.COLOR_BUFFER_BIT);p.setUniform1i("tex",0);l.bindTexture(c.colorTexture,0);p.setUniform2f("blurSize",1/a,0);l.drawArrays(t,0,e.vertexCount(h,"geometry"));l.bindFramebuffer(this.blur1Fbo);l.clear(l.gl.COLOR_BUFFER_BIT);l.bindTexture(this.blur0Fbo.colorTexture,0);p.setUniform2f("blurSize",0,1/k);l.drawArrays(t,0,e.vertexCount(h,"geometry"));l.bindFramebuffer(b);l.setBlendingEnabled(!0);l.setBlendFunctionSeparate(770,771,1,771);l.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],
this.viewportToRestore[2],this.viewportToRestore[3]);f?(p=this.programRep.get(g?"highlight-apply-grid-debug":"highlight-apply-grid"),l.bindProgram(p),p.setUniform1i("coverageTex",2),l.bindTexture(this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture,2)):(p=this.programRep.get("highlight-apply"),l.bindProgram(p));p.setUniform1i("tex",0);l.bindTexture(this.blur1Fbo.colorTexture,0);p.setUniform1i("origin",1);l.bindTexture(c.colorTexture,1);p.setUniform4fv("color",this.defaultOptions.color);
p.setUniform1f("outlineSize",8.6);p.setUniform1f("blurSize",.4);p.setUniform4f("opacities",this.defaultOptions.haloOpacity,this.defaultOptions.haloOpacityOccluded,this.defaultOptions.fillOpacity,this.defaultOptions.fillOpacityOccluded);l.drawArrays(t,0,e.vertexCount(h,"geometry"));l.bindVAO(null);l.setDepthWriteEnabled(!0);l.setDepthTestEnabled(!0);l.setBlendingEnabled(!1)};c.prototype.setDefaultOptions=function(a){this.defaultOptions=a};c.loadShaders=function(b,c,d,e){b._parse(a);c=0;for(var f=["3",
"5","7","9"];c<f.length;c++){var g=f[c];d.add("highlight-blur-"+g,new k(e,b.vsHighlightBlurFastGaussian,b.fsHighlightBlurFastGaussian,v.Default3D,{GAUSSIAN_SAMPLES:g}));d.add("highlight-blur-grid-"+g,new k(e,b.vsHighlightBlurFastGaussian,b.fsHighlightBlurFastGaussian,v.Default3D,{GAUSSIAN_SAMPLES:g,GRID_OPTIMIZATION:"true"}))}d.add("highlight-apply",new k(e,b.vsHighlightApply,b.fsHighlightApply,v.Default3D));d.add("highlight-apply-grid",new k(e,b.vsHighlightApply,b.fsHighlightApply,v.Default3D,["GRID_OPTIMIZATION"]));
d.add("highlight-apply-grid-debug",new k(e,b.vsHighlightApply,b.fsHighlightApply,v.Default3D,["GRID_OPTIMIZATION","GRID_DEBUG"]));d.add("conservative-downsample",new k(e,b.vsConservativeDownsample,b.fsConservativeDownsample,v.Default3D))};return c}()})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),function(m,h,d,c,a,b){m=
function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.SCENEVIEW_HITTEST_RETURN_SELECTOR=!1;b.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;b.HIGHLIGHTS_VISUALIZE_BLOCKS=!1;b.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;b.DECONFLICTOR_SHOW_OUTLINES=!1;b.DECONFLICTOR_SHOW_GRID=!1;b.LABELS_SHOW_BORDER=!1;return b}d(b,a);return b}(a.declared(b));c([a.property()],m.prototype,"SCENEVIEW_HITTEST_RETURN_SELECTOR",void 0);c([a.property()],m.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);c([a.property()],
m.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0);c([a.property()],m.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);c([a.property()],m.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0);c([a.property()],m.prototype,"DECONFLICTOR_SHOW_GRID",void 0);c([a.property()],m.prototype,"LABELS_SHOW_BORDER",void 0);m=c([a.subclass()],m);return new m})},"esri/views/3d/webgl-engine/materials/repository":function(){define("dojo/text!./internal/util.xml dojo/text!./internal/hud.xml ./BillboardMaterial ./ColorMaterial ./HUDMaterial ./LineCalloutMaterial ./LeafCardMaterial ./Material ./RibbonLineMaterial ./WaterMaterial ./internal/SimpleGLMaterial ./internal/TexOnlyGLMaterial ./internal/BlendLayers".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){return{initializeShaders:function(q,n,t,u){q._parse(m);q._parse(h);l.loadShaders(q,n,t,u);p.loadShaders(q,n,t,u);f.loadShaders(q,n,t,u);d.loadShaders(q,n,t,u);a.loadShaders(q,n,t,u);b.loadShaders(q,n,t,u);k.loadShaders(q,n,t,u);g.loadShaders(q,n,t,u);e.loadShaders(q,n,t,u);v.loadShaders(q,n,t,u);c.loadShaders(q,n,t,u)}}})},"esri/views/3d/webgl-engine/materials/BillboardMaterial":function(){define("dojo/text!./BillboardMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(m,h,d,c,a,b,k){var f=function(a,c){h.basicMaterialConstructor(this,c);var d=b.Pos3NormTex;this.getSize=function(){return 1.05};this.dispose=function(){};this.getTextureId=function(){return a};this.getOutputAmount=function(a){var b=k.getStride(d)/4;return a*b*6};this.getVertexBufferLayout=function(){return d};this.fillInterleaved=function(a,b,c,d,e,f){d=h.fill;var g=a.faces.indices.va,l=a.vertexAttr.va.data,k=a.vertexAttr.tc4.data,p=a.vertexAttr.n0.data,n=a.vertexAttr.n1.data,q=a.vertexAttr.n2.data;
a=a.vertexAttr.n3.data;for(var t=0;t<g.length;++t){var r=4*g[t],v=3*g[t];f+=d(l,r,e,f,b,3);f+=d(p,v,e,f,c,3);e[f++]=k[r];e[f++]=k[r+1];f+=d(l,r,e,f,b,3);f+=d(n,v,e,f,c,3);e[f++]=k[r+2]+1;e[f++]=k[r+1];f+=d(l,r,e,f,b,3);f+=d(q,v,e,f,c,3);e[f++]=k[r+2]+1;e[f++]=k[r+3]+1;f+=d(l,r,e,f,b,3);f+=d(q,v,e,f,c,3);e[f++]=k[r+2]+1;e[f++]=k[r+3]+1;f+=d(l,r,e,f,b,3);f+=d(a,v,e,f,c,3);e[f++]=k[r];e[f++]=k[r+3]+1;f+=d(l,r,e,f,b,3);f+=d(p,v,e,f,c,3);e[f++]=k[r];e[f++]=k[r+1]}};this.intersect=function(){};this.getGLMaterials=
function(){return{color:g,depthShadowMap:l,normal:void 0,depth:e,highlight:void 0}};this.getAllTextureIds=function(){return[a]}},g=function(a,b,c){h.basicGLMaterialConstructor(this,a);var e=d.TRANSPARENT_MATERIAL,f=b.get("billboard");h.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return e===a};this.getProgram=function(){return f};this.bind=function(a,b){a.bindProgram(f);this.bindTexture(a,f);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,
a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation);f.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},e=function(a,b,c,e){h.basicGLMaterialConstructor(this,a);var f=d.TRANSPARENT_MATERIAL,g=null==e?b.get("billboardDepth"):b.get("billboardDepthShadowMap");
h.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return f===a};this.getProgram=function(){return g};this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);g.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.detUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},l=function(a,b,c){e.call(this,
a,b,c,!0)};f.loadShaders=function(b,d,e,f){b._parse(m);var g=new c(f,b.vertexShaderBillboard,b.fragmentShaderBillboard,a.Default3D),l=d.get("fsDepthTextured");d=d.get("fsDepthTexturedShadowMap");l=new c(f,b.vertexShaderBillboardDepth,l.source,a.Default3D,l.defines);b=new c(f,b.vertexShaderBillboardDepth,d.source,a.Default3D,d.defines);e.add("billboard",g);e.add("billboardDepth",l);e.add("billboardDepthShadowMap",b)};return f})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("dojo/_base/lang dojo/text!./ColorMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../lib/Util ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(m,h,d,c,a,b,k,f,g){a=function(a,b){d.basicMaterialConstructor(this,b);a=a||{};a.color=a.color||[1,1,1,1];a.polygonOffset=a.polygonOffset||!1;a.vertexColors=a.vertexColors||!1;var c=f.Pos3Color;this.getParams=function(){return a};this.setColor=function(b){a.color=b;this.notifyDirty("matChanged")};this.getColor=function(){return a.color};this.setTransparent=function(b){a.transparent=b;this.notifyDirty("matChanged")};this.getTransparent=function(b){return a.transparent};this.dispose=function(){};
this.getOutputAmount=function(a){var b=g.getStride(c)/4;return a*b};this.getVertexBufferLayout=function(){return c};this.fillInterleaved=function(a,b,e,f,g,l,k){d.fillInterleaved(a,b,e,f,c,g,l,k)};this.intersect=d.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:e,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:l}};this.getAllTextureIds=function(){return[]}};var e=function(a,b,e){d.basicGLMaterialConstructor(this,a);var f=m.clone(a.getParams()),g=b.get("colorMaterial"),
l=a.getColor();this.beginSlot=function(a){return a===(1>l[3]?c.TRANSPARENT_MATERIAL:c.OPAQUE_MATERIAL)};this.getProgram=function(){return g};this.updateParameters=function(){f.color=a.getColor();f.transparent=a.getTransparent()};this.bind=function(a,b){a.bindProgram(g);g.setUniform4fv("eColor",f.color);a.setFaceCullingEnabled(!1);f.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1));f.transparent&&(a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,
a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA));a.setDepthTestEnabled(!0)};this.release=function(a){a.setPolygonOffsetFillEnabled(!1);f.transparent&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){d.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},l=function(a,b,e){d.basicGLMaterialConstructor(this,a);var f=m.clone(a.getParams()),g=b.get("colorMaterial"),l=[1,1,1,1];this.beginSlot=function(a){return a===
(1>l[3]?c.TRANSPARENT_MATERIAL:c.OPAQUE_MATERIAL)};this.getProgram=function(){return g};this.updateParameters=function(){f.color=a.getColor();f.transparent=a.getTransparent()};this.bind=function(a,b){a.bindProgram(g);g.setUniform4fv("eColor",f.color);a.setFaceCullingEnabled(!1);f.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1))};this.release=function(a){a.setPolygonOffsetFillEnabled(!1)};this.bindView=function(a,b){d.bindView(b.origin,b.view,g)};this.bindInstance=function(a,
b){g.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};a.programs=null;a.loadShaders=function(a,c,d,e){a._parse(h);a=new b(e,a.vertexShaderColorMaterial,a.fragmentShaderColorMaterial,k.Default3D);d.add("colorMaterial",a)};return a})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/text!./HUDMaterial.xml ./internal/MaterialUtil ../lib/Util ../../../webgl/Util ./internal/MaterialBase ./internal/GLMaterialTextureBase ../lib/gl-matrix ../lib/RenderSlot ../lib/ShaderVariations ../lib/ComponentUtils ../../support/aaBoundingRect ../lib/screenSizePerspectiveUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n){function t(a,b){void 0===b&&(b=G);if(a.textureIsSignedDistanceField){var c=a.anchorPos;a=a.distanceFieldBoundingBox;var d=b;d[0]=c[0]*(a[2]-a[0])+a[0];d[1]=c[1]*(a[3]-a[1])+a[1]}else u.set(a.anchorPos,b);return b}var u=e.vec2d,x=e.vec3d,r=e.mat3d,z=e.mat4d,B={"bottom-left":[0,0],bottom:[.5,0],"bottom-right":[1,0],left:[0,.5],center:[.5,.5],right:[1,.5],"top-left":[0,1],top:[.5,1],"top-right":[1,1]},C=[{name:"position",count:3,type:5126,offset:0,stride:76,normalized:!1},
{name:"normal",count:3,type:5126,offset:12,stride:76,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:76,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:76,normalized:!1},{name:"size",count:2,type:5126,offset:36,stride:76,normalized:!1},{name:"auxpos1",count:4,type:5126,offset:44,stride:76,normalized:!1},{name:"auxpos2",count:4,type:5126,offset:60,stride:76,normalized:!1}],A={texCoordScale:[1,1],occlusionTest:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,
1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,anchorPos:B.center,shaderPolygonOffset:1E-5,polygonOffset:!1,textureId:null,centerOffsetUnits:"world",
debugDrawBorder:!1};m=function(e){function f(b,c){c=e.call(this,c)||this;c._textureDirty=!1;c.params=a.copyParameters(b,A);"string"===typeof c.params.anchorPos&&(c.params.anchorPos=B[c.params.anchorPos]);return c}d(f,e);f.prototype.dispose=function(){};f.prototype.getParameterValues=function(){var a=this.params;return{color:a.color,texCoordScale:a.texCoordScale,polygonOffset:a.polygonOffset,anchorPos:a.anchorPos,screenOffset:a.screenOffset,verticalOffset:a.verticalOffset,screenSizePerspective:a.screenSizePerspective,
screenSizePerspectiveAlignment:a.screenSizePerspectiveAlignment,shaderPolygonOffset:a.shaderPolygonOffset,textureIsSignedDistanceField:a.textureIsSignedDistanceField,outlineColor:a.outlineColor,outlineSize:a.outlineSize,distanceFieldBoundingBox:a.distanceFieldBoundingBox,vvSizeEnabled:a.vvSizeEnabled,vvSizeMinSize:a.vvSizeMinSize,vvSizeMaxSize:a.vvSizeMaxSize,vvSizeOffset:a.vvSizeOffset,vvSizeFactor:a.vvSizeFactor,vvColorEnabled:a.vvColorEnabled,vvColorValues:a.vvColorValues,vvColorColors:a.vvColorColors,
textureId:a.textureId,occlusionTest:a.occlusionTest,centerOffsetUnits:a.centerOffsetUnits,debugDrawBorder:a.debugDrawBorder,drawInSecondSlot:a.drawInSecondSlot}};f.prototype.setParameterValues=function(a){for(var c in a)"textureId"===c&&b.assert(!!this.params.textureId,"Can only change texture of material that already has a texture"),this.params[c]=a[c];this.notifyDirty("matChanged")};f.prototype.getParams=function(){return this.params};f.prototype.getOutputAmount=function(a){return 114*a};f.prototype.getInstanceBufferLayout=
function(){};f.prototype.getVertexBufferLayout=function(){return C};f.prototype.fillInterleaved=function(c,d,e,f,g,l){var p=4*l,n=c.faces.indices[b.VertexAttrConstants.POSITION],h=c.vertexAttr[b.VertexAttrConstants.POSITION].data,q=l+k.findAttribute(C,b.VertexAttrConstants.POSITION).offset/4;for(f=0;f<n.length;++f){var t=3*n[f];a.fill(h,t,g,q,d,3);q+=19;a.fill(h,t,g,q,d,3);q+=19;a.fill(h,t,g,q,d,3);q+=19;a.fill(h,t,g,q,d,3);q+=19;a.fill(h,t,g,q,d,3);q+=19;a.fill(h,t,g,q,d,3);q+=19}d=c.faces.indices[b.VertexAttrConstants.NORMAL];
h=c.vertexAttr[b.VertexAttrConstants.NORMAL].data;q=l+k.findAttribute(C,b.VertexAttrConstants.NORMAL).offset/4;for(f=0;f<d.length;++f)t=3*d[f],a.fill(h,t,g,q,e,3),q+=19,a.fill(h,t,g,q,e,3),q+=19,a.fill(h,t,g,q,e,3),q+=19,a.fill(h,t,g,q,e,3),q+=19,a.fill(h,t,g,q,e,3),q+=19,a.fill(h,t,g,q,e,3),q+=19;f=c.vertexAttr[b.VertexAttrConstants.UV0].data;null==f||3>=f.length?(e=t=0,d=this.params.texCoordScale[0],h=this.params.texCoordScale[1]):(t=c.vertexAttr[b.VertexAttrConstants.UV0].data[0],e=c.vertexAttr[b.VertexAttrConstants.UV0].data[1],
d=c.vertexAttr[b.VertexAttrConstants.UV0].data[2],h=c.vertexAttr[b.VertexAttrConstants.UV0].data[3]);d=Math.min(1.99999,d+1);h=Math.min(1.99999,h+1);q=l+k.findAttribute(C,b.VertexAttrConstants.UV0).offset/4;for(f=0;f<n.length;++f)g[q]=t,g[q+1]=e,q+=19,g[q]=d,g[q+1]=e,q+=19,g[q]=d,g[q+1]=h,q+=19,g[q]=d,g[q+1]=h,q+=19,g[q]=t,g[q+1]=h,q+=19,g[q]=t,g[q+1]=e,q+=19;n=c.faces.indices[b.VertexAttrConstants.COLOR];e=c.vertexAttr[b.VertexAttrConstants.COLOR].data;p+=k.findAttribute(C,b.VertexAttrConstants.COLOR).offset;
d=new Uint8Array(g.buffer);for(f=0;f<n.length;++f)t=4*n[f],a.fill(e,t,d,p,null,4),p+=76,a.fill(e,t,d,p,null,4),p+=76,a.fill(e,t,d,p,null,4),p+=76,a.fill(e,t,d,p,null,4),p+=76,a.fill(e,t,d,p,null,4),p+=76,a.fill(e,t,d,p,null,4),p+=76;t=c.faces.indices[b.VertexAttrConstants.SIZE];p=c.vertexAttr[b.VertexAttrConstants.SIZE].data;n=l+k.findAttribute(C,b.VertexAttrConstants.SIZE).offset/4;for(f=0;f<t.length;++f)e=p[2*t[f]],d=p[2*t[f]+1],g[n]=e,g[n+1]=d,n+=19,g[n]=e,g[n+1]=d,n+=19,g[n]=e,g[n+1]=d,n+=19,
g[n]=e,g[n+1]=d,n+=19,g[n]=e,g[n+1]=d,n+=19,g[n]=e,g[n+1]=d,n+=19;if(null!=c.faces.indices[b.VertexAttrConstants.AUXPOS1]&&null!=c.vertexAttr[b.VertexAttrConstants.AUXPOS1])for(p=c.faces.indices[b.VertexAttrConstants.AUXPOS1],n=c.vertexAttr[b.VertexAttrConstants.AUXPOS1].data,e=l+k.findAttribute(C,"auxpos1").offset/4,f=0;f<p.length;++f)t=4*p[f],a.fill(n,t,g,e,null,4),e+=19,a.fill(n,t,g,e,null,4),e+=19,a.fill(n,t,g,e,null,4),e+=19,a.fill(n,t,g,e,null,4),e+=19,a.fill(n,t,g,e,null,4),e+=19,a.fill(n,
t,g,e,null,4),e+=19;if(null!=c.faces.indices[b.VertexAttrConstants.AUXPOS2]&&null!=c.vertexAttr[b.VertexAttrConstants.AUXPOS2])for(p=c.faces.indices[b.VertexAttrConstants.AUXPOS2],c=c.vertexAttr[b.VertexAttrConstants.AUXPOS2].data,l+=k.findAttribute(C,"auxpos2").offset/4,f=0;f<p.length;++f)t=4*p[f],a.fill(c,t,g,l,null,4),l+=19,a.fill(c,t,g,l,null,4),l+=19,a.fill(c,t,g,l,null,4),l+=19,a.fill(c,t,g,l,null,4),l+=19,a.fill(c,t,g,l,null,4),l+=19,a.fill(c,t,g,l,null,4),l+=19};f.prototype.intersect=function(a,
c,d,e,f,g,l,k){if(e.isSelection&&e.enableHUDSelection&&!v.isAllHidden(c.componentVisibilities,a.data.componentOffsets)){c=this.params;g=f=1;k&&(g=k(X),f=g[0],g=g[5]);k=a.getData().getVertexAttr()[b.VertexAttrConstants.POSITION];var p=a.getData().getVertexAttr()[b.VertexAttrConstants.SIZE];a=a.getData().getVertexAttr()[b.VertexAttrConstants.NORMAL];b.assert(3<=k.size);for(var h=e.point,q=e.camera,r=t(c),u=0;u<k.data.length/k.size;u++){var m=u*k.size;x.set3(k.data[m],k.data[m+1],k.data[m+2],J);z.multiplyVec3(d,
J,J);m=u*p.size;V[0]=p.data[m]*f;V[1]=p.data[m+1]*g;z.multiplyVec3(q.viewMatrix,J);m=u*a.size;x.set3(a.data[m],a.data[m+1],a.data[m+2],I);this.applyVerticalOffsetTransformation(J,I,d,q,H);q.applyProjection(J,F);if(-1<F[0]){var m=Math.floor(F[0]),B=Math.floor(F[1]);n.applyPrecomputedScaleFactorVec2(V,H.factor,V);var m=m-T-(0<r[0]?V[0]*r[0]:0),C=m+V[0]+2*T,B=B-T-(0<r[1]?V[1]*r[1]:0),D=B+V[1]+2*T;if(c.textureIsSignedDistanceField)var A=c.outlineSize/2,E=c.distanceFieldBoundingBox,m=m+V[0]*E[0],B=B+V[1]*
E[1],C=C-V[0]*(1-E[2]),D=D-V[1]*(1-E[3]),m=m-A,C=C+A,B=B-A,D=D+A;h[0]>m&&h[0]<C&&h[1]>B&&h[1]<D&&(C=e.p0,B=e.p1,z.multiplyVec3(z.inverse(q.viewMatrix,K),J,L),F[0]=h[0],F[1]=h[1],q.unprojectPoint(F,J),m=x.negate(e.getDirection(),x.create()),C=x.dist(C,J)/x.dist(C,B),l(C,m,-1,1,!0,L))}}}};f.prototype.normalAndViewAngle=function(a,b,c,d){void 0===d&&(d=ba);r.multiplyVec3(z.toMat3(b,M),a,d.normal);z.multiplyVec3(c.viewInverseTransposeMatrix,d.normal);d.cosAngle=x.dot(N,P);return d};f.prototype.updateScaleInfo=
function(a,b,c){b=this.params;b.screenSizePerspective?a.factor=n.precomputeScaleFactor(ba.cosAngle,c,b.screenSizePerspective,a.factor):(a.factor.scale=1,a.factor.factor=0,a.factor.minPixelSize=0,a.factor.paddingPixels=0);b.screenSizePerspectiveAlignment?(a.scaleAlignment=n.precomputeScale(ba.cosAngle,c,b.screenSizePerspectiveAlignment),a.minPixelSizeAlignment=b.screenSizePerspectiveAlignment.parameters.minPixelSize):(a.scaleAlignment=a.factor.scale,a.minPixelSizeAlignment=a.factor.minPixelSize)};
f.prototype.applyVerticalOffsetTransformation=function(b,c,d,e,f,g){var l=this.params;if(!l.verticalOffset||!l.verticalOffset.screenLength)return f&&(l.screenSizePerspective||l.screenSizePerspectiveAlignment)?(e=this.normalAndViewAngle(c,d,e),l=x.length(b),this.updateScaleInfo(f,e.cosAngle,l)):f&&(f.factor.scale=1,f.scaleAlignment=1),g?x.set(b,g):b;c=this.normalAndViewAngle(c,d,e);d=x.length(b);e=a.verticalOffsetAtDistance(e,d,l.verticalOffset,c.cosAngle,l.screenSizePerspectiveAlignment||l.screenSizePerspective);
f&&this.updateScaleInfo(f,c.cosAngle,d);return x.add(b,x.scale(c.normal,e),g)};f.prototype.getGLMaterials=function(){return{color:D,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:E}};f.prototype.getAllTextureIds=function(){return[this.params.textureId]};f.prototype.setTextureDirty=function(){this._textureDirty=!0};f.prototype.calculateRelativeScreenBounds=function(a,b,c){void 0===c&&(c=q.create());var d=this.params,e=c;void 0===e&&(e=G);u.set(d.anchorPos,e);e[0]*=-a[0];e[1]*=-a[1];e[0]+=
d.screenOffset[0]*b;e[1]+=d.screenOffset[1]*b;c[2]=c[0]+a[0];c[3]=c[1]+a[1];return c};f.prototype.calculateAnchorPosForRendering=function(a){return t(this.params,a)};f.loadShaders=function(a,b,d,e){a._parse(c);var f=function(a){a.addDefine("OcclTest","OCCL_TEST");a.addDefine("SDF","SIGNED_DISTANCE_FIELD");a.addDefine("vvSize","VV_SIZE");a.addDefine("vvColor","VV_COLOR");a.addDefine("verticalOffset","VERTICAL_OFFSET");a.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");a.addDefine("centerOffsetUnitsScreen",
"CENTER_OFFSET_UNITS_SCREEN")},g=new p("hud",["vertexShaderHUD","fragmentShaderHUD"],null,d,b,a,e);f(g);g.addDefine("debugDrawBorder","DEBUG_DRAW_BORDER");d.addShaderVariations("hud-material-shader-variations",g);g=new p("hudHighlight",["vertexShaderHUD","fragmentShaderHUDHighlight"],null,d,b,a,e);f(g);d.addShaderVariations("hud-material-highlight-shader-variations",g);a=new p("hudOcclusionTestPixel",["vertexShaderOcclusionTestPixel","fragmentShaderSimple"],null,d,b,a,e);a.addDefine("verticalOffset",
"VERTICAL_OFFSET");a.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");a.addDefine("centerOffsetUnitsScreen","CENTER_OFFSET_UNITS_SCREEN");d.addShaderVariations("hud-material-occlusion-test-pixel-shader-variations",a)};return f}(f.MaterialBase);g=function(b){function c(c,d,e){e=b.call(this,c,c.getParams(),d,e)||this;e.programRep=d;e.params=a.copyParameters(c.getParams());e.selectProgram();e.selectSlot();return e}d(c,b);c.prototype.selectSlot=function(){this.mainSlot=this.params.drawInSecondSlot?
l.HUDMATERIAL2:l.HUDMATERIAL1};c.prototype.beginSlot=function(a){return a===this.mainSlot};c.prototype.getProgram=function(){return this.program};c.prototype.getAllPrograms=function(){return[this.program]};c.prototype.updateParameters=function(){var a=this.material.getParams(),b=this.params;b.color=a.color;b.texCoordScale=a.texCoordScale;b.polygonOffset=a.polygonOffset;b.anchorPos=a.anchorPos;b.screenOffset=a.screenOffset;b.verticalOffset=a.verticalOffset;b.screenSizePerspective=a.screenSizePerspective;
b.screenSizePerspectiveAlignment=a.screenSizePerspectiveAlignment;b.shaderPolygonOffset=a.shaderPolygonOffset;b.textureIsSignedDistanceField=a.textureIsSignedDistanceField;b.outlineColor=a.outlineColor;b.outlineSize=a.outlineSize;b.vvSizeEnabled=a.vvSizeEnabled;b.vvSizeMinSize=a.vvSizeMinSize;b.vvSizeMaxSize=a.vvSizeMaxSize;b.vvSizeOffset=a.vvSizeOffset;b.vvSizeFactor=a.vvSizeFactor;b.vvColorEnabled=a.vvColorEnabled;b.vvColorValues=a.vvColorValues;b.vvColorColors=a.vvColorColors;this.updateTexture(a.textureId);
this.selectProgram();this.selectSlot()};c.prototype.bindRender=function(a,b){var c=this.params,d=this.getProgram();this.bindTexture(a,d);d.setUniform1i("hudVisibilityTexture",1);a.bindTexture(b.hudVisibilityTexture,1);a.setActiveTexture(0);d.setUniform4fv("overrideColor",c.color);d.setUniform1f("pixelRatio",b.pixelRatio);c.textureIsSignedDistanceField&&(d.setUniform4fv("outlineColor",c.outlineColor),d.setUniform1f("outlineSize",c.outlineSize));c.vvSizeEnabled&&(d.setUniform3fv("vvSizeMinSize",c.vvSizeMinSize),
d.setUniform3fv("vvSizeMaxSize",c.vvSizeMaxSize),d.setUniform3fv("vvSizeOffset",c.vvSizeOffset),d.setUniform3fv("vvSizeFactor",c.vvSizeFactor));c.vvColorEnabled&&(d.setUniform1fv("vvColorValues",c.vvColorValues),d.setUniform4fv("vvColorColors",c.vvColorColors));d.setUniform2fv("texScale",c.texCoordScale);d.setUniform2f("screenOffset",2*c.screenOffset[0],2*c.screenOffset[1]);d.setUniform2fv("anchorPos",t(c));c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0);
a.setBlendFunction(1,771)};c.prototype.bindProjection=function(b,c){this.material._textureDirty&&(this.renderTexture(b),this.material._textureDirty=!1);var d=c.cameraAboveGround?1:-1,e=this.getProgram(),f=this.params;b.bindProgram(e);e.setUniform1f("cameraGroundRelative",d);e.setUniform1f("polygonOffset",f.shaderPolygonOffset);e.setUniform4fv("viewport",c.viewport);a.bindVerticalOffset(f.verticalOffset,c,e);e.setUniformMatrix4fv("viewNormal",c.viewInvTransp);f.screenSizePerspective&&(a.bindScreenSizePerspective(f.screenSizePerspective,
e,"screenSizePerspective"),a.bindScreenSizePerspective(f.screenSizePerspectiveAlignment||f.screenSizePerspective,e,"screenSizePerspectiveAlignment"))};c.prototype.releaseRender=function(a){a.setPolygonOffsetFillEnabled(!1);a.setBlendFunction(770,771);a.setBlendingEnabled(!1)};c.prototype.bindView=function(b,c){b=c.origin;var d=this.getProgram();a.bindView(b,c.view,d);a.bindCamPos(b,c.viewInvTransp,d)};c.prototype.bindInstance=function(a,b){a=this.getProgram();a.setUniformMatrix4fv("model",b.transformation);
a.setUniformMatrix4fv("modelNormal",b.transformationNormal)};c.prototype.getDrawMode=function(a){return a.gl.TRIANGLES};return c}(g.GLMaterialTextureBase);var D=function(a){function b(b,c,d){b=a.call(this,b,c,d)||this;b.isOcclusionSlot=!1;return b}d(b,a);b.prototype.selectProgram=function(){var a=this.params;this.programOcclusionTestPixel=this.programRep.getShaderVariationsProgram("hud-material-occlusion-test-pixel-shader-variations",[!!a.verticalOffset,!!a.screenSizePerspective,"screen"===a.centerOffsetUnits]);
this.program=this.programRep.getShaderVariationsProgram("hud-material-shader-variations",[a.occlusionTest,a.textureIsSignedDistanceField,!!a.vvSizeEnabled,!!a.vvColorEnabled,!!a.verticalOffset,!!a.screenSizePerspective,"screen"===a.centerOffsetUnits,!!a.debugDrawBorder])};b.prototype.getDrawMode=function(a){a=a.gl;return this.isOcclusionSlot?a.POINTS:a.TRIANGLES};b.prototype.release=function(a){a.setDepthFunction(a.gl.LESS);this.isOcclusionSlot||this.releaseRender(a)};b.prototype.bind=function(a,
b){var c=a.gl;this.bindProjection(a,b);var d=this.getProgram();a.setDepthFunction(c.LEQUAL);this.isOcclusionSlot?d.setUniform4f("color",1,1,1,1):(this.bindRender(a,b),this.bindTexture(a,d))};b.prototype.getProgram=function(){return this.isOcclusionSlot?this.programOcclusionTestPixel:this.program};b.prototype.getAllPrograms=function(){return[this.programOcclusionTestPixel,this.program]};b.prototype.beginSlot=function(a){if(this.params.occlusionTest)return this.isOcclusionSlot=a===l.OCCLUSION_PIXELS,
a===l.OCCLUSION_PIXELS||a===this.mainSlot;this.isOcclusionSlot=!1;return a===this.mainSlot};return b}(g),E=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.prototype.selectProgram=function(){var a=this.params;this.program=this.programRep.getShaderVariationsProgram("hud-material-highlight-shader-variations",[a.occlusionTest,a.textureIsSignedDistanceField,!!a.vvSizeEnabled,!!a.vvColorEnabled,!!a.verticalOffset,!!a.screenSizePerspective,"screen"===a.centerOffsetUnits])};
b.prototype.bind=function(a,b){this.bindProjection(a,b);this.bindRender(a,b)};b.prototype.release=function(a){this.releaseRender(a)};return b}(g),H={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},scaleAlignment:0,minPixelSizeAlignment:0},G=[0,0],J=x.create(),I=x.create(),F=x.create(),N=x.create(),L=x.create(),M=r.create(),K=z.create(),ba={normal:N,cosAngle:0},X=z.create();z.identity(X);var T=1,V=[0,0],P=[0,0,1];return m})},"esri/views/3d/webgl-engine/materials/internal/MaterialBase":function(){define(["require",
"exports","./MaterialUtil","../../lib/ModelContentType"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function a(a){this.visible=!0;this.renderPriority=0;this.parentStage=null;this.id=d.__Material_idGen.gen(a)}a.prototype.getId=function(){return this.id};a.prototype.getParentStage=function(){return this.parentStage};a.prototype.addParentStage=function(a){this.parentStage=a};a.prototype.removeParentStage=function(a){this.parentStage=null};a.prototype.setVisible=function(a){this.visible!==
a&&(this.visible=a,this.notifyDirty("matChanged"))};a.prototype.isVisible=function(){return this.visible};a.prototype.notifyDirty=function(a){this.parentStage&&this.parentStage.notifyDirty(c.MATERIAL,this,a)};a.prototype.setRenderPriority=function(a){this.renderPriority=a;this.notifyDirty("matChanged")};a.prototype.getRenderPriority=function(){return this.renderPriority};return a}();h.MaterialBase=m;h.default=m})},"esri/views/3d/webgl-engine/materials/internal/GLMaterialTextureBase":function(){define(["require",
"exports","../../../../../core/tsSupport/extendsHelper","./GLMaterialBase","./MaterialUtil"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(b){function c(c,d,e,l,k){void 0===k&&(k=!1);c=b.call(this,c,e,l)||this;c.params=d;c.textureRep=l;c.initTransparent=k;c.glTextureRef=a.aquireIfNotUndefined(d.textureId,d.initTexture,l,k);return c}d(c,b);c.prototype.updateTexture=function(b){var c=this.params;c.textureId!==b&&(a.releaseIfNotUndefined(c.textureId,this.textureRep),
c.textureId=b,this.glTextureRef=a.aquireIfNotUndefined(c.textureId,c.initTexture,this.textureRep,this.initTransparent))};c.prototype.renderTexture=function(a){(a=this.textureRep.getTexture(this.params.textureId))&&a.dirty&&a.redraw&&a.redraw()};c.prototype.bindTexture=function(a,b){null!=this.glTextureRef&&(b.setUniform1i("tex",0),a.bindTexture(this.glTextureRef.getGLTexture()))};c.prototype.bindTextureSize=function(a,b){null!=this.glTextureRef&&(a=this.glTextureRef.getGLTexture(),b.setUniform2f("texSize",
a.descriptor.width,a.descriptor.height))};c.prototype.dispose=function(){a.releaseIfNotUndefined(this.params.textureId,this.textureRep)};return c}(c.default);h.GLMaterialTextureBase=m;h.default=m})},"esri/views/3d/webgl-engine/materials/internal/GLMaterialBase":function(){define(["require","exports","./MaterialUtil"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function c(a,b,c){this.id=d.__GLMaterial_id++;this.material=a}c.prototype.getId=function(){return this.id};
c.prototype.getMaterialId=function(){return this.material.getId()};c.prototype.isVisible=function(){return this.material.isVisible()};c.prototype.getRenderPriority=function(){return this.material.getRenderPriority()};return c}();h.GLMaterialBase=m;h.default=m})},"esri/views/3d/webgl-engine/lib/ShaderVariations":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ./Util ../../../webgl/Program ./DefaultVertexAttributeLocations".split(" "),function(m,h,d,c,a,b,
k){return function(){function d(b,c,d,f,k,h,n){this.variables=[];this.sealed=!1;this.programCache={};a.assert(2===c.length,"you must specify shader snippet prefixes for vertex and fragment shaders");this.programNamePrefix=b;this.shaderSnippetPrefixes=c;this.baseDefines=d;this.programRep=f;this.shaderRep=k;this.snippets=h;this.rctx=n;this.baseDefines=d?d.slice():[]}d.prototype.addDefine=function(b,c,d,f){a.assert(!this.sealed,"you cannot add another variable after the first program has been generated");
a.assert(!!b,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",b],shaderNameSuffixes:f||b,defineStr:c,affectsShaderTypes:d||[!0,!0]})};d.prototype.addBinaryShaderSnippetSuffix=function(b,c,d){a.assert(!this.sealed,"you cannot add another variable after the first program has been generated");a.assert(!!b,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",b],shaderSnippetSuffixes:["",c],affectsShaderTypes:d||[!0,!0]})};d.prototype.addNaryShaderSnippetSuffix=
function(b,c){a.assert(!this.sealed,"you cannot add another variable after the first program has been generated");var d=b.map(function(b){a.assert(null!=b.value,"value must always be specified");return b.value});this.variables.push({values:d,programNameSuffixes:b.map(function(a,b){return null!=a.programNameSuffix?a.programNameSuffix:d[b]}),shaderSnippetSuffixes:b.map(function(a,b){return null!=a.shaderSnippetSuffix?a.shaderSnippetSuffix:d[b]}),affectsShaderTypes:c||[!0,!0]})};d.prototype.getShaderVariation=
function(b){a.assert(b.length===this.variables.length,"you must specify a value for each variable");for(var d=this.programNamePrefix,f=c.clone(this.shaderSnippetPrefixes),g=c.clone(this.shaderSnippetPrefixes),k=c.clone(this.baseDefines),h=0;h<this.variables.length;h++){var n=this.variables[h],t=b[h],u=void 0;n.values?(u=n.values.indexOf(t.toString()),a.assert(0<=u,"invalid value "+t+" for variable "+h)):u=t?1:0;d+=n.programNameSuffixes[u];for(t=0;2>t;t++)n.affectsShaderTypes[t]&&(n.shaderSnippetSuffixes&&
(f[t]+=n.shaderSnippetSuffixes[u],g[t]+=n.shaderSnippetSuffixes[u]),n.defineStr&&u&&(k.push(n.defineStr),g[t]+=n.shaderNameSuffixes))}return{programName:d,shaderSnippetNames:f,shaderNames:g,defines:k}};d.prototype.getProgram=function(c,d,f){void 0===d&&(d=this.snippets);void 0===f&&(f=this.rctx);this.sealed=!0;var e=c.reduce(function(a,b){return a+b.toString()},"");if(this.programCache[e])return this.programCache[e];c=this.getShaderVariation(c);var g=this.programRep.get(c.programName);if(g)return g;
var l=c.shaderSnippetNames[0],g=d[l];a.assert(null!=g,"shader snippet '"+l+"' does not exist");l=c.shaderSnippetNames[1];d=d[l];a.assert(null!=d,"shader snippet '"+l+"' does not exist");g=new b(f,g,d,k.Default3D,c.defines);this.programCache[e]=g;this.programRep.add(c.programName,g);return g};return d}()})},"esri/views/3d/webgl-engine/materials/LineCalloutMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/text!./LineCalloutMaterial.xml ./internal/MaterialUtil ../lib/Util ../../../webgl/Util ./internal/MaterialBase ./internal/GLMaterialBase ../lib/RenderSlot ../lib/ShaderVariations".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){function p(a,b,c){3===c.length?a.setUniform4f(b,c[0],c[1],c[2],1):a.setUniform4fv(b,c)}var v=b.VertexAttrConstants,q=[{name:"position",count:3,type:5126,offset:0,stride:48,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:48,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:48,normalized:!1},{name:"auxpos1",count:4,type:5126,offset:32,stride:48,normalized:!1}],n={verticalOffset:null,screenSizePerspective:null,screenOffset:[0,0],color:[0,0,
0,1],size:1,borderColor:null,occlusionTest:!1,shaderPolygonOffset:1E-5,depthHUDAlignStart:!1,centerOffsetUnits:"world"};m=function(b){function e(c,d){d=b.call(this,d)||this;d.params=a.copyParameters(c,n);d._uniqueMaterialIdentifier=e.uniqueMaterialIdentifier(d.params);return d}d(e,b);Object.defineProperty(e.prototype,"uniqueMaterialIdentifier",{get:function(){return this._uniqueMaterialIdentifier},enumerable:!0,configurable:!0});e.prototype.dispose=function(){};e.prototype.getGLMaterials=function(){return{color:t,
depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};e.prototype.getAllTextureIds=function(){return[]};e.prototype.fillAttributeData=function(b,c,d,e,f,g){var l=b.faces.indices[c];b=b.vertexAttr[c].data;if(l&&b)for(c=d+k.findAttribute(q,c).offset/4,d=0;d<l.length;d++)for(var p=e*l[d],n=0;6>n;n++)a.fill(b,p,g,c,f,e),c+=12};e.prototype.fillInterleaved=function(a,b,c,d,e,f,g){this.fillAttributeData(a,v.POSITION,f,3,b,e);this.fillAttributeData(a,v.NORMAL,f,3,c,e);this.fillAttributeData(a,
v.AUXPOS1,f,4,null,e);a=f+k.findAttribute(q,v.UV0).offset/4;b=0;for(c=u;b<c.length;b++)d=c[b],e[a+0]=d[0],e[a+1]=d[1],a+=12};e.prototype.getOutputAmount=function(a){return 288*a};e.prototype.getInstanceBufferLayout=function(){};e.prototype.getVertexBufferLayout=function(){return q};e.prototype.intersect=function(a,b,c,d,e,f,g,l){};e.prototype.getParameterValues=function(){var a=this.params;return{verticalOffset:a.verticalOffset,screenSizePerspective:a.screenSizePerspective,screenOffset:a.screenOffset,
centerOffsetUnits:a.centerOffsetUnits,color:[a.color[0],a.color[1],a.color[2],a.color[3]],size:a.size,borderColor:a.borderColor,occlusionTest:a.occlusionTest,shaderPolygonOffset:a.shaderPolygonOffset,depthHUDAlignStart:a.depthHUDAlignStart}};e.prototype.setParameterValues=function(a){var b=!1,c;for(c in a){var d=a[c];void 0!==d&&(b=!0,Array.isArray(d)?this.params[c]=d.slice():this.params[c]=d)}b&&(this._uniqueMaterialIdentifier=e.uniqueMaterialIdentifier(this.params),this.notifyDirty("matChanged"))};
e.uniqueMaterialIdentifier=function(a){return JSON.stringify({screenOffset:a.screenOffset||[0,0],centerOffsetUnits:a.centerOffsetUnits||"world"})};e.loadShaders=function(a,b,d,e){a._parse(c);a=new l("lineCallout",["vertexShaderLineCallout","fragmentShaderLineCallout"],null,d,b,a,e);a.addDefine("occlTest","OCCL_TEST");a.addDefine("verticalOffset","VERTICAL_OFFSET");a.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");a.addDefine("depthHud","DEPTH_HUD");a.addDefine("depthHudAlignStart","DEPTH_HUD_ALIGN_START");
a.addDefine("centerOffsetUnitsScreen","CENTER_OFFSET_UNITS_SCREEN");d.addShaderVariations("line-callout-material-shader-variations",a)};return e}(f.MaterialBase);var t=function(b){function c(a,c,d){a=b.call(this,a,c,d)||this;a.isRenderSlot=!0;a.programRep=c;a.updateParameters();return a}d(c,b);c.prototype.updateParameters=function(){this.params=this.material.getParameterValues();this.selectProgram()};c.prototype.selectProgram=function(){var a=this.params;this.renderProgram=this.programRep.getShaderVariationsProgram("line-callout-material-shader-variations",
[!!a.occlusionTest,!!a.verticalOffset,!!a.screenSizePerspective,!1,!!a.depthHUDAlignStart,"screen"===a.centerOffsetUnits]);this.depthProgram=this.programRep.getShaderVariationsProgram("line-callout-material-shader-variations",[!!a.occlusionTest,!!a.verticalOffset,!!a.screenSizePerspective,!0,!!a.depthHUDAlignStart,"screen"===a.centerOffsetUnits])};c.prototype.beginSlot=function(a){switch(a){case e.LINE_CALLOUTS:return this.isRenderSlot=!0;case e.LINE_CALLOUTS_HUD_DEPTH:return this.isRenderSlot=!1,
!0}return!1};Object.defineProperty(c.prototype,"program",{get:function(){return this.isRenderSlot?this.renderProgram:this.depthProgram},enumerable:!0,configurable:!0});c.prototype.getAllPrograms=function(){return[this.renderProgram,this.depthProgram]};c.prototype.getProgram=function(){return this.program};c.prototype.getDrawMode=function(a){return a.gl.TRIANGLES};c.prototype.bind=function(b,c){var d=c.cameraAboveGround?1:-1,e=this.program,f=this.params;b.bindProgram(e);e.setUniform1f("cameraGroundRelative",
d);e.setUniform1f("polygonOffset",f.shaderPolygonOffset);e.setUniform4fv("viewport",c.viewport);e.setUniformMatrix4fv("viewNormal",c.viewInvTransp);e.setUniform1i("hudVisibilityTexture",0);b.bindTexture(c.hudVisibilityTexture,0);p(e,"color",f.color);e.setUniform2f("screenOffset",f.screenOffset[0],f.screenOffset[1]);this.bindBorder(b,c);a.bindVerticalOffset(f.verticalOffset,c,e);this.bindSizing(b,c);a.bindScreenSizePerspective(f.screenSizePerspective,e);this.isRenderSlot?this.bindRender(b,c):this.bindHUDDepth(b,
c)};c.prototype.bindRender=function(a,b){a.setBlendFunctionSeparate(1,771,770,771);a.setBlendingEnabled(!0);a.setDepthWriteEnabled(!1)};c.prototype.bindHUDDepth=function(a,b){a.setColorMask(!1,!1,!1,!1);a.setDepthWriteEnabled(!0);a.setBlendingEnabled(!1);a.setDepthTestEnabled(!0)};c.prototype.bindView=function(b,c){b=this.program;a.bindView(c.origin,c.view,b);a.bindCamPos(c.origin,c.viewInvTransp,b)};c.prototype.bindInstance=function(a,b){a=this.program;a.setUniformMatrix4fv("model",b.transformation);
a.setUniformMatrix4fv("modelNormal",b.transformationNormal)};c.prototype.release=function(a,b){this.isRenderSlot?this.releaseRender(a,b):this.releaseHUDDepth(a,b)};c.prototype.releaseRender=function(a,b){a.setBlendingEnabled(!1);a.setBlendFunction(770,771);a.setDepthWriteEnabled(!0)};c.prototype.releaseHUDDepth=function(a,b){a.setColorMask(!0,!0,!0,!0)};c.prototype.bindSizing=function(a,b){a=this.program;var c=this.params;a.setUniform2f("pixelToNDC",2/b.viewport[2],2/b.viewport[3]);a.setUniform1f("lineSize",
Math.ceil(c.size))};c.prototype.bindBorder=function(a,b){a=this.program;b=this.params;null!==b.borderColor?(p(a,"borderColor",b.borderColor),a.setUniform1f("borderSize",1)):(a.setUniform4f("borderColor",0,0,0,0),a.setUniform1f("borderSize",0))};return c}(g.GLMaterialBase),u=[[0,0],[1,0],[0,1],[1,0],[1,1],[0,1]];return m})},"esri/views/3d/webgl-engine/materials/LeafCardMaterial":function(){define("dojo/text!./LeafCardMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../../../webgl/Util".split(" "),
function(m,h,d,c,a,b,k,f){function g(){t=(9301*t+49297)%233280;return t/233280}var e=c.vec3,l=c.mat4,p=c.mat4d;c=function(a,b,c,k,t,m){h.basicMaterialConstructor(this,m);var r=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:4,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:4,type:5126,offset:28,stride:44,normalized:!1}],u=f.getStride(r)/4;this.getAmbient=function(){return b};this.getDiffuse=function(){return c};this.getSpecular=function(){return k};
this.getShininess=function(){return t};this.dispose=function(){};this.getTextureId=function(){return a};this.getOutputAmount=function(a){var b=0,c;for(c=0;c<a/6;c++)0===c%1&&(b+=6);a=b;for(c=b=0;c<a/6;c++)0===c%1&&(b+=6);return b*u};this.getVertexBufferLayout=function(){return r};this.reduce=function(a,b){var c=a.position,d=a.normal;a=a.uv0;for(var e=[],f=[],g=[],l=0,k=0;k<c.length/6;k++)if(0===k%b)for(var p=0;6>p;p++)e[l]=c[6*k+p],f[l]=d[6*k+p],g[l]=a[6*k+p],l++;return{position:e,normal:f,uv0:g}};
this.fillInterleaved=function(a,b,c,f,k,n){f=h.fill;var q=this.reduce(a.faces.indices,1),q=this.reduce(q,1),t=this.getOutputAmount(a.faces.indices.position.length);d.assert(t===q.position.length*u);var r=q.position,v=q.normal,m=q.uv0,q=a.vertexAttr.position.data,x=a.vertexAttr.normal.data,B=a.vertexAttr.uv0.data,C=e.create();a=r.length/6;for(var t=n,D=e.createFrom(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),A=e.createFrom(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),z=0;z<a;++z){for(var E=
e.create(),H=e.create(),F=[100,100,-100,-100],G=e.create(),I=0;6>I;++I){var J=6*z+I,R=3*r[J],da=3*v[J],J=2*m[J];E[0]+=q[R+0];E[1]+=q[R+1];E[2]+=q[R+2];H[0]+=x[da+0];H[1]+=x[da+1];H[2]+=x[da+2];da=B[J+0];J=B[J+1];F[0]=Math.min(F[0],da);F[1]=Math.min(F[1],J);F[2]=Math.max(F[2],da);F[3]=Math.max(F[3],J);0===I&&e.set3(q[R+0],q[R+1],q[R+2],G)}E[0]/=6;E[1]/=6;E[2]/=6;H[0]/=6;H[1]/=6;H[2]/=6;E[0]+=.1*(2*g()-1);E[1]+=.1*(2*g()-1);E[2]+=.1*(2*g()-1);void 0!==b&&(p.multiplyVec3(b,G,G),p.multiplyVec3(b,E,E),
p.multiplyVec3(c,H,H));e.add(E,C,C);e.max(D,E,D);e.min(A,E,A);F[0]+=.01;F[1]+=.01;F[2]-=.01;F[3]-=.01;for(I=0;4>I;I++)F[I]=Math.min(F[I],.99999);I=2*g()*Math.PI;G=1.41*e.dist(G,E);n+=f(E,0,k,n,void 0,3);n+=f(H,0,k,n,void 0,3);k[n++]=0;k[n++]=F[0];k[n++]=F[1];k[n++]=I;k[n++]=G;n+=f(E,0,k,n,void 0,3);n+=f(H,0,k,n,void 0,3);k[n++]=0;k[n++]=F[2]+1;k[n++]=F[1];k[n++]=I;k[n++]=G;n+=f(E,0,k,n,void 0,3);n+=f(H,0,k,n,void 0,3);k[n++]=0;k[n++]=F[2]+1;k[n++]=F[3]+1;k[n++]=I;k[n++]=G;n+=f(E,0,k,n,void 0,3);n+=
f(H,0,k,n,void 0,3);k[n++]=0;k[n++]=F[2]+1;k[n++]=F[3]+1;k[n++]=I;k[n++]=G;n+=f(E,0,k,n,void 0,3);n+=f(H,0,k,n,void 0,3);k[n++]=0;k[n++]=F[0];k[n++]=F[3]+1;k[n++]=I;k[n++]=G;n+=f(E,0,k,n,void 0,3);n+=f(H,0,k,n,void 0,3);k[n++]=0;k[n++]=F[0];k[n++]=F[1];k[n++]=I;k[n++]=G}C[0]/=a;C[1]/=a;C[2]/=a;b=e.create();e.add(D,A,b);e.scale(b,.5,b);n=e.create();e.subtract(D,A,n);n[0]=Math.abs(n[0])/2;n[1]=Math.abs(n[1])/2;n[2]=Math.abs(n[2])/2;r=e.create(C);r[1]-=(D[1]-A[1])/3;D=e.create();A=e.create();q=e.create();
v=[e.create(),e.create(),e.create(),e.create()];C=[0,0,0,0];m=l.create();for(z=0;z<a;++z){e.set3(k[t],k[t+1],k[t+2],q);e.subtract(q,r,D);e.normalize(D,D);A=e.subtract(q,b,A);e.normalize(A,A);B=Math.abs(e.dot(A,[1,0,0]));I=Math.abs(e.dot(A,[0,1,0]));x=Math.abs(e.dot(A,[0,0,1]));B=B*Math.abs(b[0]-q[0])/n[0];B+=I*Math.abs(b[1]-q[1])/n[1];B+=x*Math.abs(b[2]-q[2])/n[2];for(I=0;4>I;I++)l.identity(m),l.rotate(m,.8*(2*g()-1),[0,1,0],m),l.rotate(m,.8*(2*g()-1),[1,0,0],m),l.multiplyVec3(m,D,v[I]),C[I]=.5+.5*
B-.2*(2*g()-1);x=.8+.3*(2*g()-1);for(I=0;6>I;++I){var fa;switch(I){case 0:fa=0;break;case 1:fa=1;break;case 2:fa=2;break;case 3:fa=2;break;case 4:fa=3;break;case 5:fa=0}t+=3;t+=f(v[fa],0,k,t,c,3);k[t++]=C[fa];t+=3;k[t++]*=x}}};this.intersect=function(){};this.getGLMaterials=function(){return{color:v,depthShadowMap:n,normal:void 0,depth:q,highlight:void 0}};this.getAllTextureIds=function(){return[a]}};var v=function(b,c,d){h.basicGLMaterialConstructor(this,b);var e=a.TRANSPARENT_MATERIAL,f=c.get("leafCard");
h.singleTextureGLMaterialConstructor(this,d,{textureId:b.getTextureId()});this.beginSlot=function(a){return e===a};this.getProgram=function(){return f};var g=b.getAmbient(),l=b.getDiffuse(),k=b.getSpecular(),p=b.getShininess();this.bind=function(a,b){a.bindProgram(f);this.bindTexture(a,f);f.setUniform3fv("ambient",g);f.setUniform3fv("diffuse",l);f.setUniform3fv("specular",k);f.setUniform1f("shininess",p);f.setUniform1f("trafoScale",1);a.setBlendingEnabled(!1);a.setDepthTestEnabled(!0)};this.release=
function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,f);h.bindCamPos(b.origin,b.viewInvTransp,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation);f.setUniformMatrix4fv("modelNormal",b.transformationNormal);a=b.transformation;f.setUniform1f("trafoScale",(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8])+Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])+Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},q=function(b,c,d,
e){h.basicGLMaterialConstructor(this,b);var f=a.TRANSPARENT_MATERIAL,g=null==e?c.get("leafCardDepth"):c.get("leafCardDepthShadowMap");h.singleTextureGLMaterialConstructor(this,d,{textureId:b.getTextureId()});this.beginSlot=function(a){return f===a};this.getProgram=function(){return g};this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);g.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){h.bindView(b.origin,b.view,g)};this.bindInstance=function(a,
b){g.setUniformMatrix4fv("model",b.transformation);a=b.transformation;g.setUniform1f("trafoScale",(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8])+Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])+Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},n=function(a,b,c){q.call(this,a,b,c,!0)};c.loadShaders=function(a,c,d,e){a._parse(m);var f=new b(e,a.vertexShaderLeafCard,a.fragmentShaderLeafCard,k.Default3D),g=c.get("fsDepthTextured");c=c.get("fsDepthTexturedShadowMap");
g=new b(e,a.vertexShaderLeafCardDepth,g.source,k.Default3D,g.defines);a=new b(e,a.vertexShaderLeafCardDepth,c.source,k.Default3D,c.defines);d.add("leafCard",f);d.add("leafCardDepth",g);d.add("leafCardDepthShadowMap",a)};var t=1234;return c})},"esri/views/3d/webgl-engine/materials/Material":function(){define("dojo/text!./Material.xml ./internal/MaterialUtil ../../../webgl/Program ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util ../../layers/graphics/graphicUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){function p(a,b){var c=b.vvSizeEnabled;b.vvSizeEnabled?(a.setUniform3fv("vvSizeMinSize",b.vvSizeMinSize),a.setUniform3fv("vvSizeMaxSize",b.vvSizeMaxSize),a.setUniform3fv("vvSizeOffset",b.vvSizeOffset),a.setUniform3fv("vvSizeFactor",b.vvSizeFactor)):c&&a.setUniform3fv("vvSizeValue",b.vvSizeValue);c&&(a.setUniform3fv("vvSymbolAnchor",b.vvSymbolAnchor),l.computeObjectRotation(b.vvSymbolRotation[2],b.vvSymbolRotation[0],b.vvSymbolRotation[1],r.identity(A)),a.setUniformMatrix3fv("vvSymbolRotation",
r.toMat3(A,C)));b.vvColorEnabled&&(a.setUniform1fv("vvColorValues",b.vvColorValues),a.setUniform4fv("vvColorColors",b.vvColorColors))}function v(a,b){a.vvSizeEnabled=b.vvSizeEnabled;a.vvSizeMinSize=b.vvSizeMinSize;a.vvSizeMaxSize=b.vvSizeMaxSize;a.vvSizeOffset=b.vvSizeOffset;a.vvSizeFactor=b.vvSizeFactor;a.vvSizeValue=b.vvSizeValue;a.vvSymbolAnchor=b.vvSymbolAnchor;a.vvSymbolRotation=b.vvSymbolRotation}function q(a,b){u.set(a,B);return u.multiply(b,B)}var n=a.assert,t=b.vec3,u=b.vec4,x=b.mat3,r=b.mat4,
z,B=u.create(),C=x.create(),A=r.create(),D=t.create(),E=t.create(),H=t.createFrom(0,0,1),G=t.create(),J=t.create(),I=t.create(),F=t.create();a=function(a,b){h.basicMaterialConstructor(this,b);a=a||{};a.ambient=a.ambient||[.2,.2,.2];a.diffuse=a.diffuse||[.8,.8,.8];a.specular=a.specular||[0,0,0];a.externalColor=a.externalColor||[1,1,1,1];a.colorMixMode=a.colorMixMode||"multiply";a.shininess=a.shininess||10;a.opacity=void 0!==a.opacity?a.opacity:1;a.layerOpacity=void 0!==a.layerOpacity?a.layerOpacity:
1;a.blendModeOneOne=a.blendModeOneOne||!1;a.inverseWindingOrder=a.inverseWindingOrder||!1;a.vertexColors=a.vertexColors||!1;a.symbolColors=a.symbolColors||!1;a.flipV=a.flipV||!1;a.doubleSided=a.doubleSided||!1;a.cullFace=a.cullFace||void 0;a.instanced=a.instanced||!1;this.instanced=!!a.instanced;a.groundNormalShading=a.groundNormalShading||!1;a.writeStencil=a.writeStencil||!1;a.textureId||(a.reflTextureId=void 0);a.receiveSSAO=void 0!==a.receiveSSAO?a.receiveSSAO:!0;a.castShadows=void 0!==a.castShadows?
a.castShadows:!0;a.verticalOffset=a.verticalOffset||null;a.screenSizePerspective=a.screenSizePerspective||null;a.vvSizeEnabled=a.vvSizeEnabled||!1;a.vvSizeMinSize=a.vvSizeMinSize||[1,1,1];a.vvSizeMaxSize=a.vvSizeMaxSize||[100,100,100];a.vvSizeOffset=a.vvSizeOffset||[0,0,0];a.vvSizeFactor=a.vvSizeFactor||[1,1,1];a.vvSizeValue=a.vvSizeValue||[1,1,1];a.vvColorEnabled=a.vvColorEnabled||!1;a.vvColorValues=a.vvColorValues||[0,0,0,0,0,0,0,0];a.vvColorColors=a.vvColorColors||[1,0,0,0,1,0,0,0,1,0,0,0,1,0,
0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0];a.vvSymbolAnchor=a.vvSymbolAnchor||[0,0,0];a.vvSymbolRotation=a.vvSymbolRotation||[0,0,0];b=a.textureId?a.atlasRegions?"Pos3NormTexRegion":"Pos3NormTex":"Pos3Norm";a.vertexColors&&(b+="Col");a.symbolColors&&(b+="Symcol");var c=g[b],d=null;a.instanced&&(d=[],e.addDescriptor(d,"model",16,5126,!1,1),e.addDescriptor(d,"modelNormal",16,5126,!1,1),-1<a.instanced.indexOf("color")&&e.addDescriptor(d,"instanceColor",4,5126,!1,1),-1<a.instanced.indexOf("featureAttribute")&&
e.addDescriptor(d,"instanceFeatureAttribute",4,5126,!1,1));var f=this.isVisible.bind(this);this.isVisible=function(){return f()&&0<a.opacity&&0<a.layerOpacity};this.dispose=function(){};this.getParams=function(){return a};this.getParameterValues=function(){var b={ambient:a.ambient,diffuse:a.diffuse,specular:a.specular,externalColor:a.externalColor,colorMixMode:a.colorMixMode,shininess:a.shininess,opacity:a.opacity,layerOpacity:a.layerOpacity,transparent:a.transparent,polygonOffset:a.polygonOffset,
reflectivity:a.reflectivity,atlasRegions:a.atlasRegions,flipV:a.flipV,doubleSided:a.doubleSided,cullFace:a.cullFace,writeStencil:a.writeStencil,receiveSSAO:a.receiveSSAO,castShadows:a.castShadows,verticalOffset:a.verticalOffset,screenSizePerspective:a.screenSizePerspective,vvSizeEnabled:a.vvSizeEnabled,vvSizeMinSize:a.vvSizeMinSize,vvSizeMaxSize:a.vvSizeMaxSize,vvSizeOffset:a.vvSizeOffset,vvSizeFactor:a.vvSizeFactor,vvSizeValue:a.vvSizeValue,vvColorEnabled:a.vvColorEnabled,vvColorValues:a.vvColorValues,
vvColorColors:a.vvColorColors,groundNormalShading:a.groundNormalShading,vvSymbolAnchor:a.vvSymbolAnchor,vvSymbolRotation:a.vvSymbolRotation};a.textureId&&(b.textureId=a.textureId,b.initTexture=a.initTexture);return b};this.setParameterValues=function(b){for(var c in b)"textureId"===c&&n(a.textureId,"Can only change texture of material that already has a texture"),"castShadows"===c&&n(b.castShadows===a.castShadows,"Can not change shadow casting behavior."),a[c]=b[c];this.notifyDirty("matChanged")};
this.getOutputAmount=function(a){var b=e.getStride(c)/4;return a*b};this.getVertexBufferLayout=function(){return c};this.getInstanceBufferLayout=function(){return d};this.fillInterleaved=function(a,b,d,e,f,g,l){h.fillInterleaved(a,b,d,e,c,f,g,l)};this.intersect=function(b,c,d,e,f,g,l,k){if(null!=a.verticalOffset){k=e.camera;t.set3(d[12],d[13],d[14],I);var p=t.subtract(I,k.eye,F),n=t.length(p),q=t.scale(p,1/n),r=null,p=null;switch(e.viewingMode){case "global":p=t.normalize(I,G);break;case "local":p=
t.set(H,G)}a.screenSizePerspective&&(r=t.dot(p,q));k=h.verticalOffsetAtDistance(k,n,a.verticalOffset,r,a.screenSizePerspective);t.scale(p,k);x.multiplyVec3(e.transformInverseRotation,p,J);f=t.subtract(f,J,D);g=t.subtract(g,J,E)}h.intersectTriangleGeometry(b,c,d,e,f,g,l)};this.getGLMaterials=function(){return{color:K,depthShadowMap:a.castShadows?X:null,normal:T,depth:ba,highlight:V}};this.getAllTextureIds=function(){var b=[];a.textureId&&b.push(a.textureId);a.reflTextureId&&b.push(a.reflTextureId);
return b}};a.paramsFromOldConstructor=function(a,b,c,d,e,f,g,l,k,p,n,h,q){return{textureId:a,transparent:b,ambient:c,diffuse:d,specular:e,shininess:f,opacity:g,polygonOffset:l,initTexture:k,reflTextureId:p,reflectivity:n,flipV:h,doubleSided:q,cullFace:void 0}};var N=function(a,b){var c=a.gl;(b.cullFace?"none"===b.cullFace:b.transparent)?a.setFaceCullingEnabled(!1):(a.setFaceCullingEnabled(!0),"front"===b.cullFace&&a.setCullFace(c.FRONT))},L=function(a,b){var c=a.gl;(b.cullFace?"none"===b.cullFace:
b.transparent)?a.setFaceCullingEnabled(!0):(a.setFaceCullingEnabled(!1),"front"===b.cullFace&&a.setCullFace(c.BACK))},M=function(a,b){return a?k.TRANSPARENT_MATERIAL:b?k.STENCIL_MATERIAL:k.OPAQUE_MATERIAL},K=function(a,b,c){h.basicGLMaterialConstructor(this,a);var d=h.copyParameters(a.getParams()),e=M(d.transparent,d.writeStencil);h.singleTextureGLMaterialConstructor(this,c,d);var f=h.aquireIfNotUndefined(d.reflTextureId,d.reflInitTexture,c);f&&(f=f.getGLTexture());n(!(d.atlasRegions&&d.reflTextureId),
"Atlas texture with reflection is not yet supported");var g=d.textureId?d.atlasRegions?"AtlasTextured":"Textured":"none";this.instanced=z&&d.instanced;var l=!!this.instanced&&-1<this.instanced.indexOf("color"),k=!z&&d.instanced&&-1<d.instanced.indexOf("color"),t=[[null,null],[null,null]],r,u=null;this._loadPrograms=function(){t[0][0]=this._loadProgram(!1,!1);t[1][0]=this._loadProgram(!0,!1);d.receiveSSAO?(t[0][1]=this._loadProgram(!1,!0),t[1][1]=this._loadProgram(!0,!0),r=t[0].concat(t[1])):(t[0][1]=
t[0][0],t[1][1]=t[1][0],r=[t[0][0],t[1][0]])};this._loadProgram=function(a,c){return b.getShaderVariationsProgram("material",[g,!!d.reflTextureId,d.vertexColors,d.symbolColors,d.flipV,d.doubleSided,!!this.instanced,l,a,c,!!d.vvSizeEnabled,!!d.vvColorEnabled,null!=d.verticalOffset,null!=d.screenSizePerspective,d.groundNormalShading])};this._loadPrograms();var m="AtlasTextured"===g,x=this.dispose;this.dispose=function(){x();h.releaseIfNotUndefined(d.reflTextureId,c)};this.beginSlot=function(a){return e===
a};this.getProgram=function(){return u||t[0][0]};this.getAllPrograms=function(){return r};this.updateParameters=function(){var b=a.getParams();d.ambient=b.ambient;d.diffuse=b.diffuse;d.specular=b.specular;d.externalColor=b.externalColor;d.colorMixMode=b.colorMixMode;d.shininess=b.shininess;d.opacity=b.opacity;d.layerOpacity=b.layerOpacity;d.polygonOffset=b.polygonOffset;d.reflectivity=b.reflectivity;d.flipV=b.flipV;d.doubleSided=b.doubleSided;d.cullFace=b.cullFace;d.receiveSSAO=b.receiveSSAO;d.castShadows=
b.castShadows;d.verticalOffset=b.verticalOffset;d.screenSizePerspective=b.screenSizePerspective;v(d,b);d.vvColorEnabled=b.vvColorEnabled;d.vvColorValues=b.vvColorValues;d.vvColorColors=b.vvColorColors;d.transparent!=b.transparent&&(e=M(b.transparent),d.transparent=b.transparent);d.groundNormalShading=b.groundNormalShading;d.initTexture=b.initTexture;this.updateTexture(b.textureId);b.atlasRegions&&(d.atlasRegions=b.atlasRegions);d.blendModeOneOne=b.blendModeOneOne;d.inverseWindingOrder=b.inverseWindingOrder;
this._loadPrograms()};this.bind=function(a,b){var c=a.gl;u=t[b.shadowMappingEnabled?1:0][b.ssaoEnabled?1:0];a.bindProgram(u);u.setUniform3fv("ambient",d.ambient);u.setUniform3fv("diffuse",d.diffuse);u.setUniform3fv("specular",d.specular);u.setUniform4fv("externalColor",d.externalColor);u.setUniform1i("colorMixMode",h.colorMixModes[d.colorMixMode]);u.setUniform1f("shininess",d.shininess);u.setUniform1f("opacity",d.opacity);u.setUniform1f("layerOpacity",d.layerOpacity);h.bindVerticalOffset(d.verticalOffset,
b,u);h.bindScreenSizePerspective(d.screenSizePerspective,u);p(u,d);this.bindTexture(a,u);m&&this.bindTextureSize(a,u);a.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);void 0!==f&&(u.setUniform1i("reflTex",1),a.bindTexture(f,1),u.setUniform1f("reflectivity",d.reflectivity));d.inverseWindingOrder&&a.setFrontFace(c.CW);d.transparent?(a.setBlendingEnabled(!0),d.blendModeOneOne?(a.setBlendFunction(c.ONE,c.ONE),a.setDepthWriteEnabled(!1)):a.setBlendFunctionSeparate(c.SRC_ALPHA,
c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)):a.setBlendingEnabled(!1);d.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(2,2));N(a,d);a.setDepthTestEnabled(!0)};this.release=function(a,b){b=a.gl;a.setPolygonOffsetFillEnabled(!1);L(a,d);a.setBlendingEnabled(!1);a.setBlendFunctionSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);a.setDepthWriteEnabled(!0);a.setFrontFace(b.CCW)};this.bindView=function(a,b){u=t[b.shadowMappingEnabled?1:0][b.ssaoEnabled?
1:0];a=b.origin;h.bindView(a,b.view,u);h.bindCamPos(a,b.viewInvTransp,u);b.shadowMappingEnabled&&b.shadowMap.bindView(u,a)};this.bindInstance=function(a,b){u.setUniformMatrix4fv("model",b.transformation);u.setUniformMatrix4fv("modelNormal",b.transformationNormal);b.instanceParameters&&k&&(a=b.instanceParameters.color)&&u.setUniform4fv("externalColor",q(a,d.externalColor))};this.getDrawMode=function(a){return a.gl.TRIANGLES}},ba=function(a,b,c,d){h.basicGLMaterialConstructor(this,a);var f=h.copyParameters(a.getParams());
this.instanced=z&&f.instanced;var g=e.hasAttribute(a.getVertexBufferLayout(),"uv0")?"Textured":"none",l=b.getShaderVariationsProgram("material-depth",[g,f.flipV,!!this.instanced,!!d,!!f.vvSizeEnabled,null!=f.verticalOffset,null!=f.screenSizePerspective]),k=M(f.transparent,f.writeStencil);h.singleTextureGLMaterialConstructor(this,c,f);this.beginSlot=function(a){return k===a};this.getProgram=function(){return l};this.updateParameters=function(){var b=a.getParams();f.initTexture=b.initTexture;f.cullFace=
b.cullFace;f.inverseWindingOrder=b.inverseWindingOrder;f.flipV=b.flipV;v(f,b);this.updateTexture(b.textureId)};this.bind=function(a,b){var c=a.gl;a.bindProgram(l);l.setUniform2fv("nearFar",b.nearFar);f.inverseWindingOrder&&a.setFrontFace(c.CW);h.bindVerticalOffset(f.verticalOffset,b,l);h.bindScreenSizePerspective(f.screenSizePerspective,l);p(l,f);this.bindTexture(a,l);N(a,f);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;L(a,f);f.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=
function(a,b){h.bindView(b.origin,b.view,l);f.screenSizePerspective&&h.bindCamPos(b.origin,b.viewInvTransp,l)};this.bindInstance=function(a,b){l.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},X=function(a,b,c){ba.call(this,a,b,c,!0)},T=function(a,b,c){h.basicGLMaterialConstructor(this,a);var d=h.copyParameters(a.getParams()),f=e.hasAttribute(a.getVertexBufferLayout(),"uv0")?"Textured":"none";this.instanced=z&&d.instanced;var g=b.getShaderVariationsProgram("material-normal",
[f,d.flipV,!!this.instanced,!!d.vvSizeEnabled,null!=d.verticalOffset,null!=d.screenSizePerspective]),l=M(d.transparent,d.writeStencil);h.singleTextureGLMaterialConstructor(this,c,d);this.beginSlot=function(a){return l===a};this.getProgram=function(){return g};this.updateParameters=function(){var b=a.getParams();d.initTexture=b.initTexture;d.cullFace=b.cullFace;d.inverseWindingOrder=b.inverseWindingOrder;d.flipV=b.flipV;v(d,b);this.updateTexture(b.textureId)};this.bind=function(a,b){var c=a.gl;a.bindProgram(g);
this.bindTexture(a,g);g.setUniformMatrix4fv("viewNormal",b.viewInvTransp);h.bindVerticalOffset(d.verticalOffset,b,g);h.bindScreenSizePerspective(d.screenSizePerspective,g);p(g,d);N(a,d);d.inverseWindingOrder&&a.setFrontFace(c.CW);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;L(a,d);d.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){h.bindView(b.origin,b.view,g);d.screenSizePerspective&&h.bindCamPos(b.origin,b.viewInvTransp,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",
b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},V=function(a,b,c,d){h.basicGLMaterialConstructor(this,a);var f=h.copyParameters(a.getParams());d=e.hasAttribute(a.getVertexBufferLayout(),"uv0")?"Textured":"none";this.instanced=z&&f.instanced;var g=b.getShaderVariationsProgram("material-highlight",[d,f.flipV,!!this.instanced,!!f.vvSizeEnabled,null!=f.verticalOffset,null!=f.screenSizePerspective]),l=M(f.transparent,f.writeStencil);
h.singleTextureGLMaterialConstructor(this,c,f);this.beginSlot=function(a){return l===a};this.getProgram=function(){return g};this.updateParameters=function(){var b=a.getParams();f.initTexture=b.initTexture;f.cullFace=b.cullFace;f.inverseWindingOrder=b.inverseWindingOrder;f.flipV=b.flipV;v(f,b);this.updateTexture(b.textureId)};this.bind=function(a,b){var c=a.gl;a.bindProgram(g);this.bindTexture(a,g);h.bindVerticalOffset(f.verticalOffset,b,g);h.bindScreenSizePerspective(f.screenSizePerspective,g);p(g,
f);N(a,f);f.inverseWindingOrder&&a.setFrontFace(c.CW);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;L(a,f);f.inverseWindingOrder&&a.setFrontFace(b.CW)};this.bindView=function(a,b){h.bindView(b.origin,b.view,g);f.screenSizePerspective&&h.bindCamPos(b.origin,b.viewInvTransp,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};a.loadShaders=
function(a,b,e,g){a._parse(m);z=g.extensions.angleInstancedArrays;g.extensions.shaderTextureLOD;g.extensions.standardDerivatives;var l=new c("phong",["vsPhong","fsPhong"],null,e,b,a,g);l.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);l.addBinaryShaderSnippetSuffix("Refl","Refl",[!1,!0]);l.addDefine("Color","VERTEXCOLORS");l.addDefine("symbolColor","SYMBOLVERTEXCOLORS");l.addDefine("FlipV","FLIPV");l.addDefine("DoubleSided",
"DOUBLESIDED");l.addDefine("Instanced","INSTANCED");l.addDefine("InstColor","INSTANCEDCOLOR");l.addDefine("ReceiveShadows","RECEIVE_SHADOWS");l.addDefine("ReceiveSSAO","RECEIVE_SSAO");l.addDefine("vvSize","VV_SIZE");l.addDefine("vvColor","VV_COLOR");l.addDefine("VerticalOffset","VERTICAL_OFFSET");l.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");l.addDefine("groundNormalShading","GROUND_NORMAL_SHADING");e.addShaderVariations("material",l);l=new c("depth",["vsDepth","fsDepth"],null,e,
b,a,g);l.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);l.addDefine("FlipV","FLIPV");l.addDefine("Instanced","INSTANCED");l.addDefine("ShadowMap","BIAS_SHADOWMAP");l.addDefine("vvSize","VV_SIZE");l.addDefine("VerticalOffset","VERTICAL_OFFSET");l.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");e.addShaderVariations("material-depth",l);l=new c("normal",["vsNormal","fsNormal"],null,e,b,a,g);l.addNaryShaderSnippetSuffix([{value:"none",
programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);l.addDefine("FlipV","FLIPV");l.addDefine("Instanced","INSTANCED");l.addDefine("vvSize","VV_SIZE");l.addDefine("VerticalOffset","VERTICAL_OFFSET");l.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");e.addShaderVariations("material-normal",l);l=new c("highlight",["vsHighlight","fsHighlight"],null,e,b,a,g);l.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},
{value:"AtlasTextured"}]);l.addDefine("FlipV","FLIPV");l.addDefine("Instanced","INSTANCED");l.addDefine("vvSize","VV_SIZE");l.addDefine("VerticalOffset","VERTICAL_OFFSET");l.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");e.addShaderVariations("material-highlight",l);var l=new d(g,a.vsDepth,a.fsDepth,f.Default3D,["BIAS_SHADOWMAP 1"]),k=new d(g,a.vsDepthTextured,a.fsDepthTextured,f.Default3D,["BIAS_SHADOWMAP 1"]),p=new d(g,a.vsDepth,a.fsDepth,f.Default3D),n=new d(g,a.vsDepthTextured,a.fsDepthTextured,
f.Default3D),h=new d(g,a.vsNormal,a.fsNormal,f.Default3D),q=new d(g,a.vsNormalTextured,a.fsNormalTextured,f.Default3D),t=new d(g,a.vsHighlight,a.fsHighlight,f.Default3D);g=new d(g,a.vsHighlightTextured,a.fsHighlightTextured,f.Default3D);e.add("depthShadowMap",l);e.add("depthTexturedShadowMap",k);e.add("depth",p);e.add("depthTextured",n);e.add("normal",h);e.add("normalTextured",q);e.add("highlight",t);e.add("highlightTextured",g);b.add("fsDepth",{source:a.fsDepth});b.add("fsDepthTextured",{source:a.fsDepthTextured});
b.add("fsDepthShadowMap",{source:a.fsDepthShadowMap,defines:["BIAS_SHADOWMAP 1"]});b.add("fsDepthTexturedShadowMap",{source:a.fsDepthTextured,defines:["BIAS_SHADOWMAP 1"]});b.add("vsDepth",{source:a.vsDepth});b.add("fsNormal",{source:a.fsNormal})};return a})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../geometry/SpatialReference ../../../../geometry/Point ../../../../geometry/support/webMercatorUtils ../../lib/glMatrix".split(" "),function(m,h,d,c,a,
b){function k(b,c){var e=b.spatialReference;e.equals(c)||(e.isWebMercator&&c.wkid===d.WGS84.wkid?a.webMercatorToGeographic(b,!1,b):c.isWebMercator&&e.wkid===d.WGS84.wkid&&a.geographicToWebMercator(b,!1,b))}function f(a){if(Array.isArray(a)){for(var b=0;b<a.length;b++)if(!f(a[b]))return!1;return!0}return null==a||0<=a}Object.defineProperty(h,"__esModule",{value:!0});var g=b.vec4d,e=b.mat4d,l=[1,1,1];h.computeCentroid=function(a,b){if("extent"===a.type)return a.center;if("polygon"===a.type)return a.centroid;
for(var d=0,e=0,f=0,g=a.hasZ,l=0,p=0,h=a.paths;p<h.length;p++){for(var v=h[p],m=0,A=v;m<A.length;m++){var D=A[m],d=d+D[0],e=e+D[1];g&&(f+=D[2])}l+=v.length}a=new c({x:d/l,y:e/l,z:g?f/l:void 0,spatialReference:a.spatialReference});b&&k(a,b);return a};h.convertToSR=k;h.enlargeExtent=function(a,b,c){if(a){b||(b=g.create());var d=.5*a.width*(c-1);c=.5*a.height*(c-1);a.width<1E-7*a.height?d+=c/20:a.height<1E-7*a.width&&(c+=d/20);g.set4(a.xmin-d,a.ymin-c,a.xmax+d,a.ymax+c,b);return b}return null};h.updateVertexAttributeAuxpos1w=
function(a,b){for(var c=0;c<a.geometries.length;++c){var d=a.geometries[c].data.vertexAttributes.auxpos1;d&&d.data[3]!==b&&(d.data[3]=b,a.geometryVertexAttrsUpdated(c))}};h.mixinColorAndOpacity=function(a,b){var c=[1,1,1,1];null!=a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);null!==b&&void 0!==b?c[3]=b:null!=a&&3<a.length&&(c[3]=a[3]);return c};h.overrideColor=function(a,b,c,d,e){e=e.slice();for(var f=0;3>f;++f)a&&null!=a[f]?e[f]=a[f]:c&&null!=c[f]&&(e[f]=c[f]);null!=b?e[3]=b:null!=d&&(e[3]=d);return e};h.computeObjectScale=
function(a,b,c,d){void 0===a&&(a=l);void 0===d&&(d=1);var e=Array(3);if(null==b||null==c)e[0]=1,e[1]=1,e[2]=1;else{for(var f=void 0,g=0,k=2;0<=k;k--){var p=a[k],n=void 0,h=null!=p,q=0===k&&!f&&!h;"symbolValue"===p||q?n=b[k]/c[k]:h&&"proportional"!==p&&isFinite(p)&&(n=p/c[k]);null!=n&&(f=e[k]=n,g=Math.max(g,Math.abs(n)))}for(k=2;0<=k;k--)null==e[k]?e[k]=f:0===e[k]&&(e[k]=.001*g)}for(k=2;0<=k;k--)e[k]/=d;return e};h.computeSizeWithResourceSize=function(a,b){var c=b.width,d=b.depth,e=b.height;b=b.isPrimitive?
10:1;if(null==c&&null==e&&null==d)return[b*a[0],b*a[1],b*a[2]];for(var c=[c,d,e],f,d=0;3>d;d++)if(e=c[d],null!=e){f=e/a[d];break}for(d=0;3>d;d++)null==c[d]&&(c[d]=a[d]*f);return c};h.validateSymbolLayerSize=function(a){null!=a.isPrimitive&&(a=[a.width,a.depth,a.height]);return f(a)?null:"Symbol sizes may not be negative values"};h.computeObjectRotation=function(a,b,c,d){void 0===d&&(d=e.identity());a=a||0;b=b||0;c=c||0;0!==a&&e.rotateZ(d,-a/180*Math.PI,d);0!==b&&e.rotateX(d,b/180*Math.PI,d);0!==c&&
e.rotateY(d,c/180*Math.PI,d);return d}})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("dojo/_base/lang dojo/text!./RibbonLineMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/ComponentUtils ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(m,h,d,c,a,b,k,f,g,e,l){var p=[255,255,255,255],v=[0,0,0,0],q=a.vec3d,n=a.vec2d,t=a.mat4d,u=q.create(),
x=q.create(),r=q.create(),z=q.create(),B=n.create(),C=n.create(),A=q.create(),D=q.create();a=function(a,b){d.basicMaterialConstructor(this,b);var f=c.VertexAttrConstants;a=a||{};a.color=a.color||[1,1,1,1];a.width=a.width||0;a.type=a.type||"screen";a.join=a.join||"miter";a.miterLimit="miter"===a.join?a.miterLimit||5:a.miterLimit;var g="wall"===a.type?2:4,n=e.Pos3Tex;"wall"!==a.type&&(n=[{name:"position",count:3,type:5126,offset:0,stride:64,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:64,
normalized:!1},{name:"auxpos1",count:3,type:5126,offset:20,stride:64,normalized:!1},{name:"auxpos2",count:3,type:5126,offset:32,stride:64,normalized:!1},{name:"color",count:4,type:5126,offset:44,stride:64,normalized:!1},{name:"size",count:1,type:5126,offset:60,stride:64,normalized:!1}]);this.canBeMerged=!1;this.getParams=function(){return a};this.getParameterValues=function(){var b={color:a.color,width:a.width,type:a.type,join:a.join,polygonOffset:a.polygonOffset};"miter"===a.join&&(b.miterLimit=
a.miterLimit);return b};this.setParameterValues=function(b){for(var d in b)b.hasOwnProperty(d)&&(c.assert("type"!==d,"RibbonLineMaterial: type cannot be changed after creation"),a[d]=b[d]);this.notifyDirty("matChanged")};this.dispose=function(){};this.getOutputAmount=function(a){return((a/2+1-2)*g+4)*l.getStride(n)/4};this.getVertexBufferLayout=function(){return n};this.fillInterleaved=function(b,c,d,e,g,l){d=b.vertexAttr[f.POSITION].data;e=b.vertexAttr[f.COLOR]?b.vertexAttr[f.COLOR].data:p;var k=
b.vertexAttr[f.SIZE]?b.vertexAttr[f.SIZE].data:v;(b=b.faces&&b.faces.indices&&b.faces.indices.position)&&b.length!=2*(d.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");if("wall"===a.type){e=l;k=d.length/3;l=0;b=d[0];for(var n=d[1],h=d[2],q,t,r,u=0;u<k;u++){var m=3*u;q=b;t=n;r=h;b=d[m];n=d[m+1];h=d[m+2];c&&(b=c[0]*b+c[4]*n+c[8]*h+c[12],n=c[1]*b+c[5]*n+c[9]*h+c[13],h=c[2]*b+c[6]*n+c[10]*h+c[14]);l+=Math.sqrt((b-q)*(b-q)+(n-t)*(n-t)+(h-r)*(h-r));g[e++]=b;g[e++]=n;g[e++]=h;g[e++]=
l;g[e++]=-1;g[e++]=b;g[e++]=n;g[e++]=h;g[e++]=l;g[e++]=1}}else{b=d.length/3;n=d[0];h=d[1];q=d[2];t=0;c&&(n=c[0]*n+c[4]*h+c[8]*q+c[12],h=c[1]*n+c[5]*h+c[9]*q+c[13],q=c[2]*n+c[6]*h+c[10]*q+c[14]);r=n;var u=h,m=q,x=d[3],B=d[4],C=d[5];c&&(x=c[0]*x+c[4]*B+c[8]*C+c[12],B=c[1]*x+c[5]*B+c[9]*C+c[13],C=c[2]*x+c[6]*B+c[10]*C+c[14]);for(var D=0;D<b;D++){var A=3*D;D<b-1&&(x=d[A+3],B=d[A+4],C=d[A+5],c&&(x=c[0]*x+c[4]*B+c[8]*C+c[12],B=c[1]*x+c[5]*B+c[9]*C+c[13],C=c[2]*x+c[6]*B+c[10]*C+c[14]));t+=Math.sqrt((r-n)*
(r-n)+(u-h)*(u-h)+(m-q)*(m-q));g[l++]=r;g[l++]=u;g[l++]=m;g[l++]=t;g[l++]=0===D?-1.2:-1;g[l++]=n;g[l++]=h;g[l++]=q;g[l++]=x;g[l++]=B;g[l++]=C;g[l++]=e[0];g[l++]=e[1];g[l++]=e[2];g[l++]=e[3];g[l++]=k[0];g[l++]=r;g[l++]=u;g[l++]=m;g[l++]=t;g[l++]=0===D?1.2:1;g[l++]=n;g[l++]=h;g[l++]=q;g[l++]=x;g[l++]=B;g[l++]=C;g[l++]=e[0];g[l++]=e[1];g[l++]=e[2];g[l++]=e[3];g[l++]=k[0];0<D&&D<b-1&&(g[l++]=r,g[l++]=u,g[l++]=m,g[l++]=t,g[l++]=-1.2,g[l++]=n,g[l++]=h,g[l++]=q,g[l++]=x,g[l++]=B,g[l++]=C,g[l++]=e[0],g[l++]=
e[1],g[l++]=e[2],g[l++]=e[3],g[l++]=k[0],g[l++]=r,g[l++]=u,g[l++]=m,g[l++]=t,g[l++]=1.2,g[l++]=n,g[l++]=h,g[l++]=q,g[l++]=x,g[l++]=B,g[l++]=C,g[l++]=e[0],g[l++]=e[1],g[l++]=e[2],g[l++]=e[3],g[l++]=k[0]);n=r;h=u;q=m;r=x;u=B;m=C}}};this.intersect=function(b,d,e,g,l,p,n){if(g.isSelection&&!k.isAllHidden(d.componentVisibilities,b.data.componentOffsets)){d=b.getData().getVertexAttr(f.position).position.data;b=b.getData().getVertexAttr(f.SIZE).size;b=(b&&b.data[0])+a.width;l=Number.MAX_VALUE;var h,v;p=
g.camera;for(var m=g.point,E=0;E<d.length-5;E+=3){u[0]=d[E];u[1]=d[E+1];u[2]=d[E+2];t.multiplyVec3(e,u);x[0]=d[E+3];x[1]=d[E+4];x[2]=d[E+5];t.multiplyVec3(e,x);p.projectPoint(u,B);p.projectPoint(x,C);if(0>B[2]&&0<C[2])q.subtract(u,x,r),h=p.frustumPlanes,v=-(q.dot(h[4],u)+h[4][3]),h=v/q.dot(r,h[4]),q.scale(r,h,r),q.add(u,r,u),p.projectPoint(u,B);else if(0<B[2]&&0>C[2])q.subtract(x,u,r),h=p.frustumPlanes,v=-(q.dot(h[4],x)+h[4][3]),h=v/q.dot(r,h[4]),q.scale(r,h,r),q.add(x,r,x),p.projectPoint(x,C);else if(0>
B[2]&&0>C[2])continue;h=c.projectVectorVector2D(B,C,m);h<l&&(l=h,q.set(u,A),q.set(x,D))}e=g.p0;g=g.p1;l<b/2+4&&(d=c.linelineDistance3D(A,D,e,g),b=Number.MAX_VALUE,d[0]&&(q.subtract(d[2],e,z),b=q.length(z)/q.dist(e,g)),n(b,z))}};this.getGLMaterials=function(){return{color:E,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:H}};this.getAllTextureIds=function(){return[]}};var E=function(a,c){d.basicGLMaterialConstructor(this,a);var e=m.clone(a.getParams());e.miterLimit="miter"===e.join?e.miterLimit:
0;delete e.join;var f=c.get("ribbonLine_"+e.type);this.updateParameters=function(){var b=a.getParams();e.polygonOffset=b.polygonOffset;e.color=b.color;e.width=b.width;e.miterLimit="miter"===b.join?b.miterLimit:0};this.beginSlot=function(a){return a===b.TRANSPARENT_MATERIAL};this.getProgram=function(){return f};this.bind=function(a,b){a.bindProgram(f);f.setUniform4fv("eColor",e.color);f.setUniform1f("miterLimit",e.miterLimit);f.setUniform1f("nearPlane",b.nearFar[0]);"screen"===e.type?(f.setUniform2fv("screenSize",
[b.viewport[2],b.viewport[3]]),f.setUniform1f("extLineWidth",e.width*b.pixelRatio)):f.setUniform1f("extLineWidth",e.width);e.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setFaceCullingEnabled(!1);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(1<=e.color[3])};this.release=function(a){e.polygonOffset&&a.setPolygonOffsetFillEnabled(!1);a.setBlendingEnabled(!1);
a.setDepthWriteEnabled(!0)};this.bindView=function(a,b){d.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP}},H=function(a,c){d.basicGLMaterialConstructor(this,a);var e=m.clone(a.getParams());e.miterLimit="miter"===e.join?e.miterLimit:0;delete e.join;var f=c.get("ribbonLineHighlight_"+e.type);this.updateParameters=function(){var b=a.getParams();e.polygonOffset=b.polygonOffset;e.color=
b.color;e.width=b.width;e.miterLimit="miter"===b.join?b.miterLimit:0};this.beginSlot=function(a){return a===b.OPAQUE_MATERIAL};this.getProgram=function(){return f};this.bind=function(a,b){a.bindProgram(f);f.setUniform4fv("eColor",e.color);f.setUniform1f("miterLimit",e.miterLimit);f.setUniform1f("nearPlane",b.nearFar[0]);"screen"===e.type?(f.setUniform2fv("screenSize",[b.viewport[2],b.viewport[3]]),f.setUniform1f("extLineWidth",e.width*b.pixelRatio)):f.setUniform1f("extLineWidth",e.width);e.polygonOffset&&
(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setFaceCullingEnabled(!1);a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(1<=e.color[3])};this.release=function(a){e.polygonOffset&&a.setPolygonOffsetFillEnabled(!1);a.setDepthWriteEnabled(!0)};this.bindView=function(a,b){d.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP}};a.loadShaders=function(a,b,c,d){a._parse(h);b=
new f(d,a.vsRibbonLine,a.fsRibbonLine,g.Default3D,["SCREENSCALE"]);var e=new f(d,a.vsRibbonLine,a.fsRibbonLineHighlight,g.Default3D,["SCREENSCALE"]),l=new f(d,a.vsRibbonLine,a.fsRibbonLine,g.Default3D),k=new f(d,a.vsRibbonLine,a.fsRibbonLineHighlight,g.Default3D),p=new f(d,a.vsRibbonLine,a.fsRibbonLine,g.Default3D,["WALL"]);a=new f(d,a.vsRibbonLine,a.fsRibbonLineHighlight,g.Default3D,["WALL"]);c.add("ribbonLine_screen",b);c.add("ribbonLineHighlight_screen",e);c.add("ribbonLine_strip",l);c.add("ribbonLineHighlight_strip",
k);c.add("ribbonLine_wall",p);c.add("ribbonLineHighlight_wall",a)};return a})},"esri/views/3d/webgl-engine/materials/WaterMaterial":function(){define("dojo/text!./WaterMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(m,h,d,c,a,b,k){var f=function(a,c,d,f,q,n){h.basicMaterialConstructor(this,n);var e=b.Pos3;this.dispose=function(){};this.getNoiseTextureId=function(){return a};
this.getReflTextureId=function(){return c};this.getColor=function(){return d};this.getScale=function(){return f};this.getSpeed=function(){return q};this.getOutputAmount=function(a){return a*k.getStride(e)/4};this.getVertexBufferLayout=function(){return e};this.fillInterleaved=function(a,b,c,d,f,g,l){h.fillInterleaved(a,b,c,d,e,f,g,l)};this.intersect=h.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:g,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=
function(){return[a,c]}},g=function(a,b,c){h.basicGLMaterialConstructor(this,a);var e=d.TRANSPARENT_MATERIAL,f=b.get("water");b={noiseTextureId:a.getNoiseTextureId(),reflTextureId:a.getReflTextureId()};h.multiTextureGLMaterialConstructor(this,c,b,[["noiseTextureId",void 0,"noiseTex"],["reflTextureId",void 0,"reflTex"]]);var g=a.getColor(),l=a.getScale(),k=a.getSpeed(),p=Date.now();this.beginSlot=function(a){return e===a};this.getProgram=function(){return f};this.bind=function(a,b){a.bindProgram(f);
this.bindTextures(a,f);f.setUniform3fv("color",g);f.setUniform1f("scale",l);a=(Date.now()-p)/1E5*k;a-=Math.floor(a);f.setUniform1f("speed",a);b.shadowMappingEnabled||f.setUniform1f("depthHalfPixelSz",-1)};this.release=function(a){};this.bindView=function(a,b){a=b.origin;h.bindView(a,b.view,f);h.bindCamPos(a,b.viewInvTransp,f);b.shadowMappingEnabled&&b.shadowMap.bindView(f,a)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};
f.loadShaders=function(b,d,f,g){b._parse(m);b=new c(g,b.vertexShaderWater,b.fragmentShaderWater,a.Default3D);f.add("water",b)};return f})},"esri/views/3d/webgl-engine/materials/internal/BlendLayers":function(){define(["dojo/text!./BlendLayers.xml","../../../../webgl/Program","../../lib/DefaultVertexAttributeLocations"],function(m,h,d){return{loadShaders:function(c,a,b,k){c._parse(m);c=new h(k,c.vertexShaderBlendLayers,c.fragmentShaderBlendLayers,d.Default3D);b.add("blendLayers",c)}}})},"esri/views/3d/webgl-engine/lib/tracer":function(){define(["require",
"exports","./webgl-debug"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});var c=null,a=[];h.enabled=!1;h.begin=function(){h.enabled&&(c=[])};h.trace=function(a){h.enabled&&null!=c&&c.push(a)};h.end=function(){if(h.enabled){var b=c;c=null;b&&(a.forEach(function(a){return a(b)}),a.length=0);return b}};h.instrumentContext=function(a){return h.enabled?d.makeDebugContext(a,void 0,function(a,b){h.enabled&&c&&c.push("gl."+a+"("+d.glFunctionArgsToString(a,b)+")")}):a};h.request=function(b){a.push(b)}})},
"esri/views/3d/webgl-engine/lib/webgl-debug":function(){define([],function(){function m(a){if(null==g){g={};e={};for(var b in a)"number"==typeof a[b]&&(g[a[b]]=b,e[b]=a[b])}}function h(){if(null==g)throw"WebGLDebugUtils.init(ctx) not called";}function d(a){h();var b=g[a];return void 0!==b?"gl."+b:"/*UNKNOWN WebGL ENUM*/ 0x"+a.toString(16)+""}function c(a,b,c,g){a=f[a];if(void 0!==a&&(a=a[b],void 0!==a&&a[c])){if("object"===typeof a[c]&&void 0!==a[c].enumBitwiseOr){b=a[c].enumBitwiseOr;c=0;a=[];for(var l=
0;l<b.length;++l){var k=e[b[l]];0!==(g&k)&&(c|=k,a.push(d(k)))}return c===g?a.join(" | "):d(g)}return d(g)}return null===g?"null":void 0===g?"undefined":g.toString()}function a(a,b,c){a.__defineGetter__(c,function(){return b[c]});a.__defineSetter__(c,function(a){b[c]=a})}function b(e,f,g,k){function l(a,b){return function(){g&&g(b,arguments);var c=a[b].apply(a,arguments),d=k.getError();0!=d&&(p[d]=!0,f(d,b,arguments));return c}}k=k||e;m(e);f=f||function(a,b,e){for(var f="",g=e.length,l=0;l<g;++l)f+=
(0==l?"":", ")+c(b,g,l,e[l]);a="WebGL error "+d(a)+" in "+b+"("+f+")";window.console&&window.console.error?window.console.error(a):window.console&&window.console.log&&window.console.log(a)};var p={},h={},q;for(q in e)if("function"==typeof e[q])if("getExtension"!=q)h[q]=l(e,q);else{var r=l(e,q);h[q]=function(){var a=r.apply(e,arguments);return b(a,f,g,k)}}else a(h,e,q);h.getError=function(){for(var a in p)if(p.hasOwnProperty(a)&&p[a])return p[a]=!1,a;return e.NO_ERROR};return h}function k(a){var b=
a.getParameter(a.MAX_VERTEX_ATTRIBS),c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);for(var d=0;d<b;++d)a.disableVertexAttribArray(d),a.vertexAttribPointer(d,4,a.FLOAT,!1,0,0),a.vertexAttrib1f(d,0);a.deleteBuffer(c);b=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);for(d=0;d<b;++d)a.activeTexture(a.TEXTURE0+d),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.bindTexture(a.TEXTURE_2D,null);a.activeTexture(a.TEXTURE0);a.useProgram(null);a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);
a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.DITHER);a.disable(a.SCISSOR_TEST);a.blendColor(0,0,0,0);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.clearColor(0,0,0,0);a.clearDepth(1);a.clearStencil(-1);a.colorMask(!0,!0,!0,!0);a.cullFace(a.BACK);a.depthFunc(a.LESS);a.depthMask(!0);a.depthRange(0,1);a.frontFace(a.CCW);a.hint(a.GENERATE_MIPMAP_HINT,a.DONT_CARE);a.lineWidth(1);a.pixelStorei(a.PACK_ALIGNMENT,
4);a.pixelStorei(a.UNPACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);a.UNPACK_COLORSPACE_CONVERSION_WEBGL&&a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);a.polygonOffset(0,0);a.sampleCoverage(1,!1);a.scissor(0,0,a.canvas.width,a.canvas.height);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilMask(4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.viewport(0,0,a.canvas.width,a.canvas.height);for(a.clear(a.COLOR_BUFFER_BIT|
a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT);a.getError(););}var f={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},
texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},
framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,
1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},g=null,e=null;return{init:m,mightBeEnum:function(a){h();return void 0!==g[a]},glEnumToString:d,glFunctionArgToString:c,glFunctionArgsToString:function(a,b){for(var d="",e=b.length,f=0;f<e;++f)d+=(0==f?"":", ")+c(a,e,f,b[f]);return d},makeDebugContext:b,
makeLostContextSimulatingCanvas:function(b){function c(a){return"function"==typeof a?a:function(b){a.handleEvent(b)}}function d(){for(var a=Object.keys(I),b=0;b<a.length;++b)delete I[a]}function e(){++H;A||E==H&&b.loseContext()}function f(a,b){var c=a[b];return function(){e();if(!A)return c.apply(a,arguments)}}function g(a){return{statusMessage:a,preventDefault:function(){G=!0}}}function l(b){for(var c in b)"function"==typeof b[c]?r[c]=f(b,c):a(r,b,c);r.getError=function(){e();if(!A)for(var a;a=h.getError();)I[a]=
!0;for(a in I)if(I[a])return delete I[a],a;return r.NO_ERROR};var d="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(c=0;c<d.length;++c){var g=d[c];r[g]=function(a){return function(){e();if(A)return null;var c=a.apply(b,arguments);c.__webglDebugContextLostId__=C;D.push(c);return c}}(b[g])}d="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(c=0;c<d.length;++c)g=d[c],r[g]=function(a){return function(){e();return A?null:a.apply(b,arguments)}}(r[g]);d="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(c=0;c<d.length;++c)g=d[c],r[g]=function(a){return function(){e();return A?!1:a.apply(b,arguments)}}(r[g]);r.checkFramebufferStatus=function(a){return function(){e();return A?r.FRAMEBUFFER_UNSUPPORTED:a.apply(b,arguments)}}(r.checkFramebufferStatus);r.getAttribLocation=function(a){return function(){e();
return A?-1:a.apply(b,arguments)}}(r.getAttribLocation);r.getVertexAttribOffset=function(a){return function(){e();return A?0:a.apply(b,arguments)}}(r.getVertexAttribOffset);r.isContextLost=function(){return A};return r}var h,r,m=[],B=[];r={};var C=1,A=!1,D=[],E=0,H=0,G=!1,J=0,I={};b.getContext=function(a){return function(){var c=a.apply(b,arguments);if(c instanceof WebGLRenderingContext){if(c!=h){if(h)throw"got different context";h=c;r=l(h)}return r}return c}}(b.getContext);(function(a){var b=a.addEventListener;
a.addEventListener=function(d,e,f){switch(d){case "webglcontextlost":m.push(c(e));break;case "webglcontextrestored":B.push(c(e));break;default:b.apply(a,arguments)}}})(b);b.loseContext=function(){if(!A){A=!0;E=0;for(++C;h.getError(););d();I[h.CONTEXT_LOST_WEBGL]=!0;var a=g("context lost"),c=m.slice();setTimeout(function(){for(var d=0;d<c.length;++d)c[d](a);0<=J&&setTimeout(function(){b.restoreContext()},J)},0)}};b.restoreContext=function(){A&&B.length&&setTimeout(function(){if(!G)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var a=0;a<D.length;++a){var b=D[a];b instanceof WebGLBuffer?h.deleteBuffer(b):b instanceof WebGLFramebuffer?h.deleteFramebuffer(b):b instanceof WebGLProgram?h.deleteProgram(b):b instanceof WebGLRenderbuffer?h.deleteRenderbuffer(b):b instanceof WebGLShader?h.deleteShader(b):b instanceof WebGLTexture&&h.deleteTexture(b)}k(h);A=!1;H=0;G=!1;for(var a=B.slice(),b=g("context restored"),c=0;c<a.length;++c)a[c](b)},0)};b.loseContextInNCalls=function(a){if(A)throw"You can not ask a lost contet to be lost";
E=H+a};b.getNumCalls=function(){return H};b.setRestoreTimeout=function(a){J=a};return b},resetToInitialState:k}})},"esri/views/webgl/RenderingContext":function(){define(["require","exports","./enums","./Extensions"],function(m,h,d,c){m=function(){function a(a,d){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState=
{r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=
1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=a;this._extensions=new c(a,d);d=a.getParameter(a.VIEWPORT);this._viewport={x:d[0],y:d[1],width:d[2],height:d[3]};d=this.extensions.textureFilterAnisotropic;this._parameters={versionString:a.getParameter(a.VERSION),maxVertexTextureImageUnits:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:a.getParameter(a.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:d?a.getParameter(d.MAX_TEXTURE_MAX_ANISOTROPY_EXT):void 0,maxTextureImageUnits:a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}Object.defineProperty(a.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null};a.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a)};a.prototype.setBlendColor=function(a,c,d,g){if(a!==this._blendColorState.r||c!==this._blendColorState.g||d!==this._blendColorState.b||
g!==this._blendColorState.a)this.gl.blendColor(a,c,d,g),this._blendColorState.r=a,this._blendColorState.g=c,this._blendColorState.b=d,this._blendColorState.a=g};a.prototype.setBlendFunction=function(a,c){if(a!==this._blendFunctionState.srcRGB||c!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,c),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=c};a.prototype.setBlendFunctionSeparate=function(a,c,d,g){if(this._blendFunctionState.srcRGB!==
a||this._blendFunctionState.srcAlpha!==d||this._blendFunctionState.dstRGB!==c||this._blendFunctionState.dstAlpha!==g)this.gl.blendFuncSeparate(a,c,d,g),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=d,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=g};a.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a)};a.prototype.setBlendEquationSeparate=
function(a,c){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==c)this.gl.blendEquationSeparate(a,c),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=c};a.prototype.setColorMask=function(a,c,d,g){if(this._colorMaskState.r!==a||this._colorMaskState.g!==c||this._colorMaskState.b!==d||this._colorMaskState.a!==g)this.gl.colorMask(a,c,d,g),this._colorMaskState.r=a,this._colorMaskState.g=c,this._colorMaskState.b=d,this._colorMaskState.a=g};a.prototype.setClearColor=
function(a,c,d,g){if(this._clearColor.r!==a||this._clearColor.g!==c||this._clearColor.b!==d||this._clearColor.a!==g)this.gl.clearColor(a,c,d,g),this._clearColor.r=a,this._clearColor.g=c,this._clearColor.b=d,this._clearColor.a=g};a.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)};a.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==
a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)};a.prototype.setPolygonOffset=function(a,c){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==c)this._polygonOffset[0]=a,this._polygonOffset[1]=c,this.gl.polygonOffset(a,c)};a.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)};a.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=
a)};a.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};a.prototype.setScissorRect=function(a,c,d,g){if(this._scissorRect.x!==a||this._scissorRect.y!==c||this._scissorRect.width!==d||this._scissorRect.height!==g)this.gl.scissor(a,c,d,g),this._scissorRect.x=a,this._scissorRect.y=c,this._scissorRect.width=d,this._scissorRect.height=g};a.prototype.setDepthTestEnabled=
function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)};a.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};a.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a)};a.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)};a.prototype.setDepthRange=
function(a,c){if(this._depthRange.zNear!==a||this._depthRange.zFar!==c)this.gl.depthRange(a,c),this._depthRange.zNear=a,this._depthRange.zFar=c};a.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a)};a.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};a.prototype.setStencilFunction=function(a,c,d){if(this._stencilFunction.func!==
a||this._stencilFunction.ref!==c||this._stencilFunction.mask!==d)this.gl.stencilFunc(a,c,d),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=c,this._stencilFunction.mask=d};a.prototype.setStencilFunctionSeparate=function(a,c,d,g){if(this._stencilFunction.face!==a||this._stencilFunction.func!==c||this._stencilFunction.ref!==d||this._stencilFunction.mask!==g)this.gl.stencilFuncSeparate(a,c,d,g),this._stencilFunction.face=a,this._stencilFunction.func=c,this._stencilFunction.ref=
d,this._stencilFunction.mask=g};a.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a)};a.prototype.setStencilOp=function(a,c,d){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==d)this.gl.stencilOp(a,c,d),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=c,this._stencilOperation.zPass=d};a.prototype.setStencilOpSeparate=function(a,c,d,g){if(this._stencilOperation.face!==
a||this._stencilOperation.fail!==c||this._stencilOperation.zFail!==d||this._stencilOperation.zPass!==g)this.gl.stencilOpSeparate(a,c,d,g),this._stencilOperation.face=a,this._stencilOperation.face=a,this._stencilOperation.fail=c,this._stencilOperation.zFail=d,this._stencilOperation.zPass=g};a.prototype.setLineWidth=function(a){var b=this._lineWidth;this._lineWidth!==a&&(this.gl.lineWidth(a),this._lineWidth=a);return b};a.prototype.setActiveTexture=function(a){var b=this._activeTextureUnit;0<=a&&a!==
this._activeTextureUnit&&(this.gl.activeTexture(d.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return b};a.prototype.clear=function(a){a&&this.gl.clear(a)};a.prototype.drawArrays=function(a,c,d){this.gl.drawArrays(a,c,d)};a.prototype.drawElements=function(a,c,d,g){5123===d?this.gl.drawElements(a,c,d,g):5125===d&&this._extensions.elementIndexUint?this.gl.drawElements(a,c,d,g):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made")};
a.prototype.drawArraysInstanced=function(a,c,d,g){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(a,c,d,g):console.error("Extension ANGLE_instanced_arrays isn't supported!")};a.prototype.drawElementsInstanced=function(a,c,d,g,e){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(a,c,d,g,e):console.error("Extension ANGLE_instanced_arrays isn't supported!")};a.prototype.setViewport=function(a,c,
d,g){var b=this._viewport;if(b.x!==a||b.y!==c||b.width!==d||b.height!==g)b.x=a,b.y=c,b.width=d,b.height=g,this.gl.viewport(a,c,d,g)};a.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};a.prototype.bindProgram=function(a){a?this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),this._activeShaderProgram=null)};a.prototype.bindTexture=function(b,
c){void 0===c&&(c=0);-1===a._MAX_TEXTURE_IMAGE_UNITS&&(a._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(c>=a._MAX_TEXTURE_IMAGE_UNITS||0>c)&&console.error("Input texture unit is out of range of available units!");var d=this._textureUnitMap[c];this.setActiveTexture(c);null==b||null==b.glName?(null!=d&&(this.gl.bindTexture(d.descriptor.target,null),d.setBoundToUnit(c,!1)),this._textureUnitMap[c]=null):d&&d.id===b.id?b.applyChanges():(this.gl.bindTexture(b.descriptor.target,
b.glName),b.setBoundToUnit(c,!0),b.applyChanges(),this._textureUnitMap[c]=b)};a.prototype.bindFramebuffer=function(a){a?this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null)};a.prototype.bindBuffer=function(b){b&&(34962===b.bufferType?this._activeVertexBuffer=a._bindBuffer(this.gl,b,b.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=
a._bindBuffer(this.gl,b,b.bufferType,this._activeIndexBuffer))};a.prototype.unbindBuffer=function(b){34962===b?this._activeVertexBuffer=a._bindBuffer(this.gl,null,b,this._activeVertexBuffer):this._activeIndexBuffer=a._bindBuffer(this.gl,null,b,this._activeIndexBuffer)};a.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=
null)};a.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};a.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};a.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};a.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,
0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,
0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};a.prototype.enforceState=function(){var a=this.gl,c=this._extensions.vao;c&&c.bindVertexArrayOES(null);for(var f=0;f<this.parameters.maxVertexAttributes;f++)a.disableVertexAttribArray(f);this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):
a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(c&&this._activeVertexArrayObject){if(c=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(c)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,
this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);
a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);
a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,
this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(c=0;c<this.parameters.maxTextureImageUnits;c++)a.activeTexture(d.BASE_TEXTURE_UNIT+c),a.bindTexture(3553,null),(f=this._textureUnitMap[c])&&a.bindTexture(f.descriptor.target,f.glName);a.activeTexture(d.BASE_TEXTURE_UNIT+this._activeTextureUnit);a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};
a._bindBuffer=function(a,c,d,g){if(!c)return a.bindBuffer(d,null),null;if(g===c)return g;a.bindBuffer(d,c.glName);return c};return a}();m._MAX_TEXTURE_IMAGE_UNITS=-1;return m})},"esri/views/webgl/Extensions":function(){define(["require","exports"],function(m,h){return function(){function d(c,a){this._disjointTimerQueryInit=this._compressedTextureS3TCInit=this._shaderTextureLODInit=this._textureFilterAnisotropicInit=this._depthTextureInit=this._elementIndexUintInit=this._standardDerivativesInit=this._angleInstancedArraysInit=
this._vaoInit=!1;this._gl=c;a&&a.disabledExtensions&&(c=a.disabledExtensions,c.vao&&(this._vao=null,this._vaoInit=!0),c.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0),c.standardDerivatives&&(this._standardDerivatives=null,this._standardDerivativesInit=!0),c.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0),c.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0),c.textureFilterAnisotropic&&(this._textureFilterAnisotropic=
null,this._textureFilterAnisotropicInit=!0),c.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0),c.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0),c.disjointTimerQuery&&(this._disjointTimerQuery=null,this._disjointTimerQueryInit=!0))}Object.defineProperty(d.prototype,"vao",{get:function(){this._vaoInit||(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),
this._vaoInit=!0);return this._vao},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"angleInstancedArrays",{get:function(){this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0);return this._angleInstancedArrays},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"standardDerivatives",{get:function(){this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),
this._standardDerivativesInit=!0);return this._standardDerivatives},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"elementIndexUint",{get:function(){this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=!0);return this._elementIndexUint},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"depthTexture",{get:function(){this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||
this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0);return this._depthTexture},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"textureFilterAnisotropic",{get:function(){this._textureFilterAnisotropicInit||(this._textureFilterAnisotropic=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),
this._textureFilterAnisotropicInit=!0);return this._textureFilterAnisotropic},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"shaderTextureLOD",{get:function(){this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=!0);return this._shaderTextureLOD},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"compressedTextureS3TC",{get:function(){this._compressedTextureS3TCInit||(this._compressedTextureS3TC=
this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0);return this._compressedTextureS3TC},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"disjointTimerQuery",{get:function(){this._disjointTimerQueryInit||(this._disjointTimerQuery=this._gl.getExtension("EXT_disjoint_timer_query"),this._disjointTimerQueryInit=!0);return this._disjointTimerQuery},enumerable:!0,configurable:!0});return d}()})},"esri/views/3d/webgl-engine/lib/ProgramRepository":function(){define(["require",
"exports","./Util"],function(m,h,d){return function(){function c(){this.shaderVariators={};this._nextId=0;this._programsByName={};this._namesById=[];this._programRefCount=[];this._commonUniforms={model:[],modelNormal:[],lightDirection:[],proj:[],shadowMapDistance:[],viewportPixelSz:[],lightingMainDirection:[]}}c.prototype.dispose=function(){for(var a in this._programsByName)this._programsByName[a].dispose();this._programRefCount=this._namesById=this._programsByName=null};c.prototype.add=function(a,
b){d.assert(null==this._programsByName[a]);this._programsByName[a]=b;this._namesById[b.id]=a};c.prototype.get=function(a){return this._programsByName[a]};c.prototype.addShaderVariations=function(a,b){this.shaderVariators[a]=b};c.prototype.getShaderVariations=function(a){return this.shaderVariators[a]};c.prototype.getShaderVariationsProgram=function(a,b,c,d){return(a=this.getShaderVariations(a))&&a.getProgram(b,c,d)};c.prototype.getProgramsUsingUniform=function(a){return this._commonUniforms[a]||[]};
c.prototype.increaseRefCount=function(a){var b=a.id;this._programRefCount[b]?this._programRefCount[b]++:(this._programRefCount[b]=1,this._findCommonUniforms(a))};c.prototype.decreaseRefCount=function(a){var b=a.id;1<this._programRefCount[b]?this._programRefCount[b]--:(this._forgetCommonUniforms(a),this._programRefCount[b]=0)};c.prototype._getNextId=function(){return this._nextId++};c.prototype._findCommonUniforms=function(a){for(var b in this._commonUniforms)a.hasUniform(b)&&(d.assert(-1===this._commonUniforms[b].indexOf(a),
"common uniforms of program have already been determined"),this._commonUniforms[b].push(a))};c.prototype._forgetCommonUniforms=function(a){for(var b in this._commonUniforms){var c=this._commonUniforms[b],d=c.indexOf(a);-1<d&&(c[d]=c[c.length-1],c.pop())}};return c}()})},"esri/views/3d/webgl-engine/lib/Selector":function(){define("require exports dojo/has ./PerformanceTimer ./gl-matrix ./Object3D".split(" "),function(m,h,d,c,a,b){var k=a.vec3d.create(),f=a.vec3d.create();m=function(){function b(b,
c,d,f,l,k,h,r){void 0===r&&(r=!1);this.dir=a.vec3d.create();this.normalDir=null;this.minResult=new g;this.maxResult=new g;this.transform=a.mat4d.create();this._transformInverse=new e({value:this.transform},a.mat4d.inverse,a.mat4d.create);this._transformInverseTranspose=new e(this._transformInverse,a.mat4d.transpose,a.mat4d.create);this._transformTranspose=new e({value:this.transform},a.mat4d.transpose,a.mat4d.create);this._transformInverseRotation=new e({value:this.transform},a.mat4d.toInverseMat3,
a.mat3d.create);this.enableHUDSelection=!0;this.enableInvisibleTerrain=!1;this.enableBackfacesTerrain=!0;this.performanceInfo={queryDuration:0,numObjectsTested:0};this.viewingMode=b||"global";this.intersectObject=this.intersectObject.bind(this);this.init(c,d,f,l,k,h,r)}b.prototype.init=function(b,c,d,e,f,g,l){c&&d&&a.vec3d.subtract(d,c,this.dir);this.minResult.init(c,d);this.maxResult.init(c,d);this.numObjectsTested=0;this.point=e;this.camera=f;this.isSelection=l;this.layers=b;this.p0=c;this.p1=d;
this.hudResults=[];null==g&&(g=1E-5);this.tolerance=g;if(this.layers)for(b=0;b<this.layers.length;++b)if(c=this.layers[b],d=c.getSpatialQueryAccelerator?c.getSpatialQueryAccelerator():void 0)d.forEachAlongRay(this.p0,this.dir,this.intersectObject);else for(c=c.getObjects(),d=0;d<c.length;++d)this.intersectObject(c[d])};Object.defineProperty(b.prototype,"transformInverse",{get:function(){return this._transformInverse.value},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"transformInverseTranspose",
{get:function(){return this._transformInverseTranspose.value},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"transformInverseRotation",{get:function(){return this._transformInverseRotation.value},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"transformTranspose",{get:function(){return this._transformTranspose.value},enumerable:!0,configurable:!0});b.prototype.getDirection=function(){this.normalDir||(this.normalDir=a.vec3d.create(),a.vec3d.normalize(this.dir,
this.normalDir));return this.normalDir};b.prototype.intersectObject=function(b){var c=this;this.numObjectsTested++;for(var d=b.getId(),e=b.getGeometryRecords(),l=b.objectTransformation,p,h=0;h<e.length;h++){var r=e[h],m=r.geometry,B=r.materials,C=r.instanceParameters;p=m.getId();a.mat4d.set(l,this.transform);a.mat4d.multiply(this.transform,r.getShaderTransformation());this._transformInverse.invalidate();this._transformInverseTranspose.invalidate();this._transformTranspose.invalidate();this._transformInverseRotation.invalidate();
a.mat4d.multiplyVec3(this.transformInverse,this.p0,k);a.mat4d.multiplyVec3(this.transformInverse,this.p1,f);B[0].intersect(m,C,this.transform,this,k,f,function(a,e,f,l,k,h){0<=a&&(k?(k=new g,k.set(b,d,a,e,l,h,p,f),c.hudResults.push(k)):((null==c.minResult.priority||l>=c.minResult.priority)&&(null==c.minResult.dist||a<c.minResult.dist)&&c.minResult.set(b,d,a,e,l,null,p,f),(null==c.maxResult.priority||l>=c.maxResult.priority)&&(null==c.maxResult.dist||a>c.maxResult.dist)&&c.maxResult.set(b,d,a,e,l,
null,p,f)))},r.customTransformation)}};b.prototype.getMinResult=function(){return this.minResult};b.prototype.getMaxResult=function(){return this.maxResult};b.prototype.getHudResults=function(){return this.hudResults};return b}();m.DEFAULT_TOLERANCE=1E-5;var g=function(){function c(b,c){this.normal=a.vec3d.create();this.init(b,c)}c.prototype.getIntersectionPoint=function(b){if(null==this.dist)return!1;a.vec3d.lerp(this.p0,this.p1,this.dist,b);return!0};c.prototype.set=function(c,d,e,f,g,l,k,h){this.dist=
e;a.vec3d.set(f,this.normal);this.targetType=c?c instanceof b?"StageObject":"StagePoint":"None";this.target=c;this.name=d;this.priority=g;this.center=l?a.vec3d.create(l):null;this.geometryId=k;this.triangleNr=h};c.prototype.setIntersector=function(a){this.intersector=a};c.prototype.init=function(a,b){this.dist=void 0;this.targetType="None";this.priority=this.name=this.target=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="stage";this.p0=a;this.p1=b};return c}(),e=function(){function a(a,
b,c){this.original=a;this.update=b;this.dirty=!0;this.transform=c()}a.prototype.invalidate=function(){this.dirty=!0};Object.defineProperty(a.prototype,"value",{get:function(){this.dirty&&(this.update(this.original.value,this.transform),this.dirty=!1);return this.transform},enumerable:!0,configurable:!0});return a}();return m})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ./IdGen ./Util ./gl-matrix ./ComponentUtils ./HighlightUtils ./ModelContentType ./GeometryRecord".split(" "),
function(m,h,d,c,a,b,k,f,g){var e=c.assert,l=a.mat4d,p=a.vec3d;m=function(){function a(b){void 0===b&&(b={});this._bvObjectSpace=new v;this._bvWorldSpace=new v;this._bvDirty=!0;this._hasVolatileTransformation=!1;this.id=a._idGen.gen(b.idHint);this.name=b.name;this.castShadow=null!=b.castShadow?b.castShadow:!0;this.metadata=b.metadata;this.objectTransformation=l.identity();this._initializeGeometryRecords(b.geometries,b.materials,b.transformations)}a.prototype._initializeGeometryRecords=function(a,
b,c){if(Array.isArray(a)){e(b.length===a.length,"Object3D: materials don't match geometries");e(c.length===a.length,"Object3D: transformations don't match geometries");this.geometryRecords=Array(a.length);this.geometries=a.slice();for(var d=0;d<a.length;d++)e(Array.isArray(b[d]),"Object3D: materials parameter must be array of array"),this.geometryRecords[d]=new g(a[d],b[d].slice(),l.create(c[d]),{});this._hasVolatileTransformation=!1}else this.geometryRecords=[],this.geometries=[]};a.prototype.getId=
function(){return this.id};Object.defineProperty(a.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(a){e(null==this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,configurable:!0});a.prototype.getParentLayer=function(){return this.parentLayer};a.prototype.addParentLayer=function(a){this.parentLayer=a};a.prototype.removeParentLayer=function(a){this.parentLayer=null};a.prototype.getNumGeometryRecords=function(){return this.geometryRecords.length};
a.prototype.getFirstGeometryIndex=function(a){a=this.geometries.indexOf(a);e(-1<a,"Object3D.getFirstGeometryIndex: geometry not found");return a};a.prototype.findGeometryRecords=function(a){for(var b=[],c=0;c<this.geometries.length;c++)this.geometries[c]===a&&b.push(this.geometryRecords[c]);return b};a.prototype.getGeometryRecord=function(a){e(0<=a&&a<this.geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this.geometryRecords[a]};a.prototype.getGeometryRecords=function(){return this.geometryRecords};
a.prototype.addGeometry=function(a,b,c,d,f,k){e(Array.isArray(b),"Object3D.addGeometry: materials must be array");this.geometries.push(a);a=new g(a,b.slice(),l.create(c),d||{},f,k);this.geometryRecords.push(a);this._hasVolatileTransformation=this.geometryRecords.some(function(a){return!!a.customTransformation});this._notifyDirty("objGeometryAdded",a);this._invalidateBoundingVolume();return a};a.prototype.hasGeometry=function(a){return-1<this.geometries.indexOf(a)};a.prototype.removeGeometry=function(a){var b=
this.geometryRecords.splice(a,1)[0];this._hasVolatileTransformation=this.geometryRecords.some(function(a){return!!a.customTransformation});this.geometries.splice(a,1);this._notifyDirty("objGeometryRemoved",b);this._invalidateBoundingVolume();return b};a.prototype.geometryVertexAttrsUpdated=function(a){this._notifyDirty("vertexAttrsUpdated",this.geometryRecords[a]);this._invalidateBoundingVolume()};a.prototype.geometryColorAttrsUpdated=function(a){this._notifyDirty("colorAttrsUpdated",this.geometryRecords[a])};
a.prototype.isAllHidden=function(){for(var a=0,c=this.geometryRecords;a<c.length;a++){var d=c[a],e=d.instanceParameters.componentVisibilities,d=d.geometry.getData().componentOffsets;if(!b.isAllHidden(e,d))return!1}return!0};a.prototype.isAllVisible=function(){for(var a=0,c=this.geometryRecords;a<c.length;a++){var d=c[a],e=d.instanceParameters.componentVisibilities,d=d.geometry.getData().componentOffsets;if(!b.isAllVisible(e,d))return!1}return!0};a.prototype.hasComponents=function(){for(var a=!1,c=
0;c<this.geometries.length&&!(a=this.geometries[c].getData(),a=b.hasComponents(a.componentOffsets));c++);return a};a.prototype.setComponentVisibility=function(a,c,d){var e=a.instanceParameters.componentVisibilities,f=a.geometry.getData().componentOffsets;c=b.updateVisibility(e,f,c,d);a.instanceParameters.componentVisibilities=c;this._notifyDirty("componentVisibilityChanged",a)};a.prototype.getComponentVisibility=function(a,c){return b.getVisibility(a.instanceParameters.componentVisibilities,c)};a.prototype.hideAllComponents=
function(){for(var a=0,c=this.geometryRecords;a<c.length;a++){var d=c[a],e=b.hideAllComponents(d.instanceParameters.componentVisibilities);d.instanceParameters.componentVisibilities=e}this._notifyDirty("componentVisibilityChanged")};a.prototype.unhideAllComponents=function(){for(var a=0,c=this.geometryRecords;a<c.length;a++){var d=c[a],e=b.unhideAllComponents(d.instanceParameters.componentVisibilities);d.instanceParameters.componentVisibilities=e}this._notifyDirty("componentVisibilityChanged")};a.prototype._setComponentHighlight=
function(a,c,d,e){c=b.addHighlight(a.instanceParameters.componentHighlights,c,d,e);a.instanceParameters.componentHighlights=c};a.prototype.setComponentHighlight=function(a,b,c){var d=k.generateHighlightId();this._setComponentHighlight(a,b,c,d);this._notifyDirty("componentHighlightChanged");return d};a.prototype.highlightAllComponents=function(a){for(var b=k.generateHighlightId(),c=0,d=this.geometryRecords;c<d.length;c++)this._setComponentHighlight(d[c],null,a,b);this._notifyDirty("componentHighlightChanged");
return b};a.prototype.removeHighlights=function(a){for(var c=0,d=this.geometryRecords;c<d.length;c++){var e=d[c].instanceParameters,f=b.removeHighlight(e.componentHighlights,a);e.componentHighlights=f}this._notifyDirty("componentHighlightChanged")};a.prototype.getFaceRangeIndexFromTriangleNr=function(a){var b=this.metadata.faceRanges;if(null!=b)for(var c=0;c<b.length;c++)if(b[c][0]<=a&&b[c][1]>=a)return c};a.prototype.getFaceRangeFromTriangleNr=function(a){a=this.getFaceRangeIndexFromTriangleNr(a);
var b=this.metadata.faceRanges;return a?[b[a]]:null};a.prototype.setGeometryTransformation=function(a,b){e(0<=a&&a<this.geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var c=this.geometryRecords[a];b=new g(c.geometry,c.materials,l.create(b),c.instanceParameters);this.geometryRecords[a]=b;this._notifyDirty("objGeometryReplaced",[c,b]);this._invalidateBoundingVolume()};a.prototype.getObjectTransformation=function(){return l.create(this.objectTransformation)};a.prototype.setObjectTransformation=
function(a){l.set(a,this.objectTransformation);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")};a.prototype.getCombinedStaticTransformation=function(a,b){b=b||l.create();l.multiply(this.objectTransformation,a.getStaticTransformation(),b);return b};a.prototype.getCombinedShaderTransformation=function(a,b){b=b||l.create();l.multiply(this.objectTransformation,a.getShaderTransformation(),b);return b};a.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation};
a.prototype.getCastShadow=function(){return this.castShadow};a.prototype.setCastShadow=function(a){this.castShadow=a};a.prototype.getMetadata=function(){return this.metadata};a.prototype.getName=function(){return this.name};a.prototype.getBBMin=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};a.prototype.getBBMax=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};a.prototype.getCenter=function(a){this._validateBoundingVolume();
return a?this._bvObjectSpace.center:this._bvWorldSpace.center};a.prototype.getBSRadius=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};a.prototype._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var a=0;a<this.geometryRecords.length;++a)for(var b=this.geometries[a],c=this.geometryRecords[a],d=b.getNumGroups(),e=0;e<d;++e){var f=b.getBoundingInfo(e);
this._calculateTransformedBoundingVolume(f,this._bvObjectSpace,c.getShaderTransformation());this._calculateTransformedBoundingVolume(f,this._bvWorldSpace,this.getCombinedShaderTransformation(c))}p.lerp(this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5,this._bvObjectSpace.center);p.lerp(this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5,this._bvWorldSpace.center);for(var c=p.create(),g=p.create(),k=this._getScaleFactor(this.objectTransformation),a=0;a<this.geometryRecords.length;++a)for(var b=
this.geometries[a],h=this.geometryRecords[a].getShaderTransformation(),q=this._getScaleFactor(h),d=b.getNumGroups(),e=0;e<d;++e){f=b.getBoundingInfo(e);l.multiplyVec3(h,f.getCenter(),c);var v=p.dist(c,this._bvObjectSpace.center),f=f.getBSRadius()*q;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,v+f);l.multiplyVec3(this.objectTransformation,c,g);v=p.dist(g,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,v+f*k)}this._bvDirty=!1}};a.prototype._calculateTransformedBoundingVolume=
function(a,b,c){var d=a.getBBMin();a=a.getBBMax();for(var e=p.create(),f=p.create(),g=-1;3>g;++g){p.set(d,e);p.set(a,f);-1<g&&(e[g]=a[g],f[g]=d[g]);l.multiplyVec3(c,e);l.multiplyVec3(c,f);for(var k=0;3>k;++k)b.bbMin[k]=Math.min(b.bbMin[k],e[k],f[k]),b.bbMax[k]=Math.max(b.bbMax[k],e[k],f[k])}};a.prototype._getScaleFactor=function(a){return Math.max(Math.max(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))};a.prototype._invalidateBoundingVolume=
function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace)};a.prototype._notifyDirty=function(a,b,c,d){this._parentLayer&&(c=c||f.OBJECT,this._parentLayer.notifyDirty(a,b,c,d||this))};return a}();m._idGen=new d;var v=function(){function a(){this.bbMin=p.create();this.bbMax=p.create();this.center=p.create();this.bsRadius=0}a.prototype.init=function(){p.set3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.bbMin);p.set3(-Number.MAX_VALUE,-Number.MAX_VALUE,
-Number.MAX_VALUE,this.bbMax);p.set3(0,0,0,this.center);this.bsRadius=0};a.prototype.getCenter=function(){return this.center};a.prototype.getBSRadius=function(){return this.bsRadius};return a}();return m})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","./IdGen"],function(m,h,d){m=function(){function c(a,b,d,f,g,e){this.id=c._idGen.gen(a.getId());this.geometry=a;this.materials=b;this.transformation=d;this.instanceParameters=f;this.origin=g;this.customTransformation=
e}c.prototype.getId=function(){return this.id};c.prototype.getStaticTransformation=function(){return this.transformation};c.prototype.getShaderTransformation=function(){return this.customTransformation?this.customTransformation(this.transformation):this.transformation};return c}();m._idGen=new d;return m})},"esri/views/3d/support/CombinedElevationProvider":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ./Evented".split(" "),
function(m,h,d,c,a,b,k){m=function(a){function b(b){var c=a.call(this)||this;c.providers={im:[],ground:[],scene:[]};c.handles=new Map;c.elevationChange=function(a){c.emit("elevation-change",a)};c.view=b;return c}d(b,a);b.prototype.getElevation=function(a,b){var c=-Infinity,d=!1;if("scene"===b)for(var e=0,f=this.providers.im;e<f.length;e++){var g=f[e],g=g.getElevation(a,b);null!=g&&(c=Math.max(g,c),!d&&isFinite(c)&&(d=!0))}if(!d)for(d=0,e=this.providers.ground;d<e.length;d++)g=e[d],g=g.getElevation(a,
b),null!=g&&(c=Math.max(g,c));if("scene"===b)for(d=0,e=this.providers.scene;d<e.length;d++)g=e[d],g=g.getElevation(a,b),null!=g&&(c=Math.max(g,c));return isFinite(c)?c:null};b.prototype.register=function(a,b){this.handles.set(b,b.on("elevation-change",this.elevationChange));this.providers[a].push(b)};b.prototype.unregister=function(a){this.handles.has(a)&&(this.handles.get(a).remove(),this.handles.delete(a));for(var b=0,c=Object.keys(this.providers);b<c.length;b++){var d=c[b],e=this.providers[d].indexOf(a);
-1<e&&this.providers[d].splice(e,1)}};return b}(a.declared(b,k.Evented));c([a.property({readOnly:!0})],m.prototype,"view",void 0);c([a.property({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],m.prototype,"spatialReference",void 0);return m=c([a.subclass("esri.views.3d.support.CombinedElevationProvider")],m)})},"esri/views/3d/support/Evented":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function d(){this._listeners=
{}}d.prototype.hasEventListener=function(c){return null!=this._listeners[c]&&0<this._listeners[c].size};d.prototype.on=function(c,a){var b=this;null==this._listeners[c]&&(this._listeners[c]=new Map);var d={};this._listeners[c].set(d,a);return{remove:function(){return b._listeners[c].delete(d)}}};d.prototype.emit=function(c,a){null!=this._listeners[c]&&this._listeners[c].forEach(function(b){return b(a)})};return d}();h.Evented=m})},"esri/views/3d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor ../../../Color".split(" "),
function(m,h,d,c,a,b,k){m=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=null;b.haloOpacity=null;b.fillOpacity=null;return b}d(b,a);b.prototype.getDefaults=function(){return{color:new k([0,255,255]),haloOpacity:1,fillOpacity:.25}};b.toEngineOptions=function(a){return{color:new Float32Array(k.toUnitRGBA(a.color)),haloOpacity:a.haloOpacity,haloOpacityOccluded:.25*a.haloOpacity,fillOpacity:a.fillOpacity,fillOpacityOccluded:.25*a.fillOpacity}};return b}(b);c([a.property({type:k})],
m.prototype,"color",void 0);c([a.property()],m.prototype,"haloOpacity",void 0);c([a.property()],m.prototype,"fillOpacity",void 0);return m=c([a.subclass()],m)})},"esri/core/accessorSupport/typescript":function(){define(["../declare","../typescript","../JSONSupport","dojo/_base/lang"],function(m,h,d,c){function a(b,c){if(!b)return c;if(!c)return b;for(var d in c){var g=b[d],e=c[d];Array.isArray(e)&&Array.isArray(g)?b[d]=g.concat(e):b[d]="object"===typeof e&&"object"===typeof g?a(g,e):e}return b}return{subclass:function(b,
k){return function(f){f=h.declareDefinition(f,b);g&&(f.instanceMembers.properties=a(g,f.instanceMembers.properties));var g=f.instanceMembers.properties;if(g)for(var e in g){var l=g[e];l&&!l.reader&&l.type&&(l.type===Date?l.reader=function(a){return null!=a?new Date(a):null}:-1!==l.type._meta.bases.indexOf(d)&&(l.reader=function(a){return function(b){return a.fromJSON(b)}}(l.type)))}return c.mixin(m(f.bases,f.instanceMembers),f.classMembers)}},shared:h.shared,property:function(a){return function(b,
c){var d=Object.getPrototypeOf(b),d=d&&d.properties;b.properties&&b.properties!==d||(b.properties={});b.properties=b.properties||{};b.properties[c]=a||{}}}}})},"esri/core/typescript":function(){define(["./declare","dojo/_base/lang"],function(m,h){var d={declareDefinition:function(c,a){var b=[],d=Object.getPrototypeOf(c.prototype),f;if(d!==Object.prototype){var g=d.constructor;f=g.prototype;b.push(g)}a&&(b=b.concat(a));a={};for(var g=Object.getOwnPropertyNames(c.prototype),e=0;e<g.length;e++){var l=
g[e];if("constructor"!==l){var p=l;"dojoConstructor"===l&&(p="constructor");f&&c.prototype[l]===f[l]||(a[p]=c.prototype[l])}}g=Object.getOwnPropertyNames(c);d=Object.getOwnPropertyNames(d.constructor);f={};for(e=0;e<g.length;e++)l=g[e],-1===d.indexOf(l)&&(f[l]=c[l]);return{bases:b,instanceMembers:a,classMembers:f}},subclass:function(c){return function(a){a=d.declareDefinition(a,c);return h.mixin(m(a.bases,a.instanceMembers),a.classMembers)}},shared:function(c){return function(a,b){a[b]=c}}};return d})},
"esri/views/3d/support/RenderCoordsHelper":function(){define(["./earthUtils","./projectionUtils","../lib/glMatrix","../webgl-engine/lib/BufferVectorMath","../../../geometry/support/scaleUtils"],function(m,h,d,c,a){var b=d.vec3,k=c.Vec3Compact,f=m.earthRadius,g=[0,0,1];m=function(a){this.spatialReference=a};m.prototype.toRenderCoords=function(a,b,c){return"esri.geometry.Point"===a.declaredClass?h.pointToVector(a,b,this.spatialReference):h.vectorToVector(a,b,c,this.spatialReference)};m.prototype.fromRenderCoords=
function(a,b,c){return"esri.geometry.Point"===b.declaredClass||"esri.SpatialReference"===b.declaredClass?h.vectorToPoint(a,this.spatialReference,b,c):h.vectorToVector(a,this.spatialReference,b,c)};d=function(a){this.spatialReference=a=a||h.SphericalRenderSpatialReference;this.unitInMeters=1};d.prototype=new m;d.prototype.getAltitude=function(a,b){return k.length(a,b||0)-f};d.prototype.setAltitude=function(a,b,c){c=c||0;a=(a+f)/k.length(b,c);k.scale(b,c,a)};d.prototype.setAltitudeOfTransformation=
function(a,b){this.setAltitude(a,b,12)};d.prototype.worldUpAtPosition=function(a,c){b.normalize(a,c)};c=function(b){this.spatialReference=b;this.unitInMeters=a.getUnitValueForSR(b);this.worldUp=g};c.prototype=new m;c.prototype.getAltitude=function(a,b){return b?a[b+2]:a[2]};c.prototype.setAltitude=function(a,b,c){c?b[c+2]=a:b[2]=a};c.prototype.setAltitudeOfTransformation=function(a,b){this.setAltitude(a,b,12)};c.prototype.worldUpAtPosition=function(a,c){b.set(g,c)};c.worldUp=g;m.Spherical=d;m.Planar=
c;return m})},"esri/views/3d/support/MapCoordsHelper":function(){define("dojo/Evented dojo/Deferred ../../../core/declare ../../../portal/support/geometryServiceUtils ../../../tasks/support/ProjectParameters ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/support/scaleUtils".split(" "),function(m,h,d,c,a,b,k,f){return d(m,{unitInMeters:1,spatialReference:null,constructor:function(a,b,d){this.spatialReference=b;this.unitInMeters=f.getUnitValueForSR(this.spatialReference);
(this.geometryService=d)||c.create(a&&a.portalItem).then(function(a){this.geometryService=a}.bind(this)).otherwise(function(){})},toGeographic:function(c){var d=new h,f=!0,g=this.spatialReference;if(!this.geometryService)return d.reject("Must specify geometryService in esri/config"),d;Array.isArray(c[0])&&"number"!==typeof c[0]||(c=[c],f=!1);c.forEach(function(a,b){a instanceof k||(c[b]=new k(a,g))});var v=new a({geometries:c,outSR:b.WGS84});this.geometryService.project(v).then(function(a){try{a=
a.map(function(a){return[a.x,a.y]}),d.resolve(f?a:a[0])}catch(n){d.reject(n)}},function(a){d.reject(a)});return d.promise},canProject:function(){return!!this.geometryService}})})},"esri/portal/support/geometryServiceUtils":function(){define("require exports ../Portal ../PortalItem ../../config ../../tasks/GeometryService ../../core/promiseUtils ../../core/Error".split(" "),function(m,h,d,c,a,b,k,f){Object.defineProperty(h,"__esModule",{value:!0});h.create=function(g){void 0===g&&(g=null);if(a.geometryServiceUrl)return k.resolve(new b({url:a.geometryServiceUrl}));
if(!g)return k.reject(new f("internal:geometry-service-url-not-configured"));var e;g.isInstanceOf(c)?e=g.portal||d.getDefault():g.isInstanceOf(d)&&(e=g);return e.load().then(function(a){if(a.helperServices&&a.helperServices.geometry&&a.helperServices.geometry.url)return k.resolve(new b({url:a.helperServices.geometry.url}));throw new f("internal:geometry-service-url-not-configured");})}})},"esri/views/3d/support/ResourceController":function(){define("../../../core/declare ../../../core/Scheduler ../../../core/HandleRegistry ../../../core/watchUtils ./StreamDataSupplier ./StreamDataLoader ./PreallocArray ../webgl-engine/lib/Util".split(" "),
function(m,h,d,c,a,b,k,f){function g(a){this.budget=this.begin=0;this.performance=f.performance;this.enabled=!0;void 0!==a&&this.reset(a)}var e=f.assert,l={TERRAIN:"terrain",SCENE:"scene",SYMBOLOGY:"symbols"},p=new k(20);g.prototype.now=function(){return this.performance.now()};g.prototype.reset=function(a){this.begin=this.now();this.budget=this.enabled?a:Number.MAX_VALUE};g.prototype.done=function(){return this.enabled&&this.elapsed()>=this.budget};g.prototype.remaining=function(){return Math.max(this.budget-
this.elapsed(),0)};g.prototype.elapsed=function(){return this.now()-this.begin};m=m(null,{constructor:function(a,e){this._clients=[];this._frameWorker=null;this._budget=new g;this._idleFrameWorkers=[];this._idleFrameWorkerRobin=0;this._idleUpdatesStartFired=!1;this._targetReached=!0;this._lastTargetChangeTime=f.performance.now();this.navigationTimeout=300;this.animatingFrameTimeBudget=10;this.idleFrameWorkerBudget=30;this.idleFrameTimeBudget=50;var k={},p;for(p in l)k[l[p]]=0;k[l.TERRAIN]=15;k[l.SCENE]=
20;k[l.SYMBOLOGY]=5;this._maxGpuMemory=500;this.streamDataLoader=new b(k);this._cameraListeners=new d;this._cameraListeners.add([c.on(a,"navigation","currentViewReachedTarget",this._currentViewReachedTargetHandler.bind(this)),c.on(a,"navigation","targetViewChanged",this._targetViewChangedHandler.bind(this))]);e||(e=h);this._frameTask=e.addFrameTask({update:this._frameUpdate.bind(this)});this._view=a;this.stats={frameUpdateTime:new v,idleUpdateTime:new v};this.frameUpdateNavigation=null},destroy:function(){this._frameTask.remove();
this._frameTask=null;this._cameraListeners.remove();this.streamDataLoader.destroy();this.streamDataLoader=null},setEnableBudget:function(a){this._budget.enabled=!!a},registerClient:function(b,c,d){this._clients.push({client:b,type:c});"function"===typeof b.setMaxGpuMemory&&b.setMaxGpuMemory(this._maxGpuMemory);return new a(c,this.streamDataLoader,d)},deregisterClient:function(a){for(var b=0;b<this._clients.length;b++)if(this._clients[b].client===a){this._clients[b]=this._clients[this._clients.length-
1];this._clients.pop();return}console.warn("deregistering an unregistered client.")},setMaxGpuMemory:function(a){this._maxGpuMemory=a;for(var b=0;b<this._clients.length;b++){var c=this._clients[b].client;"function"===typeof c.setMaxGpuMemory&&c.setMaxGpuMemory(a)}},registerIdleFrameWorker:function(a,b){var c=this._idleFrameWorkers.some(function(b){return b.client===a});e(!c,"Can only register idle frame workers once per client/layer");e(!b.idleFrame||b.needsUpdate,"needsUpdate has to be specified if idleFrame is specified");
this._idleFrameWorkers.push({client:a,callbacks:b});this._isIdle()&&this._idleUpdatesStartFired&&b.idleBegin&&b.idleBegin.call(a)},deregisterIdleFrameWorker:function(a){for(var b=this._idleFrameWorkers,c=0;c<b.length;c++){var d=b[c];if(d.client===a){this._idleUpdatesStartFired&&d.callbacks.idleEnd&&d.callbacks.idleEnd.call(a);b[c]=b[b.length-1];b.pop();break}}},registerFrameWorker:function(a){e(!this._frameWorker,"Only one (non-idle) per-frame worker supported at the moment");this._frameWorker=a},
deregisterFrameWorker:function(){this._frameWorker=null},_targetViewChangedHandler:function(a){this._lastTargetChangeTime=f.performance.now();this._targetReached=!1;this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._callWorkersNoScheduling("idleEnd"))},_currentViewReachedTargetHandler:function(a){this._targetReached=!0},_frameUpdate:function(a){var b=this._isIdle()?this.idleFrameWorkerBudget:this.animatingFrameTimeBudget;this._budget.reset(b-a.spendInFrame);this._view.navigation&&
this._view.navigation.step(a.deltaTime);this._view.inputManager&&this._view.inputManager._pinchNavigation&&this._view.inputManager._pinchNavigation.momentum.doFrameUpdate(a.deltaTime);this._frameWorker&&(this._frameWorker(this._budget),this.stats.frameUpdateTime.addSample(this._budget.elapsed()));this._isIdle()&&(this._idleUpdatesStartFired||(this._callWorkersNoScheduling("idleBegin"),this._idleUpdatesStartFired=!0),this._budget.reset(this.idleFrameTimeBudget-this._budget.elapsed()),3<this._budget.remaining()&&
(this._callWorkersStrictScheduling("idleFrame",this._budget),this.stats.idleUpdateTime.addSample(this._budget.elapsed())))},_isIdle:function(){return this._budget.now()-this._lastTargetChangeTime>this.navigationTimeout&&this._targetReached},_callWorkersNoScheduling:function(a){for(var b=this._idleFrameWorkers,c=0;c<b.length;c++){var d=b[c];d.callbacks[a]&&d.callbacks[a].call(d.client)}},_callWorkersStrictScheduling:function(a,b){var c=this._idleFrameWorkers,d=c.length,e,f,g;p.clear();f=0;for(g=this._idleFrameWorkerRobin;f<
d;f++)e=c[g++%d],e.callbacks.needsUpdate&&e.callbacks.needsUpdate.call(e.client)&&(0===p.length&&(this._idleFrameWorkerRobin=g),p.push(e));e=b.now();for(c=e+b.remaining();0<p.length&&e<c;)b.reset((c-e)/p.length),e=p.pop(),e.callbacks[a].call(e.client,b),e=b.now()}});m.ClientType=l;var v=function(){this.addSample=function(a){this.min=Math.min(this.min,a);this.max=Math.max(this.max,a);this.total+=a;this.numSamples++};this.getAverage=function(){return this.total/this.numSamples};this.reset=function(){this.numSamples=
this.total=0;this.min=Number.MAX_VALUE;this.max=-Number.MAX_VALUE};this.reset()};return m})},"esri/views/3d/support/StreamDataSupplier":function(){define(["require","exports"],function(m,h){return function(){function d(c,a,b){this._clientType=c;this._loader=a;this._activeRequests=null;this._addUrlToken=b&&b.addUrlToken;b&&b.trackRequests&&(this._activeRequests=new Map)}d.prototype.request=function(c,a,b){var d=this;a=this._loader.request(c,a,this._clientType,b,this._addUrlToken);this._activeRequests&&
(this._activeRequests.set(c,a),b=function(){d._activeRequests.delete(c)},a.then(b,b));return a};d.prototype.isRequested=function(c){return this._loader.isRequested(c)};d.prototype.cancelRequest=function(c){this._loader.cancel(c)};d.prototype.cancelAll=function(){var c=this;this._activeRequests&&(this._activeRequests.forEach(function(a){c._loader.cancel(a)}),this._activeRequests.clear())};return d}()})},"esri/views/3d/support/StreamDataLoader":function(){define("../../../core/declare ../../../request ../../../core/urlUtils ./PromiseLightweight ./AsyncQuotaRoundRobinQueue ../webgl-engine/lib/Util".split(" "),
function(m,h,d,c,a,b){var k=b.assert,f={QUEUED:1,DOWNLOADING:2,CANCELLED:4};m=m(null,{constructor:function(b){this.alreadyLoading={};this.loadQueue=new a(e,this._doneLoadingCallback,this,b);this._urlInfo={hasSameOrigin:{},canUseXhr:{}}},destroy:function(){for(var a in this.alreadyLoading){for(var b=this.alreadyLoading[a],c=0;c<b.clientPromises.length;c++){var d=b.clientPromises[c];d.isRejected()||d.reject(b.url.url,null,b.docType,b.clientMetadata[c])}this._cancelTask(b)}this.loadQueue.clear();this.alreadyLoading=
this.loadQueue=null},request:function(a,b,d,e,g){e=e||{};var l=new c.Promise(function(){this.cancel(l)}.bind(this));l.requestURL=a;var k=this.alreadyLoading[a];k?(k.clientPromises.push(l),k.clientMetadata.push(e.metadata)):(k={url:{url:null,normalized:null,normalizedWithToken:null,hasSameOrigin:!1,canUseXhr:!1},docType:b,clientType:d,status:f.QUEUED,clientMetadata:[e.metadata],clientPromises:[l],downloadObj:null,_cancelledInQueue:!1},this._prepareUrl(k,a,g),this.alreadyLoading[a]=k,this.loadQueue.push(k));
return l},isRequested:function(a){return void 0!==this.alreadyLoading[a]},cancel:function(a){var b=this.alreadyLoading[a.requestURL];b&&this._removeRequestPromiseFromTask(b,a)},hasPendingDownloads:function(){return!b.objectEmpty(this.alreadyLoading)},_prepareUrl:function(a,b,c){a.url.url=b;a.url.isData=d.isDataProtocol(b);if(a.url.isData||"image"!==a.docType)a.url.normalized=b,!a.url.isData&&c&&(a.url.normalizedWithToken=c(b));else{b=d.normalize(b);a.url.normalized=b;var e=d.getOrigin(b);c&&(a.url.normalizedWithToken=
c(b));b=this._urlInfo.hasSameOrigin[e];void 0!==b?a.url.hasSameOrigin=b:(a.url.hasSameOrigin=d.hasSameOrigin(e,window.location.href),this._urlInfo.hasSameOrigin[e]=a.url.hasSameOrigin);a.url.hasSameOrigin||(b=this._urlInfo.canUseXhr[e],void 0!==b?a.url.canUseXhr=b:(a.url.canUseXhr=d.canUseXhr(e),this._urlInfo.canUseXhr[e]=a.url.canUseXhr))}},_removeRequestPromiseFromTask:function(a,b){var c=a.clientPromises.length;1<c?(b=a.clientPromises.indexOf(b),k(-1<b,"request to be cancelled is already cancelled or invalid"),
a.clientPromises[b]=a.clientPromises[c-1],a.clientPromises.pop(),a.clientMetadata[b]=a.clientMetadata[c-1],a.clientMetadata.pop()):(k(a.clientPromises[0]===b,"request to be cancelled is already cancelled or invalid"),this._cancelTask(a))},_cancelTask:function(a){if(a.status===f.DOWNLOADING){this.loadQueue.workerCancelled(a);if("image"===a.docType&&a.url.isData){var b=a.downloadObj;b.removeAttribute("onload");b.removeAttribute("onerror");b.removeAttribute("src")}else a.status=f.CANCELLED,a.downloadObj.cancel();
a.downloadObj=null}a.status=f.CANCELLED;a.clientPromises=void 0;a.clientMetadata=void 0;delete this.alreadyLoading[a.url.url]},_doneLoadingCallback:function(a,b){var c;k(a.status===f.DOWNLOADING);delete this.alreadyLoading[a.url.url];if(b)for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].isRejected()||a.clientPromises[c].reject(a.url.url,b,a.docType,a.clientMetadata[c]);else for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].done(a.url.url,a.result,a.docType,a.clientMetadata[c])}});
var g=function(a,b,c){a.onload=function(){b.status!==f.CANCELLED&&(b.result=a,a.removeAttribute("onload"),a.removeAttribute("onerror"),c(b))};a.onerror=function(){b.status!==f.CANCELLED&&(a.removeAttribute("onload"),a.removeAttribute("onerror"),c(b,{status:404}))}},e=function(a,c){if(a.status===f.CANCELLED)return!1;a.status=f.DOWNLOADING;if("image"===a.docType&&a.url.isData){var d=new Image;g(d,a,c);d.src=a.url.normalized;a.downloadObj=d;return!0}var e;switch(a.docType){case "binary":e="array-buffer";
d=0;break;case "image":e="image";break;default:e="json"}a.downloadObj=h(a.url.normalizedWithToken||a.url.normalized,{responseType:e,timeout:d,failOk:!0,crossOrigin:!a.url.hasSameOrigin||a.url.canUseXhr,allowImageDataAccess:"image"===a.docType});a.downloadObj.then(function(d){a.duration=b.performance.now()-a.startTime;a.size=0;a.result=d.data;c(a)},function(b){a.downloadObj.isCanceled()||c(a,b)});return!0};m.TaskStatus=f;return m})},"esri/views/3d/support/PromiseLightweight":function(){(function(m){function h(a){this._callbacks=
[];this._errbacks=[];this._cancelCallback=a;this._iserr=this._isdone=this._iscancelled=!1}function d(a,b){var c=new h;0===a.length?c.done.apply(c,b):a[0].apply(null,b).then(function(){a.splice(0,1);d(a,arguments).then(function(){c.done.apply(c,arguments)})});return c}h.prototype.cancel=function(a){this._callbacks=[];this._errbacks=[];this._iscancelled=!0;this._cancelCallback&&this._cancelCallback(a)};h.prototype.then=function(a,b,c){var d;if(!this._iscancelled)return this._isdone?d=a.apply(c,this.result):
this._iserr&&b?d=b.apply(c,this.result):(this._callbacks.push(function(){return a.apply(c,arguments)}),b&&this._errbacks.push(function(){return b.apply(c,arguments)})),d};h.prototype.done=function(){this.result=arguments;this._isdone=!0;for(var a=0;a<this._callbacks.length;a++)this._callbacks[a].apply(null,arguments);this._callbacks=[];this._errbacks=[]};h.prototype.resolve=h.prototype.done;h.prototype.reject=function(){if(!this._iscancelled){this.result=arguments;this._iserr=!0;for(var a=0;a<this._errbacks.length;a++)this._errbacks[a].apply(null,
arguments);this._callbacks=[];this._errbacks=[]}};h.prototype.isRejected=function(){return this._iserr};h.prototype.isFulfilled=function(){return this._isdone||this._iserr};h.prototype.isResolved=function(){return this._isdone};h.prototype.isCancelled=function(){return this._iscancelled};var c={Promise:h,join:function(a){function b(a,b){return function(){b&&(l=!0);g+=1;e[a]=Array.prototype.slice.call(arguments);g===d&&(l?c.reject():c.done(e))}}for(var c=new h,d=a.length,g=0,e=[],l=!1,p=0;p<d;p++)a[p].then(b(p,
!1),b(p,!0));0===a.length&&c.done();return c},chain:d};"function"===typeof define&&define.amd?define(function(){return c}):m.promise=c})(this)},"esri/views/3d/support/AsyncQuotaRoundRobinQueue":function(){define(["../../../core/arrayUtils","../webgl-engine/lib/Util"],function(m,h){return function(d,c,a,b,k){function f(){return"workers: "+p+", queues: "+l.map(function(a){return a.length})}var g=0,e={},l=[],p=[],v=[],q=[],n=0,t=0,u;for(u in b)l[g]=[],p[g]=0,q[g]={requests:0,size:0,duration:0,speed:0},
v[g]=b[u],e[u]=g++,t+=b[u];var x=l.length,g=0;this.setWorkerQuota=function(a){h.assert(m.equals(Object.keys(this.typeWorkerAllication),Object.keys(a)));this.typeWorkerAllication=a;t=0;for(var b in a)v[e[b]]=a[b],t+=a[b]};this.setWorkerFunc=function(a){d=a};this.push=function(a){var b=e[a.clientType];n<t?(p[b]++,n++,k&&console.log("queue start type "+b+", "+f()),d(a,B)):(l[b].push(a),k&&console.log("queue push type "+b+", "+f()))};this._getStatsForType=function(a){a=e[a];return{quota:v[a],workers:p[a],
queueSize:l[a].length,requestStats:q[a]}};this.removeTasks=function(a,b){for(var c=[],d=l[e[b]],f=0;f<d.length;f++){var g=d[f];-1<a.indexOf(g)||c.push(g)}l[e[b]]=c};this.workerCancelled=function(a){r(a);a._cancelledInQueue=!0};this.clear=function(){for(var a=0;a<l.length;a++)l[a]=[]};var r=function(a){var b=e[a.clientType];p[b]--;n--;q[b].requests++;q[b].size+=a.size||0;q[b].duration+=a.duration||0;q[b].speed=0<q[b].duration?q[b].size/q[b].duration:0;h.assert(0<=p[b]);a=g;b=!1;do p[a]<v[a]&&z(a)&&
(b=!0),a=(a+1)%x;while(!b&&a!=g);if(!b){do z(a)&&(b=!0),a=(a+1)%x;while(!b&&a!=g)}!b&&k&&console.log("queue sink, "+f());g=a},z=function(a){for(;0<l[a].length;){if(d(l[a].shift(),B))return k&&console.log("queue startqueued clientType "+a+", "+f()),p[a]++,n++,!0;k&&console.log("queue task cancelled, "+f())}return!1},B=function(b){b._cancelledInQueue||(c.apply(a,arguments),r(b))}}})},"esri/views/3d/support/PreallocArray":function(){define(["../../../core/declare","./HeapSort"],function(m,h){return m([],
{constructor:function(d,c){this.data=Array(d);this.length=0;if(c){for(var a=0;a<d;a++)this.data[a]=c(a);this._allocator=c;this._hasAllocator=!0}else this._allocator=this._nullAllocator,this._hasAllocator=!1},_nullAllocator:function(){return null},grow:function(d){for(;this.data.length<d;)this.data.push(this._allocator(this.data.length))},next:function(){if(!this._hasAllocator)return null;this.data.length===this.length&&this.grow(2*this.length);return this.data[this.length++]},swap:function(d,c){var a=
this.data[d];this.data[d]=this.data[c];this.data[c]=a},push:function(d){this.data.length===this.length&&this.grow(2*this.length);this.data[this.length++]=d},pushArray:function(d){var c=this.length+d.length;c>=this.data.length&&this.grow(Math.max(2*this.length,c));for(c=0;c<d.length;c++)this.data[this.length++]=d[c]},pushEither:function(d){Array.isArray(d)?this.pushArray(d):this.push(d)},pop:function(){if(0===this.length)return null;var d=this.data[--this.length];this._hasAllocator||(this.data[this.length]=
null);return d},slice:function(d,c){void 0===c&&(c=this.length);return this.data.slice(d,c)},clear:function(){if(!this._hasAllocator)for(var d=0;d<this.length;d++)this.data[d]=null;this.length=0},peek:function(){return 0===this.length?null:this.data[this.length-1]},sort:function(d){h.sort(this.data,0,this.length,d);return this}})})},"esri/views/3d/support/HeapSort":function(){define([],function(){function m(d,c,a,b){for(var k=c,f=a>>>1,g=d[k-1];c<=f;){c=k<<1;c<a&&0>b(d[c-1],d[c])&&++c;var e=d[c-1];
if(0>=b(e,g))break;d[k-1]=e;k=c}d[k-1]=g}function h(d,c){return d<c?-1:d>c?1:0}return{sort:function(d,c,a,b){void 0===c&&(c=0);void 0===a&&(a=d.length);void 0===b&&(b=h);for(var k=a>>>1;k>c;k--)m(d,k,a,b);for(var f=c+1,k=a-1;k>c;k--)a=d[c],d[c]=d[k],d[k]=a,m(d,f,k,b);return d}}})},"esri/views/3d/support/DisplayQualityProfile":function(){define(["require","exports","../../../core/sniff"],function(m,h,d){var c={low:{sceneService:{"3dObject":{lodFactor:.2},point:{lodFactor:1},integratedMesh:{lodFactor:.6},
pointCloud:{lodFactor:.5}},tiledSurface:{lodBias:-1,angledSplitBias:.5},antialiasingEnabled:!1,gpuMemoryLimit:200},high:{sceneService:{"3dObject":{lodFactor:1},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1}},tiledSurface:{lodBias:0,angledSplitBias:1},antialiasingEnabled:!0,gpuMemoryLimit:500}};return function(){function a(){}a.isValidProfile=function(a){return a in c};a.getDefaultProfile=function(){return d("trident")||d("safari")||d("esri-mobile")?"low":"high"};a.apply=
function(a,d){a=c[a];d.qualitySettings.sceneService["3dObject"].lodFactor=a.sceneService["3dObject"].lodFactor;d.qualitySettings.sceneService.point.lodFactor=a.sceneService.point.lodFactor;d.qualitySettings.sceneService.integratedMesh.lodFactor=a.sceneService.integratedMesh.lodFactor;d.qualitySettings.sceneService.pointCloud.lodFactor=a.sceneService.pointCloud.lodFactor;d.qualitySettings.tiledSurface.lodBias=a.tiledSurface.lodBias;d.qualitySettings.tiledSurface.angledSplitBias=a.tiledSurface.angledSplitBias;
d.qualitySettings.antialiasingEnabled=a.antialiasingEnabled;d.qualitySettings.gpuMemoryLimit=a.gpuMemoryLimit};return a}()})},"esri/views/3d/support/QualitySettings":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor".split(" "),function(m,h,d,c,a,b){var k=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);return b}(b);c([a.property({value:1})],k.prototype,
"lodFactor",void 0);var k=c([a.subclass()],k),f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.prototype.getDefaults=function(){return{"3dObject":new k,point:new k,integratedMesh:new k,pointCloud:new k}};return b}(b);c([a.property()],f.prototype,"3dObject",void 0);c([a.property()],f.prototype,"point",void 0);c([a.property()],f.prototype,"integratedMesh",void 0);c([a.property()],f.prototype,"pointCloud",void 0);var f=c([a.subclass()],f),g=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}d(b,a);return b}(b);c([a.property({value:0})],g.prototype,"lodBias",void 0);c([a.property({value:1})],g.prototype,"angledSplitBias",void 0);g=c([a.subclass()],g);m=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.prototype.getDefaults=function(){return{sceneService:new f,tiledSurface:new g,antialiasingEnabled:!0}};return b}(b);c([a.property()],m.prototype,"sceneService",void 0);c([a.property()],m.prototype,"tiledSurface",void 0);c([a.property()],
m.prototype,"antialiasingEnabled",void 0);c([a.property()],m.prototype,"gpuMemoryLimit",void 0);return m=c([a.subclass()],m)})},"esri/views/3d/support/SharedSymbolResources":function(){define("require exports dojo/io-query ./TextureCollection ./ResourceController ../../../identity/IdentityManager ../../../core/watchUtils ../webgl-engine/lib/screenSizePerspectiveUtils".split(" "),function(m,h,d,c,a,b,k,f){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function e(b){var d=this;this.streamDataSupplier=
this.textures=null;this.tokens={};this.graphicsOwners=[];this.screenSizePerspectiveHandle=null;var e=a.ClientType.SYMBOLOGY;this.stage=b.stage;this.focusTracker=b.focusTracker;this.resourceController=b.resourceController;this.streamDataSupplier=this.resourceController.registerClient(this,e,{addUrlToken:function(a){return d.addUrlToken(a)}});this.textures=new c(this.streamDataSupplier,b.stage,{preMultiplyAlpha:!0,wrapClamp:!0});this.screenSizePerspectiveSettings=f.getSettings(b.viewingMode);this.screenSizePerspectiveSettingsLabels=
f.getLabelSettings(b.viewingMode)}e.prototype.destroy=function(){this.resourceController.deregisterClient(this);this.streamDataSupplier=this.textures=null};e.prototype.addGraphicsOwner=function(a){var b=this;this.graphicsOwners.push(a);var c=null;a.layerView&&(c=k.init(a.layerView,"layer.screenSizePerspectiveEnabled",function(){return b.updateScreenSizePerspectiveEnabled()}));return{remove:function(){c&&(c.remove(),c=null,b.updateScreenSizePerspectiveEnabled())}}};e.prototype.updateScreenSizePerspectiveEnabled=
function(){var a=this,b=this.graphicsOwners.some(function(a){return a.layerView&&!0===a.layerView.get("layer.screenSizePerspectiveEnabled")});b&&!this.screenSizePerspectiveHandle?(this.screenSizePerspectiveHandle=this.focusTracker.events.on("distanceToSurfaceChanged",function(){return a.updateScreenSizePerspectiveSettings()}),this.updateScreenSizePerspectiveSettings()):!b&&this.screenSizePerspectiveHandle&&(this.screenSizePerspectiveHandle.remove(),this.screenSizePerspectiveHandle=null)};e.prototype.updateScreenSizePerspectiveSettings=
function(){var a=this.focusTracker;g.distance=a.distanceToSurface;g.fovY=a.fovY;this.screenSizePerspectiveSettings.update(g);this.screenSizePerspectiveSettingsLabels.update(g);this.stage.setNeedsRender()};e.prototype.addUrlToken=function(a){if(0===a.indexOf("data:"))return a;var c=a.match(/^(((?:https?:)?\/\/[^\/]+).*?)(?:\?(.*))?$/);if(!c)return a;var e=c[1],f=c[2],c=d.queryToObject(c[3]||"");"token"in c||(null==this.tokens[f]&&(a=b.findCredential(a),this.tokens[f]=a&&a.token||""),this.tokens[f]&&
(c.token=this.tokens[f]));return(f=d.objectToQuery(c))?e+"?"+f:e};return e}();h.SharedSymbolResources=m;var g={distance:0,fovY:0};h.default=m})},"esri/views/3d/support/TextureCollection":function(){define("../../../core/declare ../../../core/urlUtils dojo/Deferred dojo/_base/lang ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),function(m,h,d,c,a,b,k){var f=k.assert;return m(null,{constructor:function(a,b,c){this._streamDataSupplier=a;this._stage=b;this._textureRecords=
{};this._loadedHandler=this._loadedHandler.bind(this);this._errorHandler=this._errorHandler.bind(this);this._textureOptions=c||{}},acquire:function(b,c,f){var e;if(e=this._textureRecords[b])return e.referenceCount++,e.texture||e.clientDfd;if(c)return f=c(b),this._stage.add(a.ModelContentType.TEXTURE,f),e={texture:f,referenceCount:1},this._textureRecords[b]=e,f;e=new d;c=this._streamDataSupplier.request(b,"image");this._textureRecords[b]={clientDfd:e,loaderDfd:c,texture:null,size:Math.ceil(f||0),referenceCount:1};
c.then(this._loadedHandler,this._errorHandler);return e.promise},release:function(b){var c=this._textureRecords[b];c?(1>c.referenceCount&&console.warn("TextureCollection: reference count is \x3c 1 for "+b),c.referenceCount--,1>c.referenceCount&&(c.texture?(this._stage.remove(a.ModelContentType.TEXTURE,c.texture.getId()),c.texture=null):this._streamDataSupplier.cancelRequest(c.loaderDfd),delete this._textureRecords[b])):console.warn("TextureCollection: texture doesn't exist: "+b)},isInUse:function(a){a=
this._textureRecords[a];f(!a||0<a.referenceCount,"texture record with zero reference count");return!!a},_loadedHandler:function(d,e,k){k=this._textureRecords[d];f(k&&!k.texture);if(h.isSVG(d)&&(k.size||0===e.width&&0===e.height)){d=e.width?e.height/e.width:1;var g=k.size||64;1<d?(e.width=Math.round(g/d),e.height=g):(e.width=g,e.height=Math.round(g*d))}d=c.mixin({width:e.width,height:e.height},this._textureOptions);e=new b(e,"symbol",d);this._stage.add(a.ModelContentType.TEXTURE,e);k.texture=e;k.clientDfd.resolve(e)},
_errorHandler:function(a){a=this._textureRecords[a];f(a&&!a.texture);a.clientDfd.reject()}})})},"esri/views/3d/support/FocusTracker":function(){define("require exports ./Evented ../../../core/HandleRegistry ../../../core/throttle ../lib/glMatrix ../webgl-engine/lib/Selector ./earthUtils".split(" "),function(m,h,d,c,a,b,k,f){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function h(b){this.view=b;this.handles=new c;this.throttledMeasureSurfaceAltitude=a.default(this.measureSurfaceAltitude,
this.updateDistanceToSurface,p,this);this.latestSurfaceAltitude=this.currentSurfaceAltitude=0;this.events=new d.Evented;this.fovY=this.distanceToSurface=0;this.selector=new k(b.viewingMode);this.selector.enableBackfacesTerrain=!1;this.selector.enableInvisibleTerrain=!1;this.handles.add([this.view.navigation.on("currentViewChanged",this.throttledMeasureSurfaceAltitude),this.throttledMeasureSurfaceAltitude]);this.measureSurfaceAltitude()}h.prototype.destroy=function(){this.handles.destroy()};h.prototype.forceUpdate=
function(){this.throttledMeasureSurfaceAltitude.forceUpdate();this.updateDistanceToSurface()};h.prototype.updateLatestSurfaceAltitude=function(){var a=this.view.navigation.currentCamera;this.view.basemapTerrain&&(this.selector.init(null,a.eye,a.center,null,a,null,!1),this.view.basemapTerrain.intersect(this.selector,a.eye,a.center),this.selector.minResult.getIntersectionPoint(g)&&(this.latestSurfaceAltitude=this.view.renderCoordsHelper.getAltitude(g)))};h.prototype.measureSurfaceAltitude=function(){this.updateLatestSurfaceAltitude();
this.updateDistanceToSurface()};h.prototype.updateDistanceToSurface=function(){var a=this.fovY!==this.view.navigation.currentCamera.fovY;this.fovY=this.view.navigation.currentCamera.fovY;var b=this.calculateDistanceToSurface(),c=0<=b,d=this.currentSurfaceAltitude!==this.latestSurfaceAltitude;!c&&d&&(b=this.calculateDistanceToSurface(this.latestSurfaceAltitude),c=0<=b)&&(this.currentSurfaceAltitude=this.latestSurfaceAltitude);d=this.latestSurfaceAltitudeChangesDistanceSignificantly(b);0<=d&&(b=d,c=
!0,this.currentSurfaceAltitude=this.latestSurfaceAltitude);c&&this.distanceToSurface!==b?(this.distanceToSurface=b,this.emitDistanceToSurfaceChanged()):a&&this.emitDistanceToSurfaceChanged()};h.prototype.emitDistanceToSurfaceChanged=function(){e.distanceToSurface=this.distanceToSurface;this.events.emit("distanceToSurfaceChanged",e)};h.prototype.calculateDistanceToSurface=function(a){void 0===a&&(a=this.currentSurfaceAltitude);var c=this.view.navigation,d=c.currentCamera;if(c.intersectManifold(d.eye,
d.viewForward,a,g)){var e=b.vec3d.dist(d.eye,g);if("global"===this.view.viewingMode){var k=f.earthRadius+a;if(b.vec3d.length2(d.eye)<k*k&&e>f.earthRadius/4)return c.intersectManifold(d.eye,d.viewUp,a,g)?b.vec3d.dist(d.eye,g):-1}return e}return-1};h.prototype.latestSurfaceAltitudeChangesDistanceSignificantly=function(a){if(this.latestSurfaceAltitude===this.currentSurfaceAltitude||0>a)return-1;var b=this.calculateDistanceToSurface(this.latestSurfaceAltitude);return 0<b&&Math.abs(b-a)/a>l?b:-1};return h}();
h.FocusTracker=m;var g=b.vec3d.create(),e={distanceToSurface:0},l=.05,p=3E3;h.default=m})},"esri/core/throttle":function(){define(["require","exports"],function(m,h){function d(c,a,b,d){var f=null,g=1E3;"number"===typeof a?(g=a,d=b):(f=a,g=b);var e=0,k,p=function(){e=0;c.apply(d,k)};a=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];f&&f.apply(d,a);k=a;e||(e=setTimeout(p,g))};a.remove=function(){e&&(clearTimeout(e),e=0)};a.forceUpdate=function(){e&&(clearTimeout(e),p())};return a}
Object.defineProperty(h,"__esModule",{value:!0});h.throttle=d;h.default=d})},"esri/views/3d/terrain/TerrainSurface":function(){define("../../../core/declare ../../../core/Accessor ../../../core/arrayUtils ../../../core/Logger ../../../core/watchUtils ../../../core/CollectionFlattener dojo/Evented dojo/on ../lib/glMatrix ../support/projectionUtils ../support/ResourceController ../support/PromiseLightweight ../../../geometry/support/webMercatorUtils ./TerrainRenderer ./OverlayManager ./SurfaceExtentHelper ./SurfaceTilingSchemeLogic ./terrainUtils ./tileUtils ./TerrainConst ./TileGeometryFactory ./SphericalTile ./PlanarTile ./TilemapOnlyTile ./MapTileAgent ./ElevationTileAgent ../support/PreallocArray ../../../core/ObjectPool ../support/aaBoundingRect ../support/mathUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I,F){function N(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function L(a){return a&&("cancel"===a||"cancel"===a.dojoType)}var M=g.vec3d,K=g.vec4d,ba=g.mat4d,X=x.weakAssert,T=c.getLogger("esri.views.3d.terrain"),V=z.MAX_ROOT_TILES,P=80/180*Math.PI,W=z.TileUpdateTypes,U=K.create(),Y=[0,0,0],S=Array(10),ca=[null],ga={spatialReference:null,tile:null},ea={spatialReference:null,extent:null},aa={spatialReference:null,extent:null,scale:0},
R=[-Infinity,-Infinity,Infinity,Infinity],da=function(a){a.remove()},fa=m([h,k],{properties:{ready:{readOnly:!0,get:function(){return!!this.rootTiles}},rootTiles:{readOnly:!0},manifold:{readOnly:!0},tilingScheme:{readOnly:!0},tilingSchemeLogic:{readOnly:!0},tilingSchemeLocked:{readOnly:!0,aliasOf:"tilingSchemeLogic.tilingSchemeLocked"},spatialReference:{readOnly:!0,dependsOn:["tilingScheme"],aliasOf:"tilingScheme.spatialReference"},overlayManager:{value:null},wireframe:{value:!1},opacity:1,cullBackFaces:!1,
renderOrder:1,skirts:!0,frontMostTransparent:!1,tileBackground:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAA2JJREFUeNrs3d1O20AQgFFvRJInQLQBhHj/h0JVW34El1yQ2F73DVq3jTys55zrqUBbPrErZUSZ+vcOsto4AjK76Lqu1vr8+G3mPzjc3D/+eJj/Bcz/cd75R80fbu79BsAVCAQAAgABgABAACAAEAAIAAQAAgABQPOKfQAy83Ho+HnnHzXv49B4A4AAQAAgABAACAAEAAIAAYAAQAAgABAANM4+AKnZB4ifd/5R8/YB8AYAAYAAQAAgABAACAAEAAIAAYAAQAAgAGicfQBSsw8QP+/8o+btA+ANAAIAAYAAQAAgABAACAAEAAIAAYAAQADQOPsApGYfIH7e+UfN2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAXA201QdggAggH0AUrMPED8/jsPL03fns/y8fQC8AUAAIAAQAAgABAACAAGAAEAAIAAQAAgAGmcfgNTsA8TP2weImrcPgDcACAAEAAIAAYAAQAAgABAACAAEAAIAAUDj7AOQmn2A+Hn7AFHz9gHwBgABgABAACAAEAAIAAQAAgABgABgNS4cAf9pu9u3O1+m/n2aplKK/0j+TX86/tVP5+eZ3+729gFIfwWyDxA7bx8gat4+ANkJAAGAAEAAIAAQAAgABAACAAGAAEAAIABonn0AUrMPED9vHyBq3j4A3gAgABAACAAEAAIAAYAAQAAgABAA51VrdQgCAAHAsuwDkJp9gPj5vj+9vvx0PsvP2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAYAAoHH2AUjNPkD8vH2AqHn7AHgDgABAACAAEAAIAAQAAgABgABAACAAEAA0zj4AqdkHiJ+3DxA1bx8AbwAQACQ0DL0AyKuOowBwBYKUSikCIHUBAsAVCAQAAgABgABAALBy9gFIzT5A/Lx9gKj5y6trVyC8AUAAIAAQAAgAVq90Pg5N5gA2AsAVCAQAAgABgABAALB29gFIzT5A/Lx9gKj5q6+3rkB4A4AAQAAgABAACADWzB/IIHsCAsAVCARAlKlWhyAAEAAIABZjH4DU7APEz5+OH2+vT85n+fkvhztXILwBQAAgABAACAAEAGtWigBIHcBGALgCgQBAACAAyPMO9nHosxuHodZx5vB2t691HIdh/nx/Os7/Zsz/fvgXAAAA//8DAF1P1hM2ICMfAAAAAElFTkSuQmCC",
velvetOverground:!0,extent:{},loaded:!1},defaultTileBackground:"data:image/png;base64,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",
constructor:function(){this._set("rootTiles",null);this._iteratorPool=new J(r.IteratorPreorder);this._postorderIterator=new r.IteratorPostorder;this._topLevelTilemapOnlyTiles=Array(z.TILEMAP_SIZE_EXP+1);for(a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._topLevelTilemapOnlyTiles[a]=new D([a-z.TILEMAP_SIZE_EXP,0,0]);this._dataExtent=this._clippingExtent=null;this._rootExtent=[0,0,0,0];this.notifyChange("extent");this._elevationBounds=[0,0];this._frameUpdateLowerPrio=new G(500);this.maxTextureScale=
1.2;this._stage=this._view._stage;this._updateNextFrame=this._lvPendingUpdates=this._pendingUpdates=this.suspended=this.visible=!1;this._vectorTileLayerRequests=0;this._curOverlayOpacity=1;this._curEyePos=M.create();this._curSplitLimits=[0,0,0,0,0,0];this._curFrustumPlanes=Array(6);this._viewProjectionMatrix=ba.identity();for(var a=0;6>a;++a)this._curFrustumPlanes[a]=K.create();this.tilemapStats={tilemapRequestsSent:0,tilemapRequestsPending:0,tilemapRequestErrors:0,fullTilemaps:0,emptyTilemaps:0,
tilesRequested:0,tileRequestsSent:0,tileRequestErrors:0,tilesNotPresent:0};this._layerViews=[[],[]];this._layerIndexByLayerViewId=[{},{}];this._basemapLayerViewHandles={};this._groupLayerViewHandles={};this._layerViewChangesHandle=null;this.hideSkirtsDistanceFromExtentMargin=1.2;this.hideSkirtsMinimumCameraTilt=P},normalizeCtorArgs:function(a,b){this._view=a;this._set("manifold",b);this.TileClass="planar"===b?A:C;return{}},initialize:function(){this._renderer=new q(this.manifold,null,this._view.focusTracker);
this._renderer.loaded=this._setLoaded.bind(this);this._renderer.updateTileBackground(this.tileBackground);this._renderer.install(this._view._stage);this.overlayManager=new n({terrainSurface:this,view:this._view});this.watch("overlayManager.hasHighlights",this._handleHasHighlights.bind(this));this.extentHelper=new ("spherical"===this.manifold?t.SurfaceExtentHelperGlobal:t.SurfaceExtentHelperLocal)({layers:this._view.map.allLayers,layerViews:this._view.allLayerViews,spatialReference:this._view.spatialReference});
a.init(this.extentHelper,"stencilEnabledExtents",function(a){this._renderer.setStencilEnabledLayerExtents(a)}.bind(this));var c;c=this._view.defaultsFromMap?new b({root:this._view.map,rootCollectionNames:this._view.defaultsFromMap.mapCollectionPaths,getChildrenFunction:function(a){return a.layers}}):this._view.map.allLayers;this._set("tilingSchemeLogic",new u({layers:c,extentHelper:this.extentHelper,manifold:this.manifold,viewSpatialReference:this._view.spatialReference}));this.tilingSchemeLogic.watch("tilingScheme",
this._updateTilingSchemeAndExtent.bind(this),!0);this.tilingSchemeLogic.watch("extent",this._updateTilingSchemeAndExtent.bind(this),!0);this._updateTilingSchemeAndExtent();this._streamDataSupplier=this._view.resourceController.registerClient(this,l.ClientType.TERRAIN);this._idleWorkers={needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate};this._view.resourceController.registerFrameWorker(this._frameUpdate.bind(this));this._view.resourceController.registerIdleFrameWorker(this,this._idleWorkers);
this._viewChangeListenerHandles=[];this._viewChangeUpdate=this._viewChangeUpdate.bind(this);this._viewChangeListenerHandles.push(this._view.on("resize",this._viewChangeUpdate));this._viewChangeListenerHandles.push(a.on(this._view,"navigation","currentViewChanged",this._viewChangeUpdate));this._viewChangeListenerHandles.push(this._view.watch("qualitySettings.tiledSurface.lodBias",this._viewChangeUpdate));this._layerViewChangesHandle=this._view.allLayerViews.on("change",this._handleLayerViewChanges.bind(this));
this._handleLayerViewChanges({added:this._view.allLayerViews.toArray(),removed:[],moved:[]});this._clippingChangedHandle=this._view.watch("clippingArea",this._clippingChanged.bind(this));this._updateClippingExtent()},destroy:function(){this._removeAllTiles();this.tilingSchemeLogic.destroy();this._set("tilingSchemeLogic",null);this.extentHelper.destroy();this.extentHelper=null;for(var a in this._basemapLayerViewHandles)this._unregisterTiledLayerView(a);this._view.resourceController.deregisterFrameWorker(this);
this._view.resourceController.deregisterIdleFrameWorker(this);this._view.resourceController.deregisterClient(this);this._viewChangeListenerHandles.forEach(da);for(var b in this._groupLayerViewHandles)this._groupLayerViewHandles[b].forEach(da);this._layerViewChangesHandle.remove();this._clippingChangedHandle.remove();this.overlayManager&&(this.overlayManager.destroy(),this.overlayManager=null);this._renderer.uninstall(this._stage);this._streamDataSupplier=this._stage=this._view=this._renderer=null},
setVisibility:function(a){a!==this.visible&&(this.visible=a,this._renderer.setVisibility(a),this.setUpdatesDisabled(!a),a&&this._viewChangeUpdate())},isVisible:function(){return this.visible&&this.ready},setUpdatesDisabled:function(a){(this.suspended=a)||this._viewChangeUpdate()},intersect:function(a,b,c){return this._renderer.intersect(a,b,c)},getElevation:function(a){if(!this.ready)return null;var b=z.LayerClass.ELEVATION,c=this.rootTiles,d=c[0].layerInfo[b].length;if(0===d)return null;S.length<
d&&(S.length=d);if(!Array.isArray(a)){if(!e.pointToVector(a,U,this.tilingScheme.spatialReference))return T.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;a=U}for(var f=0;f<c.length;f++){var g=c[f];if(r.isPosWithinTile(g,a)){do{f=g.layerInfo[b];for(c=0;c<d;c++)null!=f[c].data&&(S[c]=f[c].data);c=0;a[0]>.5*(g.extent[0]+g.extent[2])&&(c+=1);a[1]<.5*(g.extent[1]+g.extent[3])&&(c+=2);g=g.children[c]}while(null!=g);break}}for(c=0;c<d;c++)null!=
S[c]&&(S[c]=S[c].samplerData);b=B.elevationSampler(a[0],a[1],S);for(c=0;c<d;c++)S[c]=void 0;return b},getElevationBounds:function(){return this._elevationBounds},getScale:function(a){if(this.tilingScheme){if(!e.pointToVector(a,U,this.spatialReference))return T.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;if(this.rootTiles)for(var b=0;b<this.rootTiles.length;b++)if(a=this.rootTiles[b],r.isPosWithinTile(a,U)){for(;a.children[0];)b=0,U[0]>
a.children[0].extent[2]&&(b+=1),U[1]<a.children[0].extent[1]&&(b+=2),a=a.children[b];return this._getLodBiasCorrectedScale(a.lij[0])}}return 1E100},queryVisibleScaleRange:function(a,b,c,d){b=b?this.tilingScheme.levelAtScale(b):0;c=c?this.tilingScheme.levelAtScale(c):Infinity;var e=this._getLodBias();this._renderer.queryVisibleLevelRange(a,b+e,c+e,d)},_setLoaded:function(){this.loaded||(this.loaded=!0,this.emit("load"))},_updateTilingSchemeAndExtent:function(){var a=this.tilingSchemeLogic.extent,b=
this.tilingSchemeLogic.tilingScheme,c=!1;a&&!I.equals(a,this._dataExtent)&&(c=!0,this._dataExtent?I.set(this._dataExtent,a):this._dataExtent=I.create(a));b!=this.tilingScheme&&(X(b,"tiling scheme cannot be reset to undefined"),c=!0,this.tilingScheme&&this._removeAllTiles(),this._set("tilingScheme",b),this._updateClippingExtent(),b&&(this._updateTiledLayers(),this._renderer.setTileSize(b.pixelSize[0]),this.overlayManager.setSpatialReference(b.spatialReference,"spherical"===this.manifold)));c&&this._updateRootTiles()},
_acquireTile:function(a,b,c,d){var e=this.TileClass.Pool.acquire();Y[0]=a;Y[1]=b;Y[2]=c;e.init(Y,d,this,this.tilingScheme);return e},_releaseTile:function(a){a.dispose();a.parent=null;a.parentSurface=null;this.TileClass.Pool.release(a)},_updateRootTiles:function(){var a=this._clippingExtent||this._dataExtent,b=this.tilingScheme;if(a&&b){var c=b.rootTilesInExtent(a,U,Infinity);if(this.rootTiles){if(c.length>V){T.warn(fa.TOO_MANY_ROOT_TILES_AFTER_CHANGE);return}var a=this.rootTiles.map(function(a){return a.lij}),
e=d.difference(a,c,N);if(0<e.removed.length||0<e.added.length){var f=this.rootTiles.filter(function(a){return-1<d.findIndex(e.removed,N.bind(null,a.lij))?(this._purgeChildTiles(a),this._purgeTile(a),!1):!0}.bind(this));e.added.forEach(function(a){a=this._acquireTile(0,a[1],a[2],null);f.push(a);this._loadTile(a)}.bind(this));this._set("rootTiles",f);this._renderer.setRootTiles(this.rootTiles)}}else c.length>V&&(T.warn(fa.TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR),c=b.rootTilesInExtent(a,U,V)),this._set("rootTiles",
c.map(function(a){a=this._acquireTile(0,a[1],a[2],null);this._loadTile(a);return a}.bind(this))),this._renderer.setRootTiles(this.rootTiles);d.equals(U,this._rootExtent)||(this._rootExtent=K.create(U),this._hasFixedExtent()||this.notifyChange("extent"));this.setVisibility(!0);this._viewChangeUpdate();this.notifyChange("ready")}},_viewChangeUpdate:function(){this._stage&&!this.suspended&&this.tilingScheme&&this.visible&&(this._updateViewDependentParameters(),this._updateOverlayOpacity(this._curEyePos),
this._updateTiles(this.rootTiles),this.overlayManager&&this.overlayManager.setOverlayDirty())},_hasVisibleSiblings:function(a){Array.isArray(a)||(ca[0]=a,a=ca);for(var b=0;b<a.length;b++){var c=a[b],d=c.parent;if(d)for(var e=0;4>e;e++){var f=d.children[e];if(f&&f!==c&&f.visible)return!0}}return!1},_updateTiles:function(a){var b=this._iteratorPool.acquire();b.reset(a);var c=this._curSplitLimits,d=this._curFrustumPlanes,e=this._curEyePos,g;this._hasVisibleSiblings(a)?(a=this._elevationBounds[0],g=this._elevationBounds[1]):
(a=Infinity,g=-Infinity);for(;!b.done;){var k=b.next();k.updateClippingStatus(this._clippingExtent);var l=!0;if(k.updateVisibility(d,e)){k.updateScreenDepth(this._viewProjectionMatrix);k.renderData&&(a=Math.min(k.elevationBounds[0],a),g=Math.max(k.elevationBounds[1],g));var p=k.shouldSplit(c,e);p===W.SPLIT?(k.pendingUpdates&=~W.MERGE,k.renderData?(l=!1,k.pendingUpdates|=W.SPLIT,b.skip()):l=!1):(k.pendingUpdates&=~W.SPLIT,p===W.VSPLITMERGE&&k.updateAgents(z.LayerClass.ELEVATION),b.skip())}else b.skip();
if(l&&!k.renderData){k.pendingUpdates|=W.MERGE;k.pendingUpdates&=~W.SPLIT;l=this._iteratorPool.acquire();for(l.reset(k);!l.done;)p=l.next(),p.updateVisibility(d,e),p.visible&&p.updateScreenDepth(this._viewProjectionMatrix);this._iteratorPool.release(l)}0!==k.pendingUpdates&&(this._pendingUpdates=!0)}this._iteratorPool.release(b);isFinite(a)&&isFinite(g)&&(this._elevationBounds[0]!==a||this._elevationBounds[1]!==g)&&(this._elevationBounds[0]=a,this._elevationBounds[1]=g,f.emit(this,"elevation-bounds-change"))},
_viewParamSelector:{projectionMatrix:!0,fovX:!0,viewport:!0},_updateViewDependentParameters:function(){var a=this._view.navigation.currentCamera,b=Math.tan(.5*a.fovX),c=Math.tan(.5*a.fovY),d=this.tilingScheme.pixelSize,e=Math.pow(2,-this._getLodBias());this._curSplitLimits[0]=b;this._curSplitLimits[1]=d[0]/a.width*this.maxTextureScale*e;this._curSplitLimits[2]=c;this._curSplitLimits[3]=d[1]/a.height*this.maxTextureScale*e;this._curSplitLimits[4]=this.tilingScheme.getMaxLod();this._curSplitLimits[5]=
this._view.qualitySettings.tiledSurface.angledSplitBias;a.copyFrustumPlanes(this._curFrustumPlanes);ba.multiply(a.projectionMatrix,a.viewMatrix,this._viewProjectionMatrix);M.set(a.eye,this._curEyePos);x.autoUpdateSkirtsVisibility(this,this._curEyePos)},_setLayerViewsUpdating:function(){for(var a=0;a<z.LayerClass.LAYER_CLASS_COUNT;a++)for(var b=this._layerViews[a],c=0;c<b.length;c++)b[c]._evaluateUpdatingState(this._pendingUpdates)},_frameUpdateTraversal:function(a){if(!this.suspended){this._frameUpdateLowerPrio.clear();
var b=this._renderer.resourceCounter.numTileTexturesComposited,c=this._iteratorPool.acquire();c.reset(this.rootTiles);for(var d=!1,e=!1;!c.done&&(1<a.remaining()||!d)&&12>this._renderer.resourceCounter.numTileTexturesComposited-b;){var f=c.next();f.pendingUpdates&W.MERGE?(this._mergeTile(f),f.pendingUpdates&=~W.MERGE,d=!0,c.skip()):f.pendingUpdates&W.SPLIT?(this._splitTile(f),f.pendingUpdates&=~W.SPLIT,d=!0,c.skip()):0<f.pendingUpdates&&this._frameUpdateLowerPrio.push(f);0!==f.pendingUpdates&&(e=
!0)}this._pendingUpdates=e||!c.done;this._iteratorPool.release(c);return d}},_updateTileGeometry:function(a){this._renderer._updateTileGeometry(a);ga.spatialReference=this.spatialReference;ga.tile=a;f.emit(this,"elevation-change-tile",ga)},_updateTileTexture:function(a){this._renderer.updateTileTexture(a)},_frameUpdate:function(a){if(this.rootTiles){for(var b=this._frameUpdateTraversal(a);(1<a.remaining()||!b)&&0<this._frameUpdateLowerPrio.length;){var c=this._frameUpdateLowerPrio.pop();c.pendingUpdates&
W.DECODE_ELEVATION?(this._decodeElevation(c),c.pendingUpdates&=~W.DECODE_ELEVATION,b=!0):c.pendingUpdates&W.UPDATE_GEOMETRY?(this._renderer.updateTileGeometryNeedsUpdate(c),this._updateTileGeometry(c),b=!0,c.pendingUpdates&=~W.UPDATE_GEOMETRY):c.pendingUpdates&W.UPDATE_TEXTURE&&(this._updateTileTexture(c),c.pendingUpdates&=~W.UPDATE_TEXTURE,b=!0);0!==c.pendingUpdates&&(this._pendingUpdates=!0)}0<this._frameUpdateLowerPrio.length&&(this._pendingUpdates=!0);if(this._streamDataSupplier._loader.hasPendingDownloads()||
0!==this._vectorTileLayerRequests)this._pendingUpdates=!0;this._pendingUpdates===this._lvPendingUpdates||!this._pendingUpdates&&20!==++this._updateNextFrame||(this._setLayerViewsUpdating(),this._lvPendingUpdates=this._pendingUpdates,this._updateNextFrame=0)}},_needsIdleUpdate:function(){return this.isVisible()&&this.overlayManager&&this.overlayManager.overlaysNeedUpdate()},_idleUpdate:function(a){this.overlayManager.updateOverlay();this._updateOverlayOpacity(this._curEyePos)},_updateClippingExtent:function(){if(!this.spatialReference)return!1;
var a=[],b=null;e.extentToBoundingRect(this._view.clippingArea,a,this.spatialReference)&&(b=a);if(d.equals(b,this._clippingExtent))return!1;this._clippingExtent=b;this._renderer.clippingExtent=b;this.notifyChange("extent");return!0},_clippingChanged:function(){this._updateClippingExtent()&&this._updateRootTiles()},_getLodBias:function(){return Math.round(this._view.qualitySettings.tiledSurface.lodBias)},_getLodBiasCorrectedScale:function(a){var b=this.tilingScheme.levels;a=F.clamp(a-this._getLodBias(),
0,b.length-1);return b[a].scale},_cancelTilemapRequests:function(a){for(var b=0;b<z.LayerClass.LAYER_CLASS_COUNT;b++){var c=a.layerInfo[b];if(c)for(var d=0;d<c.length;d++){var e=c[d];e.tilemapRequest&&(e.tilemapRequest.cancel(),e.tilemapRequest=null)}}},_removeAllTiles:function(){this.rootTiles&&(this.rootTiles.forEach(function(a){this._purgeChildTiles(a);this._purgeTile(a)}.bind(this)),this._set("rootTiles",null),this.notifyChange("ready"));for(var a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._cancelTilemapRequests(this._topLevelTilemapOnlyTiles[a]);
this.setVisibility(!1)},_purgeChildTiles:function(a){var b=this._postorderIterator;for(b.reset(a);!b.done;){for(var c=b.next(),d=0;4>d;d++)c.children[d]=null;c!==a&&this._purgeTile(c)}},_purgeTile:function(a){a.unload(this._renderer);this._cancelTilemapRequests(a);a.parent=null;a.releaseLayerResources();this._releaseTile(a)},_splitTile:function(a){var b=a.lij[0]+1,c=2*a.lij[1],d=2*a.lij[2];a.children[0]=this._createTile(b,c,d,a);a.children[1]=this._createTile(b,c,d+1,a);a.children[2]=this._createTile(b,
c+1,d,a);a.children[3]=this._createTile(b,c+1,d+1,a);a.unload(this._renderer);aa.spatialReference=this.spatialReference;aa.extent=a.extent;aa.scale=this._getLodBiasCorrectedScale(b);f.emit(this,"scale-change",aa)},_createTile:function(a,b,c,d){X(d,"_createTile sanity check");a=this._acquireTile(a,b,c,d);a.updateClippingStatus(this._clippingExtent);a.updateVisibility(this._curFrustumPlanes,this._curEyePos);a.visible&&(a.updateScreenDepth(this._viewProjectionMatrix),a.shouldSplit(this._curSplitLimits,
this._curEyePos)===W.SPLIT&&(a.pendingUpdates|=W.SPLIT,this._pendingUpdates=!0));this._loadTile(a);return a},_mergeTile:function(a){X(!a.renderData,"_mergeTile sanity check");this._loadTile(a);this._purgeChildTiles(a);aa.spatialReference=this.spatialReference;aa.extent=a.extent;aa.scale=this._getLodBiasCorrectedScale(a.lij[0]);f.emit(this,"scale-change",aa)},_loadTile:function(a){a.load(this._renderer);this.overlayManager&&this.overlayManager.hasOverlays()&&this.overlayManager.setOverlayParamsOfTile(a,
a.renderData,this._curOverlayOpacity)},_handleHasHighlights:function(a){this._renderer.setNeedsHighlight(a)},_decodeElevation:function(a){var b=z.LayerClass.ELEVATION,c=a.layerInfo[b];if(c)for(var d=0;d<c.length;d++){var e=c[d];e.pendingUpdates&=~W.DECODE_ELEVATION;if(e.rawData){var f=a.decodeElevationData(e.rawData);e.rawData=null;if(f){e.data=f;var e=a.lij[0],g=this._iteratorPool.acquire();for(g.reset(a);!g.done;){var k=g.next();k.findElevationBoundsForLayer(d,e);k.computeElevationBounds()}this._iteratorPool.release(g);
a.dataArrived(d,b,f);this._updateTiles(a);ea.spatialReference=this.spatialReference;ea.extent=a.extent;this._emitElevationChange(ea)}}}},_handleLayerViewChanges:function(a){var b=!1;a.added.forEach(function(a){var c=a.layer;x.isTiledLayerView(a)?(this._registerTiledLayer(c,a),c.loaded&&(b=!0)):a.supportsDraping&&this.overlayManager&&this.overlayManager.registerLayerView(a)}.bind(this));a.removed.forEach(function(a){x.isTiledLayerView(a)?(b=!0,this._unregisterTiledLayerView(a.uid)):a.supportsDraping&&
this.overlayManager&&this.overlayManager.unregisterLayerView(a)}.bind(this));(b=b||0<a.moved.filter(x.isTiledLayerView).length)&&this._updateTiledLayers()},_registerTiledLayer:function(a,b){a=[];a.push(b.watch("suspended",function(){this._updateTiledLayers()}.bind(this)));a.push(b.watch("fullOpacity",this._updateTileTextures.bind(this)));b.on("data-changed",function(){var a=x.isElevationLayerView(b)?z.LayerClass.ELEVATION:z.LayerClass.MAP,c=this._layerIndexByLayerViewId[a][b.uid];null!=c&&this._invalidateLayerData(c,
a)}.bind(this));this._basemapLayerViewHandles[b.uid]=a},_unregisterTiledLayerView:function(a){var b=this._basemapLayerViewHandles[a];if(b){for(var c=0;c<b.length;c++)b[c].remove();delete this._basemapLayerViewHandles[a]}},_updateTiledLayers:function(){if(this.tilingScheme){var a=this._view.allLayerViews,b=[[],[]],c=z.LayerClass,d=null,e=I.create(I.NEGATIVE_INFINITY),f=function(a){var f=a.layer;if(f&&a&&!a.suspended&&x.isTiledLayerView(a)){var g=f.fullExtent;if(g){var k=f.tileInfo;x.isVectorTileLayerView(a)&&
(256===this.tilingScheme.pixelSize[0]?k=f.tileInfo256:a.view.spatialReference.isWGS84&&(k=f.compatibleTileInfo512));this.tilingScheme.compatibleWith(k)?(I.expand(e,g),x.isElevationLayerView(a)?b[c.ELEVATION].push(a):(Infinity!==a.maxDataLevel&&(null===d||a.maxDataLevel>d)&&(d=a.maxDataLevel),b[c.MAP].push(a))):T.warn("Terrain: tiling scheme of layer "+f.id+" is incompatible with other tiled layers, will not be drawn")}else T.warn("Terrain: Map or elevation layer does not have fullExtent: "+f.id)}}.bind(this);
a.forEach(f,this);for(var g=0;g<c.LAYER_CLASS_COUNT;g++){f=this._layerViews[g];a=b[g];a.reverse();var k=f.length!==a.length,l=a.length,p=Array(l),h=Array(f.length);this._layerIndexByLayerViewId[g]={};for(var n=0;n<l;n++){this._layerIndexByLayerViewId[g][a[n].uid]=n;var q=f.indexOf(a[n]);p[n]=q;n!==q&&(k=!0);-1<q&&(h[q]=n)}if(k){this._topLevelTilemapOnlyTiles.forEach(function(a){a.modifyLayers(h,p,g)});f=this._postorderIterator;if(this.rootTiles)for(f.reset(this.rootTiles);!f.done;)f.next().modifyLayers(h,
p,g);this._layerViews[g]=a;if(this.rootTiles){for(f.reset(this.rootTiles);!f.done;)a=f.next(),a.restartAgents(g),g===c.ELEVATION&&a.computeElevationBounds();this._updateTiles(this.rootTiles)}g===c.ELEVATION&&this.tilingScheme&&(ea.spatialReference=this.tilingScheme.spatialReference,ea.extent=R,this._emitElevationChange(ea))}}this.tilingScheme.levels.length-1<d&&(this.tilingScheme.ensureMaxLod(d),this._viewChangeUpdate())}},_emitElevationChange:function(a){f.emit(this,"elevation-change",a);if(fa.UPDATE_OVERLAY_MANAGER_BY_ELEVATION_UPDATES_DEFAULT)this.overlayManager.onElevationChange(a)},
_getLayerExtentUnion:function(a){var b=this._view.allLayerViews,c=I.create(I.NEGATIVE_INFINITY);b.forEach(function(b){var d=b.layer;(b=b.fullExtentInViewSpatialReference||d.fullExtent)&&!b.spatialReference.equals(a)&&(b=v.canProject(b.spatialReference,a)?v.project(b,a):null);b&&I.expand(c,b)});return I.allFinite(c)?c:null},layerViewByIndex:function(a,b){return this._layerViews[b][a]},agentTypeByLayerIndex:function(a,b){return b===z.LayerClass.ELEVATION?H:E},numLayers:function(a){return this._layerViews[a].length},
numTotalLayers:function(){return this._layerViews.reduce(function(a,b){return b.length+a},0)},_updateTileTextures:function(){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)a.next().updateTexture();this._iteratorPool.release(a)},_invalidateLayerData:function(a,b){var c=this._iteratorPool.acquire();for(c.reset(this.rootTiles);!c.done;)c.next().reinitializeLayer(a,b);this._iteratorPool.release(c)},requestTileData:function(a,b,c){this.tilemapStats.tilesRequested++;var d=this.layerViewByIndex(b,
c);if(d.layer.tilemapCache){var e=this.getTilemapTile(a),f=e.layerInfo[c][b];if(f.tilemap){if(!e.tileDataAvailable(a,b,c))return this.tilemapStats.tilesNotPresent++,this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),b=new p.Promise,b.reject(),b}else{f.tilemapRequest||(f.tilemapRequest=this.requestTilemap(e,b,c,d));var g,k=new p.Promise(function(){g&&g.cancel()});f.tilemapRequest.always(function(){f.tilemapRequest=null;if(!k.isCancelled()){var b=this._layerIndexByLayerViewId[c][d.uid];
null!=b&&(e.tileDataAvailable(a,b,c)?(g=this._requestTileData(a,b,c,d),g.then(function(){k.resolve()})):(this.tilemapStats.tilesNotPresent++,this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),k.reject()))}}.bind(this));return k}}return this._requestTileData(a,b,c,d)},_requestTileData:function(a,b,c,d){this.tilemapStats.tileRequestsSent++;return c===z.LayerClass.ELEVATION?this._requestElevationTileData(a,b,c,d):this._requestMapTileData(a,b,c,d)},_requestElevationTileData:function(a,b,c,
d){function e(b){var e=g._layerIndexByLayerViewId[c][d.uid];null!=e?(e=a.layerInfo[c][e],e.rawData=b,a.pendingUpdates|=W.DECODE_ELEVATION,e.pendingUpdates|=W.DECODE_ELEVATION,g._pendingUpdates=!0):T.warn("TerrainSurface: received data from unknown layer %d %s",c,a.lij.toString())}function f(b){L(b)||(g.tilemapStats.tileRequestErrors++,g._dispatchDataEvent(a,"dataMissing",c,d,b))}var g=this;x.useFetchTileForLayer(d.layer)?(b=d.layer.fetchTile(a.lij[0],a.lij[1],a.lij[2],z.noDataValueOpt),b.then(function(a){e(a)},
f)):(b=d.getTileUrl(a.lij[0],a.lij[1],a.lij[2]),b=this._streamDataSupplier.request(b,"binary"),b.then(function(a,b){b.url=a;e(b)},f));return b},_requestMapTileData:function(a,b,c,d){var e=this;if(x.isVectorTileLayerView(d)){var f=d.tileHandler;b=d.schemeHelper.getCompatibleLevelRowCol(a.lij);b=f.getVectorTileWithLRC(b[0],b[1],b[2],0);this._vectorTileLayerRequests=f.ongoingRequestCount}else x.useFetchTileForLayer(d.layer)?b=d.layer.fetchTile(a.lij[0],a.lij[1],a.lij[2]):(b=d.getTileUrl(a.lij[0],a.lij[1],
a.lij[2]),b=this._streamDataSupplier.request(b,"image"));b.then(function(b,g){"string"!==typeof b&&(g=b);e._dispatchDataEvent(a,"dataArrived",c,d,g);x.isVectorTileLayerView(d)&&(e._vectorTileLayerRequests=f.ongoingRequestCount)},function(b){L(b)||(e._dispatchDataEvent(a,"dataMissing",c,d,b),e.tilemapStats.tileRequestErrors++);x.isVectorTileLayerView(d)&&(e._vectorTileLayerRequests=f.ongoingRequestCount)});return b},requestTilemap:function(a,b,c,d){var e=a.lij[0]+z.TILEMAP_SIZE_EXP,f=a.lij[1]<<z.TILEMAP_SIZE_EXP,
g=a.lij[2]<<z.TILEMAP_SIZE_EXP;this.tilemapStats.tilemapRequestsSent++;this.tilemapStats.tilemapRequestsPending++;return d.layer.tilemapCache.fetchTilemap(e,f,g,{timeout:6E3}).then(function(e){this.tilemapStats.tilemapRequestsPending--;b=this._layerIndexByLayerViewId[c][d.uid];null!=b&&(a.layerInfo[c][b].tilemap=e)}.bind(this)).otherwise(function(a){this.tilemapStats.tilemapRequestsPending--;this.tilemapStats.tilemapRequestErrors++}.bind(this))},getTilemapTile:function(a){var b=a.lij[0];return b>
z.TILEMAP_SIZE_EXP?r.getTileNLevelsUp(a,z.TILEMAP_SIZE_EXP):this._topLevelTilemapOnlyTiles[b]},_dispatchDataEvent:function(a,b,c,d,e){d=this._layerIndexByLayerViewId[c][d.uid];if(null!=d)a[b](d,c,e);else T.warn("TerrainSurface: received data from unknown layer")},_updateTileOverlayParams:function(){if(this.rootTiles){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;){var b=a.next();b.renderData&&this.overlayManager&&this.overlayManager.setOverlayParamsOfTile(b,b.renderData,this._curOverlayOpacity)}this._iteratorPool.release(a);
this._renderer.setNeedsRender()}},_updateOverlayOpacity:function(a){if(this.overlayManager&&(a=this.overlayManager.updateOpacity(a),!isNaN(a))){if(a!==this._curOverlayOpacity&&this.rootTiles){var b=this._iteratorPool.acquire();for(b.reset(this.rootTiles);!b.done;){var c=b.next();c.renderData&&c.renderData.overlayTexId&&(c.renderData.overlayOpacity=a)}this._iteratorPool.release(b)}this._curOverlayOpacity=a;this._renderer.setNeedsRender()}},getStats:function(){var a=0,b=0,c=0,d=[],e=this._iteratorPool.acquire();
for(e.reset(this.rootTiles);!e.done;){var f=e.next();a++;f.renderData&&(b++,f.visible&&(c++,f=f.lij[0],d[f]=null!=d[f]?d[f]+1:1))}this._iteratorPool.release(e);return{numNodes:a,numLeaves:b,numVisible:c,numVisiblePerLevel:d}},getTile:function(a){var b=a.split("/").map(JSON.parse);if(0===b[0])return this.rootTiles.forEach(function(a){if(a.lij[1]===b[1]&&a.lij[2]===b[2])return a}),null;var c=Math.pow(2,b[0]),d=Math.floor(b[1]/c),e=Math.floor(b[2]/c),f;this.rootTiles.some(function(a){return a.lij[1]===
d&&a.lij[2]===e?(f=a,!0):!1});if(f){for(c=1<<b[0]-1;f.lij[0]<b[0];){var g=b[1]&c?2:0;0<(b[2]&c)&&g++;if(!f.children[g])return console.log("Tile "+a+" doesn't exist, smallest ancestor is "+r.tile2str(f)),null;f=f.children[g];c>>=1}X(f.lij[0]===b[0]&&f.lij[1]===b[1]&&f.lij[2]===b[2],"not the right tile?");return f}return null},hasPendingUpdates:function(){if(this._streamDataSupplier._loader.hasPendingDownloads()||0!==this._vectorTileLayerRequests)return!0;var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)if(0<
a.next().pendingUpdates)return this._iteratorPool.release(a),!0;this._iteratorPool.release(a);return!1},setBorders:function(a){this._renderer.setBorders(a)},setDisableRendering:function(a){this._renderer.setDisableRendering(a)},_extentGetter:function(){return this._clippingExtent||this._rootExtent},_hasFixedExtent:function(){return!!this._clippingExtent},_wireframeSetter:function(a){this._renderer.setWireframe(a);this._set("wireframe",a);this._view._stage.setRenderParams({earlyOcclusionPixelDraw:a})},
_opacitySetter:function(a){this._renderer.setOpacity(a);this._set("opacity",a)},_skirtsSetter:function(a){this._renderer.setDrawSkirts(!!a);this._set("skirts",a)},_cullBackFacesSetter:function(a){this._renderer.setCullBackFaces(a);this._set("cullBackFaces",a)},_renderOrderSetter:function(a){this._renderer.setRenderOrder(a);this._set("renderOrder",a)},_frontMostTransparentSetter:function(a){this._renderer.setFrontMostTransparent(!!a);this._set("frontMostTransparent",a)},_tileBackgroundSetter:function(a){a!==
this.tileBackground&&this._renderer.updateTileBackground(a);this._set("tileBackground",a)},_velvetOvergroundSetter:function(a){a!==this.velvetOverground&&this._renderer.setVelvetOverground(a);this._set("velvetOverground",a)}});fa.TOO_MANY_ROOT_TILES_AFTER_CHANGE="Cannot extend surface to encompass all layers because it would result in too many root tiles.";fa.UPDATE_OVERLAY_MANAGER_BY_ELEVATION_UPDATES_DEFAULT=!1;return fa})},"esri/views/3d/terrain/TerrainRenderer":function(){define("dojo/when ./tileUtils ./TerrainConst ./TileGeometryFactory ./TileRenderData ./ResourceCounter ./TileRenderer ../support/PreallocArray ../../../core/ObjectPool ../../../core/promiseUtils ../support/imageUtils ../webgl-engine/lib/ShaderVariations dojo/text!./TerrainMaterial.xml ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/Util ../lib/glMatrix ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/tracer ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/screenSizePerspectiveUtils ../../webgl/Util".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G){var J=n.assert;n=t.vec2d;var I=t.vec3d,F=t.vec4d,N=t.mat4d.identity(),L=[2,2],M=x.OPAQUE_TERRAIN,K=x.TRANSPARENT_TERRAIN,ba=I.create(),X=n.create();t=function(n,t,x){function V(a,b){a=a.screenDepth;b=b.screenDepth;return a<b?-wa:a>b?wa:0}function P(a,b){return 0===a.tiles.length?-wa:0===b.tiles.length?wa:V(a.tiles.data[0],b.tiles.data[0])}t=t||256;var T,S=!1,ca=null,ga=null,ea=null,aa={},R,da,fa=new g(a),la=new f(10,function(){return{root:null,
tiles:new f(300)}}),ja=!0,ka=new h.IteratorPreorder,Q=null,va=!0,na=1,ya=!0,w=!1,ia={mode:"none",width:1.5,falloff:1.5,wireOpacity:1,surfaceOpacity:0,color:[1,1,1,0],resolution:64},ra=!1,oa=!1,Ba=!1,wa=1,sa=!0,Z=!0,Aa=null,ta=null,Fa=null,za=!1,Ya=[];this.updateTileBackground=function(a){Fa&&Fa.cancel();Fa=a?l.requestImage(a).otherwise(function(){return null}):e.resolve(null);this.renderTileBackground();return Fa};var Ia=0,Ca=0,Ua=0,Ra=0;this.resourceCounter=new b;this.castShadows=!0;this.clippingExtent=
null;this.loaded=function(){};var pa=!1;this.needsRender=!0;this.receiveShadows=this.needsHighlight=this.didRender=!1;var Ga=new f(10),Pa=0,Qa=new f(30),Za=new g(function(){this.extent=F.create();this.maxLevel=this.minLevel=0;this.callback=null},!1);this.renderTileBackground=function(){if(R&&Fa&&ta)return Fa.then(function(a){za=!0;ta.setGridImage(a);ca&&h.traverseTilesPreorder(ca,function(a){ta.updateTileTexture(a)}.bind(this))}.bind(this))};this.initializeRenderContext=function(a){R=a.rctx;da=a.rctx.gl;
var b=function(a){m(a).then(function(){S=!0;this.setNeedsRender()}.bind(this)).otherwise(b)}.bind(this);b(this.renderTileBackground());T=a.textureRep;var c=a.shaderSnippets,d=a.shaderRep;a=a.programRep;c.vsTerrain||c._parse(v);R.extensions.standardDerivatives;var e=new p("terrain",["vsTerrain","fsTerrain"],null,a,d,c,R);e.addDefine("Spherical","SPHERICAL");e.addDefine("Overlay","OVERLAY");e.addDefine("Atmosphere","ATMOSPHERE");e.addDefine("Wireframe","WIREFRAME");e.addDefine("TileBorders","TILE_BORDERS");
e.addBinaryShaderSnippetSuffix("Wireframe","Wireframe",[!1,!0]);e.addDefine("ReceiveShadows","RECEIVE_SHADOWS");e.addDefine("ScreenSizePerspective","SCREEN_SIZE_PERSPECTIVE");d=new p("terrainNormal",["vsTerrainNormal","fsNormal"],null,a,d,c,R);d.addDefine("Spherical","SPHERICAL");d.addDefine("AlphaZero","ALPHA_ZERO");ea={depth:a.get("depth"),depthShadowMap:a.get("depthShadowMap"),depthOnly:new A(R,c.vsTerrainDepthOnly,c.fsTerrainDepthOnly,D.Default3D),highlight:new A(R,c.vsTerrainHighlight,c.fsTerrainHighlight,
D.Default3D)};ga={color:e,normal:d};this._updatePrograms();ta=new k(R,t,a,this.resourceCounter,this.setNeedsRender.bind(this));this.renderTileBackground();Aa=new z(R,{target:da.TEXTURE_2D,pixelFormat:da.RGBA,dataType:da.UNSIGNED_BYTE,samplingMode:da.NEAREST,width:4,height:4})};this.uninitializeRenderContext=function(a){null!=Aa&&(Aa.dispose(),Aa=null);ta&&(ta.dispose(),ta=null)};this._updatePrograms=function(){var a="spherical"===n,b="shader"===ia.mode;ea.color=ga.color.getProgram([a,!0,a&&Z,b,ra,
b||ra,this.receiveShadows,w]);ea.normal=ga.normal.getProgram([a,!0]);this.setNeedsRender()};this.install=function(a){a.addExternalRenderer([M,K],this)};this.uninstall=function(a){a.removeExternalRenderer(this)};this.setRootTiles=function(a){ca=a;this.setNeedsRender()};this.setNeedsHighlight=function(a){this.needsHighlight=a;this.setNeedsRender()};this.setStencilEnabledLayerExtents=function(a){Ya=a;this.setNeedsRender()};this.setTileSize=function(a){t=a;ta&&(ta.tileSize=a);this.setNeedsRender()};this.loadTile=
function(a){J(null===a.renderData);a.renderData=fa.acquire();a.renderData.init();var b=this.getLocalOriginOfTile(a),c=a.createGeometry(a.renderData.updateGeometryState(a),b,"debug"===ia.mode,a.renderData.geometryInfo);a.renderData.localOrigin=b;this._setTileGeometry(a,c);za&&ta.updateTileTexture(a)};this.queryVisibleLevelRange=function(a,b,c,d){var e=Za.acquire();F.set(a,e.extent);e.minLevel=b?b:-Number.MAX_VALUE;e.maxLevel=null!=c?c:Number.MAX_VALUE;e.callback=d;Qa.push(e);this.setNeedsRender()};
this.updateTileTexture=function(a){ta&&za&&ta.updateTileTexture(a)};this.updateTileGeometryNeedsUpdate=function(a){return a.renderData.updateGeometryState(a).needsUpdate};this._updateTileGeometry=function(a){for(var b=a.renderData.geometryState,c=a.layerInfo[d.LayerClass.ELEVATION],e=0;e<c.length;e++)c[e].pendingUpdates&=~d.TileUpdateTypes.UPDATE_GEOMETRY;return b.needsUpdate?(a.renderData.vao&&this._releaseTileGeometry(a),b=a.createGeometry(b,a.renderData.localOrigin,"debug"===ia.mode,a.renderData.geometryInfo),
this._setTileGeometry(a,b),!0):!1};this.updateTileGeometry=function(a){a.renderData.updateGeometryState(a);return this._updateTileGeometry(a)};this.unloadTile=function(a){this._releaseTileGeometry(a);a.renderData.texture&&a.renderData.texture.dispose();fa.release(a.renderData);a.renderData=null};this.getLocalOriginOfTile=function(a){if(10<=a.lij[0]){for(;7<a.lij[0];)a=a.parent;return a.centerAtSeaLevel}if("spherical"===n)return ba;for(;a.parent;)a=a.parent;return a.centerAtSeaLevel};this.setVisibility=
function(a){va=a;this.setNeedsRender()};this.getStats=function(){return{numTilesRendered:Ca,numTilesCulled:Ua,numTrianglesRendered:Ia,numOriginsRendered:Ra}};this.setDisableRendering=function(a){oa=!!a;this.setNeedsRender()};this.getOpacity=function(){return na};this.getWireframeEnabled=function(){return"shader"===ia.mode};this.setDebugScreenSizePerspective=function(a){a!==w&&(w=a,this._updatePrograms())};this.setWireframe=function(a){a&&!0!==a||(a={mode:a?"shader":"none"});if(void 0!==a.mode&&ia.mode!==
a.mode){var b="debug"===ia.mode,c="debug"===a.mode;ia.mode=a.mode;this._updatePrograms();b!==c&&ca&&h.traverseTilesPreorder(ca,function(a){if(a.renderData){a.renderData.vao&&this._releaseTileGeometry(a);var b=a.createGeometry(a.renderData.updateGeometryState(a),a.renderData.localOrigin,c,a.renderData.geometryInfo);this._setTileGeometry(a,b)}}.bind(this))}for(var d in a)ia.hasOwnProperty(d)&&(ia[d]=a[d]),this.setNeedsRender();ia.resolution&&(ia.resolution=Math.min(ia.resolution,t),ia.resolution=1<<
Math.round(Math.log(ia.resolution)/Math.LN2))};this.setOpacity=function(a){na=a;this.setNeedsRender()};this.setDrawSkirts=function(a){ya=a;this.setNeedsRender()};this.setCullBackFaces=function(a){Ba=a;this.setNeedsRender()};this.setRenderOrder=function(a){wa=a;this.setNeedsRender()};this.setBorders=function(a){ra!==a&&(ra=a,this._updatePrograms())};this.setFrontMostTransparent=function(a){sa!==a&&(sa=a,this.setNeedsRender())};this.setVelvetOverground=function(a){Z!==a&&(Z=a,this._updatePrograms())};
this.setNeedsRender=function(){this.needsRender=!0;this.didRender=!1;ja=!0};this.resetNeedsRender=function(){this.didRender&&(this.needsRender=0!==Qa.length,this.didRender=!1)};var Sa=I.create();this.isTransparent=function(){return 1>na||"shader"===ia.mode&&(1>ia.wireOpacity||1>ia.surfaceOpacity)};this._renderMaterialPass=function(a,b){var c=this.isTransparent(),d=a.shadowMap&&a.shadowMap.getEnableState();this.receiveShadows!=d&&(this.receiveShadows=d,this._updatePrograms());d=a.camera;R.setDepthTestEnabled(!0);
R.setBlendingEnabled(c);c&&R.setBlendFunctionSeparate(da.SRC_ALPHA,da.ONE_MINUS_SRC_ALPHA,da.ONE,da.ONE_MINUS_SRC_ALPHA);c&&sa?(c=ea.depthOnly,R.bindProgram(c),R.setColorMask(!1,!1,!1,!1),R.setDepthWriteEnabled(!0),this._renderTilesAuxilliary(a,c,b),R.setColorMask(!0,!0,!0,!0),R.setDepthFunction(da.EQUAL),R.setDepthWriteEnabled(!1)):R.setDepthFunction(da.LESS);c=ea.color;R.bindProgram(c);c.setUniform1f("opacity",na);if("shader"===ia.mode||ra)c.setUniform1f("wireframe.width",ia.width),c.setUniform1f("wireframe.falloff",
Math.min(ia.width,ia.falloff)),c.setUniform1f("wireframe.wireOpacity",ia.wireOpacity*na),c.setUniform1f("wireframe.surfaceOpacity",ia.surfaceOpacity*na),c.setUniform4fv("wireframe.color",ia.color);d=a.camera;a.shadowMap&&a.shadowMap.bind(c);a.ssaoHelper&&a.ssaoHelper.setUniforms(c);c.setUniform1i("tex",4);c.setUniform1i("overlayTex",5);c.setUniformMatrix4fv("viewNormal",d.viewInverseTransposeMatrix);c.setUniformMatrix4fv("proj",d.projectionMatrix);a.lightingData.helper.setUniforms(c,!0);d=d.viewMatrix;
I.set3(d[12],d[13],d[14],Sa);I.normalize(Sa);c.setUniform3fv("viewDirection",Sa);for(Ra=Ia=Ua=Ca=0;Ga.length<Ga.data.length&&0<Qa.length;)d=Qa.pop(),Ga.push(d);Pa=Ga.length;this._renderTiles(a,c,b);R.setBlendingEnabled(!1);R.setDepthFunction(da.LESS);R.setDepthWriteEnabled(!0);for(a=0;a<Ga.length;a++)b=Ga.data[a],Za.release(b),b.callback(a>=Pa),b.callback=null;Ga.clear();0<Ca&&!pa&&(pa=!0,this.loaded&&this.loaded())};this._renderDepthPass=function(a,b,c){var d=a.camera;R.bindProgram(b);R.setBlendingEnabled(!1);
R.setDepthTestEnabled(!0);R.setDepthFunction(da.LESS);b.setUniformMatrix4fv("model",N);b.setUniformMatrix4fv("viewNormal",d.viewInverseTransposeMatrix);X[0]=d.near;X[1]=d.far;b.setUniform2fv("nearFar",X);this._renderTilesAuxilliary(a,b,c)};this._renderNormalPass=function(a,b){var c=a.camera,d=ea.normal;R.bindProgram(d);R.setBlendingEnabled(!1);R.setDepthTestEnabled(!0);R.setDepthFunction(da.LESS);d.setUniformMatrix4fv("viewNormal",c.viewInverseTransposeMatrix);this._renderTilesAuxilliary(a,d,b)};
this._renderHighlightPass=function(a,b){var c=ea.highlight;R.bindProgram(c);R.setBlendingEnabled(!1);R.setDepthTestEnabled(!0);R.setDepthFunction(da.LESS);var d=a.offscreenRenderingHelper;R.bindTexture(d.getDepthTexture(),6);c.setUniform1i("depthTex",6);c.setUniform4f("highlightViewportPixelSz",0,0,1/d.width,1/d.height);this._renderTilesAuxilliary(a,c,b,!0)};this.render=function(a){if(S&&!oa&&va&&ca&&za){var b=this.isTransparent()?K:M;if(a.slot===b){r.trace("# BEGIN RENDER TERRAIN");b=a.pass;R.setFaceCullingEnabled(Ba);
var c=1===a.lightingData.helper.globalFactor;b===u.MATERIAL?this._renderMaterialPass(a,this._updatePerOriginTileData()):b===u.MATERIAL_DEPTH_SHADOWMAP&&this.castShadows&&c?this._renderDepthPass(a,ea.depthShadowMap,this._updatePerOriginTileData()):b===u.MATERIAL_DEPTH?this._renderDepthPass(a,ea.depth,this._updatePerOriginTileData()):b===u.MATERIAL_NORMAL?this._renderNormalPass(a,this._updatePerOriginTileData()):b===u.MATERIAL_HIGHLIGHT&&this.needsHighlight&&(this._renderHighlightPass(a,this._updatePerOriginTileData()),
R.clear(R.gl.DEPTH_BUFFER_BIT));Ba&&R.setFaceCullingEnabled(!1);r.trace("# END RENDER TERRAIN");return!0}}};this._updatePerOriginTileData=function(){if(!ja)return la;Q=null;this._renderCollectOrigins();if(0!==wa){for(var a=0;a<la.length;a++)this._sortFrontToBack(la.data[a].tiles,V);this._sortFrontToBack(la,P)}ja=!1;return la};this._renderCollectOrigins=function(){la.clear();for(var a=0;a<ca.length;a++){var b=ca[a],c=la.next();c.root=b;c.origin="spherical"===n?ba:b.centerAtSeaLevel;c.tiles.clear();
this._renderCollectOriginsForRoot(c)}return!0};this._renderCollectOriginsForRoot=function(a){for(ka.reset(a.root);!ka.done;){var b=ka.next(),c=b.renderData;if(c&&!b.visible)Ua++,ka.skip();else{var d=la.peek();if(7===b.lij[0]){if(d===a||0!==d.tiles.length)d=la.next(),d.tiles.clear();d.root=b;d.origin=b.centerAtSeaLevel}if(c){10<=b.lij[0]?la.peek().tiles.push(b):a.tiles.push(b);if(!Q||b.vlevel>Q.vlevel)Q=b;ka.skip()}}}};this._sortFrontToBack=function(a,b){a.sort(b)};this._updateStencilReadStateForTile=
function(a,b){if(a.stencilRenderingHelper&&a.stencilRenderingHelper.getEnableState()){for(var c=!1,d=0;d<Ya.length;d++)if(b.intersectsExtent(Ya[d])){c=!0;break}c?a.stencilRenderingHelper.enableStencilRead():a.stencilRenderingHelper.disableStencilRead()}};this._renderTilesAuxilliary=function(a,b,c,d){var e=a.camera,f=e.viewMatrix,g=a.rctx;b.setUniformMatrix4fv("proj",e.projectionMatrix);d&&b.setUniform1i("overlayTex",5);for(e=0;e<c.length;e++){var k=c.data[e];b.setUniform3fv("origin",k.origin);q.bindView(k.origin,
f,b);for(var l=0;l<k.tiles.length;l++){var p=k.tiles.data[l],h=p.renderData;d&&(h.highlightOverlayTexId?Ja(b,h,h.highlightOverlayTexId):g.bindTexture(Aa,5));this._updateStencilReadStateForTile(a,p);g.bindVAO(h.vao);G.assertCompatibleVertexAttributeLocations(h.vao,b);p=h.vao.indexBuffer.size;ya||(p=h.geometryInfo.numWithoutSkirtIndices);g.drawElements(da.TRIANGLES,p,h.vao.indexBuffer.indexType,0)}}g.bindVAO(null);g.stencilRenderingHelper&&g.stencilRenderingHelper.disableStencilRead()};this._renderTiles=
function(a,b,c){var d=a.camera.viewMatrix;if(w){var e=H.getSettings(n);e.update({distance:x.distanceToSurface,fovY:x.fovY});q.bindScreenSizePerspective(e,b,"screenSizePerspective")}for(e=0;e<c.length;e++){var f=c.data[e];b.setUniform3fv("origin",f.origin);q.bindView(f.origin,d,b);a.shadowMap&&a.shadowMap.bindView(b,f.origin);Ra++;var g=f.tiles;if(0!==g.length){var k=da.TRIANGLES;"debug"===ia.mode&&(k=da.LINES);var l=Q,p;l?(l=l.vlevel,p=t/ia.resolution):(l=16,p=t/64);for(var h=0;h<g.length;h++){var v=
g.data[h],f=v.renderData;this._updateStencilReadStateForTile(a,v);r.trace("# RENDER TILE "+v.lij[0]+"/"+v.lij[1]+"/"+v.lij[2]+", screenDepth:"+v.screenDepth);b.setUniform2fv("texOffset",f.texOffset);b.setUniform1f("texScale",f.texScale);R.bindTexture(f.textureReference||f.texture,4);f.overlayTexId?Ja(b,f,f.overlayTexId):(b.setUniform2fv("overlayTexOffset",L),R.bindTexture(Aa,5));("shader"===ia.mode||ra)&&b.setUniform1f("wireframe.subdivision",p*(1<<l-v.vlevel));var m=f.vao.indexBuffer.size;ya||(m=
f.geometryInfo.numWithoutSkirtIndices);R.bindVAO(f.vao);G.assertCompatibleVertexAttributeLocations(f.vao,b);R.drawElements(k,m,f.vao.indexBuffer.indexType,0);v.renderOrder=Ca;Ca++;Ia+=m/3;f=v.extent;v=v.lij[0];for(m=0;m<Pa;){var u=Ga.data[m],B=u.extent;v>=u.minLevel&&v<=u.maxLevel&&B[0]<=f[2]&&B[2]>=f[0]&&B[1]<=f[3]&&B[3]>=f[1]?(Ga.swap(m,Pa-1),Pa--):m++}}}}R.bindVAO(null);a.stencilRenderingHelper&&a.stencilRenderingHelper.disableStencilRead()};var Ja=function(a,b,c){var d=aa[c];d||(d=T.aquire(c).getGLTexture(),
J(d),aa[c]=d);a.setUniform2fv("overlayTexOffset",b.overlayTexOffset);a.setUniform2fv("overlayTexScale",b.overlayTexScale);a.setUniform1f("overlayOpacity",b.overlayOpacity);R.bindTexture(d,5)},Va=I.create(),bb=I.create(),cb=I.create(),db=this.clippingExtent;this.intersect=function(a,b,c){if(ca&&(!a.isSelection||!this.isTransparent())){I.subtract(c,b,Va);var d=a.getMinResult(),e=a.getMaxResult();ka.reset(ca);for(var f={};!ka.done;){var g=ka.next();if(null!==g.renderData){if(a.enableInvisibleTerrain){if(!g.visible&&
db&&!g.intersectsExtent(db))continue}else if(!g.visible)continue;var k=g.renderData.geometryInfo.geometry,l=g.renderData.localOrigin;I.subtract(b,l,bb);I.subtract(c,l,cb);q.intersectTriangleGeometry(k,f,void 0,a,bb,cb,function(b,c,f){if((ya||!(3*f>=g.renderData.geometryInfo.numWithoutSkirtIndices))&&0<=b&&(a.enableBackfacesTerrain||0>I.dot(c,Va))){if(void 0===d.dist||b<d.dist)f=h.lij2str(g.lij[0],g.lij[1],g.lij[2]),d.set(void 0,f,b,c,void 0),d.setIntersector("terrain");if(void 0===e.dist||b>e.dist)f=
h.lij2str(g.lij[0],g.lij[1],g.lij[2]),e.set(void 0,f,b,c,void 0),e.setIntersector("terrain")}})}}}};this._setTileGeometry=function(a,b){a=a.renderData;var d=b.geometry.getData(),e=d.getVertexAttr().terrain.data,d=d.getFaces()[0].indices.terrain;a.vao=new B(R,D.Default3D,{geometry:E.Pos3Tex},{geometry:C.createVertex(R,da.STATIC_DRAW,e)},C.createIndex(R,da.STATIC_DRAW,d));a.geometryInfo.geometry&&c.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo=b;this.setNeedsRender()};this._releaseTileGeometry=
function(a){a=a.renderData;a.vao.dispose(!0);a.vao=null;a.geometryInfo.geometry&&c.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo.geometry=null;this.setNeedsRender()}};t.TileRenderData=a;return t})},"esri/views/3d/terrain/tileUtils":function(){define(["require","exports","./UpsampleInfo","../support/PreallocArray"],function(m,h,d,c){function a(b,c,d,k){k=c.call(d,b,k);for(var e=0;4>e;e++){var f=b.children[e];f&&a(f,c,d,k)}}function b(a,b,c){if(Array.isArray(a))for(var d=0;d<a.length;d++)k(a[d],
b,c);else k(a,b,c)}function k(a,c,d){for(var e=0;4>e;e++){var f=a.children[e];f&&b(f,c,d)}c.call(d,a)}Object.defineProperty(h,"__esModule",{value:!0});m=function(){function a(a){this.q=new c(a||100);this._last=null;this.done=!0}a.prototype.reset=function(a){this.q.clear();a&&this.q.pushEither(a);this._last=null;this.done=0===this.q.length};a.prototype.skip=function(){this._last=null;0===this.q.length&&(this.done=!0)};a.prototype.next=function(){if(this.done)return null;if(null!==this._last){var a=
this._last.children;if(a[0])for(var b=4;0<=b;b--){var c=a[b];c&&this.q.push(c)}this._last=null}this._last=this.q.pop();0!==this.q.length||this._last.children[0]||(this.done=!0);return this._last};return a}();h.IteratorPreorder=m;m=function(){function a(a){this.q=new c(a||100);this.done=!0}a.prototype.reset=function(a){this.q.clear();this.q.pushEither(a);for(a=0;a<this.q.length;)for(var b=this.q.data[a++],c=0;4>c;c++){var d=b.children[c];d&&this.q.push(d)}this.done=0===this.q.length};a.prototype.next=
function(){var a=this.q.pop();this.done=0===this.q.length;return a};return a}();h.IteratorPostorder=m;h.lij2str=function(a,b,c){return a+"/"+b+"/"+c};h.tile2str=function(a){return a.lij[0]+"/"+a.lij[1]+"/"+a.lij[2]};h.traverseTilesPreorder=function(b,c,d,k){if(Array.isArray(b))for(var e=0;e<b.length;e++)a(b[e],c,d,k);else a(b,c,d,k)};h.traverseTilesPostorder=b;h.fallsWithinLayer=function(a,b,c){b=b.layer;var d=b.fullExtent,e=a.extent;if(c){if(e[0]<d.xmin||e[1]<d.ymin||e[2]>d.xmax||e[3]>d.ymax)return!1}else if(d.xmin>
e[2]||d.ymin>e[3]||d.xmax<e[0]||d.ymax<e[1])return!1;a=a.parentSurface.tilingScheme.levels[a.lij[0]].scale;return 0<b.minScale&&a>1.00000001*b.minScale||0<b.maxScale&&a<.99999999*b.maxScale?!1:!0};h.isPosWithinTile=function(a,b){a=a.extent;return b[0]>=a[0]&&b[1]>=a[1]&&b[0]<=a[2]&&b[1]<=a[3]};h.getTileNLevelsUp=function(a,b){for(;0<b;)a=a.parent,b--;return a};h.nextTileInAncestry=function(a,b){var c=a.lij[0]-b.lij[0]-1,d=a.lij[2]>>c,f=0;a.lij[1]>>c&1&&(f+=2);d&1&&(f+=1);return b.children[f]};h.computeUpsampleInfoForAncestor=
function(a,b){for(var c=1,f=0,g=0;a!==b;)if(c*=.5,f*=.5,g*=.5,a.lij[2]&1&&(f+=.5),0===(a.lij[1]&1)&&(g+=.5),a=a.parent,null==a)throw Error("tile was not a descendant of ancestorTile");a=d.Pool.acquire();a.init(b,f,g,c);return a}})},"esri/views/3d/terrain/UpsampleInfo":function(){define(["require","exports","../lib/glMatrix","../../../core/ObjectPool"],function(m,h,d,c){var a=d.vec2d;m=function(){function b(b,c,d,e){this.scale=0;this.tile=null;this.offset=a.create();void 0!==b&&this.init(b,c,d,e)}
b.prototype.init=function(a,b,c,d){this.tile=a;this.offset[0]=b;this.offset[1]=c;this.scale=d};b.prototype.dispose=function(){this.tile=null;this.offset[0]=0;this.scale=this.offset[1]=0};return b}();m.Pool=new c(m);return m})},"esri/views/3d/terrain/TerrainConst":function(){define(["require","exports","./TilingScheme","../support/aaBoundingRect"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});(function(a){a[a.MAP=0]="MAP";a[a.ELEVATION=1]="ELEVATION";a[a.LAYER_CLASS_COUNT=2]="LAYER_CLASS_COUNT"})(h.LayerClass||
(h.LayerClass={}));(function(a){a[a.NONE=0]="NONE";a[a.SPLIT=1]="SPLIT";a[a.VSPLITMERGE=2]="VSPLITMERGE";a[a.MERGE=4]="MERGE";a[a.DECODE_ELEVATION=8]="DECODE_ELEVATION";a[a.UPDATE_GEOMETRY=16]="UPDATE_GEOMETRY";a[a.UPDATE_TEXTURE=32]="UPDATE_TEXTURE"})(h.TileUpdateTypes||(h.TileUpdateTypes={}));h.TILE_LOADING_DEBUGLOG=!1;h.MAX_ROOT_TILES=64;h.MAX_TILE_TESSELATION=512;h.ELEVATION_NODATA_VALUE=3.40282347E38/10;h.noDataValueOpt={noDataValue:h.ELEVATION_NODATA_VALUE};h.ELEVATION_DESIRED_RESOLUTION_LEVEL=
4;h.TILEMAP_SIZE_EXP=5;h.TILEMAP_SIZE=1<<h.TILEMAP_SIZE_EXP;h.WEBMERCATOR_WORLD_EXTENT=c.create([0,0,0,0]);d.WebMercatorAuxiliarySphere.getExtent(0,0,0,h.WEBMERCATOR_WORLD_EXTENT);h.GEOGRAPHIC_WORLD_EXTENT=c.create([-180,-90,180,90])})},"esri/views/3d/terrain/TilingScheme":function(){define(["../../../core/Error","../../../geometry/SpatialReference","../../../geometry/support/scaleUtils","../support/projectionUtils","../support/mathUtils"],function(m,h,d,c,a){var b=c.webMercator.x2lon,k=c.webMercator.y2lat,
f=[0,0,0,0],g=function(a){var b=g._checkUnsupported(a);if(b)throw b;this.spatialReference=a.spatialReference;this._isWebMercator=this.spatialReference.isWebMercator;this._isWGS84=this.spatialReference.isWGS84;this.origin=[a.origin.x,a.origin.y];this.pixelSize=[a.size[0],a.size[1]];var c=a.lods.reduce(function(a,b,c){b.level<a.min&&(a.min=b.level,a.minIndex=c);a.max=Math.max(a.max,b.level);return a},{min:Infinity,minIndex:0,max:-Infinity}),d=a.lods[c.minIndex],e=Math.pow(2,d.level),b=d.resolution*
e,d=d.scale*e;this.levels=Array(c.max+1);for(c=0;c<this.levels.length;c++)this.levels[c]={resolution:b,scale:d,tileSize:[b*a.size[0],b*a.size[1]]},b/=2,d/=2};g.prototype={getExtent:function(c,d,f,g,h){g=g||Array(4);var e=this.levels[c];c=e.tileSize[0];e=e.tileSize[1];g[0]=this.origin[0]+f*c;g[2]=g[0]+c;g[3]=this.origin[1]-d*e;g[1]=g[3]-e;h&&(this._isWebMercator?(h[0]=b(g[0]),h[1]=k(g[1]),h[2]=b(g[2]),h[3]=k(g[3])):this._isWGS84&&(h[0]=a.deg2rad(g[0]),h[1]=a.deg2rad(g[1]),h[2]=a.deg2rad(g[2]),h[3]=
a.deg2rad(g[3])))},ensureMaxLod:function(a){for(;this.levels.length<=a;){var b=this.levels[this.levels.length-1],c=b.resolution/2;this.levels.push({resolution:c,scale:b.scale/2,tileSize:[c*this.pixelSize[0],c*this.pixelSize[1]]})}},capMaxLod:function(a){this.levels.length>a+1&&(this.levels.length=a+1)},getMaxLod:function(){return this.levels.length-1},scaleAtLevel:function(a){return this.levels[0].scale/Math.pow(2,a)},levelAtScale:function(a){var b=this.levels[0].scale;return a>=b?0:Math.log(b/a)*
Math.LOG2E},compatibleWith:function(b){if(!(b instanceof g)){if(g._checkUnsupported(b))return!1;b=new g(b)}if(!b.spatialReference.equals(this.spatialReference)||b.pixelSize[0]!==this.pixelSize[0]||b.pixelSize[1]!==this.pixelSize[1])return!1;var c=Math.min(this.levels.length,b.levels.length)-1,d=this.levels[c].resolution,e=a.floatEqualAbsolute,f=.5*d;if(!e(b.origin[0],this.origin[0],f)||!e(b.origin[1],this.origin[1],f))return!1;f=.5*d/Math.pow(2,c)/Math.max(this.pixelSize[0],this.pixelSize[1])*12;
return e(d,b.levels[c].resolution,f)},rootTilesInExtent:function(a,b,c){var d=this.levels[0].tileSize;g.computeRowColExtent(a,d,this.origin,f);a=f[1];var e=f[3],k=f[0],l=f[2],h=l-k,p=e-a;h*p>c&&(c=Math.floor(Math.sqrt(c)),p>c&&(a=a+Math.floor(.5*p)-Math.floor(.5*c),e=a+c),h>c&&(k=k+Math.floor(.5*h)-Math.floor(.5*c),l=k+c));c=Array((l-k)*(e-a));h=0;for(p=a;p<e;p++)for(var r=k;r<l;r++)c[h++]=[0,p,r];b&&(b[0]=this.origin[0]+k*d[0],b[1]=this.origin[1]-e*d[1],b[2]=this.origin[0]+l*d[0],b[3]=this.origin[1]-
a*d[1]);return c}};g.computeRowColExtent=function(a,b,c,d){var e=.001*(a[2]-a[0]+(a[3]-a[1]));d[0]=Math.floor((a[0]+e-c[0])/b[0]);d[2]=Math.ceil((a[2]-e-c[0])/b[0]);d[1]=Math.floor((c[1]-a[3]+e)/b[1]);d[3]=Math.ceil((c[1]-a[1]-e)/b[1])};g.isPowerOfTwo=function(b){b=b.lods;var c=b[0].resolution*Math.pow(2,b[0].level);return!b.some(function(b){return!a.floatEqualRelative(b.resolution,c/Math.pow(2,b.level))})};g.hasGapInLevels=function(a){a=a.lods.map(function(a){return a.level});a.sort(function(a,b){return a-
b});for(var b=1;b<a.length;b++)if(a[b]!==a[0]+b)return!0;return!1};g.tileSizeSupported=function(a){var b=a.size[1];return b===a.size[0]&&0===(b&b-1)&&128<=b&&512>=b};g._checkUnsupported=function(a){return a?1>a.lods.length?new m("tilingscheme:generic","Tiling scheme must have at least one level"):g.isPowerOfTwo(a)?null:new m("tilingscheme:power-of-two","Tiling scheme must be power of two"):new m("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")};g.checkUnsupported=function(a){var b=
g._checkUnsupported(a);return b?b:g.hasGapInLevels(a)?new m("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):g.tileSizeSupported(a)?null:new m("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]")};g.fromExtent=function(a,b){var c=a[2]-a[0],e=a[3]-a[1],f=d.getUnitValueForSR(b),k=1.2*Math.max(c,e);a=new g({size:[256,256],origin:{x:a[0]-.5*(k-c),y:a[3]+.5*(k-e)},lods:[{level:0,resolution:k/256,scale:1/(256/96*.0254/(k*f))}],
spatialReference:b});a.ensureMaxLod(20);return a};g.WebMercatorAuxiliarySphereTileInfo={size:[256,256],origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:h.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:5.91657527591555E8}]};g.makeWebMercatorAuxiliarySphere=function(a){a=a||19;var b=new g(g.WebMercatorAuxiliarySphereTileInfo);b.ensureMaxLod(a);return b};g.WebMercatorAuxiliarySphere=g.makeWebMercatorAuxiliarySphere(19);g.makeWGS84WithTileSize=function(a,b){b=b||16;var c=
256/a;a=new g({size:[a,a],origin:{x:-180,y:90},spatialReference:h.WGS84,lods:[{level:0,resolution:.703125*c,scale:2.95497598570834E8*c}]});a.ensureMaxLod(b);return a};return g})},"esri/views/3d/terrain/TileGeometryFactory":function(){define("../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../lib/glMatrix ../support/earthUtils ../support/mathUtils ./TerrainConst".split(" "),function(m,h,d,c,a,b){function k(a,b,c,d,e){a<d[0]&&(d[0]=a);a>e[0]&&(e[0]=a);b<d[1]&&(d[1]=b);b>e[1]&&(e[1]=b);
c<d[2]&&(d[2]=c);c>e[2]&&(e[2]=c)}function f(c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g){var k=g.safeWidth,l=g.width,h=g.pixelData,p=a.clamp(g.dy*(g.y1-d),0,k),g=a.clamp(g.dx*(c-g.x0),0,k),k=Math.floor(p),n=Math.floor(g),q=k*l+n,r=q+l,t=h[q],l=h[r],q=h[q+1],h=h[r+1];if(t+l+q+h<.5*b.ELEVATION_NODATA_VALUE)return p-=k,g-=n,c=t+(q-t)*g,c+(l+(h-l)*g-c)*p}}return null}var g=c.earthRadius,e=d.vec3d,l=a.lerp,p=function(){var a=e.create(),b=e.create(),c=e.create(),d,f,g;this.init=function(k,l){f=
k;g=l;e.subtract(c,b,a);d=.5*e.length(a);e.lerp(b,c,.5,a)};this.getCenter=function(){return a};this.getBSRadius=function(){return d};this.getBBMin=function(){return b};this.getBBMax=function(){return c};this.getPosition=function(){return f};this.getIndices=function(){return g};this.getPrimitiveIndices=function(){};this.getChildren=function(){}},v=function(a,b,c,d){a*=g;for(var e=0;e<=b;e++)c[5*d]=0,c[5*d+1]=0,c[5*d+2]=a,d++},q=new function(){var a=Array(50),b=0,c={};this.get=function(e){var f=c[e];
f||(f={ptr:0,data:Array(50)},c[e]=f);0<f.ptr?(d.vertexArrayHits++,e=f.data[--f.ptr],f.data[f.ptr]=null):(d.vertexArrayMisses++,e=new Float32Array(e));if(0<b)return d.geometryHits++,f=a[--b],a[b]=null,f.getData().getVertexAttr().terrain.data=e,f;d.geometryMisses++;f={};f.terrain={size:5,data:e};e=new p;return new m(new h([{type:"triangle",indices:{terrain:null},positionKey:"terrain"}],f),"tile",[e])};this.put=function(d){var e=d.getData(),f=e.getVertexAttr(),g=f.terrain.data,k=c[g.length];50>k.ptr&&
(k.data[k.ptr++]=g);f.terrain.data=null;e.getFaces()[0].indices.terrain=null;50>b&&(a[b++]=d)};var d={geometryHits:0,geometryMisses:0,vertexArrayHits:0,vertexArrayMisses:0};this.stats=d;this._pools={geometry:a,vertexArray:c}},n=[],t=Array(b.MAX_TILE_TESSELATION+1),u=Array(b.MAX_TILE_TESSELATION+1),x=Array(b.MAX_TILE_TESSELATION+1),r=Array(b.MAX_TILE_TESSELATION+1),z={values:null,numSurfaceIndices:0,numSkirtIndices:0},B=function(a,b,c){c||(a.values=b.values);a.numSurfaceIndices=b.numSurfaceIndices;
a.numSkirtIndices=b.numSkirtIndices;return a},C=function(a,b,c,d,e){var f;f=z;var g=c&2,k=b+(d?1024:0)+(g?2048:0),l=n[k];f||(f={});if(l)B(f,l);else{var l=b-1,h=b-1,p=b*b,q=2*l+2*h,r=l*h*6,t=6*q,m=6*(2*l+h-1);d&&(r*=2,t*=2,m*=2);for(var q=65536<p+q?new Uint32Array(r+t):new Uint16Array(r+t),v=0,u=0,x=r,D,C,A,E,H=0,G=0;G<=h;G++){g&&(H=0===G?m:G===h?-m:0);for(var x=x+H,aa=0;aa<=l;aa++)E=C=-1,0===G&&(C=p+aa,aa!==l&&(E=v+1)),aa===l&&(C=p+l+G,G<h&&(E=v+l+1)),G===h&&(C=p+l+h+(l-aa),0<aa&&(E=v-1)),0===aa&&
0<G&&(C=p+2*l+h+(h-G),E=v-(l+1)),-1<C&&(A=0===aa&&1===G?p:C+1,-1<E&&(D=v,d?(q[x+0]=D,q[x+1]=C,q[x+2]=C,q[x+3]=A,q[x+4]=A,q[x+5]=D,q[x+6]=A,q[x+7]=E,q[x+8]=E,q[x+9]=D,q[x+10]=D,q[x+11]=A,x+=12):(q[x+0]=D,q[x+1]=C,q[x+2]=A,q[x+3]=A,q[x+4]=E,q[x+5]=D,x+=6))),++v,aa<l&&G<h&&(D=G*(l+1)+aa,C=D+1,A=C+(l+1),E=A-1,d?(q[u+0]=D,q[u+1]=C,q[u+2]=C,q[u+3]=A,q[u+4]=A,q[u+5]=D,q[u+6]=A,q[u+7]=E,q[u+8]=E,q[u+9]=D,q[u+10]=D,q[u+11]=A,u+=12):(q[u+0]=D,q[u+1]=C,q[u+2]=A,q[u+3]=A,q[u+4]=E,q[u+5]=D,u+=6));x-=H}f.values=
q;f.numSurfaceIndices=r;f.numSkirtIndices=t;n[k]=B({},f)}g=a.getData();k=g.getVertexAttr();g.getFaces()[0].indices.terrain=f.values;a.getBoundingInfo(0).init(k.terrain,f.values);e||(e={});e.geometry=a;e.numWithoutSkirtIndices=f.numSurfaceIndices+(c?6*(b-1)*(d?2:1):0);e.numVertsPerRow=b;return B(e,f,!0)};return{createPlanarGlobeTile:function(a,b,c,d,g,l,h){var p=b[0],n=b[1],r=b[2]-p;b=b[3]-n;var t=.1*r,v=a-1,m=a-1,u=a*a,B=q.get(5*(u+(2*v+2*m))),x=B.getData().getVertexAttr().terrain.data,D,z,A=0;D=
B.getBoundingInfo(0);var E=D.getBBMin(),H=D.getBBMax();e.set3(1E7,1E7,1E7,E);e.set3(-1E7,-1E7,-1E7,H);for(z=0;z<=m;z++){var G=z/m,I=n+G*b;l&&(I<l[1]?(I=l[1],G=(I-n)/b):I>l[3]&&(I=l[3],G=(I-n)/b));for(D=0;D<=v;D++){var J=D/v,aa=p+J*r;l&&(aa<l[0]?(aa=l[0],J=(aa-p)/r):aa>l[2]&&(aa=l[2],J=(aa-p)/r));var R=c?f(aa,I,c)||0:0,aa=aa-d[0],da=I-d[1],R=R-d[2];k(aa,da,R,E,H);x[5*A]=aa;x[5*A+1]=da;x[5*A+2]=R;x[5*A+3]=J;x[5*A+4]=G;var fa=-1;0===z&&(fa=u+D);D===v&&(fa=u+v+z);z===m&&(fa=u+v+m+(v-D));0===D&&0<z&&(fa=
u+2*v+m+(m-z));-1<fa&&(x[5*fa]=aa,x[5*fa+1]=da,x[5*fa+2]=R-t,x[5*fa+3]=J,x[5*fa+4]=G,k(aa,da,R-t,E,H));++A}}return C(B,a,0,g,h)},createSphericalGlobeTile:function(a,b,c,d,h,p,n,m,B){var D=c[0],z=c[1],A=c[2],E=c[3],H=Math.max(.9,1-.5*(A-D));c=a-1;var F=a-1,G=a*a,I=q.get(5*(G+(2*c+2*F))),J=I.getData().getVertexAttr().terrain.data,N=b[2]-b[0],Y=b[3]-b[1],S=A-D,A=p[0],ca=p[1];p=p[2];var ga=I.getBoundingInfo(0),ea=ga.getBBMin(),ga=ga.getBBMax();e.set3(1E7,1E7,1E7,ea);e.set3(-1E7,-1E7,-1E7,ga);var aa;for(aa=
0;aa<=c;aa++){var R=aa/c,da=D+R*S;t[aa]=Math.sin(da);u[aa]=Math.cos(da);x[aa]=R;r[aa]=b[0]+R*N}for(D=N=0;D<=F;D++){S=D/F;aa=l(z,E,S);var da=Math.cos(aa),fa=Math.sin(aa),la;d?(la=g/2*Math.log((1+fa)/(1-fa)),S=(la-b[1])/Y):la=180*aa/Math.PI;for(aa=0;aa<=c;aa++){var R=x[aa],ja=t[aa],ka=u[aa],Q=g;h&&(Q+=f(r[aa],la,h)||0);var ka=ka*da*Q,ja=ja*da*Q,Q=fa*Q,va=ka-A,na=ja-ca,ya=Q-p;k(va,na,ya,ea,ga);var w=5*N;J[w+0]=va;J[w+1]=na;J[w+2]=ya;J[w+3]=R;J[w+4]=S;w=-1;0===D&&(w=G+aa);aa===c&&(w=G+c+D);D===F&&(w=
G+c+F+(c-aa));0===aa&&0<D&&(w=G+2*c+F+(F-D));-1<w&&(ka=ka*H-A,ja=ja*H-ca,Q=Q*H-p,k(ka,ja,Q,ea,ga),w*=5,J[w+0]=ka,J[w+1]=ja,J[w+2]=Q,J[w+3]=R,J[w+4]=S);++N}}d&&(b=!!(n&2),n&1&&v(-1,c,J,G),b&&v(1,c,J,G+c+F));return C(I,a,d?n:0,m,B)},releaseGeometry:q.put,elevationSampler:f,_geometryObjectPool:q}})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define("require exports ./IdGen ./Util ./BoundingInfo ./ComponentUtils".split(" "),function(m,h,d,c,a,b){m=function(){function d(a,b,e){this.singleUse=
!1;this.componentAABB=null;this.id=d.__idGen.gen(b);this.data=a;this.boundingInfos=e||[];c.assert(1<=a.faces.length)}d.prototype.getId=function(){return this.id};d.prototype.getData=function(){return this.data};Object.defineProperty(d.prototype,"numGroups",{get:function(){return this.data.faces.length},enumerable:!0,configurable:!0});d.prototype.getNumGroups=function(){return this.numGroups};d.prototype.getComponentCount=function(){return b.componentCount(this.data.componentOffsets)};d.prototype.getComponentAABB=
function(a,b){null==this.componentAABB&&(this.componentAABB=this._computeComponentAABB());for(var c=0;6>c;c++)b[c]=this.componentAABB[6*a+c];return b};d.prototype._computeComponentAABB=function(){for(var a=this.getComponentCount(),b=new Float32Array(6*a),c=0;c<a;c++)this._calculateAABB(0,c,b,6*c);return b};d.prototype._calculateAABB=function(a,b,c,d){void 0===d&&(d=0);var e=this.data.faces[a];a=e.indices[e.positionKey];var e=this.data.vertexAttributes[e.positionKey].data,f=this.data.componentOffsets,
g=f.length?f[b+1]:a.length,k=Infinity,l=Infinity,h=Infinity,m=-Infinity,r=-Infinity,z=-Infinity;for(b=f.length?f[b]:0;b<g;b++)var B=3*a[b],f=e[B],C=e[B+1],B=e[B+2],k=Math.min(k,f),l=Math.min(l,C),h=Math.min(h,B),m=Math.max(m,f),r=Math.max(r,C),z=Math.max(z,B);c?(c[d]=k,c[d+1]=l,c[d+2]=h,c[d+3]=m,c[d+4]=r,c[d+5]=z):c=[k,l,h,m,r,z];return c};d.prototype.calculateBoundingInfo=function(b,d){b=this.data.faces[b];var e="triangle"===b.type?3:1,f=b.indices[b.positionKey];if(0===f.length)for(var f=new Uint32Array(e),
g=0;g<e;++g)f[g]=g;g=f.length;c.assert(0===g%e);for(var k=g/e,h=new Uint32Array(k),g=0;g<k;++g)h[g]=g;return new a(h,e,f,this.data.vertexAttributes[b.positionKey],d)};d.prototype.getBoundingInfo=function(a){var b=this.boundingInfos[a];null==b&&(b=this.calculateBoundingInfo(a),this.boundingInfos[a]=b);return b};d.prototype.invalidateBoundingInfo=function(){this.boundingInfos=[]};return d}();m.__idGen=new d;return m})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["require","exports",
"./Util","./gl-matrix"],function(m,h,d,c){var a=c.vec3d;return function(){function b(b,c,g,e,l){d.assert(1<=b.length);d.assert(0===g.length%c);d.assert(g.length>=b.length*c);d.assert(3===e.size||4===e.size);this.primitiveIndices=b;this.indices=g;this.position=e;this._numIndexPerPrimitive=c;this._faceRange=l;var f=e.data;e=e.size;var k=0,h=b.length;null!=l&&(k=l[0],h=l[1]+1);var n=e*g[c*b[k]];this.bbMin=a.createFrom(f[n],f[n+1],f[n+2]);this.bbMax=a.create(this.bbMin);for(l=k;l<h;++l)for(var t=c*b[l],
m=0;m<c;++m)for(var n=e*g[t+m],x=0;3>x;++x){var r=f[n+x];r<this.bbMin[x]?this.bbMin[x]=r:r>this.bbMax[x]&&(this.bbMax[x]=r)}this.center=a.create();a.lerp(this.bbMin,this.bbMax,.5,this.center);this.bsRadius=0;for(l=k;l<h;++l)for(t=c*b[l],m=0;m<c;++m)n=e*g[t+m],k=f[n]-this.center[0],x=f[n+1]-this.center[1],n=f[n+2]-this.center[2],n=k*k+x*x+n*n,n>this.bsRadius&&(this.bsRadius=n);this.bsRadius=Math.sqrt(this.bsRadius)}b.prototype.getCenter=function(){return this.center};b.prototype.getBSRadius=function(){return this.bsRadius};
b.prototype.getBBMin=function(){return this.bbMin};b.prototype.getBBMax=function(){return this.bbMax};b.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};b.prototype.getIndices=function(){return this.indices};b.prototype.getPosition=function(){return this.position};b.prototype.getChildren=function(){if(this.children)return this.children;if(1<a.dist2(this.bbMin,this.bbMax)){for(var c=a.lerp(this.bbMin,this.bbMax,.5,a.create()),d=this.primitiveIndices.length,g=new Uint8Array(d),
e=Array(8),l=0;8>l;++l)e[l]=0;for(var h=this.position.size,l=0;l<d;++l){for(var m=0,q=this._numIndexPerPrimitive*this.primitiveIndices[l],n=this.position.data,t=h*this.indices[q],u=n[t],x=n[t+1],r=n[t+2],z=1;z<this._numIndexPerPrimitive;++z){var t=h*this.indices[q+z],B=n[t],C=n[t+1],t=n[t+2];B<u&&(u=B);C<x&&(x=C);t<r&&(r=t)}u<c[0]&&(m|=1);x<c[1]&&(m|=2);r<c[2]&&(m|=4);g[l]=m;++e[m]}for(l=m=0;8>l;++l)0<e[l]&&++m;if(2>m)return;c=Array(8);for(l=0;8>l;++l)c[l]=0<e[l]?new Uint32Array(e[l]):void 0;for(l=
0;8>l;++l)e[l]=0;for(l=0;l<d;++l)m=g[l],c[m][e[m]++]=this.primitiveIndices[l];this.children=Array(8);for(l=0;8>l;++l)void 0!==c[l]&&(this.children[l]=new b(c[l],this._numIndexPerPrimitive,this.indices,this.position))}return this.children};return b}()})},"esri/views/3d/terrain/TileRenderData":function(){define(["require","exports","../lib/glMatrix"],function(m,h,d){var c=d.vec2d;return function(){function a(){this.overlayTexOffset=c.create();this.texOffset=c.create();this.geometryInfo={geometry:null,
numSurfaceIndices:0,numSkirtIndices:0,numWithoutSkirtIndices:0,numVertsPerRow:0};this.init()}a.prototype.init=function(){this.geometryInfo.geometry=null;this.geometryInfo.numSurfaceIndices=0;this.geometryInfo.numSkirtIndices=0;this.geometryInfo.numWithoutSkirtIndices=0;this.geometryInfo.numVertsPerRow=0;this.textureReference=this.texture=this.vao=this.geometryState=null;c.set2(0,0,this.texOffset);this.texScale=1;this.highlightOverlayTexId=this.overlayTexId=null;this.overlayTexScale=[1,1];this.overlayOpacity=
1;this.localOrigin=null};a.prototype.updateGeometryState=function(a){return this.geometryState=a.geometryState(this.geometryState)};return a}()})},"esri/views/3d/terrain/ResourceCounter":function(){define(["require","exports"],function(m,h){return function(){function d(){this._numTileTexturesComposited=0}Object.defineProperty(d.prototype,"numTileTexturesComposited",{get:function(){return this._numTileTexturesComposited},enumerable:!0,configurable:!0});d.prototype.incrementNumTileTexturesComposited=
function(){this._numTileTexturesComposited++};d.prototype.resetNumTileTexturesComposited=function(){this._numTileTexturesComposited=0};return d}()})},"esri/views/3d/terrain/TileRenderer":function(){define("require exports ../lib/glMatrix ../../webgl/FramebufferObject ../../webgl/VertexArrayObject ../../webgl/Texture ../../webgl/BufferObject ../../webgl/Util ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../../vectorTiles/VectorTileDisplayObject ../../vectorTiles/tileRendererHelper3D ./TerrainConst".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){var q=d.vec2d,n=Array(20),t=[0,0];return function(){function d(b,c,d,f,l){this._gridTex=null;this.tileSize=256;this._context=b;this.tileSize=c;this._resourceCounter=f;this._setNeedsRender=l;b.extensions.textureFilterAnisotropic&&(this._maxAnisotropy=Math.min(8,b.parameters.maxMaxAnisotropy));c=new Float32Array(20);c[0]=-1;c[1]=-1;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=-1;c[7]=0;c[8]=1;c[9]=0;c[10]=-1;c[11]=1;c[12]=0;c[13]=0;c[14]=1;c[15]=1;c[16]=1;c[17]=0;c[18]=1;c[19]=
1;this._vaoQuad=new a(b,g.Default3D,{geometry:e.Pos3Tex},{geometry:k.createVertex(b,35044,c)});this._blendLayersProgram=d.get("blendLayers")}d.prototype.dispose=function(){this._fbo&&(this._fbo.dispose(),this._fbo=null);this._vaoQuad&&(this._vaoQuad.dispose(),this._vaoQuad=null);this._gridTex&&(this._gridTex.dispose(),this._gridTex=null);this._blendLayersProgram&&(this._blendLayersProgram.dispose(),this._blendLayersProgram=null);this._context&&(this._context=null)};d.prototype.updateTileTexture=function(a){for(var b=
v.LayerClass.MAP,c=a.layerInfo[b],d=0;d<c.length;d++)c[d].pendingUpdates&=~v.TileUpdateTypes.UPDATE_TEXTURE;if(a.renderData){var e,d=a.renderData,f,g=0,k=!0;for(f=0;f<c.length;f++){e=c[f];var l=a.parentSurface.layerViewByIndex(f,b);n[f]=l.fullOpacity;if(e.data||e.upsampleFromTile)if(g++,!l.isTransparent){k=!1;break}}f===c.length&&f--;0===g&&this._gridTex?(d.textureReference=this._gridTex,q.set2(0,0,d.texOffset),d.texScale=1):1!==g||k?(this._composeMapLayers(a,c,f,k,n),d.textureReference=null,q.set2(0,
0,d.texOffset),d.texScale=1):(e=c[f],e.data?(b=e,q.set2(0,0,d.texOffset),d.texScale=1):(a=e.upsampleFromTile,b=a.tile.layerInfo[b][f],q.set(a.offset,d.texOffset),d.texScale=a.scale),b&&(b.data instanceof HTMLImageElement&&(b.data=this._buildTexture(b.data)),d.textureReference=b.data));this._setNeedsRender()}};d.prototype.setGridImage=function(a){this._gridTex=this._buildTexture(a)};d.prototype._buildTexture=function(a){var c={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,
maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},d=this._context,e;if(a)try{e=new b(d,c,a)}catch(C){c.width=c.height=this.tileSize,e=new b(d,c),console.warn("TileRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}else c.width=c.height=this.tileSize,e=new b(d,c);d.bindTexture(e);e.generateMipmap();return e};d.prototype._drawVectorData=function(a,b,c,d,e,f,g,k){void 0===k&&(k=1);p(this._context,c,a,b.renderer,b.schemeHelper,c[0],d,e,0,f,g,k)};d.prototype._drawRasterData=
function(a,b,c,d){void 0===d&&(d=1);var e=this._context,g=this._blendLayersProgram,k=this._vaoQuad;e.bindProgram(g);e.bindVAO(k);f.assertCompatibleVertexAttributeLocations(k,g);e.bindTexture(a,0);g.setUniform1i("tex",0);g.setUniform1f("scale",b);g.setUniform2f("offset",c[0],c[1]);g.setUniform1f("opacity",d);e.drawArrays(5,0,f.vertexCount(k,"geometry"))};d.prototype._composeMapLayers=function(a,b,d,e,f){var g=v.LayerClass.MAP,k=this._context;a.renderData.texture||(a.renderData.texture=this._buildTexture());
var h=a.renderData.texture,p=this._fbo;p&&p.width===h.descriptor.width&&p.height===h.descriptor.height||(this._fbo=p=c.create(k,{colorTarget:0,depthStencilTarget:1,width:h.descriptor.width,height:h.descriptor.height}));var n=k.gl;k.bindFramebuffer(p);k.setViewport(0,0,this.tileSize,this.tileSize);k.setClearColor(0,0,0,0);k.setClearDepth(1);k.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);k.setDepthTestEnabled(!1);k.setBlendFunctionSeparate(1,771,1,771);k.setBlendEquation(32774);k.setBlendingEnabled(!0);
var q,r;for(e&&this._gridTex&&this._drawRasterData(this._gridTex,1,t);0<=d;d--)if(e=null,p=b[d],p.data?(e=p,q=t,r=1):p.upsampleFromTile&&(r=p.upsampleFromTile,e=r.tile.layerInfo[g][d],q=r.offset,r=r.scale),e){if(e.data instanceof HTMLImageElement||e.data instanceof HTMLCanvasElement)e.data=this._buildTexture(e.data);e.data instanceof l?(p=a.parentSurface.layerViewByIndex(d,g),this._drawVectorData(e.data,p,a.lij,h.descriptor.width,h.descriptor.height,r,q,f[d])):this._drawRasterData(e.data,r,q,f[d])}k.bindTexture(h);
n.copyTexImage2D(k.gl.TEXTURE_2D,0,h.descriptor.pixelFormat,0,0,h.descriptor.width,h.descriptor.height,0);h.generateMipmap();k.bindFramebuffer(null);k.setBlendFunctionSeparate(770,771,1,771);k.setBlendingEnabled(!1);this._resourceCounter.incrementNumTileTexturesComposited()};return d}()})},"esri/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ../../core/ObjectPool ../../geometry/support/spatialReferenceUtils ../webgl/BufferObject ../2d/engine/DisplayObject ../2d/tiling/TileKey ./RenderBucket".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){m=function(b){function g(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];e=b.call(this)||this;e._renderBuckets=[];e._vectorTileData=null;e._symbolUpdateData=null;e.status=5;e.coords=[0,0];e.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};e.stencilData={mask:0,reference:0};e.status=0;e.tileTransform.transform=a.create();e.tileTransform.displayCoord=c.create();0<d.length&&(f=e.acquire).call.apply(f,[e].concat(d));return e;var f}d(g,
b);g.prototype.reset=function(){e.pool.release(this.key);this.refKey=this.key=null;this.coords[0]=0;this.height=this.width=this.coords[1]=0;this.resolution=null;this.rotation=0;this.id=this._connection=this.workerID=this._glyphsMosaic=this.styleLayers=this._vectorTileData=null;this.tileTransform.transform.fill(0);this.tileTransform.displayCoord.fill(0);this.stencilData.mask=0;this.stencilData.reference=0;this._renderBuckets.length=0;this._symbolUpdateData=null;this.status=0};g.prototype.acquire=function(a,
b,c,d,e,f){this.key=a;this.refKey=b;b=c.lods[a.level].resolution;var g=c.size[0]*b,l=c.origin,h=a.col*g,g=a.row*g,p=c.spatialReference,n=0;p&&(p._isWrappable?p._isWrappable():p.isWrappable)&&(n=k.getInfo(p),n=n.valid[1]-n.valid[0]);g=l.y-g;this.coords[0]=l.x+h+a.world*n;this.coords[1]=g;this.widthInPixels=c.size[1];this.coordRange=4096;this.resolution=b;this.rotation=f;this.styleLayers=d;this._glyphsMosaic=e;this.id=a.id;this.status=1};g.prototype.setData=function(a,b,c){this._vectorTileData=a;this.workerID=
b;this._connection=c;this.status=3};g.prototype.updateSymbolData=function(a){a&&(this._symbolUpdateData=a,this.requestRender())};g.prototype.dispose=function(){this.polygonTrianglesVertexArrayObject&&(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),
this.lineTrianglesVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&
(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),
this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);this.texture&&(this.texture.dispose(),this.texture=null);this._renderBuckets.length=0;this.status=7};g.prototype.attach=function(a){if(4===this.status)return!0;this.status=3;if(!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var b=new Uint32Array(this._vectorTileData.bucketDataInfo),c=b.length,
d=0;d<c;){var e=b[d],g=b[d+1];if(0===g)g=new l.BackgroundRenderBucket,g.layerID=e,this._renderBuckets.push(g),d+=2;else if(1===g)g=new l.FillRenderBucket,g.layerID=e,g.triangleElementStart=b[d+2],g.triangleElementCount=b[d+3],g.outlineElementStart=b[d+4],g.outlineElementCount=b[d+5],this._renderBuckets.push(g),d+=6;else if(2===g)g=new l.LineRenderBucket,g.layerID=e,g.triangleElementStart=b[d+2],g.triangleElementCount=b[d+3],this._renderBuckets.push(g),d+=6;else if(3===g){g=new l.SymbolRenderBucket;
g.layerID=e;g.isSDF=0!==b[d+2];var e=b[d+3],k=d+4;if(0<e)for(var k=d+4,h=void 0,p=void 0,q=void 0,m=0;m<e;m++)h=b[k],p=b[k+1],q=b[k+2],g.markerPerPageElementsMap.set(h,[p,q]),k+=3;var v=b[k];if(0<v)for(k++,q=p=h=void 0,m=0;m<v;m++)h=b[k],p=b[k+1],q=b[k+2],g.glyphPerPageElementsMap.set(h,[p,q]),k+=3;this._renderBuckets.push(g);d+=5+3*e+3*v}else console.error("Bad bucket type!")}a=a.context;b=new Uint32Array(this._vectorTileData.bufferDataInfo);c=b.length;for(g=d=0;g<c;g+=2,d++)if(!(0>=b[g+1]||0===
this._vectorTileData.bufferData[d].byteLength))switch(b[g]){case 2:this.polygonTrianglesVertexBuffer?this.polygonTrianglesVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.polygonTrianglesVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 6:this.polygonTrianglesIndexBuffer?this.polygonTrianglesIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.polygonTrianglesIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);break;case 3:this.polygonOutlinesVertexBuffer?
this.polygonOutlinesVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.polygonOutlinesVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 7:this.polygonOutlinesIndexBuffer?this.polygonOutlinesIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.polygonOutlinesIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);break;case 0:this.lineVertexBuffer?this.lineVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.lineVertexBuffer=
f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 8:this.lineTrianglesIndexBuffer?this.lineTrianglesIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.lineTrianglesIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);break;case 4:this.iconVertexBuffer?this.iconVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.iconVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 9:this.iconIndexBuffer?this.iconIndexBuffer.setData(this._vectorTileData.bufferData[d]):
this.iconIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);break;case 5:this.textVertexBuffer?this.textVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.textVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 10:this.textIndexBuffer?this.textIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.textIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d])}this.status=4;return!0};g.prototype.detach=function(a){-1!==this.workerID&&
this._connection&&6!==this.status&&7!==this.status&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.dispose();b.prototype.detach.call(this,a)};g.prototype.doRender=function(a){if(this.visible&&4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,this.stencilData.reference,this.stencilData.mask);var e=this.styleLayers,f=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==
f){var g,k=this._renderBuckets.length,l=0;if(0===d)for(l=k-1;0<=l;l--)g=this._renderBuckets[l],3!==g.type&&g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID],f);else for(l=0;l<k;l++)g=this._renderBuckets[l],g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID],f)}}}};g.prototype._updateSymbolData=function(a){var b=new Uint32Array(this._symbolUpdateData.bucketDataInfo),c=b.length;if(0===c)return this._symbolUpdateData=null,
!0;if(1>a.budget.remaining||4!==this.status)return this.requestRender(),!1;a=a.context;for(var d=new Uint32Array(this._symbolUpdateData.bufferDataInfo),e=d.length,g=0,k=0;k<e;k+=2,g++)switch(d[k]){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[g]);break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=f.createIndex(a,
35044,this._symbolUpdateData.bufferData[g]);break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[g]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=f.createIndex(a,35044,this._symbolUpdateData.bufferData[g])}a=this._renderBuckets.length;for(d=0;d<a;d++)this._renderBuckets[d]instanceof l.SymbolRenderBucket&&(e=
this._renderBuckets[d],e.markerPerPageElementsMap.clear(),e.glyphPerPageElementsMap.clear());for(a=0;a<c;){e=b[a];g=-1;k=this._renderBuckets.length;for(d=0;d<k;d++)if(this._renderBuckets[d].layerID===e){g=d;break}d=this._renderBuckets[g];d||(d=new l.SymbolRenderBucket,d.layerID=e,d.isSDF=0!==b[a+2],this._renderBuckets.push(d));var e=b[a+3],h=a+4;if(0<e)for(var h=a+4,p=k=g=void 0,q=0;q<e;q++)g=b[h],k=b[h+1],p=b[h+2],d.markerPerPageElementsMap.set(g,[k,p]),h+=3;var m=b[h];if(0<m)for(h++,p=k=g=void 0,
q=0;q<m;q++)g=b[h],k=b[h+1],p=b[h+2],d.glyphPerPageElementsMap.set(g,[k,p]),h+=3;a+=5+3*e+3*m}this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this._symbolUpdateData=null;return!0};return g}(g);m.pool=new b(m);return m})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var h={create:function(){var d=new m.ARRAY_TYPE(2);d[0]=
0;d[1]=0;return d},clone:function(d){var c=new m.ARRAY_TYPE(2);c[0]=d[0];c[1]=d[1];return c},fromValues:function(d,c){var a=new m.ARRAY_TYPE(2);a[0]=d;a[1]=c;return a},copy:function(d,c){d[0]=c[0];d[1]=c[1];return d},set:function(d,c,a){d[0]=c;d[1]=a;return d},add:function(d,c,a){d[0]=c[0]+a[0];d[1]=c[1]+a[1];return d},subtract:function(d,c,a){d[0]=c[0]-a[0];d[1]=c[1]-a[1];return d}};h.sub=h.subtract;h.multiply=function(d,c,a){d[0]=c[0]*a[0];d[1]=c[1]*a[1];return d};h.mul=h.multiply;h.divide=function(d,
c,a){d[0]=c[0]/a[0];d[1]=c[1]/a[1];return d};h.div=h.divide;h.ceil=function(d,c){d[0]=Math.ceil(c[0]);d[1]=Math.ceil(c[1]);return d};h.floor=function(d,c){d[0]=Math.floor(c[0]);d[1]=Math.floor(c[1]);return d};h.min=function(d,c,a){d[0]=Math.min(c[0],a[0]);d[1]=Math.min(c[1],a[1]);return d};h.max=function(d,c,a){d[0]=Math.max(c[0],a[0]);d[1]=Math.max(c[1],a[1]);return d};h.round=function(d,c){d[0]=Math.round(c[0]);d[1]=Math.round(c[1]);return d};h.scale=function(d,c,a){d[0]=c[0]*a;d[1]=c[1]*a;return d};
h.scaleAndAdd=function(d,c,a,b){d[0]=c[0]+a[0]*b;d[1]=c[1]+a[1]*b;return d};h.distance=function(d,c){var a=c[0]-d[0];d=c[1]-d[1];return Math.sqrt(a*a+d*d)};h.dist=h.distance;h.squaredDistance=function(d,c){var a=c[0]-d[0];d=c[1]-d[1];return a*a+d*d};h.sqrDist=h.squaredDistance;h.length=function(d){var c=d[0];d=d[1];return Math.sqrt(c*c+d*d)};h.len=h.length;h.squaredLength=function(d){var c=d[0];d=d[1];return c*c+d*d};h.sqrLen=h.squaredLength;h.negate=function(d,c){d[0]=-c[0];d[1]=-c[1];return d};
h.inverse=function(d,c){d[0]=1/c[0];d[1]=1/c[1];return d};h.normalize=function(d,c){var a=c[0],b=c[1],a=a*a+b*b;0<a&&(a=1/Math.sqrt(a),d[0]=c[0]*a,d[1]=c[1]*a);return d};h.dot=function(d,c){return d[0]*c[0]+d[1]*c[1]};h.cross=function(d,c,a){c=c[0]*a[1]-c[1]*a[0];d[0]=d[1]=0;d[2]=c;return d};h.lerp=function(d,c,a,b){var k=c[0];c=c[1];d[0]=k+b*(a[0]-k);d[1]=c+b*(a[1]-c);return d};h.random=function(d,c){c=c||1;var a=2*m.RANDOM()*Math.PI;d[0]=Math.cos(a)*c;d[1]=Math.sin(a)*c;return d};h.transformMat2=
function(d,c,a){var b=c[0];c=c[1];d[0]=a[0]*b+a[2]*c;d[1]=a[1]*b+a[3]*c;return d};h.transformMat2d=function(d,c,a){var b=c[0];c=c[1];d[0]=a[0]*b+a[2]*c+a[4];d[1]=a[1]*b+a[3]*c+a[5];return d};h.transformMat3=function(d,c,a){var b=c[0];c=c[1];d[0]=a[0]*b+a[3]*c+a[6];d[1]=a[1]*b+a[4]*c+a[7];return d};h.transformMat4=function(d,c,a){var b=c[0];c=c[1];d[0]=a[0]*b+a[4]*c+a[12];d[1]=a[1]*b+a[5]*c+a[13];return d};h.forEach=function(){var d=h.create();return function(c,a,b,k,f,g){a||(a=2);b||(b=0);for(k=k?
Math.min(k*a+b,c.length):c.length;b<k;b+=a)d[0]=c[b],d[1]=c[b+1],f(d,d,g),c[b]=d[0],c[b+1]=d[1];return c}}();h.str=function(d){return"vec2("+d[0]+", "+d[1]+")"};h.exactEquals=function(d,c){return d[0]===c[0]&&d[1]===c[1]};h.equals=function(d,c){var a=d[0];d=d[1];var b=c[0];c=c[1];return Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(d-c)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(c))};return h})},"esri/core/libs/gl-matrix/common":function(){define([],function(){var m={EPSILON:1E-6};
m.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;m.RANDOM=Math.random;m.ENABLE_SIMD=!1;m.SIMD_AVAILABLE=m.ARRAY_TYPE===Float32Array&&"SIMD"in this;m.USE_SIMD=m.ENABLE_SIMD&&m.SIMD_AVAILABLE;m.setMatrixArrayType=function(d){m.ARRAY_TYPE=d};var h=Math.PI/180;m.toRadian=function(d){return d*h};m.equals=function(d,c){return Math.abs(d-c)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(c))};return m})},"esri/core/libs/gl-matrix/mat4":function(){define(["./common"],function(m){var h={scalar:{},
SIMD:{},create:function(){var d=new m.ARRAY_TYPE(16);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d},clone:function(d){var c=new m.ARRAY_TYPE(16);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return c},copy:function(d,c){d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=c[6];d[7]=
c[7];d[8]=c[8];d[9]=c[9];d[10]=c[10];d[11]=c[11];d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return d},fromValues:function(d,c,a,b,k,f,g,e,l,h,v,q,n,t,u,x){var p=new m.ARRAY_TYPE(16);p[0]=d;p[1]=c;p[2]=a;p[3]=b;p[4]=k;p[5]=f;p[6]=g;p[7]=e;p[8]=l;p[9]=h;p[10]=v;p[11]=q;p[12]=n;p[13]=t;p[14]=u;p[15]=x;return p},set:function(d,c,a,b,k,f,g,e,l,h,m,q,n,t,u,x,r){d[0]=c;d[1]=a;d[2]=b;d[3]=k;d[4]=f;d[5]=g;d[6]=e;d[7]=l;d[8]=h;d[9]=m;d[10]=q;d[11]=n;d[12]=t;d[13]=u;d[14]=x;d[15]=r;return d},identity:function(d){d[0]=
1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d}};h.scalar.transpose=function(d,c){if(d===c){var a=c[1],b=c[2],k=c[3],f=c[6],g=c[7],e=c[11];d[1]=c[4];d[2]=c[8];d[3]=c[12];d[4]=a;d[6]=c[9];d[7]=c[13];d[8]=b;d[9]=f;d[11]=c[14];d[12]=k;d[13]=g;d[14]=e}else d[0]=c[0],d[1]=c[4],d[2]=c[8],d[3]=c[12],d[4]=c[1],d[5]=c[5],d[6]=c[9],d[7]=c[13],d[8]=c[2],d[9]=c[6],d[10]=c[10],d[11]=c[14],d[12]=c[3],d[13]=c[7],d[14]=c[11],d[15]=c[15];return d};
h.SIMD.transpose=function(d,c){var a,b,k,f,g,e;a=SIMD.Float32x4.load(c,0);b=SIMD.Float32x4.load(c,4);k=SIMD.Float32x4.load(c,8);c=SIMD.Float32x4.load(c,12);f=SIMD.Float32x4.shuffle(a,b,0,1,4,5);g=SIMD.Float32x4.shuffle(k,c,0,1,4,5);e=SIMD.Float32x4.shuffle(f,g,0,2,4,6);f=SIMD.Float32x4.shuffle(f,g,1,3,5,7);SIMD.Float32x4.store(d,0,e);SIMD.Float32x4.store(d,4,f);f=SIMD.Float32x4.shuffle(a,b,2,3,6,7);g=SIMD.Float32x4.shuffle(k,c,2,3,6,7);a=SIMD.Float32x4.shuffle(f,g,0,2,4,6);b=SIMD.Float32x4.shuffle(f,
g,1,3,5,7);SIMD.Float32x4.store(d,8,a);SIMD.Float32x4.store(d,12,b);return d};h.transpose=m.USE_SIMD?h.SIMD.transpose:h.scalar.transpose;h.scalar.invert=function(d,c){var a=c[0],b=c[1],k=c[2],f=c[3],g=c[4],e=c[5],l=c[6],h=c[7],m=c[8],q=c[9],n=c[10],t=c[11],u=c[12],x=c[13],r=c[14];c=c[15];var z=a*e-b*g,B=a*l-k*g,C=a*h-f*g,A=b*l-k*e,D=b*h-f*e,E=k*h-f*l,H=m*x-q*u,G=m*r-n*u,J=m*c-t*u,I=q*r-n*x,F=q*c-t*x,N=n*c-t*r,L=z*N-B*F+C*I+A*J-D*G+E*H;if(!L)return null;L=1/L;d[0]=(e*N-l*F+h*I)*L;d[1]=(k*F-b*N-f*I)*
L;d[2]=(x*E-r*D+c*A)*L;d[3]=(n*D-q*E-t*A)*L;d[4]=(l*J-g*N-h*G)*L;d[5]=(a*N-k*J+f*G)*L;d[6]=(r*C-u*E-c*B)*L;d[7]=(m*E-n*C+t*B)*L;d[8]=(g*F-e*J+h*H)*L;d[9]=(b*J-a*F-f*H)*L;d[10]=(u*D-x*C+c*z)*L;d[11]=(q*C-m*D-t*z)*L;d[12]=(e*G-g*I-l*H)*L;d[13]=(a*I-b*G+k*H)*L;d[14]=(x*B-u*A-r*z)*L;d[15]=(m*A-q*B+n*z)*L;return d};h.SIMD.invert=function(d,c){var a,b,k,f,g,e,l,h;g=SIMD.Float32x4.load(c,0);e=SIMD.Float32x4.load(c,4);l=SIMD.Float32x4.load(c,8);h=SIMD.Float32x4.load(c,12);c=SIMD.Float32x4.shuffle(g,e,0,1,
4,5);b=SIMD.Float32x4.shuffle(l,h,0,1,4,5);a=SIMD.Float32x4.shuffle(c,b,0,2,4,6);b=SIMD.Float32x4.shuffle(b,c,1,3,5,7);c=SIMD.Float32x4.shuffle(g,e,2,3,6,7);f=SIMD.Float32x4.shuffle(l,h,2,3,6,7);k=SIMD.Float32x4.shuffle(c,f,0,2,4,6);f=SIMD.Float32x4.shuffle(f,c,1,3,5,7);c=SIMD.Float32x4.mul(k,f);c=SIMD.Float32x4.swizzle(c,1,0,3,2);g=SIMD.Float32x4.mul(b,c);e=SIMD.Float32x4.mul(a,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);g=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),g);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,
c),e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);c=SIMD.Float32x4.mul(b,k);c=SIMD.Float32x4.swizzle(c,1,0,3,2);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),g);h=SIMD.Float32x4.mul(a,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(f,c));h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,2,3,0,1),f);c=SIMD.Float32x4.swizzle(c,1,0,3,2);k=SIMD.Float32x4.swizzle(k,2,3,0,1);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,
c),g);l=SIMD.Float32x4.mul(a,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(k,c));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);c=SIMD.Float32x4.mul(a,b);c=SIMD.Float32x4.swizzle(c,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),l);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,c),h);c=SIMD.Float32x4.swizzle(c,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,c),l);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(k,c));c=SIMD.Float32x4.mul(a,
f);c=SIMD.Float32x4.swizzle(c,1,0,3,2);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(k,c));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,c),l);c=SIMD.Float32x4.swizzle(c,2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,c),e);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(b,c));c=SIMD.Float32x4.mul(a,k);c=SIMD.Float32x4.swizzle(c,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),e);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(b,c));c=SIMD.Float32x4.swizzle(c,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(f,
c));h=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,c),h);a=SIMD.Float32x4.mul(a,g);a=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(a,2,3,0,1),a);a=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(a,1,0,3,2),a);c=SIMD.Float32x4.reciprocalApproximation(a);a=SIMD.Float32x4.sub(SIMD.Float32x4.add(c,c),SIMD.Float32x4.mul(a,SIMD.Float32x4.mul(c,c)));a=SIMD.Float32x4.swizzle(a,0,0,0,0);if(!a)return null;SIMD.Float32x4.store(d,0,SIMD.Float32x4.mul(a,g));SIMD.Float32x4.store(d,4,SIMD.Float32x4.mul(a,e));SIMD.Float32x4.store(d,
8,SIMD.Float32x4.mul(a,l));SIMD.Float32x4.store(d,12,SIMD.Float32x4.mul(a,h));return d};h.invert=m.USE_SIMD?h.SIMD.invert:h.scalar.invert;h.scalar.adjoint=function(d,c){var a=c[0],b=c[1],k=c[2],f=c[3],g=c[4],e=c[5],l=c[6],h=c[7],m=c[8],q=c[9],n=c[10],t=c[11],u=c[12],x=c[13],r=c[14];c=c[15];d[0]=e*(n*c-t*r)-q*(l*c-h*r)+x*(l*t-h*n);d[1]=-(b*(n*c-t*r)-q*(k*c-f*r)+x*(k*t-f*n));d[2]=b*(l*c-h*r)-e*(k*c-f*r)+x*(k*h-f*l);d[3]=-(b*(l*t-h*n)-e*(k*t-f*n)+q*(k*h-f*l));d[4]=-(g*(n*c-t*r)-m*(l*c-h*r)+u*(l*t-h*
n));d[5]=a*(n*c-t*r)-m*(k*c-f*r)+u*(k*t-f*n);d[6]=-(a*(l*c-h*r)-g*(k*c-f*r)+u*(k*h-f*l));d[7]=a*(l*t-h*n)-g*(k*t-f*n)+m*(k*h-f*l);d[8]=g*(q*c-t*x)-m*(e*c-h*x)+u*(e*t-h*q);d[9]=-(a*(q*c-t*x)-m*(b*c-f*x)+u*(b*t-f*q));d[10]=a*(e*c-h*x)-g*(b*c-f*x)+u*(b*h-f*e);d[11]=-(a*(e*t-h*q)-g*(b*t-f*q)+m*(b*h-f*e));d[12]=-(g*(q*r-n*x)-m*(e*r-l*x)+u*(e*n-l*q));d[13]=a*(q*r-n*x)-m*(b*r-k*x)+u*(b*n-k*q);d[14]=-(a*(e*r-l*x)-g*(b*r-k*x)+u*(b*l-k*e));d[15]=a*(e*n-l*q)-g*(b*n-k*q)+m*(b*l-k*e);return d};h.SIMD.adjoint=
function(d,c){var a,b,k,f,g,e,l,h;a=SIMD.Float32x4.load(c,0);b=SIMD.Float32x4.load(c,4);k=SIMD.Float32x4.load(c,8);f=SIMD.Float32x4.load(c,12);e=SIMD.Float32x4.shuffle(a,b,0,1,4,5);g=SIMD.Float32x4.shuffle(k,f,0,1,4,5);c=SIMD.Float32x4.shuffle(e,g,0,2,4,6);g=SIMD.Float32x4.shuffle(g,e,1,3,5,7);e=SIMD.Float32x4.shuffle(a,b,2,3,6,7);b=SIMD.Float32x4.shuffle(k,f,2,3,6,7);a=SIMD.Float32x4.shuffle(e,b,0,2,4,6);b=SIMD.Float32x4.shuffle(b,e,1,3,5,7);e=SIMD.Float32x4.mul(a,b);e=SIMD.Float32x4.swizzle(e,1,
0,3,2);k=SIMD.Float32x4.mul(g,e);f=SIMD.Float32x4.mul(c,e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);k=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,e),k);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,e),f);f=SIMD.Float32x4.swizzle(f,2,3,0,1);e=SIMD.Float32x4.mul(g,a);e=SIMD.Float32x4.swizzle(e,1,0,3,2);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,e),k);h=SIMD.Float32x4.mul(c,e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(b,e));h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,e),h);h=SIMD.Float32x4.swizzle(h,
2,3,0,1);e=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,3,0,1),b);e=SIMD.Float32x4.swizzle(e,1,0,3,2);a=SIMD.Float32x4.swizzle(a,2,3,0,1);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,e),k);l=SIMD.Float32x4.mul(c,e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(a,e));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,e),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);e=SIMD.Float32x4.mul(c,g);e=SIMD.Float32x4.swizzle(e,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,e),l);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,
e),h);e=SIMD.Float32x4.swizzle(e,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,e),l);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(a,e));e=SIMD.Float32x4.mul(c,b);e=SIMD.Float32x4.swizzle(e,1,0,3,2);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(a,e));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,e),l);e=SIMD.Float32x4.swizzle(e,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,e),f);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(g,e));e=SIMD.Float32x4.mul(c,a);e=SIMD.Float32x4.swizzle(e,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,
e),f);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(g,e));e=SIMD.Float32x4.swizzle(e,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(b,e));h=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,e),h);SIMD.Float32x4.store(d,0,k);SIMD.Float32x4.store(d,4,f);SIMD.Float32x4.store(d,8,l);SIMD.Float32x4.store(d,12,h);return d};h.adjoint=m.USE_SIMD?h.SIMD.adjoint:h.scalar.adjoint;h.determinant=function(d){var c=d[0],a=d[1],b=d[2],k=d[3],f=d[4],g=d[5],e=d[6],l=d[7],h=d[8],m=d[9],q=d[10],n=d[11],t=d[12],u=d[13],x=d[14];
d=d[15];return(c*g-a*f)*(q*d-n*x)-(c*e-b*f)*(m*d-n*u)+(c*l-k*f)*(m*x-q*u)+(a*e-b*g)*(h*d-n*t)-(a*l-k*g)*(h*x-q*t)+(b*l-k*e)*(h*u-m*t)};h.SIMD.multiply=function(d,c,a){var b=SIMD.Float32x4.load(c,0),k=SIMD.Float32x4.load(c,4),f=SIMD.Float32x4.load(c,8);c=SIMD.Float32x4.load(c,12);var g=SIMD.Float32x4.load(a,0),g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),b),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,
2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),c))));SIMD.Float32x4.store(d,0,g);g=SIMD.Float32x4.load(a,4);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),b),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),c))));SIMD.Float32x4.store(d,4,g);g=SIMD.Float32x4.load(a,8);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,
0,0,0,0),b),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),c))));SIMD.Float32x4.store(d,8,g);a=SIMD.Float32x4.load(a,12);b=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,0,0,0,0),b),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,2,2,2),
f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,3,3,3,3),c))));SIMD.Float32x4.store(d,12,b);return d};h.scalar.multiply=function(d,c,a){var b=c[0],k=c[1],f=c[2],g=c[3],e=c[4],l=c[5],h=c[6],m=c[7],q=c[8],n=c[9],t=c[10],u=c[11],x=c[12],r=c[13],z=c[14];c=c[15];var B=a[0],C=a[1],A=a[2],D=a[3];d[0]=B*b+C*e+A*q+D*x;d[1]=B*k+C*l+A*n+D*r;d[2]=B*f+C*h+A*t+D*z;d[3]=B*g+C*m+A*u+D*c;B=a[4];C=a[5];A=a[6];D=a[7];d[4]=B*b+C*e+A*q+D*x;d[5]=B*k+C*l+A*n+D*r;d[6]=B*f+C*h+A*t+D*z;d[7]=B*g+C*m+A*u+D*c;B=a[8];C=a[9];A=
a[10];D=a[11];d[8]=B*b+C*e+A*q+D*x;d[9]=B*k+C*l+A*n+D*r;d[10]=B*f+C*h+A*t+D*z;d[11]=B*g+C*m+A*u+D*c;B=a[12];C=a[13];A=a[14];D=a[15];d[12]=B*b+C*e+A*q+D*x;d[13]=B*k+C*l+A*n+D*r;d[14]=B*f+C*h+A*t+D*z;d[15]=B*g+C*m+A*u+D*c;return d};h.multiply=m.USE_SIMD?h.SIMD.multiply:h.scalar.multiply;h.mul=h.multiply;h.scalar.translate=function(d,c,a){var b=a[0],k=a[1];a=a[2];var f,g,e,l,h,m,q,n,t,u,x,r;c===d?(d[12]=c[0]*b+c[4]*k+c[8]*a+c[12],d[13]=c[1]*b+c[5]*k+c[9]*a+c[13],d[14]=c[2]*b+c[6]*k+c[10]*a+c[14],d[15]=
c[3]*b+c[7]*k+c[11]*a+c[15]):(f=c[0],g=c[1],e=c[2],l=c[3],h=c[4],m=c[5],q=c[6],n=c[7],t=c[8],u=c[9],x=c[10],r=c[11],d[0]=f,d[1]=g,d[2]=e,d[3]=l,d[4]=h,d[5]=m,d[6]=q,d[7]=n,d[8]=t,d[9]=u,d[10]=x,d[11]=r,d[12]=f*b+h*k+t*a+c[12],d[13]=g*b+m*k+u*a+c[13],d[14]=e*b+q*k+x*a+c[14],d[15]=l*b+n*k+r*a+c[15]);return d};h.SIMD.translate=function(d,c,a){var b=SIMD.Float32x4.load(c,0),k=SIMD.Float32x4.load(c,4),f=SIMD.Float32x4.load(c,8),g=SIMD.Float32x4.load(c,12);a=SIMD.Float32x4(a[0],a[1],a[2],0);c!==d&&(d[0]=
c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11]);b=SIMD.Float32x4.mul(b,SIMD.Float32x4.swizzle(a,0,0,0,0));k=SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(a,1,1,1,1));f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(a,2,2,2,2));c=SIMD.Float32x4.add(b,SIMD.Float32x4.add(k,SIMD.Float32x4.add(f,g)));SIMD.Float32x4.store(d,12,c);return d};h.translate=m.USE_SIMD?h.SIMD.translate:h.scalar.translate;h.scalar.scale=function(d,c,a){var b=a[0],
k=a[1];a=a[2];d[0]=c[0]*b;d[1]=c[1]*b;d[2]=c[2]*b;d[3]=c[3]*b;d[4]=c[4]*k;d[5]=c[5]*k;d[6]=c[6]*k;d[7]=c[7]*k;d[8]=c[8]*a;d[9]=c[9]*a;d[10]=c[10]*a;d[11]=c[11]*a;d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return d};h.SIMD.scale=function(d,c,a){var b;a=SIMD.Float32x4(a[0],a[1],a[2],0);b=SIMD.Float32x4.load(c,0);SIMD.Float32x4.store(d,0,SIMD.Float32x4.mul(b,SIMD.Float32x4.swizzle(a,0,0,0,0)));b=SIMD.Float32x4.load(c,4);SIMD.Float32x4.store(d,4,SIMD.Float32x4.mul(b,SIMD.Float32x4.swizzle(a,1,1,
1,1)));b=SIMD.Float32x4.load(c,8);SIMD.Float32x4.store(d,8,SIMD.Float32x4.mul(b,SIMD.Float32x4.swizzle(a,2,2,2,2)));d[12]=c[12];d[13]=c[13];d[14]=c[14];d[15]=c[15];return d};h.scale=m.USE_SIMD?h.SIMD.scale:h.scalar.scale;h.rotate=function(d,c,a,b){var k=b[0],f=b[1];b=b[2];var g=Math.sqrt(k*k+f*f+b*b),e,l,h,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I;if(Math.abs(g)<m.EPSILON)return null;g=1/g;k*=g;f*=g;b*=g;e=Math.sin(a);l=Math.cos(a);h=1-l;a=c[0];g=c[1];v=c[2];q=c[3];n=c[4];t=c[5];u=c[6];x=c[7];r=c[8];z=c[9];
B=c[10];C=c[11];A=k*k*h+l;D=f*k*h+b*e;E=b*k*h-f*e;H=k*f*h-b*e;G=f*f*h+l;J=b*f*h+k*e;I=k*b*h+f*e;k=f*b*h-k*e;f=b*b*h+l;d[0]=a*A+n*D+r*E;d[1]=g*A+t*D+z*E;d[2]=v*A+u*D+B*E;d[3]=q*A+x*D+C*E;d[4]=a*H+n*G+r*J;d[5]=g*H+t*G+z*J;d[6]=v*H+u*G+B*J;d[7]=q*H+x*G+C*J;d[8]=a*I+n*k+r*f;d[9]=g*I+t*k+z*f;d[10]=v*I+u*k+B*f;d[11]=q*I+x*k+C*f;c!==d&&(d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);return d};h.scalar.rotateX=function(d,c,a){var b=Math.sin(a);a=Math.cos(a);var k=c[4],f=c[5],g=c[6],e=c[7],l=c[8],h=c[9],
m=c[10],q=c[11];c!==d&&(d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);d[4]=k*a+l*b;d[5]=f*a+h*b;d[6]=g*a+m*b;d[7]=e*a+q*b;d[8]=l*a-k*b;d[9]=h*a-f*b;d[10]=m*a-g*b;d[11]=q*a-e*b;return d};h.SIMD.rotateX=function(d,c,a){var b=SIMD.Float32x4.splat(Math.sin(a));a=SIMD.Float32x4.splat(Math.cos(a));c!==d&&(d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);var k=SIMD.Float32x4.load(c,4);c=SIMD.Float32x4.load(c,8);SIMD.Float32x4.store(d,
4,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,a),SIMD.Float32x4.mul(c,b)));SIMD.Float32x4.store(d,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,a),SIMD.Float32x4.mul(k,b)));return d};h.rotateX=m.USE_SIMD?h.SIMD.rotateX:h.scalar.rotateX;h.scalar.rotateY=function(d,c,a){var b=Math.sin(a);a=Math.cos(a);var k=c[0],f=c[1],g=c[2],e=c[3],l=c[8],h=c[9],m=c[10],q=c[11];c!==d&&(d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);d[0]=k*a-l*b;d[1]=f*a-h*b;d[2]=g*a-m*b;d[3]=e*a-q*
b;d[8]=k*b+l*a;d[9]=f*b+h*a;d[10]=g*b+m*a;d[11]=e*b+q*a;return d};h.SIMD.rotateY=function(d,c,a){var b=SIMD.Float32x4.splat(Math.sin(a));a=SIMD.Float32x4.splat(Math.cos(a));c!==d&&(d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);var k=SIMD.Float32x4.load(c,0);c=SIMD.Float32x4.load(c,8);SIMD.Float32x4.store(d,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,a),SIMD.Float32x4.mul(c,b)));SIMD.Float32x4.store(d,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,b),SIMD.Float32x4.mul(c,
a)));return d};h.rotateY=m.USE_SIMD?h.SIMD.rotateY:h.scalar.rotateY;h.scalar.rotateZ=function(d,c,a){var b=Math.sin(a);a=Math.cos(a);var k=c[0],f=c[1],g=c[2],e=c[3],l=c[4],h=c[5],m=c[6],q=c[7];c!==d&&(d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);d[0]=k*a+l*b;d[1]=f*a+h*b;d[2]=g*a+m*b;d[3]=e*a+q*b;d[4]=l*a-k*b;d[5]=h*a-f*b;d[6]=m*a-g*b;d[7]=q*a-e*b;return d};h.SIMD.rotateZ=function(d,c,a){var b=SIMD.Float32x4.splat(Math.sin(a));a=SIMD.Float32x4.splat(Math.cos(a));
c!==d&&(d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]);var k=SIMD.Float32x4.load(c,0);c=SIMD.Float32x4.load(c,4);SIMD.Float32x4.store(d,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,a),SIMD.Float32x4.mul(c,b)));SIMD.Float32x4.store(d,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,a),SIMD.Float32x4.mul(k,b)));return d};h.rotateZ=m.USE_SIMD?h.SIMD.rotateZ:h.scalar.rotateZ;h.fromTranslation=function(d,c){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=
0;d[9]=0;d[10]=1;d[11]=0;d[12]=c[0];d[13]=c[1];d[14]=c[2];d[15]=1;return d};h.fromScaling=function(d,c){d[0]=c[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=c[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=c[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};h.fromRotation=function(d,c,a){var b=a[0],k=a[1];a=a[2];var f=Math.sqrt(b*b+k*k+a*a),g;if(Math.abs(f)<m.EPSILON)return null;f=1/f;b*=f;k*=f;a*=f;f=Math.sin(c);c=Math.cos(c);g=1-c;d[0]=b*b*g+c;d[1]=k*b*g+a*f;d[2]=a*b*g-k*f;d[3]=0;d[4]=b*k*g-a*f;d[5]=k*k*g+c;d[6]=
a*k*g+b*f;d[7]=0;d[8]=b*a*g+k*f;d[9]=k*a*g-b*f;d[10]=a*a*g+c;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};h.fromXRotation=function(d,c){var a=Math.sin(c);c=Math.cos(c);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=c;d[6]=a;d[7]=0;d[8]=0;d[9]=-a;d[10]=c;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};h.fromYRotation=function(d,c){var a=Math.sin(c);c=Math.cos(c);d[0]=c;d[1]=0;d[2]=-a;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=a;d[9]=0;d[10]=c;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};h.fromZRotation=
function(d,c){var a=Math.sin(c);c=Math.cos(c);d[0]=c;d[1]=a;d[2]=0;d[3]=0;d[4]=-a;d[5]=c;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};h.fromRotationTranslation=function(d,c,a){var b=c[0],k=c[1],f=c[2],g=c[3],e=b+b,l=k+k,h=f+f;c=b*e;var m=b*l,b=b*h,q=k*l,k=k*h,f=f*h,e=g*e,l=g*l,g=g*h;d[0]=1-(q+f);d[1]=m+g;d[2]=b-l;d[3]=0;d[4]=m-g;d[5]=1-(c+f);d[6]=k+e;d[7]=0;d[8]=b+l;d[9]=k-e;d[10]=1-(c+q);d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};h.getTranslation=
function(d,c){d[0]=c[12];d[1]=c[13];d[2]=c[14];return d};h.getRotation=function(d,c){var a=c[0]+c[5]+c[10],b=0;0<a?(b=2*Math.sqrt(a+1),d[3]=.25*b,d[0]=(c[6]-c[9])/b,d[1]=(c[8]-c[2])/b,d[2]=(c[1]-c[4])/b):c[0]>c[5]&c[0]>c[10]?(b=2*Math.sqrt(1+c[0]-c[5]-c[10]),d[3]=(c[6]-c[9])/b,d[0]=.25*b,d[1]=(c[1]+c[4])/b,d[2]=(c[8]+c[2])/b):c[5]>c[10]?(b=2*Math.sqrt(1+c[5]-c[0]-c[10]),d[3]=(c[8]-c[2])/b,d[0]=(c[1]+c[4])/b,d[1]=.25*b,d[2]=(c[6]+c[9])/b):(b=2*Math.sqrt(1+c[10]-c[0]-c[5]),d[3]=(c[1]-c[4])/b,d[0]=(c[8]+
c[2])/b,d[1]=(c[6]+c[9])/b,d[2]=.25*b);return d};h.fromRotationTranslationScale=function(d,c,a,b){var k=c[0],f=c[1],g=c[2],e=c[3],l=k+k,h=f+f,m=g+g;c=k*l;var q=k*h,k=k*m,n=f*h,f=f*m,g=g*m,l=e*l,h=e*h,e=e*m,m=b[0],t=b[1];b=b[2];d[0]=(1-(n+g))*m;d[1]=(q+e)*m;d[2]=(k-h)*m;d[3]=0;d[4]=(q-e)*t;d[5]=(1-(c+g))*t;d[6]=(f+l)*t;d[7]=0;d[8]=(k+h)*b;d[9]=(f-l)*b;d[10]=(1-(c+n))*b;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};h.fromRotationTranslationScaleOrigin=function(d,c,a,b,k){var f=c[0],g=c[1],
e=c[2],l=c[3],h=f+f,m=g+g,q=e+e;c=f*h;var n=f*m,f=f*q,t=g*m,g=g*q,e=e*q,h=l*h,m=l*m,l=l*q,q=b[0],u=b[1];b=b[2];var x=k[0],r=k[1];k=k[2];d[0]=(1-(t+e))*q;d[1]=(n+l)*q;d[2]=(f-m)*q;d[3]=0;d[4]=(n-l)*u;d[5]=(1-(c+e))*u;d[6]=(g+h)*u;d[7]=0;d[8]=(f+m)*b;d[9]=(g-h)*b;d[10]=(1-(c+t))*b;d[11]=0;d[12]=a[0]+x-(d[0]*x+d[4]*r+d[8]*k);d[13]=a[1]+r-(d[1]*x+d[5]*r+d[9]*k);d[14]=a[2]+k-(d[2]*x+d[6]*r+d[10]*k);d[15]=1;return d};h.fromQuat=function(d,c){var a=c[0],b=c[1],k=c[2];c=c[3];var f=a+a,g=b+b,e=k+k,a=a*f,l=
b*f,b=b*g,h=k*f,m=k*g,k=k*e,f=c*f,g=c*g;c*=e;d[0]=1-b-k;d[1]=l+c;d[2]=h-g;d[3]=0;d[4]=l-c;d[5]=1-a-k;d[6]=m+f;d[7]=0;d[8]=h+g;d[9]=m-f;d[10]=1-a-b;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};h.frustum=function(d,c,a,b,k,f,g){var e=1/(a-c),l=1/(k-b),h=1/(f-g);d[0]=2*f*e;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=2*f*l;d[6]=0;d[7]=0;d[8]=(a+c)*e;d[9]=(k+b)*l;d[10]=(g+f)*h;d[11]=-1;d[12]=0;d[13]=0;d[14]=g*f*2*h;d[15]=0;return d};h.perspective=function(d,c,a,b,k){c=1/Math.tan(c/2);var f=1/(b-k);d[0]=c/a;
d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=c;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=(k+b)*f;d[11]=-1;d[12]=0;d[13]=0;d[14]=2*k*b*f;d[15]=0;return d};h.perspectiveFromFieldOfView=function(d,c,a,b){var k=Math.tan(c.upDegrees*Math.PI/180),f=Math.tan(c.downDegrees*Math.PI/180),g=Math.tan(c.leftDegrees*Math.PI/180);c=Math.tan(c.rightDegrees*Math.PI/180);var e=2/(g+c),l=2/(k+f);d[0]=e;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=l;d[6]=0;d[7]=0;d[8]=-((g-c)*e*.5);d[9]=(k-f)*l*.5;d[10]=b/(a-b);d[11]=-1;d[12]=0;d[13]=0;d[14]=b*a/(a-
b);d[15]=0;return d};h.ortho=function(d,c,a,b,k,f,g){var e=1/(c-a),l=1/(b-k),h=1/(f-g);d[0]=-2*e;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=-2*l;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=2*h;d[11]=0;d[12]=(c+a)*e;d[13]=(k+b)*l;d[14]=(g+f)*h;d[15]=1;return d};h.lookAt=function(d,c,a,b){var k,f,g,e,l,p,v,q,n=c[0],t=c[1];c=c[2];g=b[0];e=b[1];f=b[2];v=a[0];b=a[1];k=a[2];if(Math.abs(n-v)<m.EPSILON&&Math.abs(t-b)<m.EPSILON&&Math.abs(c-k)<m.EPSILON)return h.identity(d);a=n-v;b=t-b;v=c-k;q=1/Math.sqrt(a*a+b*b+v*v);a*=q;b*=
q;v*=q;k=e*v-f*b;f=f*a-g*v;g=g*b-e*a;(q=Math.sqrt(k*k+f*f+g*g))?(q=1/q,k*=q,f*=q,g*=q):g=f=k=0;e=b*g-v*f;l=v*k-a*g;p=a*f-b*k;(q=Math.sqrt(e*e+l*l+p*p))?(q=1/q,e*=q,l*=q,p*=q):p=l=e=0;d[0]=k;d[1]=e;d[2]=a;d[3]=0;d[4]=f;d[5]=l;d[6]=b;d[7]=0;d[8]=g;d[9]=p;d[10]=v;d[11]=0;d[12]=-(k*n+f*t+g*c);d[13]=-(e*n+l*t+p*c);d[14]=-(a*n+b*t+v*c);d[15]=1;return d};h.str=function(d){return"mat4("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+", "+d[9]+", "+d[10]+", "+d[11]+", "+
d[12]+", "+d[13]+", "+d[14]+", "+d[15]+")"};h.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+Math.pow(d[6],2)+Math.pow(d[7],2)+Math.pow(d[8],2)+Math.pow(d[9],2)+Math.pow(d[10],2)+Math.pow(d[11],2)+Math.pow(d[12],2)+Math.pow(d[13],2)+Math.pow(d[14],2)+Math.pow(d[15],2))};h.add=function(d,c,a){d[0]=c[0]+a[0];d[1]=c[1]+a[1];d[2]=c[2]+a[2];d[3]=c[3]+a[3];d[4]=c[4]+a[4];d[5]=c[5]+a[5];d[6]=c[6]+a[6];d[7]=c[7]+a[7];
d[8]=c[8]+a[8];d[9]=c[9]+a[9];d[10]=c[10]+a[10];d[11]=c[11]+a[11];d[12]=c[12]+a[12];d[13]=c[13]+a[13];d[14]=c[14]+a[14];d[15]=c[15]+a[15];return d};h.subtract=function(d,c,a){d[0]=c[0]-a[0];d[1]=c[1]-a[1];d[2]=c[2]-a[2];d[3]=c[3]-a[3];d[4]=c[4]-a[4];d[5]=c[5]-a[5];d[6]=c[6]-a[6];d[7]=c[7]-a[7];d[8]=c[8]-a[8];d[9]=c[9]-a[9];d[10]=c[10]-a[10];d[11]=c[11]-a[11];d[12]=c[12]-a[12];d[13]=c[13]-a[13];d[14]=c[14]-a[14];d[15]=c[15]-a[15];return d};h.sub=h.subtract;h.multiplyScalar=function(d,c,a){d[0]=c[0]*
a;d[1]=c[1]*a;d[2]=c[2]*a;d[3]=c[3]*a;d[4]=c[4]*a;d[5]=c[5]*a;d[6]=c[6]*a;d[7]=c[7]*a;d[8]=c[8]*a;d[9]=c[9]*a;d[10]=c[10]*a;d[11]=c[11]*a;d[12]=c[12]*a;d[13]=c[13]*a;d[14]=c[14]*a;d[15]=c[15]*a;return d};h.multiplyScalarAndAdd=function(d,c,a,b){d[0]=c[0]+a[0]*b;d[1]=c[1]+a[1]*b;d[2]=c[2]+a[2]*b;d[3]=c[3]+a[3]*b;d[4]=c[4]+a[4]*b;d[5]=c[5]+a[5]*b;d[6]=c[6]+a[6]*b;d[7]=c[7]+a[7]*b;d[8]=c[8]+a[8]*b;d[9]=c[9]+a[9]*b;d[10]=c[10]+a[10]*b;d[11]=c[11]+a[11]*b;d[12]=c[12]+a[12]*b;d[13]=c[13]+a[13]*b;d[14]=
c[14]+a[14]*b;d[15]=c[15]+a[15]*b;return d};h.exactEquals=function(d,c){return d[0]===c[0]&&d[1]===c[1]&&d[2]===c[2]&&d[3]===c[3]&&d[4]===c[4]&&d[5]===c[5]&&d[6]===c[6]&&d[7]===c[7]&&d[8]===c[8]&&d[9]===c[9]&&d[10]===c[10]&&d[11]===c[11]&&d[12]===c[12]&&d[13]===c[13]&&d[14]===c[14]&&d[15]===c[15]};h.equals=function(d,c){var a=d[0],b=d[1],k=d[2],f=d[3],g=d[4],e=d[5],l=d[6],h=d[7],v=d[8],q=d[9],n=d[10],t=d[11],u=d[12],x=d[13],r=d[14];d=d[15];var z=c[0],B=c[1],C=c[2],A=c[3],D=c[4],E=c[5],H=c[6],G=c[7],
J=c[8],I=c[9],F=c[10],N=c[11],L=c[12],M=c[13],K=c[14];c=c[15];return Math.abs(a-z)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(z))&&Math.abs(b-B)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(B))&&Math.abs(k-C)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(C))&&Math.abs(f-A)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(g-D)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(e-E)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(E))&&Math.abs(l-H)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(H))&&
Math.abs(h-G)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(G))&&Math.abs(v-J)<=m.EPSILON*Math.max(1,Math.abs(v),Math.abs(J))&&Math.abs(q-I)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(I))&&Math.abs(n-F)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(F))&&Math.abs(t-N)<=m.EPSILON*Math.max(1,Math.abs(t),Math.abs(N))&&Math.abs(u-L)<=m.EPSILON*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(x-M)<=m.EPSILON*Math.max(1,Math.abs(x),Math.abs(M))&&Math.abs(r-K)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(K))&&Math.abs(d-
c)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(c))};return h})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Evented"],function(m,h,d,c){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._renderRequestedCalled=!1;b._attached=!1;b._opacity=1;b.renderRequested=!1;b._visible=!0;return b}d(b,a);Object.defineProperty(b.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==
a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},
enumerable:!0,configurable:!0});b.prototype.attach=function(a){return!0};b.prototype.detach=function(a){};b.prototype.processRender=function(a){this._renderRequestedCalled=!1;this.doRender(a);this._renderRequestedCalled||(this.renderRequested=!1);this.hasEventListener("post-render")&&this.emit("post-render")};b.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestChildRender(this);a!==this.renderRequested&&
this.hasEventListener("will-render")&&this.emit("will-render")};b.prototype.dispose=function(){};return b}(c.Evented)})},"esri/views/2d/engine/Evented":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","dojo/aspect","dojo/on"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function b(){}b.prototype.on=function(a,b){return c.after(this,"on"+a,b,!0)};b.prototype.once=function(b,c){return a.once(this,b,c)};b.prototype.emit=function(b){a.emit(this,
b,this)};b.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return b}();h.Evented=m;h.EventedMixin=function(b){return function(b){function f(){return null!==b&&b.apply(this,arguments)||this}d(f,b);f.prototype.on=function(a,b){return c.after(this,"on"+a,b,!0)};f.prototype.once=function(b,c){return a.once(this,b,c)};f.prototype.emit=function(b,c){a.emit(this,b,c)};f.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return f}(b)}})},
"esri/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});m=function(){return function(a){this.type=a}}();h.RenderBucket=m;c=function(a){function b(){var b=a.call(this,2)||this;b.triangleElementStart=0;b.triangleElementCount=0;b.joinStart=0;b.joinCount=0;return b}d(b,a);b.prototype.hasData=function(){return 0<this.triangleElementCount||0<
this.joinCount};return b}(m);h.LineRenderBucket=c;c=function(a){function b(){var b=a.call(this,1)||this;b.triangleElementStart=0;b.triangleElementCount=0;b.outlineElementStart=0;b.outlineElementCount=0;return b}d(b,a);b.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount};return b}(m);h.FillRenderBucket=c;c=function(a){function b(){var b=a.call(this,3)||this;b.markerPerPageElementsMap=new Map;b.glyphPerPageElementsMap=new Map;b.isSDF=!1;return b}d(b,a);b.prototype.hasData=
function(){return 0<this.markerPerPageElementsMap.size||0<this.glyphPerPageElementsMap.size};return b}(m);h.SymbolRenderBucket=c;m=function(a){function b(){return a.call(this,0)||this}d(b,a);b.prototype.hasData=function(){return!0};return b}(m);h.BackgroundRenderBucket=m})},"esri/views/vectorTiles/tileRendererHelper3D":function(){define(["require","exports","dojo/has","../../core/libs/gl-matrix/vec3","../../core/libs/gl-matrix/mat4"],function(m,h,d,c,a){var b={extent:{xmin:0,ymin:0,xmax:0,ymax:0,
spatialReference:{wkid:102100,isWrappable:!0},intersects:function(a){return!1}},center:[0,0],scale:1,resolution:1,rotation:0,width:1,height:1,pixelRatio:1,size:[256,256],spatialReference:{wkid:102100,isWrappable:!0},worldScreenWidth:1,viewpoint:{},toMap:function(a,b){return[0,0]},toScreen:function(a,b){return[0,0]},clone:function(){return null},copy:function(a){return this}},k=c.create();return function(c,g,e,l,h,m,q,n,t,u,x,r){t=[g[0],g[1],g[2]];for(var f=u;1>f;f*=2)t[0]--,t[1]>>=1,t[2]>>=1;g={context:c,
budget:null,state:b,stationary:!0,devicePixelRatio:1,displayLevel:h.adjustLevel(m),requiredLevel:h.adjustLevel(g[0]),drawphase:0,renderer:l,layerOpacity:r};if(q!==n)throw Error("It is expected that tiles are square!");m=1/u;r=h.getSchemaShift(t,m);f=r[1];e.tileTransform.displayCoord[0]=-1-2*m*x[0]-r[0];e.tileTransform.displayCoord[1]=1+2*m*(1-x[1]-u)+f;u=e.tileTransform.transform;a.identity(u);h.isWGS84&&512===h.lockedSchemaPixelSize&&(m*=2);h=.25*m/q;k.set([h,-h,1]);a.scale(u,u,k);c.setBlendFunctionSeparate(1,
771,1,771);c.setClearDepth(1);c.clear(c.gl.DEPTH_BUFFER_BIT);g.state.size=[q,n];g.state.width=q;g.state.height=n;l.setStateParams(g.state,g.devicePixelRatio,t[0]);e.attach(g);c.setFaceCullingEnabled(!1);c.setDepthFunction(515);c.setBlendingEnabled(!1);c.setDepthTestEnabled(!0);c.setDepthWriteEnabled(!0);e.processRender(g);c.setDepthWriteEnabled(!1);c.setBlendingEnabled(!0);g.drawphase=1;e.processRender(g);g.drawphase=2;e.processRender(g);d("esri-vector-tiles-debug")&&l.renderTileInfo(c,e);c.setDepthWriteEnabled(!0);
c.setDepthTestEnabled(!1);c.setFaceCullingEnabled(!0)}})},"esri/core/libs/gl-matrix/vec3":function(){define(["./common"],function(m){var h={create:function(){var d=new m.ARRAY_TYPE(3);d[0]=0;d[1]=0;d[2]=0;return d},clone:function(d){var c=new m.ARRAY_TYPE(3);c[0]=d[0];c[1]=d[1];c[2]=d[2];return c},fromValues:function(d,c,a){var b=new m.ARRAY_TYPE(3);b[0]=d;b[1]=c;b[2]=a;return b},copy:function(d,c){d[0]=c[0];d[1]=c[1];d[2]=c[2];return d},set:function(d,c,a,b){d[0]=c;d[1]=a;d[2]=b;return d},add:function(d,
c,a){d[0]=c[0]+a[0];d[1]=c[1]+a[1];d[2]=c[2]+a[2];return d},subtract:function(d,c,a){d[0]=c[0]-a[0];d[1]=c[1]-a[1];d[2]=c[2]-a[2];return d}};h.sub=h.subtract;h.multiply=function(d,c,a){d[0]=c[0]*a[0];d[1]=c[1]*a[1];d[2]=c[2]*a[2];return d};h.mul=h.multiply;h.divide=function(d,c,a){d[0]=c[0]/a[0];d[1]=c[1]/a[1];d[2]=c[2]/a[2];return d};h.div=h.divide;h.ceil=function(d,c){d[0]=Math.ceil(c[0]);d[1]=Math.ceil(c[1]);d[2]=Math.ceil(c[2]);return d};h.floor=function(d,c){d[0]=Math.floor(c[0]);d[1]=Math.floor(c[1]);
d[2]=Math.floor(c[2]);return d};h.min=function(d,c,a){d[0]=Math.min(c[0],a[0]);d[1]=Math.min(c[1],a[1]);d[2]=Math.min(c[2],a[2]);return d};h.max=function(d,c,a){d[0]=Math.max(c[0],a[0]);d[1]=Math.max(c[1],a[1]);d[2]=Math.max(c[2],a[2]);return d};h.round=function(d,c){d[0]=Math.round(c[0]);d[1]=Math.round(c[1]);d[2]=Math.round(c[2]);return d};h.scale=function(d,c,a){d[0]=c[0]*a;d[1]=c[1]*a;d[2]=c[2]*a;return d};h.scaleAndAdd=function(d,c,a,b){d[0]=c[0]+a[0]*b;d[1]=c[1]+a[1]*b;d[2]=c[2]+a[2]*b;return d};
h.distance=function(d,c){var a=c[0]-d[0],b=c[1]-d[1];d=c[2]-d[2];return Math.sqrt(a*a+b*b+d*d)};h.dist=h.distance;h.squaredDistance=function(d,c){var a=c[0]-d[0],b=c[1]-d[1];d=c[2]-d[2];return a*a+b*b+d*d};h.sqrDist=h.squaredDistance;h.length=function(d){var c=d[0],a=d[1];d=d[2];return Math.sqrt(c*c+a*a+d*d)};h.len=h.length;h.squaredLength=function(d){var c=d[0],a=d[1];d=d[2];return c*c+a*a+d*d};h.sqrLen=h.squaredLength;h.negate=function(d,c){d[0]=-c[0];d[1]=-c[1];d[2]=-c[2];return d};h.inverse=function(d,
c){d[0]=1/c[0];d[1]=1/c[1];d[2]=1/c[2];return d};h.normalize=function(d,c){var a=c[0],b=c[1],k=c[2],a=a*a+b*b+k*k;0<a&&(a=1/Math.sqrt(a),d[0]=c[0]*a,d[1]=c[1]*a,d[2]=c[2]*a);return d};h.dot=function(d,c){return d[0]*c[0]+d[1]*c[1]+d[2]*c[2]};h.cross=function(d,c,a){var b=c[0],k=c[1];c=c[2];var f=a[0],g=a[1];a=a[2];d[0]=k*a-c*g;d[1]=c*f-b*a;d[2]=b*g-k*f;return d};h.lerp=function(d,c,a,b){var k=c[0],f=c[1];c=c[2];d[0]=k+b*(a[0]-k);d[1]=f+b*(a[1]-f);d[2]=c+b*(a[2]-c);return d};h.hermite=function(d,c,
a,b,k,f){var g=f*f,e=g*(2*f-3)+1,l=g*(f-2)+f,h=g*(f-1);f=g*(3-2*f);d[0]=c[0]*e+a[0]*l+b[0]*h+k[0]*f;d[1]=c[1]*e+a[1]*l+b[1]*h+k[1]*f;d[2]=c[2]*e+a[2]*l+b[2]*h+k[2]*f;return d};h.bezier=function(d,c,a,b,k,f){var g=1-f,e=g*g,l=f*f,h=e*g,e=3*f*e,g=3*l*g;f*=l;d[0]=c[0]*h+a[0]*e+b[0]*g+k[0]*f;d[1]=c[1]*h+a[1]*e+b[1]*g+k[1]*f;d[2]=c[2]*h+a[2]*e+b[2]*g+k[2]*f;return d};h.random=function(d,c){c=c||1;var a=2*m.RANDOM()*Math.PI,b=2*m.RANDOM()-1,k=Math.sqrt(1-b*b)*c;d[0]=Math.cos(a)*k;d[1]=Math.sin(a)*k;d[2]=
b*c;return d};h.transformMat4=function(d,c,a){var b=c[0],k=c[1];c=c[2];var f=a[3]*b+a[7]*k+a[11]*c+a[15],f=f||1;d[0]=(a[0]*b+a[4]*k+a[8]*c+a[12])/f;d[1]=(a[1]*b+a[5]*k+a[9]*c+a[13])/f;d[2]=(a[2]*b+a[6]*k+a[10]*c+a[14])/f;return d};h.transformMat3=function(d,c,a){var b=c[0],k=c[1];c=c[2];d[0]=b*a[0]+k*a[3]+c*a[6];d[1]=b*a[1]+k*a[4]+c*a[7];d[2]=b*a[2]+k*a[5]+c*a[8];return d};h.transformQuat=function(d,c,a){var b=c[0],k=c[1],f=c[2];c=a[0];var g=a[1],e=a[2];a=a[3];var l=a*b+g*f-e*k,h=a*k+e*b-c*f,m=a*
f+c*k-g*b,b=-c*b-g*k-e*f;d[0]=l*a+b*-c+h*-e-m*-g;d[1]=h*a+b*-g+m*-c-l*-e;d[2]=m*a+b*-e+l*-g-h*-c;return d};h.rotateX=function(d,c,a,b){var k=[],f=[];k[0]=c[0]-a[0];k[1]=c[1]-a[1];k[2]=c[2]-a[2];f[0]=k[0];f[1]=k[1]*Math.cos(b)-k[2]*Math.sin(b);f[2]=k[1]*Math.sin(b)+k[2]*Math.cos(b);d[0]=f[0]+a[0];d[1]=f[1]+a[1];d[2]=f[2]+a[2];return d};h.rotateY=function(d,c,a,b){var k=[],f=[];k[0]=c[0]-a[0];k[1]=c[1]-a[1];k[2]=c[2]-a[2];f[0]=k[2]*Math.sin(b)+k[0]*Math.cos(b);f[1]=k[1];f[2]=k[2]*Math.cos(b)-k[0]*Math.sin(b);
d[0]=f[0]+a[0];d[1]=f[1]+a[1];d[2]=f[2]+a[2];return d};h.rotateZ=function(d,c,a,b){var k=[],f=[];k[0]=c[0]-a[0];k[1]=c[1]-a[1];k[2]=c[2]-a[2];f[0]=k[0]*Math.cos(b)-k[1]*Math.sin(b);f[1]=k[0]*Math.sin(b)+k[1]*Math.cos(b);f[2]=k[2];d[0]=f[0]+a[0];d[1]=f[1]+a[1];d[2]=f[2]+a[2];return d};h.forEach=function(){var d=h.create();return function(c,a,b,k,f,g){a||(a=3);b||(b=0);for(k=k?Math.min(k*a+b,c.length):c.length;b<k;b+=a)d[0]=c[b],d[1]=c[b+1],d[2]=c[b+2],f(d,d,g),c[b]=d[0],c[b+1]=d[1],c[b+2]=d[2];return c}}();
h.angle=function(d,c){d=h.fromValues(d[0],d[1],d[2]);c=h.fromValues(c[0],c[1],c[2]);h.normalize(d,d);h.normalize(c,c);c=h.dot(d,c);return 1<c?0:Math.acos(c)};h.str=function(d){return"vec3("+d[0]+", "+d[1]+", "+d[2]+")"};h.exactEquals=function(d,c){return d[0]===c[0]&&d[1]===c[1]&&d[2]===c[2]};h.equals=function(d,c){var a=d[0],b=d[1];d=d[2];var k=c[0],f=c[1];c=c[2];return Math.abs(a-k)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(b-f)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(f))&&Math.abs(d-
c)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(c))};return h})},"esri/views/3d/terrain/OverlayManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/on ../../../core/Logger ../../../core/Accessor ../../../core/accessorSupport/decorators ../lib/glMatrix ../support/mathUtils ../support/earthUtils ../support/projectionUtils ../support/aaBoundingRect ../webgl-engine/Stage ../webgl-engine/lib/Texture".split(" "),function(m,h,
d,c,a,b,k,f,g,e,l,p,v,q,n){var t=g.vec2d,u=g.vec3d,x=g.vec4d,r={width:0,height:0,pixelRatio:0,views:null},z=[{viewport:x.create(),extent:x.create()}],B=[z[0],{viewport:x.create(),extent:x.create()}],C=x.create(),A=u.create(),D=[x.create(),x.create()],E=[[0,-1,2,1],[0,-2,2,0],[-1,-2,1,0],[-2,-2,0,0],[-2,-1,0,1],[-2,0,0,2],[-1,0,1,2],[0,0,2,2]],H=b.getLogger("esri.views.3d.OverlayManager");m=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._overlaySR=null;a._renderSR=null;a._overlaySREqualsRenderSR=
!0;a._connectedLayers={};a._scale=0;a._dirty=!1;a._isSpherical=!1;a.opacity=0;return a}d(c,b);Object.defineProperty(c.prototype,"hasHighlights",{get:function(){return this._renderer.hasHighlights},enumerable:!0,configurable:!0});c.prototype.initialize=function(){var a=this;this._stage=this.view._stage;this._renderer=this._stage.getTextureGraphicsRenderer();this._renderer.onHasHighlightsChanged=function(){return a.onHasHighlightsChanged()};this._initialEmptyTexture=new n(new Uint8Array([0,0,0,0]),
"overlayEmpty",{width:1,height:1,wrapClamp:!0});this._stage.add(q.ModelContentType.TEXTURE,this._initialEmptyTexture)};c.prototype.destroy=function(){for(var a in this._connectedLayers)this.unregisterLayerView(this._connectedLayers[a].layerView);this._disposeOverlays();this._stage.remove(q.ModelContentType.TEXTURE,this._initialEmptyTexture.getId())};c.prototype.onHasHighlightsChanged=function(){this.setOverlayDirty();this.notifyChange("hasHighlights")};c.prototype.hasOverlays=function(){return!!this._overlays};
c.prototype.setSpatialReference=function(a,b){(this._overlaySR=a)?(this._renderSR=this.view.renderSpatialReference,this._overlaySREqualsRenderSR=this._overlaySR.equals(this._renderSR),this._longitudeCyclical=(this._isSpherical=b)?a.isWebMercator?new e.Cyclical(-2.0037508342788905E7,2.0037508342788905E7):new e.Cyclical(-180,180):null):(this._disposeOverlays(),this._longitudeCyclical=null)};c.prototype.registerLayerView=function(b){var c=this,d=b.layer.uid;if(this._connectedLayers[d])H.warn("[OverlayManager#registerLayerView]: Layer "+
d+" is already connected");else{var e=a(b,"draped-data-change",function(){return c.setOverlayDirty()});this._connectedLayers[d]={eventHandles:[e],layerView:b};if(b.setDrapingExtent&&this._overlays)for(d=0;d<this._overlays.length;d++)b.setDrapingExtent(d,this._overlays[d].extent,this._overlaySR,2048);this.setOverlayDirty()}};c.prototype.unregisterLayerView=function(a){for(var b in this._connectedLayers){var c=this._connectedLayers[b];if(c.layerView===a){if(c.eventHandles)for(var d=0;d<c.eventHandles.length;d++)c.eventHandles[d].remove();
delete this._connectedLayers[b];this.setOverlayDirty();a.destroyed||(a._overlayUpdating=!1,a._evaluateUpdatingState())}}};c.prototype.onElevationChange=function(a){var b=a.extent;this.view.renderCoordsHelper.fromRenderCoords(this.view.navigation.currentCamera.center,A,a.spatialReference);b[0]<=A[0]&&b[1]<=A[1]&&b[2]>A[0]&&b[3]>A[1]&&this.setOverlayDirty()};c.prototype.setOverlayDirty=function(){this._dirty||(this._setOverlayUpdating(!0),this._dirty=!0)};c.prototype._setOverlayUpdating=function(a){for(var b in this._connectedLayers){var c=
this._connectedLayers[b].layerView;if(!a||!c.suspended&&c.hasDraped)c._overlayUpdating=a,c._evaluateUpdatingState()}if(b=this.view._graphicsView)b._overlayUpdating=a,b._evaluateUpdatingState()};c.prototype.updateOverlay=function(){if(this._overlaySR){var a=this._computeOverlayExtents();if(a){this._overlays||this._initOverlays();for(var b=0;b<this._overlays.length;b++){var c;a:{c=a[b];for(var d=this._overlays[b].extent,e=1E-5*Math.max(c[2]-c[0],c[3]-c[1],d[2]-d[0],d[3]-d[1]),f=0;4>f;f++)if(Math.abs(d[f]-
c[f])>e){c=!0;break a}c=!1}if(c){x.set(a[b],this._overlays[b].extent);for(var g in this._connectedLayers)c=this._connectedLayers[g].layerView,c.setDrapingExtent&&c.setDrapingExtent(b,a[b],this._overlaySR,2048)}}this._setOverlayUpdating(!1);this._drawOverlays();this.terrainSurface._updateTileOverlayParams();this._dirty=!1}}};c.prototype.overlaysNeedUpdate=function(){return this._dirty&&this._overlaySR};c.prototype.updateOpacity=function(a){var b=1;if(this._overlays){var c=this._scale;a=this.view.renderCoordsHelper.getAltitude(a);
3.5*a<c&&(b=Math.sqrt(e.clamp((a-c/10)/(c/3.5-c/10),0,1)))}return b};c.prototype.setOverlayParamsOfTile=function(a,b,c){a=a.extent;var d=-1;this._rectInsideRect(a,this._overlays[0].extent)?d=0:this._rectanglesOverlap(a,this._overlays[1].extent)&&(d=1);if(0<=d){var e=this._overlays[d].extent;b.overlayTexScale[0]=(a[2]-a[0])/(e[2]-e[0]);b.overlayTexScale[1]=(a[3]-a[1])/(e[3]-e[1]);var f=a[0];if(this._longitudeCyclical){var f=this._longitudeCyclical.minimalMonotonic(e[0],f),g=this._longitudeCyclical.minimalMonotonic(e[0],
a[2]);f>g&&(f=g-(a[2]-a[0]))}t.set2((f-e[0])/(e[2]-e[0]),(a[1]-e[1])/(e[3]-e[1]),b.overlayTexOffset);b.overlayTexId=this._overlays[d].valid?this._overlays[d].texture.getId():this._initialEmptyTexture.getId();b.highlightOverlayTexId=this._overlays[d].highlightValid?this._overlays[d].highlightTexture.getId():this._initialEmptyTexture.getId();b.overlayOpacity=void 0!==c?c:1}else b.overlayTexId=null,b.highlightOverlayTexId=null};c.prototype.overlayPixelSizeInMapUnits=function(a){var b;this._overlays&&
(this._overlays[0]&&this._pointIsInExtent(a,this._overlays[0].extent)?b=this._overlays[0].extent:this._overlays[1]&&(b=this._overlays[1].extent));return b?(b[2]-b[0])/2048:0};c.prototype._createEmptyOverlay=function(){var a=new n(null,"overlay",{wrapClamp:!0,mipmap:!0});this._stage.add(q.ModelContentType.TEXTURE,a);var b=new n(null,"highlightOverlay",{wrapClamp:!0,mipmap:!0});this._stage.add(q.ModelContentType.TEXTURE,b);return{extent:x.create(),texture:a,valid:!1,highlightTexture:b,highlightValid:!1}};
c.prototype._initOverlays=function(){this._overlays=[this._createEmptyOverlay(),this._createEmptyOverlay()]};c.prototype._disposeOverlays=function(){if(this._overlays){var a=this._stage;this._overlays.forEach(function(b){a.remove(q.ModelContentType.TEXTURE,b.texture.getId());a.remove(q.ModelContentType.TEXTURE,b.highlightTexture.getId())});this._overlays=null}};c.prototype._computeOverlayExtents=function(){var a=this.view.navigation.currentCamera,b=this.terrainSurface.extent,c=u.create();u.set(a.center,
c);this._scale=this.view.renderCoordsHelper.getAltitude(a.eye);var d=p.vectorToPoint(c,this._renderSR,this.terrainSurface.spatialReference);(d=this.terrainSurface.getElevation(d))?this.view.renderCoordsHelper.setAltitude(d,c):this.view.navigation.getCenterIntersectManifold(a.eye,a.center,c);var f=u.dist(a.eye,c),d=a.angleOfElevation;if(!isNaN(d)){this._overlaySREqualsRenderSR||p.vectorToVector(c,this._renderSR,c,this._overlaySR);var f=1024*a.perPixelRatio*f*2,g=!1,k=Infinity;this._isSpherical&&(this._overlaySR.isWebMercator?
(f/=Math.cos(p.webMercator.y2lat(c[1])),k=this.terrainSurface.extent[3],k*=.999):(g=!0,f/=l.metersPerDegree,k=90),f>=k&&(f=k,c[1]=0,this._overlaySR.isWebMercator&&(c[0]=0)));var h=1;g&&(h=1/Math.max(.2,Math.cos(Math.abs(e.deg2rad(c[1])))),180<f*h&&(h=180/f));var n=f*h,q=D[0];q[0]=c[0]-n;q[1]=c[1]-f;q[2]=c[0]+n;q[3]=c[1]+f;this._isSpherical&&this._shiftExtentToFitBounds(q,Infinity,k);g=D[1];x.set(q,g);6*n>b[2]-b[0]?x.set(b,g):d>.25*Math.PI?(g[0]-=n,g[1]-=f,g[2]+=n,g[3]+=f):(p.vectorToVector(a.eye,
this._renderSR,A,this._overlaySR),t.subtract(c,A,C),a=-Math.atan2(C[1],C[0])+.125*Math.PI,0>a&&(a+=2*Math.PI),x.scale(E[Math.floor(a/(.25*Math.PI))],2*f,C),C[0]*=h,C[2]*=h,x.add(g,C,g));this._isSpherical&&(g[0]=this._longitudeCyclical.clamp(g[0]),g[2]=this._longitudeCyclical.clamp(g[2]),g[1]=Math.max(g[1],-k),g[3]=Math.min(g[3],k));this.opacity=1;return D}};c.prototype._drawOverlays=function(){for(var a=this._overlays[0].extent[2]-this._overlays[0].extent[0],b=this._renderer,c=0;c<this._overlays.length;c++){var d=
this._overlays[c].extent,e=this._longitudeCyclical?d[2]>this._longitudeCyclical.max:!1,f=this._longitudeCyclical?d[0]<this._longitudeCyclical.min:!1;if(e||f){r.views=B;var f=void 0,f=e?this._longitudeCyclical.max-d[0]:this._longitudeCyclical.min-d[0],f=Math.round(f/(d[2]-d[0])*2048),g=r.views[0];x.set4(0,0,f,2048,g.viewport);x.set4(d[0],d[1],this._longitudeCyclical.max,d[3],g.extent);e||(g.extent[0]+=this._longitudeCyclical.range);g=r.views[1];x.set4(f,0,2048-f,2048,g.viewport);x.set4(this._longitudeCyclical.min,
d[1],d[2],d[3],g.extent);e&&(g.extent[2]-=this._longitudeCyclical.range)}else r.views=z,x.set(d,r.views[0].extent),x.set4(0,0,2048,2048,r.views[0].viewport);r.width=2048;r.height=2048;r.pixelRatio=a/(d[2]-d[0]);this._overlays[c].valid=b.draw(this._overlays[c].texture,r);this._overlays[c].highlightValid=b.drawHighlights(this._overlays[c].highlightTexture,r)}};c.prototype._rectanglesOverlap=function(a,b){return this._longitudeCyclical?(this._longitudeCyclical.contains(b[0],b[2],a[0])||this._longitudeCyclical.contains(b[0],
b[2],a[2]))&&!(a[1]>b[3]||a[3]<b[1]):!(a[0]>b[2]||a[2]<b[0]||a[1]>b[3]||a[3]<b[1])};c.prototype._rectInsideRect=function(a,b){return this._longitudeCyclical?this._longitudeCyclical.contains(b[0],b[2],a[0])&&this._longitudeCyclical.contains(b[0],b[2],a[2])&&a[1]>b[1]&&a[3]<b[3]:a[0]>b[0]&&a[2]<b[2]&&a[1]>b[1]&&a[3]<b[3]};c.prototype._pointIsInExtent=function(a,b){if(this._longitudeCyclical)return this._longitudeCyclical.contains(b[0],b[2],a.x)&&a.y>=b[1]&&a.y<=b[3];var c=a.x;a=a.y;return c>b[0]&&c<
b[2]&&a>b[1]&&a<b[3]};c.prototype._shiftExtentToFitBounds=function(a,b,c){var d=0,e=0;a[0]<-b?d=a[0]+b:a[2]>b&&(d=b-a[2]);a[1]<-c?e=a[1]+c:a[3]>c&&(e=c-a[3]);v.offset(a,d,e)};return c}(f.declared(k));c([f.property()],m.prototype,"view",void 0);c([f.property()],m.prototype,"terrainSurface",void 0);c([f.property({type:Boolean})],m.prototype,"hasHighlights",null);return m=c([f.subclass("esri.views.3d.terrain.OverlayManager")],m)})},"esri/views/3d/terrain/SurfaceExtentHelper":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/_base/lang ../../../core/Accessor ../../../core/arrayUtils ../../../core/HandleRegistry ../../../geometry/support/webMercatorUtils ../../../views/3d/support/aaBoundingRect ./terrainUtils ./TerrainConst".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){function q(a,b){a&&!a.spatialReference.equals(b)&&(a=e.canProject(a.spatialReference,b)?e.project(a,b):null);return a}Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function c(){var b=a.call(this)||this;b._changeListeners=new g;return b}d(c,a);c.prototype.initialize=function(){var a=this;this._changeListeners.add([this._layerViews.on("change",function(){return a.notifyChange("stencilEnabledExtents")})])};c.prototype.destroy=function(){this._changeListeners.destroy();
this._changeListeners=null};Object.defineProperty(c.prototype,"layerViewsExtent",{get:function(){return this._computeLayerViewsExtent()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tiledLayersExtent",{get:function(){return this._computeTiledLayersExtent()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stencilEnabledExtents",{get:function(){return this._computeStencilEnabledExtents(this._layerViews,this.spatialReference)},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"spatialReference",{set:function(a){this.tilingScheme||this._set("spatialReference",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tilingScheme",{set:function(a){this._set("tilingScheme",a);this._set("spatialReference",a.spatialReference)},enumerable:!0,configurable:!0});c.prototype.normalizeCtorArgs=function(a){a=b.mixin({},a);this._layers=a.layers;delete a.layers;this._layerViews=a.layerViews;delete a.layerViews;return a};c.prototype._computeStencilEnabledExtents=
function(a,b){var c=[],d=0;for(a=a.items;d<a.length;d++){var e=a[d].layer;"IntegratedMeshLayer"===e.operationalLayerType&&null!=b&&(e=q(e.fullExtent,b),null!=e&&c.push([e.xmin,e.ymin,e.xmax,e.ymax]))}return c};return c}(a.declared(k));c([a.property({readOnly:!0})],m.prototype,"layerViewsExtent",null);c([a.property({readOnly:!0,dependsOn:["spatialReference","tilingScheme"]})],m.prototype,"tiledLayersExtent",null);c([a.property({readOnly:!0,dependsOn:["spatialReference"]})],m.prototype,"stencilEnabledExtents",
null);c([a.property()],m.prototype,"spatialReference",null);c([a.property()],m.prototype,"tilingScheme",null);c([a.property()],m.prototype,"defaultTiledLayersExtent",void 0);m=c([a.subclass()],m);k=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.prototype._computeLayerViewsExtent=function(){return this._getGlobalExtent()};b.prototype._computeTiledLayersExtent=function(){return this._getGlobalExtent()};b.prototype._getGlobalExtent=function(){return this.spatialReference.isWebMercator?
v.WEBMERCATOR_WORLD_EXTENT:v.GEOGRAPHIC_WORLD_EXTENT};return b}(a.declared(m));c([a.property({dependsOn:["spatialReference"]})],k.prototype,"layerViewsExtent",void 0);k=c([a.subclass()],k);h.SurfaceExtentHelperGlobal=k;m=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}d(b,a);b.prototype.initialize=function(){var a=this;this._changeListeners.add([this._layers.on("change",function(){return a.notifyChange("tiledLayersExtent")}),this._layerViews.on("change",function(){return a.notifyChange("layerViewsExtent")})])};
b.prototype._computeLayerViewsExtent=function(){var a=l.create(l.NEGATIVE_INFINITY),b=this.spatialReference;this._layerViews.forEach(function(c){c.isResolved()&&(c=c.fullExtentInViewSpatialReference||c.layer.fullExtent,(c=q(c,b))&&l.expand(a,c))});var c=l.allFinite(a)?a:null,d=this._get("layerViewsExtent");return f.equals(c,d)?d:c};b.prototype._computeTiledLayersExtent=function(){var a=this.tilingScheme;if(!a)return null;var b=this.spatialReference,c=l.create(l.NEGATIVE_INFINITY);this._layers.forEach(function(d){p.isTiledLayer(d)&&
a.compatibleWith(p.getTileInfo(d))&&d.fullExtent&&d.fullExtent.spatialReference.equals(b)&&l.expand(c,d.fullExtent)});this.defaultTiledLayersExtent&&l.expand(c,this.defaultTiledLayersExtent);var d=l.allFinite(c)?c:null,e=this._get("tiledLayersExtent");return f.equals(d,e)?e:d};return b}(a.declared(m));m=c([a.subclass()],m);h.SurfaceExtentHelperLocal=m})},"esri/views/3d/terrain/terrainUtils":function(){define("require exports ./terrainUtilsPlanar ./terrainUtilsSpherical ../../../layers/TiledLayer ../../../layers/TileLayer ../../../layers/BaseTileLayer ../../../layers/BaseElevationLayer ../../../layers/ElevationLayer ../../../layers/VectorTileLayer ../../../support/basemapDefinitions".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){function p(a){return a&&a.isInstanceOf(e)}function v(a){return a&&"esri.views.3d.layers.TiledLayerView3D"===a.declaredClass}function q(a){return a&&"esri.views.3d.layers.VectorTileLayerView3D"===a.declaredClass}function n(a){return a&&"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function t(){x={};for(var a in l)l[a].baseMapLayers.forEach(function(a){x[a.url]=19});x["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}Object.defineProperty(h,
"__esModule",{value:!0});var u={planar:d,spherical:c};h.weakAssert=function(a,b){a||console.warn("Terrain: "+b)};h.autoUpdateSkirtsVisibility=function(a,b){u[a.manifold].autoUpdateSkirtsVisibility(a,b)};h.isTiledLayer=function(b){return b&&(b.isInstanceOf(a)||b.isInstanceOf(k)||b.isInstanceOf(f))};h.isVectorTileLayer=p;h.isTiledMapLayerView=v;h.isVectorTileLayerView=q;h.isElevationLayerView=n;h.isTiledLayerView=function(a){return a&&(v(a)||n(a)||q(a))};h.useFetchTileForLayer=function(a){return a.fetchTile&&
!(a.fetchTile===b.prototype.fetchTile||a.fetchTile===g.prototype.fetchTile)};var x=null;h.getKnownTiledServiceLevelCap=function(a){x||t();a=a&&a.replace(/https?:/,"");return a in x?x[a]:Infinity};h.prepareKnownTiledServiceLevelCaps=t;h.checkIfTileInfoSupportedForView=function(a,b,c,d){return u["local"===d||"planar"===d?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(a,b,c)};h.getTileInfo=function(a){return p(a)?a.tileInfo256:a.tileInfo}})},"esri/views/3d/terrain/terrainUtilsPlanar":function(){define("require exports ./TilingScheme ./TerrainConst ../../../core/Error ../support/aaBoundingRect ../lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k){function f(a,b,c,d){e.set(c,l);l[d]=b[d];d=e.subtract(l,b);var f=e.subtract(a,b,p),f=e.dot(f,d),g=e.dot(d,d);b=0>=f?b:g<=f?c:e.add(b,e.scale(d,f/g),l);a=e.subtract(a,b,l);return Math.PI/2-Math.atan(a[2]/Math.sqrt(a[0]*a[0]+a[1]*a[1]))}function g(a,b){var c=a.getElevationBounds();a=a.extent;c=.5*(c[0]+c[1]);v[0]=a[0];v[1]=a[1];v[2]=c;q[0]=a[2];q[1]=a[3];q[2]=c;a=c=Infinity;b[0]<v[0]?c=f(b,v,q,0):b[0]>q[0]&&(c=f(b,q,v,0));b[1]<v[1]?a=f(b,v,q,1):b[1]>q[1]&&(a=f(b,q,v,1));return Math.min(c,
a)}Object.defineProperty(h,"__esModule",{value:!0});var e=k.vec3d,l=e.create(),p=e.create(),v=e.create(),q=e.create();h.autoUpdateSkirtsVisibility=function(a,c){var d,e=!0,f=a.extent,k=b.containsPoint(f,c);k?d=a.getElevation(c):(d=a.getElevationBounds(),d=.5*(d[0]+d[1]));d>c[2]?e=!1:k||(b.containsPointWithMargin(f,c,a.hideSkirtsDistanceFromExtentMargin*Math.min(f[2]-f[0],f[3]-f[1]))?g(a,c)>a.hideSkirtsMinimumCameraTilt&&(e=!1):e=!1);e!==a.skirts&&(a.skirts=e)};h.tiltOnEdge=f;h.tiltToExtentEdge=g;
h.checkIfTileInfoSupportedForViewSR=function(e,f,g){if(e.spatialReference.isGeographic)return new a("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var k=d.checkUnsupported(e);if(k)return k;var l=e.lods,k=l[0].resolution*Math.pow(2,l[0].level),h=[k*e.size[0],k*e.size[1]],p=[e.origin.x,e.origin.y];f=b.fromExtent(f);var n=b.create();d.computeRowColExtent(f,h,p,n);h=(n[2]-n[0])*(n[3]-n[1]);h>c.MAX_ROOT_TILES?(l=l[0].scale*Math.pow(2,l[0].level),
k=Math.max((f[3]-f[1])/e.size[1],(f[2]-f[0])/e.size[0])*l/k,f=Math.floor(Math.log(k)/Math.log(10)),k=Math.ceil(k/Math.pow(10,f))*Math.pow(10,f),k=new a("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(l).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+k.toLocaleString()+".",{level0Scale:l,suggestedLevel0Scale:k,requiredNumRootTiles:h,allowedNumRootTiles:c.MAX_ROOT_TILES})):k=null;return k?k:g&&!e.spatialReference.equals(g)?new a("tilingscheme:spatial-reference-mismatch",
"The tiling scheme does not match the spatial reference of the local scene"):null}})},"esri/views/3d/terrain/terrainUtilsSpherical":function(){define(["require","exports","./TilingScheme","../../../core/Error"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});h.autoUpdateSkirtsVisibility=function(a,b){};h.checkIfTileInfoSupportedForViewSR=function(a,b,k){b=a.lods.length-1;if(a.spatialReference.isWebMercator){if(!d.makeWebMercatorAuxiliarySphere(b).compatibleWith(a))return new c("tilingscheme:incompatible-global-web-mercator",
"The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else if(a.spatialReference.isWGS84){if(!d.makeWGS84WithTileSize(a.size[1],b).compatibleWith(a))return new c("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme")}else return new c("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(k&&!a.spatialReference.equals(k))return new c("tilingscheme:spatial-reference-mismatch",
"The tiling scheme does not match the spatial reference of the global scene")}})},"esri/layers/BaseTileLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../request ../core/Error ../geometry/Extent ../geometry/SpatialReference ./Layer ./support/TileInfo ../core/accessorSupport/decorators".split(" "),function(m,h,d,c,a,b,k,f,g,e,l){var p={id:"0/0/0",level:0,row:0,col:0,extent:null};m=function(c){function g(){var a=null!==c&&c.apply(this,
arguments)||this;a.tileInfo=e.create({spatialReference:f.WebMercator,size:256});a.type="base-tile";a.fullExtent=new k(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,f.WebMercator);a.spatialReference=f.WebMercator;return a}d(g,c);g.prototype.getTileBounds=function(a,b,c,d){d=d||[0,0,0,0];p.level=a;p.row=b;p.col=c;p.extent=d;this.tileInfo.updateTileInfo(p);p.extent=null;return d};g.prototype.getTileUrl=function(a,c,d){throw new b("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented");
};g.prototype.fetchTile=function(b,c,d,e){b=this.getTileUrl(b,c,d);return"string"===typeof b?a(b,{responseType:"image",allowImageDataAccess:e&&e.allowImageDataAccess||!1}).then(function(a){return a.data}):b.then(function(b){return a(b,{responseType:"image"})}).then(function(a){return a.data})};return g}(l.declared(g));c([l.shared({"2d":"../views/2d/layers/TiledLayerView2D","3d":"../views/3d/layers/TiledLayerView3D"})],m.prototype,"viewModulePaths",void 0);c([l.property({type:e})],m.prototype,"tileInfo",
void 0);c([l.property({readOnly:!0,value:"base-tile"})],m.prototype,"type",void 0);c([l.property()],m.prototype,"fullExtent",void 0);c([l.property()],m.prototype,"spatialReference",void 0);return m=c([l.subclass("esri.layers.BaseTileLayer")],m)})},"esri/layers/BaseElevationLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../geometry/Extent ../geometry/SpatialReference ./Layer ./support/TileInfo ../core/accessorSupport/decorators".split(" "),
function(m,h,d,c,a,b,k,f,g,e){var l={id:"0/0/0",level:0,row:0,col:0,extent:null};m=function(c){function e(){var a=null!==c&&c.apply(this,arguments)||this;a.tileInfo=g.create({spatialReference:k.WebMercator,size:256});a.fullExtent=new b(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,k.WebMercator);a.spatialReference=k.WebMercator;a.type="base-elevation";return a}d(e,c);e.prototype.getTileBounds=function(a,b,c,d){d=d||[0,0,0,0];l.level=a;l.row=b;l.col=c;l.extent=d;this.tileInfo.updateTileInfo(l);
l.extent=null;return d};e.prototype.fetchTile=function(b,c,d,e){throw new a("BaseElevationLayer:fetchtile-not-implemented","fetchTile() is not implemented");};return e}(e.declared(f));c([e.shared({"3d":"../views/3d/layers/ElevationLayerView3D"})],m.prototype,"viewModulePaths",void 0);c([e.property({type:g})],m.prototype,"tileInfo",void 0);c([e.property()],m.prototype,"fullExtent",void 0);c([e.property()],m.prototype,"spatialReference",void 0);c([e.property({readOnly:!0,value:"base-elevation"})],m.prototype,
"type",void 0);return m=c([e.subclass("esri.layers.BaseElevationLayer")],m)})},"esri/layers/VectorTileLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/accessorSupport/decorators ../core/Error ../core/MultiOriginJSONSupport ../core/urlUtils ../core/promiseUtils ../core/lang ../request ../geometry/Extent ../geometry/SpatialReference ../portal/support/jsonContext ./TiledLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/ArcGISCachedService ./support/TileInfo ./support/vectorTileLayerLoader ../views/vectorTiles/style/StyleRepository ../views/vectorTiles/SchemaHelper".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D){m=function(b){function c(a,c){a=b.call(this)||this;a.currentStyleInfo=null;a.fullExtent=null;a.operationalLayerType="VectorTileLayer";a.tileInfo=null;a.type="vector-tile";a.url=null;return a}d(c,b);c.prototype.normalizeCtorArgs=function(b,c){return"string"===typeof b?a.mixin({},{url:b},c):b};c.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1}).then(function(){if(a.portalItem&&
a.portalItem.id){var b=a.portalItem.itemUrl+"/resources/styles/root.json";return p(b,{query:{f:"json"}}).then(function(c){c.data&&a.read({url:b},n.createForItem(a.portalItem))})}}).always(function(){return a.loadStyle()});this.addResolvingPromise(b);return this};Object.defineProperty(c.prototype,"attributionDataUrl",{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&g.urlToObject(a.serviceUrl))?this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0});c.prototype.writeStyleUrl=function(a,b){a&&g.isProtocolRelative(a)&&
(a="https:"+a);a&&!l.endsWith(a,"root.json")&&(a=g.join(a,"root.json"));b.styleUrl=a};c.prototype.readTileIndexType=function(a,b){return b.type};c.prototype.readTileIndexUrl=function(a,b){return g.join(this.serviceUrl,b.tileMap)};c.prototype.readTileServers=function(a,b){var c=this;a=b.tiles;this.serviceUrl&&a.forEach(function(a,b,d){d[b]=g.join(c.serviceUrl,a)});return a};c.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};c.prototype.readTileInfo256=
function(a,b){return B.fromJSON(D.create256x256CompatibleTileInfo(this.tileInfo.toJSON()))};c.prototype.readCompatibleTileInfo512=function(a,b){return B.fromJSON(D.create512x512CompatibleTileInfo(this.tileInfo.toJSON()))};c.prototype.loadStyle=function(a){a=a||this.url;if(this._loadingPromise&&"string"===typeof a&&this.url===a)return this._loadingPromise;var b=this._loadingPromise;this._loadingPromise=this._getSourceAndStyle(a);b&&!b.isFulfilled()&&b.cancel();return this._loadingPromise};c.prototype.getTileUrl=
function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{x\}/gi,c.toString())};c.prototype.write=function(a,b){return b&&b.origin&&!this.styleUrl?(b.messages&&b.messages.push(new k("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,[a,b])};c.prototype._getSourceAndStyle=function(a){var b=
this;return a?C.loadMetadata(a).then(function(a){b._set("currentStyleInfo",{serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,spriteUrl:a.spriteUrl,glyphsUrl:a.glyphsUrl,style:a.style,layerDefinition:a.layerDefinition});b._set("styleRepository",new A(a.style,a));b.read(a.layerDefinition)}):e.reject(Error("invalid style!"))};c.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);
if(b&&(a=b[3]&&b[3].toLowerCase()))for(var b=b[2]||"",c=0,d=["World_Basemap","World_Basemap_WGS84"];c<d.length;c++){var e=d[c];if(-1<e.toLowerCase().indexOf(a))return g.normalize("//static.arcgis.com/attribution/Vector"+b+"/"+e)}};return c}(b.declared(t,u,x,r,f,z));c([b.shared({"2d":"../views/2d/layers/VectorTileLayerView2D","3d":"../views/3d/layers/VectorTileLayerView3D"})],m.prototype,"viewModulePaths",void 0);c([b.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],m.prototype,"attributionDataUrl",
null);c([b.property({readOnly:!0})],m.prototype,"currentStyleInfo",void 0);c([b.property({type:v,readOnly:!0})],m.prototype,"fullExtent",void 0);c([b.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],m.prototype,"serviceUrl",null);c([b.property({type:q,dependsOn:["tileInfo"],readOnly:!0})],m.prototype,"spatialReference",null);c([b.property({readOnly:!0})],m.prototype,"styleRepository",void 0);c([b.property({readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0}}})],m.prototype,
"styleUrl",null);c([b.writer("styleUrl")],m.prototype,"writeStyleUrl",null);c([b.property({readOnly:!0})],m.prototype,"tileIndexType",void 0);c([b.reader("tileIndexType",["tileIndexType","type"])],m.prototype,"readTileIndexType",null);c([b.property({readOnly:!0})],m.prototype,"tileIndexUrl",void 0);c([b.reader("tileIndexUrl",["tileIndexUrl","tileMap"])],m.prototype,"readTileIndexUrl",null);c([b.property({readOnly:!0,type:B})],m.prototype,"tileInfo",void 0);c([b.property({readOnly:!0})],m.prototype,
"tileServers",void 0);c([b.reader("tileServers",["tiles"])],m.prototype,"readTileServers",null);c([b.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],m.prototype,"type",void 0);c([b.property({json:{origins:{webDocument:{read:{source:"styleUrl"}},portalItem:{read:{source:"url"}}},write:!1,read:!1}})],m.prototype,"url",void 0);c([b.property({readOnly:!0})],m.prototype,"version",void 0);c([b.reader("version",["version","currentVersion"])],m.prototype,"readVersion",null);c([b.property({readOnly:!0})],
m.prototype,"tileInfo256",void 0);c([b.reader("tileInfo256",["tileInfo"])],m.prototype,"readTileInfo256",null);c([b.property({readOnly:!0})],m.prototype,"compatibleTileInfo512",void 0);c([b.reader("compatibleTileInfo512",["tileInfo"])],m.prototype,"readCompatibleTileInfo512",null);return m=c([b.subclass("esri.layers.VectorTileLayer")],m)})},"esri/portal/support/jsonContext":function(){define(["require","exports","../Portal","../../core/urlUtils"],function(m,h,d,c){Object.defineProperty(h,"__esModule",
{value:!0});h.createForItem=function(a){return{origin:"portal-item",url:c.urlToObject(a.itemUrl),portal:a.portal||d.getDefault()}}})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../config ../../request".split(" "),function(m,h,d,c,a,b,k,f){function g(a){if(a){var c=b.getOrigin(a);b.canUseXhr(c)||-1!==n.indexOf(c)||n.push(c);return a}}function e(a,c,d){if(null!=c.sources){d&&-1!==d.path.indexOf("root.json")&&
(d.path=d.path.substr(0,d.path.indexOf("root.json")),a.styleUrl=d.path);var e=v(c,d),f=c.sprite,g=c.glyphs;e&&e.url&&(e=d&&d.path?d.path:e.url,c.sprite&&!b.isAbsolute(c.sprite)&&(f=b.join(e,c.sprite)),c.glyphs&&!b.isAbsolute(c.glyphs)&&(g=b.join(e,c.glyphs)));a.style=c;a.spriteUrl=f;a.glyphsUrl=g;return p(a,c,d)}if(c.hasOwnProperty("tileInfo"))return a.layerDefinition=c,a.serviceUrl=d.path,l(a,c,d)}function l(a,c,d){c=c.defaultStyles;b.isAbsolute(c)?a.styleUrl=b.normalize(c):a.styleUrl=b.normalize(b.join(d.path,
c));g(a.styleUrl);return f(b.join(a.styleUrl,"root.json"),{responseType:"json"}).then(function(c){var d=c.data.sprite,e=c.data.glyphs;d&&!b.isAbsolute(d)&&(d=b.join(a.styleUrl,d));e&&!b.isAbsolute(e)&&(e=b.join(a.styleUrl,e));a.spriteUrl=d;a.glyphsUrl=e;return a.style=c.data})}function p(c,d,e){(d=v(d,e))||a.reject("Source isn't available in the syle object!");if(d.url)return c.serviceUrl=d.url,b.isAbsolute(c.serviceUrl)||(c.serviceUrl=b.join(e.path,c.serviceUrl)),g(c.serviceUrl),f(c.serviceUrl,{query:{f:"json"},
responseType:"json"}).then(function(a){c.layerDefinition=q(a.data);return c});c.layerDefinition=q(d);return a.resolve(c)}function v(a,c){if(!a.sources)return null;var d=a.sources;a=null;if(d.esri)a=d.esri,c&&a.url&&!b.isAbsolute(a.url)&&(d=c.path.substring(0,c.path.lastIndexOf("/")),a.url=b.join(d,a.url));else{for(var e=0,f=Object.keys(d);e<f.length;e++)if(c=f[e],-1!==c.toLocaleLowerCase().indexOf("street")&&"vector"===a.type){a=d[c];break}if(!a)for(e=0,f=Object.keys(d);e<f.length&&(c=f[e],a=d[c],
"vector"!==a.type);e++);}return a}function q(a){if(a.hasOwnProperty("tileInfo"))return a;for(var b={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},c=(b.xmax-b.xmin)/512,d=[],e=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,f=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):16;e<f;e++){var k=c/Math.pow(2,e);d.push({level:e,scale:Math.floor(3779.527559055118*k),resolution:k})}a.tiles.forEach(g);return{capabilities:"TilesOnly",
initialExtent:b,fullExtent:b,minScale:d[0].scale,maxScale:d[d.length-1].scale,tiles:a.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:d,spatialReference:{wkid:102100}}}}Object.defineProperty(h,"__esModule",{value:!0});var n=k.defaults&&k.defaults.io.corsEnabledServers||k.request.corsEnabledServers;h.loadMetadata=function(d){if(!d)return a.reject("invalid input URL!");var k={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,
styleUrl:null,url:null,spriteUrl:null,glyphsUrl:null};if("string"!==typeof d)return e(k,d,null).then(function(){return k});d=k.url=b.normalize(d);var l=k.parsedUrl=b.urlToObject(d);g(d);return f(l.path,{responseType:"json",query:c.mixin({f:"json"},l.query)}).then(function(a){return e(k,a.data,l)}).then(function(){return k})}})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","./StyleLayer","dojo/has"],function(m,h,d,c){return function(){function a(b,d){this.styleJSON=
b;this.version=parseFloat(b.version);this.sprite=d?d.spriteUrl:b.sprite;this.glyphs=d?d.glyphsUrl:b.glyphs;if(c("stable-symbol-rendering")){var f=(b.layers||[]).filter(function(a){return a.layout&&a.layout["text-font"]})[0];f&&(b.layers||[]).forEach(function(a){a.layout&&a.layout["text-font"]&&(a.layout["text-font"]=f.layout["text-font"])})}this.layers=(b.layers||[]).map(a._create);this._identifyRefLayers()}a.prototype._identifyRefLayers=function(){for(var a=[],c=[],d=0,g=this.layers;d<g.length;d++){var e=
g[d];if(1===e.type){var l=e.sourceLayer,l=l+("|"+JSON.stringify(e.minzoom)),l=l+("|"+JSON.stringify(e.maxzoom)),l=l+("|"+JSON.stringify(e.filter));a.push({key:l,layer:e})}2===e.type&&(l=e.sourceLayer,l+="|"+JSON.stringify(e.minzoom),l+="|"+JSON.stringify(e.maxzoom),l+="|"+JSON.stringify(e.filter),l+="|"+JSON.stringify(e.layout["line-cap"]),l+="|"+JSON.stringify(e.layout["line-join"]),c.push({key:l,layer:e}))}this._assignRefLayers(a);this._assignRefLayers(c)};a.prototype._assignRefLayers=function(a){a.sort(function(a,
b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,c,d=a.length,e=0;e<d;e++){var l=a[e];if(l.key===b)l.layer.refLayerId=c;else if(b=l.key,c=l.layer.id,1===l.layer.type&&!l.layer.hasPaintProperty("fill-outline-color"))for(var h=e+1;h<d;h++){var m=a[h];if(m.key===b){if(m.layer.hasPaintProperty("fill-outline-color")){a[e]=m;a[h]=l;c=m.layer.id;break}}else break}}};a._create=function(a,c,f){c=1-1/(f.length+1)*(1+c);switch(a.type){case "background":return new d.StyleLayer(0,a,c);case "fill":return new d.StyleLayer(1,
a,c);case "line":return new d.StyleLayer(2,a,c);case "symbol":return new d.StyleLayer(3,a,c);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");};return a}()})},"esri/views/vectorTiles/style/StyleLayer":function(){define(["require","exports","./StyleDefinition","./StyleProperty","./Filter"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function b(a,
b,c){this.type=a;this.id=b.id;this.source=b.source;this.sourceLayer=b["source-layer"];this.minzoom=b.minzoom;this.maxzoom=b.maxzoom;this.filter=b.filter;this.layout=b.layout;this.paint=b.paint;this.z=c;switch(a){case 0:this._layoutDefinition=d.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=d.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=d.StyleDefinition.fillLayoutDefinition;this._paintDefinition=d.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=
d.StyleDefinition.lineLayoutDefinition;this._paintDefinition=d.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=d.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=d.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}b.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=a.createFilter(this.filter)};b.prototype.hasLayoutProperty=
function(a){var b=this._layoutProperties;return b&&b[a]?!0:!1};b.prototype.hasPaintProperty=function(a){var b=this._paintProperties;return b?void 0!==b[a]:!1};b.prototype.getLayoutValue=function(a,b){var c,d=this._layoutProperties;d&&(d=d[a])&&(c=d.getValue(b));a=this._layoutDefinition[a];void 0===c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};b.prototype.getPaintValue=function(a,b){var c,d=this._paintProperties;d&&(d=d[a])&&(c=d.getValue(b));a=this._paintDefinition[a];void 0===
c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};b.prototype._parseLayout=function(a){var b={},d;for(d in a)b[d]=new c(this._layoutDefinition[d],a[d]);return b};b.prototype._parsePaint=function(a){var b={},d;for(d in a)b[d]=new c(this._paintDefinition[d],a[d]);return b};return b}();h.StyleLayer=m;m=function(){return function(a,c){this.cap=a.getLayoutValue("line-cap",c);this.join=a.getLayoutValue("line-join",c);this.miterLimit=a.getLayoutValue("line-miter-limit",c);this.roundLimit=
a.getLayoutValue("line-round-limit",c)}}();h.LineLayout=m;m=function(){return function(a,c,d){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",c);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",c);this.optional=a.getLayoutValue("icon-optional",c);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",c);this.size=a.getLayoutValue("icon-size",c);this.rotate=a.getLayoutValue("icon-rotate",c);this.padding=a.getLayoutValue("icon-padding",c);this.keepUpright=a.getLayoutValue("icon-keep-upright",
c);this.offset=a.getLayoutValue("icon-offset",c);d&&1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment")&&(this.rotationAlignment=0)}}();h.IconLayout=m;m=function(){return function(a,c,d){this.allowOverlap=a.getLayoutValue("text-allow-overlap",c);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",c);this.optional=a.getLayoutValue("text-optional",c);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",c);this.font=a.getLayoutValue("text-font",c);this.maxWidth=
a.getLayoutValue("text-max-width",c);this.lineHeight=a.getLayoutValue("text-line-height",c);this.letterSpacing=a.getLayoutValue("text-letter-spacing",c);this.justify=a.getLayoutValue("text-justify",c);this.anchor=a.getLayoutValue("text-anchor",c);this.maxAngle=a.getLayoutValue("text-max-angle",c);this.size=a.getLayoutValue("text-size",c);this.rotate=a.getLayoutValue("text-rotate",c);this.padding=a.getLayoutValue("text-padding",c);this.keepUpright=a.getLayoutValue("text-keep-upright",c);this.transform=
a.getLayoutValue("text-transform",c);this.offset=a.getLayoutValue("text-offset",c);d&&1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment")&&(this.rotationAlignment=0)}}();h.TextLayout=m})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){return function(){}}();m.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};m.fillLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],"default":"visible"}};m.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}};m.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},
"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number",
"default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},
"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center","right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number","default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean",
"default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}};m.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}};
m.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}};m.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},
"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",value:"number","default":[]},"line-pattern":{type:"string"}};m.symbolPaintDefinition=
{"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color","default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color",
"default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};m.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",
minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}};m.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",
minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};h.StyleDefinition=m})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(m,h,d,c){return function(){function a(b,c){switch(b.type){case "number":b=!0;break;case "color":b=!0;c=a._parseColor(c);break;case "array":b="number"===b.value;break;default:b=
!1}this.getValue=b?this._interpolate(c):this._piecewise(c)}a.prototype._piecewise=function(a){var b=a.stops;return b?function(a){var c=b.length;if(0!==c){for(var d=0,f=0;f<c;f++)if(b[f][0]<=a)d=f;else break;return b[d][1]}}:function(){return a}};a.prototype._interpolate=function(a){var b=a.stops;if(b){var d=a.base||1;return function(a){for(var e,f,g=b.length,k=0;k<g;k++){var h=b[k];if(h[0]<=a)e=h;else{f=h;break}}if(e&&f){k=f[0]-e[0];a-=e[0];a=1===d?a/k:(Math.pow(d,a)-1)/(Math.pow(d,k)-1);if(Array.isArray(e[1])){e=
e[1];f=f[1];g=[];for(k=0;k<e.length;k++)g.push(c.interpolate(e[k],f[k],a));return g}return c.interpolate(e[1],f[1],a)}if(e)return e[1];if(f)return f[1]}}return function(){return a}};a._parseColor=function(b){if(Array.isArray(b))return b;if("string"===typeof b)return b=new d(b),[b.r/255,b.g/255,b.b/255,b.a||1];if(b&&b.stops)return b.stops=b.stops.map(function(b){return[b[0],a._parseColor(b[1])]}),b;throw Error("Incorrect color definition "+b);};return a}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require",
"exports"],function(m,h){function d(a,b){a%=b;return 0<=a?a:a+b}Object.defineProperty(h,"__esModule",{value:!0});h.C_INFINITY=Number.POSITIVE_INFINITY;h.C_PI=Math.PI;h.C_2PI=2*h.C_PI;h.C_PI_BY_2=h.C_PI/2;h.C_RAD_TO_256=128/h.C_PI;h.C_256_TO_RAD=h.C_PI/128;h.C_DEG_TO_256=256/360;h.C_DEG_TO_RAD=h.C_PI/180;h.C_SQRT2=1.414213562;h.C_SQRT2_INV=1/h.C_SQRT2;var c=1/Math.LN2;h.positiveMod=d;h.radToByte=function(a){return d(a*h.C_RAD_TO_256,256)};h.degToByte=function(a){return d(a*h.C_DEG_TO_256,256)};h.log2=
function(a){return Math.log(a)*c};h.sqr=function(a){return a*a};h.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};h.interpolate=function(a,b,c){return a*(1-c)+b*c};h.between=function(a,b,c){return a>=b&&a<=c||a>=c&&a<=b}})},"esri/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(m,h){m=function(){function d(c,a,b){this._op=c;"$type"===a?(this._val=b instanceof Array?b.map(function(a){return d._types.indexOf(a)}):d._types.indexOf(b),this._op+=11):(this._key=a,
this._val=b)}d.prototype.filter=function(c){switch(this._op){case 0:return this._val;case 1:return c.values[this._key]===this._val;case 2:return c.values[this._key]!==this._val;case 3:return c.values[this._key]<this._val;case 4:return c.values[this._key]>this._val;case 5:return c.values[this._key]<=this._val;case 6:return c.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(c.values[this._key]);case 8:return-1===this._val.indexOf(c.values[this._key]);case 9:for(var a=0,b=this._val;a<
b.length;a++){var d=b[a];if(d.filter(c))return!0}return!1;case 10:a=0;for(b=this._val;a<b.length;a++)if(d=b[a],!d.filter(c))return!1;return!0;case 11:a=0;for(b=this._val;a<b.length;a++)if(d=b[a],d.filter(c))return!1;return!0;case 12:return c.type===this._val;case 13:return c.type!==this._val;case 14:return c.type<this._val;case 15:return c.type>this._val;case 16:return c.type>=this._val;case 17:return c.type<=this._val;case 18:return-1!==this._val.indexOf(c.type);case 19:return-1===this._val.indexOf(c.type)}};
d.createFilter=function(c){if(!c)return new d(0,void 0,!0);var a=c[0];if(1>=c.length)return new d(0,void 0,"any"!==a);switch(a){case "\x3d\x3d":return new d(1,c[1],c[2]);case "!\x3d":return new d(2,c[1],c[2]);case "\x3e":return new d(4,c[1],c[2]);case "\x3c":return new d(3,c[1],c[2]);case "\x3e\x3d":return new d(6,c[1],c[2]);case "\x3c\x3d":return new d(5,c[1],c[2]);case "in":return new d(7,c[1],c.slice(2));case "!in":return new d(8,c[1],c.slice(2));case "any":return new d(9,void 0,c.slice(1).map(d.createFilter.bind(this)));
case "all":return new d(10,void 0,c.slice(1).map(d.createFilter.bind(this)));case "none":return new d(11,void 0,c.slice(1).map(d.createFilter.bind(this)));default:throw Error("invalid operator: "+a);}};return d}();m._types=["Unknown","Point","LineString","Polygon"];return m})},"esri/views/vectorTiles/SchemaHelper":function(){define(["require","exports"],function(m,h){return function(){function d(c,a){this.lockedSchemaPixelSize=c;this.isWGS84=a}d.prototype.getCompatibleLevelRowCol=function(c){var a=
c[0],b=c[1];c=c[2];this.isWGS84?(b>>=1,c>>=1):256===this.lockedSchemaPixelSize&&0<a&&(a--,b>>=1,c>>=1);return[a,b,c]};d.prototype.getSchemaShift=function(c,a){var b=0,d=0;if(256===this.lockedSchemaPixelSize||this.isWGS84)c[2]%2&&(b=2*a),c[1]%2&&(d=2*a);return[b,d]};d.prototype.adjustLevel=function(c){return this.isWGS84?c:256===this.lockedSchemaPixelSize?0<c?c-1:0:c};d.create256x256CompatibleTileInfo=function(c){if(!c)return null;if(256===c.rows&&256===c.cols)return c;for(var a=c.format,b=c.compressionQuality,
d=c.dpi,f=c.origin,g=c.spatialReference,e=4326===g.wkid,l=[],h,m,q=c.lods.length,n=0;n<q;n++){var t=c.lods[n];h=t.scale;m=e?t.resolution:2*t.resolution;l.push({level:t.level,scale:h,resolution:m})}return{rows:256,cols:256,dpi:d,format:a,compressionQuality:b,origin:f,spatialReference:g,lods:l}};d.create512x512CompatibleTileInfo=function(c){if(!c||256===c.rows||256===c.cols)return null;for(var a=c.format,b=c.compressionQuality,d=c.dpi,f=c.origin,g=c.spatialReference,e=[],l,h,m=c.lods.length,q=0;q<m;q++){var n=
c.lods[q];l=n.scale;h=.5*n.resolution;e.push({level:n.level,scale:l,resolution:h})}return{rows:512,cols:512,dpi:d,format:a,compressionQuality:b,origin:f,spatialReference:g,lods:e}};return d}()})},"esri/views/3d/terrain/SurfaceTilingSchemeLogic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/HandleRegistry ./TilingScheme ./terrainUtils".split(" "),function(m,
h,d,c,a,b,k,f,g){m=function(a){function b(){var b=a.call(this)||this;b._changeHandles=new k;return b}d(b,a);b.prototype.normalizeCtorArgs=function(a){this._layers=a.layers;this._extentHelper=a.extentHelper;this._manifold=a.manifold;return{viewSpatialReference:a.viewSpatialReference}};b.prototype.initialize=function(){var a=this;this._changeHandles.add(this._layers.on("change",function(){return a._update()}));this._changeHandles.add(this._extentHelper.watch("layerViewsExtent",function(){return a._setAdHocTilingScheme()}));
this._update();this.tilingSchemeLocked||this._setAdHocTilingScheme()};b.prototype.destroy=function(){this._changeHandles.destroy();this._changeHandles=null};b.prototype._update=function(){var a=this;this._waitTask=null;if(!this.tilingSchemeLocked){var b=this._layers.find(function(b){if(g.isTiledLayer(b))return b.isResolved()&&!a._isTileInfoSupported(g.getTileInfo(b),b.fullExtent)?!1:!b.isRejected()});if(b)if(b.isResolved()){var c=new f(g.getTileInfo(b)),b=g.getKnownTiledServiceLevelCap(b.url);Infinity>
b&&c.capMaxLod(b);this._lockTilingScheme(c)}else this._updateWhen(b)}};b.prototype._updateWhen=function(a){var b=this,c=a.always(function(){c===b._waitTask&&b._update()});this._waitTask=c};b.prototype._lockTilingScheme=function(a){var b=this;if("spherical"===this._manifold){var c=a.levels.length-1;a=a.spatialReference.isWebMercator?f.makeWebMercatorAuxiliarySphere(c):f.makeWGS84WithTileSize(a.pixelSize[0],c)}this.tilingSchemeLocked=!0;this.tilingScheme=a;this._extentHelper.tilingScheme=this.tilingScheme;
this._updateTiledLayerExtent();this._changeHandles.removeAll();this._changeHandles.add(this._extentHelper.watch("tiledLayersExtent",function(){return b._updateTiledLayerExtent()}))};b.prototype._updateTiledLayerExtent=function(){this.extent=this._extentHelper.tiledLayersExtent};b.prototype._setAdHocTilingScheme=function(){if("spherical"===this._manifold)this.tilingScheme=this._extentHelper.spatialReference.isWebMercator?f.WebMercatorAuxiliarySphere:f.makeWGS84WithTileSize(256),this.extent=this._extentHelper.layerViewsExtent;
else{var a=this._extentHelper.layerViewsExtent;a&&(this.tilingScheme=f.fromExtent(a,this._extentHelper.spatialReference),this.extent=a)}};b.prototype._isTileInfoSupported=function(a,b){return null==g.checkIfTileInfoSupportedForView(a,b,this.viewSpatialReference,this._manifold)};return b}(a.declared(b));c([a.property()],m.prototype,"tilingScheme",void 0);c([a.property()],m.prototype,"extent",void 0);c([a.property({value:!1})],m.prototype,"tilingSchemeLocked",void 0);c([a.property()],m.prototype,"viewSpatialReference",
void 0);return m=c([a.subclass()],m)})},"esri/views/3d/terrain/SphericalTile":function(){define("./TileBase ./TileGeometryFactory ../../../core/ObjectPool ../support/mathUtils ../support/earthUtils ../lib/glMatrix".split(" "),function(m,h,d,c,a,b){var k=b.vec3d,f=a.earthRadius,g=function(a,b,c,d){c=f+c;var e=Math.cos(a);d[0]=Math.cos(b)*e*c;d[1]=Math.sin(b)*e*c;d[2]=Math.sin(a)*c};a=function(a,b,c,d){m.call(this);this.tileUp=k.create();this.obb=Array(8);this._isWebMercator=!1;for(var e=0;8>e;e++)this.obb[e]=
k.create();void 0!==a&&this.init(a,b,c,d)};a.prototype=new m;a.prototype.constructor=a;a.prototype.init=function(a,b,d,h){m.prototype.init.call(this,a,b,d,h);this._isWebMercator=h.spatialReference.isWebMercator;b=this.extentWGS84Rad[0];d=this.extentWGS84Rad[1];h=this.extentWGS84Rad[2];var e=this.extentWGS84Rad[3];a=a[0];var l=c.lerp(d,e,.5),p=c.lerp(b,h,.5);this.edgeLen=(h-b)*Math.cos(0===a?0:Math.min(Math.abs(d),Math.abs(e)))*f;this.curvatureHeight=f-Math.sqrt(f*f-this.edgeLen*this.edgeLen/4);g(l,
p,0,this.centerAtSeaLevel);k.set(this.centerAtSeaLevel,this.tileUp);k.normalize(this.tileUp);this._updateOBB();this.updateRadiusAndCenter()};a.prototype.isVisible=function(a,b){if(!this.intersectsClippingArea)return!1;if(9<this.lij[0]){b=this.obb;for(var c=0;6>c;c++){for(var d=0;8>d&&!(0>a[c][0]*b[d][0]+a[c][1]*b[d][1]+a[c][2]*b[d][2]+a[c][3]);d++);if(8===d)return!1}}else if(b=this.radius,c=this.center,a[0][0]*c[0]+a[0][1]*c[1]+a[0][2]*c[2]+a[0][3]>b||a[1][0]*c[0]+a[1][1]*c[1]+a[1][2]*c[2]+a[1][3]>
b||a[2][0]*c[0]+a[2][1]*c[1]+a[2][2]*c[2]+a[2][3]>b||a[3][0]*c[0]+a[3][1]*c[1]+a[3][2]*c[2]+a[3][3]>b||a[4][0]*c[0]+a[4][1]*c[1]+a[4][2]*c[2]+a[4][3]>b||a[5][0]*c[0]+a[5][1]*c[1]+a[5][2]*c[2]+a[5][3]>b)return!1;return!0};a.prototype.computeElevationBounds=function(){m.prototype.computeElevationBounds.call(this);this._updateOBB()};a.prototype.updateRadiusAndCenter=function(){if(0===this.lij[0])k.set3(0,0,0,this.center),this.radius=f+this.elevationBounds[1];else{m.prototype.updateRadiusAndCenter.call(this);
var a=Math.max(k.dist2(this.center,this.obb[0]),k.dist2(this.center,this.obb[1]));this.radius=Math.sqrt(a)}};a.prototype._numSubdivisionsAtLevel=[128,64,32,16,16,8,8,4];a.prototype.createGeometry=function(a,b,c){var d=this._isPole(this.lij[1],this.lij[0]);a.needsUpdate=!1;return h.createSphericalGlobeTile(a.numVertsPerRow,this.extent,this.extentWGS84Rad,this._isWebMercator,a.samplerData,b,d,c)};a.prototype._updateOBB=function(){var a=this.extentWGS84Rad,b=this.obb,c;for(c=0;2>c;c++){var d=this.elevationBounds[c],
h=4*c;g(a[1],a[0],d,b[h++]);g(a[3],a[0],d,b[h++]);g(a[3],a[2],d,b[h++]);g(a[1],a[2],d,b[h++])}this._isWebMercator&&(a=this._isPole(this.lij[1],this.lij[0]),2===a?(k.set3(0,0,f,b[1]),k.set3(0,0,f,b[2]),k.set3(0,0,f,b[5]),k.set3(0,0,f,b[6])):1===a&&(k.set3(0,0,-f,b[0]),k.set3(0,0,-f,b[3]),k.set3(0,0,-f,b[4]),k.set3(0,0,-f,b[7])))};a.prototype._isPole=function(a,b){var c=0;a===(1<<b)-1&&(c+=1);0===a&&(c+=2);return c};a.Pool=new d(a);return a})},"esri/views/3d/terrain/TileBase":function(){define("./terrainUtils ./tileUtils ./TerrainConst ./UpsampleInfo ./ElevationData ./TilePerLayerInfo ../support/mathUtils ../lib/glMatrix ../../../core/arrayUtils".split(" "),
function(m,h,d,c,a,b,k,f,g){var e=f.vec3d,l=f.vec2d,p=f.vec4d,v=f.mat4d,q=m.weakAssert,n=e.create(),t=p.create(),u=p.create(),x=e.create(),r={},z=d.LayerClass.LAYER_CLASS_COUNT,B=d.LayerClass.MAP,C=d.LayerClass.ELEVATION,A=d.TileUpdateTypes;f=function(a,b,c){this.lij=[0,0,0];this.extent=p.create();this.extentWGS84Rad=p.create();this.centerAtSeaLevel=e.create();this.center=e.create();this.tileUp=x;this.elevationBounds=l.create();this.children=[null,null,null,null];this.layerInfo=Array(z);this.intersectsClippingArea=
this.isWithinClippingArea=!0;this.clippingArea=null;this._maxTesselation=0};f.prototype.init=function(a,c,e,f){this.lij[0]=a[0];this.lij[1]=a[1];this.lij[2]=a[2];f.getExtent(a[0],a[1],a[2],this.extent,this.extentWGS84Rad);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this.radius=this.edgeLen=0;this.vlevel=a?a[0]:0;c&&c.elevationBounds?l.set(c.elevationBounds,this.elevationBounds):l.set2(0,0,this.elevationBounds);this.parent=c;for(a=0;4>a;a++)this.children[a]=null;
this.pendingUpdates=0;this.renderData=null;this.renderOrder=this.screenDepth=0;this.visible=!1;this.parentSurface=e;for(a=0;a<z;a++)if(e){c=e.numLayers(a);var g;this.layerInfo[a]?(g=this.layerInfo[a],g.length=c):(g=Array(c),this.layerInfo[a]=g);for(var k=0;k<c;k++)g[k]=b.makeEmptyLayerInfo(a,g[k]),a==C&&this.findElevationBoundsForLayer(k,-1)}else this.layerInfo[a]=null;this.computeElevationBounds();this._maxTesselation=Math.min(f.pixelSize[0],d.MAX_TILE_TESSELATION)};f.prototype.dispose=function(){for(var a=
0;a<z;a++)for(var b=this.layerInfo[a],d=0;d<b.length;d++){var e=b[d];e.upsampleFromTile&&(c.Pool.release(e.upsampleFromTile),e.upsampleFromTile=null)}};f.prototype.releaseLayerResources=function(){for(var a=this.layerInfo[d.LayerClass.MAP],b=0;b<a.length;b++)a[b].releaseResources()};f.prototype.updateScreenDepth=function(a){e.set(this.center,u);u[3]=1;v.multiplyVec4(a,u,u);this.screenDepth=u[2]/u[3]};f.prototype.shouldSplit=function(a,b){var c=this.lij[0];if(1>c)return A.SPLIT;e.subtract(this.center,
b,n);var d=e.length(n),f=this.edgeLen/(a[0]*d*2),d=this.edgeLen/(a[2]*d*2),g=a[1],l=a[3],h=a[4];a=a[5];return f<g?this.vlevel!==this.lij[0]?(this.vlevel=this.lij[0],A.VSPLITMERGE):A.NONE:c>=h?(b=c+Math.ceil(-k.log2(g/f)),b!==this.vlevel?(this.vlevel=b,A.VSPLITMERGE):A.NONE):6<c&&(e.scale(this.tileUp,e.dot(this.tileUp,n),t),e.subtract(t,n),e.length2(t)>this.radius*this.radius&&(e.scale(t,this.radius/e.length(t)),e.add(t,this.center),e.subtract(b,t,t),b=this.elevationBounds[1]-this.elevationBounds[0],
Math.min(1,(Math.abs(e.dot(t,this.tileUp))+.5*b+this.curvatureHeight)/e.length(t))*d<.1/a*l))?A.NONE:A.SPLIT};f.prototype.decodeElevationData=function(b){var c;if(b instanceof ArrayBuffer)try{c=a.createFromLERC(this.lij,this.extent,b,d.noDataValueOpt)}catch(H){console.warn("Error decoding %s: %s",b.url,H.message)}else c=a.createFromFetchTileResult(this.lij,this.extent,b);return c};f.prototype.getWGS84Extent=function(){return this.extentWGS84Rad.map(k.rad2deg)};f.prototype.load=function(a){for(var b=
0;b<z;b++)this.layerInfo[b]&&this._createOrUpdateAgents(0,b);a.loadTile(this)};f.prototype.unload=function(a){this.renderData&&a.unloadTile(this);for(a=0;a<z;a++)for(var b=this.layerInfo[a],c=0;c<b.length;c++){var e=b[c];e.loadingAgent&&e.loadingAgent!==r&&(e.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(c,a).Pool.release(e.loadingAgent),e.loadingAgent=null);e.pendingUpdates=0}this.pendingUpdates&=~d.TileUpdateTypes.UPDATE_GEOMETRY;this.pendingUpdates&=~d.TileUpdateTypes.UPDATE_TEXTURE};
f.prototype.updateClippingStatus=function(a){g.equals(a,this.clippingArea)||(a?(this.intersectsClippingArea=this.intersectsExtent(a),this.isWithinClippingArea=this.isWithinExtent(a)):this.isWithinClippingArea=this.intersectsClippingArea=!0,this.clippingArea=a,this.renderData&&this.updateGeometry())};f.prototype.updateVisibility=function(a,b,c){a=c||this.isVisible(a,b)&&this.intersectsClippingArea;if(a!==this.visible)for(this.visible=a,b=this.layerInfo[0],c=0;c<b.length;c++){var d=b[c];d.loadingAgent&&
d.loadingAgent!==r&&d.loadingAgent.setSuspension(!a)}return a};f.prototype.getLayerInfo=function(a,b){return this.layerInfo[b][a]};f.prototype.hasLayerData=function(a,b){return(a=this.layerInfo[b][a])&&a.data};f.prototype.tileDataAvailable=function(a,b,c){return(b=this.layerInfo[c][b].tilemap)?"unavailable"!==b.getAvailability(a.lij[1],a.lij[2]):!0};f.prototype.requestLayerData=function(a,b,c){d.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d requested by tile %s",this.lij.toString(),b,a,
c.tile.lij.toString());var e=this.layerInfo[b][a];if(-1<e.waitingAgents.indexOf(c))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),c.tile.lij.toString(),b,a),!0;if(e.data)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),c.tile.lij.toString(),b,a),e.waitingAgents.push(c),setTimeout(c.dataArrived.bind(c,this),0),!0;if(e.pendingUpdates&A.DECODE_ELEVATION)return e.waitingAgents.push(c),
!0;e.waitingAgents.push(c);if(!e.requestPromise){var f=this.parentSurface.requestTileData(this,a,b);if(f.isFulfilled())return!1;a=function(){e.requestPromise===f&&(e.requestPromise=null)};e.requestPromise=f;f.then(a,a);return!!f}return!0};f.prototype.descendants=function(a){a||(a=[]);for(var b=0;4>b;b++){var c=this.children[b];c&&(c.descendants(a),a.unshift(this.children[b]))}return a};f.prototype.isLij=function(a){return this.lij[0]===a[0]&&this.lij[1]===a[1]&&this.lij[2]==a[2]};f.prototype.findByLij=
function(a){if(this.isLij(a))return this;for(var b=0;4>b;b++){var c=this.children[b];if(c&&(c=c.findByLij(a)))return c}return null};f.prototype.unrequestLayerData=function(a,b,c){d.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d canceled by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var e=this.layerInfo[b][a],f=e.waitingAgents;c=f.indexOf(c);q(-1<c,"agent has not requested this piece of map data");f[c]=f[f.length-1];f.length--;1>f.length&&(f=e.requestPromise,c=!1,b===B&&(c=this.parentSurface.layerViewByIndex(a,
B),c=m.isVectorTileLayerView(c)),c||q(f||e.rawData,"no pending operations on layerInfo that agents were waiting for"),f&&!f.isFulfilled()&&(f.cancel(),e.requestPromise=null),d.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d request/loading canceled",this.lij.toString(),b,a))};f.prototype.dataArrived=function(a,b,c){a=this.layerInfo[b][a];a.data=c;for(c=0;c<a.waitingAgents.length;c++)a.waitingAgents[c].dataArrived(this);a.waitingAgents.length=0};f.prototype.dataMissing=function(a,b,c){c.notInTilemap||
console.error("Tile %s layer %d/%d error",this.lij.toString(),b,a);a=this.layerInfo[b][a];for(b=0;b<a.waitingAgents.length;b++)a.waitingAgents[b].dataMissing(this);a.waitingAgents.length=0};f.prototype.updateTexture=function(a){this.renderData&&(a?this.parentSurface._renderer.updateTileTexture(this):(this.pendingUpdates|=d.TileUpdateTypes.UPDATE_TEXTURE,this.parentSurface._pendingUpdates=!0))};f.prototype.reinitializeLayer=function(a,c){a=this.layerInfo[c][a];a.loadingAgent&&a.loadingAgent!==r&&a.loadingAgent.dispose();
b.makeEmptyLayerInfo(c,a);this.restartAgents(c)};f.prototype.computeElevationBounds=function(){l.set2(Number.MAX_VALUE,-Number.MAX_VALUE,this.elevationBounds);for(var a=this.layerInfo[C],b=!1,c=0;c<a.length;c++){var d=a[c];d.elevationBounds&&(this.elevationBounds[0]=Math.min(this.elevationBounds[0],d.elevationBounds[0]),this.elevationBounds[1]=Math.max(this.elevationBounds[1],d.elevationBounds[1]),b=!0)}b||l.set2(0,0,this.elevationBounds);this.updateRadiusAndCenter()};f.prototype.updateRadiusAndCenter=
function(){e.scale(this.tileUp,.5*(this.elevationBounds[0]+this.elevationBounds[1]),t);e.add(this.centerAtSeaLevel,t,this.center)};f.prototype.findElevationBoundsForLayer=function(a,b){var c=this.layerInfo[C][a];if(!c.elevationBounds||c.elevationBounds[2]<b)if(b=this.parentSurface.layerViewByIndex(a,C),h.fallsWithinLayer(this,b,!1)){b=!1;if(c.data)l.set(c.data.bounds,t),t[2]=this.lij[0],b=!0;else{for(var f=this.parent,g=0,k=null,p=c.data;f&&(!p||g<d.ELEVATION_DESIRED_RESOLUTION_LEVEL);){g=this.vlevel-
f.lij[0];k=p||k;p=f.layerInfo[C][a].data;if(!p&&k&&g>=d.ELEVATION_DESIRED_RESOLUTION_LEVEL)break;f=f.parent}if(p=p||k)p.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],t),Infinity!==t[0]&&(t[2]=p.level,b=!0)}b&&(c.elevationBounds?e.set(t,c.elevationBounds):c.elevationBounds=[t[0],t[1],t[2]])}};f.prototype.updateGeometry=function(){this.pendingUpdates|=d.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0};f.prototype.modifyLayers=function(a,c,d){for(var e=c.length,f=this.layerInfo[d],
g=Array(e),k=0;k<f.length;k++){var l=f[k];l.loadingAgent&&l.loadingAgent!==r&&(l.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(k,d).Pool.release(l.loadingAgent),l.loadingAgent=null);l.waitingAgents.length=0}if(d===B)for(k=0;k<f.length;k++)void 0===a[k]&&f[k].releaseResources();for(k=0;k<e;k++)a=c[k],g[k]=-1<a?f[a]:b.makeEmptyLayerInfo(d);this.layerInfo[d]=g};f.prototype.restartAgents=function(a){if(this.renderData)if(this._createOrUpdateAgents(0,a),a===C){this.updateGeometry();a=
this.layerInfo[a];for(var b=0;b<a.length;b++)a[b].pendingUpdates|=d.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0}else this.updateTexture(!0)};f.prototype.updateAgents=function(a){if(this.renderData){for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.loadingAgent===r&&(d.loadingAgent=null)}this._createOrUpdateAgents(0,a)}};f.prototype.agentDone=function(a,b){var c=this.layerInfo[b],d=c[a];d.loadingAgent=r;d.data||d.upsampleFromTile||a<c.length-1&&this._createOrUpdateAgents(a+
1,b)};f.prototype._createOrUpdateAgents=function(a,b){var c;c=b===C?!1:!this.visible;for(var d=this.layerInfo[b];a<d.length;){var e=d[a],f=!1,g=this.parentSurface.layerViewByIndex(a,b);if(null!==e.loadingAgent&&e.loadingAgent!==r)f=e.loadingAgent.update();else if(e.loadingAgent!==r&&h.fallsWithinLayer(this,g,!1)){var k=this.parentSurface.agentTypeByLayerIndex(a,b),l=k.Pool.acquire();(f=l.init(this,a,b,c))?e.loadingAgent=l:(l.dispose(),k.Pool.release(l),e.loadingAgent=r)}if(f&&!g.isTransparent)break;
a++}};f.prototype.geometryState=function(a){var b,c=this._getElevationInfo(a?a.samplerData:null),e=this.lij[0],f=!1;c.samplerData?(b=this.vlevel-e,b=Math.max(e-c.maxTileLevel,d.ELEVATION_DESIRED_RESOLUTION_LEVEL-b),e=this._maxTesselation,b=k.clamp((e>>b)+1,2,e+1)):b=8>e?this._numSubdivisionsAtLevel[e]+1:2;e=this.clippingArea;if(!this.intersectsClippingArea||this.isWithinClippingArea)e=null;a?(a.numVertsPerRow!==b&&(a.numVertsPerRow=b,f=!0),c.changed&&(a.samplerData=c.samplerData,f=!0),g.equals(a.clippingArea,
e)||(a.clippingArea=e,f=!0),a.needsUpdate=f):a={numVertsPerRow:b,samplerData:c.samplerData,needsUpdate:!0,clippingArea:e};return a};f.prototype._getElevationInfo=function(a){for(var b=this.layerInfo[C],c=b.length,d=Array(c),e=0,f=0,g=!1,k=0;k<c;k++){var l=b[k];if(l.upsampleFromTile){var l=l.upsampleFromTile.tile,p=l.layerInfo[C][k].data;a&&a[e]===p.samplerData||(g=!0);d[e++]=p.samplerData;f=Math.max(f,l.lij[0])}else l.data&&(p=this.parentSurface.layerViewByIndex(k,C),h.fallsWithinLayer(this,p,!1)&&
(a&&a[e]===l.data.samplerData||(g=!0),d[e++]=l.data.samplerData,f=this.lij[0]))}a&&a.length!==e&&(g=!0);0<e?d.length=e:d=null;return{changed:g,samplerData:d,maxTileLevel:f}};f.prototype.isWithinExtent=function(a){var b=this.extent;return b[0]>=a[0]&&a[2]>=b[2]&&b[1]>=a[1]&&a[3]>=b[3]};f.prototype.intersectsExtent=function(a){var b=this.extent;return b[2]>=a[0]&&a[2]>=b[0]&&b[3]>=a[1]&&a[3]>=b[1]};return f})},"esri/views/3d/terrain/ElevationData":function(){define(["require","exports","../../../layers/support/rasterFormats/LercCodec",
"./TerrainConst","../support/mathUtils"],function(m,h,d,c,a){return function(){function b(a,b,c,d){this.samplerData=null;this.level=a;this.i=b;this.j=c;this.extent=d}b.prototype.computeMinMaxValue=function(b,d,g,e){var f=Infinity,k=-Infinity;b-=this.level;var h=Math.pow(2,b);if(Math.floor(d/h)===this.i&&Math.floor(g/h)===this.j&&0<b){var q=this.samplerData.width,n=this.samplerData.pixelData,m=.5*c.ELEVATION_NODATA_VALUE;b=(q-1)/h;g=(g-this.j*h)*b;d=(d-this.i*h)*b;if(1>b){var h=Math.floor(g),u=Math.floor(d),
x=h+u*q,r=n[x],z=n[x+1],B=n[x+q],x=n[x+q+1];if(r+z+B+x<m)return f=a.bilerp(r,z,B,x,g-h,d-u),k=a.bilerp(r,z,B,x,g-h+b,d-u),q=a.bilerp(r,z,B,x,g-h,d-u+b),b=a.bilerp(r,z,B,x,g-h+b,d-u+b),e[0]=Math.min(f,k,q,b),e[1]=Math.max(f,k,q,b),e;g=h;d=u;b=1}else g=Math.floor(g),d=Math.floor(d),b=Math.ceil(b);for(h=g;h<=g+b;h++)for(u=d;u<=d+b;u++)x=h+u*q,r=n[x],r<m?(f=Math.min(f,r),k=Math.max(k,r)):(f=0<f?0:f,k=0>k?0:k)}e[0]=f;e[1]=k;return e};b.createFromLERC=function(a,c,g,e){g=d.decode(g,e);a=new b(a[0],a[1],
a[2],c);a.samplerData={pixelData:g.pixelData,width:g.width,height:g.height,minValue:g.minValue,maxValue:g.maxValue,noDataValue:g.noDataValue,safeWidth:.99999999*(g.width-1),dx:(g.width-1)/(a.extent[2]-a.extent[0]),dy:(g.width-1)/(a.extent[3]-a.extent[1]),x0:a.extent[0],y1:a.extent[3]};a.bounds=[a.samplerData.minValue,-3E38<a.samplerData.maxValue?a.samplerData.maxValue:0];return a};b.createFromFetchTileResult=function(a,c,d){a=new b(a[0],a[1],a[2],c);c=d.values;for(var e=d.noDataValue,f=Infinity,g=
-Infinity,k=!0,h=0;h<c.length;h++){var n=c[h];n!==e&&(f=n<f?n:f,g=n>g?n:g,k=!1)}k&&(g=f=0);a.samplerData={pixelData:d.values,width:d.width,height:d.height,minValue:f,maxValue:g,noDataValue:e,safeWidth:.99999999*(d.width-1),dx:(d.width-1)/(a.extent[2]-a.extent[0]),dy:(d.width-1)/(a.extent[3]-a.extent[1]),x0:a.extent[0],y1:a.extent[3]};a.bounds=[f,g];return a};return b}()})},"esri/views/3d/terrain/TilePerLayerInfo":function(){define(["require","exports","./TerrainConst","../../webgl/Texture","../../vectorTiles/VectorTileDisplayObject"],
function(m,h,d,c,a){return function(){function b(a){this.waitingAgents=[];this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=this.data=null;this.pendingUpdates=0;this.elevationBounds=void 0;this.init(a)}b.prototype.init=function(a){this.waitingAgents.length=0;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=this.data=null;this.pendingUpdates=0;a===d.LayerClass.ELEVATION&&(this.elevationBounds=
null)};b.prototype.releaseResources=function(){this.waitingAgents.length=0;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=null;this.pendingUpdates=0;var b=this.data;b&&(b instanceof c?b.dispose():b instanceof a&&b.dispose())};b.makeEmptyLayerInfo=function(a,c){return c?(c.init(a),c):new b(a)};return b}()})},"esri/views/3d/terrain/PlanarTile":function(){define(["./TileBase","./TileGeometryFactory","../../../core/ObjectPool","../support/mathUtils",
"../lib/glMatrix"],function(m,h,d,c,a){var b=a.vec3d.createFrom(0,0,1);a=function(a,c,d,e){m.call(this);this.tileUp=b;void 0!==a&&this.init(a,c,d,e)};a.prototype=new m;a.prototype.constructor=a;a.prototype.init=function(a,b,d,e){m.prototype.init.call(this,a,b,d,e);this.edgeLen=this.extent[2]-this.extent[0];this.curvatureHeight=0;this.centerAtSeaLevel[0]=c.lerp(this.extent[0],this.extent[2],.5);this.centerAtSeaLevel[1]=c.lerp(this.extent[1],this.extent[3],.5);this.centerAtSeaLevel[2]=0;this.updateRadiusAndCenter()};
a.prototype.updateRadiusAndCenter=function(){m.prototype.updateRadiusAndCenter.call(this);var a=(this.extent[2]-this.extent[0])*Math.SQRT1_2,b=.5*(this.elevationBounds[0]-this.elevationBounds[1]);this.radius=Math.sqrt(a*a+b*b)};a.prototype.isVisible=function(a){if(!this.intersectsClippingArea)return!1;var b=this.extent[0],c=this.extent[1],d=this.elevationBounds[0],k=this.extent[2],h=this.extent[3],m=this.elevationBounds[1];return 0<a[0][0]*(0<a[0][0]?b:k)+a[0][1]*(0<a[0][1]?c:h)+a[0][2]*(0<a[0][2]?
d:m)+a[0][3]||0<a[1][0]*(0<a[1][0]?b:k)+a[1][1]*(0<a[1][1]?c:h)+a[1][2]*(0<a[1][2]?d:m)+a[1][3]||0<a[2][0]*(0<a[2][0]?b:k)+a[2][1]*(0<a[2][1]?c:h)+a[2][2]*(0<a[2][2]?d:m)+a[2][3]||0<a[3][0]*(0<a[3][0]?b:k)+a[3][1]*(0<a[3][1]?c:h)+a[3][2]*(0<a[3][2]?d:m)+a[3][3]||0<a[4][0]*(0<a[4][0]?b:k)+a[4][1]*(0<a[4][1]?c:h)+a[4][2]*(0<a[4][2]?d:m)+a[4][3]||0<a[5][0]*(0<a[5][0]?b:k)+a[5][1]*(0<a[5][1]?c:h)+a[5][2]*(0<a[5][2]?d:m)+a[5][3]?!1:!0};a.prototype._numSubdivisionsAtLevel=[2,2,2,2,2,2,2,2];a.prototype.createGeometry=
function(a,b,c){a.needsUpdate=!1;return h.createPlanarGlobeTile(a.numVertsPerRow,this.extent,a.samplerData,b,c,a.clippingArea)};a.Pool=new d(a);return a})},"esri/views/3d/terrain/TilemapOnlyTile":function(){define(["require","exports","./TerrainConst","./TilePerLayerInfo"],function(m,h,d,c){return function(){function a(a){this.lij=a;this.layerInfo=Array(d.LayerClass.LAYER_CLASS_COUNT)}a.prototype.tileDataAvailable=function(a,c,d){return(c=this.layerInfo[d][c].tilemap)?"unavailable"!==c.getAvailability(a.lij[1],
a.lij[2]):!0};a.prototype.modifyLayers=function(a,d,f){a=d.length;for(var b=this.layerInfo[f],e=Array(a),k=0;k<a;k++){var h=d[k];e[k]=-1<h?b[h]:new c(f)}this.layerInfo[f]=e};return a}()})},"esri/views/3d/terrain/MapTileAgent":function(){define(["./TileAgentBase","./tileUtils","./UpsampleInfo","../../../core/ObjectPool"],function(m,h,d,c){var a=function(){m.apply(this,arguments)};a.prototype=new m;a.prototype.constructor=a;a.prototype.dataArrived=function(a){a!==this.tile?this._setUpsamplingTile(a):
this.tile.updateTexture();this._dataRequested=null;a!==this.tile&&this._requestNext()};a.prototype._desiredMinLevelDelta=function(){return 0};a.prototype.START_LOADING_LEVEL_DELTA=4;a.prototype.SCALE_RANGE_ENABLED=!0;a.prototype._setUpsamplingTile=function(a){this._tileLayerInfo.upsampleFromTile&&this._tileLayerInfo.upsampleFromTile.tile===a||(this._tileLayerInfo.upsampleFromTile&&d.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=h.computeUpsampleInfoForAncestor(this.tile,
a),this.tile.updateTexture())};a.Pool=new c(a);return a})},"esri/views/3d/terrain/TileAgentBase":function(){define(["./UpsampleInfo","./tileUtils"],function(m,h){var d=Error("Abstract method called on TileAgentBase"),c=function(){};c.prototype.init=function(a,c,d,g){this.tile=a;this.layerIdx=c;this.layerClass=d;this._tileLayerInfo=a.getLayerInfo(c,d);this._dataRequested=null;this.suspended=g;if(!a.data)return(a=this._findAncestorWithData())?(this._setUpsamplingTile(a.tile),m.Pool.release(a)):(this._tileLayerInfo.upsampleFromTile&&
m.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=null),this._requestNext(!0)};c.prototype.dispose=function(){this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=null);this._tileLayerInfo=this.tile=null};c.prototype.setSuspension=function(a){a!==this.suspended&&((this.suspended=a)?this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=
null):this._tileLayerInfo.data||this.update())};c.prototype.update=function(){var a=this._findAncestorWithData();a&&this._tileLayerInfo.upsampleFromTile&&a.tile!==this._tileLayerInfo.upsampleFromTile.tile?this._setUpsamplingTile(a.tile):a&&m.Pool.release(a);return this._requestNext()};c.prototype.dataArrived=function(a){throw d;};c.prototype.dataMissing=function(a){this._dataRequested=null;this._agentDone()};c.prototype._agentDone=function(){this.tile.agentDone(this.layerIdx,this.layerClass);this.dispose()};
c.prototype._requestNext=function(a){if(this.suspended)return!0;var b=this._findNextDownload();if(this._dataRequested){if(b===this._dataRequested)return!0;this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this);this._dataRequested=null}b?b.requestLayerData(this.layerIdx,this.layerClass,this)&&(this._dataRequested=b):a||this._agentDone();return!!this._dataRequested};c.prototype._findNextDownload=function(){for(var a,c=this.layerIdx,d=this.layerClass,g=this.tile.parentSurface.layerViewByIndex(c,
d),e=g.minDataLevel,l=g.maxDataLevel,p=this._desiredMinLevelDelta(),m=this.START_LOADING_LEVEL_DELTA+p,q=this.SCALE_RANGE_ENABLED,n=this.tile,t=n.lij[0],u=0,x=this._tileLayerInfo.upsampleFromTile?this._tileLayerInfo.upsampleFromTile.tile.lij[0]:-1,r=this.tile.parentSurface,z=r.getTilemapTile(n),B=r.tilemapStats,C=!1;n&&(u<=m||!a)&&(!q||h.fallsWithinLayer(n,g,!1))&&n.lij[0]>=e;){var A=n.layerInfo[d][c];if(A.data&&u>=p){n.lij[0]>x&&this._setUpsamplingTile(n);break}z&&!z.tileDataAvailable(n,c,d)?C=!0:
n.lij[0]<=l&&!A.data&&(a=n);(n=n.parent)&&z&&(z=z.parent||r.getTilemapTile(n));u++}a&&t-a.lij[0]<p&&this._tileLayerInfo.upsampleFromTile&&(a=null);!a&&C&&B.tilesNotPresent++;return a};c.prototype._findAncestorWithData=function(){return a(this.tile,this.layerIdx,this.layerClass,1,0,0,0)};var a=function(b,c,d,g,e,l,h){if(!b.parent||6<h)return null;g*=.5;e*=.5;l*=.5;b.lij[2]&1&&(e+=.5);0===(b.lij[1]&1)&&(l+=.5);return b.parent.hasLayerData(c,d)?(c=m.Pool.acquire(),c.init(b.parent,e,l,g),c):a(b.parent,
c,d,g,e,l,h+1)};c.prototype._desiredMinLevelDelta=function(){throw d;};c.prototype.START_LOADING_LEVEL_DELTA=4;c.prototype.SCALE_RANGE_ENABLED=!1;return c})},"esri/views/3d/terrain/ElevationTileAgent":function(){define(["./TileAgentBase","./TerrainConst","./UpsampleInfo","../../../core/ObjectPool"],function(m,h,d,c){var a=function(){m.apply(this,arguments)};a.prototype=new m;a.prototype.constructor=a;a.prototype.dataArrived=function(a){a!==this.tile?this._setUpsamplingTile(a):this.updateGeometry();
this._dataRequested=null;this._requestNext()};a.prototype.updateGeometry=function(){this._tileLayerInfo.pendingUpdates|=h.TileUpdateTypes.UPDATE_GEOMETRY;this.tile.updateGeometry()};a.prototype._findAncestorWithData=function(){for(var a=this.layerClass,c=this.layerIdx,f=this.tile,g=f.vlevel,e;f&&!(f.layerInfo[a][c].data&&(e=f,g-f.lij[0]>=h.ELEVATION_DESIRED_RESOLUTION_LEVEL));)f=f.parent;return e?(a=d.Pool.acquire(),a.init(e,0,0,1),a):null};a.prototype._desiredMinLevelDelta=function(){return h.ELEVATION_DESIRED_RESOLUTION_LEVEL-
(this.tile.vlevel-this.tile.lij[0])};a.prototype.START_LOADING_LEVEL_DELTA=4;a.prototype.SCALE_RANGE_ENABLED=!1;a.prototype._setUpsamplingTile=function(a){this._tileLayerInfo.upsampleFromTile&&d.Pool.release(this._tileLayerInfo.upsampleFromTile);var b=d.Pool.acquire();b.init(a,0,0,1);this._tileLayerInfo.upsampleFromTile=b;this.updateGeometry()};a.Pool=new c(a);return a})},"esri/views/3d/layers/graphics/Deconflictor":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/watchUtils ../../../../core/HandleRegistry ../../../../core/Logger ../../support/aaBoundingRect ../../support/PreallocArray ./deconflictorDebug ../../lib/glMatrix ../../webgl-engine/lib/Util ../../webgl-engine/lib/screenSizePerspectiveUtils ../../webgl-engine/materials/internal/MaterialUtil ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q){function n(a){return!!a&&"selection"===a.type}var t=e.vec2d;m=e.vec4d;var u=l.VertexAttrConstants,x=b.getLogger("esri.views.3d.graphics.Deconflictor"),r=m.create(),z=m.create(),B=m.create(),C=m.create(),A=t.create(),D=k.create(),E=k.create(),H=new Set,G=l.lerp,J=new f(100),I=new f(100),F=function(){function a(a,b){this.creator=a;this.disposer=b;this.list=[];this.currentIndex=0}a.prototype.alloc=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
this.currentIndex>=this.list.length&&this.list.push(new this.creator(a));return this.list[this.currentIndex++]};a.prototype.freeAll=function(){for(var a=this.currentIndex,b=this.disposer,c=this.list;0<=--a;)b(c[a]);this.currentIndex=0};return a}(),N=function(){function a(){this.graphics3DGraphic=null;this.positions=[t.create(),t.create(),t.create(),t.create()];this.posView=this.yMax=this.yMin=this.xMax=this.xMin=0;this.graphicsOwner=null;this.graphicId=this.id=0}a.release=function(a){a.graphics3DGraphic=
null;a.graphicsOwner=null};return a}();b=function(){function b(b){var d=this;this.graphicsOwners=[];this.deconflictTimeoutId=0;this.handles=new a;this.graphicInfoPool=new F(N,N.release);this.nextGraphicInfoId=0;this.accBinsNumX=15;this.accBinsNumY=20;this.accBinsSizeY=this.accBinsSizeX=0;this.accBins=null;this.accNumTests=0;this.iconMarginFactor=-.1;this.view=b;this.stage=b._stage;this.handles.add([c.on(b,"navigation","targetViewChanged",function(){return d.scheduleRun()}),c.whenNot(b,"ready",function(){return d.clearDeconflictTimeout()})])}
b.prototype.destroy=function(){this.handles.destroy();this.handles=null;this.clearDeconflictTimeout();this.graphicInfoPool.freeAll();this.stage=this.view=this.graphicInfoPool=null};b.prototype.clearDeconflictTimeout=function(){this.deconflictTimeoutId&&(clearTimeout(this.deconflictTimeoutId),this.deconflictTimeoutId=0)};b.prototype.addGraphicsOwner=function(a){var b=this;this.graphicsOwners.push(a);this.setDirty();a.layer&&"function"===typeof a.layer.watch&&a.layer.watch("featureReduction",function(c,
d){n(c)?b.setDirty():n(d)&&(b._removeIconVisibilityFlags(a),b.setDirty())})};b.prototype.removeGraphicsOwner=function(a){a=this.graphicsOwners.indexOf(a);0<=a&&this.graphicsOwners.splice(a,1);this.setDirty()};b.prototype.setDirty=function(){this.scheduleRun(10)};b.prototype.initializeLabelVisibility=function(a){a.setVisibilityFlag(2,!1,1)};b.prototype.doesIntersectExistingPoly=function(a){var b=a.graphicId,c=a.positions;H.clear();for(var d=Math.floor(a.xMin/this.accBinsSizeX);d<=Math.floor(a.xMax/
this.accBinsSizeX);d++)if(!(0>d||d>=this.accBinsNumX))for(var e=Math.floor(a.yMin/this.accBinsSizeY);e<=Math.floor(a.yMax/this.accBinsSizeY);e++)if(!(0>e||e>=this.accBinsNumY)){var f=this.accBins[d][e],g=0;a:for(;g<f.length;g++){var k=f.data[g];if(k.graphicId!==b&&!H.has(k.id)){H.add(k.id);k=k.positions;this.accNumTests++;for(var l=0;2>l;l++){var h=0===l?c:k,p=0===l?k:c,n=0;b:for(;4>n;n++){var q=h[n],m=h[(n+1)%4],r=h[(n+2)%4];A[0]=m[0]-q[0];A[1]=m[1]-q[1];m=t.normalize(A);u=[-m[1],m[0]];m[0]=u[0];
m[1]=u[1];q=m[0]*q[0]+m[1]*q[1];r=m[0]*r[0]+m[1]*r[1]<q;for(u=0;4>u;u++){var v=p[u],v=m[0]*v[0]+m[1]*v[1];if(r&&v<q||!r&&v>q)continue b}continue a}}return!0}}}return!1;var u};b.prototype.initBins=function(a,b){if(null==this.accBins){this.accBins=[];for(var c=0;c<this.accBinsNumX;c++){this.accBins.push([]);for(var d=this.accBins[this.accBins.length-1],e=0;e<this.accBinsNumY;e++)d.push(new f(10))}}for(c=0;c<this.accBinsNumX;c++)for(e=0;e<this.accBinsNumY;e++)this.accBins[c][e].clear();this.accBinsSizeX=
a/this.accBinsNumX;this.accBinsSizeY=b/this.accBinsNumY;this.accNumTests=0};b.prototype.addToBins=function(a){for(var b=Math.floor(a.xMin/this.accBinsSizeX);b<=Math.floor(a.xMax/this.accBinsSizeX);b++)if(!(0>b||b>=this.accBinsNumX))for(var c=Math.floor(a.yMin/this.accBinsSizeY);c<=Math.floor(a.yMax/this.accBinsSizeY);c++)0>c||c>=this.accBinsNumY||this.accBins[b][c].push(a)};b.prototype.scheduleRun=function(a){var b=this;void 0===a&&(a=200);0===this.deconflictTimeoutId&&(this.deconflictTimeoutId=setTimeout(function(){return b.run()},
a))};b.prototype.run=function(){var a=this.view;if(a.ready){var b=a.navigation.targetCamera;this.clearDeconflictTimeout();this.graphicInfoPool.freeAll();this.nextGraphicInfoId=0;var c=b.fullWidth,d=b.fullHeight;g.prepare(a);J.clear();I.clear();for(var a=!1,e=0;e<this.graphicsOwners.length;e++){var f=this.graphicsOwners[e];if(null!=f.getGraphics3DGraphics&&null!=f.getGraphics3DGraphicsKeys){var k=null!=f.labelsEnabled&&f.labelsEnabled(),l=n(f.layer?f.layer.featureReduction:null);if(k||l){a||(this.initBins(c,
d),a=!0);for(var h=f.getGraphics3DGraphics(),p=f.getGraphics3DGraphicsKeys(),q=0;q<p.length;q++){var m=h[p[q]];m.areVisibilityFlagsSet(void 0,2)&&(l&&this._collectGraphics(m,!1,f,b,J,this.iconMarginFactor),k&&this._collectGraphics(m,!0,f,b,I))}}}}J.sort(function(a,b){return b.posView-a.posView});I.sort(function(a,b){return b.posView-a.posView});this._deconflictVisibleObjects(J,!1);I.length&&this._deconflictVisibleObjects(I,!0);g.drawAccelerationStruct(this,J);g.drawAccelerationStruct(this,I)}else this.setDirty()};
b.prototype._collectGraphics=function(a,b,c,d,e,f){void 0===f&&(f=0);var g=b?a._labelGraphics:a._graphics,l=b?1:0;if(g.length){b=k.set(D,k.NEGATIVE_INFINITY);for(var h,n,m,t=0;t<g.length;t++){var A=g[t];if(!A.isDraped()){var H=A.stageObject,F=H?H.getNumGeometryRecords():0;if(!(1>F)){var I=H.getGeometryRecord(0),J=I.materials[0];if(J instanceof q)if(1<F)x.warn("Graphic objects with more than 1 geometry record are not supported");else{F=I.geometry.getData().getVertexAttr();if(!n){n=H.getCenter();m=
I.origin.vec3;n=v.transformToWorld(n,m,r);n=v.transformToView(n,m,d.viewMatrix,z);J.applyVerticalOffsetTransformation(n,F[u.NORMAL].data,H.objectTransformation,d,L);H=F[u.AUXPOS1].data;F="screen"!==J.getParams().centerOffsetUnits;m=v.transformToProjection(n,d.projectionMatrix,F?H:[0,0,0],B);m=v.transformToNDC(m,C);F||(m[0]+=H[0]/d.fullWidth*2,m[1]+=H[1]/d.fullHeight*2);if(-1>m[0]||-1>m[1]||-1>m[2]||1<=m[0]||1<=m[1])break;h=n[2];a.areVisibilityFlagsSet(2,void 0,l)&&(h*=.7)}A=A.getScreenSize(M);p.applyPrecomputedScaleFactorVec2(A,
L.factor,A);J=k.offset(J.calculateRelativeScreenBounds(A,L.scaleAlignment,E),G(0,d.fullWidth,.5+.5*m[0]),G(0,d.fullHeight,.5+.5*m[1]));0!==f&&(A=f*Math.min(k.width(J),k.height(J)),J[0]-=A,J[1]-=A,J[2]+=A,J[3]+=A);k.expand(b,J)}}}}null!=h&&(d=this.graphicInfoPool.alloc(),d.id=this.nextGraphicInfoId++,d.graphicId=a.graphic.uid,d.xMin=b[0],d.yMin=b[1],d.xMax=b[2],d.yMax=b[3],d.positions[0][0]=b[0],d.positions[0][1]=b[1],d.positions[1][0]=b[0],d.positions[1][1]=b[3],d.positions[2][0]=b[2],d.positions[2][1]=
b[3],d.positions[3][0]=b[2],d.positions[3][1]=b[1],d.graphics3DGraphic=a,d.posView=h,d.graphicsOwner=c,e.push(d))}};b.prototype._deconflictVisibleObjects=function(a,b){for(var c=b?1:0,d=0;d<a.length;d++){var e=a.data[d],f=e.graphics3DGraphic,k=!(b&&!1===f.areVisibilityFlagsSet(2,void 0))&&!this.doesIntersectExistingPoly(e);k&&this.addToBins(e);f.setVisibilityFlag(2,k,c);g.drawPoly(e.positions,k?"green":"red")}};b.prototype._removeIconVisibilityFlags=function(a){if(null!=a.getGraphics3DGraphics&&null!=
a.getGraphics3DGraphicsKeys){var b=a.getGraphics3DGraphics(),c=0;for(a=a.getGraphics3DGraphicsKeys();c<a.length;c++)b[a[c]].setVisibilityFlag(2,void 0)}};return b}();var L={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},scaleAlignment:0,minPixelSizeAlignment:0},M=t.create();return b})},"esri/views/3d/layers/graphics/deconflictorDebug":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../lib/glMatrix","../../support/debugFlags"],function(m,h,d,c,a){function b(a,
b){if(f){var c=e.height,d=l;d.beginPath();d.lineWidth=1;d.strokeStyle=b;d.moveTo(a[0][0],c-a[0][1]);for(b=1;4>b;b++)d.lineTo(a[b][0],c-a[b][1]),d.stroke();d.lineTo(a[0][0],c-a[0][1]);d.stroke();d.closePath()}}Object.defineProperty(h,"__esModule",{value:!0});var k=c.vec2d,f=!1,g=!1,e,l;h.drawAccelerationStruct=function(a,c){if(g&&l){for(var d=l,e=[k.create(),k.create(),k.create(),k.create()],f=0,h=0;h<a.accBinsNumX;h++)for(var p=0;p<a.accBinsNumY;p++){var m=a.accBins[h][p],f=f+m.length,v=h*a.accBinsSizeX,
B=(h+1)*a.accBinsSizeX,C=p*a.accBinsSizeY,A=(p+1)*a.accBinsSizeY;e[0][0]=v;e[0][1]=C;e[1][0]=B;e[1][1]=C;e[2][0]=B;e[2][1]=A;e[3][0]=v;e[3][1]=A;d.fillText(m.length.toFixed(),v+5,C+15);b(e,"blue")}d.fillText("total totalShownLabels: "+f,70,40);d.fillText("total visible labels: "+c.length,70,50);d.fillText("total numTests: "+a.accNumTests,70,30)}};h.prepare=function(b){f=a.DECONFLICTOR_SHOW_OUTLINES;g=a.DECONFLICTOR_SHOW_GRID;if(f||g)null==e&&(e=document.createElement("canvas"),e.setAttribute("id",
"canvas2d"),b.surface.parentElement.style.position="relative",b.surface.parentElement.appendChild(e)),e.setAttribute("width",b.width+"px"),e.setAttribute("height",b.height+"px"),e.setAttribute("style","position:absolute;left:0px;top:0px;display:block;pointer-events:none;"),l=e.getContext("2d"),l.clearRect(0,0,b.width,b.height),l.font="8px Arial"};h.drawPoly=b})},"esri/views/3d/layers/GraphicsView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../layers/GraphicsView ./graphics/Graphics3DCore ./graphics/Graphics3DSpatialIndex ./graphics/Graphics3DElevationAlignment ../support/PromiseLightweight ../../../core/promiseUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){m=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.graphicsCore=null;b.spatialIndex=null;b.elevation=null;b.supportsDraping=!0;b._overlayUpdating=!1;b._eventHandles=[];return b}d(b,a);Object.defineProperty(b.prototype,"graphics",{set:function(a){a!==this.loadedGraphics&&(this.loadedGraphics=a);this._set("graphics",a)},enumerable:!0,configurable:!0});b.prototype.initialize=function(){var a=this;this.mockLayerId="__sceneView.graphics-"+Date.now().toString(16);
this.spatialIndex=new f;this.spatialIndex.whenLoaded().then(function(){return a.deferredInitialize()})};b.prototype.deferredInitialize=function(){var a=this;if(!this.destroyed){this.loadedGraphics=this.graphics;this.graphicsCore=new k;this.elevation=new g;var b={id:this.mockLayerId};this.spatialIndex.initialize(this,b,this.view.spatialReference,this.graphicsCore);this.elevation.initialize(this,function(b,c,d){a.spatialIndex.intersects(b,c,d)},this.graphicsCore,this.view.elevationProvider);this.graphicsCore.initialize(this,
b,this.elevation,null,this.spatialIndex,null,null,null,null,this.view.basemapTerrain);this._eventHandles.push(this.view.watch("clippingArea",function(){return a.updateClippingExtent()}));this.updateClippingExtent();this.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate})}};b.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=null;this.view.resourceController.deregisterIdleFrameWorker(this);
this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.elevation&&(this.elevation.destroy(),this.elevation=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.loadedGraphics=null};b.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===c?(d=a,!0):!1});a=new e.Promise;null!==d?a.done(d):a.reject();return a};b.prototype.whenGraphicBounds=function(a){var b=
this;return this.spatialIndex?this.spatialIndex.whenLoaded().then(function(){return b.graphicsCore?b.graphicsCore.whenGraphicBounds(a):l.reject()}):l.reject()};b.prototype._needsIdleUpdate=function(){return this.elevation.needsIdleUpdate()};b.prototype._idleUpdate=function(a){this.elevation.idleUpdate(a)};b.prototype._notifySuspendedChange=function(){};b.prototype._notifyDrapedDataChange=function(){this.view.basemapTerrain&&this.view.basemapTerrain.overlayManager.setOverlayDirty()};b.prototype._evaluateUpdatingState=
function(){if(this.elevation){var a;a=0+this.elevation.numNodesUpdating();a+=this.graphicsCore.numNodesUpdating();this.updating=a=(a=(a=0<a||this._overlayUpdating)||this.spatialIndex.isUpdating())||this.graphicsCore.needsIdleUpdate()}else this.updating=!1};b.prototype.updateClippingExtent=function(){this.graphicsCore.setClippingExtent(this.view.clippingArea,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()};return b}(a.declared(b));c([a.property()],m.prototype,"graphics",null);
c([a.property()],m.prototype,"loadedGraphics",void 0);c([a.property({value:!0})],m.prototype,"updating",void 0);c([a.property({value:!1})],m.prototype,"suspended",void 0);return m=c([a.subclass("esri.views.3d.layers.GraphicsView3D")],m)})},"esri/views/layers/GraphicsView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Collection ../../Graphic".split(" "),function(m,
h,d,c,a,b,k,f){m=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.graphics=null;b.renderer=null;b.view=null;return b}d(b,a);return b}(a.declared(b));c([a.property({type:k.ofType(f)})],m.prototype,"graphics",void 0);c([a.property()],m.prototype,"renderer",void 0);c([a.property()],m.prototype,"view",void 0);return m=c([a.subclass("esri.views.layers.GraphicsView")],m)})},"esri/views/3d/layers/graphics/Graphics3DCore":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/watchUtils ../../../../core/arrayUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../support/projectionUtils ../../../../renderers/UniqueValueRenderer ../../../../renderers/support/rendererConversion ../../../../renderers/support/diffUtils ../../../../geometry/Point ../../../../geometry/Extent ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Layer ../../webgl-engine/lib/FloatingBoxLocalOriginFactory ../../../../symbols/WebStyleSymbol ../../../../symbols/LabelSymbol3D ../../../../symbols/TextSymbol ../../../../symbols/support/symbolConversion ../../lib/glMatrix ./Graphics3DGraphic ./Graphics3DWebStyleSymbol ./graphicUtils ./Graphics3DSymbolFactory ./Graphics3DOwner ./ElevationQuery ../../support/aaBoundingBox ../../support/mathUtils dojo/Deferred".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I,F,N,L,M){m=D.vec3d;var K=new q,ba=m.create(),X=f.getLogger("esri.views.3d.LayerView3D");f=function(){function f(){this.graphics={};this.graphicsDrapedIds={};this.graphicsBySymbol={};this.graphicsKeys=[];this.symbols={};this.graphicsWithoutSymbol={};this.computedExtent=null;this.symbolCreationContext=new I.Graphics3DSymbolCreationContext;this.hasDraped=!1;this.updatingGraphicIds=new Set;this.graphicTransformFunc=this.onComputedExtentChange=
this.stage=this.labelStageLayer=this.stageLayer=this.tilingSchemeHandle=this.lastFastUpdate=null;this.eventHandles=[];this.sharedSymbolResourcesOwnerHandle=this.highlights=this.elevationQueryService=this.labeling=this.spatialIndex=this.scaleVisibility=this.elevation=this.layer=this.layerView=this.viewSR=null;this.whenGraphics3DGraphicRequests={}}f.prototype.initialize=function(b,c,d,e,g,k,l,h,p,n){var q=this;this.layerView=b;this.layer=c;this.viewSR=b.view.spatialReference;this.elevation=d;this.scaleVisibility=
e;this.spatialIndex=g;this.labeling=k;this.highlights=l;this.onComputedExtentChange=h;this.graphicTransformFunc=p;var m=this.layerView.view;this.elevationQueryService=new F.ElevationQuery(this.viewSR,function(){return m.map.ground},{maximumAutoTileRequests:4});this.initializeStage(m,this.layer.id);this.symbolCreationContext.sharedResources=m.sharedSymbolResources;this.sharedSymbolResourcesOwnerHandle=m.sharedSymbolResources.addGraphicsOwner(this);this.symbolCreationContext.renderer=this.layer.renderer;
this.symbolCreationContext.stage=this.stage;this.symbolCreationContext.streamDataSupplier=m.sharedSymbolResources.streamDataSupplier;this.symbolCreationContext.renderSpatialReference=m.renderSpatialReference;this.symbolCreationContext.renderCoordsHelper=m.renderCoordsHelper;this.symbolCreationContext.layer=this.layer;this.symbolCreationContext.layerView=this.layerView;this.symbolCreationContext.layerOrder=0;this.symbolCreationContext.localOriginFactory=f.createLocalOriginFactory();this.symbolCreationContext.elevationProvider=
m.elevationProvider;m.deconflictor.addGraphicsOwner(this);this.symbolCreationContext.screenSizePerspectiveEnabled=m.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled;this.tilingSchemeHandle=a.when(n,"tilingScheme",function(a){a.spatialReference.equals(q.symbolCreationContext.overlaySR)||(q.symbolCreationContext.overlaySR=n.spatialReference,q.recreateAllGraphics())});this.eventHandles.push(this.layerView.watch("suspended",function(){return q.suspendedChange()}));this.eventHandles.push(this.layerView.watch("layer.screenSizePerspectiveEnabled,view.screenSizePerspectiveEnabled",
function(){q.symbolCreationContext.screenSizePerspectiveEnabled=m.screenSizePerspectiveEnabled&&q.layer.screenSizePerspectiveEnabled;q.recreateAllGraphics()}));this.eventHandles.push(a.on(b,"loadedGraphics","change",function(a){return q.graphicsCollectionChanged(a)},function(){q.clearSymbolsAndGraphics();q.graphicsCollectionChanged({added:q.layerView.loadedGraphics.toArray(),removed:[]})}));this.validateRenderer(this.layer.renderer)};f.prototype.destroy=function(){var a=this;this.layerView.view.deconflictor.removeGraphicsOwner(this);
this.clear();if(this.stage){var b=[this.stageLayer.getId()];this.labelStageLayer&&b.push(this.labelStageLayer.getId());this.stage.removeFromViewContent(b);b.forEach(function(b){return a.stage.remove(t.ModelContentType.LAYER,b)});this.stage=this.labelStageLayer=this.stageLayer=null}this.tilingSchemeHandle&&(this.tilingSchemeHandle.remove(),this.tilingSchemeHandle=null);this.eventHandles.forEach(function(a){return a.remove()});this.layerView=this.labeling=this.scaleVisibility=this.viewSR=this.onComputedExtentChange=
this.eventHandles=null;for(var c in this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[c].reject(new k("graphic:layer-destroyed","Layer has been destroyed"));this.whenGraphics3DGraphicRequests=null;this.sharedSymbolResourcesOwnerHandle&&(this.sharedSymbolResourcesOwnerHandle.remove(),this.sharedSymbolResourcesOwnerHandle=null)};f.prototype.clear=function(){var a=!1,b;for(b in this.graphics){var c=this.graphics[b],a=a||c.isDraped();c.destroy()}this.graphics={};this.graphicsKeys=
null;for(var d in this.symbols)(b=this.symbols[d])&&b.destroy();this.symbols={};this.graphicsBySymbol={};this.graphicsWithoutSymbol={};this.hasDraped=!1;a&&this.layerView._notifyDrapedDataChange()};f.prototype.initializeStage=function(a,b){this.stage=a._stage;this.stageLayer=new x(b,{state:this.layerView.suspended?"HIDDEN":"VISIBLE"},b);this.stage.add(t.ModelContentType.LAYER,this.stageLayer);a=[this.stageLayer.getId()];this.labeling&&(this.labelStageLayer=new x(b,{state:this.layerView.suspended?
"HIDDEN":"IGNORED"},b+"_labels"),this.stage.add(t.ModelContentType.LAYER,this.labelStageLayer),a.push(this.labelStageLayer.getId()));this.stage.addToViewContent(a)};f.prototype.setDrawingOrder=function(a){this.symbolCreationContext.layerOrder=a;var b={},c={},d;for(d in this.graphics)this.graphics[d].setDrawOrder(a,b,c);for(var e in c)(c=this.symbols[e])&&c.setDrawOrder(a,b);u.objectEmpty(b)||(this.stage.getTextureGraphicsRenderer().updateRenderOrder(b),this.layerView._notifyDrapedDataChange())};f.prototype.suspendedChange=
function(){!0===this.layerView.suspended?(this.stageLayer.setState("HIDDEN"),this.labelStageLayer&&this.labelStageLayer.setState("HIDDEN"),this.hideAllGraphics()):!1===this.layerView.suspended&&(this.stageLayer.setState("VISIBLE"),this.labelStageLayer&&this.labelStageLayer.setState("IGNORED"),this.updateAllGraphicsVisibility())};f.prototype.getGraphics3DGraphics=function(){return this.graphics};f.prototype.getGraphics3DGraphicById=function(a){return this.graphics[a]};f.prototype.getGraphics3DGraphicsKeys=
function(){null===this.graphicsKeys&&(this.graphicsKeys=Object.keys(this.graphics));return this.graphicsKeys};f.prototype.labelsEnabled=function(){return!(!this.labeling||!this.labeling.layerLabelsEnabled())};f.prototype.getSymbolUpdateType=function(){var a=0,b=0,c=0,d;for(d in this.symbols){var e=this.symbols[d];e&&(e=e.getFastUpdateStatus(),a+=e.loading,c+=e.fast,b+=e.slow)}return 0<a?"unknown":0<=c&&0===b?"fast":0<=b&&0===c?"slow":"mixed"};f.prototype.numNodesUpdating=function(){return this.updatingGraphicIds.size};
f.prototype.needsIdleUpdate=function(){return!!this.lastFastUpdate&&500<performance.now()-this.lastFastUpdate};f.prototype.idleUpdate=function(a){a.done()||(this.lastFastUpdate&&(this.labeling&&this.labeling.updateLabelingInfo(),this.lastFastUpdate=null),this.layerView._evaluateUpdatingState())};f.prototype.whenGraphics3DGraphic=function(a){var b=this.graphics[a.uid];if(b)return g.resolve(b);b=this.whenGraphics3DGraphicRequests[a.uid];b||(b=new M,this.whenGraphics3DGraphicRequests[a.uid]=b);return b.promise};
f.prototype.boundsForGraphics3DGraphic=function(a){return c(this,void 0,void 0,function(){var b,c,f,g,k,l,h,p,n;return d(this,function(d){switch(d.label){case 0:return b=this.layerView.view.spatialReference,c=this.layerView.view.renderSpatialReference,f=this.layerView.view.basemapTerrain.spatialReference,g=function(a,d,f){return e.bufferToBuffer(a,c,d,a,b,d,f)},k=function(a,c,d){return e.bufferToBuffer(a,f,c,a,b,c,d)},[4,a.getProjectedBoundingBox(g,k,this.elevationQueryService)];case 1:l=d.sent();
if(!l)return[2,null];h=l.boundingBox;l.requiresDrapedElevation&&(p=this.symbolCreationContext.elevationProvider)&&(N.center(h,ba),K.x=ba[0],K.y=ba[1],K.z=void 0,K.spatialReference=b,n=p.getElevation(K)||0,h[2]=Math.min(h[2],n),h[5]=Math.max(h[5],n));return[2,{boundingBox:h,screenSpaceObjects:l.screenSpaceObjects}]}})})};f.prototype.whenGraphicBounds=function(b){var c=this;return a.whenOnce(this.layerView,"loadedGraphics").then(function(){var a=c.layerView.layer&&c.layerView.layer.objectIdField,d=
c.layerView.loadedGraphics.find(function(c){return c===b||a&&c.attributes&&b.attributes&&c.attributes[a]===b.attributes[a]?!0:!1});if(d)return c.whenGraphics3DGraphic(d);throw new k("internal:graphic-not-part-of-view","Graphic is not part of this view");}).then(function(a){return c.boundsForGraphics3DGraphic(a)})};f.prototype.graphicsCollectionChanged=function(a){var b=this.graphicTransformFunc?this.graphicTransformFunc(a.added):a.added;this.add(b);this.remove(a.removed)};f.prototype.graphicUpdateHandler=
function(a){var b=this.graphics[a.graphic.uid];if(b)switch(a.property){case "visible":b.setVisibilityFlag(0,a.newValue)&&(b.isDraped()&&this.layerView._notifyDrapedDataChange(),this.labeling&&this.layerView.view.deconflictor.setDirty())}};f.prototype.beginGraphicUpdate=function(a){this.updatingGraphicIds.add(a.uid);this.layerView.get("symbolsUpdating")||this.layerView.set("symbolsUpdating",!0);this.layerView._evaluateUpdatingState()};f.prototype.endGraphicUpdate=function(a){a&&this.updatingGraphicIds.delete(a.uid);
this.layerView.get("symbolsUpdating")&&0===this.updatingGraphicIds.size&&(this.layerView.view.flushDisplayModifications(),this.layerView.set("symbolsUpdating",!1));this.layerView._evaluateUpdatingState()};f.prototype.expandComputedExtent=function(a){var b,c,d,g,k,l;if("point"===a.type)b=c=a.x,d=g=a.y,a.z&&(k=l=a.z);else if("polygon"===a.type||"polyline"===a.type||"multipoint"===a.type){l=a.extent;if(!l)return;b=l.xmin;c=l.xmax;d=l.ymin;g=l.ymax;k=l.zmin;l=l.zmax}var h=this.viewSR,p=f.tmpVec;!a.spatialReference.equals(h)&&
e.xyzToVector(b,d,0,a.spatialReference,p,h)&&(b=p[0],d=p[1],e.xyzToVector(c,g,0,a.spatialReference,p,h),c=p[0],g=p[1]);if(L.isFinite(b)&&L.isFinite(c)&&L.isFinite(d)&&L.isFinite(g)){(h=this.computedExtent)?(b<h.xmin&&(h.xmin=b),c>h.xmax&&(h.xmax=c),d<h.ymin&&(h.ymin=d),g>h.ymax&&(h.ymax=g)):this.computedExtent=h=new n(b,d,c,g,a.spatialReference);if(L.isFinite(k)&&!L.isFinite(l)){if(null==h.zmin||k<h.zmin)h.zmin=k;if(null==h.zmax||l>h.zmax)h.zmax=l}this.onComputedExtentChange&&this.onComputedExtentChange()}};
f.prototype.updateHasDraped=function(){this.hasDraped=!1;for(var a in this.graphicsDrapedIds)if(this.graphicsDrapedIds.hasOwnProperty(a)){this.hasDraped=!0;break}};f.prototype.elevationInfoChange=function(){this.labeling&&this.labeling.elevationInfoChange();this.layer.renderer!==this.symbolCreationContext.renderer&&this.rendererChange(this.layer.renderer);for(var a in this.graphicsBySymbol){var b=this.symbols[a],c=this.graphicsBySymbol[a];if(b&&b.layerPropertyChanged("elevationInfo",c))for(var d in c){var e=
c[d],b=e.graphic,e=e._labelGraphics;this.elevation&&this.elevation.markGraphicElevationDirty(b.uid);for(var f=0;f<e.length;f++){var g=e[f];g.graphics3DSymbolLayer.updateGraphicElevationInfo(b,g)}}else this._recreateSymbol(a)}};f.prototype.clearSymbolsAndGraphics=function(){this.clear();this.elevation&&this.elevation.clear();this.labeling&&this.labeling.clear()};f.prototype.recreateAllGraphics=function(){this.clearSymbolsAndGraphics();this.computedExtent=null;this.onComputedExtentChange&&this.onComputedExtentChange();
this.layerView.loadedGraphics&&this.layerView.view.basemapTerrain.tilingScheme&&this.add(this.layerView.loadedGraphics.toArray())};f.prototype._recreateSymbol=function(a){var b=this.graphicsBySymbol[a],c=[],d=!1,e;for(e in b){var f=b[e];f.isDraped()&&(delete this.graphicsDrapedIds[e],d=!0);c.push(f.graphic);f.destroy();delete this.graphics[e]}this.graphicsBySymbol[a]={};(b=this.symbols[a])&&b.destroy();delete this.symbols[a];this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();this.add(c)};
f.prototype.add=function(a){if(this.layerView.view.basemapTerrain&&this.layerView.view.basemapTerrain.tilingScheme){for(var b=a.length,c=Array(b),d=Array(b),e=Array(b),f=0;f<b;f++){var g=a[f],k=g.geometry;k&&(this.expandComputedExtent(k),(k=this.layerView.getRenderingInfo?this.layerView.getRenderingInfo(g):{symbol:g.symbol})&&k.symbol?(d[f]=k.symbol,e[f]=k,(k=this.getOrCreateGraphics3DSymbol(d[f],k.renderer))?(c[f]=k,this.beginGraphicUpdate(g)):this.graphicsWithoutSymbol[g.uid]=g):this.graphicsWithoutSymbol[g.uid]=
g)}for(f=0;f<b;f++)this.waitForSymbol(c[f],d[f],a[f],e[f])}};f.prototype.waitForSymbol=function(a,b,c,d){var e=this;a&&a.then(function(){e.createGraphics3DGraphic(a,c,d);e.endGraphicUpdate(c);e.labeling&&e.layerView.view.deconflictor.setDirty()},function(){e.endGraphicUpdate(c)})};f.prototype.remove=function(a){for(var b=!1,c=a.length,d=0;d<c;d++){var e=a[d].uid,f=this.graphics[e];if(f){f.isDraped()&&(delete this.graphicsDrapedIds[e],b=!0);var g=f.graphics3DSymbol.symbol.id;f.destroy();delete this.graphics[e];
delete this.graphicsBySymbol[g][e];delete this.graphicsWithoutSymbol[e];this.graphicsKeys=null}}this.updateHasDraped();b&&this.layerView._notifyDrapedDataChange();this.layerView.view.deconflictor.setDirty()};f.prototype.hasLabelingContext=function(a){if(a instanceof B||a instanceof C){var b=this.symbolCreationContext.layer;return b.labelingInfo?b.labelingInfo.some(function(b){return b.symbol===a}):!1}return!1};f.prototype.hasValidSymbolCreationContext=function(a){return a instanceof B&&!this.hasLabelingContext(a)?
(X.error("LabelSymbol3D is only valid as part of a LabelClass. Using LabelSymbol3D as a renderer symbol is not supported."),!1):!0};f.prototype.createGraphics3DSymbol=function(a,b){if(!this.hasValidSymbolCreationContext(a))return null;a=A.to3D(a,!0,!1,this.hasLabelingContext(a));if(a.symbol){var c=void 0;b&&b.backgroundFillSymbol&&(b=A.to3D(b.backgroundFillSymbol,!1,!0),b.symbol&&(c=b.symbol.symbolLayers));return J.make(a.symbol,this.symbolCreationContext,c)}return null};f.prototype.getOrCreateGraphics3DSymbol=
function(a,b){var c=this,d=this.symbols[a.id];void 0===d&&(d=a instanceof z?new H(a,function(a){return c.createGraphics3DSymbol(a,b)}):this.createGraphics3DSymbol(a,b),this.symbols[a.id]=d);return d};f.prototype.createGraphics3DGraphic=function(a,b,c){if(!this.symbols[a.symbol.id])this.add([b]);else if(!this.graphics[b.uid]){c=a.createGraphics3DGraphic(b,c);this.graphics[b.uid]=c;this.graphicsKeys=null;this.graphicsBySymbol[a.symbol.id]||(this.graphicsBySymbol[a.symbol.id]={});this.graphicsBySymbol[a.symbol.id][b.uid]=
c;c.initialize(this.stageLayer,this.stage);c.isDraped()&&(this.hasDraped=this.graphicsDrapedIds[b.uid]=!0,this.layerView._notifyDrapedDataChange());c.centroid=null;"point"!==b.geometry.type&&c instanceof E&&(c.centroid=G.computeCentroid(b.geometry,this.viewSR));a=this.scaleVisibility&&this.scaleVisibility.scaleRangeActive();this.spatialIndex&&this.spatialIndex.shouldAddToSpatialIndex(b,c,a)&&this.spatialIndex.addGraphicToSpatialIndex(b,c);this.labeling&&this.labeling.layerLabelsEnabled()&&this.labeling.createLabelsForGraphic(b,
c);a&&this.scaleVisibility.updateGraphicScaleVisibility(b,c);c.setVisibilityFlag(0,b.visible&&!this.layerView.suspended);if(a=this.whenGraphics3DGraphicRequests[b.uid])delete this.whenGraphics3DGraphicRequests[b.uid],a.resolve(c);this.highlights&&this.highlights.graphicCreated(c)}};f.prototype.rendererChange=function(a){var b=this.symbolCreationContext.renderer;if(a!==b){this.validateRenderer(a);var c=v.diff(b,a);this.updateUnchangedSymbolMappings(c,a,b);this.symbolCreationContext.renderer=a;c&&("complete"===
c.type?this.recreateAllGraphics():"partial"===c.type&&(this.applyRendererDiff(c,a,b)?this.volatileGraphicsUpdated():this.recreateAllGraphics()))}};f.prototype.diffHasSymbolChange=function(a){for(var b in a.diff)switch(b){case "visualVariables":break;case "defaultSymbol":break;case "uniqueValueInfos":break;case "authoringInfo":case "fieldDelimiter":delete a.diff[b];break;default:return!0}return!1};f.prototype.applySymbolSetDiff=function(a,b,c,d){d=!1;a=a||[];b=b||[];for(var e=[],f=0;f<b.length;f++){var g=
b[f],k=this.graphicsBySymbol[g.id],l;for(l in k){var h=k[l],p=h.graphic;if(g!==c.defaultSymbol||c.getSymbol(p)!==c.defaultSymbol)h.isDraped()&&(delete this.graphicsDrapedIds[l],d=!0),a.length||c.defaultSymbol?e.push(p):this.graphicsWithoutSymbol[l]=p,h.destroy(),this.highlights&&this.highlights.graphicDeleted(this.graphics[l]),delete k[l],delete this.graphics[l],this.graphicsKeys=null}if(void 0===k||0===Object.keys(k).length)delete this.graphicsBySymbol[g.id],(k=this.symbols[g.id])&&k.destroy(),delete this.symbols[g.id]}if(a.length||
e.length){for(l in this.graphicsWithoutSymbol)e.push(this.graphicsWithoutSymbol[l]);this.graphicsWithoutSymbol={};this.add(e)}this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();this.layerView.view.deconflictor.setDirty()};f.prototype.applyUniqueValueRendererDiff=function(a,b,c){var d=a.diff.defaultSymbol,e=a.diff.uniqueValueInfos;if(d||e){var f=e?e.added.map(function(a){return a.symbol}):[],g=e?e.removed.map(function(a){return a.symbol}):[];if(e)for(var k=0;k<e.changed.length;k++)f.push(e.changed[k].newValue.symbol),
g.push(e.changed[k].oldValue.symbol);d?(c.defaultSymbol&&g.push(c.defaultSymbol),b.defaultSymbol&&f.push(b.defaultSymbol)):c.defaultSymbol&&f.length&&g.push(b.defaultSymbol);this.applySymbolSetDiff(f,g,b,c);delete a.diff.defaultSymbol;delete a.diff.uniqueValueInfos;return!0}return!1};f.prototype.calculateUnchangedSymbolMapping=function(a,b,c){if(b instanceof l&&c instanceof l)if(!a){if(c&&c.defaultSymbol)return[{oldId:c.defaultSymbol.id,newId:b.defaultSymbol.id}]}else if("partial"===a.type){var d=
a.diff;a=d.defaultSymbol;var d=d.uniqueValueInfos,e=void 0,e=d?d.unchanged.map(function(a){return{oldId:a.oldValue.symbol.id,newId:a.newValue.symbol.id}}):c.uniqueValueInfos.map(function(a,c){return{oldId:a.symbol.id,newId:b.uniqueValueInfos[c].symbol.id}});!a&&c.defaultSymbol&&e.push({oldId:c.defaultSymbol.id,newId:b.defaultSymbol.id});return e}return[]};f.prototype.updateUnchangedSymbolMappings=function(a,b,c){var d=0;for(a=this.calculateUnchangedSymbolMapping(a,b,c);d<a.length;d++)if(c=a[d],b=
c.oldId,c=c.newId,b&&b!==c){var e=this.graphicsBySymbol[b];delete this.graphicsBySymbol[b];void 0!==e&&(this.graphicsBySymbol[c]=e);e=this.symbols[b];delete this.symbols[b];void 0!==e&&(this.symbols[c]=e,e.symbol.id=c)}};f.prototype.applyRendererDiff=function(a,b,c){var d=!1;if(this.diffHasSymbolChange(a))return!1;if(b instanceof l&&c instanceof l&&this.applyUniqueValueRendererDiff(a,b,c)&&0===Object.keys(a.diff).length)return!0;for(var e in this.graphicsBySymbol)if(c=this.symbols[e]){var f=this.graphicsBySymbol[e];
if(!c.applyRendererDiff(a,b,f))return!1;if(!d)for(var g in f)if(f[g].isDraped()){this.layerView._notifyDrapedDataChange();d=!0;break}}return!0};f.prototype.opacityChange=function(){var a=!1,b;for(b in this.graphicsBySymbol){var c=this.symbols[b];if(c){var d=this.graphicsBySymbol[b];c.layerPropertyChanged("opacity");if(!a)for(var e in d)if(d[e].isDraped()){this.layerView._notifyDrapedDataChange();a=!0;break}}}};f.prototype.setClippingExtent=function(a,c){var d=this.symbolCreationContext.clippingExtent,
f=[];e.extentToBoundingRect(a,f,c)?this.symbolCreationContext.clippingExtent=[f[0],f[1],-Infinity,f[2],f[3],Infinity]:this.symbolCreationContext.clippingExtent=null;return!b.equals(this.symbolCreationContext.clippingExtent,d)};f.prototype.forEachGraphics3DGraphic=function(a){var b=this;if(this.layerView.loadedGraphics){var c=!1,d=!1;this.layerView.loadedGraphics.forEach(function(e){var f=b.getGraphics3DGraphicById(e.uid);f&&a(f,e)&&(c=!0,d=d||f.isDraped())});c&&this.layerView.view.deconflictor.setDirty();
d&&this.layerView._notifyDrapedDataChange()}};f.prototype.updateAllGraphicsVisibility=function(){var a=this;this.forEachGraphics3DGraphic(function(b,c){var d=b.setVisibilityFlag(0,c.visible),e=!1;a.scaleVisibility&&(e=a.scaleVisibility.updateGraphicScaleVisibility(c,b));return d||e})};f.prototype.hideAllGraphics=function(){this.forEachGraphics3DGraphic(function(a){return a.setVisibilityFlag(0,!1)})};f.prototype.validateRenderer=function(a){(a=p.validateTo3D(a))&&X.warn("Renderer for layer '"+(this.layer.title?
this.layer.title+", ":"")+", id:"+this.layer.id+"' is not supported in a SceneView",a.message)};f.prototype.volatileGraphicsUpdated=function(){this.labeling&&(this.lastFastUpdate=performance.now());this.stageLayer.invalidateSpatialQueryAccelerator();this.stageLayer.shaderTransformationChanged();this.layerView._evaluateUpdatingState()};f.createLocalOriginFactory=function(){return new r(5E6,16)};f.prototype.snapshotInternals=function(){var a=this;return{graphics:Object.keys(this.graphics).sort(),symbols:Object.keys(this.symbols).sort(),
graphicsBySymbol:Object.keys(this.graphicsBySymbol).sort().map(function(b){return{symbolId:b,graphics:Object.keys(a.graphicsBySymbol[b]).sort()}}),graphicsWithoutSymbol:Object.keys(this.graphicsWithoutSymbol).sort(),graphicsDrapedIds:Object.keys(this.graphicsDrapedIds).sort()}};return f}();f.tmpVec=D.vec3d.create();return f})},"esri/core/tsSupport/generatorHelper":function(){define([],function(){return function(m,h){function d(a){return function(b){return c([a,b])}}function c(c){if(b)throw new TypeError("Generator is already executing.");
for(;a;)try{if(b=1,k&&(f=k[c[0]&2?"return":c[0]?"throw":"next"])&&!(f=f.call(k,c[1])).done)return f;if(k=0,f)c=[0,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++;k=c[1];c=[0];continue;case 7:c=a.ops.pop();a.trys.pop();continue;default:if(!(f=a.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){a=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))a.label=c[1];else if(6===c[0]&&a.label<f[1])a.label=f[1],f=c;else if(f&&a.label<f[2])a.label=
f[2],a.ops.push(c);else{f[2]&&a.ops.pop();a.trys.pop();continue}}c=h.call(m,a)}catch(l){c=[6,l],k=0}finally{b=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},b,k,f,g;return g={next:d(0),"throw":d(1),"return":d(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g}})},"esri/core/tsSupport/awaiterHelper":function(){define(["dojo/Deferred","dojo/when"],function(m,h){return function(d,
c,a,b){function k(a){try{g(b.next(a))}catch(p){e.reject(p)}}function f(a){try{g(b["throw"](a))}catch(p){e.reject(p)}}function g(a){a.done?h(a.value).then(e.resolve,e.reject):h(a.value).then(k,f)}var e=new m;g((b=b.apply(d,c||[])).next());return e.promise}})},"esri/renderers/support/rendererConversion":function(){define(["require","exports","../../core/Error","../../symbols/support/symbolConversion"],function(m,h,d,c){function a(a,b){if(!b)return null;b=Array.isArray(b)?b:[b];if(0<b.length){var c=
b.map(function(a){return a.details.symbol.type||a.details.symbol.declaredClass}).filter(function(a){return!!a});c.sort();var f=[];c.forEach(function(a,b){0!==b&&a===c[b-1]||f.push(a)});return new d("renderer-conversion-3d:unsupported-symbols","Renderer contains symbols ("+f.join(", ")+") which are not supported in 3D",{renderer:a,symbolErrors:b})}return null}function b(b){var d=b.uniqueValueInfos.map(function(a){return c.to3D(a.symbol).error}).filter(function(a){return!!a}),e=c.to3D(b.defaultSymbol);
e.error&&d.unshift(e.error);return a(b,d)}function k(b){var d=b.classBreakInfos.map(function(a){return c.to3D(a.symbol).error}).filter(function(a){return!!a}),e=c.to3D(b.defaultSymbol);e.error&&d.unshift(e.error);return a(b,d)}Object.defineProperty(h,"__esModule",{value:!0});h.validateTo3D=function(f){return f?"simple"===f.type?a(f,c.to3D(f.symbol).error):"uniqueValue"===f.type?b(f):"classBreaks"===f.type?k(f):new d("renderer-conversion-3d:unsupported-renderer","Unsupported renderer of type '"+(f.type||
f.declaredClass)+"'",{renderer:f}):null}})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports dojo/has ./IdGen ./Octree ./PerformanceTimer ./Util ./gl-matrix ./ModelContentType".split(" "),function(m,h,d,c,a,b,k,f,g){var e=f.vec3d;m=function(){function b(a,c,d){this._parentStages=[];this._children=[];this.id=b._idGen.gen(d);this.name=a;c=c||{};this.group=c.group||"";this.state=c.state||"VISIBLE";this.interaction=c.interaction||"PICKABLE";this.translation=e.create(c.translation);
this._extent=[e.createFrom(0,0,0),e.createFrom(1E3,1E3,1E3)];this._extentDirty=!0}b.prototype.getId=function(){return this.id};b.prototype.getParentStages=function(){return this._parentStages};b.prototype.addParentStage=function(a){-1===this._parentStages.indexOf(a)&&this._parentStages.push(a)};b.prototype.removeParentStage=function(a){a=this._parentStages.indexOf(a);-1<a&&this._parentStages.splice(a,1)};b.prototype.getName=function(){return this.name};b.prototype.getGroup=function(){return this.group};
b.prototype.getState=function(){return this.state};b.prototype.getInteraction=function(){return this.interaction};b.prototype.getTranslation=function(){return this.translation};b.prototype.getObjectIds=function(){return this._children.map(function(a){return a.getId()})};b.prototype.getObjects=function(){return this._children};b.prototype.setState=function(a){this.state=a};b.prototype.getExtent=function(){this._updateExtent();return this._extent};b.prototype.addObject=function(a){this._children.push(a);
a.addParentLayer(this);this.notifyDirty("layObjectAdded",a);this._invalidateExtent();this._spatialAccelerator&&this._spatialAccelerator.add(a)};b.prototype.hasObject=function(a){return-1<this._children.indexOf(a)};b.prototype.removeObject=function(a){return null!=k.arrayRemove(this._children,a)?(a.removeParentLayer(this),this.notifyDirty("layObjectRemoved",a),this._invalidateExtent(),this._spatialAccelerator&&this._spatialAccelerator.remove(a),!0):!1};b.prototype.replaceObject=function(a,b){var c=
this._children.indexOf(a);k.assert(-1<c,"Layer.replaceObject: layer doesn't contain specified object");this._children[c]=b;a.removeParentLayer(this);b.addParentLayer(this);this.notifyDirty("layObjectReplaced",[a,b]);this._invalidateExtent();this._spatialAccelerator&&(this._spatialAccelerator.remove(a),this._spatialAccelerator.add(b))};b.prototype.notifyObjectBBChanged=function(a,b){this._spatialAccelerator&&this._spatialAccelerator.update(a,b)};b.prototype.getCenter=function(){this._updateExtent();
var a=e.create();return e.lerp(this._extent[0],this._extent[1],.5,a)};b.prototype.getBSRadius=function(){this._updateExtent();return.5*e.dist(this._extent[0],this._extent[1])};b.prototype.getSpatialQueryAccelerator=function(){if(this._spatialAccelerator)return this._spatialAccelerator;if(50<this._children.length)return this._createOctree(),this._spatialAccelerator};b.prototype.shaderTransformationChanged=function(){this.notifyDirty("shaderTransformationChanged",null)};b.prototype.invalidateSpatialQueryAccelerator=
function(){this._spatialAccelerator=null};b.prototype.notifyDirty=function(a,b,c,d){c=c||g.LAYER;d=d||this;for(var e=0;e<this._parentStages.length;e++)this._parentStages[e].notifyDirty(c,d,a,b)};b.prototype._createOctree=function(){for(var b=this.getExtent(),c=0,d=0;3>d;d++)c=Math.max(c,b[1][d]-b[0][d]);d=e.create();e.lerp(b[0],b[1],.5,d);this._spatialAccelerator=new a(d,1.2*c);this._spatialAccelerator.add(this._children)};b.prototype._invalidateExtent=function(){this._extentDirty=!0};b.prototype._updateExtent=
function(){if(this._extentDirty)if(0===this._children.length)this._extent=[[0,0,0],[0,0,0]];else{var a=this._children[0];this._extent=[e.create(a.getBBMin()),e.create(a.getBBMax())];for(a=0;a<this._children.length;++a)for(var b=this._children[a],c=b.getBBMin(),b=b.getBBMax(),d=0;3>d;++d)this._extent[0][d]=Math.min(this._extent[0][d],c[d]),this._extent[1][d]=Math.max(this._extent[1][d],b[d]);this._extentDirty=!1}};return b}();m._idGen=new c;return m})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ./gl-matrix ./Util dojo/has ./PerformanceTimer".split(" "),
function(m,h,d,c,a,b){function k(a,b,c){c=c||a;c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;return c}var f=d.vec3d;m=function(){function a(a,b,c){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._autoResize=!0;this._outsiders=[];c&&(void 0!==c.maximumObjectsPerNode&&(this._maximumObjectsPerNode=c.maximumObjectsPerNode),void 0!==c.maximumDepth&&(this._maximumDepth=c.maximumDepth),void 0!==c.autoResize&&(this._autoResize=c.autoResize));isNaN(a[0])||isNaN(a[1])||isNaN(a[2])||isNaN(b)?this._root=new g(null,
f.createFrom(0,0,0),.5):this._root=new g(null,a,b/2)}Object.defineProperty(a.prototype,"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"outsiders",{get:function(){return this._outsiders.slice()},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"autoResize",{get:function(){return this._autoResize},enumerable:!0,configurable:!0});a.prototype.add=function(a){a=this._objectOrObjectsArray(a);this._grow(a);for(var b=g.acquire(),c=
0;c<a.length;c++){var d=a[c];b.init(this._root);0===d.getBSRadius()||isNaN(d.getBSRadius())||!this._autoResize&&!this._fitsInsideTree(this._boundingSphereFromObject(d,t))?this._outsiders.push(d):this._add(d,b)}g.release(b)};a.prototype.remove=function(a,b){a=this._objectOrObjectsArray(a);for(var d=g.acquire(),e=!0,f=0;f<a.length;f++){var e=a[f],k=this._boundingSphereFromObject(b||e,t);0===k.radius||isNaN(k.radius)||!this._autoResize&&!this._fitsInsideTree(k)?e=null!=c.arrayRemove(this._outsiders,
e):(d.init(this._root),e=this._remove(e,k,d))}g.release(d);this._shrink();return e};a.prototype.update=function(a,b){this.remove(a,b);this.add(a)};a.prototype.forEachAlongRay=function(a,b,d){this._forEachTest(function(d){k(d.center,2*-d.halfSize,v);k(d.center,2*d.halfSize,q);return c.rayBoxTest(a,b,v,q)},d)};a.prototype.forEachInBoundingBox=function(a,b,c){this._forEachTest(function(c){for(var d=2*c.halfSize,e=0;3>e;e++)if(c.center[e]+d<a[e]||c.center[e]-d>b[e])return!1;return!0},c)};a.prototype.forEachNode=
function(a){this._forEachNode(this._root,function(b){return a(b.node,b.center,2*b.halfSize)})};a.prototype._forEachTest=function(a,b){this._outsiders.forEach(b);this._forEachNode(this._root,function(c){return a(c)?(c=c.node,c.terminals.forEach(b),null!==c.residents&&c.residents.forEach(b),!0):!1})};a.prototype._forEachNode=function(a,b){a=g.acquire().init(a);for(var c=[a];0!==c.length;){a=c.pop();if(b(a)&&!a.isLeaf())for(var d=0;d<a.node.children.length;d++)a.node.children[d]&&c.push(g.acquire().init(a).advance(d));
g.release(a)}};a.prototype._objectOrObjectsArray=function(a){Array.isArray(a)||(l[0]=a,a=l);return a};a.prototype._remove=function(a,b,d){n.length=0;d.advanceTo(b,function(a,b){n.push(a.node,b)})?(a=null!=c.arrayRemove(d.node.terminals,a),d=0===d.node.terminals.length):(a=null!=c.arrayRemove(d.node.residents,a),d=0===d.node.residents.length);if(d)for(d=n.length-2;0<=d&&this._purge(n[d],n[d+1]);d-=2);return a};a.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==a.residents)return 0===
a.residents.length;for(var b=0;b<a.children.length;b++)if(a.children[b])return!1;return!0};a.prototype._purge=function(a,b){0<=b&&(a.children[b]=null);return this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=[]),!0):!1};a.prototype._add=function(a,b){b.advanceTo(this._boundingSphereFromObject(a,t))?b.node.terminals.push(a):(b.node.residents.push(a),b.node.residents.length>this._maximumObjectsPerNode&&b.depth<this._maximumDepth&&this._split(b))};a.prototype._split=function(a){var b=a.node.residents;
a.node.residents=null;for(var c=0;c<b.length;c++){var d=g.acquire().init(a);this._add(b[c],d);g.release(d)}};a.prototype._grow=function(a){if(0!==a.length&&this._autoResize&&(a=this._boundingSphereFromObjects(a,this._boundingSphereFromObject,u),!isNaN(a.radius)&&0!==a.radius&&!this._fitsInsideTree(a)))if(this._nodeIsEmpty(this._root.node))f.set(a.center,this._root.center),this._root.halfSize=1.25*a.radius;else{var b=g.acquire();this._rootBoundsForRootAsSubNode(a,b);this._placingRootViolatesMaxDepth(b)?
this._rebuildTree(a,b):this._growRootAsSubNode(b);g.release(b)}};a.prototype._rebuildTree=function(a,b){var c=this;f.set(b.center,x.center);x.radius=b.halfSize;a=this._boundingSphereFromObjects([a,x],function(a){return a},r);b=g.acquire().init(this._root);this._root.initFrom(null,a.center,1.25*a.radius);this._forEachNode(b,function(a){c.add(a.node.terminals);null!==a.node.residents&&c.add(a.node.residents);return!0});g.release(b)};a.prototype._placingRootViolatesMaxDepth=function(a){var b=0;this._forEachNode(this._root,
function(a){b=Math.max(b,a.depth);return!0});return b+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};a.prototype._rootBoundsForRootAsSubNode=function(a,b){var c=a.radius,d=a.center;a=-Infinity;for(var e=this._root.center,f=this._root.halfSize,g=0;3>g;g++){var k=Math.max(0,Math.ceil((e[g]-f-(d[g]-c))/(2*f))),l=Math.max(0,Math.ceil((d[g]+c-(e[g]+f))/(2*f)))+1;a=Math.max(a,Math.pow(2,Math.ceil(Math.log(k+l)*Math.LOG2E)));z[g].min=k;z[g].max=l}for(g=0;3>g;g++)k=z[g].min,l=z[g].max,
c=(a-(k+l))/2,k+=Math.ceil(c),l+=Math.floor(c),p[g]=e[g]-f-k*f*2+(l+k)*f;return b.initFrom(null,p,a*f,0)};a.prototype._growRootAsSubNode=function(a){var b=this._root.node;f.set(this._root.center,u.center);u.radius=this._root.halfSize;this._root.init(a);a.advanceTo(u,null,!0);a.node.children=b.children;a.node.residents=b.residents;a.node.terminals=b.terminals};a.prototype._shrink=function(){if(this._autoResize)for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);this._root.depth=
0}};a.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,b=this._root.node.children,c=0,d=0;d<b.length&&null==a;)c=d++,a=b[c];for(;d<b.length;)if(b[d++])return-1;return c};a.prototype._fitsInsideTree=function(a){var b=this._root.center,c=this._root.halfSize,d=a.center;return a.radius<=c&&d[0]>=b[0]-c&&d[0]<=b[0]+c&&d[1]>=b[1]-c&&d[1]<=b[1]+c&&d[2]>=b[2]-c&&d[2]<=b[2]+c};a.prototype._boundingSphereFromObject=function(a,b){f.set(a.getCenter(),
b.center);b.radius=a.getBSRadius();return b};a.prototype._boundingSphereFromObjects=function(a,b,c){if(1===a.length){var d=b(a[0],u);f.set(d.center,c.center);c.radius=d.radius}else{v[0]=Infinity;v[1]=Infinity;v[2]=Infinity;q[0]=-Infinity;q[1]=-Infinity;q[2]=-Infinity;for(var e=0;e<a.length;e++){var d=b(a[e],u),g=v,k=d.center,l=d.radius;g[0]=Math.min(g[0],k[0]-l);g[1]=Math.min(g[1],k[1]-l);g[2]=Math.min(g[2],k[2]-l);g=q;k=d.center;d=d.radius;g[0]=Math.max(g[0],k[0]+d);g[1]=Math.max(g[1],k[1]+d);g[2]=
Math.max(g[2],k[2]+d)}f.scale(f.add(v,q,c.center),.5);c.radius=Math.max(q[0]-v[0],q[1]-v[1],q[2]-v[2])/2}return c};return a}();var g=function(){function a(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);this.center=f.create();this.initFrom(a,b,c,0)}a.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)};a.prototype.initFrom=function(b,c,d,e){void 0===b&&(b=null);void 0===d&&(d=this.halfSize);void 0===e&&(e=this.depth);this.node=b||a.createEmptyNode();c&&f.set(c,this.center);
this.halfSize=d;this.depth=e;return this};a.prototype.advance=function(b){var c=this.node.children[b];c||(c=a.createEmptyNode(),this.node.children[b]=c);this.node=c;this.halfSize/=2;this.depth++;b=e[b];this.center[0]+=b[0]*this.halfSize;this.center[1]+=b[1]*this.halfSize;this.center[2]+=b[2]*this.halfSize;return this};a.prototype.advanceTo=function(a,b,c){for(void 0===c&&(c=!1);;){if(this.isTerminalFor(a))return b&&b(this,-1),!0;if(this.isLeaf()&&!c)return b&&b(this,-1),!1;this.isLeaf()&&(this.node.residents=
null);var d=this._childIndex(a);b&&b(this,d);this.advance(d)}};a.prototype.isLeaf=function(){return null!=this.node.residents};a.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2};a.prototype._childIndex=function(a){a=a.center;for(var b=this.center,c=0,d=0;3>d;d++)b[d]<a[d]&&(c|=1<<d);return c};a.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:[],residents:[]}};a.acquire=function(){if(0===this._pool.length)return new a;var b=this._pool[this._pool.length-
1];this._pool.length--;return b};a.release=function(a){this._pool.push(a)};return a}();g._pool=[];var e=[[-1,-1,-1],[1,-1,-1],[-1,1,-1],[1,1,-1],[-1,-1,1],[1,-1,1],[-1,1,1],[1,1,1]],l=[null],p=f.create(),v=f.create(),q=f.create(),n=[],t={center:f.create(),radius:0},u={center:f.create(),radius:0},x={center:f.create(),radius:0},r={center:f.create(),radius:0},z=[{min:0,max:0},{min:0,max:0},{min:0,max:0}];return m})},"esri/views/3d/webgl-engine/lib/FloatingBoxLocalOriginFactory":function(){define(["require",
"exports","./gl-matrix"],function(m,h,d){var c=d.vec3d;m=function(){function b(a,b){this._origins=[];this._boxSize=a;this._maxNumOrigins=b}b.prototype.getOrigin=function(d){for(var f=this._origins.length,g,e=!1,k=Number.MAX_VALUE,h=0;h<f;h++){var m=this._origins[h];c.subtract(d,m.vec3,a);a[0]=Math.abs(a[0]);a[1]=Math.abs(a[1]);a[2]=Math.abs(a[2]);var q=a[0]+a[1]+a[2];q<k&&(g=m,k=q,e=a[0]<this._boxSize&&a[1]<this._boxSize&&a[2]<this._boxSize)}e||g&&null!=this._maxNumOrigins&&!(this._origins.length<
this._maxNumOrigins)||(f=b.OFFSET,g={vec3:[d[0]+f,d[1]+f,d[2]+f],id:b.ORIGIN_PREFIX+this._origins.length},this._origins.push(g));return g};return b}();m.OFFSET=1.11;m.ORIGIN_PREFIX="fb_";var a=c.create();return m})},"esri/views/3d/layers/graphics/Graphics3DGraphic":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/asyncUtils ../../../../core/ObjectPool ../../support/aaBoundingBox ../../support/aaBoundingRect".split(" "),
function(m,h,d,c,a,b,k,f){var g=new b(Array,function(a){return k.set(a,k.ZERO)},null,10,5),e=f.create();return function(){function b(a,b,c){this.addedToSpatialIndex=!1;this._labelGraphics=[];this._auxiliaryGraphics=[];for(var d=Array(2),e=0;e<d.length;e++)d[e]=Array(3);this._visibilityFlags=d;this.graphics3DSymbol=b;this.graphic=a;this._graphics=c}b.prototype.initialize=function(a,b){var c=this;this._layer=a;this._stage=b;this.forEachSymbolLayerGraphic(function(d){d.initialize(a,b);d.setVisibility(c.isVisible())})};
b.prototype.destroy=function(){this.forEachRenderedGraphic(function(a){return a.destroy()});this._graphics.length=0;this._labelGraphics.length=0;this._auxiliaryGraphics.length=0};b.prototype.clearLabelGraphics=function(){this.forEachLabelGraphic(function(a){return a.destroy()});this._labelGraphics.length=0};b.prototype.addLabelGraphic=function(a,b,c){this._labelGraphics.push(a);a.initialize(b,c);a.setVisibility(this.isVisible(1))};b.prototype.addAuxiliaryGraphic=function(a){this._auxiliaryGraphics.push(a);
this._layer&&(a.initialize(this._layer,this._stage),a.setVisibility(this.isVisible()))};b.prototype.isDraped=function(){var a=!1;this.forEachSymbolLayerGraphic(function(b){b.isDraped()&&(a=!0)});return a};b.prototype.setDrawOrder=function(a,b,c){var d=this;c[this.graphics3DSymbol.symbol.id]=!0;this.forEachSymbolLayerGraphic(function(e,f){e.setDrawOrder(a+(1-(1+f)/d._graphics.length),b,c)})};b.prototype.areVisibilityFlagsSet=function(a,b,c){void 0===c&&(c=0);c=this._visibilityFlags[c];if(null!=a)return c[a];
a=!0;for(var d=0;d<c.length;d++)if(d!==b){var e=c[d];a=a&&(null==e||!0===e)}return a};b.prototype.isVisible=function(a){void 0===a&&(a=0);for(var b=!0,c=0;c<=a;c++)for(var d=this._visibilityFlags[c],e=0;e<d.length;e++)var f=d[e],b=b&&(null==f||!0===f);return b};b.prototype.setVisibilityFlag=function(a,b,c){void 0===c&&(c=0);var d=this.isVisible(c);this._visibilityFlags[c][a]=b;var e=this.isVisible(c);if(d!==e){if(1===c)this.forEachLabelGraphic(function(a){return a.setVisibility(e)});else{this.forEachSymbolLayerGraphic(function(a){return a.setVisibility(e)});
var f=this.isVisible(1);this.forEachLabelGraphic(function(a){return a.setVisibility(f)})}return!0}return!1};b.prototype.getBSRadius=function(){var a=0;this.forEachSymbolLayerGraphic(function(b){a=Math.max(a,b.getBSRadius())});return a};b.prototype.getCenterObjectSpace=function(){return this._graphics[0].getCenterObjectSpace()};b.prototype.getProjectedBoundingBox=function(b,l,h,n){return c(this,void 0,void 0,function(){var p=this;return d(this,function(m){switch(m.label){case 0:return n||(n={boundingBox:null,
requiresDrapedElevation:!1,screenSpaceObjects:[]}),n.boundingBox?k.set(n.boundingBox,k.NEGATIVE_INFINITY):n.boundingBox=k.create(k.NEGATIVE_INFINITY),n.requiresDrapedElevation=!1,[4,a.forEach(this._graphics,function(a){return c(p,void 0,void 0,function(){var c,e,f;return d(this,function(d){switch(d.label){case 0:if(!a)return[2];c=a.isDraped()?l:b;e=g.acquire();return[4,a.getProjectedBoundingBox(c,h,e,n.screenSpaceObjects)];case 1:return f=d.sent(),isFinite(f[2])&&isFinite(f[5])||(n.requiresDrapedElevation=
!0),f&&k.expand(n.boundingBox,e),g.release(e),[2]}})})})];case 1:return m.sent(),k.allFinite(n.boundingBox)||f.allFinite(k.toRect(n.boundingBox,e))?[2,n]:[2,null]}})})};b.prototype.needsElevationUpdates=function(){for(var a=0,b=this._graphics;a<b.length;a++){var c=b[a];if(c&&c.needsElevationUpdates)return!0}a=0;for(b=this._labelGraphics;a<b.length;a++)if((c=b[a])&&c.needsElevationUpdates)return!0;return!1};b.prototype.alignWithElevation=function(a,b){this.forEachRenderedGraphic(function(c){return c.alignWithElevation(a,
b)})};b.prototype.addHighlight=function(a,b){this.forEachSymbolLayerGraphic(function(c){return c.addHighlight(a,b)})};b.prototype.removeHighlight=function(a){this.forEachSymbolLayerGraphic(function(b){return b.removeHighlight(a)})};b.prototype.forEachGraphicList=function(a,b){a.forEach(function(a,c){return a&&b(a,c)})};b.prototype.forEachSymbolLayerGraphic=function(a){this.forEachGraphicList(this._graphics,a);this.forEachGraphicList(this._auxiliaryGraphics,a)};b.prototype.forEachLabelGraphic=function(a){this.forEachGraphicList(this._labelGraphics,
a)};b.prototype.forEachRenderedGraphic=function(a){this.forEachSymbolLayerGraphic(a);this.forEachLabelGraphic(a)};return b}()})},"esri/core/asyncUtils":function(){define(["require","exports","./tsSupport/generatorHelper","./tsSupport/awaiterHelper","./promiseUtils"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});h.forEach=function(b,k,f){return c(this,void 0,void 0,function(){return d(this,function(c){switch(c.label){case 0:return[4,a.eachAlways(b.map(function(a,b){return k.apply(f,
[a,b])}))];case 1:return c.sent(),[2]}})})};h.map=function(b,k,f){return c(this,void 0,void 0,function(){var c;return d(this,function(d){switch(d.label){case 0:return[4,a.eachAlways(b.map(function(a,b){return k.apply(f,[a,b])}))];case 1:return c=d.sent(),[2,c.map(function(a){return a.value})]}})})}})},"esri/views/3d/layers/graphics/Graphics3DWebStyleSymbol":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../support/PromiseLightweight"],function(m,h,d,c){return function(a){function b(b,
c){var d=a.call(this)||this;d.symbol=null;d.graphics3DSymbol=null;d.symbol=b;b.fetchSymbol().then(function(a){if(d.isRejected())throw Error();d.graphics3DSymbol=c(a)}).then(function(){if(d.isRejected())throw Error();d.graphics3DSymbol.then(function(){d.isRejected()||d.resolve()},function(a){d.isRejected()||d.reject(a)})}).otherwise(function(a){d.isRejected()||d.reject(a)});return d}d(b,a);b.prototype.createGraphics3DGraphic=function(a,b){return this.graphics3DSymbol.createGraphics3DGraphic(a,b,this)};
b.prototype.layerPropertyChanged=function(a,b){return this.graphics3DSymbol.layerPropertyChanged(a,b)};b.prototype.applyRendererDiff=function(a,b,c){return this.graphics3DSymbol.applyRendererDiff(a,b,c)};b.prototype.getFastUpdateStatus=function(){return this.graphics3DSymbol?this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}};b.prototype.setDrawOrder=function(a,b){return this.graphics3DSymbol.setDrawOrder(a,b)};b.prototype.destroy=function(){this.isFulfilled()||this.reject();this.graphics3DSymbol&&
this.graphics3DSymbol.destroy()};return b}(c.Promise)})},"esri/views/3d/layers/graphics/Graphics3DSymbolFactory":function(){define(["require","exports","./Graphics3DSymbol","./Graphics3DPointSymbol"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});h.make=function(a,b,k){var f;switch(a.type){case "point-symbol-3d":f=c;break;default:f=d}return new f(a,b,k)}})},"esri/views/3d/layers/graphics/Graphics3DSymbol":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../support/PromiseLightweight ./Graphics3DGraphic ./Graphics3DSymbolLayerFactory".split(" "),
function(m,h,d,c,a,b){return function(c){function f(a,d,f){var e=c.call(this)||this;e.symbol=a;a=a.symbolLayers;f&&(a=f.concat(a));f=a.length;e.childGraphics3DSymbols=Array(a.length);e.childGraphics3DSymbolPromises=Array(a.length);for(var g=d.layerOrder,k=0,l=0,h=!1,m=function(a,b){b&&(this.childGraphics3DSymbols[a]=b,l++);k--;!this.isRejected()&&h&&1>k&&(0<l?this.resolve():this.reject())},x=0;x<f;x++){var r=a.getItemAt(x);!1!==r.enabled&&(d.layerOrder=g+(1-(1+x)/f),d.layerOrderDelta=1/f,r=b.make(e.symbol,
r,d,r._ignoreDrivers))&&(k++,e.childGraphics3DSymbolPromises[x]=r,r.then(m.bind(e,x,r),m.bind(e,x,null)))}d.layerOrder=g;h=!0;!e.isRejected()&&1>k&&(0<l?e.resolve():e.reject());return e}d(f,c);f.prototype.createGraphics3DGraphic=function(b,c,d){for(var e=Array(this.childGraphics3DSymbols.length),f=0;f<this.childGraphics3DSymbols.length;f++){var g=this.childGraphics3DSymbols[f];g&&(e[f]=g.createGraphics3DGraphic(b,c))}return new a(b,d||this,e)};f.prototype.layerPropertyChanged=function(a,b){for(var c=
this.childGraphics3DSymbols.length,d=function(c){var d=e.childGraphics3DSymbols[c],f=function(a){return a._graphics[c]};if(d&&!d.layerPropertyChanged(a,b,f))return{value:!1}},e=this,f=0;f<c;f++){var g=d(f);if("object"===typeof g)return g.value}return!0};f.prototype.applyRendererDiff=function(a,b,c){return this.isResolved()?this.childGraphics3DSymbols.reduce(function(d,e,f){return d&&(!e||e.applyRendererDiff(a,b,c,f))},!0):!1};f.prototype.getFastUpdateStatus=function(){var a=0,b=0,c=0;this.childGraphics3DSymbolPromises.forEach(function(d){d&&
!d.isFulfilled()?a++:d&&d.isFastUpdatesEnabled()?c++:d&&b++});return{loading:a,slow:b,fast:c}};f.prototype.setDrawOrder=function(a,b){for(var c=this.childGraphics3DSymbols.length,d=1/c,e=0;e<c;e++){var f=this.childGraphics3DSymbols[e];f&&f.setDrawOrder(a+(1-(1+e)/c),d,b)}};f.prototype.destroy=function(){this.isFulfilled()||this.reject();for(var a=0;a<this.childGraphics3DSymbolPromises.length;a++)this.childGraphics3DSymbolPromises[a]&&this.childGraphics3DSymbolPromises[a].destroy()};return f}(c.Promise)})},
"esri/views/3d/layers/graphics/Graphics3DSymbolLayerFactory":function(){define("require exports ../../../../core/Logger ./Graphics3DIconSymbolLayer ./Graphics3DObjectSymbolLayer ./Graphics3DLineSymbolLayer ./Graphics3DPathSymbolLayer ./Graphics3DFillSymbolLayer ./Graphics3DExtrudeSymbolLayer ./Graphics3DTextSymbolLayer".split(" "),function(m,h,d,c,a,b,k,f,g,e){Object.defineProperty(h,"__esModule",{value:!0});var l=d.getLogger("esri.views.3d.graphics");h.make=function(a,b,c,d){var e=p[b.type];return e?
new e(a,b,c,d):(l.error("GraphicsLayerFactory#make","unknown symbol type "+b.type),null)};var p={icon:c,object:a,line:b,path:k,fill:f,extrude:g,text:e}})},"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojo/when ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./SignedDistanceFunctions ../support/FastSymbolUpdates ./graphicUtils ../../../../core/screenUtils ../../../../core/sniff ../../../../core/Logger ../../../../core/Error ../../../../symbols/support/symbolUtils ../../../../Color ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial ../../../../core/urlUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I){function F(a){return"cross"===a||"x"===a}function N(a){var b;"primitive:"===a.substring(0,10)&&(a=a.substring(10));switch(a){case U.PRIM_CIRCLE:b=l.computeSignedDistancefieldCicle(128,64);break;case U.PRIM_SQUARE:b=l.computeSignedDistancefieldSquare(128,64,!1);break;case U.PRIM_KITE:b=l.computeSignedDistancefieldSquare(128,64,!0);break;case U.PRIM_CROSS:b=l.computeSignedDistancefieldCrossAndX(128,64,!1);break;case U.PRIM_X:b=l.computeSignedDistancefieldCrossAndX(128,
64,!0)}return new G(b,"sdf_"+a,{mipmap:!1,wrapClamp:!0,width:128,height:128,components:4})}var L=t.getLogger("esri.views.3d.graphics"),M=C.vec3d;m=C.vec4d;var K=C.mat4d.identity(),ba=[0,0,1],X=[0,0,0,0],T=[0,0,0],V=[1,1,1],P="center bottom top left right bottom-left bottom-right top-left top-right".split(" "),W=[.25,.25,.75,.75],U={PRIM_CIRCLE:"circle",PRIM_SQUARE:"square",PRIM_CROSS:"cross",PRIM_X:"x",PRIM_KITE:"kite"};b=function(b){function l(){var a=null!==b&&b.apply(this,arguments)||this;a._elevationOptions=
{supportsOffsetAdjustment:!0,supportsOnTheGround:!0};return a}d(l,b);l.prototype._prepareResources=function(){var a=this.symbol,b=Math.round(null!=a.size?q.pt2px(a.size):16);this._size=null;this._symbolTextureRatio=1;this._primitive=null;var c=this._getStageIdHint();if(!this._isPropertyDriven("size")){var d=v.validateSymbolLayerSize(b);if(d){this._logWarning(d);this.reject();return}}this._isPropertyDriven("size")&&64>b&&(b=64);var e=a.resource||{primitive:"circle",href:void 0},d={anchorPos:this._getAnchorPos(a)},
f=this.symbolContainer;if(this._hasVisibleVerticalOffset(f)){var f=f.verticalOffset,g=f.minWorldLength,k=f.maxWorldLength;d.verticalOffset={screenLength:q.pt2px(f.screenLength),minWorldLength:g||0,maxWorldLength:null!=k?k:Infinity}}this._context.screenSizePerspectiveEnabled&&(d.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings);e.href?(this._outlineSize=this._getOutlineSize(a,null),d.color=this._getFillColor(a,null),d.outlineColor=this._getOutlineColor(a),d.outlineSize=
this._outlineSize,d.textureIsSignedDistanceField=!1,this._prepareImageResources(b,d,c)):(e=e.primitive||"circle",f="primitive:"+e,this._primitive=e,this._outlineSize=this._getOutlineSize(a,e),d.color=this._getFillColor(a,e),d.outlineColor=this._getOutlineColor(a),d.outlineSize=this._outlineSize,F(e)&&0===d.outlineSize?this.reject():(this.texture=this._context.sharedResources.textures.acquire(f,N),this._textureURI=f,d.textureIsSignedDistanceField=!0,d.distanceFieldBoundingBox=W,d.textureId=this.texture.getId(),
this._size=[b,b],this._symbolTextureRatio=2,this._createMaterialsAndAddToStage(d,this._context.stage,c),this.resolve()))};l.prototype._getOutlineSize=function(a,b){var c=0,c=a.outline&&null!=a.outline.size?q.pt2px(a.outline.size):F(b)?1.5:0;return Math.max(c,0)};l.prototype._getOutlineColor=function(a){var b=this._getLayerOpacity();if(a.outline&&null!=a.outline.color){var c=r.toUnitRGB(a.outline.color);return[c[0],c[1],c[2],a.outline.color.a*b]}return[0,0,0,b]};l.prototype._getFillColor=function(a,
b){return F(b)?X:this._getMaterialOpacityAndColor()};l.prototype._getAnchorPos=function(a){return-1<P.indexOf(a.anchor)?a.anchor:"center"};l.prototype._prepareImageResources=function(b,c,d){var e=this,f=x.getIconHref(this.symbolContainer,this.symbol);!n("esri-canvas-svg-support")&&I.isSVG(f)?(L.warn("#_prepareImageResources()","SVG symbols are not supported in IE11"),this.reject(new u("SVG Not Supported","SVG symbols are not supported in IE11"))):(a(this._context.sharedResources.textures.acquire(f,
null,b),function(a){if(!e.isRejected()){var f=a.params,g=f.width/f.height;e._size=b?1<g?[b,Math.round(b/g)]:[Math.round(b*g),b]:[f.width,f.height];c.textureId=a.getId();e._createMaterialsAndAddToStage(c,e._context.stage,d);e.resolve()}},function(){e.reject()}),this._textureURI=f)};l.prototype._createMaterialsAndAddToStage=function(a,b,d){this._fastUpdates=p.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled&&
c.mixin(a,this._fastUpdates.materialParameters);var e=c.mixin({},a);e.verticalOffset=null;e.screenSizePerspective=null;e.occlusionTest=!1;e.shaderPolygonOffset=0;this._drapedMaterial=new J(e,d+"_iconDraped");b.add(A.ModelContentType.MATERIAL,this._drapedMaterial);a.occlusionTest=!0;this._material=new J(a,d+"_icon");b.add(A.ModelContentType.MATERIAL,this._material)};l.prototype.destroy=function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(A.ModelContentType.MATERIAL,
this._material.getId()),this._material=null);this._drapedMaterial&&(this._context.stage.remove(A.ModelContentType.MATERIAL,this._drapedMaterial.getId()),this._drapedMaterial=null);this._textureURI&&(this._context.sharedResources.textures.release(this._textureURI),this._textureURI=null)};l.prototype._getGeometry=function(a){a=a.geometry;if("extent"===a.type)return e.placePointOnPolygon(z.fromExtent(a));if("polyline"===a.type)return e.placePointOnPolyline(a);if("polygon"===a.type)return e.placePointOnPolygon(a);
if("point"===a.type)return a;this._logWarning("unsupported geometry type for icon symbol: "+a.type);return null};l.prototype._getScaleFactor=function(a){if(this._isPropertyDriven("size")&&a.size){for(var b=0;3>b;b++){var c=a.size[b];c&&"symbolValue"!==c&&"proportional"!==c&&(a.size[b]=q.pt2px(c))}b=this._size[0]>this._size[1]?this._size[0]:this._size[1];if("symbolValue"!==a.size[0]){if(isFinite(+a.size[0]))return+a.size[0]/b;if(isFinite(+a.size[2]))return+a.size[2]/b}}return 1};l.prototype.createGraphics3DGraphic=
function(a,b){var c=this._getGeometry(a);if(null===c)return null;var d="graphic"+a.uid,e=this._getVertexOpacityAndColor(b),f=1;this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||(f=this._getScaleFactor(b));f*=this._symbolTextureRatio;b=[this._size[0]*f,this._size[1]*f];f=this.getGraphicElevationInfo(a);return"on-the-ground"===f.mode?this._createAsOverlay(a,c,e,b,f,d,a.uid):this._createAs3DShape(a,c,e,b,f,d,a.uid)};l.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)return b=
this._getFillColor(this.symbol,this._primitive),this._drapedMaterial.setParameterValues({color:b}),this._material.setParameterValues({color:b}),b=this._getOutlineColor(this.symbol),this._drapedMaterial.setParameterValues({outlineColor:b}),this._material.setParameterValues({outlineColor:b}),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var d=this._elevationInfo.mode;if("on-the-ground"===a&&"on-the-ground"===d)return!0;if(a!==d&&("on-the-ground"===a||"on-the-ground"===
d))return!1;a=e.needsElevationUpdates2D(d)||"absolute-height"===d;for(var f in b){var g=b[f];(d=c(g))&&!d.isDraped()&&(g=this.getGraphicElevationInfo(g.graphic),d.needsElevationUpdates=a,d.elevationInfo.set(g))}return!0}return!1};l.prototype.applyRendererDiff=function(a,b,c,d){for(var e in a.diff)switch(e){case "visualVariables":if(p.updateFastSymbolUpdatesState(this._fastUpdates,b,this._fastVisualVariableConvertOptions()))this._material.setParameterValues(this._fastUpdates.materialParameters),this._drapedMaterial.setParameterValues(this._fastUpdates.materialParameters);
else return!1;break;default:return!1}return!0};l.prototype.setDrawOrder=function(a,b,c){this._drapedMaterial&&(this._drapedMaterial.setRenderPriority(a),c[this._drapedMaterial.getId()]=!0)};l.prototype._defaultElevationInfoNoZ=function(){return Y};l.prototype._createAs3DShape=function(a,b,c,d,f,l,h){var n=this,m=this._getFastUpdateAttrValues(a);a=m?function(a){return p.evaluateModelTransform(n._fastUpdates.materialParameters,m,a)}:null;c=E.createPointGeometry(ba,null,c,d,S,null,m);c=[new D(c,l)];
l=e.createStageObjectForPoint.call(this,b,c,[[this._material]],null,null,f,l,this._context.layer.id,h,!0,a);if(null===l)return null;var q=new k(this,l.object,c,null,null,g.perObjectElevationAligner,f);q.alignedTerrainElevation=l.terrainElevation;q.needsElevationUpdates=e.needsElevationUpdates2D(f.mode)||"absolute-height"===f.mode;q.getScreenSize=this._createScreenSizeGetter(d,a);q.calculateRelativeScreenBounds=function(a){return n._material.calculateRelativeScreenBounds(q.getScreenSize(),1,a)};e.extendPointGraphicElevationInfo(q,
b,this._context.elevationProvider);return q};l.prototype._createAsOverlay=function(a,b,c,d,g,k,l){var h=this;this._drapedMaterial.setRenderPriority(this._symbolLayerOrder);l=M.create();B.pointToVector(b,l,this._context.overlaySR);l[2]=this._getDrapedZ();if((b=this._context.clippingExtent)&&!e.pointInBox2D(l,b))return null;var n=this._getFastUpdateAttrValues(a);a=n?function(a){return p.evaluateModelTransform(h._fastUpdates.materialParameters,n,a)}:null;c=E.createPointGeometry(ba,l,c,d,null,null,n);
b=new H(c);b.material=this._drapedMaterial;b.center=l;b.bsRadius=0;b.transformation=K;b.name=k;b.uniqueName=k+"#"+c.id;var m=new f(this,[b],null,null,null,g);m.getScreenSize=this._createScreenSizeGetter(d,a);m.calculateRelativeScreenBounds=function(a){return h._drapedMaterial.calculateRelativeScreenBounds(m.getScreenSize(),1,a)};return m};l.prototype._createScreenSizeGetter=function(a,b){var c=this._outlineSize+2;if(this._fastUpdates.enabled){var d=a[0]/this._symbolTextureRatio,e=a[1]/this._symbolTextureRatio;
return function(a){void 0===a&&(a=Array(2));var f=b(K);a[0]=f[0]*d+c;a[1]=f[5]*e+c;return a}}var f=a[0]/this._symbolTextureRatio+c,g=a[1]/this._symbolTextureRatio+c;return function(a){void 0===a&&(a=Array(2));a[0]=f;a[1]=g;return a}};l.prototype._supportsShaderVisualVariables=function(){return!0};l.prototype._fastVisualVariableConvertOptions=function(){var a=this._size[0]>this._size[1]?this._size[0]:this._size[1],b=[a,a,a],c=q.px2pt(1),a=a*c;return{modelSize:b,symbolSize:[a,a,a],unitInMeters:c,transformation:{anchor:T,
scale:V,rotation:T}}};l.prototype._hasVisibleVerticalOffset=function(a){return this.symbolContainer&&"point-symbol-3d"===this.symbolContainer.type&&this.symbolContainer.hasVisibleVerticalOffset()};return l}(b);b.PRIMITIVE_SIZE=[64,64];b.VALID_ANCHOR_STRINGS=P;var Y={mode:"relative-to-ground",offset:0},S=m.createFrom(0,0,0,1);return b})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ../../support/PromiseLightweight ./ElevationInfo ./graphicUtils ./Graphics3DSymbolCommonCode ./constants ../../../../core/Logger ../../../../Color".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){function p(a,b){a=null!=a?b.attributes[a]:0;null!=a&&isFinite(a)||(a=0);return a}var v=new b,q=e.getLogger("esri.symbols.Symbol3D"),n={mode:"on-the-ground",offset:0},t={mode:"absolute-height",offset:0};return function(a){function e(c,d,e,f){var g=a.call(this)||this;g._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0};g.symbolContainer=c;g.symbol=d;g._context=e;g._symbolLayerOrder=e.layerOrder;g._symbolLayerOrderDelta=e.layerOrderDelta;g._elevationInfo=
new b;g._material=null;g._updateDrivenProperties(f);g._updateElevationInfo();g._prepareResources();return g}d(e,a);e.prototype._logWarning=function(a){q.warn(a)};e.prototype._prepareResources=function(a){throw Error("This is an abstract base class");};e.prototype._defaultElevationInfoNoZ=function(){return n};e.prototype._defaultElevationInfoZ=function(){return t};e.prototype._updateElevationInfo=function(){for(var a in this._elevationInfo)this._elevationInfo[a]=void 0;if(a=this._context.layer.elevationInfo)this._elevationInfo=
c.mixin(this._elevationInfo,a);this.symbol&&this.symbol.elevationInfo&&(this._elevationInfo=c.mixin(this._elevationInfo,this.symbol.elevationInfo))};e.prototype.getGraphicElevationInfo=function(a){var b=a.geometry.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ();v.mode=this._elevationInfo.mode||b.mode;v.offset=null!=this._elevationInfo.offset?this._elevationInfo.offset:b.offset;v.featureExpression=this._elevationInfo.featureExpression;v.hasOffsetAdjustment=!1;this._elevationOptions.supportsOnTheGround||
"on-the-ground"!==v.mode||(v.mode="relative-to-ground",v.offset=0,v.featureExpression={value:0});if(!0===this._elevationOptions.needsOffsetAdjustment||null==this._elevationOptions.needsOffsetAdjustment&&this._elevationOptions.supportsOffsetAdjustment&&f.needsOffsetAdjustment(v,a.geometry,this.symbolContainer))v.offset=g.defaultIconElevationOffset,v.hasOffsetAdjustment=!0;v.offset/=this._context.renderCoordsHelper.unitInMeters;return v};e.prototype._getDrapedZ=function(){return-2};e.prototype._updateDrivenProperties=
function(a){var b={color:!1,opacity:!1,size:!1};!a&&(a=this._context.renderer)&&(b.color=!!a.colorInfo,b.size=!!a.sizeInfo,a.visualVariables&&a.visualVariables.forEach(function(a){switch(a.type){case "color":b.color=!0;if(a.colors)for(var c=0;c<a.colors.length;c++){var d=a.colors[c];d&&(Array.isArray(d)&&3<d.length&&255!==d[3]||void 0!==d.a&&255!==d.a)&&(b.opacity=!0)}if(a.stops)for(c=0;c<a.stops.length;c++)(d=a.stops[c].color)&&(Array.isArray(d)&&3<d.length&&255!==d[3]||void 0!==d.a&&255!==d.a)&&
(b.opacity=!0);break;case "opacity":b.opacity=!0;break;case "size":b.size=!0}}));this._drivenProperties=b};e.prototype._isPropertyDriven=function(a){return this._drivenProperties[a]};e.prototype._getLayerOpacity=function(){if(this._context.layerView&&"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;var a=this._context.layer.opacity;return null==a?1:a};e.prototype._getMaterialOpacity=function(){var a;a=1*this._getLayerOpacity();var b=this.symbol&&this.symbol.material;
b&&!this._isPropertyDriven("opacity")&&b.color&&(a*=b.color.a);return a};e.prototype._getMaterialOpacityAndColor=function(){var a=this.symbol&&this.symbol.material,b=this._getMaterialOpacity(),a=!this._isPropertyDriven("color")&&a&&a.color?l.toUnitRGB(a.color):null;return k.mixinColorAndOpacity(a,b)};e.prototype._getVertexOpacityAndColor=function(a,b,c){var d=this._isPropertyDriven("color")?a.color:null;a=this._isPropertyDriven("opacity")?a.opacity:null;d=k.mixinColorAndOpacity(d,a);c&&(d[0]*=c,d[1]*=
c,d[2]*=c,d[3]*=c);return b?new b(d):d};e.prototype._getStageIdHint=function(){return this._context.layer.id+"_symbol"};e.prototype.isFastUpdatesEnabled=function(){return this._fastUpdates&&this._fastUpdates.enabled};e.prototype.setDrawOrder=function(a,b,c){this._material&&(this._material.setRenderPriority(a),c[this._material.getId()]=!0)};e.prototype.createGraphics3DGraphic=function(a,b){for(var c=2;c<arguments.length;c++);throw Error("This is an abstract base class");};e.prototype.destroy=function(){throw Error("This is an abstract base class");
};e.prototype.layerPropertyChanged=function(a,b,c){return!1};e.prototype.applyRendererDiff=function(a,b,c,d){return!1};e.prototype._getFastUpdateAttrValues=function(a){if(!this._fastUpdates.enabled)return null;var b=this._fastUpdates.visualVariables,c=b.size?p(b.size.field,a):0;a=b.color?p(b.color.field,a):0;return[c,a,0,0]};return e}(a.Promise)})},"esri/views/3d/layers/graphics/ElevationInfo":function(){define(["require","exports","../../../../core/lang"],function(m,h,d){return function(){function c(a){a?
this.set(a):(this.mode=null,this.offset=0,this.featureExpression=null,this.hasOffsetAdjustment=!1)}c.prototype.set=function(a){this.mode=a.mode;this.offset=a.offset;this.featureExpression=a.featureExpression?d.clone(a.featureExpression):null;this.hasOffsetAdjustment=a.hasOffsetAdjustment};return c}()})},"esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode":function(){define("require exports ../../../../geometry/Point ../../../../symbols/callouts/calloutUtils ../../../../geometry/support/mathUtils ./graphicUtils ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/lib/Object3D".split(" "),
function(m,h,d,c,a,b,k,f,g){function e(a,b,c,d){var e=0,f=b.z||0,g=0,g=c.mode,k=c.offset||0;"on-the-ground"===g?(e=g=a.getElevation(b,"ground")||0,d&&(d.verticalDistanceToGround=0,d.terrainElevation=g)):"relative-to-ground"===g?(g=a.getElevation(b,"ground")||0,e=k,null==c.featureExpression&&(e+=f),d&&(d.verticalDistanceToGround=e,d.terrainElevation=g),e+=g):"relative-to-scene"===g?(g=a.getElevation(b,"scene")||0,e=k,d&&(d.verticalDistanceToGround=e,d.terrainElevation=g),e+=g):"absolute-height"===
g&&(e=f+k,d&&(g=a.getElevation(b,"ground")||0,d.verticalDistanceToGround=e-g,d.terrainElevation=g));return e}function l(a,b,c,d,e,f,g){var k=g.mode,l=g.offset,h=0,p=0,n=0;A.spatialReference=a.spatialReference;c*=3;e*=3;for(var m=0;m<f;++m)A.x=b[c+0],A.y=b[c+1],A.z=b[c+2],"on-the-ground"===k?(p=h=a.getElevation(A)||0,n+=h):"relative-to-ground"===k?(h=a.getElevation(A)||0,p=h+l,null==g.featureExpression&&(p+=A.z),n+=h):"relative-to-scene"===k?(h=a.getElevation(A,"scene")||0,p=h+l,n+=h):"absolute-height"===
k&&(p=A.z+l),d[e+0]=b[c+0],d[e+1]=b[c+1],d[e+2]=p,c+=3,e+=3;return{terrainElevation:n/f}}function p(a,c,d,f,g){var l=0,h;if(a.metadata.usesVerticalDistanceToGround)l=e(g,c,d,D),b.updateVertexAttributeAuxpos1w(a,D.verticalDistanceToGround),h=D.terrainElevation;else{var p="absolute-height"!==d.mode,l=e(g,c,d,p?D:null);p&&(h=D.terrainElevation)}d=a.getObjectTransformation();B[0]=c.x;B[1]=c.y;B[2]=l;k.computeLinearTransformation(c.spatialReference,B,d,f)?a.setObjectTransformation(d):console.warn("Could not locate symbol object properly, it might be misplaced");
return{terrainElevation:h}}function v(a){for(var b=0,c=a.length-1,d=0;d<c;d++)b+=a[d][0]*a[d+1][1]-a[d+1][0]*a[d][1];return 0<=b}function q(a,b,c,d,e,f){d*=3;for(var g=0;g<e;++g){var k=a[b++];c[d++]=k[0];c[d++]=k[1];c[d++]=f?k[2]:0}return d/3}function n(a,b){for(var c=a.length,d=Array(c),e=Array(c),f=Array(c),g=0,k=0,l=0,h=0,p=0;p<c;++p)h+=a[p].length;for(var h=new Float64Array(3*h),n=0,m=c-1;0<=m;m--){var t=a[m];if(v(t))d[g++]=t;else{for(var r=t.length,p=0;p<g;++p)r+=d[p].length;p={index:n,pathLengths:Array(g+
1),count:r,holeIndices:Array(g)};p.pathLengths[0]=t.length;0<t.length&&(f[l++]={index:n,count:t.length});n=q(t,0,h,n,t.length,b);for(t=0;t<g;++t)r=d[t],p.holeIndices[t]=n,p.pathLengths[t+1]=r.length,0<r.length&&(f[l++]={index:n,count:r.length}),n=q(r,0,h,n,r.length,b);g=0;0<p.count&&(e[k++]=p)}}for(t=0;t<g;++t)r=d[t],0<r.length&&(f[l++]={index:n,count:r.length}),n=q(r,0,h,n,r.length,b);k<c&&(e.length=k);l<c&&(f.length=l);return{vertexData:h,polygons:e,outlines:f}}function t(a,b,c,d,e){b*=3;d*=3;for(var f=
0;f<e;++f)c[d++]=a[b++],c[d++]=a[b++],c[d++]=a[b++]}function u(a,b,c,d,e,f,g){k.bufferToBuffer(a,c,b,d,f,e,g)}function x(a,b,c){k.pointToVector(a,b,c)}function r(a,b){return!(a[0]>b[3]||a[0]<b[0]||a[1]>b[4]||a[1]<b[1])}function z(a,b){return!(b[0]>a[3]||b[3]<a[0]||b[1]>a[4]||b[4]<a[1])}Object.defineProperty(h,"__esModule",{value:!0});m=f.mat4d;var B=f.vec3d.create(),C=m.identity(),A=new d({x:0,y:0,z:0,spatialReference:null});h.createStageObjectForPoint=function(a,b,c,d,e,f,k,l,h,n,m){var q=b?b.length:
0,t=this._context.clippingExtent;x(a,B,this._context.elevationProvider.spatialReference);if(t&&!r(B,t))return null;x(a,B,this._context.renderSpatialReference);t=this._context.localOriginFactory.getOrigin(B);k=new g({castShadow:!1,metadata:{layerId:l,graphicId:h,usesVerticalDistanceToGround:!!n},idHint:k});for(l=0;l<q;l++)k.addGeometry(b[l],c[l],d?d[l]:C,e,t,m);a=p(k,a,f,this._context.renderSpatialReference,this._context.elevationProvider);return{object:k,terrainElevation:a.terrainElevation}};h.extendPointGraphicElevationInfo=
function(a,b,c){a=a.elevationInfo;c=c.spatialReference;x(b,B,c);a.centerPointInElevationSR=new d({x:B[0],y:B[1],z:b.hasZ?B[2]:0,spatialReference:c})};h.placePointOnPolyline=function(b){var c=b.paths[0],c=a.getPointOnPath(c,a.getPathLength(c)/2);return new d({x:c[0],y:c[1],z:c[2],spatialReference:b.spatialReference})};h.placePointOnPolygon=function(a){return b.computeCentroid(a)};h.computeElevation=e;h.applyElevation=l;h.setObjectElevation=p;h.getSingleSizeDriver=function(a,b){void 0===b&&(b=0);return isFinite(a[b])?
a[b]:null};h.isCounterClockwise=v;h.copyPointData=q;h.copyPathData=n;h.copyVertices=t;h.chooseOrigin=function(a,b,c,d){b=Math.floor(b+(c-1)/2);d[0]=a[3*b+0];d[1]=a[3*b+1];d[2]=a[3*b+2]};h.subtractCoordinates=function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b++]-=d[0],a[b++]-=d[1],a[b++]-=d[2]};h.setZ=function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b+2]=d,b+=3};h.offsetZ=function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b+2]+=d,b+=3};h.scaleZ=function(a,b,c,d){b*=3;for(var e=0;e<c;++e)a[b+2]*=d,b+=3};h.flatArrayToArrayOfArrays=
function(a,b,c){var d=[];b*=3;for(var e=0;e<c;++e)d.push([a[b++],a[b++],a[b++]]);return d};h.reproject=u;h.reprojectPoint=x;h.getGeometryVertexData3D=function(a,b,c,d,e,f){var g=e.spatialReference;a=n(a,b);b=a.vertexData;var k=b.length/3,h=new Float64Array(b.length);c.equals(g)?t(b,0,h,0,b.length):u(b,0,c,h,0,g,k);c=l(e,h,0,b,0,k,f);g.equals(d)||u(b,0,g,b,0,d,k);return{geometryData:a,vertexData:b,eleVertexData:h,terrainElevation:c.terrainElevation}};h.getGeometryVertexDataDraped=function(a,b,c){a=
n(a,!1);var d=a.vertexData,e=d.length/3;b.equals(c)||k.bufferToBuffer(d,b,0,d,c,0,e);return{geometryData:a,vertexData:d}};h.computeBoundingBox=function(a,b,c,d){d[0]=Number.MAX_VALUE;d[1]=Number.MAX_VALUE;d[2]=Number.MAX_VALUE;d[3]=-Number.MAX_VALUE;d[4]=-Number.MAX_VALUE;d[5]=-Number.MAX_VALUE;b*=3;for(var e=0;e<c;++e){var f=a[b++],g=a[b++],k=a[b++];f<d[0]&&(d[0]=f);g<d[1]&&(d[1]=g);k<d[2]&&(d[2]=k);f>d[3]&&(d[3]=f);g>d[4]&&(d[4]=g);k>d[5]&&(d[5]=k)}return d};h.pointInBox2D=r;h.boxesIntersect2D=
z;h.boundingBoxClipped=function(a,b){return b?!z(a,b):!1};h.needsElevationUpdates2D=function(a){return"relative-to-ground"===a||"relative-to-scene"===a};h.needsElevationUpdates3D=function(a){return"absolute-height"!==a};h.needsOffsetAdjustment=function(a,b,d){return c.isCalloutSupport(d)&&d.hasVisibleVerticalOffset()?!1:"relative-to-ground"===a.mode&&0===a.offset&&(!b.hasZ||a.featureExpression)||"relative-to-scene"===a.mode&&0===a.offset?!0:!1};var D={verticalDistanceToGround:0,terrainElevation:0}})},
"esri/views/3d/layers/graphics/constants":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.defaultIconElevationOffset=1})},"esri/views/3d/layers/graphics/Graphics3DGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./Graphics3DGraphicElevationInfo ./ElevationAligners ../../webgl-engine/Stage ../../lib/glMatrix ../../support/aaBoundingBox".split(" "),
function(m,h,d,c,a,b,k,f,g,e){m=g.vec3d;var l=g.mat4d,p=[0,0,0];g=function(){function d(a,c,e,f,g,k,l,h){this._addedToStage=!1;this.alignedTerrainElevation=0;this.needsElevationUpdates=!1;this.graphics3DSymbolLayer=a;this.uniqueMaterials=f;this.uniqueGeometries=e;this.uniqueTextures=g;this.stageObject=c;this.elevationAligner=k;this.elevationInfo=new b(l);this.stageLayer=this.stage=null;this._visible=!1;this.visibilityMode=null!=h?h:d.VisibilityModes.HIDE_FACERANGE}d.prototype.initialize=function(a,
b){this.stageLayer=a;this.stage=b;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)b.add(f.ModelContentType.MATERIAL,this.uniqueMaterials[a]);if(this.uniqueGeometries)for(a=0;a<this.uniqueGeometries.length;a++)b.add(f.ModelContentType.GEOMETRY,this.uniqueGeometries[a]);if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.add(f.ModelContentType.TEXTURE,this.uniqueTextures[a]);b.add(f.ModelContentType.OBJECT,this.stageObject)};d.prototype.isDraped=function(){return!1};
d.prototype.setVisibility=function(a){if(null!=this.stage)return this._visible!==a?((this._visible=a)?this._addedToStage?this.stageObject.unhideAllComponents():(this.stageLayer.addObject(this.stageObject),this._addedToStage=!0):this.visibilityMode===d.VisibilityModes.HIDE_FACERANGE?this.stageObject.hideAllComponents():(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1),!0):!1};d.prototype.destroy=function(){var a=this.stage;if(this.stageLayer){if(this.uniqueMaterials)for(var b=
0;b<this.uniqueMaterials.length;b++)a.remove(f.ModelContentType.MATERIAL,this.uniqueMaterials[b].getId());if(this.uniqueGeometries)for(b=0;b<this.uniqueGeometries.length;b++)a.remove(f.ModelContentType.GEOMETRY,this.uniqueGeometries[b].getId());if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.remove(f.ModelContentType.TEXTURE,this.uniqueTextures[b].getId())}a.remove(f.ModelContentType.OBJECT,this.stageObject.getId());this._addedToStage&&(this.stageLayer.removeObject(this.stageObject),
this._addedToStage=!1);this._visible=!1;this.stage=this.stageLayer=null};d.prototype.alignWithElevation=function(a,b){this.elevationAligner&&k.applyElevationAligner(this.elevationAligner,this,a,b)};d.prototype.setDrawOrder=function(a,b,c){};d.prototype.getBSRadius=function(){return this.stageObject.getBSRadius()};d.prototype.getCenterObjectSpace=function(){return this.stageObject.getCenter(!0)};d.prototype.getBoundingBoxObjectSpace=function(a){var b=this.stageObject;a||(a=e.create());e.setMin(a,b.getBBMin(!0));
e.setMax(a,b.getBBMax(!0));return a};d.prototype.getProjectedBoundingBox=function(b,d,f,g){return a(this,void 0,void 0,function(){var a,k,h,m,t,r,u,x;return c(this,function(c){switch(c.label){case 0:a=this.getBoundingBoxObjectSpace(f);k=n;h=e.isPoint(a)?1:k.length;for(m=0;m<h;m++)t=k[m],q[0]=a[t[0]],q[1]=a[t[1]],q[2]=a[t[2]],l.multiplyVec3(this.stageObject.objectTransformation,q),v[3*m+0]=q[0],v[3*m+1]=q[1],v[3*m+2]=q[2];if(!b(v,0,h))return[3,6];e.set(a,e.NEGATIVE_INFINITY);r=null;this.calculateRelativeScreenBounds&&
(r=this.calculateRelativeScreenBounds());for(m=0;m<3*h;m+=3){for(u=0;3>u;u++)a[u]=Math.min(a[u],v[m+u]),a[u+3]=Math.max(a[u+3],v[m+u]);r&&g.push({location:v.slice(m,m+3),screenSpaceBoundingRect:r})}if(!d)return[3,5];e.center(a,p);if("absolute-height"===this.elevationInfo.mode)return[3,5];x=void 0;c.label=1;case 1:return c.trys.push([1,3,,4]),[4,d.queryElevation(p[0],p[1])];case 2:return x=c.sent(),[3,4];case 3:return c.sent(),x=null,[3,4];case 4:null!=x&&e.offset(a,0,0,-this.alignedTerrainElevation+
x),c.label=5;case 5:return[2,a];case 6:return[2,null]}})})};d.prototype.addHighlight=function(a,b){b=this.stageObject.highlightAllComponents(b);a.addObject(this.stageObject,b)};d.prototype.removeHighlight=function(a){a.removeObject(this.stageObject)};return d}();g.VisibilityModes={REMOVE_OBJECT:0,HIDE_FACERANGE:1};var v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=m.create(),n=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];return g})},"esri/views/3d/layers/graphics/Graphics3DGraphicElevationInfo":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","./ElevationInfo"],function(m,h,d,c){return function(a){function b(b){b=a.call(this,b)||this;b.centerPointInElevationSR=null;return b}d(b,a);return b}(c)})},"esri/views/3d/layers/graphics/ElevationAligners":function(){define("require exports ../../../../geometry/Point ../../lib/glMatrix ../../support/projectionUtils ../../webgl-engine/lib/Util ./Graphics3DSymbolCommonCode ./graphicUtils".split(" "),function(m,h,d,c,a,b,k,f){Object.defineProperty(h,
"__esModule",{value:!0});var g=b.VertexAttrConstants;m=c.vec3d;var e=new d,l=m.create(),p=m.create(),v=m.create(),q={verticalDistanceToGround:0,terrainElevation:0};h.perVertexElevationAligner=function(a,b,c,d){e.spatialReference=c.spatialReference;for(var f=a.getGeometryRecords(),n=f.length,m="absolute-height"!==b.mode,t=0,u=0;u<n;u++){var x=f[u].geometry,E=f[u].getShaderTransformation();p[0]=E[12];p[1]=E[13];p[2]=E[14];x.invalidateBoundingInfo();for(var E=x.getData().getVertexAttr(),H=E[g.POSITION],
x=H.data,E=E.mapPos.data,H=H.size,G=x.length/H,J=0,I=0,F=!1,N=0,L=0;L<G;L++){e.x=E[I++];e.y=E[I++];e.z=E[I++];v[0]=x[J];v[1]=x[J+1];v[2]=x[J+2];var M=k.computeElevation(c,e,b,m?q:null);m&&(N+=q.terrainElevation);l[0]=x[J]+p[0];l[1]=x[J+1]+p[1];l[2]=x[J+2]+p[2];d.setAltitude(M,l,0);x[J]=l[0]-p[0];x[J+1]=l[1]-p[1];x[J+2]=l[2]-p[2];M=h.updateThresholdInMeters/d.unitInMeters;if(Math.abs(v[0]-x[J])>=M||Math.abs(v[1]-x[J+1])>=M||Math.abs(v[2]-x[J+2])>=M)F=!0;J+=H}t+=N/G;F&&a.geometryVertexAttrsUpdated(u)}return t/
n};h.perObjectElevationAligner=function(b,c,d,e){var g=c.centerPointInElevationSR,p=0,n=0;if(b.metadata.usesVerticalDistanceToGround)p=k.computeElevation(d,g,c,q),f.updateVertexAttributeAuxpos1w(b,q.verticalDistanceToGround),n=q.terrainElevation;else{var m="absolute-height"!==c.mode,p=k.computeElevation(d,g,c,m?q:null);m&&(n=q.terrainElevation)}c=b.getObjectTransformation();d=[c[12],c[13],c[14]];h.iterativeUpdatesEnabled?e.setAltitudeOfTransformation(p,c):(l[0]=g.x,l[1]=g.y,l[2]=p,a.computeLinearTransformation(g.spatialReference,
l,c,e.spatialReference)&&b.setObjectTransformation(c));e=h.updateThresholdInMeters/e.unitInMeters;(Math.abs(c[12]-d[0])>=e||Math.abs(c[13]-d[1])>=e||Math.abs(c[14]-d[2])>=e)&&b.setObjectTransformation(c);return n};h.applyElevationAligner=function(a,b,c,d){a=a(b.stageObject,b.elevationInfo,c,d);null!=a&&(b.alignedTerrainElevation=a)};h.updateThresholdInMeters=.01;h.iterativeUpdatesEnabled=!0})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./ElevationInfo ../../support/aaBoundingBox ../../support/aaBoundingRect ../../webgl-engine/Stage".split(" "),
function(m,h,d,c,a,b,k,f,g){m=function(){function d(a,c,d,e,f,g){this.needsElevationUpdates=!1;this.graphics3DSymbolLayer=a;this.renderGeometries=c;this.uniqueMaterials=d;this.uniqueTextures=e;this.boundingBox=f;this.elevationInfo=new b(g);this.stage=null;this._visible=!1}d.prototype.initialize=function(a,b){this.stage=b;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)b.add(g.ModelContentType.MATERIAL,this.uniqueMaterials[a]);if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.add(g.ModelContentType.TEXTURE,
this.uniqueTextures[a])};d.prototype.isDraped=function(){return!0};d.prototype.setVisibility=function(a){if(null!=this.stage)return this._visible!==a?((this._visible=a)?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1};d.prototype.destroy=function(){if(this.stage){var a=this.stage;this._visible&&a.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);
this._visible=!1;if(this.uniqueMaterials)for(var b=0;b<this.uniqueMaterials.length;b++)a.remove(g.ModelContentType.MATERIAL,this.uniqueMaterials[b].getId());if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.remove(g.ModelContentType.TEXTURE,this.uniqueTextures[b].getId());this.stage=null}};d.prototype.alignWithElevation=function(a,b){};d.prototype.setDrawOrder=function(a,b,c){var d=this;this.uniqueMaterials&&this.uniqueMaterials.forEach(function(c){c.setRenderPriority(a);d._visible&&
(b[c.getId()]=!0)})};d.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,b){return Math.max(a,b.bsRadius)},0)};d.prototype.getCenterObjectSpace=function(){return[0,0,0]};d.prototype.addHighlight=function(a,b){var c=this.stage.getTextureGraphicsRenderer();this.renderGeometries.forEach(function(d){var e=c.addRenderGeometryHighlight(d,b);a.addRenderGeometry(d,c,e)})};d.prototype.removeHighlight=function(a){this.renderGeometries.forEach(function(b){a.removeRenderGeometry(b)})};
d.prototype.getProjectedBoundingBox=function(b,d,f,g){return a(this,void 0,void 0,function(){var a,l,h;return c(this,function(c){switch(c.label){case 0:k.set(f,k.NEGATIVE_INFINITY);for(a=0;a<this.renderGeometries.length;a++)l=this.renderGeometries[a],this._getRenderGeometryProjectedBoundingRect(l,e,b,g),k.expand(f,e);if(!d)return[3,5];k.center(f,p);h=void 0;c.label=1;case 1:return c.trys.push([1,3,,4]),[4,d.queryElevation(p[0],p[1])];case 2:return h=c.sent(),[3,4];case 3:return c.sent(),h=null,[3,
4];case 4:null!=h&&(f[2]=Math.min(f[2],h),f[5]=Math.max(f[5],h)),c.label=5;case 5:return[2,f]}})})};d.prototype._getRenderGeometryProjectedBoundingRect=function(a,b,c,d){if(this.boundingBox)k.set(l,this.boundingBox);else{var e=a.center;a=a.bsRadius;l[0]=e[0]-a;l[1]=e[1]-a;l[2]=e[2]-a;l[3]=e[0]+a;l[4]=e[1]+a;l[5]=e[2]+a}c(l,0,2);this.calculateRelativeScreenBounds&&d.push({location:k.center(l),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()});return k.toRect(l,b)};return d}();var e=f.create(),
l=[0,0,0,0,0,0],p=[0,0,0];return m})},"esri/views/3d/layers/graphics/SignedDistanceFunctions":function(){define(["require","exports","../../support/mathUtils"],function(m,h,d){function c(a){return a-Math.floor(a)}function a(a,e,f){a=d.clamp(a,0,.9999991);var g=c(a*b[0]),l=c(a*b[1]),h=c(a*b[2]);a=c(a*b[3]);e[f+0]=256*(g-g*k[0]);e[f+1]=256*(l-g*k[1]);e[f+2]=256*(h-l*k[2]);e[f+3]=256*(a-h*k[3])}Object.defineProperty(h,"__esModule",{value:!0});var b=[16777216,65536,256,1],k=[0,1/256,1/256,1/256],f=[1/
16777216,1/65536,1/256,1];h.packFloat=a;h.unpackFloat=function(a,b){var c=a[b+1]/256,d=a[b+2]/256,e=a[b+3]/256;a=0+a[b+0]/256*f[0];a+=c*f[1];a+=d*f[2];return a+=e*f[3]};h.computeSignedDistancefieldCicle=function(b,c){var d=new Uint8Array(4*b*b),e=b/2-.5;c/=2;for(var f=0;f<b;f++)for(var g=0;g<b;g++){var k=g+b*f,h=g-e,m=f-e,h=Math.sqrt(h*h+m*m)-c,h=h/b+.5;a(h,d,4*k)}return d};h.computeSignedDistancefieldSquare=function(b,c,d){d&&(c/=Math.SQRT2);for(var e=new Uint8Array(4*b*b),f=0;f<b;f++)for(var g=
0;g<b;g++){var k=g-.5*(b-.5),l=f-.5*(b-.5),h=f*b+g;if(d)var m=(k+l)/Math.SQRT2,l=(l-k)/Math.SQRT2,k=m;k=Math.max(Math.abs(k),Math.abs(l))-.5*c;k=k/b+.5;a(k,e,4*h)}return e};h.computeSignedDistancefieldCrossAndX=function(b,c,d){d&&(c*=Math.SQRT2);c*=.5;for(var e=new Uint8Array(4*b*b),f=0;f<b;f++)for(var g=0;g<b;g++){var k=g-.5*b+0,l=f-.5*b+0,h=f*b+g;if(d)var m=(k+l)/Math.SQRT2,l=(l-k)/Math.SQRT2,k=m;k=Math.abs(k);l=Math.abs(l);m=void 0;m=k>l?k>c?Math.sqrt((k-c)*(k-c)+l*l):l:l>c?Math.sqrt(k*k+(l-c)*
(l-c)):k;m=m/b+.5;a(m,e,4*h)}return e}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define(["require","exports","../../../../renderers/support/utils","../../lib/glMatrix","../graphics/graphicUtils"],function(m,h,d,c,a){function b(a){return null!==a&&void 0!==a}function k(a){return"number"===typeof a}function f(a,b){a&&a.push(b)}function g(a,c,g,l,h){var p=a.minSize,n=a.maxSize;if(a.expression)return f(h,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=
l.symbolSize[g],c.minSize[g]=a,c.maxSize[g]=a,c.offset[g]=c.minSize[g],c.factor[g]=0,c.type[g]=1,!0;if(b(a.field)){if(b(a.stops)){if(2===a.stops.length&&k(a.stops[0].size)&&k(a.stops[1].size))return e(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,c,g),c.type[g]=1,!0;f(h,"Could not convert size info: stops only supported with 2 elements");return!1}if(k(p)&&k(n)&&b(a.minDataValue)&&b(a.maxDataValue))return e(p,n,a.minDataValue,a.maxDataValue,c,g),c.type[g]=1,!0;if(null!=d.meterIn[a.valueUnit])return c.minSize[g]=
-Infinity,c.maxSize[g]=Infinity,c.offset[g]=0,c.factor[g]=1/d.meterIn[a.valueUnit],c.type[g]=1,!0;"unknown"===a.valueUnit?f(h,"Could not convert size info: proportional size not supported"):f(h,"Could not convert size info: scale-dependent size not supported");return!1}if(!b(a.field)){if(a.stops&&a.stops[0]&&k(a.stops[0].size))return c.minSize[g]=a.stops[0].size,c.maxSize[g]=a.stops[0].size,c.offset[g]=c.minSize[g],c.factor[g]=0,c.type[g]=1,!0;if(k(p))return c.minSize[g]=p,c.maxSize[g]=p,c.offset[g]=
p,c.factor[g]=0,c.type[g]=1,!0}f(h,"Could not convert size info: unsupported variant of sizeInfo");return!1}function e(a,b,c,d,e,f){d=0<Math.abs(d-c)?(b-a)/(d-c):0;e.minSize[f]=0<d?a:b;e.maxSize[f]=0<d?b:a;e.offset[f]=a-c*d;e.factor[f]=d}function l(a,b,c,d){if(a.normalizationField||a.valueRepresentation)return f(d,"Could not convert size info: unsupported property"),null;var e=a.field;if(null!=e&&"string"!==typeof e)return f(d,"Could not convert size info: field is not a string"),null;if(!b.size)b.size=
{field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=a.field;else if(a.field!==b.size.field)return f(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(e=g(a,b.size,0,c,d))?b:null;case "height":return(e=g(a,b.size,2,c,d))?b:null;case "depth":return(e=g(a,b.size,1,c,d))?b:null;case "width-and-depth":return(e=g(a,b.size,0,c,d))&&g(a,b.size,1,c,d),e?b:null;case null:case void 0:case "all":return(e=
(e=(e=g(a,b.size,0,c,d))&&g(a,b.size,1,c,d))&&g(a,b.size,2,c,d))?b:null;default:return f(d,'Could not convert size info: unknown axis "'+a.axis+'""'),null}}function p(a,b,c){for(var d=0;3>d;++d){var e=b.unitInMeters;1===a.type[d]&&(e*=b.modelSize[d],a.type[d]=2);a.minSize[d]/=e;a.maxSize[d]/=e;a.offset[d]/=e;a.factor[d]/=e}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else if(0!==a.type[2])b=2;else return f(c,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=
a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function v(a,b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function q(a,c,d){if(a.normalizationField)return f(d,"Could not convert color info: unsupported property"),null;if("string"===typeof a.field)if(a.stops){if(8<a.stops.length)return f(d,"Could not convert color info: too many color stops"),null;c.color={field:a.field,values:[],colors:[]};a=a.stops;for(d=
0;8>d;++d){var e=a[Math.min(d,a.length-1)];c.color.values[d]=e.value;v(c.color.colors,d,e.color)}}else if(a.colors){if(!b(a.minDataValue)||!b(a.maxDataValue))return f(d,"Could not convert color info: missing data values"),null;if(2!==a.colors.length)return f(d,"Could not convert color info: invalid colors array"),null;c.color={field:a.field,values:[],colors:[]};c.color.values[0]=a.minDataValue;v(c.color.colors,0,a.colors[0]);c.color.values[1]=a.maxDataValue;v(c.color.colors,1,a.colors[1]);for(d=2;8>
d;++d)c.color.values[d]=a.maxDataValue,v(c.color.colors,d,a.colors[1])}else return f(d,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length||a.colors&&0<=a.colors.length)for(a=a.stops&&0<=a.stops.length?a.stops[0].color:a.colors[0],c.color={field:null,values:Array(8),colors:Array(32)},d=0;8>d;d++)c.color.values[d]=Infinity,v(c.color.colors,d,a);else return f(d,"Could not convert color info: no field and no colors/stops"),null;return c}function n(a,b,c,d){a=
2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function t(a,b,c){if("string"!==typeof a.field)return f(c,"Could not convert rotation info: field is not a string"),null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return f(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return n(a,
b.rotation,0,c),b;case "roll":return n(a,b.rotation,1,c),b;case null:case void 0:case "heading":return n(a,b.rotation,2,c),b;default:return f(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),null}}function u(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,e=!b.supportedTypes||!!b.supportedTypes.color,g=!b.supportedTypes||!!b.supportedTypes.rotation;return(a=a.reduce(function(a,k){if(!a)return a;if(k.valueExpression)return f(c,"Could not convert visual variables: arcade expressions not supported"),
null;switch(k.type){case "size":return d?l(k,a,b,c):a;case "color":return e?q(k,a,c):a;case "rotation":return g?t(k,a,c):a;default:return f(c,"Could not convert visual variables: unsupported type "+k.type),null}},{size:null,color:null,rotation:null}))&&a.size&&!p(a.size,b,c)?null:a}function x(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function r(a,b){var c=
{vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvSymbolAnchor:null,vvSymbolRotation:null},d=a&&null!=a.size;a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&d&&(c.vvSizeValue=b.transformation.scale);a&&d&&(c.vvSymbolAnchor=b.transformation.anchor,c.vvSymbolRotation=b.transformation.rotation);
a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors);return c}Object.defineProperty(h,"__esModule",{value:!0});h.convertVisualVariables=u;h.initFastSymbolUpdatesState=function(a,b,c){return b&&a&&!a.disableFastUpdates?(a=u(a.visualVariables,c))?{enabled:!0,visualVariables:a,materialParameters:r(a,c),customTransformation:a&&null!=a.size}:{enabled:!1}:{enabled:!1}};h.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;
b=u(b.visualVariables,c);if(!(b&&x(d.size,b.size,"size")&&x(d.color,b.color,"color")&&x(d.rotation,b.rotation,"rotation")))return!1;a.visualVariables=b;a.materialParameters=r(b,c);a.customTransformation=b&&null!=b.size;return!0};h.getMaterialParams=r;var z;(function(b){var d=c.mat4d,e=c.vec3,f=d.create(),g=e.create();b.evaluateModelTransform=function(b,c,e){if(!b.vvSizeEnabled)return e;d.identity(f);d.multiply(e,f,f);a.computeObjectRotation(b.vvSymbolRotation[2],b.vvSymbolRotation[0],b.vvSymbolRotation[1],
f);if(b.vvSizeEnabled){for(e=0;3>e;++e){var k=b.vvSizeOffset[e]+c[0]*b.vvSizeFactor[e],l=e;var h=b.vvSizeMinSize[e],p=b.vvSizeMaxSize[e],k=k<h?h:k>p?p:k;g[l]=k}d.scale(f,g,f)}else d.scale(f,b.vvSizeValue,f);d.translate(f,b.vvSymbolAnchor,f);return f}})(z||(z={}));h.evaluateModelTransform=z.evaluateModelTransform})},"esri/views/3d/layers/graphics/Graphics3DObjectSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ../../../../Color ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./graphicUtils ../support/FastSymbolUpdates ./objectResourceUtils ../../lib/glMatrix ../../../../symbols/ObjectSymbol3DLayer ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z){var B=q.mat4d,C=q.vec3d,A=[1,1,1],D=[1,1,1,1],E=[0,0,0];m=[-.5,-.5,-.5,.5,.5,.5];h=[-.5,-.5,0,.5,.5,1];var H={sphere:m,cube:m,cylinder:h,cone:h,"inverted-cone":h,tetrahedron:[-.5,-.5,0,.5,.5,.5],diamond:m},G=[u.ModelContentType.MATERIAL,u.ModelContentType.TEXTURE,u.ModelContentType.GEOMETRY];k=function(k){function h(){return null!==k&&k.apply(this,arguments)||this}d(h,k);h.prototype._prepareResources=function(){var a=this.symbol,b=this._getStageIdHint();
if(!this._isPropertyDriven("size")){var c=l.validateSymbolLayerSize(this.symbol);if(c){this._logWarning(c);this.reject();return}}a.resource&&a.resource.href?this._prepareModelResources(a.resource.href,b):this._preparePrimitiveResources(a.resource?a.resource.primitive:"sphere",b)};h.prototype._preparePrimitiveResources=function(d,e){var f=this.symbol;if("sphere"===d)this._geometryData=r.createPolySphereGeometry(.5,2,!0);else if("cube"===d)this._geometryData=r.createBoxGeometry(1);else if("cylinder"===
d)this._geometryData=r.createCylinderGeometry(1,.5,32,[0,0,1],[0,0,.5]);else if("cone"===d)this._geometryData=r.createConeGeometry(1,.5,15,!1),r.cgToGIS(this._geometryData);else if("inverted-cone"===d)this._geometryData=r.createConeGeometry(1,.5,15,!0),r.cgToGIS(this._geometryData);else if("tetrahedron"===d)this._geometryData=r.createTetrahedronGeometry(1),r.cgToGIS(this._geometryData);else if("diamond"===d)this._geometryData=r.createDiamondGeometry(1),r.cgToGIS(this._geometryData);else{this._logWarning("Unknown object symbol primitive: "+
d);this.reject();return}this._geometry=new x(this._geometryData,e);this._context.stage.add(u.ModelContentType.GEOMETRY,this._geometry);this._resourceBoundingBox=H[d];this._resourceSize=t.size(this._resourceBoundingBox);this._symbolSize=l.computeSizeWithResourceSize(this._resourceSize,f);d=this._getMaterialOpacity();d={specular:[0,0,0],shininess:3,opacity:d,transparent:1>d||this._isPropertyDriven("opacity"),instanced:["transformation"],ambient:A,diffuse:A};var g=this.symbolContainer;if("point-symbol-3d"===
g.type&&g.verticalOffset){var g=g.verticalOffset,k=g.minWorldLength,h=g.maxWorldLength;d.verticalOffset={screenLength:b.pt2px(g.screenLength),minWorldLength:k||0,maxWorldLength:null!=h?h:Infinity};d.castShadows=!1}this._context.screenSizePerspectiveEnabled&&(d.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings);this._isPropertyDriven("color")?d.externalColor=D:(g=f.material?a.toUnitRGBA(f.material.color):D,d.externalColor=g);f.material&&f.material.colorMixMode&&(d.colorMixMode=
f.material.colorMixMode);this._fastUpdates=p.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled?(c.mixin(d,this._fastUpdates.materialParameters),d.instanced.push("featureAttribute")):this._hasPerInstanceColor()&&d.instanced.push("color");this._material=new z(d,e+"_objectmat");this._context.stage.add(u.ModelContentType.MATERIAL,this._material);this.resolve()};h.prototype._prepareModelResources=
function(a,d){var e=this,f=["transformation"];d={materialParamsMixin:{instanced:f},idHint:d,streamDataSupplier:this._context.streamDataSupplier};this._fastUpdates=p.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled?(c.mixin(d.materialParamsMixin,this._fastUpdates.materialParameters),f.push("featureAttribute")):this._hasPerInstanceColor()&&f.push("color");f=this.symbolContainer;if("point-symbol-3d"===
f.type&&f.verticalOffset){var f=f.verticalOffset,g=f.minWorldLength,k=f.maxWorldLength;d.materialParamsMixin.verticalOffset={screenLength:b.pt2px(f.screenLength),minWorldLength:g||0,maxWorldLength:null!=k?k:Infinity};d.materialParamsMixin.castShadows=!1}this._symbolLoaderPromise=v.fetch(a,d);this._symbolLoaderPromise.then(function(a){e._symbolLoaderPromise=null;if(!e.isRejected()){var b=e._context,c=a.stageResources,d=b.stage,f=e._getExternalColorParameters(e.symbol.material),g=e._getMaterialOpacity(),
k=e._isPropertyDriven("opacity"),h=c[u.ModelContentType.MATERIAL];a.originalMaterialOpacities=Array(h.length);h.forEach(function(c,d){var e=c.getParameterValues();c.setParameterValues(f);a.originalMaterialOpacities[d]=e.opacity;e.opacity*=g;e.transparent=1>e.opacity;c.setParameterValues({opacity:e.opacity,transparent:e.transparent||k});b.screenSizePerspectiveEnabled&&(e.screenSizePerspective=b.sharedResources.screenSizePerspectiveSettings,c.setParameterValues({screenSizePerspective:e.screenSizePerspective}))});
G.forEach(function(a){for(var b=c[a],e=0;b&&e<b.length;e++)d.add(a,b[e])});e._resourceBoundingBox=v.computeBoundingBox(a);e._resourceSize=t.size(e._resourceBoundingBox);e._pivotOffset=a.pivotOffset;e._symbolSize=l.computeSizeWithResourceSize(e._resourceSize,e.symbol);e._i3sModel=a;p.updateFastSymbolUpdatesState(e._fastUpdates,e._context.renderer,e._fastVisualVariableConvertOptions())&&h.forEach(function(a){return a.setParameterValues(e._fastUpdates.materialParameters)});e.resolve()}},function(){e._symbolLoaderPromise=
null;e.isFulfilled()||e.reject()})};h.prototype._forEachMaterial=function(a){this._i3sModel?this._i3sModel.stageResources[u.ModelContentType.MATERIAL].forEach(a):a(this._material)};h.prototype._getExternalColorParameters=function(b){var c={};b&&b.colorMixMode&&(c.colorMixMode=b.colorMixMode);this._isPropertyDriven("color")?c.externalColor=D:b&&b.color?c.externalColor=a.toUnitRGBA(b.color):(c.externalColor=D,c.colorMixMode="ignore");return c};h.prototype.destroy=function(){this.isFulfilled()||this.reject();
this._symbolLoaderPromise&&this._symbolLoaderPromise.cancel();var a=this._context.stage;if(this._i3sModel){var b=this._i3sModel.stageResources;G.forEach(function(c){for(var d=b[c],e=0;d&&e<d.length;e++)a.remove(c,d[e].getId())})}else this._material&&a.remove(u.ModelContentType.MATERIAL,this._material.getId()),this._geometry&&a.remove(u.ModelContentType.GEOMETRY,this._geometry.getId())};h.prototype._getGeometry=function(a){a=a.geometry;return"polyline"===a.type?e.placePointOnPolyline(a):"polygon"===
a.type?e.placePointOnPolygon(a):"extent"===a.type?a.center:"point"!==a.type?(this._logWarning("unsupported geometry type for object symbol: "+a.type),null):a};h.prototype.createGraphics3DGraphic=function(a,b){var c=this._getGeometry(a);if(null===c)return null;var d="graphic"+a.uid,e=this.getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,e,d,a.uid)};h.prototype.layerPropertyChanged=function(a,b,c){var d=this;if("opacity"===a){var f=this._isPropertyDriven("opacity");if(this._i3sModel){var g=
this._getMaterialOpacity();this._i3sModel.stageResources[u.ModelContentType.MATERIAL].forEach(function(a,b){b=d._i3sModel.originalMaterialOpacities[b]*g;a.setParameterValues({opacity:b,transparent:1>b||f})})}else b=this._getMaterialOpacity(),this._material.setParameterValues({opacity:b,transparent:1>b||f});return!0}if("elevationInfo"===a){this._updateElevationInfo();for(var k in b){var l=b[k];if(a=c(l))l=this.getGraphicElevationInfo(l.graphic),a.needsElevationUpdates=e.needsElevationUpdates3D(l.mode),
a.elevationInfo.set(l)}return!0}return!1};h.prototype.applyRendererDiff=function(a,b,c,d){var e=this,f;for(f in a.diff)switch(f){case "visualVariables":if(p.updateFastSymbolUpdatesState(this._fastUpdates,b,this._fastVisualVariableConvertOptions()))this._forEachMaterial(function(a){return a.setParameterValues(e._fastUpdates.materialParameters)});else return!1;break;default:return!1}return!0};h.prototype._createAs3DShape=function(a,b,c,d,k,h){var n=this,m=null,q=null;if(a=this._getFastUpdateAttrValues(a))m=
m||{},m.featureAttribute=a,q=function(a){return p.evaluateModelTransform(n._fastUpdates.materialParameters,m.featureAttribute,a)};!this._fastUpdates.enabled&&this._hasPerInstanceColor()&&(m=m||{},m.color=l.mixinColorAndOpacity(c.color,c.opacity));a=this._context.layer.id;var t=B.identity();this._applyObjectRotation(c,t);this._applyObjectRotation(this.symbol,t);this._applyObjectScale(c,t);this._applyAnchor(t);if(this._i3sModel){c=this._i3sModel.stageResources[u.ModelContentType.GEOMETRY];for(var r=
this._i3sModel.materialsByComponent,v=Array(c.length),x=0;x<t.length;x++)v[x]=t;k=e.createStageObjectForPoint.call(this,b,c,r,v,m,d,k,a,h,null,q)}else k=e.createStageObjectForPoint.call(this,b,[this._geometry],[[this._material]],[t],m,d,k,a,h,null,q);if(null===k)return null;if(this._fastUpdates.enabled){var z=p.getMaterialParams(this._fastUpdates.visualVariables,this._fastVisualVariableConvertOptions());this._forEachMaterial(function(a){return a.setParameterValues(z)})}k.object.setCastShadow(!0);
h=new f(this,k.object,null,null,null,g.perObjectElevationAligner,d,f.VisibilityModes.REMOVE_OBJECT);h.alignedTerrainElevation=k.terrainElevation;h.needsElevationUpdates=e.needsElevationUpdates3D(d.mode);e.extendPointGraphicElevationInfo(h,b,this._context.elevationProvider);return h};h.prototype._applyObjectScale=function(a,b){this._fastUpdates.enabled&&this._fastUpdates.customTransformation||(a=this._isPropertyDriven("size")&&a.size?a.size:this._symbolSize,a=l.computeObjectScale(a,this._symbolSize,
this._resourceSize,this._context.renderCoordsHelper.unitInMeters),1===a[0]&&1===a[1]&&1===a[2]||B.scale(b,a))};h.prototype._applyObjectRotation=function(a,b){if(!(this._fastUpdates.enabled&&this._fastUpdates.customTransformation&&a instanceof n))return l.computeObjectRotation(a.heading,a.tilt,a.roll,b)};h.prototype._computeAnchor=function(){switch(this.symbol.anchor){case "center":return C.scale(t.center(this._resourceBoundingBox),-1);case "bottom":var a=t.center(this._resourceBoundingBox);return[-a[0],
-a[1],-this._resourceBoundingBox[2]];default:return this._pivotOffset?C.scale(this._pivotOffset,-1,Array(3)):E}};h.prototype._applyAnchor=function(a){if(!this._fastUpdates.enabled||!this._fastUpdates.customTransformation){var b=this._computeAnchor();b&&B.translate(a,b)}};h.prototype._hasPerInstanceColor=function(){return this._isPropertyDriven("color")||this._isPropertyDriven("opacity")};h.prototype._supportsShaderVisualVariables=function(){return this._context.stage.has("angleInstancedArrays")?!0:
!1};h.prototype._fastVisualVariableConvertOptions=function(){var a=this._resourceBoundingBox?t.size(this._resourceBoundingBox):A,b=this._resourceBoundingBox?this._computeAnchor():E,c=this._context.renderCoordsHelper.unitInMeters,d=l.computeObjectScale(this._symbolSize,this._symbolSize,this._resourceSize,c);return{modelSize:a,symbolSize:this._symbolSize||A,unitInMeters:c,transformation:{anchor:b,scale:d,rotation:[this.symbol.tilt||0,this.symbol.roll||0,this.symbol.heading||0]}}};return h}(k);k.PRIMITIVE_BOUNDING_BOX=
H;return k})},"esri/views/3d/layers/graphics/objectResourceUtils":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojo/Deferred ../../../../request ../../../../core/Version ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Texture ../../support/aaBoundingBox".split(" "),function(m,h,d,c,a,b,k,f,g,e,l,p,v,
q,n){function t(a,b){var d=[],e=[],f=[],h=[],n=[],m=k.Version.parse(a.version||"1.0","wosr");r.validate(m);var m="meshsymbol_"+a.model.name,t=a.textureDefinitions,u={},z;for(z in t){var B=t[z],L=B.images[0].data;x(L,"symbol resources must have embedded texture data (at the moment)");var M="/textureDefinitions/"+z,L=new q(B.encoding+";base64,"+L,m,{noUnpackFlip:!0});n.push(L);u[M]={engineTexObj:L,transparent:"rgba"===B.channels}}z=a.model.geometries;t=a.materialDefinitions;for(B=0;B<z.length;B++){var K=
z[B];K.params.components||(M=K,L=M.params,x(L.material),L.components=[{id:1,material:M.params.material,texture:M.params.texture,region:M.params.texture}],L.faces&&(L.faces.componentIndices=[L.faces.position.count]));var M=K.params.components,ba=M.length,L=K.params.faces,X=K.params.vertexAttributes,T=K.params.topology||"Indexed",K={},V;for(V in X){var P=X[V],W=P.values;x(P.values,"symbol resources with external geometry bin not yet supported");K[V]={data:W,size:P.valuesPerElement}}X=void 0;P=Array(ba);
if("Indexed"===T){var X=L.componentIndices,U;for(U in L);}else"PerAttributeArray"!==T?console.warn("I3S symbol loader: unsupported topology type "+T):1!==ba&&console.warn("I3S symbol loader: if topology is not Indexed, only single component geometries are supported");f.push([]);for(ba=0;ba<M.length;ba++){T=M[ba];W={type:"triangle",positionKey:"position",indices:{}};if(X)for(var Y in L){if("componentIndices"!==Y){var S=L[Y];x(S.values,"symbol resources with external geometry bin not yet supported");
W.indices[Y]=new Uint32Array(S.values)}}else{for(var S=K.position.data.length/K.position.size,ca=new Uint32Array(S),ga=0;ga<S;ga++)ca[ga]=ga;var S=ca,ea;for(ea in K)W.indices[ea]=S}P[ba]=W;W=void 0;T.texture&&(W=u[T.texture].engineTexObj.getId());S=h[T.material]?h[T.material][T.texture]:null;S||(S=T.material.substring(T.material.lastIndexOf("/")+1),S=t[S].params,1===S.transparency&&(S.transparency=0),W={ambient:S.diffuse,diffuse:S.diffuse,specular:[0,0,0],shininess:0,opacity:1-S.transparency,transparent:0<
S.transparency,textureId:W,doubleSided:!0,cullFace:"none",flipV:!1,colorMixMode:S.externalColorMixMode||"tint"},b.materialParamsMixin&&c.mixin(W,b.materialParamsMixin),S=new v(W,m),h[T.material]||(h[T.material]={}),h[T.material][T.texture]=S,e.push(S));f[B].push(S)}M=new l(new p(P,K),m);d.push(M)}return{stageResources:(aa={},aa[g.ModelContentType.TEXTURE]=n,aa[g.ModelContentType.MATERIAL]=e,aa[g.ModelContentType.GEOMETRY]=d,aa),materialsByComponent:f,pivotOffset:a.model.pivotOffset};var aa}Object.defineProperty(h,
"__esModule",{value:!0});var u=f.vec3d,x=e.assert,r=new k.Version(1,1,"wosr");h.fetch=function(c,d){d=d||{};if(d.streamDataSupplier){var e=d.streamDataSupplier.request(c,"json"),f=new a(function(){return d.streamDataSupplier.cancelRequest(e)});e.then(function(a,b){a=t(b,d);f.resolve(a)},function(){f.reject()});return f.promise}var g=b(c),k=new a(function(){return g.cancel()});g.then(function(a){a=t(a.data,d);k.resolve(a)},function(){k.reject()});return k.promise};h.computeBoundingBox=function(a){a=
a.stageResources[g.ModelContentType.GEOMETRY];for(var b=n.create(n.NEGATIVE_INFINITY),c=[0,0,0],d=[0,0,0],e=0;e<a.length;e++)for(var f=a[e],k=f.getNumGroups(),l=0;l<k;++l){var h=f.getBoundingInfo(l);u.set(h.getBBMin(),c);u.set(h.getBBMax(),d);for(h=0;3>h;++h)b[h]=Math.min(b[h],c[h]),b[h+3]=Math.max(b[h+3],d[h])}return b};h.createStageResources=t})},"esri/core/Version":function(){define(["require","exports","./Error"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function c(a,
b,c){void 0===c&&(c="");this.major=a;this.minor=b;this._context=c}c.prototype.validate=function(a){if(this.major!==a.major)throw new d((this._context&&this._context+":")+"unsupported-version","Required major "+(this._context&&this._context+" ")+"version is '"+this.major+"', but got '${version.major}.${version.minor}'",{version:a});};c.parse=function(a,b){void 0===b&&(b="");var k=a.split("."),f=k[0],k=k[1],g=/^\s*\d+\s*$/;if(!f||!f.match||!f.match(g))throw new d((b&&b+":")+"invalid-version","Expected major version to be a number, but got '${version}'",
{version:a});if(!k||!k.match||!k.match(g))throw new d((b&&b+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:a});a=parseInt(f,10);f=parseInt(k,10);return new c(a,f,b)};return c}();h.Version=m})},"esri/views/3d/layers/graphics/Graphics3DLineSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ../../../../core/screenUtils ../../../../geometry/Polygon ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/RenderGeometry ./graphicUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u){var x=p.vec3d,r=p.mat4d;return function(c){function h(){return null!==c&&c.apply(this,arguments)||this}d(h,c);h.prototype._prepareResources=function(){var a=this.symbol,b=this._isPropertyDriven("size")||this._isPropertyDriven("color")||this._isPropertyDriven("opacity"),a={idHint:this._getStageIdHint(),width:this._getWidth(a),color:this._getMaterialOpacityAndColor()};if(!this._isPropertyDriven("size")){var c=u.validateSymbolLayerSize(a.width);if(c){this._logWarning(c);
this.reject();return}}if(b||1.5<=a.width)this._isPropertyDriven("size")&&(a.width=0),this._isNativeLineMaterial=!1,this._material=g.createRibbonMaterial(a);else if(0<a.width)this._isNativeLineMaterial=!0,this._material=g.createNativeMaterial(a);else{this.reject();return}this._context.stage.add(v.ModelContentType.MATERIAL,this._material);this.resolve()};h.prototype._getWidth=function(a){return null!=a.size?e.pt2px(a.size):1};h.prototype.destroy=function(){this.isFulfilled()||this.reject();this._material&&
(this._context.stage.remove(v.ModelContentType.MATERIAL,this._material.getId()),this._material=null)};h.prototype.createGraphics3DGraphic=function(a,b){var c=a.geometry;if("polyline"!==c.type&&"polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for line symbol: "+c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.uid,g=this._getVertexOpacityAndColor(b,Float32Array,255),k=0;b.size&&this._isPropertyDriven("size")&&(k=f.getSingleSizeDriver(b.size),
k=e.pt2px(k));b=this.getGraphicElevationInfo(a);return"on-the-ground"===b.mode?this._createAsOverlay(a,c,g,k,b,d):this._createAs3DShape(a,c,g,k,b,d,a.uid)};h.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)return this._isNativeLineMaterial?(b=this._material.getColor(),b[3]=this._getMaterialOpacity(),this._material.setColor(b)):(b=this._material.getParameterValues(),b.color[3]=this._getMaterialOpacity(),this._material.setParameterValues({color:b.color})),!0;if("elevationInfo"===a){a=
this._elevationInfo.mode;this._updateElevationInfo();var d=this._elevationInfo.mode;if(null==a||null==d)return!1;if("on-the-ground"===a&&"on-the-ground"===d)return!0;if(a!==d&&("on-the-ground"===a||"on-the-ground"===d))return!1;a=f.needsElevationUpdates2D(d);for(var e in b){var g=b[e];(d=c(g))&&!d.isDraped()&&(g=g.graphic,d.needsElevationUpdates=a,d.elevationInfo.set(this.getGraphicElevationInfo(g)))}return!0}return!1};h.prototype._getOutlineGeometry=function(a,b){return a._outlineSegments?g.createOutlineGeometryFromSegments(b,
a._outlineSegments):b};h.prototype._getGeometry=function(a){a=a.geometry;"extent"===a.type&&(a=l.fromExtent(a));return a};h.prototype._createAs3DShape=function(b,c,d,e,l,h,p){var m=this._getGeometry(b),t=m.hasZ,v=this._getOutlineGeometry(m,m[c]);if(0<v.length){b=[];for(var u=[],z=[],B=x.create(),A=Array(6),m=f.getGeometryVertexData3D(v,t,m.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,l),t=m.geometryData.outlines,v=m.eleVertexData,D=m.vertexData,C=0;C<t.length;++C){var H=
t[C],E=H.index,G=H.count;if(this._context.clippingExtent&&(f.computeBoundingBox(v,E,G,A),f.boundingBoxClipped(A,this._context.clippingExtent)))continue;f.chooseOrigin(D,E,G,B);f.subtractCoordinates(D,E,G,B);H=new Float64Array(v.buffer,3*E*v.BYTES_PER_ELEMENT,3*G);E=new Float64Array(D.buffer,3*E*D.BYTES_PER_ELEMENT,3*G);E=g.createPolylineGeometry(E,H,"rings"===c,d,e);E=new n(E,h+"path"+C);E.singleUse=!0;b.push(E);u.push([this._material]);E=r.identity();r.translate(E,B,E);z.push(E)}if(0<b.length)return c=
new q({geometries:b,materials:u,transformations:z,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:p},idHint:h}),c=new a(this,c,b,null,null,k.perVertexElevationAligner,l),c.alignedTerrainElevation=m.terrainElevation,c.needsElevationUpdates=f.needsElevationUpdates2D(l.mode),c}return null};h.prototype._createAsOverlay=function(a,c,d,e,k,l){var h=this._getGeometry(a);this._material.setRenderPriority(this._symbolLayerOrder);var p=this._getOutlineGeometry(h,h[c]);if(0<p.length){a=[];for(var n=
Array(6),m=x.create(),p=f.getGeometryVertexDataDraped(p,h.spatialReference,this._context.overlaySR),h=p.vertexData,p=p.geometryData.outlines,q=0;q<p.length;++q){var v=p[q],u=v.index,v=v.count;f.computeBoundingBox(h,u,v,n);if(!f.boundingBoxClipped(n,this._context.clippingExtent)){f.chooseOrigin(h,u,v,m);f.subtractCoordinates(h,u,v,m);f.setZ(h,u,v,this._getDrapedZ());v=new Float64Array(h.buffer,3*u*h.BYTES_PER_ELEMENT,3*v);u=r.identity();r.translate(u,m,u);var v=g.createPolylineGeometry(v,null,"rings"===
c,d,e),z=new t(v);z.material=this._material;z.center=[.5*(n[0]+n[3]),.5*(n[1]+n[4]),0];z.bsRadius=.5*Math.sqrt((n[3]-n[0])*(n[3]-n[0])+(n[4]-n[1])*(n[4]-n[1]));z.transformation=u;z.name=l;z.uniqueName=l+"#"+v.id;a.push(z)}}return new b(this,a,null,null,n,k)}return null};return h}(c)})},"esri/views/3d/layers/graphics/lineUtils":function(){define("require exports ../../webgl-engine/materials/RibbonLineMaterial ../../webgl-engine/materials/NativeLineMaterial ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Util".split(" "),
function(m,h,d,c,a,b){function k(a){var b=a.length;return a[0]===a[b-3]&&a[1]===a[b-2]&&a[2]===a[b-1]}Object.defineProperty(h,"__esModule",{value:!0});var f=b.VertexAttrConstants;h.createRibbonMaterial=function(a){var b={width:a.width,color:a.color,miterLimit:a.miterLimit,polygonOffset:!0};"miter"===a.join||"bevel"===a.join?b.join=a.join:(b.join="miter",a.join&&console.warn("unsupported join type for line symbol: "+a.join));return new d(b,a.idHint+"_ribbonlinemat")};h.createNativeMaterial=function(a){return new c(a.width,
a.color,a.idHint+"_nativelinemat")};h.createOutlineGeometryFromSegments=function(a,b){for(var c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<b[d].length;f++){for(var g=b[d][f],k=[],h=g[0];h<g[1];h++)k.push(e[h]);0<k.length&&c.push(k)}return c};h.isClosed=k;h.createPolylineGeometry=function(b,c,d,h,m){var e,g,l;if(d=d&&!k(b)){d=new Float32Array(b.length+3);for(g=0;g<b.length;g++)d[g]=b[g];g=d.length;d[g-3]=b[0];d[g-2]=b[1];d[g-1]=b[2];e=b.length/3+1;g=new Uint32Array(2*(e-1));l=new Uint32Array(2*(e-
1))}else e=b.length/3,g=new Uint32Array(2*(e-1)),l=new Uint32Array(2*(e-1)),d=b;b=new Float32Array(1);b[0]=m;for(var p=m=0,v=0;v<e-1;v++)g[m++]=v,g[m++]=v+1,l[p++]=0,l[p++]=0;m={};e={};m[f.POSITION]=g;m[f.COLOR]=l;m[f.SIZE]=l;e[f.POSITION]={size:3,data:d};e[f.COLOR]={size:4,data:h};e[f.SIZE]={size:1,data:b};c&&(m.mapPos=g,e.mapPos={size:3,data:c});return new a(e,m,a.DefaultOffsets,"line")}})},"esri/views/3d/webgl-engine/materials/NativeLineMaterial":function(){define("./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexBufferLayouts ../lib/ComponentUtils ../../../webgl/Util".split(" "),
function(m,h,d,c,a,b,k){var f=d.vec3d,g=d.vec2d,e=d.mat4d,l=h.VertexAttrConstants,p=f.create(),v=f.create(),q=f.create(),n=f.create(),t=g.create(),u=g.create(),x=f.create(),r=f.create(),z=function(c,d,g,H){"string"===typeof g&&(H=g,g=void 0);m.basicMaterialConstructor(this,H);this.lineType=g||z.LINES;var A=a.Pos3,D=k.getStride(A)/4;this.canBeMerged=this.lineType===z.LINES;this.setColor=function(a){d=a;this.notifyDirty("matChanged")};this.getColor=function(){return d};this.dispose=function(){};this.getOutputAmount=
function(a){a=a/2+1;if(this.lineType===z.STRIP)return a*D;if(this.lineType===z.LINES)return(2*a-2)*D};this.getVertexBufferLayout=function(){return A};this.fillInterleaved=function(a,b,c,d,e,f){a=a.vertexAttr[l.POSITION].data;if(b||this.lineType===z.LINES)for(d=a.length/3,c=0;c<d;c++){var g=3*c,k=a[g],h=a[g+1],p=a[g+2];if(b)var g=k,n=h,k=b[0]*g+b[4]*n+b[8]*p+b[12],h=b[1]*g+b[5]*n+b[9]*p+b[13],p=b[2]*g+b[6]*n+b[10]*p+b[14];e[f++]=k;e[f++]=h;e[f++]=p;this.lineType===z.LINES&&0!==c&&c!==d-1&&(e[f++]=
k,e[f++]=h,e[f++]=p)}else for(c=0;c<a.length;c++)e[f++]=a[c]};this.intersect=function(a,c,d,g,k,l,m){if(g.isSelection&&!b.isAllHidden(c.componentVisibilities,a.data.componentOffsets)){c=a.getData().getVertexAttr("position").position.data;a=Number.MAX_VALUE;var z,B;k=g.camera;l=g.point;for(var A=0;A<c.length-5;A+=3){p[0]=c[A];p[1]=c[A+1];p[2]=c[A+2];e.multiplyVec3(d,p);v[0]=c[A+3];v[1]=c[A+4];v[2]=c[A+5];e.multiplyVec3(d,v);k.projectPoint(p,t);k.projectPoint(v,u);if(0>t[2]&&0<u[2])f.subtract(p,v,q),
z=k.frustumPlanes,B=-(f.dot(z[4],p)+z[4][3]),z=B/f.dot(q,z[4]),f.scale(q,z,q),f.add(p,q,p),k.projectPoint(p,t);else if(0<t[2]&&0>u[2])f.subtract(v,p,q),z=k.frustumPlanes,B=-(f.dot(z[4],v)+z[4][3]),z=B/f.dot(q,z[4]),f.scale(q,z,q),f.add(v,q,v),k.projectPoint(v,u);else if(0>t[2]&&0>u[2])continue;z=h.projectVectorVector2D(t,u,l);z<a&&(a=z,f.set(p,x),f.set(v,r))}d=g.p0;g=g.p1;2>a&&(a=h.linelineDistance3D(x,r,d,g),c=Number.MAX_VALUE,a[0]&&(f.subtract(a[2],d,n),a=f.length(n),f.scale(n,1/a),c=a/f.dist(d,
g)),m(c,n))}};this.getGLMaterials=function(){return{color:B,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:C}};this.getAllTextureIds=function(){return[]}};z.STRIP=1;z.LINES=2;var B=function(a,b){m.basicGLMaterialConstructor(this,a);var d=b.get("simple"),e=a.getColor();this.beginSlot=function(a){return a===c.OPAQUE_MATERIAL};this.getProgram=function(){return d};this.bind=function(a,b){a.bindProgram(d);d.setUniform4fv("color",e);a.setBlendingEnabled(1>e[3]);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,
a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0)};this.release=function(a){1>e[3]&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){m.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(b){b=b.gl;return a.lineType===z.STRIP?b.LINE_STRIP:b.LINES}},C=function(a,b){m.basicGLMaterialConstructor(this,a);var d=b.get("highlight");this.beginSlot=function(a){return a===c.OPAQUE_MATERIAL};
this.getProgram=function(){return d};this.bind=function(a,b){a.bindProgram(d);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,b){m.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(b){b=b.gl;return a.lineType===z.STRIP?b.LINE_STRIP:b.LINES}};return z})},"esri/views/3d/layers/graphics/Graphics3DPathSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../../../geometry/Point ../../support/projectionUtils ../../../../views/3d/lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./graphicUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t){function u(a,c,d,e){for(var f=a.getGeometryRecords(),g=f.length,k="absolute-height"!==c.mode,l=0,h=0;h<g;h++){var p=f[h].geometry,n=[f[h].transformation[12],f[h].transformation[13],f[h].transformation[14]],m=p.getData().getVertexAttr(),q=m[B.POSITION].data,t=m.zOffset.data,m=m.mapPos.data,r=m.length/3;z(q.length/3===r*E+2,"unexpected tube geometry");var v=0,u=0;A.spatialReference=d.spatialReference;for(var x=0,H=0;H<r;H++){A.x=m[3*H];A.y=m[3*H+1];A.z=m[3*
H+2];var G=b.computeElevation(d,A,c,k?D:null);k&&(x+=D.terrainElevation);var I=E;0!==H&&H!==r-1||I++;for(var J=0;J<I;J++)C[0]=q[v]+n[0],C[1]=q[v+1]+n[1],C[2]=q[v+2]+n[2],e.setAltitude(G+t[u],C,0),q[v]=C[0]-n[0],q[v+1]=C[1]-n[1],q[v+2]=C[2]-n[2],v+=3,u+=1;p.invalidateBoundingInfo()}a.geometryVertexAttrsUpdated(h);l+=x/r}return l/g}var x=g.vec3d,r=g.mat4d,z=n.assert;m=function(c){function g(){return null!==c&&c.apply(this,arguments)||this}d(g,c);g.prototype._prepareResources=function(){if(!this._isPropertyDriven("size")){var a=
t.validateSymbolLayerSize(this._getSymbolSize());if(a){this._logWarning(a);this.reject();return}}var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),c=x.create(b),b=b[3],c={diffuse:c,ambient:c,opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:this._isPropertyDriven("color")||this._isPropertyDriven("opacity")};this._material=new q(c,a+"_3dlinemat");this._context.stage.add(e.ModelContentType.MATERIAL,this._material);this.resolve()};g.prototype.destroy=function(){this.isFulfilled()||
this.reject();this._material&&(this._context.stage.remove(e.ModelContentType.MATERIAL,this._material.getId()),this._material=null)};g.prototype.createGraphics3DGraphic=function(a,b){var c=a.geometry;if("polyline"!==c.type)return this._logWarning("unsupported geometry type for path symbol: "+c.type),null;var c="graphic"+a.uid,d=this.getGraphicElevationInfo(a);return this._createAs3DShape(a,b,d,c,a.uid)};g.prototype.layerPropertyChanged=function(a,c,d){if("opacity"===a)return c=this._getMaterialOpacity(),
d=1>c||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:c,transparent:d}),!0;if("elevationInfo"===a){this._updateElevationInfo();for(var e in c){var f=c[e];if(a=d(f))f=this.getGraphicElevationInfo(f.graphic),a.needsElevationUpdates=b.needsElevationUpdates3D(f.mode),a.elevationInfo.set(f)}return!0}return!1};g.prototype._getPathSize=function(a){a=a.size&&this._isPropertyDriven("size")?b.getSingleSizeDriver(a.size):this._getSymbolSize();return a/=this._context.renderCoordsHelper.unitInMeters};
g.prototype._getSymbolSize=function(){return this.symbol.size||1};g.prototype._createAs3DShape=function(c,d,e,g,k){var h=c.geometry,n=h.hasZ,m=h.paths;if(0<m.length){c=[];for(var q=[],t=[],z=x.create(),B=this._context.renderSpatialReference===f.SphericalRenderSpatialReference,A=Array(6),D=this._getPathSize(d),h=b.getGeometryVertexData3D(m,n,h.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,e),n=h.geometryData.outlines,m=h.eleVertexData,C=h.vertexData,H=0;H<n.length;++H){var F=
n[H],G=F.index,I=F.count;if(this._context.clippingExtent&&(b.computeBoundingBox(m,G,I,A),b.boundingBoxClipped(A,this._context.clippingExtent)))continue;b.chooseOrigin(C,G,I,z);b.subtractCoordinates(C,G,I,z);F=new Float64Array(m.buffer,3*G*m.BYTES_PER_ELEMENT,3*I);G=b.flatArrayToArrayOfArrays(C,G,I);G=v.createTubeGeometry(G,.5*D,E,B,z);G.getVertexAttr().mapPos={size:3,data:F};this._material.getParams().vertexColors&&(F=this._getVertexOpacityAndColor(d),G=v.addVertexColors(G,F,!0));F=new p(G,g+"path"+
H);F.singleUse=!0;c.push(F);q.push([this._material]);F=r.identity();r.translate(F,z,F);t.push(F)}if(0<c.length)return d=new l({geometries:c,materials:q,transformations:t,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:k},idHint:g}),d=new a(this,d,c,null,null,u,e),d.alignedTerrainElevation=h.terrainElevation,d.needsElevationUpdates=b.needsElevationUpdates3D(e.mode),d}return null};return g}(c);var B=n.VertexAttrConstants,C=x.create(),A=new k,D={verticalDistanceToGround:0,terrainElevation:0},
E=10;return m})},"esri/views/3d/layers/graphics/Graphics3DFillSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ./graphicUtils ../../../../geometry/Polygon ../../../../Color ../../lib/glMatrix ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A){var D=C.VertexAttrConstants;m=q.vec3d;var E=q.mat4d;a=function(a){function h(){var b=null!==a&&a.apply(this,arguments)||this;b._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0};return b}d(h,a);h.prototype._prepareResources=function(){this._prepareFillResources();this._prepareOutlineResources();this.resolve()};h.prototype._prepareFillResources=function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),b=
{color:b,transparent:1>b[3]||this._isPropertyDriven("opacity"),polygonOffset:!1,vertexColors:!0};this._material=new B(b,a+"_colormat");this._context.stage.add(t.ModelContentType.MATERIAL,this._material)};h.prototype._prepareOutlineResources=function(){var a=this.symbol.outline;if(this._hasOutline=!!(a&&a.size&&0<a.size&&a.color))a={idHint:this._getStageIdHint()+"_outline",color:this._getOutlineColor(),width:c.pt2px(a.size)},2<a.width?(this._outlineMaterial=e.createRibbonMaterial(a),this._isOutlineNativeLineMaterial=
!1):(this._outlineMaterial=e.createNativeMaterial(a),this._isOutlineNativeLineMaterial=!0),this._context.stage.add(t.ModelContentType.MATERIAL,this._outlineMaterial)};h.prototype.destroy=function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._material.getId()),this._material=null);this._outlineMaterial&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._outlineMaterial.getId()),this._outlineMaterial=null)};h.prototype.createGraphics3DGraphic=
function(a,b){var c=a.geometry;if("polyline"!==c.type&&"polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for fill symbol: "+c.type),null;c="graphic"+a.uid;b=this._getVertexOpacityAndColor(b,Uint8Array,255);var d=this.getGraphicElevationInfo(a);return"on-the-ground"===d.mode?this._createAsOverlay(a,b,d,c):this._createAs3DShape(a,b,d,c,a.uid)};h.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)return b=this._material.getColor(),b[3]=this._getMaterialOpacity(),
this._material.setColor(b),this._material.setTransparent(1>b[3]),this._outlineMaterial&&(this._isOutlineNativeLineMaterial?(b=this._outlineMaterial.getColor(),b[3]=this._getOutlineOpacity(),this._outlineMaterial.setColor(b)):(b=this._outlineMaterial.getParameterValues(),b.color[3]=this._getOutlineOpacity(),this._outlineMaterial.setParameterValues({color:b.color}))),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var d=this._elevationInfo.mode;if(null==a||null==d)return!1;
if("on-the-ground"===a&&"on-the-ground"===d)return!0;if(a!==d&&("on-the-ground"===a||"on-the-ground"===d))return!1;a=g.needsElevationUpdates2D(d);for(var e in b){var f=b[e];(d=c(f))&&!d.isDraped()&&(f=f.graphic,d.needsElevationUpdates=a,d.elevationInfo.set(this.getGraphicElevationInfo(f)))}return!0}return!1};h.prototype.setDrawOrder=function(a,b,c){this._material&&(this._material.setRenderPriority(a+b/2),c[this._material.getId()]=!0);this._outlineMaterial&&(this._outlineMaterial.setRenderPriority(a),
c[this._outlineMaterial.getId()]=!0)};h.prototype._createAs3DShape=function(a,c,d,e,k){a=this._getPolyGeometry(a);var h=a.hasZ,l=this._getOutlineGeometry(a,a.rings);a=g.getGeometryVertexData3D(l,h,a.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,d);I.idHint=e;I.color=c;I.isRings=!0;I.data=a;var p;this._hasOutline&&(p=new a.vertexData.constructor(a.vertexData));I.outNum=0;I.outGeometries=[];I.outTransforms=[];I.outMaterials=[];this._createAs3DShapeFill(I);I.data.vertexData=
p;this._createAs3DShapeOutline(I);if(0===I.outNum)return null;c=new u({geometries:I.outGeometries,materials:I.outMaterials,transformations:I.outTransforms,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:k},idHint:e});c=new b(this,c,I.outGeometries,null,null,f.perVertexElevationAligner,d);c.alignedTerrainElevation=a.terrainElevation;c.needsElevationUpdates=g.needsElevationUpdates2D(d.mode);return c};h.prototype._createAs3DShapeFill=function(a){for(var b=a.data.geometryData.polygons,
c=a.data.eleVertexData,d=a.data.vertexData,e=function(e){var k=b[e];e=k.count;var h=k.index;if(f._context.clippingExtent&&(g.computeBoundingBox(c,h,e,H),g.boundingBoxClipped(H,f._context.clippingExtent)))return"continue";var l=new Float64Array(c.buffer,3*h*c.BYTES_PER_ELEMENT,3*e),p=new Float64Array(d.buffer,3*h*d.BYTES_PER_ELEMENT,3*e),k=k.holeIndices.map(function(a){return a-h}),k=A(l,k,3);if(0===k.length)return"continue";g.chooseOrigin(d,h,e,G);g.subtractCoordinates(d,h,e,G);e=f._createFillGeometry(k,
0,p,l,a.color);e=new x(e,a.idHint);e.singleUse=!0;l=E.identity();E.translate(l,G,l);a.outGeometries.push(e);a.outMaterials.push([f._material]);a.outTransforms.push(l);a.outNum++},f=this,k=0;k<b.length;++k)e(k)};h.prototype._createAs3DShapeOutline=function(a){if(this._hasOutline)for(var b=a.data.geometryData.outlines,c=a.data.eleVertexData,d=a.data.vertexData,f=0;f<b.length;++f){var k=b[f],h=k.index,l=k.count;if(this._context.clippingExtent&&(g.computeBoundingBox(c,h,l,H),g.boundingBoxClipped(H,this._context.clippingExtent)))continue;
g.chooseOrigin(d,h,l,G);g.subtractCoordinates(d,h,l,G);k=new Float64Array(c.buffer,3*h*c.BYTES_PER_ELEMENT,3*l);h=new Float64Array(d.buffer,3*h*d.BYTES_PER_ELEMENT,3*l);h=e.createPolylineGeometry(h,k,a.isRings,J,0);h=new x(h,a.idHint+"outline"+f);h.singleUse=!0;k=E.identity();E.translate(k,G,k);a.outGeometries.push(h);a.outMaterials.push([this._outlineMaterial]);a.outTransforms.push(k);a.outNum++}};h.prototype._createAsOverlay=function(a,b,c,d){a=this._getPolyGeometry(a);var e=this._getOutlineGeometry(a,
a.rings);if(0===e.length)return null;this._material.setRenderPriority(this._symbolLayerOrder+this._symbolLayerOrderDelta/2);this._hasOutline&&this._outlineMaterial.setRenderPriority(this._symbolLayerOrder);a=g.getGeometryVertexDataDraped(e,a.spatialReference,this._context.overlaySR);I.idHint=d;I.color=b;I.isRings=!0;I.data=a;var f;this._hasOutline&&(f=new a.vertexData.constructor(a.vertexData));I.outNum=0;I.outGeometries=[];I.outBoundingBox=n.create(n.NEGATIVE_INFINITY);this._createAsOverlayFill(I);
I.data.vertexData=f;this._createAsOverlayOutline(I);return 0<I.outNum?new k(this,I.outGeometries,null,null,I.outBoundingBox,c):null};h.prototype._createAsOverlayFill=function(a){for(var b=a.data.vertexData,c=a.data.geometryData.polygons,d=function(d){var f=c[d];d=f.count;var k=f.index,h=new Float64Array(b.buffer,3*k*b.BYTES_PER_ELEMENT,3*d),f=f.holeIndices.map(function(a){return a-k}),h=A(h,f,3);if(0===h.length)return"continue";g.computeBoundingBox(b,k,d,H);if(g.boundingBoxClipped(H,e._context.clippingExtent))return"continue";
n.expand(a.outBoundingBox,H);g.chooseOrigin(b,k,d,G);g.subtractCoordinates(b,k,d,G);g.setZ(b,k,d,e._getDrapedZ());d=E.identity();E.translate(d,G,d);h=e._createFillGeometry(h,k,b,null,a.color);f=new z(h);f.material=e._material;var l=H;f.center=[.5*(l[0]+l[3]),.5*(l[1]+l[4]),0];f.bsRadius=.5*Math.sqrt((l[3]-l[0])*(l[3]-l[0])+(l[4]-l[1])*(l[4]-l[1]));f.transformation=d;f.name=a.idHint;f.uniqueName=a.idHint+"#"+h.id;a.outGeometries.push(f);a.outNum++},e=this,f=0;f<c.length;++f)d(f)};h.prototype._createAsOverlayOutline=
function(a){if(this._hasOutline)for(var b=a.data.vertexData,c=a.data.geometryData.outlines,d=0;d<c.length;++d){var f=c[d],k=f.index,f=f.count;g.computeBoundingBox(b,k,f,H);if(!g.boundingBoxClipped(H,this._context.clippingExtent)){n.expand(a.outBoundingBox,H);g.chooseOrigin(b,k,f,G);g.subtractCoordinates(b,k,f,G);g.setZ(b,k,f,this._getDrapedZ());f=new Float64Array(b.buffer,3*k*b.BYTES_PER_ELEMENT,3*f);k=E.identity();E.translate(k,G,k);var f=e.createPolylineGeometry(f,null,a.isRings,J,0),h=new z(f);
h.material=this._outlineMaterial;var l=H;h.center=[.5*(l[0]+l[3]),.5*(l[1]+l[4]),0];h.bsRadius=.5*Math.sqrt((l[3]-l[0])*(l[3]-l[0])+(l[4]-l[1])*(l[4]-l[1]));h.transformation=k;h.name=a.idHint+"outline";h.uniqueName=a.idHint+"outline#"+f.id;a.outGeometries.push(h);a.outNum++}}};h.prototype._getOutlineGeometry=function(a,b){return a._outlineSegments?e.createOutlineGeometryFromSegments(b,a._outlineSegments):b};h.prototype._getOutlineOpacity=function(){return this._getLayerOpacity()*this.symbol.outline.color.a};
h.prototype._getOutlineColor=function(){var a=this.symbol.outline.color,b=this._getOutlineOpacity();return l.mixinColorAndOpacity(v.toUnitRGB(a),b)};h.prototype._getPolyGeometry=function(a){a=a.geometry;return"extent"===a.type?p.fromExtent(a):a};h.prototype._createFillGeometry=function(a,b,c,d,e){for(var f=a.length,g=new Uint32Array(f),k=new Uint32Array(f),h=0;h<f;h++)g[h]=a[h]+b,k[h]=0;a={};b={};a[D.POSITION]=g;a[D.COLOR]=k;b[D.POSITION]={size:3,data:c};b[D.COLOR]={size:4,data:e};d&&(b.mapPos={size:3,
data:d},a.mapPos=g);return new r(b,a)};return h}(a);var H=n.create(),G=m.create(),J=new Float32Array([255,255,255,255]),I={idHint:null,color:null,isRings:!1,data:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null};return a})},"esri/views/3d/layers/graphics/earcut/earcut":function(){define([],function(){function m(e,g,k){k=k||2;var l=g&&g.length,p=l?g[0]*k:e.length,n=h(e,0,p,k,!0),m=[];if(!n)return m;var t,r,v,u;if(l){var x=k,l=[],z,B,M;u=0;for(z=g.length;u<z;u++)B=
g[u]*x,M=u<z-1?g[u+1]*x:e.length,B=h(e,B,M,x,!1),B===B.next&&(B.steiner=!0),l.push(f(B));l.sort(a);for(u=0;u<l.length;u++){g=l[u];x=n;if(x=b(g,x))g=q(x,g),d(g,g.next);n=d(n,n.next)}}if(e.length>80*k){t=v=e[0];r=l=e[1];for(x=k;x<p;x+=k)u=e[x],g=e[x+1],u<t&&(t=u),g<r&&(r=g),u>v&&(v=u),g>l&&(l=g);v=Math.max(v-t,l-r)}c(n,m,k,t,r,v);return m}function h(a,b,c,d,e){var f;if(e===0<x(a,b,c,d))for(e=b;e<c;e+=d)f=n(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=n(e,a[e],a[e+1],f);f&&l(f,f.next)&&(t(f),f=f.next);
return f}function d(a,b){if(!a)return a;b||(b=a);var c;do if(c=!1,a.steiner||!l(a,a.next)&&0!==e(a.prev,a,a.next))a=a.next;else{t(a);a=b=a.prev;if(a===a.next)return null;c=!0}while(c||a!==b);return b}function c(a,b,f,h,n,m,u){if(a){if(!u&&m){var r=a,x=r;do null===x.z&&(x.z=k(x.x,x.y,h,n,m)),x.prevZ=x.prev,x=x.nextZ=x.next;while(x!==r);x.prevZ.nextZ=null;x.prevZ=null;var r=x,z,B,A,C,D,E,K=1;do{x=r;A=r=null;for(C=0;x;){C++;B=x;for(z=D=0;z<K&&(D++,B=B.nextZ,B);z++);for(E=K;0<D||0<E&&B;)0===D?(z=B,B=
B.nextZ,E--):0!==E&&B?x.z<=B.z?(z=x,x=x.nextZ,D--):(z=B,B=B.nextZ,E--):(z=x,x=x.nextZ,D--),A?A.nextZ=z:r=z,z.prevZ=A,A=z;x=B}A.nextZ=null;K*=2}while(1<C)}for(r=a;a.prev!==a.next;){x=a.prev;B=a.next;if(m)a:{A=a;E=h;var ba=n,X=m;C=A.prev;D=A;K=A.next;if(0<=e(C,D,K))A=!1;else{var T=C.x>D.x?C.x>K.x?C.x:K.x:D.x>K.x?D.x:K.x,V=C.y>D.y?C.y>K.y?C.y:K.y:D.y>K.y?D.y:K.y;z=k(C.x<D.x?C.x<K.x?C.x:K.x:D.x<K.x?D.x:K.x,C.y<D.y?C.y<K.y?C.y:K.y:D.y<K.y?D.y:K.y,E,ba,X);E=k(T,V,E,ba,X);for(ba=A.nextZ;ba&&ba.z<=E;){if(ba!==
A.prev&&ba!==A.next&&g(C.x,C.y,D.x,D.y,K.x,K.y,ba.x,ba.y)&&0<=e(ba.prev,ba,ba.next)){A=!1;break a}ba=ba.nextZ}for(ba=A.prevZ;ba&&ba.z>=z;){if(ba!==A.prev&&ba!==A.next&&g(C.x,C.y,D.x,D.y,K.x,K.y,ba.x,ba.y)&&0<=e(ba.prev,ba,ba.next)){A=!1;break a}ba=ba.prevZ}A=!0}}else a:if(A=a,C=A.prev,D=A,K=A.next,0<=e(C,D,K))A=!1;else{for(z=A.next.next;z!==A.prev;){if(g(C.x,C.y,D.x,D.y,K.x,K.y,z.x,z.y)&&0<=e(z.prev,z,z.next)){A=!1;break a}z=z.next}A=!0}if(A)b.push(x.i/f),b.push(a.i/f),b.push(B.i/f),t(a),r=a=B.next;
else if(a=B,a===r){if(!u)c(d(a),b,f,h,n,m,1);else if(1===u){u=b;r=f;x=a;do B=x.prev,A=x.next.next,!l(B,A)&&p(B,x,x.next,A)&&v(B,A)&&v(A,B)&&(u.push(B.i/r),u.push(x.i/r),u.push(A.i/r),t(x),t(x.next),x=a=A),x=x.next;while(x!==a);a=x;c(a,b,f,h,n,m,2)}else if(2===u)a:{u=a;do{for(r=u.next.next;r!==u.prev;){if(x=u.i!==r.i){x=u;B=r;A=void 0;if(A=x.next.i!==B.i&&x.prev.i!==B.i){A=void 0;b:{A=x;do{if(A.i!==x.i&&A.next.i!==x.i&&A.i!==B.i&&A.next.i!==B.i&&p(A,A.next,x,B)){A=!0;break b}A=A.next}while(A!==x);
A=!1}A=!A}C=void 0;if(C=A&&v(x,B)&&v(B,x)){A=x;C=!1;D=(x.x+B.x)/2;B=(x.y+B.y)/2;do A.y>B!==A.next.y>B&&D<(A.next.x-A.x)*(B-A.y)/(A.next.y-A.y)+A.x&&(C=!C),A=A.next;while(A!==x)}x=C}if(x){a=q(u,r);u=d(u,u.next);a=d(a,a.next);c(u,b,f,h,n,m);c(a,b,f,h,n,m);break a}r=r.next}u=u.next}while(u!==a)}break}}}}function a(a,b){return a.x-b.x}function b(a,b){var c=b,d=a.x,e=a.y,f=-Infinity,k;do{if(e<=c.y&&e>=c.next.y){var h=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(h<=d&&h>f){f=h;if(h===d){if(e===c.y)return c;
if(e===c.next.y)return c.next}k=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!k)return null;if(d===f)return k.prev;b=k;for(var h=k.x,l=k.y,p=Infinity,n,c=k.next;c!==b;)d>=c.x&&c.x>=h&&g(e<l?d:f,e,h,l,e<l?f:d,e,c.x,c.y)&&(n=Math.abs(e-c.y)/(d-c.x),(n<p||n===p&&c.x>k.x)&&v(c,a)&&(k=c,p=n)),c=c.next;return k}function k(a,b,c,d,e){a=32767*(a-c)/e;b=32767*(b-d)/e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&
1431655765|((b|b<<1)&1431655765)<<1}function f(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function g(a,b,c,d,e,f,g,k){return 0<=(e-g)*(b-k)-(a-g)*(f-k)&&0<=(a-g)*(d-k)-(c-g)*(b-k)&&0<=(c-g)*(f-k)-(e-g)*(d-k)}function e(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function l(a,b){return a.x===b.x&&a.y===b.y}function p(a,b,c,d){return l(a,b)&&l(c,d)||l(a,d)&&l(c,b)?!0:0<e(a,b,c)!==0<e(a,b,d)&&0<e(c,d,a)!==0<e(c,d,b)}function v(a,b){return 0>e(a.prev,a,a.next)?0<=e(a,b,a.next)&&
0<=e(a,a.prev,b):0>e(a,b,a.prev)||0>e(a,a.next,b)}function q(a,b){var c=new u(a.i,a.x,a.y),d=new u(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function n(a,b,c,d){a=new u(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function t(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function u(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=
this.z=this.next=this.prev=null;this.steiner=!1}function x(a,b,c,d){for(var e=0,f=c-d;b<c;b+=d)e+=(a[f]-a[b])*(a[b+1]+a[f+1]),f=b;return e}m.deviation=function(a,b,c,d){var e=b&&b.length,f=Math.abs(x(a,0,e?b[0]*c:a.length,c));if(e)for(var e=0,g=b.length;e<g;e++)f-=Math.abs(x(a,b[e]*c,e<g-1?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var g=d[e]*c,k=d[e+1]*c,h=d[e+2]*c;b+=Math.abs((a[g]-a[h])*(a[k+1]-a[g+1])-(a[g]-a[k])*(a[h+1]-a[g+1]))}return 0===f&&0===b?0:Math.abs((b-f)/f)};m.flatten=function(a){for(var b=
a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;g<b;g++)c.vertices.push(a[e][f][g]);0<e&&(d+=a[e-1].length,c.holes.push(d))}return c};return m})},"esri/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../../../geometry/Polygon ../../../../geometry/Point ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./earcut/earcut ./graphicUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x){function r(a,b,c,d,e,f,g,k,h,l,p,n,m,q){var t=c.length/3,r=0;p+=2*d.count;var v=d.index,u=d.count,x=h,z=p;D.set(m,G);var A=0<n?1:-1,v=3*v,C=x;m=3*C;for(var H=x+u,x=3*H,E=0;E<u;++E)q&&(G[0]=a[v+0],G[1]=a[v+1],G[2]=a[v+2],D.normalize(G)),e[m+0]=a[v+0],e[m+1]=a[v+1],e[m+2]=a[v+2],f[m+0]=b[v+0],f[m+1]=b[v+1],f[m+2]=b[v+2],g[m+0]=-A*G[0],g[m+1]=-A*G[1],g[m+2]=-A*G[2],k[C]=0,e[x+0]=a[v+0]+n*G[0],e[x+1]=a[v+1]+n*G[1],e[x+2]=a[v+2]+n*G[2],f[x+0]=b[v+0],f[x+1]=
b[v+1],f[x+2]=b[v+2],g[x+0]=A*G[0],g[x+1]=A*G[1],g[x+2]=A*G[2],k[H]=n,m+=3,x+=3,v+=3,C+=1,H+=1;v=0;m=3*z;x=3*(z+t);m=3*(z+t);x=3*z;a=J;b=I;0>n&&(a=I,b=J);for(E=0;E<t;++E)l[m+0]=c[v+a[0]],l[m+1]=c[v+a[1]],l[m+2]=c[v+a[2]],l[x+0]=c[v+b[0]]+u,l[x+1]=c[v+b[1]]+u,l[x+2]=c[v+b[2]]+u,m+=3,x+=3,v+=3;h+=2*d.count;p=p+2*t-(2*d.count+2*t);B(e,f,k,g,r,d.pathLengths[0],d.count,h,l,p,n);h+=4*d.pathLengths[0];p+=2*d.pathLengths[0];r+=d.pathLengths[0];for(c=1;c<d.pathLengths.length;++c)B(e,f,k,g,r,d.pathLengths[c],
d.count,h,l,p,n),h+=4*d.pathLengths[c],p+=2*d.pathLengths[c],r+=d.pathLengths[c]}function z(a,b,c,d,e,f,g){d[f]=d[g];g*=3;f*=3;a[f+0]=a[g+0];a[f+1]=a[g+1];a[f+2]=a[g+2];b[f+0]=b[g+0];b[f+1]=b[g+1];b[f+2]=b[g+2];c[f+0]=e[0];c[f+1]=e[1];c[f+2]=e[2]}function B(a,b,c,d,e,f,g,k,h,l,p){var n=e,m=e+1,q=e+g,t=e+g+1,r=k,v=k+1,u=k+2*f;k=k+2*f+1;0>p&&(n=e+g+1,t=e);l*=3;for(var x=0;x<f;++x){x===f-1&&(0<p?(m=e,t=e+g):(m=e,n=e+g));var B=a,A=n,C=m,H=q,E=L,A=3*A,C=3*C,H=3*H;D.set3(B[A++],B[A++],B[A++],M);D.set3(B[C++],
B[C++],B[C++],K);D.set3(B[H++],B[H++],B[H++],ba);D.subtract(K,M,X);D.subtract(ba,M,T);D.cross(T,X,E);D.normalize(E,E);z(a,b,d,c,L,r,n);z(a,b,d,c,L,v,m);z(a,b,d,c,L,u,q);z(a,b,d,c,L,k,t);h[l++]=r;h[l++]=u;h[l++]=k;h[l++]=r;h[l++]=k;h[l++]=v;n++;m++;q++;t++;r+=2;v+=2;u+=2;k+=2}}function C(a,c,d,e){var f=e.setAltitude;F.spatialReference=d.spatialReference;for(var g=a.getGeometryRecords(),k=g.length,h="absolute-height"!==c.mode,l=0,p=0;p<k;p++){var n=g[p].geometry,m=g[p].transformation;P[0]=m[12];P[1]=
m[13];P[2]=m[14];n.invalidateBoundingInfo();for(var q=n.getData().getVertexAttr(),n=q[A.POSITION].data,m=q[A.SIZE].data,q=q.mapPos.data,t=n.length/3,r=0,v=0,u=!1,x=0,w=0;w<t;w++){F.x=q[v];F.y=q[v+1];F.z=q[v+2];V[0]=n[r];V[1]=n[r+1];V[2]=n[r+2];var z=b.computeElevation(d,F,c,h?N:null);h&&(x+=N.terrainElevation);H[0]=n[r]+P[0];H[1]=n[r+1]+P[1];H[2]=n[r+2]+P[2];f(z+m[r/3],H,0);n[r]=H[0]-P[0];n[r+1]=H[1]-P[1];n[r+2]=H[2]-P[2];z=.01/e.unitInMeters;if(Math.abs(V[0]-n[r])>z||Math.abs(V[1]-n[r+1])>z||Math.abs(V[2]-
n[r+2])>z)u=!0;v+=3;r+=3}u&&a.geometryVertexAttrsUpdated(p);l+=x/t}return l/k}var A=t.VertexAttrConstants,D=e.vec3d,E=e.mat4d,H=D.create(),G=D.create(),J=[0,2,1],I=[0,1,2],F=new f,N={verticalDistanceToGround:0,terrainElevation:0};m=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}d(e,c);e.prototype._prepareResources=function(){if(!this._isPropertyDriven("size")){var a=x.validateSymbolLayerSize(this._getSymbolSize());if(a){this._logWarning(a);this.reject();return}}var a=this._getStageIdHint(),
b=this._getMaterialOpacityAndColor(),c=D.create(b),b=b[3],c={diffuse:c,ambient:c,opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:!0};this._material=new n(c,a+"_3dlinemat");this._context.stage.add(l.ModelContentType.MATERIAL,this._material);this.resolve()};e.prototype.destroy=function(){this.isFulfilled()||this.reject();this._material&&this._context.stage.remove(l.ModelContentType.MATERIAL,this._material.getId())};e.prototype.createGraphics3DGraphic=function(a,b){var c=a.geometry;
if("polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for extrude symbol: "+c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.uid,e=this._getVertexOpacityAndColor(b,Float32Array,255),f=this.getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,e,f,d,a.uid)};e.prototype.layerPropertyChanged=function(a,c,d){if("opacity"===a)return c=this._getMaterialOpacity(),d=1>c||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:c,
transparent:d}),!0;if("elevationInfo"===a){this._updateElevationInfo();for(var e in c){var f=c[e];if(a=d(f))f=this.getGraphicElevationInfo(f.graphic),a.needsElevationUpdates=b.needsElevationUpdates3D(f.mode),a.elevationInfo.set(f)}return!0}return!1};e.prototype._getExtrusionSize=function(a){a=a.size&&this._isPropertyDriven("size")?b.getSingleSizeDriver(a.size,2):this._getSymbolSize();return a/=this._context.renderCoordsHelper.unitInMeters};e.prototype._getSymbolSize=function(){return this.symbol.size||
1};e.prototype._createAs3DShape=function(c,d,e,f,h,l,n){c=c.geometry;"extent"===c.type&&(c=k.fromExtent(c));d=c[d];var m=c.hasZ;if(0<d.length){var q=[],t=[],x=[],z=D.create(),B=Array(6),A=this._context.renderSpatialReference===g.SphericalRenderSpatialReference,H=this._getExtrusionSize(e),F=D.create();A||this._context.renderCoordsHelper.worldUpAtPosition(null,F);e=b.getGeometryVertexData3D(d,m,c.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,h);var w=e.geometryData.polygons,
G=e.eleVertexData,I=e.vertexData;c=I.length/3;var J=new Float64Array(18*c),S=new Float64Array(18*c),N=new Float64Array(18*c),T=new Float64Array(6*c),L=0;c=function(a){var c=w[a],d=c.count,e=c.index;if(K._context.clippingExtent&&(b.computeBoundingBox(G,e,d,B),b.boundingBoxClipped(B,K._context.clippingExtent)))return"continue";var g=new Float64Array(G.buffer,3*e*J.BYTES_PER_ELEMENT,3*d),k=c.holeIndices.map(function(a){return a-e}),g=u(g,k,3);if(0<g.length){b.chooseOrigin(I,e,d,z);var k=new Uint32Array(6*
d+2*g.length),h=6*d,p=new Float64Array(J.buffer,3*L*J.BYTES_PER_ELEMENT,3*h),n=new Float64Array(S.buffer,3*L*S.BYTES_PER_ELEMENT,3*h),m=new Float64Array(N.buffer,3*L*N.BYTES_PER_ELEMENT,3*h),D=new Float64Array(T.buffer,1*L*T.BYTES_PER_ELEMENT,1*h);r(I,G,g,c,p,m,n,D,0,k,0,H,F,A);b.subtractCoordinates(p,0,h,z);L+=6*d;c=K._createExtrudeGeometry(k,{positions:p,elevation:m,normals:n,heights:D},f);a=new v(c,l+"path"+a);a.singleUse=!0;q.push(a);t.push([K._material]);a=E.identity();E.translate(a,z,a);x.push(a)}};
var K=this;for(d=0;d<w.length;++d)c(d);return 0<q.length?(n=new p({geometries:q,materials:t,transformations:x,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:n},idHint:l}),n=new a(this,n,q,null,null,C,h),n.alignedTerrainElevation=e.terrainElevation,n.needsElevationUpdates=b.needsElevationUpdates3D(h.mode),n):null}this._logWarning("no paths found for extrusion symbol");return null};e.prototype._createExtrudeGeometry=function(a,b,c){for(var d=a.length,e=new Uint32Array(d),f=0;f<d;f++)e[f]=
0;d={};f={};d[A.POSITION]=a;d[A.NORMAL]=a;d[A.COLOR]=e;f[A.POSITION]={size:3,data:b.positions};f[A.NORMAL]={size:3,data:b.normals};f[A.COLOR]={size:4,data:c};f[A.SIZE]={size:1,data:b.heights};b.elevation&&(f.mapPos={size:3,data:b.elevation},d.mapPos=a);return new q(f,d)};return e}(c);var L=D.create(),M=D.create(),K=D.create(),ba=D.create(),X=D.create(),T=D.create(),V=D.create(),P=D.create();return m})},"esri/views/3d/layers/graphics/Graphics3DTextSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../Color ../../../../core/screenUtils ../../../../symbols/callouts/calloutUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./graphicUtils ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/TextTexture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n){var t=[1,1,1,1],u=[0,0,1],x={mode:"relative-to-ground",offset:0},r=[0,0,0,1];return function(k){function h(){var a=null!==k&&k.apply(this,arguments)||this;a._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1};return a}d(h,k);h.prototype._prepareResources=function(){if(!this._isPropertyDriven("size")){var a=l.validateSymbolLayerSize(this._getTextSize());if(a){this._logWarning(a);this.reject();return}}this._anchor="center";this.resolve()};h.prototype.destroy=
function(){this.isFulfilled()||this.reject()};h.prototype.createGraphics3DGraphic=function(a,b,c,d){var e="polyline"===a.geometry.type,f=this._getGeometry(a);if(!f)return this._logWarning("unsupported geometry type for text symbol: "+a.geometry.type),null;var g=this._context.layer.id+"_label_"+a.uid,k=b.text||this.symbol.text;if(!k||1>k.length)return null;b&&null!=b.needsOffsetAdjustment&&(this._elevationOptions.needsOffsetAdjustment=b.needsOffsetAdjustment);var h=this.getGraphicElevationInfo(a,b.elevationOffset||
0);return this._createAs3DShape(this.symbol,f,k,h,g,a.uid,b,c,d,e)};h.prototype.getGraphicElevationInfo=function(a,b){void 0===b&&(b=0);a=k.prototype.getGraphicElevationInfo.call(this,a);b&&(a.offset+=b);return a};h.prototype._getGeometry=function(a){a=a.geometry;return"polyline"===a.type?e.placePointOnPolyline(a):"polygon"===a.type?e.placePointOnPolygon(a):"extent"===a.type?a.center:"point"!==a.type?null:a};h.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)this._logWarning("layer opacity change not yet implemented in Graphics3DTextSymbolLayer");
else if("elevationInfo"===a){this._updateElevationInfo();if(b)for(var d in b){a=b[d];var e=c(a);e&&this.updateGraphicElevationInfo(a.graphic,e)}return!0}return!1};h.prototype.updateGraphicElevationInfo=function(a,b){a=this.getGraphicElevationInfo(a,b.metadata.elevationOffset);b.elevationInfo.set(a);b.needsElevationUpdates=e.needsElevationUpdates2D(a.mode)||"absolute-height"===a.mode};h.prototype._defaultElevationInfoNoZ=function(){return x};h.prototype._createAs3DShape=function(d,k,h,l,m,x,z,B,F,
N){var A=z.centerOffset||r,D=z.screenOffset||[0,0],C=z.debugDrawBorder||!1,H=z.translation||[0,0,0],E=z.anchor||this._anchor||"center";this._anchor=E;var G=d.material?c.toUnitRGBA(d.material.color):t,I=d.halo&&d.halo.color&&0<d.halo.size,J=I?c.toUnitRGBA(d.halo.color):t,W=I?a.pt2px(d.halo.size):0,U=this._getTextSize(d),I=null!=F;d=new q(h,{size:U,color:G,font:{family:d.font&&d.font.family?d.font.family:"Arial",weight:d.font&&d.font.weight?d.font.weight:"normal",style:d.font&&d.font.style?d.font.style:
"normal"},halo:{size:W,color:J},usedInAtlas:I},m);var G=I?F.addTextTexture(d):null,Y;B?Y=z:b.isCalloutSupport(this.symbolContainer)&&this.symbolContainer.hasVisibleVerticalOffset()&&(Y=this.symbolContainer);D={textureId:I?G.texture.getId():d.getId(),texCoordScale:d.getTexcoordScale(),occlusionTest:!0,screenOffset:D,anchorPos:E,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:z.centerOffsetUnits,debugDrawBorder:C,drawInSecondSlot:!0};Y&&Y.verticalOffset&&(Y=Y.verticalOffset,C=Y.minWorldLength,E=
Y.maxWorldLength,D.verticalOffset={screenLength:a.pt2px(Y.screenLength),minWorldLength:C||0,maxWorldLength:null!=E?E:Infinity});this._context.screenSizePerspectiveEnabled&&(Y=this._context.sharedResources,C=Y.screenSizePerspectiveSettings,D.screenSizePerspective=Y.screenSizePerspectiveSettingsLabels.overridePadding(W),D.screenSizePerspectiveAlignment=C);N&&(D.shaderPolygonOffset=1E-4);N=null;W=JSON.stringify(D);null!=B?(N=B.getMaterial(W),null==N?(N=new n(D,m),B.addMaterial(W,N)):I&&N.setTextureDirty()):
N=new n(D,m);I=[N];N=[d.getTextWidth(),d.getTextHeight()];A=v.createPointGeometry(u,H,void 0,N,A,G?G.uvMinMax:null);A=[new p(A,m)];m=e.createStageObjectForPoint.call(this,k,A,[I],null,null,l,m,this._context.layer.id,x,!0);B=new f(this,m.object,A,null==B?I:null,null==F?[d]:null,g.perObjectElevationAligner,l);B.alignedTerrainElevation=m.terrainElevation;B.needsElevationUpdates=e.needsElevationUpdates2D(l.mode)||"absolute-height"===l.mode;var S=d.getWidth(),ca=d.getHeight();B.getScreenSize=function(a){void 0===
a&&(a=Array(2));a[0]=S;a[1]=ca;return a};B.metadata={labelText:h,elevationOffset:z.elevationOffset||0};e.extendPointGraphicElevationInfo(B,k,this._context.elevationProvider);return B};h.prototype._getTextSize=function(b){return a.pt2px((b||this.symbol).size)||12};return h}(k)})},"esri/views/3d/webgl-engine/lib/TextTexture":function(){define("require exports ./Texture ./Util ../../../webgl/Texture ../../../webgl/enums".split(" "),function(m,h,d,c,a,b){function k(){var a=document.createElement("canvas");
a.width=1024;a.height=1024;return a}function f(a){return"rgb("+a.slice(0,3).map(function(a){return Math.floor(255*a)}).toString()+")"}function g(a){return"rgba("+a.slice(0,3).map(function(a){return Math.floor(255*a)}).toString()+","+a[3]+")"}m=function(){function b(a,b,c){this._idHint=c;this._text=a;this._textLines=a.split(/\r?\n/);this._params=b;this._haloSize=Math.round(this._params.halo.size);this._fillStyle=g(this._params.color);this._haloStyle=f(this._params.halo.color)}b.prototype.getId=function(){null==
this._id&&(this._id=d.idGen.gen(this._idHint));return this._id};b.prototype.getParams=function(){return this._params};b.prototype.getString=function(){return this._text};b.prototype.deferredLoading=function(){return!1};b.prototype.getWidth=function(){if(null!=this._width)return this._width;var a=this.getTextWidth();this._params.usedInAtlas||(a=c.nextHighestPowerOfTwo(a));return this._width=a};b.prototype.getHeight=function(){if(null!=this._height)return this._height;var a=this.getTextHeight();this._params.usedInAtlas||
(a=c.nextHighestPowerOfTwo(a));return this._height=a};b.prototype.initializeThroughRender=function(b,c){var d=this._getTextCanvas(),e=d.getContext("2d");e.save();var f=this.getWidth(),g=this.getHeight(),k=this.getTextWidth(),h=this.getTextHeight();d.width=f;d.height=g;c.samplingMode=9987;c.wrapMode=33071;c.flipped=!0;c.preMultiplyAlpha=!0;c.hasMipmap=!0;this.renderText(1,k,h,e,0,g-h);b=new a(b,c,d);e.restore();return b};b.prototype.getTextWidth=function(){var a=this._getTextCanvas().getContext("2d");
this._setFontProperties(a,this._params.size);for(var b=0,c=0,d=this._textLines;c<d.length;c++){var e=a.measureText(d[c]).width;e>b&&(b=e)}c=this._params.font;if("italic"===c.style||"oblique"===c.style||"string"===typeof c.weight&&("bold"===c.weight||"bolder"===c.weight)||"number"===typeof c.weight&&600<c.weight)b+=.3*a.measureText("A").width;b+=2*this._haloSize;return Math.round(b)};b.prototype.getTextHeight=function(){return this.getLineHeight()*this._textLines.length};b.prototype.getTexcoordScale=
function(){var a=this.getTextWidth(),b=this.getTextHeight();return[a/this.getWidth(),b/this.getHeight()]};b.prototype.getLineHeight=function(){return Math.floor(1.275*this._params.size+2*this._haloSize)};b.prototype.setUnloadFunc=function(a){this._unloadFunc=a};b.prototype.unload=function(){this._unloadFunc&&(this._unloadFunc(this._id),this._unloadFunc=null)};b.prototype.renderText=function(a,b,c,d,f,g){void 0===f&&(f=0);void 0===g&&(g=0);c=this.getLineHeight()*a;var k=this._haloSize,h=d.textAlign;
b=f+("center"===h?.5*b:"right"===h?b:0)+k;h=g+k;d.save();f=3>k;if(0<k){g=h;var l=this._getHaloCanvas(),p=l.getContext("2d");p.clearRect(0,0,1024,1024);this._setFontProperties(p,this._params.size*a);p.fillStyle=this._haloStyle;p.strokeStyle=this._haloStyle;p.lineJoin=f?"miter":"round";if(f)for(var n=0,m=this._textLines;n<m.length;n++){f=m[n];for(var q=0,t=e;q<t.length;q++){var v=t[q];p.fillText(f,b+k*v[0],h+k*v[1])}g+=c}else for(n=0,m=this._textLines;n<m.length;n++){f=m[n];q=2*k;for(t=0;5>t;t++)p.lineWidth=
(.6+.1*t)*q,p.strokeText(f,b,g);g+=c}d.globalAlpha=this._params.halo.color[3];d.drawImage(l,0,0);d.globalAlpha=1}this._setFontProperties(d,this._params.size*a);g=h;a=0;for(k=this._textLines;a<k.length;a++)f=k[a],d.globalCompositeOperation="destination-out",d.fillStyle="rgb(0, 0, 0)",d.fillText(f,b,g),d.globalCompositeOperation="source-over",d.fillStyle=this._fillStyle,d.fillText(f,b,g),g+=c;d.restore()};b.prototype._getTextCanvas=function(){null==b._textCanvas2D&&(b._textCanvas2D=k());return b._textCanvas2D};
b.prototype._getHaloCanvas=function(){null==b._haloCanvas2D&&(b._haloCanvas2D=k());return b._haloCanvas2D};b.prototype._setFontProperties=function(a,b){var c=this._params.font;a.font=c.style+" "+c.weight+" "+b+"px "+c.family;a.textAlign="left";a.textBaseline="top"};return b}();var e=[];for(h=0;360>h;h+=22.5)e.push([Math.cos(Math.PI*h/180),Math.sin(Math.PI*h/180)]);return m})},"esri/views/3d/layers/graphics/Graphics3DPointSymbol":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"./Graphics3DSymbol","./Graphics3DCalloutSymbolLayerFactory"],function(m,h,d,c,a){return function(b){function c(c,d,e){c=b.call(this,c,d,e)||this;c.calloutSymbolLayer=null;c.symbol.hasVisibleCallout()&&(c.calloutSymbolLayer=a.make(c.symbol,d));return c}d(c,b);c.prototype.destroy=function(){b.prototype.destroy.call(this)};c.prototype.createGraphics3DGraphic=function(a,c,d){d=b.prototype.createGraphics3DGraphic.call(this,a,c,d);this.calloutSymbolLayer&&(a=this.createCalloutGraphic(a,c))&&d.addAuxiliaryGraphic(a);
return d};c.prototype.layerPropertyChanged=function(a,c){var d=this;return b.prototype.layerPropertyChanged.call(this,a,c)?this.calloutSymbolLayer?this.calloutSymbolLayer.layerPropertyChanged(a,c,function(a){var b=0;for(a=a._auxiliaryGraphics;b<a.length;b++){var c=a[b];if(c.graphics3DSymbolLayer===d.calloutSymbolLayer)return c}}):!0:!1};c.prototype.createCalloutGraphic=function(a,b){return this.calloutSymbolLayer.createGraphics3DGraphic(a,{renderer:b.renderer,symbol:b.symbol,needsOffsetAdjustment:b.needsOffsetAdjustment,
translation:[0,0,0],centerOffset:[0,0,0,0],screenOffset:[0,0],centerOffsetUnits:"world",elevationOffset:0,materialCollection:null})};return c}(c)})},"esri/views/3d/layers/graphics/Graphics3DCalloutSymbolLayerFactory":function(){define(["require","exports","../../../../core/Logger","../../../../symbols/callouts/calloutUtils","./Graphics3DLineCalloutSymbolLayer"],function(m,h,d,c,a){Object.defineProperty(h,"__esModule",{value:!0});var b=d.getLogger("esri.views.3d.graphics");h.make=function(a,d){if(!c.isCalloutSupport(a))return b.error("Graphics3DCalloutSymbolLayerFactory#make",
"symbol of type '"+a.type+"' does not support callouts"),null;if(!a.callout)return null;var e=k[a.callout.type];return e?new e(a,d):(b.error("Graphics3DCalloutSymbolLayerFactory#make","unknown or unsupported callout type "+a.callout.type),null)};var k={line:a}})},"esri/views/3d/layers/graphics/Graphics3DLineCalloutSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ./ElevationAligners ../../../../core/screenUtils ../../../../Color ../../../../geometry/Polygon ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/Util ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/LineCalloutMaterial".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n){var t=v.VertexAttrConstants;m=function(c){function h(a,b){a=c.call(this,a,null,b,!0)||this;a._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1};return a}d(h,c);h.prototype.destroy=function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(l.ModelContentType.MATERIAL,this._material.getId()),this._material=null)};h.prototype._prepareResources=function(){var a=this._getStageIdHint();this._createMaterialsAndAddToStage(this._context.stage,
a);this.resolve()};h.prototype.perInstanceMaterialParameters=function(a){var b=this.materialParameters;b.screenOffset=a.screenOffset||[0,0];b.centerOffsetUnits=a.centerOffsetUnits||"world";return b};Object.defineProperty(h.prototype,"materialParameters",{get:function(){var a=this.symbolContainer,b=a.callout,c=g.toUnitRGBA(b.color);c[3]*=this._getLayerOpacity();var d=f.pt2px(b.size||0),e=null;if(a.verticalOffset)var e=a.verticalOffset,k=e.minWorldLength,h=e.maxWorldLength,e={screenLength:f.pt2px(e.screenLength),
minWorldLength:k||0,maxWorldLength:null!=h?h:Infinity};b=b.border&&b.border.color?g.toUnitRGBA(b.border.color):null;k="object"===a.symbolLayers.getItemAt(0).type;return{color:c,size:d,verticalOffset:e,screenSizePerspective:this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,screenOffset:[0,0],centerOffsetUnits:"world",borderColor:b,occlusionTest:!k,shaderPolygonOffset:k?0:void 0,depthHUDAlignStart:"label-symbol-3d"===a.type}},enumerable:!0,configurable:!0});
h.prototype._createMaterialsAndAddToStage=function(a,b){this._material=new n(this.materialParameters,b+"_lineCallout_common");a.add(l.ModelContentType.MATERIAL,this._material)};h.prototype._defaultElevationInfoNoZ=function(){return z};h.prototype._getGeometry=function(a){a=a.geometry;if("extent"===a.type)return b.placePointOnPolygon(e.fromExtent(a));if("polyline"===a.type)return b.placePointOnPolyline(a);if("polygon"===a.type)return b.placePointOnPolygon(a);if("point"===a.type)return a;this._logWarning("unsupported geometry type for point symbol: "+
a.type);return null};h.prototype.createGraphics3DGraphic=function(a,b){null!=b.needsOffsetAdjustment&&(this._elevationOptions.needsOffsetAdjustment=b.needsOffsetAdjustment);var c=this.getGraphicElevationInfo(a,b.elevationOffset||0),d=b.symbol,e="on-the-ground"===this._elevationInfo.mode&&!d.symbolLayers.some(function(a){return"object"===a.type||"text"===a.type});if("label-symbol-3d"!==d.type&&e)return null;d=this._getGeometry(a);return null===d?null:this._createAs3DShape(a,d,c,b,"graphic"+a.uid,a.uid)};
h.prototype.layerPropertyChanged=function(a,b,c){switch(a){case "opacity":return this.layerOpacityChanged(b,c);case "elevationInfo":return this.layerElevationInfoChanged(b,c)}return!1};h.prototype.layerOpacityChanged=function(a,b){this._material.setParameterValues(this.materialParameters);return!0};h.prototype.layerElevationInfoChanged=function(a,b){var c=this._elevationInfo.mode;this._updateElevationInfo();var d=this._elevationInfo.mode;if(c!==d&&("on-the-ground"===c||"on-the-ground"===d))return!1;
for(var e in a)c=a[e],(d=b(c))&&this.updateGraphicElevationInfo(c.graphic,d);return!0};h.prototype.getGraphicElevationInfo=function(a,b){void 0===b&&(b=0);a=c.prototype.getGraphicElevationInfo.call(this,a);b&&(a.offset+=b);return a};h.prototype.updateGraphicElevationInfo=function(a,c){a=this.getGraphicElevationInfo(a,c.metadata.elevationOffset);c.elevationInfo.set(a);c.needsElevationUpdates=b.needsElevationUpdates2D(a.mode)};h.prototype.createVertexData=function(a){var b=a.translation;a=a.centerOffset;
if(!b&&!a)return u;b=b?{size:3,data:[b[0],b[1],b[2]]}:u[t.POSITION];a=a?{size:4,data:[a[0],a[1],a[2],a[3]]}:u[t.AUXPOS1];return c={},c[t.POSITION]=b,c[t.NORMAL]=u[t.NORMAL],c[t.AUXPOS1]=a,c;var c};h.prototype.getOrCreateMaterial=function(a,b){var c=this.perInstanceMaterialParameters(a),d=n.uniqueMaterialIdentifier(c);if(d===this._material.uniqueMaterialIdentifier)return{material:this._material,isUnique:!1};if(a.materialCollection){var e=a.materialCollection.getMaterial(d);e||(e=new n(c,b+"_lineCallout_shared"),
a.materialCollection.addMaterial(d,e));return{material:e,isUnique:!1}}e=new n(c,b+"_lineCallout_unique");return{material:e,isUnique:!0}};h.prototype._createAs3DShape=function(c,d,e,f,g,h){c=new q(this.createVertexData(f),r,q.DefaultOffsets,"point");c=[new p(c,g)];var l=this._context.layer.id,n=this.getOrCreateMaterial(f,g);g=b.createStageObjectForPoint.call(this,d,c,[[n.material]],null,null,e,g,l,h,!0);if(null===g)return null;h=new a(this,g.object,c,n.isUnique?[n.material]:null,null,k.perObjectElevationAligner,
e);h.metadata={elevationOffset:f.elevationOffset||0};h.alignedTerrainElevation=g.terrainElevation;h.needsElevationUpdates=b.needsElevationUpdates2D(e.mode);b.extendPointGraphicElevationInfo(h,d,this._context.elevationProvider);return h};return h}(c);var u=(x={},x[t.POSITION]={size:3,data:[0,0,0]},x[t.NORMAL]={size:3,data:[0,0,1]},x[t.AUXPOS1]={size:4,data:[0,0,0,1]},x),x=new Uint32Array([0]),r=(B={},B[t.POSITION]=x,B[t.NORMAL]=x,B[t.AUXPOS1]=x,B),z={mode:"relative-to-ground",offset:0},x,B;return m})},
"esri/views/3d/layers/graphics/Graphics3DOwner":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){return function(){this.localOriginFactory=this.layerView=this.layer=this.overlaySR=this.renderCoordsHelper=this.renderSpatialReference=this.clippingExtent=this.layerOrderDelta=this.layerOrder=this.stage=this.renderer=this.elevationProvider=this.streamDataSupplier=this.sharedResources=null;this.screenSizePerspectiveEnabled=!0}}();h.Graphics3DSymbolCreationContext=
m})},"esri/views/3d/layers/graphics/ElevationQuery":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper dojo/Deferred dojo/_base/lang ../../../../core/Scheduler ../../../../geometry/Multipoint".split(" "),function(m,h,d,c,a,b,k,f){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function g(a,c,d){this.spatialReference=a;this._getElevationQueryProvider=c;this._queries=[];this._isScheduled=!1;this._queryOptions=b.mixin({},
d,{ignoreInvisibleLayers:!0})}g.prototype.queryElevation=function(b,f){return c(this,void 0,void 0,function(){var c;return d(this,function(d){c=new a;this._queries.push({x:b,y:f,result:c});this._scheduleDoQuery();return[2,c.promise]})})};g.prototype._scheduleDoQuery=function(){var a=this;this._isScheduled||(k.schedule(function(){return a._doQuery()}),this._isScheduled=!0)};g.prototype._doQuery=function(){return c(this,void 0,void 0,function(){var a,b,c,g,k,h,m;return d(this,function(d){switch(d.label){case 0:this._isScheduled=
!1;a=this._queries;this._queries=[];b=a.map(function(a){return[a.x,a.y]});c=new f({points:b,spatialReference:this.spatialReference});g=this._getElevationQueryProvider();if(!g)return a.forEach(function(a,b){return a.result.reject()}),[2];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,g.queryElevation(c,this._queryOptions)];case 2:return k=d.sent(),[3,4];case 3:return h=d.sent(),a.forEach(function(a){return a.result.reject(h)}),[2];case 4:return m=k.geometry.points,a.forEach(function(a,b){return a.result.resolve(m[b][2])}),
[2]}})})};return g}();h.ElevationQuery=m})},"esri/views/3d/layers/graphics/Graphics3DSpatialIndex":function(){define("require exports dojo/Deferred ../../../../processors/SpatialIndex ../../../../geometry/SpatialReference ../../../../geometry/support/webMercatorUtils".split(" "),function(m,h,d,c,a,b){return function(){function k(){var a=this;this.spatialIndex=new c;this.spatialIndexNumPendingQueries=this.spatialIndexNumGraphics=0;this.graphicsCore=this.viewSR=this.layer=this.layerView=null;this._readyDfd=
new d;var b=function(a){return a.workerClient&&a.workerClient.worker};if(b(this.spatialIndex))this._readyDfd.resolve();else this.spatialIndex.on("start",function(){b(a.spatialIndex)&&a._readyDfd.resolve()})}k.prototype.initialize=function(a,b,c,d){this.layerView=a;this.layer=b;this.viewSR=c;this.graphicsCore=d};k.prototype.destroy=function(){this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.graphicsCore=this.layerView=this.viewSR=null};k.prototype.numNodesUpdating=function(){return 0};
k.prototype.isUpdating=function(){return 0<this.spatialIndexNumPendingQueries};k.prototype.hasGraphics=function(){return 0<this.spatialIndexNumGraphics};k.prototype.intersects=function(a,b,c){var d=this;this.hasGraphics()&&(this.spatialIndexNumPendingQueries++,this.spatialIndex.intersects(a,void 0,void 0,!0).then(function(a){d.spatialIndexNumPendingQueries--;c(a.results,a.results.length);d.layerView._evaluateUpdatingState()}))};k.prototype.shouldAddToSpatialIndex=function(a,b,c){return c||b.needsElevationUpdates()};
k.prototype.addGraphicsToSpatialIndex=function(a){if(this.layerView.loadedGraphics)for(var b=this.layerView.loadedGraphics.toArray(),c=b.length,d=0;d<c;d++){var f=b[d],k=this.graphicsCore.getGraphics3DGraphicById(f.uid);k&&!k.addedToSpatialIndex&&this.shouldAddToSpatialIndex(f,k,a)&&this.addGraphicToSpatialIndex(f,k)}};k.prototype.addGraphicToSpatialIndex=function(c,d){var e=c.geometry.spatialReference,f=this.viewSR,g={id:c.uid,geometry:null};if(e.equals(f))g.geometry=c.geometry.toJSON();else{var k=
void 0;if(e.wkid===a.WGS84.wkid&&f.isWebMercator)k=b.geographicToWebMercator(c.geometry);else if(e.isWebMercator&&f.wkid===a.WGS84.wkid)k=b.webMercatorToGeographic(c.geometry);else return console.warn("Cannot convert graphic geometry to map spatial reference, elevation and scale updates are disabled"),!1;g.geometry=k.toJSON()}this.spatialIndexNumGraphics++;this.spatialIndex.runProcess([g],this.layer.id);return d.addedToSpatialIndex=!0};k.prototype.whenLoaded=function(){return this._readyDfd.promise};
return k}()})},"esri/processors/SpatialIndex":function(){define("../core/declare dojo/Deferred dojo/_base/lang ./Processor ../workers/WorkerClient ../layers/FeatureLayer".split(" "),function(m,h,d,c,a,b){return m([c],{declaredClass:"esri.processors.SpatialIndex",index:null,indexType:"rtree",autostart:!1,constructor:function(b){b=b||{};var c=!1!==b.autostart;d.mixin(this,b);this.workerCallback=["./scripts/helpers","./scripts/indexInterface","./indexWorker"];if(!this.fetchWithWorker){var g=this;this.workerClient=
new a("./mutableWorker",function(a){this.workerClient=a;this.workerCallback.push("./libs/"+this.indexType);this.workerClient.importScripts(this.workerCallback).then(function(){g._attachedSystem=!0;c&&g.start()})}.bind(this))}this._featCache={}},destroy:function(){this.workerClient&&this.workerClient.terminate()},addLayer:function(a,c){if(a.graphics&&a.graphics.length||c||a.isInstanceOf(b)){var d=this.workerClient;if(!this._attachedSystem&&d.worker){var e=this;this.inherited(arguments,[a,!0]);d.importScripts("./libs/"+
this.indexType).then(function(){e.runProcess(a.graphics,a.id);e._attachedSystem=!0})}else this.inherited(arguments,[a])}},unsetMap:function(){this.stop();this.workerClient.terminate();this.fetchWithWorker||(this.workerClient=new a(this.workerCallback,function(){}));this.inherited(arguments);this.start()},removeLayer:function(a){this.inherited(arguments)},runProcess:function(a,b){if(a&&a.length){var c=this,d=this.workerClient,f=a[0]._graphicsLayer;b||0===b||(b=f?f.id:"rawFeatures_"+Object.keys(this._featCache).length);
this._featCache[b]||(this._featCache[b]={});for(var k,h,m=[],n=a.length,t=f&&f.objectIdField;n--;)h=a[n],k=h.attributes&&t?h.attributes[t]:h.id,null!=k&&this._featCache[b][k]||(this._featCache[b][k]=1,h.declaredClass?m.push({id:k,geometry:h.geometry.toJSON(!0),attributes:h.attributes}):m.push(h));0!==m.length&&(d.postMessage({insert:m,system:this.indexType,options:this.indexOptions,idField:f&&f.objectIdField,layerId:b}).then(function(a){f&&f.emit("process-end",{processor:c,results:{insert:a.insert}})}),
f&&f.emit("process-start",{processor:this}))}},_sendFeaturesFromLayer:function(a,b){b=b.graphic;var c=this.workerClient,d=this,f=b.attributes[a.objectIdField];this._featCache[a.id]||(this._featCache[a.id]={});this._featCache[a.id][f]||(this._featCache[a.id][f]=1,c.postMessage({insert:[{attributes:b.attributes,geometry:b.geometry.toJSON(!0)}],system:this.indexType,options:this.indexOptions,idField:a.objectIdField,layerId:a.id}).then(function(b){a.emit("process-end",{processor:d,results:{insert:b.insert}})}),
a.emit("process-start",{processor:d}))},_notifyProcessStart:function(a,b){},_sendFeaturesFromTask:function(a,b){b=b.featureSet.features;var c=[],d=this.workerClient,f=this,k=b.length,h,m;for(this._featCache[a.id]||(this._featCache[a.id]={});k--;)m=b[k],h=m.attributes[a.objectIdField],this._featCache[a.id][h]||(this._featCache[a.id][h]=1,c.push(m));d.postMessage({insert:c,system:this.indexType,options:this.indexOptions,idField:a.objectIdField,layerId:a.id}).then(function(b){a.emit("process-end",{processor:f,
results:{insert:b.insert}})});a.emit("process-start",{processor:f})},get:function(){},intersects:function(a,b,c,d){return"rtree"!=this.indexType?(console.error("Index.intersects only works with rtree indexes"),a=new h,a.reject({message:"Index.intersects only works with rtree indexes"}),a.promise):this.workerClient.postMessage({search:a,layerId:b,returnNode:c,onlyIds:d})},within:function(a,b,c){if("rtree"!=this.indexType)return console.error("Index.within only works with rtree indexes"),a=new h,a.reject({message:"Index.within only works with rtree indexes"}),
a.promise},nearest:function(a){return"kdtree"!=this.indexType?(console.error("Index.nearest only works with kdtree indexes"),a=new h,a.reject({message:"Index.nearest only works with kdtree indexes"}),a.promise):this.workerClient.postMessage({search:a})}})})},"esri/processors/Processor":function(){define("../core/sniff ../core/declare dojo/_base/lang dojo/_base/array dojo/Evented ../workers/RequestClient ../layers/GraphicsLayer".split(" "),function(m,h,d,c,a,b,k){return h([a],{declaredClass:"esri.processors.Processor",
layers:null,results:null,passFeatures:!0,drawFeatures:!0,requireWorkerSupport:!0,fetchWithWorker:!1,workerCallback:null,workerClient:null,_started:null,_handlers:null,constructor:function(a){a=a||{};d.mixin(this,a);m("esri-workers")||!1===this.requireWorkerSupport&&!1===a.requireWorkerSupport?(this._handlers={},this._notifyProcessStart=d.hitch(this,this._notifyProcessStart),this._sendFeaturesFromTask=d.hitch(this,this._sendFeaturesFromTask),this._sendFeaturesFromLayer=d.hitch(this,this._sendFeaturesFromLayer),
!1!==a.autostart&&this.start()):(console.log("Browser doesn't support workers \x26 worker support is required for this processor"),this.addLayer=this.setMap=this.start=this.runProcess=function(){},this._disabled=!0)},addLayer:function(a,c){var e=a._task,f=this._handlers[a.id]=[],g="complete";!1===this.drawFeatures&&(a._params.drawMode=!1);this.fetchWithWorker?(this.workerClient||(this.workerClient=b.getClient(this.workerCallback)),e.requestOptions={workerOptions:{worker:this.workerClient}},this.passFeatures&&
f.push(e.on(g,d.partial(this._notifyProcessStart,a)))):this.passFeatures?(g=this.drawFeatures?"graphic-draw":"graphic-add",f.push(a.on(g,d.partial(this._sendFeaturesFromLayer,a)))):f.push(e.on(g,d.partial(this._sendFeaturesFromTask,a)));!0!==c&&a.graphics&&this.runProcess(a.graphics,a.id)},removeLayer:function(a){c.forEach(this._handlers[a.id],function(a){a.remove()});delete this._handlers[a.id]},setMap:function(a){if(this.map)if(a!=this.map)this.unsetMap();else return;var b=this;c.forEach(this.layers,
b.removeLayer);c.forEach(a.graphicsLayerIds,function(c){b.addLayer(a.findLayerById(c))});this._handlers.map=[a.on("layer-add",function(a){a=a.layer;a.isInstanceOf(k)&&b.addLayer(a)}),a.on("layer-remove",function(a){a=a.layer;a.isInstanceOf(k)&&b.removeLayer(a)})];this.map=a},unsetMap:function(){this.map&&(c.forEach(this._handlers.map,function(a){a.remove()}),delete this._handlers.map,c.forEach(this.layers,this.removeLayer),this.map=null)},start:function(){this.map?this.setMap(this.map):this.layers&&
(d.isArray(this.layers)||(this.layers=[this.layers]),c.forEach(this.layers,this.addLayer));this._started=!0;this.emit("start",{processor:this});console.log("processor started")},stop:function(){this._started=!1;for(var a in this._handlers)this._handlers.hasOwnProperty(a)&&(this._handlers[a].remove(),delete this._handlers[a]);this.emit("stop",{processor:this});console.log("processor stopped")},runProcess:function(a,b){},_sendFeaturesFromTask:function(){},_sendFeaturesFromLayer:function(){},_notifyProcessStart:function(){}})})},
"esri/workers/RequestClient":function(){define(["../core/declare","dojo/_base/xhr","../config","./WorkerClient"],function(m,h,d,c){function a(a,c){var d=new b;d.addWorkerCallback(a,c);k.unshift({id:c?a+"::"+c:a,client:d});k.length>f&&k.pop().client.terminate();return d}var b=m([c],{declaredClass:"esri.workers.RequestClient",constructor:function(){this.setWorker(["./mutableWorker","./requestWorker"],function(){})},get:function(a){return this._send("GET",a)},post:function(a){return this._send("POST",
a)},_send:function(a,b){b=h._ioSetArgs(b);b.xhr=null;var c=b.ioArgs,d=c.url;delete c.url;delete c.args;this.postMessage({method:a,url:d,options:c}).then(this._getSuccessHandler(b),this._getErrorHandler(b),this._getProgressHandler(b));return b},_addHeaderFunctions:function(a){a.getResponseHeader=function(b){var c,d=a.headers;Object.keys(d).forEach(function(a){if(a.toLowerCase()==b.toLowerCase())return c=d[a],!1});return c};a.getAllResponseHeaders=function(){var b=[],c=a.headers;Object.keys(c).forEach(function(a){b.push(a+
": "+c[a])});return b=b.join("\n")};return a},_getSuccessHandler:function(a){var b=this,c=a.ioArgs;return function(d){a.xhr=b._addHeaderFunctions(d);d=a.xhr.getResponseHeader("content-type");("xml"==c.handleAs||-1<d.indexOf("xml"))&&"string"==typeof a.xhr.response&&(a.xhr.response=(new DOMParser).parseFromString(a.xhr.response,"text/xml"));a.resolve(a.xhr.response,a.xhr)}},_getErrorHandler:function(a){return function(b){a.reject(b)}},_getProgressHandler:function(a){return function(b){a.progress(b)}}}),
k=[],f=d.request.maxWorkers,g=new b;b.getClient=function(b,c){if(b){var d;k.some(function(a){a.id==(c?b+"::"+c:b)&&(d=a.client);return!0});return d||a(b,c)}return g};b.setLimit=function(a){f=d.request.maxWorkers=a};return b})},"esri/workers/WorkerClient":function(){define("dojo/Evented ../core/declare dojo/Deferred dojo/_base/lang dojo/request ../core/sniff ../core/urlUtils require".split(" "),function(m,h,d,c,a,b,k,f){var g=window.Blob||window.webkitBlob||window.mozBlob,e=window.URL||window.webkitURL||
window.mozURL;return h([m],{declaredClass:"esri.workers.WorkerClient",worker:null,_queue:null,constructor:function(a,d){this._isIE=b("ie");this._queue={};this._acceptMessage=c.hitch(this,this._acceptMessage);this._errorMessage=c.hitch(this,this._errorMessage);a&&this.setWorker(a,function(a){this.worker=a;d(this)}.bind(this))},setWorker:function(a,b){if(a instanceof Array){var c=a;a=c.shift()}var d=this._getUrl(a),d=k.normalize(d);a=!k.hasSameOrigin(d,location.href);var f;if(!1===d)return console.log("Can not resolve worker path"),
!1;this.worker&&(f=this.worker,f.removeEventListener("message",this._acceptMessage,!1),f.removeEventListener("error",this._errorMessage,!1),f.terminate(),f=null);if(a){a=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(a,function(a){a=e.createObjectURL(new g([a],{type:"text/javascript"}));b(this._createWorker(a,d))}.bind(this))}catch(t){try{a=k.getProxyUrl(a).path+"?"+encodeURI(a),this._useProxy=!0,b(this._createWorker(a,c))}catch(u){return console.log("Can not create worker"),!1}}}else b(this._createWorker(d,
c))},_createWorker:function(a,b){a=new Worker(a);a.addEventListener("message",this._acceptMessage,!1);a.addEventListener("error",this._errorMessage,!1);this.worker=a;b&&this.importScripts(b);return a},postMessage:function(a,b){if(a instanceof Array||"object"!=typeof a)a={data:a};var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new d;this.worker?(b?this.worker.postMessage(a,b):this.worker.postMessage(a),this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."});
return c.promise},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var e=this._getUrl(a,!0);return!1===e?(b=new d,b.reject({message:"Could not load text from "+a}),b.promise):this.postMessage({action:"add-callback",url:e,cbName:b||"main"}).then(c.hitch(this,function(a){a.target=this;this.emit("callback-added",a)}))},importScripts:function(a){Array.isArray(a)||
(a=[a]);a=a.map(function(a){a=this._getUrl(a,!0);this._useProxy&&!k.hasSameOrigin(a,location.href)&&(a=k.getProxyUrl(a).path+"?"+encodeURI(a));return a},this);return this.postMessage({action:"import-script",url:a}).then(c.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}))},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):("error"==
b.status?d.reject(a.data):d.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,b){if(!a)return console.error("can not resolve empty path"),!1;a.match(/\.js$/)||(a+=".js");a=f.toUrl(a);return b?k.makeAbsolute(a):a},_getRemoteText:function(b,c){(b=this._getUrl(b))&&
a.get(b,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){c(a)})},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new g(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=e.createObjectURL(a));try{return new Worker(a)}catch(p){return console.log(p.message),!1}}})})},"esri/layers/GraphicsLayer":function(){define("../core/Accessor ../core/Collection ../core/promiseUtils ./Layer ./mixins/ScaleRangeLayer ../Graphic dojo/_base/lang".split(" "),
function(m,h,d,c,a,b,k){var f=m.createSubclass({properties:{layer:null,layerView:null,graphics:null}});return c.createSubclass([a],{declaredClass:"esri.layers.GraphicsLayer",viewModulePaths:{"2d":"../views/2d/layers/GraphicsLayerView2D","3d":"../views/3d/layers/FeatureLayerView3D"},getDefaults:function(a){return k.mixin(this.inherited(arguments),{graphics:[]})},destroy:function(){this.removeAll()},_gfxHdl:null,properties:{elevationInfo:null,graphics:{type:h.ofType(b),set:function(a){var b=this._get("graphics");
b||(a.forEach(function(a){a.layer=this},this),this._gfxHdl=a.on("change",function(a){var b,c,d;d=a.added;for(b=0;c=d[b];b++)c.layer=this;d=a.removed;for(b=0;c=d[b];b++)c.layer=null}.bind(this)),this._set("graphics",a),b=a);b.removeAll();b.addMany(a)}},screenSizePerspectiveEnabled:!0,type:{readOnly:!0,value:"graphics"}},add:function(a){this.graphics.add(a);return this},addMany:function(a){this.graphics.addMany(a);return this},removeAll:function(){this.graphics.removeAll();return this},createGraphicsController:function(a){return d.resolve(new f({layer:this,
layerView:a.layerView,graphics:this.graphics}))},remove:function(a){this.graphics.remove(a)},removeMany:function(a){this.graphics.removeMany(a)},graphicChanged:function(a){this.emit("graphic-update",a)}})})},"esri/views/3d/layers/graphics/Graphics3DElevationAlignment":function(){define(["require","exports"],function(m,h){return function(){function d(){this.elevationDirtyGraphicsQueue=[];this.elevationDirtyGraphicsSet={};this.elevationUpdateEventHandle=null;this.eventHandles=[];this.updateElevation=
!1;this.graphicsCore=this.layerView=null}d.prototype.initialize=function(c,a,b,d){var f=this;this.layerView=c;this.graphicsCore=b;this.elevationProvider=d;this.getGraphicsInExtent=a;this.elevationUpdateEventHandle=d.on("elevation-change",function(a){return f.elevationUpdateHandler(a)});this.eventHandles.push(this.layerView.watch("suspended",function(){return f.suspendedChange()}))};d.prototype.destroy=function(){this.elevationDirtyGraphicsSet=this.elevationDirtyGraphicsQueue=null;this.elevationUpdateEventHandle&&
(this.elevationUpdateEventHandle.remove(),this.elevationUpdateEventHandle=null);this.eventHandles.forEach(function(c){return c.remove()});this.getGraphicsInExtent=this.graphicsCore=this.layerView=this.eventHandles=null};d.prototype.clear=function(){this.elevationDirtyGraphicsSet={};this.elevationDirtyGraphicsQueue=[]};d.prototype.suspendedChange=function(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&this.markAllGraphicsElevationDirty()};
d.prototype.isUpdating=function(){return 0<this.elevationDirtyGraphicsQueue.length};d.prototype.numNodesUpdating=function(){return this.elevationDirtyGraphicsQueue.length};d.prototype.needsIdleUpdate=function(){return this.elevationProvider&&0<this.elevationDirtyGraphicsQueue.length};d.prototype.idleUpdate=function(c){if(!c.done()){var a=this.layerView.view,b=this.elevationDirtyGraphicsQueue.length;if(0<b){for(var d=this.graphicsCore.stageLayer.getId(),f=this.graphicsCore.labelStageLayer?this.graphicsCore.labelStageLayer.getId():
null,g=0,e=0,e=0;e<b;e++){var h=this.elevationDirtyGraphicsQueue[e],m=this.graphicsCore.graphics[h];m&&m.alignWithElevation(this.elevationProvider,a.renderCoordsHelper);delete this.elevationDirtyGraphicsSet[h];g++;if(20<=g){a._stage.processDirtyLayer(d);null!=f&&a._stage.processDirtyLayer(f);if(c.done())break;g=0}}a._stage.processDirtyLayer(d);null!=f&&a._stage.processDirtyLayer(f);this.elevationDirtyGraphicsQueue.splice(0,e+1);a.deconflictor.setDirty();this.layerView._evaluateUpdatingState()}}};
d.prototype.markAllGraphicsElevationDirty=function(){for(var c in this.graphicsCore.graphics)this.markGraphicElevationDirty(this.graphicsCore.graphics[c].graphic.uid);this.layerView._evaluateUpdatingState()};d.prototype.markGraphicElevationDirty=function(c){this.elevationDirtyGraphicsSet[c]||(this.elevationDirtyGraphicsSet[c]=!0,this.elevationDirtyGraphicsQueue.push(c))};d.prototype.elevationUpdateHandler=function(c){var a=this,b=c.extent;this.layerView.suspended?this.updateElevation||(c=this.graphicsCore.computedExtent)&&
b[2]>c.xmin&&b[0]<c.xmax&&b[3]>c.ymin&&b[1]<c.ymax&&(this.updateElevation=!0):-Infinity===b[0]?this.markAllGraphicsElevationDirty():this.getGraphicsInExtent(b,c.spatialReference,function(b,c){for(var d=!1,e=0;e<c;e++){var f=b[e],k=a.graphicsCore.graphics[f];k&&k.needsElevationUpdates()&&(a.markGraphicElevationDirty(f),d=!0)}d&&a.layerView._evaluateUpdatingState()})};return d}()})},"esri/views/3d/navigation/spherical/NavigationSpherical":function(){define("../Navigation ./ConstraintsSpherical ./AnimationSpherical ./actions/PanSpherical ./actions/ZoomSpherical ./actions/RotateSpherical ../../webgl-engine/lib/Camera ../../support/earthUtils ../../lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k,f,g){var e=g.vec3d,l=g.mat4d,p=e.create(),v=e.create(),q=l.create();return m.createSubclass([h,d],{declaredClass:"esri.views.3d.navigation.spherical.NavigationSpherical",initialize:function(){this.pan=new c({navigation:this});this.zoom=new a({navigation:this});this.rotate=new b({navigation:this});this._intersectTerrainSelector.enableBackfacesTerrain=!1},getInitialCamera:function(){return new k(e.createFrom(4*f.earthRadius,0,0),e.createFrom(f.earthRadius,0,0),e.createFrom(0,
0,1))},fixTargetUpVector:function(){this.cameras.target.computeUpOnSphere()},setPoiAuto:function(a,b){a=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,a);this.picker.pickedIntersectionPoint(a,p)&&(this.setCameraFromEyeAndCenter(this.cameras.target.eye,p,{animate:!1}),e.set(this.cameras.target.center,this.cameras.current.center),b&&this.setCurrentToTarget())},rotateCameraWithPointsOnSphere:function(a,b,c,d,f){var g;null==f&&(f=e.length(a));g=Math.abs(e.length(b)-f);
1E-4<=g&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere: invalid radius for target point (got "+f+", but expected "+e.length(b)+")"),f=e.length(b));g=Math.abs(e.length(a)-f);1E-4<=g&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere]: invalid radius for source point (got "+f+", but expected "+e.length(a)+", "+a+")"),f=e.length(a));a=this.rotationFromPointsOnSphere(a,b,f,v);l.identity(q);l.rotate(q,a,v);l.multiplyVec3(q,c.eye,d.eye);l.multiplyVec3(q,c.center,
d.center);l.multiplyVec3(q,c.up,d.up)},rotationFromPointsOnSphere:function(a,b,c,d){e.cross(a,b,d);return-Math.acos(1-e.dist2(a,b)/(2*c*c))}})})},"esri/views/3d/navigation/Navigation":function(){define(["../../../core/Accessor","../../../core/Evented","../../../core/watchUtils","./Picker","./mixins/CamerasMixin"],function(m,h,d,c,a){return m.createSubclass([a,h],{properties:{interacting:{get:function(){return this._interacting},readOnly:!0},renderCoordsHelper:{},renderUnitInMeters:{dependsOn:["renderCoordsHelper"],
get:function(){return this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1}},picker:{},constraints:{},pan:{},zoom:{},rotate:{}},initialize:function(){this._mapCoordsHelperHandle=d.init(this.view,"mapCoordsHelper",function(a){this.mapCoordsHelper=a}.bind(this));this._renderCoordsHelperHandle=d.init(this.view,"renderCoordsHelper",this.updateRenderCoordsHelper.bind(this));this.picker=new c(this,this.view);this._interacting=!1},destroy:function(){this._mapCoordsHelperHandle.remove();this._renderCoordsHelperHandle.remove()},
updateRenderCoordsHelper:function(a){this.renderCoordsHelper=a;this.inherited(arguments)},begin:function(a){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.pan&&this.pan.momentum&&(this.pan.momentum=null);this._interacting=!0;this.notifyChange("interacting")},end:function(a){this._interacting=!1;this.notifyChange("interacting")}})})},"esri/views/3d/navigation/Picker":function(){define(["../../../core/declare","../support/RenderCoordsHelper","../lib/glMatrix","../webgl-engine/lib/Selector"],
function(m,h,d,c){var a=d.vec3d,b=a.create(),k=a.create();return m([],{constructor:function(a,b){this.navigation=a;this.pickAlongRay=b._pickRay.bind(b);this.createPickRay=b._pickRayWithBeginPoint.bind(b);this.selector=new c(b.viewingMode)},pickPointInScreen:function(a,b){return this.pickedIntersectionPoint(this.pickInScreen(a,!1),b)},pickFreePointInScreen:function(c,d){this.createPickRay(c,void 0,this.navigation.currentCamera.viewMatrix,b,k);d||(d=a.create());a.subtract(k,b);a.normalize(k);var e=
this.navigation.view.dataExtent;c=Math.max(e.xmax-e.xmin,e.ymax-e.ymin,8*Math.max(e.xmax-e.xmin,e.ymax-e.ymin));var f=this.navigation.currentCamera,g=Math.max(0,e.xmin-f.eye[0],f.eye[0]-e.xmax),e=Math.max(0,e.ymin-f.eye[1],f.eye[1]-e.ymax),g=Math.sqrt(g*g+e*e),e="global"==this.navigation.view.viewingMode?h.Spherical.prototype.getAltitude(f.eye):h.Planar.prototype.getAltitude(f.eye),f=this.navigation._getTerrainElevationBelowCamera(f),f=c/Math.max(1,Math.pow(Math.max(0,Math.log(c/(Math.abs(e-f)+Number.MIN_VALUE))),
2)),f=Math.max(f,Math.min(g,c));a.scale(k,f);a.add(b,k,d)},pickInScreen:function(c,d){this.createPickRay(c,void 0,this.navigation.currentCamera.viewMatrix,b,k);d&&a.set(this.navigation.currentCamera.eye,b);return this.pickAlongRay(b,k,c,c,null,null,this.selector)},pickedIntersectionPoint:function(b,c){if(!b)return!1;c||(c=a.create());return b.getMinResult().getIntersectionPoint(c)}})})},"esri/views/3d/navigation/mixins/CamerasMixin":function(){define("../../../../core/Accessor ../../../../core/Evented ../../webgl-engine/lib/Camera ../../support/mathUtils ../../lib/glMatrix dojo/on".split(" "),
function(m,h,d,c,a,b){var k=a.vec4d.create();return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.mixins.CamerasMixin",properties:{targetCamera:{get:function(){return this.cameras.target}},currentCamera:{get:function(){return this.cameras.current}},windowSize:{set:function(a){var b=a[0],c=a[1],d=!1,f=this.cameras.target.x-this.cameras.target.padding[3],k=this.cameras.target.y-this.cameras.target.padding[2];if(this.cameras.target.width+f!==b||this.cameras.target.height+k!==c)this.cameras.target.width=
b-f,this.cameras.target.height=c-k,this.targetChanged(),d=!0;f=this.cameras.current.x-this.cameras.current.padding[3];k=this.cameras.current.y-this.cameras.current.padding[2];if(this.cameras.current.width+f!==b||this.cameras.current.height+k!==c)this.cameras.current.width=b-f,this.cameras.current.height=c-k,this.currentChanged(),d=!0;d&&this.currentHasReachedTarget()&&this.currentReachedTarget();this._set("windowSize",a)}},padding:{set:function(a){var b=!1,d=!1;k[0]=a.top;k[1]=a.right;k[2]=a.bottom;
k[3]=a.left;c.vectorEquals(this.cameras.current.padding,k)||(this.cameras.current.padding=k,d=!0);c.vectorEquals(this.cameras.target.padding,k)||(this.cameras.target.padding=k,b=!0);b&&this.targetChanged();d&&this.currentChanged();this.currentHasReachedTarget()&&(b||d)&&this.currentReachedTarget()}}},initialize:function(){var a=this.getInitialCamera();this.cameras={current:a,target:a.copy()}},currentHasReachedTarget:function(){return this.cameras.current.equals(this.cameras.target)},currentHasAlmostReachedTarget:function(){return this.cameras.current.almostEquals(this.cameras.target,
5E-4/this.renderUnitInMeters)},setCamera:function(a,b){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.pan&&this.pan.momentum&&(this.pan.momentum=null);this.cameras.target.copyFrom(a);var c=!(b&&b.internalUpdate)||!this._targetCameraChangedByElevationUpdate;c&&this._targetCameraBeforeElevationUpdate.copyFrom(a);this._targetCameraAnimated.copyFrom(this.cameras.target);this.applyConstraints(this._targetCameraAnimated,!0);a=!1;this.constrainTargetEyeByElevation()&&(a=!0);this.applyConstraints(this.cameras.target,
!0)&&(a=!0);this.fixTargetUpVector();this.currentHasReachedTarget()?(this.targetChanged(),a&&c&&(this._targetCameraChangedByElevationUpdate=!0),this.currentReachedTarget()):(void 0===b||void 0===b.animate||b.animate?this.targetAnimatedChanged(!1,b,!0):(this.targetAndCurrentChanged(!0),a=!0),a&&c&&(this._targetCameraChangedByElevationUpdate=!0),this._autoUpdateTiltConstraint())},getTargetCamera:function(){console.warn("[Navigation.getTargetCamera()] deprecated; use .targetCamera instead");return this.targetCamera},
getCurrentCamera:function(){console.warn("[Navigation.getCurrentCamera()] deprecated; use .currentCamera instead");return this.currentCamera},_cameraFromEyeCenterUp:function(a,b,c){var d=this.cameras.target.copy();d.eye=a;d.center=b;d.up=c;return d},setCameraFromEyeAndCenter:function(a,b,c){this.setCamera(this._cameraFromEyeCenterUp(a,b,this.cameras.target.up),c)},setCameraFromEyeCenterAndUp:function(a,b,c,d){this.setCamera(this._cameraFromEyeCenterUp(a,b,c),d)},_cameraEvents:{},_prepareCameraEvent:function(a,
b){var c=this._cameraEvents[a];c||(c={camera:new d},this._cameraEvents[a]=c);c.camera.copyFrom(b);return c},emitWithCamera:function(a,c){b.emit(this,a,this._prepareCameraEvent(a,c))},targetChanged:function(a){this.inherited(arguments);this.cameras.target.markViewDirty();var c=this._prepareCameraEvent("targetViewChanged",this.cameras.target);c.interruptedAnimation=!!a;c.finishedAnimation=!1;b.emit(this,"targetViewChanged",c)},targetAnimatedChanged:function(a,b,c){this.targetChanged(a);this.startAnimation(b,
c)},targetAndCurrentChanged:function(a){this.targetChanged(a);this.setCurrentToTarget(!1,a)},currentChanged:function(){this.inherited(arguments);this.cameras.current.markViewDirty();this.emitWithCamera("currentViewChanged",this.cameras.current)},currentReachedTarget:function(a,c){this.inherited(arguments);this.currentChanged();if(!(this.pan&&this.pan.continuous&&this.pan.continuous.active)){var d=this._prepareCameraEvent("currentViewReachedTarget",this.cameras.current);d.finishedAnimation=!!a;d.interruptedAnimation=
!!c;b.emit(this,"currentViewReachedTarget",d)}},setCurrentToTarget:function(a,b){this.cameras.current.copyFrom(this.cameras.target);this.currentReachedTarget(a,b)}})})},"esri/views/3d/navigation/spherical/ConstraintsSpherical":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../constraints/SceneViewTiltConstraint ../../webgl-engine/lib/Util".split(" "),function(m,h,d,c,a,b,k){var f=c.vec3d,
g=f.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.ConstraintsSpherical",defaultConstraints:{tilt:new m.Tilt({min:function(){return h.deg2rad(b.MAX_DEFAULT)},max:h.makePiecewiseLinearFunction([[4E3,h.deg2rad(b.MIN_DEFAULT)],[5E4,h.deg2rad(88)],[6E6,h.deg2rad(88)],[2E7,h.deg2rad(b.MAX_DEFAULT)]])}),altitude:new m.Altitude({min:function(){return a.MIN_DEFAULT},max:function(){return a.MAX_DEFAULT}}),collision:new m.Collision},initialize:function(){this.captainNemoAltitudeThreshold=
2E4;this.captainNemoElevationThreshold=-500},limitAltitude:function(a,b,c,k){f.scale(c,a/k,g);f.subtract(b,g,g);var e=this.renderCoordsHelper.getAltitude(g),h=this.constraints.altitude.apply(this,e);if(1E-6<Math.abs(e-h)){var l=f.length(b);b=f.dot(c,b)/(l*k);if(.9999<Math.abs(b))return a+(h-e);e=h+d.earthRadius;a=-2*l*b;l=a*a-4*(-(e*e)+l*l);if(0>l)return this.minPoiDist;l=Math.sqrt(l);return l<a?(a-l)/2:(l-a)/2}return a},limitTiltByAltitudeConstraints:function(a,b,c,g){b=f.length(b);var e=b*b,k=c*
c,l=Math.sqrt(e+k-2*b*c*Math.cos(Math.PI-a))-d.earthRadius,m=this.constraints.altitude.min(),p=this.constraints.altitude.max(),r;(void 0===g||0<g)&&l<m?r=m:(void 0===g||0>g)&&l>p&&(r=p);void 0!==r&&(a=r+d.earthRadius,a=Math.PI-h.acos((-(a*a)+e+k)/(2*b*c)));return a},distanceToSilhouette:function(a,b,c,g,k){k||(k={maxFarNearRatio:0,distance:0});a=f.dot(a.eye,a.eye);b=d.earthRadius*d.earthRadius;k.maxFarNearRatio=this.maxFarNearRatio;this.isNemoMode(a,g)?(g=d.earthRadius+g,k.distance=Math.sqrt(a-g*
g)):a>b?(k.maxFarNearRatio=h.clamp(2E4-(Math.log(Math.sqrt(a)-d.earthRadius)-7.983)/9.011*19E3,1E3,2E4),k.distance=Math.sqrt(a-b)):k.distance=this.maxFarNearRatio*this.minNearDistance;k.distance*=1.2;return k},isNemoMode:function(a,b){var c=d.earthRadius+this.captainNemoAltitudeThreshold;return a<c*c&&b<this.captainNemoElevationThreshold},intersectManifold:function(a,b,c,f){return k.raySphereClosestPositive(a,b,d.earthRadius+c,f)},getFallbackCenterAlongViewDirection:function(a,b,c){var e=f.dot(a,
a),g=d.earthRadius*d.earthRadius,e=e>g?Math.sqrt(e-g)/3:1;f.subtract(b,a,c);f.scale(c,e/f.length(c),c);f.add(c,a)}})})},"esri/views/3d/navigation/mixins/ConstraintsMixin":function(){define("../../../../core/Accessor ../../../../core/watchUtils ../../../../geometry/Point ../../support/mathUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../webgl-engine/lib/Camera ../../webgl-engine/lib/IntervalUtilities ../../webgl-engine/lib/Selector".split(" "),function(m,h,d,c,a,b,k,f,g){function e(a){return new E.Tilt({min:function(){return.01},
max:function(){return c.deg2rad(a.tilt.max)}})}function l(a){return new E.Altitude({min:function(){return a.altitude.min},max:function(){return a.altitude.max}})}var p=a.vec3d,v=a.mat4d,q=new d,n=p.create(),t=p.create(),u=v.create(),x=p.create(),r=p.create(),z=p.create(),B=new k,C=p.create(),A={tilt:0,distance:0},D={distance:0,maxFarNearRatio:0},E=m.createSubclass([],{declaredClass:"esri.views.3d.navigation.mixins.ConstraintsMixin",properties:{userConstraints:{set:function(a){this._disconnectUserConstraints();
this._connectUserConstraints(a);this._set("userConstraints",a)}},elevationProvider:{value:null,set:function(a){null!==this._elevationChangeHandle&&(this._elevationChangeHandle.remove(),this._elevationChangeHandle=null);null!==this._elevationChangeTileHandle&&(this._elevationChangeTileHandle.remove(),this._elevationChangeTileHandle=null);null!==a&&(this._elevationChangeHandle=a.on("elevation-change",this._elevationChangeHandler.bind(this)),this._elevationChangeTileHandle=a.on("elevation-change-tile",
this._elevationChangeTileHandler.bind(this)));this._set("elevationProvider",a)}},minPoiDist:{get:function(){return this._minPoiDistInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},cameraElevationMargin:{get:function(){return this._cameraElevationMarginInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},minNearDistance:{get:function(){return this._minNearDistanceInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},renderUnitInMeters:{},constraintsEnabled:{value:!0}},
constructor:function(a){this._userConstraints=null;this._userConstraintsHandles=[];this._clipDistanceHandles=[];this._tiltHandles=[];this._altitudeHandles=[];this.constraints={tilt:this.defaultConstraints.tilt,altitude:this.defaultConstraints.altitude,collision:this.defaultConstraints.collision};this._tiltModeHandler=this._tiltModeHandler.bind(this);this._tiltMaxHandler=this._tiltMaxHandler.bind(this);this._altitudeModeHandler=this._altitudeModeHandler.bind(this);this._altitudeMinMaxHandler=this._altitudeMinMaxHandler.bind(this);
this._clipDistanceModeHandler=this._clipDistanceModeHandler.bind(this);this._clipDistanceNearFarHandler=this._clipDistanceNearFarHandler.bind(this);this._collisionEnabledHandler=this._collisionEnabledHandler.bind(this);this.enableElevationUpdates=!0;this.updateTargetByElevationUpdates=E.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT;this._recomputeTargetEyeForElevationChange=this._recomputeTargetCenterForElevationChange=!1;this._elevationChangeTileHandle=this._elevationChangeHandle=null;this._autoAltitudeConstraints=
{min:b.MIN_DEFAULT,max:b.MAX_DEFAULT};this.maxFarNearRatio=2E4;this._minNearDistanceInMeters=2;this._minPoiDistInMeters=4;this._cameraElevationMarginInMeters=5;this._intersectTerrainSelector=new g(a.view.viewingMode);this._intersectTerrainSelector.enableInvisibleTerrain=!0},initialize:function(){this._targetCameraBeforeElevationUpdate=this.cameras.current.copy();this._targetCameraChangedByElevationUpdate=!1;this._sceneExtentChangeHandle=this.view.watch("dataExtent",function(a){this._dataExtentChanged()}.bind(this))},
_dataExtentChanged:function(){this.view.ready&&(this._updateAltitudeConstraintFromExtent(this.view.dataExtent),this._reapplyConstraints(),this._camerasChanged())},_updateAutoAltitudeConstraints:function(a){},updateRenderCoordsHelper:function(a,b){this.inherited(arguments);this._userConstraints&&"auto"!==this._userConstraints.altitude.mode||(this.constraints.altitude=E.Altitude.scale(this.defaultConstraints.altitude,a.unitInMeters));this._userConstraints&&"auto"!==this._userConstraints.tilt.mode||
(this.constraints.tilt=E.Tilt.scale(this.defaultConstraints.tilt,a.unitInMeters));this._updateAltitudeConstraintFromExtent(this.view.dataExtent);this._reapplyConstraints();this._camerasChanged()},_updateAltitudeConstraintFromExtent:function(a){0<a.xmax-a.xmin&&(this._updateAutoAltitudeConstraints(a),this._userConstraints&&"auto"!==this._userConstraints.altitude.mode||this._autoUpdateAltitudeConstraint())},destroy:function(){this._disconnectUserConstraints();this._sceneExtentChangeHandle.remove()},
_updateTargetCenterForElevation:function(a){this._recomputeTargetCenterForElevationChange=!1;if(a||this.enableElevationUpdates&&this.updateTargetByElevationUpdates)if(this._targetCameraChangedByElevationUpdate?a=this._targetCameraBeforeElevationUpdate:(a=this.cameras.target,this._targetCameraBeforeElevationUpdate.copyFrom(a)),(a=this.getCameraIntersectTerrain(a.eye,a.center,a.up,.02))&&!a.equals(this.cameras.target))return this.setCamera(a,{internalUpdate:!0}),this._targetCameraChangedByElevationUpdate=
!0;return!1},_updateTargetCenterForElevationWhenIdle:function(){var a=this.isAnimating,b=!1;if(!(this.pan&&this.pan.continuous&&this.pan.continuous.active||this.pan.active||this.zoom.active||this.rotate.active||a)&&this._recomputeTargetCenterForElevationChange){var c=this._targetCameraChangedByElevationUpdate;this._updateTargetCenterForElevation()&&(b=!0);this._targetCameraChangedByElevationUpdate=c}!a&&this._recomputeTargetEyeForElevationChange&&this._updateTargetEyeForElevationChange()&&(b=!0);
return b},step:function(){this._updateTargetCenterForElevationWhenIdle();this.inherited(arguments)},applyConstraints:function(a,b){if(!this.constraintsEnabled)return!1;var c=this._cameraElevationAngle(a,A),d=this.constraints.tilt.min(c.distance),e=this.constraints.tilt.max(c.distance),f=0;!b&&c.tilt>e?f=c.tilt-e:c.tilt<d&&(f=c.tilt-d);b=!1;.01<Math.abs(f)&&(p.cross(n,a.up,t),v.identity(u),v.rotate(u,f,t),v.multiplyVec3(u,n),p.add(a.center,n,a.eye),v.multiplyVec3(u,a.up),b=!0);p.subtract(a.center,
a.eye,x);f=a.distance;c=this.limitAltitude(f,a.center,x,f);f!==c&&(p.scale(x,-c/f),p.add(a.center,x,a.eye),b=!0);this._autoUpdateTiltConstraint(e);return b},limitTiltByConstraints:function(a,b,c,d){if(!this.constraintsEnabled)return a;var e=this.constraints.tilt.min(c),f=this.constraints.tilt.max(c);(void 0===d||0<d)&&a>=f?a=f:(void 0===d||0>d)&&a<=e&&(a=e);a=this.limitTiltByAltitudeConstraints(a,b,c,d);this._autoUpdateTiltConstraint(f);return a},_autoUpdateAltitudeConstraint:function(){var a=this._userConstraints&&
this._userConstraints.altitude;a&&"auto"===a.mode&&a.autoUpdate(this.constraints.altitude.min(this),this.constraints.altitude.max(this))},_autoUpdateTiltConstraint:function(a){var b=this._userConstraints&&this._userConstraints.tilt;void 0===a&&(a=this.constraints.tilt.max(this.cameras.target.distance));b&&"auto"===b.mode&&b.autoUpdate(c.rad2deg(a))},_disconnectUserConstraints:function(){if(this._userConstraints){this._userConstraintsHandles.forEach(function(a){a.remove()});this._userConstraints=null;
this._userConstraintsHandles.length=0;var a=this.renderUnitInMeters;this.constraints.tilt=E.Tilt.scale(this.defaultConstraints.tilt,a);this.constraints.altitude=E.Altitude.scale(this.defaultConstraints.altitude,a)}},_connectUserConstraints:function(a){a&&(this._userConstraints=a,this._userConstraintsHandles.push(h.init(a,"tilt.mode",this._tiltModeHandler),h.init(a,"clipDistance.mode",this._clipDistanceModeHandler),h.init(a,"altitude.mode",this._altitudeModeHandler),h.init(a,"collision.enabled",this._collisionEnabledHandler)))},
_camerasChanged:function(){var a=this._targetCameraChangedByElevationUpdate;this.targetChanged();this._targetCameraChangedByElevationUpdate=a;this.currentChanged();this.currentHasReachedTarget()&&this.currentReachedTarget()},_reapplyConstraints:function(){var a=!1;this.applyConstraints(this.cameras.current)&&(a=!0);this.applyConstraints(this.cameras.target)&&(a=!0);a&&this._camerasChanged()},_userConstraintsChanged:function(){this._reapplyConstraints()},_altitudeMinMaxHandler:function(a,b,c){this._userConstraintsChanged()},
_tiltMaxHandler:function(a,b,c){this._userConstraintsChanged()},_tiltModeHandler:function(a){this._tiltHandles.forEach(function(a){a.remove()});this._tiltHandles.length=0;"auto"===a?this.constraints.tilt=E.Tilt.scale(this.defaultConstraints.tilt,this.renderUnitInMeters):(this._tiltHandles.push(this._userConstraints.watch("tilt.max",this._tiltMaxHandler)),this.constraints.tilt=e(this._userConstraints));this._tiltMaxHandler()},_altitudeModeHandler:function(a){this._altitudeHandles.forEach(function(a){a.remove()});
this._altitudeHandles.length=0;"auto"===a?(this.constraints.altitude=E.Altitude.scale(this.defaultConstraints.altitude,this.renderUnitInMeters),this._autoUpdateAltitudeConstraint()):(this._altitudeHandles.push(this._userConstraints.watch("altitude.min",this._altitudeMinMaxHandler),this._userConstraints.watch("altitude.max",this._altitudeMinMaxHandler)),this.constraints.altitude=l(this._userConstraints));this._altitudeMinMaxHandler()},_collisionEnabledHandler:function(a,b,c){this.constraints.collision=
new E.Collision(this._userConstraints.collision.enabled);this._userConstraintsChanged()},_clipDistanceNearFarHandler:function(a,b,c){"auto"!==this._userConstraints.clipDistance.mode&&(this.cameras.target.near=this._userConstraints.clipDistance.near,this.cameras.target.far=this._userConstraints.clipDistance.far,this.cameras.current.near=this._userConstraints.clipDistance.near,this.cameras.current.far=this._userConstraints.clipDistance.far);this._camerasChanged()},_clipDistanceModeHandler:function(a){this._clipDistanceHandles.forEach(function(a){a.remove()});
this._clipDistanceHandles.length=0;"auto"!==a&&this._clipDistanceHandles.push(this._userConstraints.watch(["clipDistance.near","clipDistance.far"],this._clipDistanceNearFarHandler));this._clipDistanceNearFarHandler()},_updateAutoNearFar:function(a){var b=this._userConstraints&&this._userConstraints.clipDistance;if(!b||"auto"===b.mode){var c=this.renderUnitInMeters,d=this.distanceToSilhouette(a,this.view.dataExtent,c,this._getTerrainElevationBelowCamera(a),D);a.far=d.distance/c;a.far/d.maxFarNearRatio>
this.minNearDistance?a.near=a.far/d.maxFarNearRatio:(a.near=this.minNearDistance,a.far=a.near*d.maxFarNearRatio);b&&a===this.cameras.current&&b.autoUpdate(a.near,a.far)}},constrainTargetEyeByElevation:function(){var a=!1,b=this.elevationProvider;b&&b.spatialReference&&(a=this.cameras.target,b=this._getTerrainElevationBelowCamera(a),a=this._applyElevationConstraint(a.eye,b,this.cameraElevationMargin));return a},constrainTargetEyeByElevationAndMoveLookAt:function(){p.set(this.cameras.target.eye,z);
this.constrainTargetEyeByElevation()&&(p.subtract(z,this.cameras.target.eye),p.subtract(this.cameras.target.center,z))},targetChanged:function(a){this.inherited(arguments);this._targetCameraChangedByElevationUpdate=!1;this._updateAutoNearFar(this.cameras.target);this.currentHasReachedTarget()&&this.currentReachedTarget()},currentChanged:function(){this._updateAutoNearFar(this.cameras.current);this.inherited(arguments)},_applyElevationConstraint:function(a,b,c){if(!this.constraintsEnabled)return!1;
var d=this.renderCoordsHelper,e=d.getAltitude(a);return this.constraints.collision.enabled&&e-b<c?(d.setAltitude(b+c,a,0),!0):!1},_cameraElevationAngle:function(a,b){b=b||{tilt:0,distance:0};this.renderCoordsHelper.worldUpAtPosition(a.center,r);p.subtract(a.eye,a.center,n);a=p.length(n);var c=Math.acos(p.dot(n,r)/a/p.length(r));b.tilt=c;b.distance=a;return b},_elevationChangeTileHandler:function(a){if(this.enableElevationUpdates&&this._targetCameraChangedByElevationUpdate&&this.constraintsEnabled){var b=
!1,c=a.tile.extent;a=this.renderCoordsHelper.fromRenderCoords(this._targetCameraBeforeElevationUpdate.eye,q,a.spatialReference);c[0]<=a.x&&c[1]<=a.y&&c[2]>a.x&&c[3]>a.y&&(B.copyFrom(this.cameras.target),this.cameras.target.copyFrom(this._targetCameraBeforeElevationUpdate),this.constrainTargetEyeByElevation(),this.applyConstraints(this.cameras.target),b=!B.equals(this.cameras.target));b&&(this.isAnimating?this.targetChanged():this.targetAnimatedChanged(!1,{internalUpdate:!0}),this._targetCameraChangedByElevationUpdate=
!0)}},_elevationChangeHandler:function(a){var b=a.extent;a=a.spatialReference;var c=this.renderCoordsHelper.fromRenderCoords(this.cameras.target.eye,a);this._deferredUpdateTargetEyeForElevationChange(b,c,a);this._deferredUpdateTargetCenterForElevationChange(b,c,a)},_isPositionWithinExtent:function(a,b){return b[0]<=a.x&&b[1]<=a.y&&b[2]>a.x&&b[3]>a.y},_deferredUpdateTargetEyeForElevationChange:function(a,b){this.enableElevationUpdates&&this.constraintsEnabled&&this._isPositionWithinExtent(b,a)&&(this.isAnimating?
this._recomputeTargetEyeForElevationChange=!0:this._updateTargetEyeForElevationChange())},_updateTargetEyeForElevationChange:function(){this._recomputeTargetEyeForElevationChange=!1;var a=this.cameras.target;this._targetCameraChangedByElevationUpdate||this._targetCameraBeforeElevationUpdate.copyFrom(a);var b=this._getTerrainElevationBelowCamera(a);if(a=this._applyElevationConstraint(a.eye,b,this.cameraElevationMargin))this.isAnimating?this.targetChanged():this.targetAnimatedChanged(!1,{internalUpdate:!0}),
this._targetCameraChangedByElevationUpdate=!0;return a},_deferredUpdateTargetCenterForElevationChange:function(a,b,c){if(this.enableElevationUpdates&&!this._recomputeTargetCenterForElevationChange){var d=this.renderCoordsHelper.fromRenderCoords(this.cameras.target.center,c);c=Math.max(d.y,b.y);var e=Math.min(d.y,b.y);b=f.intersectIntervals([[Math.min(d.x,b.x),Math.max(d.x,b.x)]],[[a[0],a[2]]]);a=f.intersectIntervals([[e,c]],[[a[1],a[3]]]);0<b.length&&0<a.length&&(this._recomputeTargetCenterForElevationChange=
!0)}},_getTerrainElevationBelowCamera:function(a){var b=this.elevationProvider;return b&&b.spatialReference?(a=this.renderCoordsHelper.fromRenderCoords(a.eye,this.elevationProvider.spatialReference),this.elevationProvider.getElevation(a)||0):0},getCenterIntersectTerrain:function(a,b,c){c||(c=p.create());p.set(b,c);var d=this.picker.pickAlongRay(a,c,null,null,null,!1,this._intersectTerrainSelector);this.picker.pickedIntersectionPoint(d,c)||this.getCenterIntersectManifold(a,b,c)||this.getFallbackCenterAlongViewDirection(a,
b,c);return c},getCenterIntersectManifold:function(a,b,c){p.subtract(b,a,n);return this.intersectManifold(a,n,0,c)},getCameraIntersectTerrain:function(a,b,c,d){var e=this.cameras.current.copy();a&&(e.eye=a);b&&(e.center=b);c&&(e.up=c);this.getCenterIntersectTerrain(e.eye,e.center,C);p.dist2(e.eye,C)<this.minPoiDist&&this.constraintsEnabled&&(a=this.constraints.collision.enabled,p.set(e.viewForward,n),p.scale(n,this.minPoiDist),a?p.subtract(C,n,e.eye):p.add(e.eye,n,C),b=this.renderCoordsHelper,c=b.getAltitude(e.eye),
a&&c<this.cameraElevationMargin&&(p.subtract(C,e.eye,n),b.setAltitude(this.cameraElevationMargin,e.eye),p.add(e.eye,n,C)),e.markViewDirty());0<d?(a=p.dist(e.eye,e.center),p.dist(C,e.center)>a*d&&(e.center=C)):e.center=C;return e}});E.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT=!0;E.Tilt=function(a){this.min=a.min;this.max=a.max};E.Tilt.scale=function(a,b){return 1===b?a:new E.Tilt({min:function(c){return a.min(c*b)},max:function(c){return a.max(c*b)}})};E.Tilt.prototype.apply=function(a,b){return c.clamp(a,
this.min(b),this.max(b))};E.Altitude=function(a){this.min=a.min;this.max=a.max};E.Altitude.scale=function(a,b){return 1===b?a:new E.Altitude({min:function(c){return a.min(c)/b},max:function(c){return a.max(c)/b}})};E.Altitude.prototype.apply=function(a,b){return c.clamp(b,this.min(a),this.max(a))};E.Collision=function(a){this.enabled=null!=a?a:!0};return E})},"esri/views/3d/navigation/spherical/AnimationSpherical":function(){define(["../mixins/AnimationMixin","../../lib/glMatrix","../../support/mathUtils"],
function(m,h,d){function c(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];a=b[3]-a[3];return c*c+d*d+e*e+a*a}function a(a,b){return Math.sqrt(c(a,b))}function b(a){this.interpolate=function(a,b,c){c=Math.min(9*c,.3);d.slerpOrLerp(a.center,b.center,c,a.center,1E-4);d.slerpOrLerp(a.eye,b.eye,c,a.eye,1E-4);d.slerp(a.up,b.up,c);a.fov=d.lerp(a.fov,b.fov,c);a.padding=g.lerp(a.padding,b.padding,c,e);a.computeUpOnSphere()}}function k(b,c,k){c=c||250;k=k||c;var h=0,l=0,m=0,p=0,v=function(a,d,e,f,g){return b.easeInOutInterpLinear(k,
c,a,d,e,f,g)},r=function(a,b,e,g){var h=f.dist(a,b);if(.1>h)return f.set(b,a),0;g=Math.min(g+k*e,Math.min(Math.sqrt(h*k),c));d.slerpOrLerp(a,b,Math.min(g/h*e,1),a,1E-4);return g};this.interpolate=function(b,c,f){h=r(b.eye,c.eye,f,h);l=r(b.center,c.center,f,l);p=r(b.padding,c.padding,f,p,{dist:a,lerp:function(a,b,c){return g.lerp(a,b,c,e)},set:function(a){b.padding=a}});m=v(b.fov,c.fov,f,m,{dist:function(a,b){return Math.abs(b-a)},lerp:d.lerp,set:function(a){b.fov=a}});b.computeUpOnSphere()}}var f=
h.vec3d,g=h.vec4d,e=g.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.AnimationSpherical",constructor:function(){this.interpolationTypes={linear:b,easeInOut:k}}})})},"esri/views/3d/navigation/mixins/AnimationMixin":function(){define(["../../../../core/Accessor","dojo/on","dojo/_base/lang","../../animation/pointToPoint/Animation","../../../animation/easing"],function(m,h,d,c,a){c=c.default;return m.createSubclass([],{declaredClass:"esri.views.3d.navigation.mixins.AnimationMixin",
properties:{interpolation:{set:function(a){if("string"===typeof a){var b=this.interpolationTypes[a];b?this._set("interpolation",new b(this)):console.error("[AnimationMixin] Invalid interpolation type "+a)}else this._set("interpolation",a)}},isAnimating:!1},initialize:function(){this._pointToPointAnimation=new c(this.view.viewingMode);this._targetCameraAnimated=this.cameras.current.copy();this.animationId=0},getDefaults:function(){return{interpolation:"linear"}},easeInOutInterpLinear:function(a,c,
d,g,e,h,m){var b=m.dist(d,g);if(b<.1/this.renderUnitInMeters)return m.set(g,d),0;h=Math.min(h+a*e,Math.min(Math.sqrt(b*a),c));m.set(m.lerp(d,g,Math.min(h/b*e,1)),d);return h},step:function(a){this.inherited(arguments);var b=this.currentHasReachedTarget();this._stepTimeAnimation(a/1E3,b);b&&this.pan.updateContinuous(a)},startAnimation:function(a,c){this.animationId++;this._startTimeAnimation(a,c);this.animationStarted()},_stepTimeAnimation:function(a,c){this.isAnimating&&(c?this.setCurrentToTarget(!0):
(c=this._pointToPointAnimation,c.step(a,this.cameras.current),c.finished?(this.isAnimating=!1,this._updateTargetCenterForElevationWhenIdle()||(this.isAnimating=!0,this.setCurrentToTarget(!0))):this.currentChanged()))},_startTimeAnimation:function(b,c){this.isAnimating=!0;var f={};b&&b.internalUpdate?(f.apex=null,f.duration=.3,f.easing=a.outExpo):f.apex={maximumDistance:this.view.constraints.altitude.max/6};b=d.mixin(f,"object"===typeof b?b:null);this._pointToPointAnimation.update(this.cameras.current,
c?this._targetCameraAnimated:this.cameras.target,b)},animationStarted:function(){h.emit(this,"animationStarted")},stop:function(){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.pan&&this.pan.momentum&&(this.pan.momentum=null);this.currentHasAlmostReachedTarget()?this.currentReachedTarget(!1,!0):(this.cameras.target.copyFrom(this.cameras.current),this.targetAndCurrentChanged(!0))},currentReachedTarget:function(){this.inherited(arguments);this.isAnimating=!1}})})},"esri/views/3d/animation/pointToPoint/Animation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../animation/pointToPoint/Animation ./Camera ../../lib/glMatrix ../../webgl-engine/lib/Camera".split(" "),
function(m,h,d,c,a,b,k){Object.defineProperty(h,"__esModule",{value:!0});var f=b.vec3d,g=f.create();m=function(){function b(b){this.animation=new c.Animation(function(){return new a.default(b)});this._current=new a.default(b)}Object.defineProperty(b.prototype,"finished",{get:function(){return this.currentTime>=this.animation.time},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"time",{get:function(){return this.animation.time},enumerable:!0,configurable:!0});b.prototype.update=
function(a,b,c){var d=this.animation.definition.source,e=this.animation.definition.target,k=f.subtract(b.center,a.center,g),h=f.length(k);1E-5<=h?(k[0]/=h,k[1]/=h,k[2]/=h):(k[0]=0,k[1]=1,k[0]=0);f.set(k,d.lookAtDirection);f.set(k,e.lookAtDirection);d.copyFromRenderCamera(a);e.copyFromRenderCamera(b);this._current.copyFrom(d);this.animation.update(d,e,c);this.currentTime=0};b.prototype.cameraAt=function(a,b){a=this.animation.cameraAt(a,this._current);b||(b=new k);a.copyToRenderCamera(b);return b};
b.prototype.step=function(a,b){this.finished||(this.currentTime+=a,this.currentTime>=this.time&&(this.currentTime=this.time));return this.cameraAt(this.currentTime/this.time,b)};return b}();h.Animation=m;h.default=m})},"esri/views/animation/pointToPoint/Animation":function(){define("require exports ../easing ./Definition ./Settings ./apex/Path".split(" "),function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});var k={zoom:0,pan:0,rotate:0};m=function(){function f(a){this.createCamera=
a;this.time=0;this.definition=new c.Definition(a);this.path=new b.Path}f.prototype.update=function(a,b,c){this.definition.update(a,b,c);this.path.update(this.definition,c);this.time=this._applyTimeSettings(this.path.time,c);this.settings=c};f.prototype.cameraAt=function(a,b){b||(b=this.createCamera());a=Math.min(Math.max(0,a),1);a=this.settings.easing?this.settings.easing(a,1E3*this.time):1<=this.time?d.inOutCoastQuad(a):d.outExpo(a);a=this.path.interpolateComponentsAt(a,k);b.interpolate(this.definition.source,
this.definition.target,a);return b};f.prototype._applyTimeSettings=function(b,c){var d=null!=c.speedFactor?c.speedFactor:1;null!=c.duration?b=c.duration:null!=c.speedFactor&&(b/=d);return b=Math.min(Math.max(null!=c.minDuration?c.minDuration:a.defaultSettings.minDuration/d,b),null!=c.maxDuration?c.maxDuration:a.defaultSettings.maxDuration/d)};return f}();h.Animation=m;h.default=m})},"esri/views/animation/pointToPoint/Definition":function(){define(["require","exports","./Settings"],function(m,h,d){Object.defineProperty(h,
"__esModule",{value:!0});m=function(){function c(a){this.createCamera=a;this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0};this.settings={desiredScreenFlow:d.defaultSettings.desiredScreenFlow};this.source=a();this.target=a()}c.prototype.clone=function(){var a=new c(this.createCamera);a.copyFrom(this);return a};c.prototype.copyFrom=function(a){this.update(a.source,a.target,a.settings)};c.prototype.update=function(a,b,c){this.source!==a&&this.source.copyFrom(a);this.target!==b&&this.target.copyFrom(b);
this.settings.desiredScreenFlow=null!=c.desiredScreenFlow?c.desiredScreenFlow:d.defaultSettings.desiredScreenFlow;this.compared=this.source.compareTo(this.target,this.compared);this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size;this.halfWindowSize=this.target.size/2};c.prototype.halfWindowPanAtZoom=function(a){a=this.target.pixelsPerPanAtZoom(a);return this.halfWindowSize/a};Object.defineProperty(c.prototype,"hasZoom",{get:function(){return 1E-5<Math.abs(this.compared.sourceZoom-
this.compared.targetZoom)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasPan",{get:function(){return 1E-9<this.compared.pan},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasRotate",{get:function(){return 1E-9<this.compared.rotate},enumerable:!0,configurable:!0});return c}();h.Definition=m;h.default=m})},"esri/views/animation/pointToPoint/Settings":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.defaultSettings=
{desiredScreenFlow:2,minDuration:.5,maxDuration:8}})},"esri/views/animation/pointToPoint/apex/Path":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../easing ../Path ../Segment ./planning".split(" "),function(m,h,d,c,a,b,k){Object.defineProperty(h,"__esModule",{value:!0});m=function(a){function f(c,d){var e=a.call(this)||this;e._preallocSegments=[new b.default,new b.default,new b.default];e.update(c,d);return e}d(f,a);f.prototype.update=function(a,b){if(a){this.definition?
this.definition.copyFrom(a):this.definition=a.clone();var c=null;b&&b.apex&&(c=k.optimalDistance(a,b.apex));this.segments.length=0;this._descensionSegment=this._ascensionSegment=null;null==c?this._updateWithoutApex():this._updateWithApex(c,b.apex)}};f.prototype.segmentInterpolateComponentsAt=function(a,b,d){d=a.interpolateComponentsAt(b,d);a===this._ascensionSegment?d.zoom=c.outQuad(d.zoom):a===this._descensionSegment&&(d.zoom=c.inQuad(d.zoom));return d};f.prototype._updateWithApex=function(a,b){var c=
this._preallocSegments,d=c[0],e=c[1],c=c[2],f=null!=b.ascensionFactor?b.ascensionFactor:.5;b=Math.min(1-f,null!=b.ascensionFactor?b.descensionFactor:.5);var g=1-f-b;d.definition?d.definition.copyFrom(this.definition):d.definition=this.definition.clone();d.definition.compared.targetZoom=a;d.definition.compared.pan=this.definition.compared.pan*f;d.definition.compared.rotate=this.definition.compared.rotate*f;d.update();this._ascensionSegment=d;this.segments.push(d);0<g&&(e.definition?e.definition.copyFrom(this.definition):
e.definition=this.definition.clone(),e.definition.copyFrom(this.definition),e.definition.compared.sourceZoom=a,e.definition.compared.targetZoom=a,e.definition.compared.pan=this.definition.compared.pan*g,e.definition.compared.rotate=this.definition.compared.rotate*g,e.update(),this.segments.push(e));c.definition?c.definition.copyFrom(this.definition):c.definition=this.definition.clone();c.definition.compared.sourceZoom=a;c.definition.compared.pan=this.definition.compared.pan*b;c.definition.compared.rotate=
this.definition.compared.rotate*b;c.update();this._descensionSegment=c;this.segments.push(c)};f.prototype._updateWithoutApex=function(){var a=this._preallocSegments[0];a.update(this.definition);this.segments.push(a)};return f}(a.default);h.Path=m;h.default=m})},"esri/views/animation/pointToPoint/Path":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function d(){this.segments=[]}Object.defineProperty(d.prototype,"time",{get:function(){return this.segments.reduce(function(c,
a){return c+a.time},0)},enumerable:!0,configurable:!0});d.prototype.interpolateComponentsAt=function(c,a){c=Math.min(Math.max(c,0),1);c*=this.time;for(var b=0,d=0,f=this.definition,g=0;g<this.segments.length;g++){var e=this.segments[g],h=e.definition;if(c<=e.time||g===this.segments.length-1)return a=this.segmentInterpolateComponentsAt(e,c/e.time,a),a.pan=f.hasPan?(b+h.compared.pan*a.pan)/f.compared.pan:1,a.rotate=f.hasRotate?(d+h.compared.rotate*a.rotate)/f.compared.rotate:1,c=a.zoom*(h.compared.targetZoom-
h.compared.sourceZoom)+h.compared.sourceZoom,b=this.segments[0].definition.compared.sourceZoom,d=this.segments[this.segments.length-1].definition.compared.targetZoom,a.zoom=f.hasZoom?(c-b)/(d-b):1,a;c-=e.time;b+=h.compared.pan;d+=h.compared.rotate}};d.prototype.segmentInterpolateComponentsAt=function(c,a,b){return c.interpolateComponentsAt(a,b)};return d}();h.Path=m;h.default=m})},"esri/views/animation/pointToPoint/Segment":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,
"__esModule",{value:!0});m=function(){function d(c){c&&this.update(c)}d.prototype.update=function(c){c&&(this.definition?this.definition.copyFrom(c):this.definition=c.clone());this._updatePrecomputedVariables();this._updatePixelFlow()};d.prototype._updatePrecomputedVariables=function(){var c=this.definition,a=c.compared,b=a.sourceZoom,d=a.targetZoom;this._sl=b>d?1:-1;this._panPixelsAtSource=a.pan*c.source.pixelsPerPanAtZoom(b);c=(c.source.pixelsPerRotateAtZoom(b)+c.target.pixelsPerRotateAtZoom(d))/
2;this._rotatePixels=a.rotate*c};d.prototype._updatePixelFlow=function(){var c=this.definition.compared.sourceZoom,a=this.definition.compared.targetZoom,b=this.definition.hasZoom,d=this.definition.hasPan,f=this.definition.hasRotate,g,e;g=d&&b?(a/c-1)/(-1/(this._sl*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource):0;e=b&&f?Math.log(c/a)/Math.LN2*this._sl*this.definition.halfWindowSize/this._rotatePixels:0;this._rotatePixelFlow=this._panPixelFlow=this._zoomPixelFlow=0;c=this.definition.desiredPixelFlow;
b&&d&&f?(a=g+e+g*e,this._zoomPixelFlow=g*e/a*c,this._panPixelFlow=e/a*c,this._rotatePixelFlow=g/a*c):b&&d?(a=1+g,this._zoomPixelFlow=g/a*c,this._panPixelFlow=1/a*c):b&&f?(a=1+e,this._zoomPixelFlow=e/a*c,this._rotatePixelFlow=1/a*c):d&&f?(g=this._panPixelsAtSource/this._rotatePixels,a=1+g,this._panPixelFlow=g/a*c,this._rotatePixelFlow=1/a*c):d?this._panPixelFlow=c:b?this._zoomPixelFlow=c:f&&(this._rotatePixelFlow=c);this.time=f?this.rotateTime:b?this.zoomTime:d?this.panTime:0};Object.defineProperty(d.prototype,
"zoomTime",{get:function(){return this.definition.hasZoom?Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2*this._sl*this.definition.halfWindowSize/this._zoomPixelFlow:0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"panTime",{get:function(){if(this.definition.hasPan){if(this.definition.hasZoom){var c=-1/(this._sl*this.definition.halfWindowSize)*Math.LN2;return Math.log(this._zoomPixelFlow/this._panPixelFlow*this._panPixelsAtSource*c+1)/
(c*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}return 0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"rotateTime",{get:function(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0},enumerable:!0,configurable:!0});d.prototype._interpolateComponentsZoom=function(c){if(this.definition.hasZoom){var a=this.definition.compared.sourceZoom,b=this.definition.compared.targetZoom;return(a*Math.pow(a/b,-c)-a)/(b-a)}return c};d.prototype._interpolateComponentsPan=
function(c){if(this.definition.hasPan&&this.definition.hasZoom){var a=-1/(this._sl*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*this._panPixelFlow*(Math.pow(2,a*c*this.time)-1)/(a*Math.LN2)}return c};d.prototype._interpolateComponentsRotate=function(c){return c};d.prototype.interpolateComponentsAt=function(c,a){c=Math.min(Math.max(c,0),1);var b=this._interpolateComponentsZoom(c),d=this._interpolateComponentsPan(c);c=this._interpolateComponentsRotate(c);a?(a.zoom=
b,a.pan=d,a.rotate=c):a={zoom:b,pan:d,rotate:c};return a};return d}();h.Segment=m;h.default=m})},"esri/views/animation/pointToPoint/apex/planning":function(){define(["require","exports","./functions"],function(m,h,d){function c(a,b){var c=Math.max(a.compared.sourceZoom,a.compared.targetZoom);a=a.source.zoomAtPixelsPerPan(a.desiredPixelFlow/a.compared.pan)/2;return a<c?null!=b.maximumDistance?c+(b.maximumDistance-c)/2:1.5*c:b.maximumDistance?Math.min(b.maximumDistance,a):a}Object.defineProperty(h,
"__esModule",{value:!0});h.optimalDistance=function(a,b){var k=c(a,b),f={ascensionFactor:null!=b.ascensionFactor?b.ascensionFactor:.5,descensionFactor:null!=b.descensionFactor?b.descensionFactor:.5},g=0===f.ascensionFactor,e=0===f.descensionFactor,h=g?d.tAscensionZoomOnly:d.tAscensionZoomPan,m=g?d.dtAscensionZoomOnly:d.dtAscensionZoomPan,v=g?d.ddtAscensionZoomOnly:d.ddtAscensionZoomPan,q=e?d.tDescensionZoomOnly:d.tDescensionZoomPan,n=e?d.dtDescensionZoomOnly:d.dtDescensionZoomPan,t=e?d.ddtDescensionZoomOnly:
d.ddtDescensionZoomPan,g=function(b){return h(a,f,b)+d.tPanion(a,f,b)+q(a,f,b)},e=function(b){return m(a,f,b)+d.dtPanion(a,f,b)+n(a,f,b)},u=function(b){return v(a,f,b)+d.ddtPanion(a,f,b)+t(a,f,b)},x=g(k),r=d.tBaseLine(a),z=b.maximumIterations||20,B=null!=b.maximumDistance?b.maximumDistance:Infinity;for(b=0;b<z;b++){var C=(e(k)+1E-6)/u(k);if(isNaN(C)||k>=B&&0>C){if(!isFinite(B))return null;k=B;x=g(k);break}k-=C;if(k<a.compared.sourceZoom||k<a.compared.targetZoom)return null;C=g(k);if(.005>=Math.abs(C-
x)/x)break;x=C}return x>.7*r?null:k<a.compared.sourceZoom||k<a.compared.targetZoom?null:k}})},"esri/views/animation/pointToPoint/apex/functions":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.tAscensionZoomPan=function(d,c,a){var b=d.halfWindowPanAtZoom(a-d.compared.sourceZoom);return-d.halfWindowSize*(c.ascensionFactor*Math.LN2*d.compared.pan+b)*Math.log(d.compared.sourceZoom/a)/(d.desiredPixelFlow*Math.LN2*b)};h.dtAscensionZoomPan=function(d,
c,a){var b=1/a,k=Math.log(d.compared.sourceZoom*b),f=1/d.desiredPixelFlow,g=1/Math.LN2;a-=d.compared.sourceZoom;var e=1/a;c=(c.ascensionFactor*Math.LN2*d.compared.pan+d.halfWindowPanAtZoom(a))/d.halfWindowPanAtZoom(1);return d.halfWindowSize*b*f*g*e*c-d.halfWindowSize*k*f*g*e+d.halfWindowSize*k*f*g*c/(a*a)};h.ddtAscensionZoomPan=function(d,c,a){var b=a-d.compared.sourceZoom,k=1/b,f=1/a,g=Math.log(d.compared.sourceZoom*f);c=(c.ascensionFactor*Math.LN2*d.compared.pan+d.halfWindowPanAtZoom(b))/d.halfWindowPanAtZoom(1);
return d.halfWindowSize*k*(-2*k*f*c+2*k*g+2*f-2*g*c/(b*b)-c/(a*a))/(d.desiredPixelFlow*Math.LN2)};h.tAscensionZoomOnly=function(d,c,a){return-d.halfWindowSize*Math.log(d.compared.sourceZoom/a)/(d.desiredPixelFlow*Math.LN2)};h.dtAscensionZoomOnly=function(d,c,a){return d.halfWindowSize/(a*d.desiredPixelFlow*Math.LN2)};h.ddtAscensionZoomOnly=function(d,c,a){return-d.halfWindowSize/(a*a*d.desiredPixelFlow*Math.LN2)};h.tPanion=function(d,c,a){return-d.compared.pan*d.halfWindowSize*(c.ascensionFactor+
c.descensionFactor-1)/(d.desiredPixelFlow*d.halfWindowPanAtZoom(a))};h.dtPanion=function(d,c,a){return d.compared.pan*d.halfWindowSize*(c.ascensionFactor+c.descensionFactor-1)/(d.desiredPixelFlow*d.halfWindowPanAtZoom(a*a))};h.ddtPanion=function(d,c,a){return-2*d.compared.pan*d.halfWindowSize*(c.ascensionFactor+c.descensionFactor-1)/(d.desiredPixelFlow*d.halfWindowPanAtZoom(a*a*a))};h.tDescensionZoomPan=function(d,c,a){return d.halfWindowSize*(-d.halfWindowPanAtZoom(a)-c.descensionFactor*Math.LN2*
d.compared.pan+d.halfWindowPanAtZoom(d.compared.targetZoom))*Math.log(a/d.compared.targetZoom)/(d.desiredPixelFlow*Math.LN2*d.halfWindowPanAtZoom(-a+d.compared.targetZoom))};h.dtDescensionZoomPan=function(d,c,a){var b=Math.log(a/d.compared.targetZoom),k=1/d.desiredPixelFlow,f=1/Math.LN2,g=-a+d.compared.targetZoom,e=1/g;c=(-d.halfWindowPanAtZoom(a)-c.descensionFactor*Math.LN2*d.compared.pan+d.halfWindowPanAtZoom(d.compared.targetZoom))/d.halfWindowPanAtZoom(1);return-d.halfWindowSize*b*k*f*e+d.halfWindowSize*
b*k*f*c/(g*g)+d.halfWindowSize*k*f*e*c/a};h.ddtDescensionZoomPan=function(d,c,a){var b=a-d.compared.targetZoom,k=1/b,f=1/a,g=Math.log(a/d.compared.targetZoom);c=(d.halfWindowPanAtZoom(a)+c.descensionFactor*Math.LN2*d.compared.pan-d.halfWindowPanAtZoom(d.compared.targetZoom))/d.halfWindowPanAtZoom(1);return d.halfWindowSize*k*(-2*k*f*c-2*k*g+2*f+2*g*c/(b*b)-c/(a*a))/(d.desiredPixelFlow*Math.LN2)};h.tDescensionZoomOnly=function(d,c,a){return d.halfWindowSize*Math.log(a/d.compared.targetZoom)/(d.desiredPixelFlow*
Math.LN2)};h.dtDescensionZoomOnly=function(d,c,a){return d.halfWindowSize/(a*d.desiredPixelFlow*Math.LN2)};h.ddtDescensionZoomOnly=function(d,c,a){return-d.halfWindowSize/(a*a*d.desiredPixelFlow*Math.LN2)};h.tBaseLine=function(d){var c=Math.LN2*d.compared.pan,a=d.halfWindowPanAtZoom(d.compared.sourceZoom-d.compared.targetZoom),b=d.halfWindowSize*Math.log(d.compared.sourceZoom/d.compared.targetZoom)/(d.desiredPixelFlow*Math.LN2*a);return d.compared.sourceZoom<=d.compared.targetZoom?b*(c-a):b*(c+a)}})},
"esri/views/3d/animation/pointToPoint/Camera":function(){define(["require","exports","../../lib/glMatrix","../../support/mathUtils"],function(m,h,d,c){Object.defineProperty(h,"__esModule",{value:!0});var a=c.angle,b=c.lerp,k=c.slerpOrLerp,f=d.vec3d,g=d.mat3d,e=f.create(),l=f.create(),p=f.create(),v=f.create(),q=f.create(),n=f.createFrom(0,0,1),t=f.createFrom(0,1,0),u=f.createFrom(1,0,0),x=g.create();m=function(){function c(a){void 0===a&&(a="global");this.viewingMode=a;this.center=f.create();this.distance=
this.yaw=this.pitch=0;this.lookAtDirection=f.create(t)}c.prototype.pixelsPerPanAtZoom=function(a){return this.size/2/(this._zoomToPanScale*a)};c.prototype.zoomAtPixelsPerPan=function(a){return this.size/2/(this._zoomToPanScale*a)};c.prototype.pixelsPerRotateAtZoom=function(a){return this.size/2/Math.max(Math.cos(Math.abs(this.pitch)),.5)};c.prototype.compareTo=function(b,c){c||(c={pan:0,rotate:0,sourceZoom:0,targetZoom:0});if("global"===this.viewingMode){var d=f.length(this.center),e=f.length(b.center),
d=(d+e)/2;c.pan=a(this.center,b.center)*d}else c.pan=f.dist(this.center,b.center);d=Math.abs(b.yaw-this.yaw);d>=Math.PI&&(d=2*Math.PI-d);c.rotate=Math.max(d,Math.abs(b.pitch-this.pitch));c.sourceZoom=this.distance;c.targetZoom=b.distance;return c};c.prototype.interpolate=function(a,c,d){"global"===this.viewingMode?k(a.center,c.center,d.pan,this.center,r):f.lerp(a.center,c.center,d.pan,this.center);this.distance=b(a.distance,c.distance,d.zoom);this.pitch=b(a.pitch,c.pitch,d.rotate);a=a.yaw;c=c.yaw;
Math.abs(c-a)>=Math.PI&&(a+=2*(a<c?1:-1)*Math.PI);this.yaw=b(a,c,d.rotate)};c.prototype.copyFrom=function(a){f.set(a.center,this.center);this.pitch=a.pitch;this.yaw=a.yaw;this.distance=a.distance;f.set(a.lookAtDirection,this.lookAtDirection);this.size=a.size;this.copyFromCommon(a);this.viewingMode=a.viewingMode};c.prototype.copyFromRenderCamera=function(a){var b=this._lookAtOrientation(a.center,x);f.set(a.center,this.center);g.multiplyVec3(b,f.subtract(a.center,a.eye,v));g.multiplyVec3(b,a.up,q);
this.distance=f.length(v);v[0]/=this.distance;v[1]/=this.distance;v[2]/=this.distance;this.pitch=this._eyeUpToPitch(v,q);this.yaw=this._eyeUpToYaw(v,q);this.size=Math.sqrt(a.width*a.width+a.height*a.height);this.copyFromCommon(a)};c.prototype.copyFromCommon=function(a){this.fov=a.fov;this._zoomToPanScale=Math.atan(.5*this.fov)};c.prototype.copyToRenderCamera=function(a){var b=this._lookAtOrientation(this.center,x);g.transpose(b);this._axisAngleVec3(u,this.pitch-Math.PI/2,t,v);this._axisAngleVec3(n,
this.yaw,v);this._axisAngleVec3(u,this.pitch-Math.PI/2,n,q);this._axisAngleVec3(n,this.yaw,q);f.scale(v,this.distance);g.multiplyVec3(b,v);g.multiplyVec3(b,q);a.center=this.center;a.eye=f.subtract(this.center,v,v);a.up=q};c.prototype._axisAngleVec3=function(a,b,c,d){void 0===d&&(d=c);var g=Math.cos(b);b=Math.sin(b);f.scale(c,g,e);f.scale(f.cross(a,c,l),b);f.scale(a,(1-g)*f.dot(a,c),p);return f.add(f.add(e,l,d),p,d)};c.prototype._lookAtOrientation=function(a,b){this._upAtLookAt(a,p);f.normalize(f.cross(this.lookAtDirection,
p,e));0===e[0]&&0===e[1]&&0===e[2]&&f.set(u,e);f.normalize(f.cross(p,e,l));b||(b=g.create());b[0]=e[0];b[1]=l[0];b[2]=p[0];b[3]=e[1];b[4]=l[1];b[5]=p[1];b[6]=e[2];b[7]=l[2];b[8]=p[2];return b};c.prototype._upAtLookAt=function(a,b){return"local"===this.viewingMode?f.set(n,b):f.normalize(a,b)};c.prototype._eyeUpToPitch=function(b,c){return Math.PI-a(n,b)};c.prototype._eyeUpToYaw=function(b,c){return a(u,f.normalize(f.cross(.5>Math.abs(c[2])?c:b,n,l)),n)};return c}();var r=1E-4;h.default=m})},"esri/views/3d/navigation/spherical/actions/PanSpherical":function(){define("./ActionSpherical ../../mixins/PanMixin ../../../lib/glMatrix ../../../support/earthUtils ../../../support/mathUtils ../../../webgl-engine/lib/Util ../../ContinuousAction ../../NavigationConstants ../../../webgl-engine/lib/Camera ./Momentum".split(" "),
function(m,h,d,c,a,b,k,f,g,e){var l=d.vec2d,p=d.vec3d,v=d.vec4d,q=d.mat4d,n=p.create(),t=p.create(),u=p.create(),x=p.create(),r=p.create(),z=p.create(),B=q.create(),C=f.Pan.Mode,A=f.Pan.Direction,D=f.Pan.Vertical;return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.spherical.actions.PanSpherical",constructor:function(){this._panMode=0;this._plane=v.create();this.momentum=null;this._momentumEstimator=new e.ScreenspaceMomentumEstimator(.05,500,12,.82);this._momentumDirection=p.create();
this.momentumEnabled=!0;this._momentumInitialCamera=new g;this.continuous=new k},begin:function(a,d){this.inherited(arguments);this._momentumEstimator.reset();this.pickPointInScreen(a,this._navPickPoint)?this._navSphereRadius=p.length(this._navPickPoint):(this._navSphereRadius=p.length(this.targetCamera.center),this._navSphereRadius<.9*c.earthRadius&&(this._navSphereRadius=c.earthRadius),this.createPickRay(a,a,this.currentCamera.viewMatrix,n,t),p.subtract(t,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,
t,this._navSphereRadius-c.earthRadius,this._navPickPoint)||this.closestPointOnSphereSilhouette(this.currentCamera.eye,n,this._navSphereRadius,this._navPickPoint));var e=!1;this.renderCoordsHelper.getAltitude(this.currentCamera.eye)<D.ELEVATION_THRESHOLD&&(this._navSphereRadius>p.length(this.currentCamera.eye)?e=!0:(p.normalize(p.subtract(this.targetCamera.eye,this._navPickPoint,u)),e=Math.abs(.5*Math.PI-Math.acos(p.dot(this._navPickPoint,u)/p.length(this._navPickPoint)))<D.ANGLE_THRESHOLD));e?(this._panMode=
C.VERTICAL,p.normalize(p.subtract(this.targetCamera.eye,this.targetCamera.center,u)),this.updatePlane(this._navPickPoint,u)):(this._panMode=C.HORIZONTAL,e=void 0===d?b.performance.now():d,this._momentumEstimator.add(a[0],a[1],this._navPickPoint,.001*e));l.set(a,this._dragLastPoint);l.set(a,this._dragBeginPoint);this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(a,d){if(this._panMode===C.HORIZONTAL){if(0>=this._navSphereRadius)return;this.createPickRay(a,this._dragBeginPoint,this._mouseDownCamera.viewMatrix,
n,t);p.subtract(t,this._mouseDownCamera.eye);this.intersectManifold(this._mouseDownCamera.eye,t,this._navSphereRadius-c.earthRadius,this._targetOnSphere)||this.closestPointOnSphereSilhouette(this._mouseDownCamera.eye,n,this._navSphereRadius,this._targetOnSphere);this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,this._mouseDownCamera,this.targetCamera,this._navSphereRadius);var e=void 0===d?b.performance.now():d;this._momentumEstimator.add(a[0],a[1],this._targetOnSphere,.001*
e)}else{this.createPickRay(this._dragLastPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,n,t);p.subtract(t,n);if(!b.rayPlane(n,t,this._plane,x))return;this.createPickRay(a,this._dragBeginPoint,this.currentCamera.viewMatrix,n,t);p.subtract(t,n);if(!b.rayPlane(n,t,this._plane,r))return;p.subtract(r,x);p.subtract(this.targetCamera.eye,r);p.subtract(this.targetCamera.center,r);l.set(a,this._dragLastPoint)}this.constrainTargetEyeByElevationAndMoveLookAt();l.set(a,this._dragLastPoint);this.fixTargetUpVector();
this.targetAndCurrentChanged();this.inherited(arguments)},end:function(a,b){this.update(a,b);this._panMode===C.HORIZONTAL&&this._initiateMomentumPanning(a,b);this._navSphereRadius=0;this.inherited(arguments)},_initiateMomentumPanning:function(a,b){if(0>=this._navSphereRadius)return this.setPoiAuto(a,!0),!1;this.update(a,b);this.momentumEnabled&&(this.momentum=this._momentumEstimator.evaluateMomentum());if(this.momentum)return this._momentumInitialVelocity=this.rotationFromPointsOnSphere(this.momentum.dataOldest,
this.momentum.dataNewest,this._navSphereRadius,this._momentumDirection)/this.momentum.dataTimeDelta,this._momentumElapsed=0,this._momentumInitialCamera.copyFrom(this.currentCamera),this.animationStarted(),!0;this.currentReachedTarget();return!1},beginContinuous:function(a){var b=0===this.continuous.status;this.momentum=null;b&&(this.navigation.begin(this),this.active=!0,this.emit("begin"));this.inherited(arguments);this.setCurrentToTarget();b&&p.set3(0,0,0,this.continuous.direction);this.continuous.status&
a||(this.continuous.status|=a,a&(A.LEFT|A.RIGHT|A.FORWARD|A.BACKWARD)?(this._computePanAxis(a,z),p.add(this.continuous.direction,z)):(b=this.continuous.status&(A.UP|A.DOWN),this.continuous.radiusChange=b===A.UP?1:b===A.DOWN?-1:0),this.continuous.velocity=this._computePanVelocity());this.continuous.timer=0},updateContinuous:function(a){if(this.continuous){var b=0,c=null,d=!1;if(this.momentum)this._momentumElapsed+=.001*a,b=this.momentum.valueFromInitialVelocity(this._momentumInitialVelocity,this._momentumElapsed),
c=this._momentumDirection,q.identity(B),q.rotate(B,b,c),q.multiplyVec3(B,this._momentumInitialCamera.eye,this.targetCamera.eye),q.multiplyVec3(B,this._momentumInitialCamera.center,this.targetCamera.center),q.multiplyVec3(B,this._momentumInitialCamera.up,this.targetCamera.up),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevationAndMoveLookAt(),this.fixTargetUpVector(),this.momentum.isFinished(this._momentumElapsed)?(this.momentum=null,this.setCurrentToTarget(!0,!1)):this.targetAndCurrentChanged();
else{var b=this.continuous.step(a),c=this.continuous.direction,d=.01<p.dot(this.continuous.direction,this.continuous.direction),e=this.targetCamera;if(0<Math.abs(this.continuous.radiusChange)){a=1+b*this.continuous.radiusChange;var f=e.viewForward,e=p.normalize(e.center,t);(-.999<p.dot(f,e)||0>this.continuous.radiusChange)&&p.scale(this.targetCamera.center,a);p.scale(this.targetCamera.eye,a);this.continuous.velocity=this._computePanVelocity();d||(this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevationAndMoveLookAt(),
this.fixTargetUpVector(),this.targetAndCurrentChanged())}}d&&(q.identity(B),q.rotate(B,b,c),q.multiplyVec3(B,this.targetCamera.eye),q.multiplyVec3(B,this.targetCamera.center),q.multiplyVec3(B,this.targetCamera.up),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevationAndMoveLookAt(),this.fixTargetUpVector(),this.targetAndCurrentChanged());this.emit("update")}},endContinuous:function(a){this.continuous.status&=~a;this.momentum=null;if(0===this.continuous.status)this.continuous.stop(),
this.continuous.radiusChange=0,this.active=!1,this.emit("end"),this.navigation.end(this);else if(a&(A.LEFT|A.RIGHT|A.FORWARD|A.BACKWARD))this._computePanAxis(a,z),p.subtract(this.continuous.direction,z),.01>p.length(this.continuous.direction)&&p.set3(0,0,0,this.continuous.direction);else{var b=this.continuous.status&(A.UP|A.DOWN);this.continuous.radiusChange=b==A.UP?1:b==A.DOWN?-1:0}this.inherited(arguments)},_computePanAxis:function(a,b){p.subtract(this.targetCamera.center,this.targetCamera.eye,
b);p.cross(b,this.targetCamera.up);if(a===A.LEFT||a===A.RIGHT)p.normalize(b),p.cross(b,this.targetCamera.center);a!==A.RIGHT&&a!==A.FORWARD||p.negate(b);p.normalize(b)},_computePanVelocity:function(){var b=.5*Math.abs(p.length(this.targetCamera.eye)-c.earthRadius),b=a.clamp(b,1,2*c.earthRadius);return a.acos(1-b*b/(2*c.earthRadius*c.earthRadius))},updatePlane:function(a,b){v.set4(b[0],b[1],b[2],-p.dot(b,a),this._plane)}})})},"esri/views/3d/navigation/spherical/actions/ActionSpherical":function(){define(["../../Action",
"../../../support/mathUtils","../../../lib/glMatrix"],function(m,h,d){var c=d.vec3d,a=d.mat4d,b=c.create(),k=a.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.actions.ActionSpherical",constructor:function(){this._targetOnSphere=c.create();this._navSphereRadius=0},closestPointOnSphereSilhouette:function(d,g,e,l){c.cross(d,g,b);c.cross(b,d,l);c.scale(l,1/c.length(l)*e);d=-h.asin(e/c.length(d));a.identity(k);a.rotate(k,d,b);a.multiplyVec3(k,l)},rotateCameraWithPointsOnSphere:function(a,
b,c,d,k){return this.navigation.rotateCameraWithPointsOnSphere(a,b,c,d,k)},rotationFromPointsOnSphere:function(a,b,c,d){return this.navigation.rotationFromPointsOnSphere(a,b,c,d)}})})},"esri/views/3d/navigation/Action":function(){define(["../../../core/Accessor","../../../core/Evented","../webgl-engine/lib/Camera","../lib/glMatrix","dojo/on"],function(m,h,d,c,a){var b=c.vec3d,k=c.vec2d;return m.createSubclass([h],{properties:{type:{},navigation:{},picker:{readOnly:!0,aliasOf:"navigation.picker"},
currentCamera:{aliasOf:"navigation.currentCamera"},targetCamera:{aliasOf:"navigation.targetCamera"},constraints:{readOnly:!0,aliasOf:"navigation.constraints"},renderCoordsHelper:{readOnly:!0,aliasOf:"navigation.renderCoordsHelper"},minPoiDist:{readOnly:!0,aliasOf:"navigation.minPoiDist"}},constructor:function(){this._tmpEvent={type:null,phase:null,x:void 0,y:void 0};this._mouseDownCamera=new d;this._navPickPoint=b.create();this._dragLastPoint=k.create();this._dragBeginPoint=k.create();this.active=
!1},initialize:function(){var a=this;["minPoiDist","renderCoordsHelper","constraints","picker"].forEach(function(b){this.navigation.watch(b,function(){a.notifyChange(b)})}.bind(this))},emit:function(b,c,d){this._tmpEvent.type=this.type;this._tmpEvent.phase=b;this._tmpEvent.x=c;this._tmpEvent.y=d;a.emit(this,b,this._tmpEvent);a.emit(this.navigation,this.type,this._tmpEvent)},intersectManifold:function(a,b,c,d){return this.navigation.intersectManifold(a,b,c,d)},fixTargetUpVector:function(){return this.navigation.fixTargetUpVector()},
setPoiAuto:function(a,b){return this.navigation.setPoiAuto(a,b)},normalizeCoordinate:function(a,b){b[0]=a[0]/this.currentCamera.width;b[1]=a[1]/this.currentCamera.height},worldUpAtPosition:function(a,b){return this.renderCoordsHelper.worldUpAtPosition(a,b)},applyConstraints:function(a,b){return this.navigation.applyConstraints(a,b)},constrainTargetEyeByElevation:function(a){return this.navigation.constrainTargetEyeByElevation(a)},constrainTargetEyeByElevationAndMoveLookAt:function(){return this.navigation.constrainTargetEyeByElevationAndMoveLookAt()},
targetAndCurrentChanged:function(a){return this.navigation.targetAndCurrentChanged(a)},targetAnimatedChanged:function(a,b){return this.navigation.targetAnimatedChanged(a,b)},currentReachedTarget:function(a){return this.navigation.currentReachedTarget(a)},setCurrentToTarget:function(a,b){return this.navigation.setCurrentToTarget(a,b)},animationStarted:function(){return this.navigation.animationStarted()},limitAltitude:function(a,b,c,d){return this.navigation.limitAltitude(a,b,c,d)},limitTiltByConstraints:function(a,
b,c,d){return this.navigation.limitTiltByConstraints(a,b,c,d)},createPickRay:function(a,b,c,d,k){return this.picker.createPickRay(a,b,c,d,k)},pickAlongRay:function(a,b,c,d,k,h){return this.picker.pickAlongRay(a,b,c,d,k,h)},pickPointInScreen:function(a,b){return this.picker.pickPointInScreen(a,b)},pickFreePointInScreen:function(a,b){return this.picker.pickFreePointInScreen(a,b)},pickInScreen:function(a){return this.picker.pickInScreen(a)}})})},"esri/views/3d/navigation/mixins/PanMixin":function(){define(["../../../../core/declare"],
function(m){return m([],{declaredClass:"esri.views.3d.navigation.mixins.PanMixin",type:"pan",begin:function(h){this.navigation.begin(this);this.active=!0;this.emit("begin")},update:function(h){this.emit("update")},end:function(h){this.active=!1;this.emit("end");this.navigation.end(this)},beginContinuous:function(h){},updateContinuous:function(h){},endContinuous:function(h){}})})},"esri/views/3d/navigation/ContinuousAction":function(){define(["../../../core/Accessor","../lib/glMatrix"],function(m,
h){var d=h.vec3d;return m.createSubclass({properties:{active:{get:function(){return 0!==this.velocity},dependsOn:["velocity"],readOnly:!0},velocity:{}},constructor:function(){this.direction=d.create();this.status=this.timer=this.velocity=0},stop:function(){this.status=this.velocity=this.timer=0;d.set3(0,0,0,this.direction)},step:function(c){var a;c*=.001;0<this.timer?(c=Math.min(c,this.timer),a=this.velocity*c*(1-c/(2*this.timer)),this.velocity*=1-c/this.timer,this.timer-=c):a=this.velocity*c;return a}})})},
"esri/views/3d/navigation/spherical/actions/Momentum":function(){define(["require","exports","../../../../navigation/Momentum"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.ScreenspaceMomentumEstimator=d.ScreenspaceMomentumEstimator;h.ScreenspaceMomentum=d.ScreenspaceMomentum})},"esri/views/3d/navigation/spherical/actions/ZoomSpherical":function(){define(["./ActionSpherical","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../support/earthUtils"],function(m,h,d,c){var a=
d.vec2d,b=d.vec3d,k=d.mat4d,f=b.create(),g=b.create(),e=b.create(),l=k.create(),p=b.create(),v=b.create();return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.spherical.actions.ZoomSpherical",constructor:function(){},begin:function(a){this.inherited(arguments);this.pickPointInScreen(a,this._navPickPoint)?this._navSphereRadius=b.length(this._navPickPoint):(this._navSphereRadius=b.length(this.targetCamera.center),this._navSphereRadius<.9*c.earthRadius&&(this._navSphereRadius=c.earthRadius),
this.createPickRay(a,a,this.currentCamera.viewMatrix,f,g),b.subtract(g,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,g,this._navSphereRadius-c.earthUtils,this._navPickPoint)||(this._navSphereRadius=0));this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(d){var h=this.targetCamera;h.eye=this._mouseDownCamera.eye;h.center=this._mouseDownCamera.center;h.up=this._mouseDownCamera.up;b.subtract(h.center,h.eye,e);var m=b.length(e);this.normalizeCoordinate(d,f);var p=
12*(f[1]-this.normalizedAnchorPoint[1]);d=m*Math.pow(2,p);0>p&&d<this.navigation.minPoiDist&&(d=this.navigation.minPoiDist);d=this.limitAltitude(d,h.center,e,m);1E-6>Math.abs(m-d)||(0<this._navSphereRadius&&d<m&&(p=1-(1-d/m)*(1-this._navSphereRadius/b.length(h.center)),b.scale(h.center,p)),b.scale(e,-d/m),b.add(h.center,e,h.eye),m=!1,0<this._navSphereRadius&&(k.lookAt(h.eye,h.center,h.up,l),this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,l,f,g),b.normalize(b.subtract(g,h.eye)),this.intersectManifold(h.eye,
g,this._navSphereRadius-c.earthRadius,this._targetOnSphere)||(this.closestPointOnSphereSilhouette(h.eye,f,this._navSphereRadius,this._targetOnSphere),m=!0),this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,h,h,this._navSphereRadius),this.fixTargetUpVector()),this.applyConstraints(h),this.constrainTargetEyeByElevation(),this.targetAndCurrentChanged(),a.set(this._dragBeginPoint,this._dragLastPoint),m&&(k.lookAt(h.eye,h.center,h.up,l),this._dragLastPoint=this.currentCamera.projectPoint(this._navPickPoint,
l)),h=this._toYDownCoord(this._dragLastPoint),this.emit("update",h[0],h[1]))},stepAtPoint:function(a,d,e,h){b.set(d,v);d=b.length(v);b.subtract(this.targetCamera.eye,this.targetCamera.center,p);var m=b.length(p),n=m*a,n=1>=a&&n<this.minPoiDist?this.minPoiDist:this.limitAltitude(n,v,p,-m);a=n/m;1E-6>Math.abs(m-n)||(h&&(m=b.length(this.targetCamera.center),b.scale(this.targetCamera.center,(d+a*(m-d))/m)),b.scale(p,a),b.add(this.targetCamera.center,p,this.targetCamera.eye),h&&e&&(k.lookAt(this.targetCamera.eye,
this.targetCamera.center,this.targetCamera.up,l),this.createPickRay(e,e,l,f,g),b.normalize(b.subtract(g,this.targetCamera.eye)),this.intersectManifold(this.targetCamera.eye,g,d-c.earthRadius,this._targetOnSphere)?this.rotateCameraWithPointsOnSphere(v,this._targetOnSphere,this.targetCamera,this.targetCamera,d):h=!1),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevation(),h&&this.fixTargetUpVector(),this.navigation.currentHasAlmostReachedTarget()?this.targetAndCurrentChanged():
this.targetAnimatedChanged(!1,{internalUpdate:!0}))}})})},"esri/views/3d/navigation/mixins/ZoomMixin":function(){define(["../../../../core/declare","../../lib/glMatrix"],function(m,h){var d=h.vec2d,c=h.vec3d,a=c.create();return m([],{declaredClass:"esri.views.3d.navigation.mixins.ZoomMixin",type:"zoom",constructor:function(){this.normalizedAnchorPoint=d.create();this._lastStepAnimationId=-1},begin:function(a){this.navigation.begin(this);d.set(a,this._dragBeginPoint);this.normalizeCoordinate(a,this.normalizedAnchorPoint);
a=this._toYDownCoord(this._dragBeginPoint);this.active=!0;this.emit("begin",a[0],a[1])},update:function(a){},end:function(a){this.active=!1;a=this._toYDownCoord(this._dragBeginPoint);this.emit("end",a[0],a[1]);this.navigation.end(this)},stepScreen:function(b,d){this.active||(c.set(this.currentCamera.center,a),0<b&&(this.pickPointInScreen(d,a)||"local"!==this.navigation.view.viewingMode||this.pickFreePointInScreen(d,a)),this.step(Math.pow(.6,b),a,d))},step:function(a,d,f){if(!this.active){this.navigation.begin(this);
this.navigation.currentHasAlmostReachedTarget()||this.navigation.animationId===this._lastStepAnimationId?this.targetCamera.copyFrom(this.currentCamera):this.navigation.stop();var b=1E-6<c.dist(d,this.targetCamera.center);this.stepAtPoint(a,d,f,b);this._lastStepAnimationId=this.navigation.animationId;this.navigation.end(this)}},stepAtPoint:function(a,c,d,g){},_toYDownCoord:function(a){return[a[0],this.currentCamera.height-a[1]]}})})},"esri/views/3d/navigation/spherical/actions/RotateSpherical":function(){define(["./ActionSpherical",
"../../mixins/RotateMixin"],function(m,h){return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.spherical.actions.RotateSpherical"})})},"esri/views/3d/navigation/mixins/RotateMixin":function(){define(["../../../../core/declare","../../lib/glMatrix","../../support/mathUtils","../NavigationConstants"],function(m,h,d,c){var a=h.vec2d,b=h.vec3d,k=h.mat4d,f=b.create(),g=b.create(),e=a.create(),l=k.create(),p=b.create(),v=[3,1.5],q=c.Rotate.PivotPoint;return m([],{declaredClass:"esri.views.3d.navigation.mixins.RotateMixin",
type:"rotate",constructor:function(){this._rotLastPoint=a.create()},begin:function(a,b){void 0===b&&(b=q.POI);this.navigation.begin(this);this.active=!0;this.emit("begin");this.setPoiAuto(a);this.normalizeCoordinate(a,this._rotLastPoint)},update:function(a,b){void 0===b&&(b=q.POI);var c,d;switch(b){case q.EYE:c=this.targetCamera.center;d=this.targetCamera.eye;break;default:c=this.targetCamera.eye,d=this.targetCamera.center,b!==q.POI&&console.error("[RotateMixin.update]: invalid pivot specified")}this._applyRotation(a,
b,c,d);this.constrainTargetEyeByElevation();this.fixTargetUpVector();this.targetAndCurrentChanged();this.emit("update")},_applyRotation:function(c,h,m,x){this.renderCoordsHelper.worldUpAtPosition(x,f);this.normalizeCoordinate(c,e);c=(e[1]-this._rotLastPoint[1])*v[h-1];var n=(e[0]-this._rotLastPoint[0])*v[h-1];b.subtract(m,x,g);var t=b.length(g),u=d.acos(b.dot(g,f)/t);h===q.POI?c=this.limitTiltByConstraints(u+c,x,t)-u:(u=.5*Math.PI-u,t=.495*Math.PI,c=u-Math.max(-t,Math.min(t,u+-.5*c)));k.identity(l);
b.cross(this.targetCamera.up,g,p);h==q.POI&&(n=-n);k.rotate(l,n,f);k.rotate(l,c,p);k.multiplyVec3(l,g);b.add(x,g,m);k.multiplyVec3(l,this.targetCamera.up);a.set(e,this._rotLastPoint)},end:function(a){this.active=!1;this.emit("end");this.navigation.end(this)}})})},"esri/views/3d/navigation/planar/NavigationPlanar":function(){define("../Navigation ./ConstraintsPlanar ./AnimationPlanar ./actions/PanPlanar ./actions/RotatePlanar ./actions/ZoomPlanar ../../webgl-engine/lib/Camera ../../lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k,f){var g=f.vec3d,e=g.create(),l=g.create(),p=g.create(),v=g.create();return m.createSubclass([h,d],{declaredClass:"esri.views.3d.navigation.planar.NavigationPlanar",initialize:function(){this.pan=new c({navigation:this});this.zoom=new b({navigation:this});this.rotate=new a({navigation:this})},getInitialCamera:function(){return new k(g.createFrom(0,0,100),g.createFrom(0,0,0),g.createFrom(0,1,0))},fixTargetUpVector:function(){var a=this.renderCoordsHelper.worldUp,b=this.cameras.target;
g.direction(b.center,b.eye,v);var c=g.dot(v,a);.9999>=Math.abs(c)&&(g.scale(v,c,v),g.subtract(a,v,b.up),g.normalize(b.up))},setPoiAuto:function(a,b){a=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,a);if(a.getMinResult().getIntersectionPoint(e)&&a.getMaxResult().getIntersectionPoint(l)){var c=5/this.renderUnitInMeters;b=a.getMinResult().dist-c;var c=a.getMaxResult().dist+c,d=g.dist(this.cameras.target.eye,this.cameras.target.center);if(d<=b||d>=c){if(a.getMinResult().object){a.getMaxResult().dist=
void 0;a.intersectObject(a.getMinResult().object);if(void 0===a.getMaxResult().dist){console.error("[NavigationPlanar.setPoiAuto] Did not obtain maximum intersection distance");return}a.getMaxResult().getIntersectionPoint(l);g.lerp(e,l,.5,p)}else g.set(e,p);this.setCameraFromEyeAndCenter(this.cameras.target.eye,p,{animate:!1})}}}})})},"esri/views/3d/navigation/planar/ConstraintsPlanar":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../support/RenderCoordsHelper ../../constraints/SceneViewTiltConstraint ../../lib/glMatrix ../../webgl-engine/lib/Util ../../../../geometry/support/scaleUtils".split(" "),
function(m,h,d,c,a,b,k,f){var g=b.vec3d,e=b.vec4d,l=e.create(),p=g.create(),v=g.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.planar.ConstraintsPlanar",defaultConstraints:{tilt:new m.Tilt({min:function(){return h.deg2rad(a.MAX_DEFAULT)},max:h.makePiecewiseLinearFunction([[4E3,h.deg2rad(a.MIN_DEFAULT)],[1E4,h.deg2rad(88)],[6E6,h.deg2rad(88)]])}),altitude:new m.Altitude({min:function(a){return a._autoAltitudeConstraints.min},max:function(a){return a._autoAltitudeConstraints.max}}),
collision:new m.Collision},_updateAutoAltitudeConstraints:function(a){var b=Math.max(a.xmax-a.xmin,a.ymax-a.ymin);a.hasZ&&(b=Math.max(b,a.zmax-a.zmin));b=3*b/Math.atan((this._targetCameraBeforeElevationUpdate||this.targetCamera)._fov/2);a=f.getUnitValueForSR(a.spatialReference);this._autoAltitudeConstraints.min=0;this._autoAltitudeConstraints.max=b*a},limitAltitude:function(a,b,c,d){return this.constraints.altitude.apply(this,a)},limitTiltByAltitudeConstraints:function(a,b,c,d){return a},distanceToSilhouette:function(a,
b,e,f,k){k||(k={maxFarNearRatio:0,distance:0});k.maxFarNearRatio=this.maxFarNearRatio;var l=c.Planar.prototype.getAltitude(a.eye),m=l*=e;f=l-f;var n=this.elevationProvider?this.elevationProvider.getElevationBounds():null;n&&(l=0<=f?m-e*n[0]:e*n[1]-m);m=Math.max(b.xmax-b.xmin,b.ymax-b.ymin,4*Math.max(b.xmax-b.xmin,b.ymax-b.ymin));g.subtract(a.center,a.eye,v);p[0]=0<v[0]?b.xmax:b.xmin;p[1]=0<v[1]?b.ymax:b.ymin;p[2]=0<v[2]?m/2:-m/2;g.subtract(p,a.eye);g.normalize(v);a=1.1*g.dot(p,v)*e;n=l+d.earthRadius;
n=Math.sqrt(n*n-d.earthRadius*d.earthRadius);b=Math.max(b.xmax-b.xmin,b.ymax-b.ymin);var q=1E-4*b*e;e=h.clamp((l-q)/(.001*b*e-q),0,1);k.distance=h.lerp(n,a,e*e*e);k.maxFarNearRatio=2E4;k.distance*=Math.max(Math.log(Math.abs(f)),1);k.distance=Math.min(k.distance,Math.max(34064E4,m));return k},intersectManifold:function(a,b,c,d){var f=this.renderCoordsHelper.worldUp;e.set4(f[0],f[1],f[2],c,l);return!k.rayPlane(a,b,l,d)||0>g.dot(g.subtract(d,a,p),b)?!1:!0},getFallbackCenterAlongViewDirection:function(a,
b,c){g.set(b,c)}})})},"esri/views/3d/navigation/planar/AnimationPlanar":function(){define(["../mixins/AnimationMixin","../../lib/glMatrix","../../support/mathUtils"],function(m,h,d){function c(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];a=b[3]-a[3];return c*c+d*d+e*e+a*a}function a(a,b){return Math.sqrt(c(a,b))}function b(a){this.interpolate=function(a,b,c){c=Math.min(5*c,.3);f.lerp(a.eye,b.eye,c);f.lerp(a.center,b.center,c);f.lerp(a.up,b.up,c);a.fov=d.lerp(a.fov,b.fov,c);a.padding=g.lerp(a.padding,
b.padding,c,e)}}function k(b,c,h){c=c||250;h=h||c;var k=0,l=0,m=0,p=0,v=0,r=function(a,d,e,f,g){return b.easeInOutInterpLinear(h,c,a,d,e,f,g)};this.interpolate=function(b,c,h){k=r(b.eye,c.eye,h,k,f);l=r(b.center,c.center,h,l,f);m=r(b.up,c.up,h,m,f);v=r(b.padding,c.padding,h,v,{dist:a,lerp:function(a,b,c){return g.lerp(a,b,c,e)},set:function(a){b.padding=a}});p=r(b.fov,c.fov,h,p,{dist:function(a,b){return Math.abs(b-a)},lerp:d.lerp,set:function(a){b.fov=a}})}}var f=h.vec3d,g=h.vec4d,e=g.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.planar.AnimationPlanar",
constructor:function(){this.interpolationTypes={linear:b,easeInOut:k}}})})},"esri/views/3d/navigation/planar/actions/PanPlanar":function(){define(["./ActionPlanar","../../mixins/PanMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(m,h,d,c){var a=d.vec2d,b=d.vec3d,k=b.create(),f=b.create(),g=b.create(),e=b.create(),l=b.create(),p=b.create(),v=Math.PI/9,q=b.create(),n=b.create();return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.planar.actions.PanPlanar",begin:function(c){this.inherited(arguments);
this.pickPointInScreen(c,k)||this.pickFreePointInScreen(c,k);b.normalize(b.subtract(this.targetCamera.eye,this.targetCamera.center,f));this.renderCoordsHelper.worldUpAtPosition(c,p);var d=b.dot(f,p);0>d&&(b.negate(f),d=-d);var e=Math.asin(d);e>=v?b.set(p,f):(b.subtract(f,b.scale(p,d,g)),b.normalize(f),e>v&&(b.lerp(f,p,(e-v)/(v-v)),b.normalize(f)));this.updatePlane(k,f);a.set(c,this._dragLastPoint);a.set(c,this._dragBeginPoint)},update:function(c){this._intersectPanPlane(this._dragLastPoint,this._dragBeginPoint,
q)&&this._intersectPanPlane(c,this._dragBeginPoint,n)&&(b.subtract(n,q),b.subtract(this.targetCamera.eye,n),b.subtract(this.targetCamera.center,n),a.set(c,this._dragLastPoint),this.constrainTargetEyeByElevationAndMoveLookAt(),this.targetAndCurrentChanged())},_intersectPanPlane:function(a,d,f){this.createPickRay(a,d,this.currentCamera.viewMatrix,e,l);b.subtract(l,e);return c.rayPlane(e,l,this._plane,f)},end:function(a){this.setPoiAuto(a,!0);this._navSphereRadius=0;this.inherited(arguments)}})})},"esri/views/3d/navigation/planar/actions/ActionPlanar":function(){define(["../../Action",
"../../../lib/glMatrix"],function(m,h){var d=h.vec3d,c=h.vec4d;return m.createSubclass({declaredClass:"esri.views.3d.navigation.planar.actions.ActionPlanar",constructor:function(){this._plane=c.create()},updatePlane:function(a,b){c.set4(b[0],b[1],b[2],-d.dot(b,a),this._plane)}})})},"esri/views/3d/navigation/planar/actions/RotatePlanar":function(){define(["./ActionPlanar","../../mixins/RotateMixin"],function(m,h){return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.planar.actions.RotatePlanar"})})},
"esri/views/3d/navigation/planar/actions/ZoomPlanar":function(){define(["./ActionPlanar","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(m,h,d,c){var a=d.vec2d,b=d.vec3d,k=b.create(),f=b.create(),g=b.create(),e=b.create(),l=b.create(),p=b.create();return m.createSubclass([h],{declaredClass:"esri.views.3d.navigation.planar.actions.ZoomPlanar",begin:function(a){this.inherited(arguments);this.pickPointInScreen(a,l)||this.pickFreePointInScreen(a,l);b.normalize(b.subtract(this.targetCamera.eye,
this.targetCamera.center,e));0>e[1]&&b.negate(e);this.updatePlane(l,e)},update:function(d){b.set(this.targetCamera.center,p);this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,k,f);b.subtract(f,k);c.rayPlane(k,f,this._plane,p);this.normalizeCoordinate(d,k);d=4*(this.normalizedAnchorPoint[1]-k[1]);a.set(k,this.normalizedAnchorPoint);this._applyZoom(p,d);d=this._toYDownCoord(this._dragLastPoint);this.emit("update",d[0],d[1])},_applyZoom:function(a,c){b.subtract(a,
this.targetCamera.eye,g);var d=b.length(g),e=d*(1-c);0<=c&&e<this.minPoiDist&&(e=this.minPoiDist);e=this.limitAltitude(e,a,g,d);1E-6>Math.abs(d-e)||(c=-(e-d)/d,b.scale(g,c),b.add(this.targetCamera.eye,g),b.lerp(this.targetCamera.center,a,c),this.fixTargetUpVector(),this.targetAndCurrentChanged())},stepAtPoint:function(a,c,d,e){b.set(c,p);b.subtract(p,this.targetCamera.eye,g);c=b.length(g);d=c*a;1>=a&&d<this.minPoiDist&&(d=this.minPoiDist);d=this.limitAltitude(d,p,g,c);a=d/c;1E-6<=Math.abs(c-d)&&(b.scale(g,
d/c),b.subtract(p,g,this.targetCamera.eye),b.lerp(this.targetCamera.center,p,1-a),this.constrainTargetEyeByElevation(),this.fixTargetUpVector(),this.targetAnimatedChanged(!1,{internalUpdate:!0}))}})})},"esri/views/3d/support/Frustum":function(){define(["../../../core/declare","../lib/glMatrix","../support/earthUtils","../webgl-engine/lib/Util"],function(m,h,d,c){var a=h.vec3d,b=h.vec4d;return m([],{constructor:function(){this.planes=Array(6);this.points=Array(8);this.lines=Array(12);this.origin=a.create();
this.direction=a.create();this.dirty=!1;this._altitude=null;for(var c=0;6>c;c++)this.planes[c]=b.create();for(c=0;8>c;c++)this.points[c]=a.create();for(c=0;12>c;c++)this.lines[c]={origin:null,direction:a.create(),endpoint:null}},_makeLine:function(b,c,d){b.origin=c;b.endpoint=d;a.direction(d,c,b.direction)},update:function(b){if(this.dirty){c.matrix2frustumPlanes(b.viewMatrix,b.projectionMatrix,this.points,this.planes);for(var d=0;4>d;d++){var g=d,e=d+4;this._makeLine(this.lines[d],this.points[g],
this.points[e]);this._makeLine(this.lines[d+4],this.points[g],3===d?this.points[0]:this.points[g+1]);this._makeLine(this.lines[d+8],this.points[e],3===d?this.points[4]:this.points[e+1])}a.set(b.eye,this.origin);a.set(b.viewForward,this.direction);this._altitude=null;this.dirty=!1}},altitude:function(){return null!=this._altitude?this._altitude:this._altitude=a.length(this.origin)-d.earthRadius}})})},"esri/views/ui/3d/DefaultUI3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),
function(m,h,d,c,a,b,k){m=function(a){function b(){return a.call(this)||this}d(b,a);b.prototype.getDefaults=function(){return k.mixin(this.inherited(arguments),{components:["attribution","zoom","navigation-toggle","compass"]})};return b}(a.declared(b));return m=c([a.subclass("esri.views.ui.3d.DefaultUI3D")],m)})},"esri/layers/graphics/controllers/I3SOnDemandController":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all ../../../views/3d/support/ResourceController ../../../core/sql/WhereClause ../../../views/3d/layers/i3s/I3SNodeLoader ../../../views/3d/layers/i3s/I3SIndexTraversal ../../../views/3d/layers/i3s/I3SUtil ../../../views/3d/layers/i3s/I3SLodHandling ../../../views/3d/layers/i3s/I3SViewportQueries ../../../layers/SceneLayer ../../../layers/IntegratedMeshLayer ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Evented ../../../core/Promise ../../../core/Logger ../../../core/watchUtils ../../../core/HandleRegistry ../../../views/3d/support/PromiseLightweight ../../../views/3d/support/projectionUtils ../../../views/3d/lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D){function E(a,b){b=b.toLowerCase();for(var c=0;c<a.length;c++)if(a[c].name.toLowerCase()===b)return c;return-1}var H=D.vec3d,G=r.getLogger("esri.layers.SceneService");m=function(c){function h(a){var b=c.call(this)||this;b.nodeIndex={};b.screenSizeFactor=0;b.updating=!0;b.updatingPercentage=0;b._lodFactorProperty=null;b._isIdle=!1;b._numNodesLoading=0;b._progressMaxNumNodes=1;b._animFrameFunctionQueue=[[],[]];b._requiredAttributesDirty=!0;b._updatesDisabled=
!1;b._restartNodeLoading=!1;b._handles=new B;b._bundleLoadedCallback=function(a,c,d,e,f,g,h,k){b._lodHandling.lodSwapBundleLoaded(a,c,k);b.layerViewRequiredFunctions.addBundle(a,c,d,e,f,g,h);null!=b.layerViewOptionalFunctions.setPolygonOffset&&(c=b._lodHandling.shouldSetPolygonOffset(a))&&b.layerViewOptionalFunctions.setPolygonOffset(a,c)};return b}d(h,c);Object.defineProperty(h.prototype,"isMeshPyramid",{get:function(){return"mesh-pyramids"===this.layer.profile||"MeshPyramid"===this.layer.store.lodType},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"streamDataSupplier",{get:function(){return this.layerView.view.resourceController.registerClient(this.layerView,b.ClientType.SCENE,{addUrlToken:this.addUrlToken,trackRequests:!0})},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parsedDefinitionExpression",{get:function(){if(this.layer&&this.layer.definitionExpression)try{var a=k.create(this.layer.definitionExpression);if(!a.isStandardized())return G.error("definitionExpression is using non standard function"),
null;var b=[],c=a.getFields();e.findFieldsCaseInsensitive(c,this.layer.fields,b);return 0<b.length?(G.error("definitionExpression references unknown fields: "+b.join(", ")),null):a}catch(M){return G.error("Failed to parse definitionExpression: "+M),null}else return null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"definitionExpressionFields",{get:function(){if(this.parsedDefinitionExpression){var a=this.parsedDefinitionExpression.getFields();return e.findFieldsCaseInsensitive(a,
this.layer.fields)}return null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"crsVertex",{get:function(){return e.getVertexCrs(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"crsIndex",{get:function(){return e.getIndexCrs(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"rootNodeVisible",{get:function(){var a=this._rootNodeId&&this.nodeIndex[this._rootNodeId];return a&&this._viewportQueries?this._viewportQueries.isNodeVisible(a):
!0},enumerable:!0,configurable:!0});h.prototype.initialize=function(){var b=this;this.updateEventListener={needsUpdate:function(){return b._needsAnimationFrameHandler()},idleFrame:function(a){return b._animationFrameHandler(a)},idleBegin:function(){b._startNodeLoading();b._updateIdleState(!0)},idleEnd:function(){b.cancelNodeLoading();b._updateIdleState(!1)}};this.updateEventListenerWhileSuspended={idleBegin:function(){return b._startNodeLoadingWhileSuspended()}};this._lodHandling=new l(this.layerViewRequiredFunctions,
this.layerViewOptionalFunctions,function(){return b._evaluateUpdatingState()});this.layerView._controller=this;var c=this.layer;this._defaultGeometrySchema=c.store.defaultGeometrySchema;this._fields=c.fields;this._attributeStorageInfo=c.attributeStorageInfo;this._rootNodeUrl=c.store.rootNode;c=this._rootNodeUrl.split("/");this._rootNodeId=c[c.length-1];this.layer instanceof v?"mesh"===this.layer.geometryType?this._lodFactorProperty="qualitySettings.sceneService.3dObject.lodFactor":"point"===this.layer.geometryType&&
(this._lodFactorProperty="qualitySettings.sceneService.point.lodFactor"):this.layer instanceof q&&(this._lodFactorProperty="qualitySettings.sceneService.integratedMesh.lodFactor");c=a([this.layer,this.layerView]).then(function(){if(!b.destroyed&&b.layerView&&!b.layerView.destroyed){b.setClippingArea(b.layerView.view.clippingArea);var a=b.layerView.view.resourceController,c=!1;b._handles.add(z.init(b.layerView,"suspended",function(d){c&&a.deregisterIdleFrameWorker(b);d?a.registerIdleFrameWorker(b,
b.updateEventListenerWhileSuspended):a.registerIdleFrameWorker(b,b.updateEventListener);c=!0}),"layerview");b._lodFactorProperty&&b._handles.add(b.layerView.view.watch(b._lodFactorProperty,function(){return b._qualityChanged()}),"quality")}});this.addResolvingPromise(c)};h.prototype.destroy=function(){this.layerView.view.resourceController.deregisterIdleFrameWorker(this);this.layerView.view.resourceController.deregisterClient(this.layerView);this._handles.destroy();this._nodeLoader=null};h.prototype._modifyNumNodesLoading=
function(a){this._numNodesLoading+=a};h.prototype._getRequiredAttributes=function(){if(null==this._attributeStorageInfo||!this._fields)return[];var a=Object.create(null);this.layer.renderer&&this.layer.renderer.collectRequiredFields(a);this.layer.labelsVisible&&this.layer.labelingInfo&&this.layer.labelingInfo.forEach(function(b){b._collectRequiredFields(a)});if(null!=this.definitionExpressionFields)for(var b=0,c=this.definitionExpressionFields;b<c.length;b++)a[c[b]]=!0;var d=this._attributeStorageInfo,
e=this._fields;return Object.keys(a).map(function(a){var b=E(d,a);a=E(e,a);return 0<=b&&0<=a?{index:b,name:e[a].name,field:e[a],attributeStorageInfo:d[b]}:null}).filter(function(a){return null!=a}).sort(function(a,b){return b.index-a.index}).filter(function(a,b,c){return 0===b||c[b-1].index!==a.index})};h.prototype._requiredFieldsChange=function(){this._requiredAttributesDirty=!0;this.restartNodeLoading()};h.prototype._labelingChanged=function(){var a=this._requiredAttributes,b=this._getRequiredAttributes();
a.length===b.length&&a.every(function(a){return 0<=E(b,a.name)})||this._requiredFieldsChange()};h.prototype.setClippingArea=function(a){var b=[];A.extentToBoundingBox(a,b,this.layerView.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null};h.prototype._qualityChanged=function(){this.restartNodeLoading()};h.prototype.updateClippingArea=function(a){this.setClippingArea(a);this.restartNodeLoading()};h.prototype.queueAnimationFrameFunctionCall=function(a,b,c,d,e){null!=this._nodeLoader&&
(this._animFrameFunctionQueue[e||0].push({fct:a,that:b,args:c,cancelFunc:d}),this._evaluateUpdatingState())};h.prototype.getBaseUrl=function(){return e.addTrailingSlash(this.layer.parsedUrl.path)};h.prototype.updateElevationChanged=function(a,b,c){e.findIntersectingNodes(a,b,this.nodeIndex.root,this.crsIndex,this.nodeIndex,c);for(a=0;a<c.length;a++)b=c.data[a],b.computedMbs&&(b.computedMbs[3]=-1);c.length&&this.restartNodeLoading()};h.prototype.restartNodeLoading=function(){this._restartNodeLoading=
!0;this._evaluateUpdatingState()};h.prototype._needsAnimationFrameHandler=function(){return!0};h.prototype._animationFrameHandler=function(a){this._restartNodeLoading&&(this.cancelNodeLoading(),this._startNodeLoading());if(null!=this._nodeLoader){for(var b;0<this._animFrameFunctionQueue[0].length&&!a.done();)b=this._animFrameFunctionQueue[0].shift(),b.fct.apply(b.that,b.args);b=5-this._numNodesLoading;for(null!=this._indexLoader&&0<b&&this._indexLoader.continueTraversal(b);0<this._animFrameFunctionQueue[1].length&&
!a.done();)b=this._animFrameFunctionQueue[1].shift(),b.fct.apply(b.that,b.args);this._evaluateUpdatingState();this._lodHandling.lodGlobalHandling()}};h.prototype._evaluateUpdatingState=function(){var a=null!=this._indexLoader?this._indexLoader.getQueueSize()+3*this._numNodesLoading:0,b=!(!(0<a||this._indexLoader&&this._indexLoader.isLoading()||this._nodeLoader&&this._nodeLoader.isLoadingAttributes||this._restartNodeLoading||0<this._animFrameFunctionQueue[0].length||0<this._animFrameFunctionQueue[1].length||
this._lodHandling&&this._lodHandling.requiresLODGlobalHandling)&&this._isIdle);0===a&&(this._progressMaxNumNodes=1);this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);b!==this._get("updating")&&this._set("updating",b);a=100*a/this._progressMaxNumNodes;a!==this._get("updatingPercentage")&&this._set("updatingPercentage",a)};h.prototype._initViewData=function(){var a=this.layerView.view,b=a.navigation.targetCamera,c=a.renderCoordsHelper;this.camPos=b.eye;this.screenSizeFactor=1/b.perPixelRatio;
this._poi=H.create();var d=H.create(),e=H.create();H.subtract(b.center,b.eye,d);H.normalize(d);c.worldUpAtPosition(b.center,e);d=Math.acos(H.dot(e,d))-.5*Math.PI;H.lerp(b.eye,b.center,Math.max(0,Math.min(1,d/(.5*Math.PI))),this._poi);d=this._lodFactorProperty&&this.layerView.view.get(this._lodFactorProperty)||1;e=this.layerViewOptionalFunctions.traversalOptions.elevationInfo;this._viewportQueries=new p(this.crsIndex,c,b,this._clippingArea,null!=this.layerViewOptionalFunctions.traversalOptions?this.layerViewOptionalFunctions.traversalOptions.errorMetricPreference:
null,e?a.elevationProvider:null,e,{screenspaceErrorBias:d,maxDistance:25E7,angleDependentLoD:.5>d});this.notifyChange("rootNodeVisible")};h.prototype._startNodeLoadingWhileSuspended=function(){var a=this;this._initViewData();this._removeInvisibleNodes(function(b){return a._viewportQueries.isNodeVisible(b)})};h.prototype._startNodeLoading=function(){var a=this;this._restartNodeLoading=!1;if(!this._updatesDisabled&&null!=this.streamDataSupplier){this._initViewData();var b=null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions?
this.layerViewOptionalFunctions.getTexturePrefetchFunctions():void 0,c=this.isMeshPyramid&&null!=this._defaultGeometrySchema&&null!=this._defaultGeometrySchema.ordering;null!=this.layerViewOptionalFunctions.getLoadedAttributes&&this._requiredAttributesDirty&&(this._requiredAttributes=this._getRequiredAttributes(),this._requiredAttributesDirty=!1,this._handles.add([this.layer.watch("renderer",function(){return a._requiredFieldsChange()}),this.layer.watch("definitionExpression",function(){return a._requiredFieldsChange()}),
this.layer.watch("labelsVisible",function(){return a._labelingChanged()}),this.layer.watch("labelingInfo",function(){return a._labelingChanged()})],"requiredAttributes"));this._nodeLoader=new f(this.streamDataSupplier,this._bundleLoadedCallback,this.queueAnimationFrameFunctionCall.bind(this),void 0,this.layerView.view.renderCoordsHelper,this.crsIndex,b?b._calcDesiredTextureLOD:void 0,b?b._imageIsPartOfTextureBundle:void 0,b?b._matId2Meta:void 0,b?b._texId2Meta:void 0,b?b.useCompressedTextures:void 0,
G,this._defaultGeometrySchema,this._requiredAttributes,c);this._indexLoader=new g(this.getBaseUrl(),this._rootNodeUrl,this._rootNodeId,this._poi,this.nodeIndex,this.streamDataSupplier,this._viewportQueries,function(b,c){return a._processNodeIndexDocument(b,c)},function(b){return a._lodHandling.finishedLevel(b)},this.layerViewOptionalFunctions._nodeDebugVisualizer,G,this.layerViewOptionalFunctions.traversalOptions);this._indexLoader.start();b=this._removeInvisibleNodes(function(b){return a._indexLoader.nodeIsVisible(b)});
c=null!=this.layerViewOptionalFunctions.traversalOptions&&!0===this.layerViewOptionalFunctions.traversalOptions.perLevelTraversal?"perLevel":this.isMeshPyramid?"global":"swap";this._lodHandling.startNodeLoading(this._indexLoader.nodeIsVisible.bind(this._indexLoader),this._indexLoader.nodeTraversalState.bind(this._indexLoader),c,this.nodeIndex,b,this._rootNodeId);this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler();this._evaluateUpdatingState()}};
h.prototype.isNodeLoading=function(){return null!=this._nodeLoader&&null!=this._indexLoader};h.prototype.cancelNodeLoading=function(){if(this.isNodeLoading()){this._indexLoader.cancel();this._nodeLoader.cancel();this.streamDataSupplier.cancelAll();for(var a=0;a<this._animFrameFunctionQueue.length;a++)for(var b=0;b<this._animFrameFunctionQueue[a].length;b++)void 0!==this._animFrameFunctionQueue[a][b].cancelFunc&&this._animFrameFunctionQueue[a][b].cancelFunc();this._numNodesLoading=0;this._animFrameFunctionQueue=
[[],[]];this._indexLoader=this._nodeLoader=void 0;this._lodHandling.cancelNodeLoading();this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler();this._evaluateUpdatingState()}};h.prototype._removeInvisibleNodes=function(a){for(var b={},c=this.layerViewRequiredFunctions.getAddedNodeIDs(),d=0;d<c.length;d++){var e=c[d],f=this.nodeIndex[e];this._isNodeVisibleWithParents(f,a)?b[e]=f:this._removeNodeData(f)}return b};h.prototype._isNodeVisibleWithParents=
function(a,b){var c=a;do a=b(c),c=c.parentNode,c=null!=c?this.nodeIndex[c.id]:null;while(a&&null!=c);return a};h.prototype._removeNodeData=function(a){this._lodHandling.setLodGlobalDirty();this.layerViewRequiredFunctions.removeNodeData(a)};h.prototype._processNodeIndexDocument=function(a,b){var c=this,d=new C.Promise;if(null!=a.featureData&&0<a.featureData.length)if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a)){var e=this.layerViewOptionalFunctions.getLoadedAttributes,e=null!=e?e(a):void 0;
null!=e&&e!==this._requiredAttributes&&(this._nodeLoader.loadAttributes(a,a.baseUrl,this._requiredAttributes).then(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,b)}).catch(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,{})}).then(function(){c._evaluateUpdatingState()}),this._evaluateUpdatingState());this._lodHandling.shouldLoadNode(a,b)&&(b=this._lodHandling.lodSwapBuildInfoForNode(a))&&null==b.swapPairs&&this._lodHandling.lodSwapBundleLoaded(a,
null,b)}else if(this._lodHandling.shouldLoadNode(a,b)){b=this._lodHandling.lodSwapBuildInfoForNode(a);if(this.layerViewRequiredFunctions.isOverMemory())return d.done(),d;this._modifyNumNodesLoading(1);for(var e=[],f=0;f<a.featureData.length;f++)this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(a,f)||e.push(f);this.queueAnimationFrameFunctionCall(this._nodeLoader.loadNodeData,this._nodeLoader,[a,e,d,null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions,b],void 0,1);d.then(function(){return c._modifyNumNodesLoading(-1)},
function(){return c._modifyNumNodesLoading(-1)});return d}d.done();return d};h.prototype._updateIdleState=function(a){a!==this._isIdle&&(this._isIdle=a,this._evaluateUpdatingState())};return h}(n.declared(t,x,u));c([n.property({readOnly:!0})],m.prototype,"isMeshPyramid",null);c([n.property({readOnly:!0})],m.prototype,"streamDataSupplier",null);c([n.property({readOnly:!0,dependsOn:["layer.definitionExpression"]})],m.prototype,"parsedDefinitionExpression",null);c([n.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],
m.prototype,"definitionExpressionFields",null);c([n.property({readOnly:!0})],m.prototype,"crsVertex",null);c([n.property({readOnly:!0})],m.prototype,"crsIndex",null);c([n.property({readOnly:!0})],m.prototype,"nodeIndex",void 0);c([n.property()],m.prototype,"camPos",void 0);c([n.property()],m.prototype,"screenSizeFactor",void 0);c([n.property()],m.prototype,"layerView",void 0);c([n.property()],m.prototype,"layerViewRequiredFunctions",void 0);c([n.property()],m.prototype,"layerViewOptionalFunctions",
void 0);c([n.property()],m.prototype,"layer",void 0);c([n.property()],m.prototype,"addUrlToken",void 0);c([n.property({readOnly:!0})],m.prototype,"updating",void 0);c([n.property({readOnly:!0})],m.prototype,"updatingPercentage",void 0);c([n.property({readOnly:!0})],m.prototype,"rootNodeVisible",null);return m=c([n.subclass("esri.layers.graphics.controllers.I3SOnDemandController")],m)})},"esri/core/sql/WhereClause":function(){define(["require","exports","./WhereGrammar","../../moment","./StandardizedFunctions"],
function(m,h,d,c,a){function b(a){return Array.isArray(a)?a:[a]}function k(a){return null!==a?!0!==a:null}function f(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var e=b[d];if(null==e)c=null;else if(a===e){c=!0;break}}return c}function g(a,b,c){if(null==a)return null;for(var d="",e=0,f=0;f<b.length;f++){var g=b.charAt(f);switch(e){case 0:g===c?e=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):"%"===g?d+".*":"_"===g?d+".":d+g;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+
g):d+g,e=0}}return(new RegExp("^"+d+"$")).test(a)}function e(a){return a instanceof Date?a.valueOf():a}function l(a,b,c){if(null==b||null==c)return null;b=e(b);c=e(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function p(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e.toLowerCase();void 0===c[f]&&(b.push(e),c[f]=1)}return b}return function(){function h(){this.parameters=
this.parseTree=null}h.create=function(a){var b=new h;b.parseTree=d.WhereGrammar.parse(a);return b};h.prototype.isStandardized=function(){var b=!0;this.visitAll(this.parseTree,function(c){b&&"function"===c.type&&(b=a.isStandardized(c.name,c.args.value.length))});return b};h.prototype.setVariablesDictionary=function(a){this.parameters=a};h.prototype.testFeature=function(a){return!!this.evaluateNode(this.parseTree,a)};h.prototype.calculateValue=function(a){return this.evaluateNode(this.parseTree,a)};
h.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return p(a)};h.prototype.getFields=function(){var a=[];this.visitAll(this.parseTree,function(b){"column_ref"===b.type&&a.push(b.column)});return p(a)};h.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return p(a)};h.prototype.featureValue=function(a,b,c){var d=a.attributes[b];
if(void 0!==d)return d;for(var e in a.attributes)if(b.toLowerCase()===e.toLowerCase())return c.column=e,a.attributes[e];return null};h.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.visitAll(e,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=
a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};h.prototype.evaluateNode=function(d,h){switch(d.type){case "case_expression":if("simple"===d.format)for(var m=e(this.evaluateNode(d.operand,h)),p=0;p<d.clauses.length;p++){if(m===e(this.evaluateNode(d.clauses[p].operand,h)))return this.evaluateNode(d.clauses[p].value,h)}else for(p=0;p<d.clauses.length;p++)if(!0===
this.evaluateNode(d.clauses[p].operand,h))return this.evaluateNode(d.clauses[p].value,h);return null!==d.else?this.evaluateNode(d.else,h):null;case "param":return this.parameters[d.value.toLowerCase()];case "expr_list":m=[];p=0;for(d=d.value;p<d.length;p++){var n=d[p];m.push(this.evaluateNode(n,h))}return m;case "unary_expr":return k(this.evaluateNode(d.expr,h));case "binary_expr":switch(d.operator){case "AND":return m=this.evaluateNode(d.left,h),h=this.evaluateNode(d.right,h),null!=m&&null!=h?!0===
m&&!0===h:!1===m||!1===h?!1:null;case "OR":return m=this.evaluateNode(d.left,h),h=this.evaluateNode(d.right,h),null!=m&&null!=h?!0===m||!0===h:!0===m||!0===h?!0:null;case "IS":if("null"!==d.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(d.left,h);case "ISNOT":if("null"!==d.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(d.left,h);case "IN":return m=b(this.evaluateNode(d.right,h)),f(this.evaluateNode(d.left,h),m);case "NOT IN":return m=
b(this.evaluateNode(d.right,h)),k(f(this.evaluateNode(d.left,h),m));case "BETWEEN":return m=this.evaluateNode(d.left,h),h=this.evaluateNode(d.right,h),null==m||null==h[0]||null==h[1]?null:m>=h[0]&&m<=h[1];case "NOTBETWEEN":return m=this.evaluateNode(d.left,h),h=this.evaluateNode(d.right,h),null==m||null==h[0]||null==h[1]?null:m<h[0]||m>h[1];case "LIKE":return g(this.evaluateNode(d.left,h),this.evaluateNode(d.right,h),d.escape);case "NOT LIKE":return k(g(this.evaluateNode(d.left,h),this.evaluateNode(d.right,
h),d.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return l(d.operator,this.evaluateNode(d.left,h),this.evaluateNode(d.right,h));case "*":return this.evaluateNode(d.left,h)*this.evaluateNode(d.right,h);case "-":return this.evaluateNode(d.left,h)-this.evaluateNode(d.right,h);case "+":return this.evaluateNode(d.left,h)+this.evaluateNode(d.right,h);case "/":return this.evaluateNode(d.left,h)/this.evaluateNode(d.right,h)}throw Error("Not Supported Operator "+
d.operator);case "null":case "bool":case "string":case "number":return d.value;case "date":return c(d.value,["YYYY-M-D"]).toDate();case "timestamp":return c(d.value,["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate();case "column_ref":return"CURRENT_DATE"===d.column.toUpperCase()?(n=new Date,n.setHours(0,0,0,0),n):"CURRENT_TIMESTAMP"===d.column.toUpperCase()?new Date:this.featureValue(h,d.column,d);case "function":return h=this.evaluateNode(d.args,h),a.evaluateFunction(d.name,
h)}throw Error("Unsupported sql syntax "+d.type);};return h}()})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function c(){}c.parse=function(a){return d.parse(a)};return c}();h.WhereGrammar=m})},"esri/core/sql/sql92grammar":function(){define([],function(){function m(h,d,c,a){this.message=h;this.expected=d;this.found=c;this.location=a;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&
Error.captureStackTrace(this,m)}(function(h,d){function c(){this.constructor=h}c.prototype=d.prototype;h.prototype=new c})(m,Error);m.buildMessage=function(h,d){function c(a){return a.charCodeAt(0).toString(16).toUpperCase()}function a(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}function b(a){return a.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}var k={literal:function(b){return'"'+a(b.text)+'"'},"class":function(a){var c="",d;for(d=0;d<a.parts.length;d++)c+=a.parts[d]instanceof Array?b(a.parts[d][0])+"-"+b(a.parts[d][1]):b(a.parts[d]);return"["+(a.inverted?"^":"")+c+"]"},
any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var d=c,f;f=a[c];f=k[f.type](f);b[d]=f}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(h)+" but "+(d?'"'+a(d)+'"':"end of input")+" found."};
return{SyntaxError:m,parse:function(h,d){function c(a,b){return{type:"literal",text:a,ignoreCase:b}}function a(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function b(a){var b=fb[a],c;if(!b){for(c=a-1;!fb[c];)c--;b=fb[c];for(b={line:b.line,column:b.column};c<a;)10===h.charCodeAt(c)?(b.line++,b.column=1):b.column++,c++;fb[a]=b}return b}function k(a,c){var d=b(a),e=b(c);return{start:{offset:a,line:d.line,column:d.column},end:{offset:c,line:e.line,column:e.column}}}function f(a){y<Ha||
(y>Ha&&(Ha=y,rb=[]),rb.push(a))}function g(){var a,b,c;a=y;b=Q();b!==w?(b=l(),b!==w?(c=Q(),c!==w?a=b:(y=a,a=w)):(y=a,a=w)):(y=a,a=w);return a}function e(){var a,b,c,d,e,f,g,h;a=y;b=l();if(b!==w){c=[];d=y;e=Q();e!==w?(f=la(),f!==w?(g=Q(),g!==w?(h=l(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);for(;d!==w;)c.push(d),d=y,e=Q(),e!==w?(f=la(),f!==w?(g=Q(),g!==w?(h=l(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);if(c!==w){a={type:"expr_list"};b=[b];for(d=0;d<c.length;d++)b.push(c[d][3]);
a.value=b}else y=a,a=w}else y=a,a=w;return a}function l(){var a,b,c,d,e,f,g,h;a=y;b=p();if(b!==w){c=[];d=y;e=Q();e!==w?(f=S(),f!==w?(g=Q(),g!==w?(h=p(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);for(;d!==w;)c.push(d),d=y,e=Q(),e!==w?(f=S(),f!==w?(g=Q(),g!==w?(h=p(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);c!==w?a=b=ya(b,c):(y=a,a=w)}else y=a,a=w;return a}function p(){var a,b,c,d,e,f,g,h;a=y;b=v();if(b!==w){c=[];d=y;e=Q();e!==w?(f=Y(),f!==w?(g=Q(),g!==w?(h=
v(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);for(;d!==w;)c.push(d),d=y,e=Q(),e!==w?(f=Y(),f!==w?(g=Q(),g!==w?(h=v(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);c!==w?a=b=ya(b,c):(y=a,a=w)}else y=a,a=w;return a}function v(){var a,b,c,d,g;a=y;b=U();b===w&&(b=y,33===h.charCodeAt(y)?(c=oa,y++):(c=w,0===O&&f(Ba)),c!==w?(d=y,O++,61===h.charCodeAt(y)?(g=wa,y++):(g=w,0===O&&f(sa)),O--,g===w?d=void 0:(y=d,d=w),d!==w?b=c=[c,d]:(y=b,b=w)):(y=b,b=w));b!==w?(c=Q(),c!==
w?(d=v(),d!==w?a=b={type:"unary_expr",operator:"NOT",expr:d}:(y=a,a=w)):(y=a,a=w)):(y=a,a=w);if(a===w)if(a=y,b=u(),b!==w)if(c=Q(),c!==w){var k,l,m;c=[];d=y;g=Q();g!==w?(k=q(),k!==w?(l=Q(),l!==w?(m=u(),m!==w?d=g=[g,k,l,m]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);if(d!==w)for(;d!==w;)c.push(d),d=y,g=Q(),g!==w?(k=q(),k!==w?(l=Q(),l!==w?(m=u(),m!==w?d=g=[g,k,l,m]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);else c=w;c!==w&&(c={type:"arithmetic",tail:c});c===w&&(c=y,d=t(),d!==w?(g=Q(),g!==w?(g=ja(),g!==
w?(g=Q(),g!==w?(g=e(),g!==w?(k=Q(),k!==w?(k=ka(),k!==w?c=d={op:d,right:g}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w),c===w&&(c=y,d=t(),d!==w?(g=Q(),g!==w?(g=ja(),g!==w?(g=Q(),g!==w?(g=ka(),g!==w?c=d={op:d,right:{type:"expr_list",value:[]}}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w),c===w&&(c=y,d=t(),d!==w?(g=Q(),g!==w?(g=H(),g!==w?c=d={op:d,right:g}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w))),c===w&&(c=y,g=U(),g!==w?(d=Q(),d!==w?(d=ca(),d!==w?(k=Q(),k!==w?(k=u(),
k!==w?(l=Q(),l!==w?(l=Y(),l!==w?(g=Q(),g!==w?(g=u(),g!==w?c=g={op:"NOT"+d,right:{type:"expr_list",value:[k,g]}}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w),c===w&&(c=y,g=ca(),g!==w?(d=Q(),d!==w?(d=u(),d!==w?(k=Q(),k!==w?(k=Y(),k!==w?(l=Q(),l!==w?(l=u(),l!==w?c=g={op:g,right:{type:"expr_list",value:[d,l]}}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)),c===w&&(c=y,d=P(),d!==w?(g=Q(),g!==w?(g=U(),g!==w?(g=Q(),g!==w?
(g=u(),g!==w?c=d={op:d+"NOT",right:g}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w),c===w&&(c=y,d=P(),d!==w?(g=Q(),g!==w?(g=u(),g!==w?c=d={op:d,right:g}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w)),c===w&&(c=y,d=n(),d!==w?(g=Q(),g!==w?(g=J(),g!==w?(k=Q(),k!==w?(k=y,h.substr(y,6).toLowerCase()===ed?(l=h.substr(y,6),y+=6):(l=w,0===O&&f(fd)),l!==w?(l=y,O++,m=D(),O--,m===w?l=void 0:(y=l,l=w),l!==w?k="ESCAPE":(y=k,k=w)):(y=k,k=w),k!==w?(k=Q(),k!==w?(k=I(),k!==w?c=d={op:d,right:g,escape:k.value}:(y=c,c=w)):
(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w)):(y=c,c=w),c===w&&(c=y,d=n(),d!==w?(g=Q(),g!==w?(g=J(),g!==w?c=d={op:d,right:g,escape:""}:(y=c,c=w)):(y=c,c=w)):(y=c,c=w))))));c===w&&(c=null);c!==w?(a=b,b=c,""==b||void 0==b||null==b?b=a:(c=null,b=c="arithmetic"==b.type?ya(a,b.tail):na(b.op,a,b.right,b.escape)),a=b):(y=a,a=w)}else y=a,a=w;else y=a,a=w;return a}function q(){var a;h.substr(y,2)===Z?(a=Z,y+=2):(a=w,0===O&&f(Aa));a===w&&(62===h.charCodeAt(y)?(a=ta,y++):(a=w,0===O&&f(Fa)),a===w&&(h.substr(y,
2)===za?(a=za,y+=2):(a=w,0===O&&f(Ya)),a===w&&(h.substr(y,2)===Ia?(a=Ia,y+=2):(a=w,0===O&&f(Ca)),a===w&&(60===h.charCodeAt(y)?(a=Ua,y++):(a=w,0===O&&f(Ra)),a===w&&(61===h.charCodeAt(y)?(a=wa,y++):(a=w,0===O&&f(sa)),a===w&&(h.substr(y,2)===pa?(a=pa,y+=2):(a=w,0===O&&f(Ga))))))));return a}function n(){var a,b,c,d;a=a=y;b=U();b!==w?(c=Q(),c!==w?(d=W(),d!==w?a=b=[b,c,d]:(y=a,a=w)):(y=a,a=w)):(y=a,a=w);a!==w&&(a=a[0]+" "+a[2]);a===w&&(a=W());return a}function t(){var a,b,c,d;a=a=y;b=U();b!==w?(c=Q(),c!==
w?(d=V(),d!==w?a=b=[b,c,d]:(y=a,a=w)):(y=a,a=w)):(y=a,a=w);a!==w&&(a=a[0]+" "+a[2]);a===w&&(a=V());return a}function u(){var a,b,c,d,e,f,g,h;a=y;b=r();if(b!==w){c=[];d=y;e=Q();e!==w?(f=x(),f!==w?(g=Q(),g!==w?(h=r(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);for(;d!==w;)c.push(d),d=y,e=Q(),e!==w?(f=x(),f!==w?(g=Q(),g!==w?(h=r(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);c!==w?a=b=ya(b,c):(y=a,a=w)}else y=a,a=w;return a}function x(){var a;43===h.charCodeAt(y)?
(a=Pa,y++):(a=w,0===O&&f(Qa));a===w&&(45===h.charCodeAt(y)?(a=Za,y++):(a=w,0===O&&f(Sa)));return a}function r(){var a,b,c,d,e,f,g,h;a=y;b=B();if(b!==w){c=[];d=y;e=Q();e!==w?(f=z(),f!==w?(g=Q(),g!==w?(h=B(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);for(;d!==w;)c.push(d),d=y,e=Q(),e!==w?(f=z(),f!==w?(g=Q(),g!==w?(h=B(),h!==w?d=e=[e,f,g,h]:(y=d,d=w)):(y=d,d=w)):(y=d,d=w)):(y=d,d=w);c!==w?a=b=ya(b,c):(y=a,a=w)}else y=a,a=w;return a}function z(){var a;42===h.charCodeAt(y)?(a=Ja,y++):
(a=w,0===O&&f(Va));a===w&&(47===h.charCodeAt(y)?(a=bb,y++):(a=w,0===O&&f(cb)));return a}function B(){var a,b,c,d,g,k,m;m=I();if(m===w){var p,n,t,r;p=y;var q,u,v,x;q=y;u=M();u!==w?(v=K(),v!==w?(x=ba(),x!==w?q=u=parseFloat(u+v+x):(y=q,q=w)):(y=q,q=w)):(y=q,q=w);q===w&&(q=y,u=M(),u!==w?(v=K(),v!==w?q=u=parseFloat(u+v):(y=q,q=w)):(y=q,q=w),q===w&&(q=y,u=M(),u!==w?(v=ba(),v!==w?q=u=parseFloat(u+v):(y=q,q=w)):(y=q,q=w),q===w&&(q=y,u=M(),u!==w&&(u=parseFloat(u)),q=u)));n=q;n!==w?(t=y,O++,r=A(),O--,r===w?
t=void 0:(y=t,t=w),t!==w?p=n={type:"number",value:n}:(y=p,p=w)):(y=p,p=w);m=p;if(m===w){var z,B;z=y;var za,S,T,Ya;za=y;h.substr(y,4).toLowerCase()===gd?(S=h.substr(y,4),y+=4):(S=w,0===O&&f(hd));S!==w?(T=y,O++,Ya=D(),O--,Ya===w?T=void 0:(y=T,T=w),T!==w?za=S=[S,T]:(y=za,za=w)):(y=za,za=w);B=za;B!==w&&(B={type:"bool",value:!0});z=B;if(z===w){z=y;var va,na,ca,P;va=y;h.substr(y,5).toLowerCase()===id?(na=h.substr(y,5),y+=5):(na=w,0===O&&f(jd));na!==w?(ca=y,O++,P=D(),O--,P===w?ca=void 0:(y=ca,ca=w),ca!==
w?va=na=[na,ca]:(y=va,va=w)):(y=va,va=w);B=va;B!==w&&(B={type:"bool",value:!1});z=B}m=z;if(m===w){var la,X,Ia,ia,ya;X=y;h.substr(y,4).toLowerCase()===kd?(Ia=h.substr(y,4),y+=4):(Ia=w,0===O&&f(ld));Ia!==w?(ia=y,O++,ya=D(),O--,ya===w?ia=void 0:(y=ia,ia=w),ia!==w?X=Ia=[Ia,ia]:(y=X,X=w)):(y=X,X=w);la=X;la!==w&&(la={type:"null",value:null});m=la;if(m===w){var W,U,Z,da;W=y;var Y,fa,oa,ra;Y=y;h.substr(y,4).toLowerCase()===md?(fa=h.substr(y,4),y+=4):(fa=w,0===O&&f(nd));fa!==w?(oa=y,O++,ra=D(),O--,ra===w?
oa=void 0:(y=oa,oa=w),oa!==w?Y=fa="DATE":(y=Y,Y=w)):(y=Y,Y=w);U=Y;U!==w?(Z=Q(),Z!==w?(da=J(),da!==w?W=U={type:"date",value:da.value}:(y=W,W=w)):(y=W,W=w)):(y=W,W=w);m=W;if(m===w){var Ca,Ua,Ba,wa;Ca=y;var ta,Ra,Aa,sa;ta=y;h.substr(y,9).toLowerCase()===od?(Ra=h.substr(y,9),y+=9):(Ra=w,0===O&&f(pd));Ra!==w?(Aa=y,O++,sa=D(),O--,sa===w?Aa=void 0:(y=Aa,Aa=w),Aa!==w?ta=Ra="TIMESTAMP":(y=ta,ta=w)):(y=ta,ta=w);Ua=ta;Ua!==w?(Ba=Q(),Ba!==w?(wa=J(),wa!==w?Ca=Ua={type:"timestamp",value:wa.value}:(y=Ca,Ca=w)):
(y=Ca,Ca=w)):(y=Ca,Ca=w);m=Ca}}}}}a=m;if(a===w){var pa,Qa,Ga,Fa,Pa,Sa,cb,db,Za,zb,bb,Ha;pa=y;var Ja,Va,eb,Vb;Ja=y;h.substr(y,7).toLowerCase()===qd?(Va=h.substr(y,7),y+=7):(Va=w,0===O&&f(rd));Va!==w?(eb=y,O++,Vb=D(),O--,Vb===w?eb=void 0:(y=eb,eb=w),eb!==w?Ja=Va="EXTRACT":(y=Ja,Ja=w)):(y=Ja,Ja=w);Qa=Ja;if(Qa!==w)if(Ga=Q(),Ga!==w)if(Fa=ja(),Fa!==w)if(Pa=Q(),Pa!==w){var Ka,gb,qb,Gb,Wb;gb=y;h.substr(y,4).toLowerCase()===sd?(qb=h.substr(y,4),y+=4):(qb=w,0===O&&f(td));qb!==w?(Gb=y,O++,Wb=D(),O--,Wb===w?
Gb=void 0:(y=Gb,Gb=w),Gb!==w?gb=qb="YEAR":(y=gb,gb=w)):(y=gb,gb=w);Ka=gb;if(Ka===w){var hb,Wa,Hb,fb;hb=y;h.substr(y,5).toLowerCase()===ud?(Wa=h.substr(y,5),y+=5):(Wa=w,0===O&&f(vd));Wa!==w?(Hb=y,O++,fb=D(),O--,fb===w?Hb=void 0:(y=Hb,Hb=w),Hb!==w?hb=Wa="MONTH":(y=hb,hb=w)):(y=hb,hb=w);Ka=hb;if(Ka===w){var ib,Xa,Ib,Ub;ib=y;h.substr(y,3).toLowerCase()===wd?(Xa=h.substr(y,3),y+=3):(Xa=w,0===O&&f(xd));Xa!==w?(Ib=y,O++,Ub=D(),O--,Ub===w?Ib=void 0:(y=Ib,Ib=w),Ib!==w?ib=Xa="DAY":(y=ib,ib=w)):(y=ib,ib=w);
Ka=ib;if(Ka===w){var jb,Yb,Jb,Xb;jb=y;h.substr(y,4).toLowerCase()===yd?(Yb=h.substr(y,4),y+=4):(Yb=w,0===O&&f(zd));Yb!==w?(Jb=y,O++,Xb=D(),O--,Xb===w?Jb=void 0:(y=Jb,Jb=w),Jb!==w?jb=Yb="HOUR":(y=jb,jb=w)):(y=jb,jb=w);Ka=jb;if(Ka===w){var kb,Zb,Kb,rb;kb=y;h.substr(y,6).toLowerCase()===Ad?(Zb=h.substr(y,6),y+=6):(Zb=w,0===O&&f(Bd));Zb!==w?(Kb=y,O++,rb=D(),O--,rb===w?Kb=void 0:(y=Kb,Kb=w),Kb!==w?kb=Zb="MINUTE":(y=kb,kb=w)):(y=kb,kb=w);Ka=kb;if(Ka===w){var lb,$b,Lb,Ab;lb=y;h.substr(y,6).toLowerCase()===
Cd?($b=h.substr(y,6),y+=6):($b=w,0===O&&f(Dd));$b!==w?(Lb=y,O++,Ab=D(),O--,Ab===w?Lb=void 0:(y=Lb,Lb=w),Lb!==w?lb=$b="SECOND":(y=lb,lb=w)):(y=lb,lb=w);Ka=lb}}}}}Sa=Ka;Sa!==w?(cb=Q(),cb!==w?(db=ga(),db!==w?(Za=Q(),Za!==w?(zb=l(),zb!==w?(bb=Q(),bb!==w?(Ha=ka(),Ha!==w?pa=Qa={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:Sa},zb]}}:(y=pa,pa=w)):(y=pa,pa=w)):(y=pa,pa=w)):(y=pa,pa=w)):(y=pa,pa=w)):(y=pa,pa=w)):(y=pa,pa=w)}else y=pa,pa=w;else y=pa,pa=w;else y=pa,pa=w;else y=
pa,pa=w;a=pa;if(a===w){var ua,sc,Bb,Cb,Db,ac,Eb,Fb,Bc,bc,Cc,Ea,sb,tc,uc,vc;ua=y;var mb,cc,Mb,Dc;mb=y;h.substr(y,9).toLowerCase()===Ed?(cc=h.substr(y,9),y+=9):(cc=w,0===O&&f(Fd));cc!==w?(Mb=y,O++,Dc=D(),O--,Dc===w?Mb=void 0:(y=Mb,Mb=w),Mb!==w?mb=cc="SUBSTRING":(y=mb,mb=w)):(y=mb,mb=w);sc=mb;if(sc!==w)if(Bb=Q(),Bb!==w)if(Cb=ja(),Cb!==w)if(Db=Q(),Db!==w)if(ac=l(),ac!==w)if(Eb=Q(),Eb!==w)if(Fb=ga(),Fb!==w)if(Bc=Q(),Bc!==w)if(bc=l(),bc!==w)if(Cc=Q(),Cc!==w){Ea=y;var nb,dc,Nb,Ec;nb=y;h.substr(y,3).toLowerCase()===
Gd?(dc=h.substr(y,3),y+=3):(dc=w,0===O&&f(Hd));dc!==w?(Nb=y,O++,Ec=D(),O--,Ec===w?Nb=void 0:(y=Nb,Nb=w),Nb!==w?nb=dc="FOR":(y=nb,nb=w)):(y=nb,nb=w);sb=nb;sb!==w?(tc=Q(),tc!==w?(uc=l(),uc!==w?(vc=Q(),vc!==w?Ea=sb=[sb,tc,uc,vc]:(y=Ea,Ea=w)):(y=Ea,Ea=w)):(y=Ea,Ea=w)):(y=Ea,Ea=w);Ea===w&&(Ea=null);Ea!==w?(sb=ka(),sb!==w?ua=sc={type:"function",name:"substring",args:{type:"expr_list",value:Ea?[ac,bc,Ea[2]]:[ac,bc]}}:(y=ua,ua=w)):(y=ua,ua=w)}else y=ua,ua=w;else y=ua,ua=w;else y=ua,ua=w;else y=ua,ua=w;else y=
ua,ua=w;else y=ua,ua=w;else y=ua,ua=w;else y=ua,ua=w;else y=ua,ua=w;else y=ua,ua=w;a=ua;if(a===w){var ha,tb,ec,fc,gc,La,hc,ub,ic,jc,Fc,wc,Gc,Hc;ha=y;tb=ea();tb!==w?(ec=Q(),ec!==w?(fc=ja(),fc!==w?(gc=Q(),gc!==w?(La=G(),La===w&&(La=null),La!==w?(hc=Q(),hc!==w?(ub=l(),ub!==w?(ic=Q(),ic!==w?(jc=ga(),jc!==w?(Fc=Q(),Fc!==w?(wc=l(),wc!==w?(Gc=Q(),Gc!==w?(Hc=ka(),Hc!==w?ha=tb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==La?"BOTH":La},ub,wc]}}:(y=ha,ha=w)):(y=ha,ha=
w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w);ha===w&&(ha=y,tb=ea(),tb!==w?(ec=Q(),ec!==w?(fc=ja(),fc!==w?(gc=Q(),gc!==w?(La=G(),La===w&&(La=null),La!==w?(hc=Q(),hc!==w?(ub=l(),ub!==w?(ic=Q(),ic!==w?(jc=ka(),jc!==w?ha=tb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==La?"BOTH":La},ub]}}:(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=
w)):(y=ha,ha=w)):(y=ha,ha=w)):(y=ha,ha=w));a=ha;if(a===w){var xa,xc,Ic,Jc,Kc,yc,Lc,Mc,Nc,zc,Oc,Pc;xa=y;var ob,kc,Ob,Qc;ob=y;h.substr(y,8).toLowerCase()===Id?(kc=h.substr(y,8),y+=8):(kc=w,0===O&&f(Jd));kc!==w?(Ob=y,O++,Qc=D(),O--,Qc===w?Ob=void 0:(y=Ob,Ob=w),Ob!==w?ob=kc="POSITION":(y=ob,ob=w)):(y=ob,ob=w);xc=ob;xc!==w?(Ic=Q(),Ic!==w?(Jc=ja(),Jc!==w?(Kc=Q(),Kc!==w?(yc=l(),yc!==w?(Lc=Q(),Lc!==w?(Mc=V(),Mc!==w?(Nc=Q(),Nc!==w?(zc=l(),zc!==w?(Oc=Q(),Oc!==w?(Pc=ka(),Pc!==w?xa=xc={type:"function",name:"position",
args:{type:"expr_list",value:[yc,zc]}}:(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w)):(y=xa,xa=w);a=xa;if(a===w){var Da,lc,Rc,Sc,Tc,vb,Uc,Vc;Da=y;var Ma,Pb,Qb,Ta;Ma=y;Ma=Pb=C();if(Ma===w)if(Ma=y,96===h.charCodeAt(y)?(Pb=Wc,y++):(Pb=w,0===O&&f(Xc)),Pb!==w){Qb=[];Yc.test(h.charAt(y))?(Ta=h.charAt(y),y++):(Ta=w,0===O&&f(Zc));if(Ta!==w)for(;Ta!==w;)Qb.push(Ta),Yc.test(h.charAt(y))?(Ta=h.charAt(y),y++):(Ta=w,0===O&&f(Zc));
else Qb=w;Qb!==w?(96===h.charCodeAt(y)?(Ta=Wc,y++):(Ta=w,0===O&&f(Xc)),Ta!==w?Ma=Pb=Qb.join(""):(y=Ma,Ma=w)):(y=Ma,Ma=w)}else y=Ma,Ma=w;lc=Ma;lc!==w?(Rc=Q(),Rc!==w?(Sc=ja(),Sc!==w?(Tc=Q(),Tc!==w?(vb=e(),vb===w&&(vb=null),vb!==w?(Uc=Q(),Uc!==w?(Vc=ka(),Vc!==w?Da=lc={type:"function",name:lc,args:vb?vb:{type:"expr_list",value:[]}}:(y=Da,Da=w)):(y=Da,Da=w)):(y=Da,Da=w)):(y=Da,Da=w)):(y=Da,Da=w)):(y=Da,Da=w)):(y=Da,Da=w);a=Da;if(a===w){var mc,ma,wb,nc,xb,oc,$a,Na,Rb,$c,ad;ma=y;wb=aa();if(wb!==w)if(nc=
Q(),nc!==w)if(xb=l(),xb!==w)if(oc=Q(),oc!==w){$a=[];for(Na=N();Na!==w;)$a.push(Na),Na=N();$a!==w?(Na=Q(),Na!==w?(Rb=R(),Rb!==w?ma=wb={type:"case_expression",format:"simple",operand:xb,clauses:$a,else:null}:(y=ma,ma=w)):(y=ma,ma=w)):(y=ma,ma=w)}else y=ma,ma=w;else y=ma,ma=w;else y=ma,ma=w;else y=ma,ma=w;if(ma===w)if(ma=y,wb=aa(),wb!==w)if(nc=Q(),nc!==w)if(xb=l(),xb!==w)if(oc=Q(),oc!==w){$a=[];for(Na=N();Na!==w;)$a.push(Na),Na=N();$a!==w?(Na=Q(),Na!==w?(Rb=L(),Rb!==w?($c=Q(),$c!==w?(ad=R(),ad!==w?ma=
wb={type:"case_expression",format:"simple",operand:xb,clauses:$a,else:Rb.value}:(y=ma,ma=w)):(y=ma,ma=w)):(y=ma,ma=w)):(y=ma,ma=w)):(y=ma,ma=w)}else y=ma,ma=w;else y=ma,ma=w;else y=ma,ma=w;else y=ma,ma=w;mc=ma;if(mc===w){var qa,yb,pc,ab,Oa,Sb,bd,cd;qa=y;yb=aa();if(yb!==w)if(pc=Q(),pc!==w){ab=[];for(Oa=F();Oa!==w;)ab.push(Oa),Oa=F();ab!==w?(Oa=Q(),Oa!==w?(Sb=R(),Sb!==w?qa=yb={type:"case_expression",format:"searched",clauses:ab,else:null}:(y=qa,qa=w)):(y=qa,qa=w)):(y=qa,qa=w)}else y=qa,qa=w;else y=
qa,qa=w;if(qa===w)if(qa=y,yb=aa(),yb!==w)if(pc=Q(),pc!==w){ab=[];for(Oa=F();Oa!==w;)ab.push(Oa),Oa=F();ab!==w?(Oa=Q(),Oa!==w?(Sb=L(),Sb!==w?(bd=Q(),bd!==w?(cd=R(),cd!==w?qa=yb={type:"case_expression",format:"searched",clauses:ab,else:Sb.value}:(y=qa,qa=w)):(y=qa,qa=w)):(y=qa,qa=w)):(y=qa,qa=w)):(y=qa,qa=w)}else y=qa,qa=w;else y=qa,qa=w;mc=qa}a=mc;if(a===w){var Tb,pb,Ac,qc,rc;pb=y;Ac=A();if(Ac!==w){qc=[];for(rc=E();rc!==w;)qc.push(rc),rc=E();qc!==w?pb=Ac+=qc.join(""):(y=pb,pb=w)}else y=pb,pb=w;Tb=
pb;Tb!==w&&(Tb={type:"column_ref",table:"",column:Tb});a=Tb;a===w&&(a=H(),a===w&&(a=y,b=ja(),b!==w?(c=Q(),c!==w?(d=l(),d!==w?(g=Q(),g!==w?(k=ka(),k!==w?(d.paren=!0,a=b=d):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)))}}}}}}}return a}function C(){var a,b,c,d;a=y;b=A();if(b!==w){c=[];for(d=D();d!==w;)c.push(d),d=D();c!==w?a=b+=c.join(""):(y=a,a=w)}else y=a,a=w;return a}function A(){var a;db.test(h.charAt(y))?(a=h.charAt(y),y++):(a=w,0===O&&f(zb));return a}function D(){var a;eb.test(h.charAt(y))?
(a=h.charAt(y),y++):(a=w,0===O&&f(Vb));return a}function E(){var a;qb.test(h.charAt(y))?(a=h.charAt(y),y++):(a=w,0===O&&f(Wb));return a}function H(){var a,b,c;a=y;64===h.charCodeAt(y)?(b=Ub,y++):(b=w,0===O&&f(Xb));b!==w?(c=C(),c!==w?a=b=[b,c]:(y=a,a=w)):(y=a,a=w);a!==w&&(a={type:"param",value:a[1]});return a}function G(){var a,b,c;a=y;h.substr(y,7).toLowerCase()===Kd?(b=h.substr(y,7),y+=7):(b=w,0===O&&f(Ld));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="LEADING":(y=a,a=w)):(y=a,a=w);
a===w&&(a=y,h.substr(y,8).toLowerCase()===Md?(b=h.substr(y,8),y+=8):(b=w,0===O&&f(Nd)),b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="TRAILING":(y=a,a=w)):(y=a,a=w),a===w&&(a=y,h.substr(y,4).toLowerCase()===Od?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(Pd)),b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="BOTH":(y=a,a=w)):(y=a,a=w)));return a}function J(){var a;a=I();a===w&&(a=H());return a}function I(){var a,b,c;a=y;39===h.charCodeAt(y)?(b=Ab,y++):(b=w,0===O&&f(Bb));b===w&&(h.substr(y,
2)===Cb?(b=Cb,y+=2):(b=w,0===O&&f(dd)));if(b!==w){b=[];c=y;h.substr(y,2)===Wa?(c=Wa,y+=2):(c=w,0===O&&f(Db));c!==w&&(c="'");c===w&&(Eb.test(h.charAt(y))?(c=h.charAt(y),y++):(c=w,0===O&&f(Fb)));for(;c!==w;)b.push(c),c=y,h.substr(y,2)===Wa?(c=Wa,y+=2):(c=w,0===O&&f(Db)),c!==w&&(c="'"),c===w&&(Eb.test(h.charAt(y))?(c=h.charAt(y),y++):(c=w,0===O&&f(Fb)));b!==w?(39===h.charCodeAt(y)?(c=Ab,y++):(c=w,0===O&&f(Bb)),c!==w?a=b={type:"string",value:b.join("")}:(y=a,a=w)):(y=a,a=w)}else y=a,a=w;return a}function F(){var a,
b,c;a=y;b=da();b!==w?(b=Q(),b!==w?(b=l(),b!==w?(c=Q(),c!==w?(c=fa(),c!==w?(c=Q(),c!==w?(c=l(),c!==w?a=b={type:"when_clause",operand:b,value:c}:(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w);return a}function N(){var a,b,c;a=y;b=da();b!==w?(b=Q(),b!==w?(b=l(),b!==w?(c=Q(),c!==w?(c=fa(),c!==w?(c=Q(),c!==w?(c=l(),c!==w?a=b={type:"when_clause",operand:b,value:c}:(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w)):(y=a,a=w);return a}function L(){var a,b;a=y;var c,
d;b=y;h.substr(y,4).toLowerCase()===Qd?(c=h.substr(y,4),y+=4):(c=w,0===O&&f(Rd));c!==w?(c=y,O++,d=D(),O--,d===w?c=void 0:(y=c,c=w),c!==w?b="ELSE":(y=b,b=w)):(y=b,b=w);b!==w?(b=Q(),b!==w?(b=l(),b!==w?a={type:"else_clause",value:b}:(y=a,a=w)):(y=a,a=w)):(y=a,a=w);return a}function M(){var a,b,c;a=X();a===w&&(a=y,45===h.charCodeAt(y)?(b=Za,y++):(b=w,0===O&&f(Sa)),b===w&&(43===h.charCodeAt(y)?(b=Pa,y++):(b=w,0===O&&f(Qa))),b!==w?(c=X(),c!==w?a=b=b[0]+c:(y=a,a=w)):(y=a,a=w));return a}function K(){var a,
b;a=y;46===h.charCodeAt(y)?(b=Sd,y++):(b=w,0===O&&f(Td));b!==w?(b=X(),b===w&&(b=null),b!==w?a="."+(null!=b?b:""):(y=a,a=w)):(y=a,a=w);return a}function ba(){var a,b,c;b=a=y;Ud.test(h.charAt(y))?(c=h.charAt(y),y++):(c=w,0===O&&f(Vd));c!==w?(Wd.test(h.charAt(y))?(c=h.charAt(y),y++):(c=w,0===O&&f(Xd)),c===w&&(c=null),c!==w?b="e"+(null===c?"":c):(y=b,b=w)):(y=b,b=w);b!==w?(c=X(),c!==w?a=b+c:(y=a,a=w)):(y=a,a=w);return a}function X(){var a,b;a=[];b=T();if(b!==w)for(;b!==w;)a.push(b),b=T();else a=w;a!==
w&&(a=a.join(""));return a}function T(){var a;Yd.test(h.charAt(y))?(a=h.charAt(y),y++):(a=w,0===O&&f(Zd));return a}function V(){var a,b,c;a=y;h.substr(y,2).toLowerCase()===$d?(b=h.substr(y,2),y+=2):(b=w,0===O&&f(ae));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="IN":(y=a,a=w)):(y=a,a=w);return a}function P(){var a,b,c;a=y;h.substr(y,2).toLowerCase()===be?(b=h.substr(y,2),y+=2):(b=w,0===O&&f(ce));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="IS":(y=a,a=w)):(y=a,a=w);return a}
function W(){var a,b,c;a=y;h.substr(y,4).toLowerCase()===de?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(ee));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="LIKE":(y=a,a=w)):(y=a,a=w);return a}function U(){var a,b,c;a=y;h.substr(y,3).toLowerCase()===fe?(b=h.substr(y,3),y+=3):(b=w,0===O&&f(ge));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="NOT":(y=a,a=w)):(y=a,a=w);return a}function Y(){var a,b,c;a=y;h.substr(y,3).toLowerCase()===he?(b=h.substr(y,3),y+=3):(b=w,0===O&&f(ie));b!==w?
(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="AND":(y=a,a=w)):(y=a,a=w);return a}function S(){var a,b,c;a=y;h.substr(y,2).toLowerCase()===je?(b=h.substr(y,2),y+=2):(b=w,0===O&&f(ke));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="OR":(y=a,a=w)):(y=a,a=w);return a}function ca(){var a,b,c;a=y;h.substr(y,7).toLowerCase()===le?(b=h.substr(y,7),y+=7):(b=w,0===O&&f(me));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="BETWEEN":(y=a,a=w)):(y=a,a=w);return a}function ga(){var a,
b,c;a=y;h.substr(y,4).toLowerCase()===ne?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(oe));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="FROM":(y=a,a=w)):(y=a,a=w);return a}function ea(){var a,b,c;a=y;h.substr(y,4).toLowerCase()===pe?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(qe));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="TRIM":(y=a,a=w)):(y=a,a=w);return a}function aa(){var a,b,c;a=y;h.substr(y,4).toLowerCase()===re?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(se));b!==w?(b=y,O++,c=D(),O--,
c===w?b=void 0:(y=b,b=w),b!==w?a="CASE":(y=a,a=w)):(y=a,a=w);return a}function R(){var a,b,c;a=y;h.substr(y,3).toLowerCase()===te?(b=h.substr(y,3),y+=3):(b=w,0===O&&f(ue));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="END":(y=a,a=w)):(y=a,a=w);return a}function da(){var a,b,c;a=y;h.substr(y,4).toLowerCase()===ve?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(we));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="WHEN":(y=a,a=w)):(y=a,a=w);return a}function fa(){var a,b,c;a=y;h.substr(y,
4).toLowerCase()===xe?(b=h.substr(y,4),y+=4):(b=w,0===O&&f(ye));b!==w?(b=y,O++,c=D(),O--,c===w?b=void 0:(y=b,b=w),b!==w?a="THEN":(y=a,a=w)):(y=a,a=w);return a}function la(){var a;44===h.charCodeAt(y)?(a=ze,y++):(a=w,0===O&&f(Ae));return a}function ja(){var a;40===h.charCodeAt(y)?(a=Be,y++):(a=w,0===O&&f(Ce));return a}function ka(){var a;41===h.charCodeAt(y)?(a=De,y++):(a=w,0===O&&f(Ee));return a}function Q(){var a,b;a=[];for(b=va();b!==w;)a.push(b),b=va();return a}function va(){var a;Fe.test(h.charAt(y))?
(a=h.charAt(y),y++):(a=w,0===O&&f(Ge));return a}function na(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function ya(a,b){for(var c=0;c<b.length;c++)a=na(b[c][1],a,b[c][3]);return a}d=void 0!==d?d:{};var w={},ia={start:g},ra=g,oa="!",Ba=c("!",!1),wa="\x3d",sa=c("\x3d",!1),Z="\x3e\x3d",Aa=c("\x3e\x3d",!1),ta="\x3e",Fa=c("\x3e",!1),za="\x3c\x3d",Ya=c("\x3c\x3d",!1),Ia="\x3c\x3e",Ca=c("\x3c\x3e",!1),Ua="\x3c",Ra=c("\x3c",!1),pa="!\x3d",Ga=c("!\x3d",!1),
Pa="+",Qa=c("+",!1),Za="-",Sa=c("-",!1),Ja="*",Va=c("*",!1),bb="/",cb=c("/",!1),db=/^[A-Za-z_\x80-\uFFFF]/,zb=a([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),eb=/^[A-Za-z0-9_]/,Vb=a([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),qb=/^[A-Za-z0-9_.\x80-\uFFFF]/,Wb=a([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Ub="@",Xb=c("@",!1),Ab="'",Bb=c("'",!1),Cb="N'",dd=c("N'",!1),Wa="''",Db=c("''",!1),Eb=/^[^']/,Fb=a(["'"],!0,!1),Sd=".",Td=c(".",!1),Yd=/^[0-9]/,Zd=a([["0","9"]],!1,!1),
Ud=/^[eE]/,Vd=a(["e","E"],!1,!1),Wd=/^[+\-]/,Xd=a(["+","-"],!1,!1),kd="null",ld=c("NULL",!0),gd="true",hd=c("TRUE",!0),id="false",jd=c("FALSE",!0),$d="in",ae=c("IN",!0),be="is",ce=c("IS",!0),de="like",ee=c("LIKE",!0),ed="escape",fd=c("ESCAPE",!0),fe="not",ge=c("NOT",!0),he="and",ie=c("AND",!0),je="or",ke=c("OR",!0),le="between",me=c("BETWEEN",!0),ne="from",oe=c("FROM",!0),Gd="for",Hd=c("FOR",!0),Ed="substring",Fd=c("SUBSTRING",!0),qd="extract",rd=c("EXTRACT",!0),pe="trim",qe=c("TRIM",!0),Id="position",
Jd=c("POSITION",!0),od="timestamp",pd=c("TIMESTAMP",!0),md="date",nd=c("DATE",!0),Kd="leading",Ld=c("LEADING",!0),Md="trailing",Nd=c("TRAILING",!0),Od="both",Pd=c("BOTH",!0),sd="year",td=c("YEAR",!0),ud="month",vd=c("MONTH",!0),wd="day",xd=c("DAY",!0),yd="hour",zd=c("HOUR",!0),Ad="minute",Bd=c("MINUTE",!0),Cd="second",Dd=c("SECOND",!0),re="case",se=c("CASE",!0),te="end",ue=c("END",!0),ve="when",we=c("WHEN",!0),xe="then",ye=c("THEN",!0),Qd="else",Rd=c("ELSE",!0),ze=",",Ae=c(",",!1),Be="(",Ce=c("(",
!1),De=")",Ee=c(")",!1),Fe=/^[ \t\n\r]/,Ge=a([" ","\t","\n","\r"],!1,!1),Wc="`",Xc=c("`",!1),Yc=/^[^`]/,Zc=a(["`"],!0,!1),y=0,fb=[{line:1,column:1}],Ha=0,rb=[],O=0,Xa;if("startRule"in d){if(!(d.startRule in ia))throw Error("Can't start parsing from rule \""+d.startRule+'".');ra=ia[d.startRule]}Xa=ra();if(Xa!==w&&y===h.length)return Xa;Xa!==w&&y<h.length&&f({type:"end"});throw function(a,b,c){return new m(m.buildMessage(a,b),a,b,c)}(rb,Ha<h.length?h.charAt(Ha):null,Ha<h.length?k(Ha,Ha+1):k(Ha,Ha));
}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(m,h,d){Object.defineProperty(h,"__esModule",{value:!0});h.evaluateFunction=function(a,b){var d=c[a.toLowerCase()];if(null==d)throw Error("Function Not Recognised");if(b.length<d.minParams||b.length>d.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return d.evaluate(b)};h.isStandardized=function(a,b){a=c[a.toLowerCase()];return null!=a&&b>=a.minParams&&b<=a.maxParams};
var c={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=a[0],c=a[1];return null==
b||null==c?null:b.toString().substring(c-1)}if(3===a.length)return b=a[0],c=a[1],a=a[2],null==b||null==c||null==a?null:0>=a?"":b.toString().substring(c-1,c+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,c=b?a[1]:" ",b=b?a[2]:a[1];if(null==c||null==b)return null;c="("+d.escapeString(c)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+c+"*|"+
c+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+c+"*","g"),"");case "TRAILING":return b.replace(new RegExp(c+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=
a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",c=0;c<a.length;c++){if(null==a[c])return null;b+=a[c].toString()}return b}},
lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/views/3d/layers/i3s/I3SNodeLoader":function(){define("require exports dojo/_base/lang ../../webgl-engine/lib/Util ./I3SUtil ./I3SBinaryReader ../../support/PromiseLightweight ../../support/projectionUtils ../../lib/glMatrix ../../support/PromiseNativeOrShim ../../../../core/urlUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){var p=c.assert,v=g.vec4d,q={};return function(){function c(a,b,d,f,g,h,k,m,p,n,q,v,J,I,F){this.bundleLoadedCallback=b;this.queueFunctionCall=d;this.debugVis=f;this.renderCoordsHelper=g;this.indexSR=h;this.calcDesiredTextureLOD=k;this.imageIsPartOfTextureBundle=m;this.matId2Meta=p;this.texId2Meta=n;this.useCompressedTextures=q;this.logger=v;this.defaultGeometrySchema=J;this.requiredAttributes=I;this.bypassFeatureData=F;this.texIdToPromises={};this._numLoadAttributes=
0;this.loadShared=function(a){if(null==a.sharedResource)return e.resolve({});var b=l.makeAbsolute(a.sharedResource.href,a.baseUrl)+"/";a.sharedResource.hrefConcat=b;return this.loadJSON(b).then(function(a){c.fixTextureEncodings(a);c.addAbsoluteHrefTexture(a,b);return a})};this.loader=a;this.cancelled=!1}Object.defineProperty(c.prototype,"isLoadingAttributes",{get:function(){return 0<this._numLoadAttributes},enumerable:!0,configurable:!0});c.prototype.waitForAnimationFrame=function(){var a=this;return new e(function(b,
c){a.queueFunctionCall(b,null,[],c)})};c.prototype.cancel=function(){this.cancelled=!0};c.prototype.loadJSON=function(a){var b=this.loader.request(a,"json");return new e(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};c.prototype.loadBinary=function(a){var b=this.loader.request(a,"binary");return new e(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};c.prototype.loadImage=function(a){var b=this.loader.request(a,"image");
return new e(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};c.prototype.loadAttribute=function(c,d,e){c=a.addTrailingSlash(l.makeAbsolute(e,c));return this.loadBinary(c).then(function(a){return b.readBinaryAttribute(d,a)})};c.prototype.loadAttributes=function(a,b,c){var d=this,f=c.map(function(c){return null==a.attributeData||null==a.attributeData[c.index]?(d.logger.error("Missing attributeData for '"+c.name+"' on node '"+a.id+"'"),e.resolve(null)):d.loadAttribute(b,
c.attributeStorageInfo,a.attributeData[c.index].href).catch(function(b){d.logger.error("Failed to load attributeData for '"+c.name+"' on node '"+a.id+"'");return null})});this._numLoadAttributes++;return e.all(f).then(function(a){d._numLoadAttributes--;for(var b={},e=0;e<c.length;++e)a[e]&&(b[c[e].name]=a[e]);return b}).catch(function(a){d._numLoadAttributes--;throw a;})};c.prototype.prepareBinaryGeometryData=function(c,e,f,g){d.mixin(c.geometries[0].params,f);c.faceRanges[0][0]=0;c.faceRanges[0][1]=
f.header.fields.vertexCount/3-1;g||null!=f.vertexAttributes.region||delete f.vertexAttributes.region;if(null!=f.featureAttributes){g=f.featureAttributes;if(g.faceRange){c.faceRanges=[];for(var h=b.createTypedView(e,g.faceRange),k=g.faceRange.valuesPerElement,l=f.header.fields.featureCount,m=0;m<l;m++)c.faceRanges[m]=[h[m*k],h[m*k+1]];c.componentOffsets=a.convertFlatRangesToOffsets(h,l,k)}if(g.id)for(c.featureIds=[],h=1,m=b.valueType2TypedArrayClassMap[g.id.valueType],"UInt64"===g.id.valueType&&(m=
Uint32Array,h=2),e=new m(e,g.id.byteOffset,g.id.count*g.id.valuesPerElement*h),m=0;m<f.header.fields.featureCount;m++)if(c.featureIds[m]=e[m*g.id.valuesPerElement*h],2===h){k=e[m*g.id.valuesPerElement*h+1];if(2097150<=k)throw Error("ID exceeded maximum range supported by javascript (max \x3d 53bit-1 \x3d 9007199254740991)");c.featureIds[m]+=4294967296*k}}};c.prototype.loadNodeData=function(a,f,g,h,k){var m=this,p=null==a.features,n=a.baseUrl,q={},r=this.loadShared(a),t=r.then(function(a){return m.loadReferencedShared(a,
n)}),u=null;null!=this.requiredAttributes&&(u=this.loadAttributes(a,n,this.requiredAttributes));var v=null;null!=a.geometryData&&(v=a.geometryData.map(function(a,b){if(-1===f.indexOf(b))return null;b=l.makeAbsolute(a.href,n);a.hrefConcat=b;return m.loadBinary(b)}));e.all([r,t]).then(function(g){var l=g[0];g=g[1];m.handleCancelled();a.sharedResource&&(q[a.sharedResource.hrefConcat]=l,d.mixin(q,g));g=f.map(function(d){return m.loadFeatureData(a,d,l).then(function(f){m.handleCancelled();p&&c.buildNodeFeatures(a,
d,f);var g=m.collectGeometries(a,d,f,l);f=null;f=null!=v&&null!=v[d]?v[d].then(function(c){q[a.geometryData[d].hrefConcat]=c;var e=Object.keys(l.materialDefinitions)[0],e=l.materialDefinitions[e].params.vertexRegions,f=b.createGeometryDataIndex(c,m.defaultGeometrySchema,e);m.prepareBinaryGeometryData(g[0],c,f,e);return g}):e.resolve(g);var k=h?m.loadTextures(g,l,m.matId2Meta,m.texId2Meta).then(function(a){var b={};a.forEach(function(a){var c=a.i3sTexId;b[c]={i3sTexId:c,data:a.data,encoding:a.encoding,
desiredLOD:a.desiredLOD,createdTextureForDomImage:function(){m.texIdToPromises[c]&&delete m.texIdToPromises[c]}}});return b}):null;return e.all([k,f,u])}).then(function(b){var c=b[0],e=b[1];b=b[2];m.handleCancelled();void 0!==m.debugVis&&m.debugVis.show(a,m.indexSR,"green");var f=null;b&&(f={attributeData:b,loadedAttributes:m.requiredAttributes});return m.callbackWrapped(a,e,f,q,c,d,k)}).catch(function(b){m.handleCancelled();m.logger.error("Failed to load node '"+a.id+"' bundle "+d+": "+b);return m.callbackWrapped(a,
null,null,q,null,d,k)})});return e.all(g)}).catch(function(b){if(!m.cancelled)return m.logger.error("Failed to shared data of node '"+a.id+"': "+b),b=f.map(function(b){return m.callbackWrapped(a,null,null,q,null,b,k)}),e.all(b)}).then(function(){g.done()})};c.prototype.callbackWrapped=function(a,b,c,d,f,g,h){var l=this;return this.waitForAnimationFrame().then(function(){return new e(function(e,m){var p=new k.Promise,n=l.bundleLoadedCallback;n(a,b,c,d,p,f,g,h);p.then(e,m)})})};c.addAbsoluteHrefTexture=
function(a,b){a=a.textureDefinitions;if(void 0!==a)for(var c in a)if(a.hasOwnProperty(c))for(var d=a[c],e=0;e<d.images.length;e++){var f=d.images[e];Array.isArray(d.encoding)?f.hrefConcat=f.href.map(function(a){return l.makeAbsolute(a,b)}):f.hrefConcat=l.makeAbsolute(f.href,b)}};c.fixTextureEncodings=function(a){a=a.textureDefinitions;if(null!=a)for(var b in a){var c=a[b];if(Array.isArray(c.encoding))for(var d=0;d<c.encoding.length;d++){var e=c.encoding[d];"data:"===e.substring(0,5)&&(c.encoding[d]=
e.substring(5))}else e=c.encoding,"data:"===e.substring(0,5)&&(c.encoding=e.substring(5))}};c.prototype.loadReferencedShared=function(a,b){var d=this;if(null==a||null==a.materialDefinitions)return e.resolve({});var f=Object.keys(a.materialDefinitions).filter(function(b){return a.materialDefinitions[b]&&null!=a.materialDefinitions[b].href}).map(function(c){return l.makeAbsolute(a.materialDefinitions[c].href,b)+"/"});return e.all(f.map(function(a){return d.loadJSON(a).then(function(b){return[a,b]})})).then(function(a){for(var b=
{},d=0;d<a.length;d++){var e=a[d],f=e[0],e=e[1];c.fixTextureEncodings(e);c.addAbsoluteHrefTexture(e,f);b[f]=e}return b})};c.prototype.loadTexture=function(b,c,d,f,g,h){var k=this,l=-1<h?d.encoding[h]:d.encoding;d=l===a.DDS_ENCODING_STRING;var m=this.imageIsPartOfTextureBundle(f);p(!(d&&m),"DDS in multi texture bundles not supported at the moment");return d?this.loadBinary(b).then(function(a){return k.cancelled?e.reject():{i3sTexId:c,data:a,encoding:l,desiredLOD:g}}):m?this.loadBinary(b).then(function(a){var d;
try{var m=void 0,n;-1<h?(p(Array.isArray(f.byteOffset)&&Array.isArray(f.length),"texture encoding is array, but image byteOffset/length isn't"),m=f.byteOffset[h],n=f.length[h]):(m=f.byteOffset,n=f.length);var q=new Uint8Array(a,m,n),r=new Blob([q],{type:l});d=window.URL.createObjectURL(r)}catch(L){d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",k.logger.error("error loading texture "+b+": "+L)}var t=
new Image;a=new e(function(a,b){var e=function(){window.URL.revokeObjectURL(d);t.onerror=void 0;t.onload=void 0};t.onerror=function(a){e();b(a)};t.onload=function(){e();k.cancelled?b():a({i3sTexId:c,data:t,encoding:l,desiredLOD:g})}});t.src=d;return a}):this.loadImage(b).then(function(a){return k.cancelled?e.reject():{i3sTexId:c,data:a,encoding:l,desiredLOD:g}})};c.getAllEngineMBS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].engineMBS);return b};c.prototype.loadTextures=function(b,d,f,
g){for(var h=[],k=0;k<b.length;k++)for(var l=b[k].geometries,m=c.getAllEngineMBS(b[k].features),n=0;n<l.length;++n)for(var q=l[n],r=q.params.components.length,t=0;t<r;t++){var u=q.params.components[t],v=u.materialID,u=u.textureID||"none";if((!f[v]||null==f[v][u])&&null==g[u]&&"none"!==u)if(null!=this.texIdToPromises[u])h.push(this.texIdToPromises[u]);else{null!=d.textureDefinitions&&null!=d.textureDefinitions[u]||this.logger.warn("textureDefinitions missing in shared resource. i3sTexId: "+u);v=d.textureDefinitions[u];
p(void 0!==v,"geometry wants unknown texture "+u);var x=this.calcDesiredTextureLOD(m,v.images);if(0!==v.images.length){var N=v.images[x],L=a.getAppropriateTextureEncoding(v.encoding,this.useCompressedTextures()),v=this.loadTexture(-1<L?N.hrefConcat[L]:N.hrefConcat,u,v,N,x,L);h.push(v);this.texIdToPromises[u]=v}}}return e.all(h)};c.getIdFromJsonPointer=function(a){a=a.split("/");return a[a.length-1]};c.buildNodeFeatures=function(a,b,c){null==a.features&&(a.features=[]);for(var d in c.featureData)a.features.push({id:c.featureData[d].id,
mbs:a.mbs,block:b})};c.prototype.collectGeometries=function(a,b,d,e){var g=[],h=!1,k=0,l=a.features.length-1;null==a.featureData[b].featureRange?h=!0:(k=a.featureData[b].featureRange[0],l=a.featureData[b].featureRange[1]);for(;k<=l;++k){var m=a.features[k];if(!m.engineMBS){var n=v.create();f.mbsToMbs(m.mbs,this.indexSR,n,this.renderCoordsHelper.spatialReference);n[3]=m.mbs[3];m.engineMBS=n}if(!h||m.block===b){for(var q=d.featureData,n=void 0,r=0;r<q.length;r++)if(q[r].id===m.id){n=q[r];break}p(null!=
n,"I3S: unable to find feature data in specified block in node.id "+a.id+" feature.id "+m.id);var q=n.geometries,r=[],t=[];if(null!=q)for(var u=0;u<q.length;u++){var x=n.geometries[u];if("GeometryReference"===x.type){for(var N=c.getIdFromJsonPointer(x.params.$ref),L=void 0,M=0;M<d.geometryData.length;M++){var K=d.geometryData[M];if(K.id+""===N){L=K;break}}p(null!=L,"I3S: Unable to find referenced geometry");null==L.params.material&&(this.logger.warn("material definition is missing in featureData, node: "+
a.id),M=Object.keys(e.materialDefinitions)[0],L.params.material="/materialDefinitions/"+M);null==L.params.components&&(L.params.components=null!=L.params.texture?[{material:L.params.material,materialID:c.getIdFromJsonPointer(L.params.material),texture:L.params.texture,textureID:c.getIdFromJsonPointer(L.params.texture),id:1}]:[{material:L.params.material,materialID:c.getIdFromJsonPointer(L.params.material),id:1}],null!=L.params.faces&&null!=L.params.faces.position&&(L.params.faces.position.componentIndices=
[0]));K=void 0;K=null;for(M=0;M<g.length;M++)if(1===g[M].geometries.length&&g[M].geometries[0].id+""===N){K=g[M];break}null===K&&(K={features:[],featureDataPositions:[],faceRanges:[],geometries:[L]},g.push(K));K.features.push(m);K.featureDataPositions.push(n.position);K.faceRanges.push(x.params.faceRange)}else r.push(x),null!=x.params.faceRange&&t.push(x.params.faceRange)}else null!=n.position&&r.push({id:m.id,type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0,0]}}});0===t.length&&
(t=null);0<r.length&&g.push({features:[m],featureDataPositions:[n.position],geometries:r,faceRanges:t})}}return g};c.prototype.idHash=function(a){var b=0,c=a.length;if(0===c)return b;for(var d=0;d<c;d++)var e=a.charCodeAt(d),b=(b<<5)-b+e,b=b|0;return b};c.prototype.loadFeatureData=function(a,b,d){if(this.bypassFeatureData&&this.defaultGeometrySchema){a=this.idHash(a.id);var f=b=void 0;null!=d.materialDefinitions&&(b=Object.keys(d.materialDefinitions)[0]);null!=d.textureDefinitions&&(f=Object.keys(d.textureDefinitions)[0]);
d=c.buildDefaultFeatureData(a,b,f,null);return e.resolve(d)}d=l.makeAbsolute(a.featureData[b].href,a.baseUrl);a.featureData[b].hrefConcat=d;return this.loadJSON(d)};c.buildDefaultFeatureData=function(a,b,c,d){return{featureData:[{id:a,position:[0,0,0],pivotOffset:[0,0,0],mbb:d,layer:"Default",geometries:[{id:1,type:"GeometryReference",params:{$ref:"/geometryData/0",faceRange:[0,0]}}]}],geometryData:[{id:0,type:"ArrayBufferView",params:{type:"triangles",material:"/materialDefinitions/"+b,texture:null!=
c?"/textureDefinitions/"+c:void 0}}]}};c.prototype.handleCancelled=function(){if(this.cancelled)throw q;};return c}()})},"esri/views/3d/layers/i3s/I3SUtil":function(){define("require exports ../../lib/glMatrix ../../support/earthUtils ../../support/projectionUtils ../../../../core/promiseUtils ../../../../core/Error ../../../../core/urlUtils ../../../../geometry/support/webMercatorUtils ../../../../tasks/QueryTask ../../../../tasks/support/Query dojo/_base/lang dojo/promise/all ../../../../request ../../../../geometry/SpatialReference ../../webgl-engine/Stage ../../webgl-engine/materials/Material ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Layer ../../webgl-engine/lib/Util ./I3SBinaryReader".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A){function D(a){return a&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10)}function E(b,c,d,e,f,g){if(null!=d){var h=W;a.mbsToMbs(d.mbs,e,h,c);if(0!==H(b,h)){g.push(d);for(var h=null!=d.children?d.children.length:0,k=0;k<h;k++)E(b,c,f[d.children[k].id],e,f,g)}}}function H(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=0;if(c<a[0])var g=a[0]-c,f=f+g*g;d<a[1]&&(g=a[1]-d,f+=g*g);e<a[2]&&(g=a[2]-e,f+=g*g);c>a[3]&&(g=c-a[3],f+=g*g);d>a[4]&&(g=d-
a[4],f+=g*g);e>a[5]&&(g=e-a[5],f+=g*g);if(f>b*b)return 0;if(0<f)return 1;f=Infinity;c-a[0]<f&&(f=c-a[0]);d-a[1]<f&&(f=d-a[1]);e-a[2]<f&&(f=e-a[2]);a[3]-c<f&&(f=a[3]-c);a[4]-d<f&&(f=a[4]-d);a[5]-e<f&&(f=a[5]-e);return f>b?2:1}function G(a,c,d){void 0===d&&(d=["*"]);if(null!=a.maxRecordCount&&c.length>a.maxRecordCount){var f=F(c,a.maxRecordCount);return v(f.map(function(b){return G(a,b,d)})).then(N)}f=new l({objectIds:c,outFields:d,orderByFields:[a.objectIdField]});return(new e(a.parsedUrl.path)).execute(f).then(function(a){return a&&
a.features&&a.features.length===c.length?a.features.map(function(a){return a.attributes}):b.reject(new k("scenelayer:feature-not-in-companion","Feature not found in companion feature layer"))})}function J(a,c,d,e,g){void 0===e&&(e=["*"]);var h=e.some(function(a){return"*"===a}),k=h?null:e.map(function(a){return a.toLowerCase()});return v(c.attributeData.map(function(d,e){var l=a[e].name.toLowerCase();if(!h&&!k.some(function(a){return l===a}))return b.resolve(null);d=f.makeAbsolute(d.href,c.baseUrl);
return q(d,{query:{token:g},responseType:"array-buffer"}).then(function(b){return A.readBinaryAttribute(a[e],b.data)}).otherwise(function(){return null})})).then(function(b){for(var c=[],e=0;e<d.length;e++){for(var f=d[e],g={},h=0;h<b.length;h++)null!=b[h]&&(g[a[h].name]=I(b[h],f));c.push(g)}return c})}function I(a,b){b=a[b];return a instanceof Int16Array?b===U?null:b:a instanceof Int32Array?b===Y?null:b:b!==b?null:b}function F(a,b){var c=a.length;b=Math.ceil(c/b);for(var d=[],e=0;e<b;e++)d.push(a.slice(Math.floor(c*
e/b),Math.floor(c*(e+1)/b)));return d}function N(a){for(var b=[],c=0;c<a.length;c++)b=b.concat(a[c]);return b}function L(a){var b=new n(D(a.store.indexCRS||a.store.geographicCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function M(a){var b=new n(D(a.store.vertexCRS||a.store.projectedCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function K(a,b,c){if(!g.canProject(a,b))throw new k("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",
{});if("local"===c&&a.isGeographic)throw new k("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",{});}function ba(a,b,c){var d=L(a);a=M(a);K(d,b,c);K(a,b,c)}Object.defineProperty(h,"__esModule",{value:!0});var X=d.vec4d,T=d.vec3d,V=d.mat4d,P=C.assert,W=X.create();h.DDS_ENCODING_STRING="image/vnd-ms.dds";h.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS=["image/jpeg","image/png"];h.addTrailingSlash=function(a){"/"!==a[a.length-1]&&(a+="/");return a};h.extractWkid=
D;h.processNormals=function(b,c,d){switch(c){case "none":c=b.normals;d=b.positions;var e=b.normalInd,f=b.positionInd;P(b.normalInd.length===b.positionInd.length);b=T.create();for(var g=T.create(),h=0;h<f.length;h+=3){var k=3*f[h],l=d[k],m=d[k+1],p=d[k+2],k=3*f[h+1];b[0]=d[k]-l;b[1]=d[k+1]-m;b[2]=d[k+2]-p;k=3*f[h+2];g[0]=d[k]-l;g[1]=d[k+1]-m;g[2]=d[k+2]-p;T.cross(b,g,b);T.normalize(b);for(k=0;3>k;k++)l=3*e[h+k],c[l]=b[0],c[l+1]=b[1],c[l+2]=b[2]}break;case "east-north-up":break;case "earth-centered":d(b.normals,
a.SphericalRenderSpatialReference);break;case "vertex-reference-frame":break;default:throw Error("Received unexpected normalReferenceFrame: "+c);}};h.getAppropriateTextureEncoding=function(a,b){if(Array.isArray(a)){if(b&&(b=a.indexOf(h.DDS_ENCODING_STRING),-1<b))return b;for(b=0;b<a.length;b++)if(-1<h.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS.indexOf(a[b]))return b;throw Error("Could not find appropriate texture encoding (among "+a.toString()+")");}return-1};h.findIntersectingNodes=E;h.intersectBoundingBoxWithMbs=
H;h.makeNodeDebugVisualizer=function(b,d,e){function f(a){return{ambient:a,diffuse:[0,0,0],transparent:!0,opacity:.5,blendModeOneOne:!1}}var g=new x(r.createCylinderGeometry(1,1,64,[0,0,1],[0,0,0],!1),"debugCylinder"),h=new x(r.createSphereGeometry(1),"debugSphere"),k={red:new u(f([.8,0,0]),"debugMaterialRed"),grey:new u(f([.4,.4,.4]),"debugMaterialGrey"),brown:new u(f([.2,.1,0]),"debugMaterialBrown"),green:new u(f([0,.8,0]),"debugMaterialGreen"),blue:new u(f([0,0,.8]),"debugMaterialBlue"),yellow:new u(f([.8,
.8,0]),"debugMaterialYellow"),magenta:new u(f([.8,0,.8]),"debugMaterialMagenta")},l;for(l in k)b.add(t.ModelContentType.MATERIAL,k[l]);b.add(t.ModelContentType.GEOMETRY,g);e=new B(e+"_debug",{interaction:"IGNORED"},e+"_debug");b.add(t.ModelContentType.LAYER,e);b.addToViewContent([e.getId()]);var m=T.create(),p=V.create();return{engineLayer:e,added:{},show:function(b,e,f){var h=b.computedMbs;h||(h=X.create(),a.mbsToMbs(b.mbs,e,h,d.spatialReference));var l="node"+b.id+"dbg";T.set(h,m);var n=h[3];if(n>
c.earthRadius/10&&d.spatialReference===a.SphericalRenderSpatialReference){this.showWS(m,Math.max(.01*n,1E4),f,l+"_center");var h=T.length(m),q=c.earthRadius;q+n>h&&(n=(h*h+q*q-n*n)/(2*h),T.scale(m,n/h),n=Math.sqrt(q*q-n*n))}V.identity(p);V.scale(p,[n,n,.05*n]);f=k[f];P(f);f=new z({name:l,geometries:[g],materials:[[f]],transformations:[p],castShadow:!1,idHint:l});a.computeLinearTransformation(e,b.mbs,p,d.spatialReference);null!=m&&(p[12]=m[0],p[13]=m[1],p[14]=m[2]);f.setObjectTransformation(p);this._addToStage(f,
l)},showWS:function(a,b,c,d){var e=V.identity();V.scale(e,[b,b,b]);b=k[c];P(b);e=new z({name:d,geometries:[h],materials:[[b]],transformations:[e],castShadow:!1,idHint:d});b=V.identity();V.translate(b,a);e.setObjectTransformation(b);this._addToStage(e,d)},_addToStage:function(a,c){b.add(t.ModelContentType.OBJECT,a);this.engineLayer.addObject(a);var d=this.added[c];void 0!==d&&(b.remove(t.ModelContentType.OBJECT,d.getId()),this.engineLayer.removeObject(d));this.added[c]=a},clear:function(){for(var a in this.added){var c=
this.added[a];b.remove(t.ModelContentType.OBJECT,c.getId());this.engineLayer.removeObject(c)}this.added={}},dispose:function(){this.clear();for(var a in k)b.remove(t.ModelContentType.MATERIAL,k[a].getId());b.remove(t.ModelContentType.GEOMETRY,g.getId());b.remove(t.ModelContentType.LAYER,this.engineLayer.getId())}}};h.findFieldsCaseInsensitive=function(a,b,c){for(var d=[],e=0;e<a.length;e++){for(var f=a[e],g=f.toLowerCase(),h=!1,k=0,l=b;k<l.length;k++){var m=l[k];if(g===m.name.toLowerCase()){d.push(m.name);
h=!0;break}}h||void 0===c||c.push(f)}return d};h.whenGraphicAttributes=function(a,c,d,e,f){if(0===c.length)return b.resolve(c);var g=Object.keys(c[0].attributes).map(function(a){return a.toLowerCase()});e=e.filter(function(a){return 0>g.indexOf(a.toLowerCase())});if(0===e.length)return b.resolve(c);var h=function(a){for(var b=0;b<c.length;b++)p.mixin(c[b].attributes,a[b]);return c},l=a.companionFeatureLayer,m=a.attributeStorageInfo;return l?(c.sort(function(a,b){return a.attributes[d]-b.attributes[d]}),
a=c.map(function(a){return a.attributes[d]}),G(l,a,e).then(h)):m&&(f=f(),null!=f)?J(m,f.node,f.indices,e,a.token).then(h):b.reject(new k("scenelayer:no-attribute-source","This scene layer does not have a source for attributes available"))};var U=-Math.pow(2,15),Y=-Math.pow(2,31);h.getCachedAttributeValue=I;h.convertFlatRangesToOffsets=function(a,b,c){void 0===c&&(c=2);b=null!=b?b:a.length/c;for(var d=new Uint32Array(b+1),e=0;e<b;e++){var f=a[e*c];d[e]=3*f;var g=(e-1)*c+1;if(0<=g&&f-1!==a[g])throw new k("Face ranges are not continuous");
}d[d.length-1]=3*(a[(b-1)*c+1]+1);return d};h.getIndexCrs=L;h.getVertexCrs=M;h.checkSpatialReference=K;h.checkSpatialReferences=ba;h.checkSceneLayerValid=function(a){var b;(b=null==a.store||null==a.store.defaultGeometrySchema)||(a=a.store.defaultGeometrySchema,b=!!(null!=a.geometryType&&"triangles"!==a.geometryType||null!=a.topology&&"PerAttributeArray"!==a.topology||null==a.vertexAttributes||null==a.vertexAttributes.position));if(b)throw new k("scenelayer:unsupported-geometry-schema","The geometry schema of this scene layer is not supported.",
{});};h.checkSceneLayerCompatibleWithView=function(a,b){ba(a,b.spatialReference,b.viewingMode)};h.checkPointCloudLayerValid=function(a){var b;(b=null==a.store||null==a.store.defaultGeometrySchema)||(a=a.store.defaultGeometrySchema,b=!!(null==a.geometryType||"points"!==a.geometryType||null!=a.topology&&"PerAttributeArray"!==a.topology||null!=a.encoding&&""!==a.encoding&&"lepcc-xyz"!==a.encoding||null==a.vertexAttributes||null==a.vertexAttributes.position));if(b)throw new k("pointcloud:unsupported-geometry-schema",
"The geometry schema of this point cloud scene layer is not supported.",{});};h.checkPointCloudLayerCompatibleWithView=function(a,b){K(a.spatialReference,b.spatialReference,b.viewingMode)};h.encodeSymbolColor=function(a,b,c){null==a||"ignore"===b?(c[0]=255,c[1]=255,c[2]=255,c[3]=255):(c[0]=Math.floor(255*a[0]),c[1]=Math.floor(255*a[1]),c[2]=Math.floor(255*a[2]),a=Math.floor(85*a[3]),c[3]=0===a?0:"tint"===b?a:"replace"===b?a+85:a+170)}})},"esri/views/3d/layers/i3s/I3SBinaryReader":function(){define("require exports dojo/_base/lang ../../../../core/Logger ../../../../core/Error ./LEPCC".split(" "),
function(m,h,d,c,a,b){function k(b,c,d){for(var e="",f=0;f<d;){var g=b[c+f];if(128>g)e+=String.fromCharCode(g),f++;else if(192<=g&&224>g){if(f+1>=d)throw new a("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var h=b[c+f+1],g=(g&31)<<6|h&63,e=e+String.fromCharCode(g),f=f+2}else if(224<=g&&240>g){if(f+2>=d)throw new a("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");var h=b[c+f+1],k=b[c+f+2],g=(g&15)<<12|(h&63)<<6|k&63,e=e+String.fromCharCode(g),
f=f+3}else if(240<=g&&248>g){if(f+3>=d)throw new a("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");h=b[c+f+1];k=b[c+f+2];g=(g&7)<<18|(h&63)<<12|(k&63)<<6|b[c+f+3]&63;e=65536<=g?e+String.fromCharCode((g-65536>>10)+55296,(g&1023)+56320):e+String.fromCharCode(g);f+=4}else throw new a("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");}return e}function f(a,b){for(var c={byteOffset:0,byteCount:0,fields:Object.create(null)},d=0,e=0;e<b.length;e++){var f=
b[e],g=f.valueType||f.type;c.fields[f.property]=(0,h.valueType2ArrayBufferReader[g])(a,d);d+=h.valueType2TypedArrayClassMap[g].BYTES_PER_ELEMENT}c.byteCount=d;return c}function g(b,c,d){var e=[],f,g=0,h;for(h=0;h<b;h+=1){f=c[h];if(0<f){if(e.push(k(d,g,f-1)),0!==d[g+f-1])throw new a("string-array-error","Invalid string array: missing null termination.");}else e.push(null);g+=f}return e}function e(a,b){return new h.valueType2TypedArrayClassMap[b.valueType](a,b.byteOffset,b.count*b.valuesPerElement)}
function l(a,b){return new Uint8Array(a,b.byteOffset,b.byteCount)}function p(b,c,e){b=null!=c.header?f(b,c.header):{byteOffset:0,byteCount:0,fields:{count:e}};e={header:b,byteOffset:b.byteCount,byteCount:0,entries:Object.create(null)};for(var g=b.byteCount,h=0;h<c.ordering.length;h++){var k=c.ordering[h],l=d.clone(c[k]);l.count=b.fields.count;if("String"===l.valueType){if(l.byteOffset=g,l.byteCount=b.fields[k+"ByteCount"],"UTF-8"!==l.encoding)throw new a("unsupported-encoding","Unsupported String encoding.",
{encoding:l.encoding});}else if(q(l.valueType)){var m=n(l.valueType),g=g+(0!==g%m?m-g%m:0);l.byteOffset=g;l.byteCount=m*l.valuesPerElement*l.count}else throw new a("unsupported-value-type","Unsupported binary valueType",{valueType:l.valueType});g+=l.byteCount;e.entries[k]=l}e.byteCount=g-e.byteOffset;return e}function v(b,c,d){c!==b&&t.error("Invalid "+d+" buffer size\n expected: "+b+", actual: "+c+")");if(c<b)throw new a("buffer-too-small","Binary buffer is too small",{expectedSize:b,actualSize:c});
}function q(a){return h.valueType2TypedArrayClassMap.hasOwnProperty(a)}function n(a){return q(a)&&h.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}Object.defineProperty(h,"__esModule",{value:!0});var t=c.getLogger("esri.layers.SceneService");h.readHeader=f;h.readStringArray=g;h.createTypedView=e;h.createRawView=l;h.createAttributeDataIndex=p;h.createGeometryDataIndex=function(a,b,c){var e=f(a,b.header),g=e.byteCount,h={header:e,byteOffset:e.byteCount,byteCount:0,vertexAttributes:d.clone(b.vertexAttributes)},
k=h.vertexAttributes;c||null==k.region||delete k.region;var l=e.fields.vertexCount||e.fields.count;for(c=0;c<b.ordering.length;c++){var m=b.ordering[c];null!=k[m]&&(k[m].byteOffset=g,k[m].count=l,g+=n(k[m].valueType)*k[m].valuesPerElement*l)}k=e.fields.faceCount;if(b.faces&&k)for(h.faces=d.clone(b.faces),l=h.faces,c=0;c<b.ordering.length;c++)m=b.ordering[c],null!=l[m]&&(l[m].byteOffset=g,l[m].count=k,g+=n(l[m].valueType)*l[m].valuesPerElement*k);e=e.fields.featureCount;if(b.featureAttributes&&b.featureAttributeOrder&&
e)for(h.featureAttributes=d.clone(b.featureAttributes),k=h.featureAttributes,c=0;c<b.featureAttributeOrder.length;c++)l=b.featureAttributeOrder[c],k[l].byteOffset=g,k[l].count=e,m=n(k[l].valueType),"UInt64"===k[l].valueType&&(m=8),g+=m*k[l].valuesPerElement*e;v(g,a.byteLength,"geometry");h.byteCount=g-h.byteOffset;return h};h.readBinaryAttribute=function(c,d,f){if("lepcc-rgb"===c.encoding)return b.decodeRGB(d);if("lepcc-intensity"===c.encoding)return b.decodeIntensity(d);if(null!=c.encoding&&""!==
c.encoding)throw new a("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");c["attributeByteCounts "]&&!c.attributeByteCounts&&(t.error("Warning: Trailing space in 'attributeByteCounts '."),c.attributeByteCounts=c["attributeByteCounts "]);"ObjectIds"===c.ordering[0]&&c.hasOwnProperty("objectIds")&&(t.error("Warning: Case error in objectIds"),c.ordering[0]="objectIds");f=p(d,c,f);v(f.byteOffset+f.byteCount,d.byteLength,"attribute");if(c=f.entries.attributeValues||f.entries.objectIds){if("String"===
c.valueType){f=f.entries.attributeByteCounts;var h=e(d,f);d=l(d,c);return g(f.count,h,d)}return e(d,c)}throw new a("bad-attribute-storage-info","Bad attributeStorageInfo specification.");};h.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array};h.valueType2ArrayBufferReader={Float32:function(a,b){return(new DataView(a,0)).getFloat32(b,!0)},Float64:function(a,b){return(new DataView(a,
0)).getFloat64(b,!0)},UInt8:function(a,b){return(new DataView(a,0)).getUint8(b)},Int8:function(a,b){return(new DataView(a,0)).getInt8(b)},UInt16:function(a,b){return(new DataView(a,0)).getUint16(b,!0)},Int16:function(a,b){return(new DataView(a,0)).getInt16(b,!0)},UInt32:function(a,b){return(new DataView(a,0)).getUint32(b,!0)},Int32:function(a,b){return(new DataView(a,0)).getInt32(b,!0)}};h.isValueType=q;h.getBytesPerValue=n})},"esri/views/3d/layers/i3s/LEPCC":function(){define(["require","exports",
"../../../../core/Error"],function(m,h,d){function c(a,b,c){return{identifier:String.fromCharCode.apply(null,new Uint8Array(a,c+k.identifierOffset,k.identifierLength)),version:b.getUint16(c+k.versionOffset,!0),checksum:b.getUint32(c+k.checksumOffset,!0)}}function a(a,c,d){var e=[];c=b(a,c,e);for(var f=[],g=0;g<e.length;g++){f.length=0;c=b(a,c,f);for(var h=0;h<f.length;h++)d.push(f[h]+e[g])}return c}function b(a,b,c){var e=new DataView(a,b),f=e.getUint8(0),g=f&31,h=!!(f&32),k=(f&192)>>6,f=0;if(0===
k)f=e.getUint32(1,!0),b+=5;else if(1===k)f=e.getUint16(1,!0),b+=3;else if(2===k)f=e.getUint8(1),b+=2;else throw new d("lepcc-decode-error","Bad count type");if(h)throw new d("lepcc-decode-error","LUT not implemented");a=new Uint8Array(a,b,Math.ceil(f*g/8));for(var k=h=e=0,m=-1>>>32-g,u=0;u<f;u++){for(;h<g;)e|=a[k]<<h,h+=8,k+=1;c[u]=e&m;e>>>=g;h-=g;32<h+g&&(e|=a[k-1]>>8-h)}return b+k}Object.defineProperty(h,"__esModule",{value:!0});var k={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,
byteCount:16};h.decodeXYZ=function(b){var f,e,h,m,v,q,n,t,u,x,r,z,B=new DataView(b,0),C=0;m=c(b,B,C);h=m.identifier;m=m.version;C+=k.byteCount;if("LEPCC     "!==h)throw new d("lepcc-decode-error","Bad identifier");if(1<m)throw new d("lepcc-decode-error","Unknown version");var A=C;f=B.getUint32(A+0,!0);e=B.getUint32(A+4,!0);h=B.getFloat64(A+8,!0);m=B.getFloat64(A+16,!0);v=B.getFloat64(A+24,!0);q=B.getFloat64(A+32,!0);n=B.getFloat64(A+40,!0);t=B.getFloat64(A+48,!0);u=B.getFloat64(A+56,!0);x=B.getFloat64(A+
64,!0);r=B.getFloat64(A+72,!0);z=B.getUint32(A+80,!0);B.getUint32(A+84,!0);C+=88;if(e*Math.pow(2,32)+f!==b.byteLength)throw new d("lepcc-decode-error","Bad size");B=new Float64Array(3*z);f=[];e=[];z=[];A=[];C=a(b,C,f);C=a(b,C,e);C=a(b,C,z);C=a(b,C,A);if(C!==b.byteLength)throw new d("lepcc-decode-error","Bad length");for(var D=C=b=0;D<f.length;D++)for(var C=C+f[D],E=0,H=0;H<e[D];H++){var E=E+z[b],G=A[b];B[3*b]=Math.min(q,h+2*u*E);B[3*b+1]=Math.min(n,m+2*x*C);B[3*b+2]=Math.min(t,v+2*r*G);b++}return{errorX:u,
errorY:x,errorZ:r,result:B}};h.decodeRGB=function(a){var b,e,f,h,m,q,n=new DataView(a,0),t=0;h=c(a,n,t);f=h.identifier;h=h.version;t+=k.byteCount;if("ClusterRGB"!==f)throw new d("lepcc-decode-error","Bad identifier");if(1<h)throw new d("lepcc-decode-error","Unknown version");q=t;b=n.getUint32(q+0,!0);e=n.getUint32(q+4,!0);f=n.getUint32(q+8,!0);h=n.getUint16(q+12,!0);m=n.getUint8(q+14);q=n.getUint8(q+15);t+=16;if(e*Math.pow(2,32)+b!==a.byteLength)throw new d("lepcc-decode-error","Bad size");if(2!==
m&&1!==m||0!==q){if(0===m&&0===q){if(3*f+t!==a.byteLength||0!==h)throw new d("lepcc-decode-error","Bad count");return(new Uint8Array(a,t)).slice()}if(2>=m&&1===q){if(t+3!==a.byteLength||1!==h)throw new d("lepcc-decode-error","Bad count");h=n.getUint8(t);b=n.getUint8(t+1);n=n.getUint8(t+2);t=new Uint8Array(3*f);for(a=0;a<f;a++)t[3*a]=h,t[3*a+1]=b,t[3*a+2]=n;return t}throw new d("lepcc-decode-error","Bad method "+m+","+q);}if(3*h+f+t!==a.byteLength||256<h)throw new d("lepcc-decode-error","Bad count");
n=new Uint8Array(a,t,3*h);h=new Uint8Array(a,t+3*h,f);t=new Uint8Array(3*f);for(a=0;a<f;a++)b=h[a],t[3*a]=n[3*b],t[3*a+1]=n[3*b+1],t[3*a+2]=n[3*b+2];return t};h.decodeIntensity=function(a){var f,e,h,m,v,q=new DataView(a,0),n=0;m=c(a,q,n);h=m.identifier;m=m.version;n+=k.byteCount;if("Intensity "!==h)throw new d("lepcc-decode-error","Bad identifier");if(1<m)throw new d("lepcc-decode-error","Unknown version");var t=n;f=q.getUint32(t+0,!0);e=q.getUint32(t+4,!0);h=q.getUint32(t+8,!0);m=q.getUint16(t+12,
!0);v=q.getUint8(t+14);q.getUint8(t+15);n+=16;if(e*Math.pow(2,32)+f!==a.byteLength)throw new d("lepcc-decode-error","Bad size");q=new Uint16Array(h);if(8===v){if(h+n!==a.byteLength)throw new d("lepcc-decode-error","Bad size");v=new Uint8Array(a,n,h)}else if(16===v){if(2*h+n!==a.byteLength)throw new d("lepcc-decode-error","Bad size");v=new Uint16Array(a,n,h)}else if(v=[],b(a,n,v)!==a.byteLength)throw new d("lepcc-decode-error","Bad size");for(a=0;a<h;a++)q[a]=v[a]*m;return q}})},"esri/views/3d/support/PromiseNativeOrShim":function(){define(["./PromiseShim"],
function(m){return null!=window.Promise&&"function"===typeof window.Promise?window.Promise:m})},"esri/views/3d/support/PromiseShim":function(){define(["require","exports"],function(m,h){function d(a,c,d){setTimeout(a,0,c,d)}function c(a){return null!=a&&"object"===typeof a&&"then"in a&&"function"===typeof a.then}var a;(function(a){a[a.Pending=0]="Pending";a[a.Rejected=1]="Rejected";a[a.Resolved=2]="Resolved"})(a||(a={}));return function(){function b(b){var c=this;this.init(a.Pending);b(function(a){return c.resolve(a)},
function(a){return c.reject(a)})}b.prototype.then=function(c,d){if(this.state===a.Pending)return c=b.pending(c,d),this._addToChain(c),c;if(this.state===a.Resolved)return null!=c?b.tryResolveAsync(c,this.value):b.resolve(this.value);if(this.state===a.Rejected)return null!=d?b.tryResolveAsync(d,this.error):b.reject(this.error)};b.prototype.catch=function(a){return this.then(null,a)};b.resolve=function(d){if(d instanceof b)return d;if(c(d)){var f=Object.create(b.prototype);f.init(a.Pending);d.then(function(a){f.resolve(a)},
function(a){f.reject(a)});return f}var g=Object.create(b.prototype);g.init(a.Resolved,d);return g};b.reject=function(c){var d=Object.create(b.prototype);d.init(a.Rejected,null,c);return d};b.all=function(a){var c=a.length;if(0===c)return b.resolve([]);var d=a.map(b.resolve),e=b.pending();a=function(){0===--c&&e.resolve(d.map(b.getValue))};for(var h=function(a){e.reject(a)},k=0;k<d.length;k++)d[k].then(a,h);return e};b.prototype.init=function(a,b,c,d,h){void 0===b&&(b=null);void 0===c&&(c=null);void 0===
d&&(d=null);void 0===h&&(h=null);this.state=a;this.value=b;this.error=c;this.callback=d;this.errback=h;this.chainedPromise=this.firstPromise=null};b.pending=function(c,d){var f=Object.create(b.prototype);f.init(a.Pending,null,null,c,d);return f};b.getValue=function(a){return a.value};b.prototype._unchain=function(){this.errback=this.callback=this.chainedPromise=null};b.prototype._addToChain=function(a){a.chainedPromise=this.firstPromise;this.firstPromise=a};b.tryResolveAsync=function(c,f){var g=Object.create(b.prototype);
g.init(a.Pending);d(function(){g.tryResolve(c,f)});return g};b.prototype.tryResolve=function(a,b){try{var c=a(b);this.resolve(c)}catch(e){this.reject(e)}};b.prototype.resolve=function(d){var f=this;this.state===a.Pending?d instanceof b?d.state===a.Pending?(this._unchain(),d._addToChain(this)):d.state===a.Resolved?this.resolve(d.value):d.state===a.Rejected&&this.reject(d.error):c(d)?d.then(function(a){f.resolve(a)},function(a){f.reject(a)}):(this.state=a.Resolved,this.value=d,this.resolveHandlers()):
console.error("Error: Promise is already resolved")};b.prototype.reject=function(b){this.state===a.Pending?(this.state=a.Rejected,this.error=b,this.rejectHandlers()):console.error("Error: Promise is already resolved")};b.prototype.resolveHandlers=function(){this.callResolveHandlers(this.firstPromise);this.firstPromise=null};b.prototype.callResolveHandlers=function(a){null!=a&&(this.callResolveHandlers(a.chainedPromise),null!=a.callback?a.tryResolve(a.callback,this.value):a.resolve(this.value))};b.prototype.rejectHandlers=
function(){this.callRejectHandlers(this.firstPromise);this.firstPromise=null};b.prototype.callRejectHandlers=function(a){null!=a&&(this.callRejectHandlers(a.chainedPromise),null!=a.errback?a.tryResolve(a.errback,this.error):a.reject(this.error))};return b}()})},"esri/views/3d/layers/i3s/I3SIndexTraversal":function(){define(["require","exports","./GoogPriorityQueue","../../support/PromiseLightweight","../../../../core/urlUtils"],function(m,h,d,c,a){return function(){function b(b,c,d,e,h,m,v,q,n,t,
u,x){void 0===x&&(x={initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1});var f=this;this.baseURL=b;this.startNodeUrl=c;this.rootId=d;this.poi=e;this.nodeIndex=h;this.streamDataSupplier=m;this.viewportQueries=v;this.processNodeIndexDocument=q;this.finishedLevelCallback=n;this.debugVis=t;this.logger=u;this.traversalOptions=x;this.queues=[];this.knownNodes=new Set;this.dataLoadingPerLevel=[];this.numIndicesLoading=this.currentLevel=0;this.cancelled=this.queueTraversalEnabled=!1;this.initQueryErrback=
function(){f.initPromise.done()};this.initQueryCallback=function(b,c){if(f.cancelled)f.initPromise.done();else if(f.nodeTraversalState(c.id),f.enqueueConnected(b,c,0),f.isLeafNode(c))f.initPromise.done();else{for(var d=1E9,e=void 0,g=0;g<c.children.length;++g){var h=c.children[g];if(f.nodeIsVisible(h)&&(!f.viewportQueries.hasLOD(c)||!f.viewportQueries.isTooHighLOD(c))){var k=f.viewportQueries.distToPOI(h,f.poi);k<d&&(d=k,e=h)}}e?(b=a.makeAbsolute(e.href,b),f.getNode(b,e.id,f.initQueryCallback,f.initQueryErrback)):
f.initPromise.done()}}}b.prototype.start=function(){var b=this;this._nodeTraversalState={};this._nodeIsVisibleCached={};this.dataLoadingPerLevel=[];this.currentLevel=0;this.rootUrl=a.makeAbsolute(this.startNodeUrl,this.baseURL);this.traversalOptions.initDepthFirst?(this.initPromise=new c.Promise,this.getNode(this.rootUrl,this.rootId,this.initQueryCallback,this.initQueryErrback),this.initPromise.then(function(){b.cancelled||(b.queueTraversalEnabled=!0)})):(this.enqueue(0,{id:this.rootId,hrefConcat:this.rootUrl},
0),this.queueTraversalEnabled=!0)};b.prototype.continueTraversal=function(a){var b=this;if(this.queueTraversalEnabled){a=null==a?5:a;for(var c=0;c<this.queues.length;c++)if(!this.traversalOptions.perLevelTraversal||this.currentLevel===c){for(var d=this.queues[c];0<a--&&!d.isEmpty();)(function(a){var c=b.queues[a].dequeue();b.dataLoadingPerLevel[a]++;var d=function(){b.dataLoadingPerLevel[a]--};b.getNode(c.hrefConcat,c.id,function(c,e){null==e.parentNode?(b.nodeTraversalState(e.id),b.enqueueConnected(c,
e,a),b.processNodeIndexDocument(e,void 0).then(d,d)):b.getNode(b.concatHref(e.parentNode,c),e.parentNode.id,function(f,g){b.nodeTraversalState(e.id);b.enqueueConnected(c,e,a);b.processNodeIndexDocument(e,g).then(d,d)})},d)})(c);this.traversalOptions.perLevelTraversal&&d.isEmpty()&&0===this.dataLoadingPerLevel[c]&&(this.finishedLevelCallback.call(null,this.currentLevel),this.currentLevel++)}}};b.prototype.isQueueTraversalEnabled=function(){return this.queueTraversalEnabled};b.prototype.getQueueSize=
function(){for(var a=0,b=0;b<this.queues.length;b++)a+=this.queues[b].getCount();return a};b.prototype.cancel=function(){this.queueTraversalEnabled=!1;for(var a=0;a<this.queues.length;a++)this.queues[a].clear();this.cancelled=!0};b.prototype.isLoading=function(){return 0<this.numIndicesLoading||0<this.getQueueSize()};b.prototype.nodeIsVisible=function(a){if(null!=this._nodeIsVisibleCached[a.id])return this._nodeIsVisibleCached[a.id];this._nodeIsVisibleCached[a.id]=this.viewportQueries.isNodeVisible(a);
return this._nodeIsVisibleCached[a.id]};b.prototype.nodeTraversalState=function(a){if(null!=this._nodeTraversalState[a])return this._nodeTraversalState[a];var b=this.nodeIndex[a];if(null==b)return null;var c=null,d=!1;if(null!=b.parentNode){c=this.nodeIndex[b.parentNode.id];if(null==c)return null;var h=this._nodeTraversalState[c.id];null!=h&&(d=h.nodeIsTooHighLOD)}var h=this.viewportQueries.hasLOD(b),k=this.viewportQueries.isTooHighLOD(b),c=this.viewportQueries.isChosenLOD(b,c,k,d);this._nodeTraversalState[b.id]=
{visited:!0,nodeHasLOD:h,nodeIsTooHighLOD:k,isChosenLOD:c};return this._nodeTraversalState[a]};b.prototype.getNode=function(a,b,c,d){var e=this;this.numIndicesLoading++;this.nodeIndex[b]?(c(a,this.nodeIndex[b]),this.numIndicesLoading--):this.streamDataSupplier.request(a,"json").then(function(a,b){e.nodeIndex[b.id]=b;b.baseUrl=a;c(a,b);e.numIndicesLoading--},function(b){null!=d&&d(b);e.loadErrorCallback(a);e.numIndicesLoading--})};b.prototype.isLeafNode=function(a){return null==a.children};b.prototype.concatHref=
function(b,c){return a.makeAbsolute(b.href,c)};b.prototype.enqueue=function(a,b,c){this.traversalOptions.perLevelTraversal||(c=0);for(this.knownNodes.add(b.id);this.queues.length<=c;)this.queues.push(new d.goog.structs.PriorityQueue),this.dataLoadingPerLevel.push(0);this.queues[c].enqueue(a,b)};b.prototype.enqueueConnected=function(a,b,c){if(!this.cancelled&&null!=b){var d=this.nodeTraversalState(b.id);if(b.id===this.rootId||null==b.parentNode||this.knownNodes.has(b.parentNode.id))b.id===this.rootId&&
!this.knownNodes.has(b.id)&&this.nodeIsVisible(b)&&this.enqueue(this.viewportQueries.distToPOI(b,this.poi),{id:b.id,hrefConcat:a},c);else{var f={id:b.parentNode.id,hrefConcat:this.concatHref(b.parentNode,a)};this.enqueue(this.viewportQueries.distToPOI(b.parentNode,this.poi),f,c-1)}if(b.children)for(var g=0,h=b.children;g<h.length;g++){var k=h[g],f=this.nodeIsVisible(k);this.knownNodes.has(k.id)||d.nodeHasLOD&&d.nodeIsTooHighLOD||!f||(f={id:k.id,hrefConcat:this.concatHref(k,a)},this.enqueue(this.viewportQueries.distToPOI(k,
this.poi),f,c+1))}if(this.traversalOptions.neighborhood&&b.neighbors)for(d=0,b=b.neighbors;d<b.length;d++)g=b[d],f=this.nodeIsVisible(g),!this.knownNodes.has(g.id)&&f&&(f={id:g.id,hrefConcat:this.concatHref(g,a)},this.enqueue(this.viewportQueries.distToPOI(g,this.poi),f,c))}};b.prototype.loadErrorCallback=function(a){this.logger.warn("Error loading node: "+a)};return b}()})},"esri/views/3d/layers/i3s/GoogPriorityQueue":function(){define([],function(){var m={};(function(){function h(a){var b=typeof a;
if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function d(a,b){a=a.split(".");var c=g;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]?c[d]:c[d]={}:c[d]=b}function c(a,b){this.d=a;this.b=b}function a(a){if("array"!=h(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function b(a){this.a=[];if(a)a:{var d,e;if(a instanceof b){d=a.a;e=[];for(var f=d.length,g=0;g<f;g++)e.push(d[g].getKey());d=e;e=a.a;for(var f=
[],g=e.length,h=0;h<g;h++)f.push(e[h].b);e=f;if(0>=a.a.length){a=this.a;for(f=0;f<d.length;f++)a.push(new c(d[f],e[f]));break a}}else{d=[];f=0;for(g in a)d[f++]=g;f=[];g=0;for(e in a)f[g++]=a[e];e=f}for(f=0;f<d.length;f++)k(this,d[f],e[f])}}function k(a,b,d){var e=a.a;e.push(new c(b,d));b=e.length-1;a=a.a;for(d=a[b];0<b;)if(e=b-1>>1,a[e].getKey()>d.getKey())a[b]=a[e],b=e;else break;a[b]=d}function f(){b.call(this)}var g=this;c.prototype.getKey=function(){return this.d};c.prototype.c=function(){return new c(this.d,
this.b)};b.prototype.remove=function(){var b=this.a,c=b.length,d=b[0];if(!(0>=c)){if(1==c)a(b);else{b[0]=b.pop();for(var b=0,c=this.a,f=c.length,g=c[b];b<f>>1;){var h=2*b+1,k=2*b+2,h=k<f&&c[k].getKey()<c[h].getKey()?k:h;if(c[h].getKey()>g.getKey())break;c[b]=c[h];b=h}c[b]=g}return d.b}};b.prototype.c=function(){return new b(this)};b.prototype.g=function(){return this.a.length};b.prototype.h=function(){return 0==this.a.length};b.prototype.clear=function(){a(this.a)};(function(){function a(){}a.prototype=
b.prototype;f.i=b.prototype;f.prototype=new a})();f.prototype.f=function(a,b){k(this,a,b)};f.prototype.e=function(){return this.remove()};d("goog.structs.PriorityQueue",f);d("goog.structs.PriorityQueue.prototype.enqueue",f.prototype.f);d("goog.structs.PriorityQueue.prototype.dequeue",f.prototype.e);d("goog.structs.PriorityQueue.prototype.isEmpty",f.prototype.h);d("goog.structs.PriorityQueue.prototype.clear",f.prototype.clear);d("goog.structs.PriorityQueue.prototype.clone",f.prototype.c);d("goog.structs.PriorityQueue.prototype.getCount",
f.prototype.g)}).call(m);return m})},"esri/views/3d/layers/i3s/I3SLodHandling":function(){define(["require","exports"],function(m,h){return function(){function d(c,a,b){this.layerViewRequiredFunctions=c;this.layerViewOptionalFunctions=a;this.lodGlobalDirtyChanged=b;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={}}d.prototype.startNodeLoading=function(c,a,b,d,f,g){this._lodGlobalDirty=!1;this._lodMode=b;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};
this._lodSwapRootFeatureLookup={};this._nodeIndex=d;this._rootId=g;this._nodeTraversalState=a;this._nodeIsVisible=c;if("swap"===this._lodMode){for(var e in f)c=f[e],this._nodeTraversalState(c.id).nodeHasLOD&&!this._nodeTraversalState(c.id).isChosenLOD&&(this._lodSwapNodeIndex[e]=c);this._lodSwapBuildUnmatchingFeatureLookups()}this.lodGlobalDirtyChanged(this._lodGlobalDirty)};d.prototype.cancelNodeLoading=function(){this._lodSwapNodeIndex={}};d.prototype.shouldLoadNode=function(c,a){var b=this._nodeTraversalState(c.id);
a=b.nodeHasLOD;b=b.isChosenLOD;return"perLevel"!==this._lodMode?b||!a:b||!a?!0:this.layerViewOptionalFunctions.traversalOptions.allowPartialOverlaps?this._someSubtreesIncomplete(c):this._allSubtreesIncomplete(c)};d.prototype.shouldSetPolygonOffset=function(c){return"perLevel"===this._lodMode?!this._nodeTraversalState(c.id).isChosenLOD:!1};d.prototype._allSubtreesIncomplete=function(c){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(c))return!1;var a=!0;if(null!=c.children)for(var b=0;b<c.children.length;++b){var d=
c.children[b];this._nodeIsVisible(d)&&(d=this._nodeIndex[d.id],a=a&&(null==d||this._allSubtreesIncomplete(d)))}return a};d.prototype._someSubtreesIncomplete=function(c){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(c))return!1;var a=!1;if(null!=c.children)for(var b=0;b<c.children.length;++b){var d=c.children[b];this._nodeIsVisible(d)&&(d=this._nodeIndex[d.id],a=a||null==d||this._allSubtreesIncomplete(d))}return a};d.prototype.setLodGlobalDirty=function(){this._lodGlobalDirty=!0;this.lodGlobalDirtyChanged(this._lodGlobalDirty)};
d.prototype.finishedLevel=function(c){"perLevel"===this._lodMode&&this._deleteUpToLevelRecurse(c-1,0,this._nodeIndex[this._rootId])};d.prototype._deleteUpToLevelRecurse=function(c,a,b){if(null!=b&&!(a>c)&&(this._nodeTraversalState(b.id).isChosenLOD||this.layerViewRequiredFunctions.removeNodeData(b),null!=b.children))for(var d=0;d<b.children.length;++d)this._deleteUpToLevelRecurse(c,a+1,this._nodeIndex[b.children[d].id])};d.prototype.lodSwapBundleLoaded=function(c,a,b){if(null!=b)if(null!=b.swapPairs&&
0<Object.keys(b.swapPairs).length){if(null!=a){c=b.swapPairs;b={};for(var d=0;d<a.length;d++)for(var f=a[d].features,g=0;g<f.length;g++)b[f[g].id]=!0;for(var e in c){a=c[e];d=[];f=a.features;for(g=0;g<f.length;g++)null!=b[f[g]]&&d.push(f[g]);this.layerViewRequiredFunctions.removeFeatures(a.node,a.features)}}}else{for(d in b.nodesHigherInTree)this.layerViewRequiredFunctions.removeNodeData(b.nodesHigherInTree[d]);for(d in b.nodesDeeperInTree)this.layerViewRequiredFunctions.removeNodeData(b.nodesDeeperInTree[d])}this.setLodGlobalDirty()};
Object.defineProperty(d.prototype,"requiresLODGlobalHandling",{get:function(){return"global"===this._lodMode&&null!=this._rootId&&(!0===this._lodGlobalDirty||this.layerViewRequiredFunctions.isOverMemory())},enumerable:!0,configurable:!0});d.prototype.lodGlobalHandling=function(){if(this.requiresLODGlobalHandling){var c=this._rootId;this._lodGlobalHandlingRecursion({id:c,mbs:null},this._nodeIndex,!1,!1,0);this._lodGlobalHandlingRecursionRemoveIntermediate(c,this._nodeIndex,!1,0);this._lodGlobalDirty=
!1;this.lodGlobalDirtyChanged(this._lodGlobalDirty)}};d.prototype.lodSwapBuildInfoForNode=function(c){if(!this._nodeTraversalState(c.id).nodeHasLOD)return null;if("swap"===this._lodMode){var a={},b={},d=!1,f=!1,g=c.id+"",e;for(e in this._lodSwapNodeIndex){var h=this._lodSwapNodeIndex[e];null!=this.layerViewRequiredFunctions.getAddedFeatures(h.id)&&(d=null===c.parentNode||0===(h.id+"").indexOf(g),f=null==h.parentNode||0===g.indexOf(h.id+""),!0===f&&(b[h.id]=h),!0===d&&(a[h.id]=h))}return{nodesHigherInTree:b,
nodesDeeperInTree:a}}if("perLevel"===this._lodMode&&this._nodeTraversalState(c.id).isChosenLOD)return a={},this._getNodesRecurse(c,a),{nodesHigherInTree:null,nodesDeeperInTree:a}};d.prototype._getNodesRecurse=function(c,a){if(null!=c.children)for(var b=0;b<c.children.length;++b){var d=c.children[b],f=this._nodeIndex[d.id];null!=f&&(a[d.id]=f,this._getNodesRecurse(f,a))}};d.prototype._lodSwapBuildUnmatchingFeatureLookups=function(){this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};for(var c in this._lodSwapNodeIndex){var a=
this._lodSwapNodeIndex[c],b=this.layerViewRequiredFunctions.getAddedFeatures(a.id);if(null!=b)for(var d=0;d<b.length;d++){var f=b[d];this._lodSwapFeatureLookup[f.id]=a;null!=f.rootFeature&&(null==this._lodSwapRootFeatureLookup[f.rootFeature]&&(this._lodSwapRootFeatureLookup[f.rootFeature]=[]),this._lodSwapRootFeatureLookup[f.rootFeature].push({node:a,featureId:f.id}))}}};d.prototype._validateLodTreeVisibilities=function(){if(null!=this.layerViewOptionalFunctions.getAllAddedFeatures){var c=this.layerViewOptionalFunctions.getAllAddedFeatures();
console.debug("validating lod tree: ");var a={},b={},d=!0,f;for(f in c)for(var g=c[f],e=0;e<g.length;e++){var h=g[e];null!=a[h.id]&&a[h.id]!==f&&(console.debug("node "+f+" !! encountered feature "+h.id+" already in node "+a[h.id]),d=!1);null!=b[h.id]&&b[h.id]!==f&&(console.debug("node "+f+" !! encountered feature "+h.id+" already as rootFeature in node "+b[h.id]),d=!1);a[h.id]=f;null!=h.rootFeature&&b[h.rootFeature]!==f&&(null!=b[h.rootFeature]&&(console.debug("node "+f+" !! encountered rootFeature "+
h.rootFeature+" already in node "+b[h.rootFeature]),d=!1),null!=a[h.rootFeature]&&(console.debug("node "+f+" !! encountered rootFeature "+h.rootFeature+" already as feature"),d=!1),b[h.rootFeature]=f)}return d}};d.prototype._lodGlobalHandlingRecursion=function(c,a,b,d,f){var g=c.id,e=a[g];if(null==e)return b=null!=c.mbs?this._nodeIsVisible(c):!1,d||!b;g=this._nodeTraversalState(g);c=this._nodeIsVisible(e);var g=g.isChosenLOD,h=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(e,0),k=!0;
if(null!=e.children)for(var m=0;m<e.children.length;++m)this._lodGlobalHandlingRecursion(e.children[m],a,h&&g||b,g||d,f+1)||(k=!1);a=this.layerViewRequiredFunctions.isOverMemory();h&&!g&&((d?b:k)||a)&&(this.setLodGlobalDirty(),this.layerViewRequiredFunctions.removeNodeData(e),h=!1);h&&this.layerViewOptionalFunctions.setPolygonOffset&&this.layerViewOptionalFunctions.setPolygonOffset(e,!(g&&!d));b=k||h;if(g&&h||!c||d)b=!0;g&&!h&&c&&(b=!1);return b};d.prototype._lodGlobalHandlingRecursionRemoveIntermediate=
function(c,a,b,d){var f=a[c];if(null!=f){var g=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(f,0);c=this._nodeTraversalState(c).isChosenLOD;if(null!=f.children)for(var e=0;e<f.children.length;++e)this._lodGlobalHandlingRecursionRemoveIntermediate(f.children[e].id,a,g||b,d+1);b&&!c&&g&&(this.layerViewRequiredFunctions.removeNodeData(f),this.setLodGlobalDirty())}};return d}()})},"esri/views/3d/layers/i3s/I3SViewportQueries":function(){define("require exports ../../lib/glMatrix ./I3SUtil ../../webgl-engine/lib/Util ../../support/projectionUtils ../graphics/Graphics3DSymbolCommonCode ../../../../geometry/Point".split(" "),
function(m,h,d,c,a,b,k,f){var g=d.vec3d,e=d.vec4d;return function(){function d(b,c,d,h,k,l,m,r){void 0===r&&(r={});this.indexSR=b;this.extent=h;this.errorMetricPreference=k;this.elevationProvider=l;this.elevationInfo=m;this.options=r;this.fp=[];this._tmp1=[0,0,0];this._tmp2=[0,0,0];this._tmp3=[0,0,0];this._tmp0=[0,0,0];this.supportedMetrics=["screenSpaceRelative","maxScreenThreshold","removedFeatureDiameter","distanceRangeFromDefaultCamera"];this.maxDistance=r.maxDistance||Number.MAX_VALUE;this.screenspaceErrorBias=
r.screenspaceErrorBias||1;this.enableLoD=!1!==r.disableLod;for(h=0;8>h;++h)this.fp[h]=e.create();a.matrix2frustumPlanes(d.viewMatrix,d.projectionMatrix,this.fp);this.engineSR=c.spatialReference;this._screenSizeFactor=1/d.perPixelRatio;this._camPos=d.eye;this._center=d.center;this._camDir=g.subtract(this._center,this._camPos,[0,0,0]);g.normalize(this._camDir);this.tmpPoint=new f({x:0,y:0,z:0,spatialReference:b})}d.prototype.computedMbs=function(a){a.computedMbs||(a.computedMbs=e.create(),a.computedMbs[3]=
-1);var c=a.computedMbs;0>c[3]&&(e.set(a.mbs,c),this.elevationProvider&&1E5>a.mbs[3]&&(this.tmpPoint.x=c[0],this.tmpPoint.y=c[1],this.tmpPoint.z=c[2],c[2]=k.computeElevation(this.elevationProvider,this.tmpPoint,this.elevationInfo)),b.mbsToMbs(c,this.indexSR,c,this.engineSR));return c};d.prototype.isNodeVisible=function(a){a=this.computedMbs(a);return this.isMBSinExtent(a)&&this.isMBSVisible(a)};d.prototype.isMBSinExtent=function(a){return this.extent?0!==c.intersectBoundingBoxWithMbs(this.extent,
a):!0};d.prototype.isMBSVisible=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];var e=this.fp;return e[0][0]*b+e[0][1]*c+e[0][2]*d+e[0][3]<=a&&e[1][0]*b+e[1][1]*c+e[1][2]*d+e[1][3]<=a&&e[2][0]*b+e[2][1]*c+e[2][2]*d+e[2][3]<=a&&e[3][0]*b+e[3][1]*c+e[3][2]*d+e[3][3]<=a&&e[4][0]*b+e[4][1]*c+e[4][2]*d+e[4][3]<=a&&e[5][0]*b+e[5][1]*c+e[5][2]*d+e[5][3]<=a};d.prototype.calcScreenSpaceSize=function(a,b){a=this.computedMbs(a);var c=a[3];a=g.dist2(a,this._camPos)-c*c;return 0>a?.5*Number.MAX_VALUE:b/Math.sqrt(a)*
this._screenSizeFactor};d.prototype.calcCameraDistance=function(a){a=this.computedMbs(a);return Math.max(0,g.dist(a,this._camPos)-a[3])};d.prototype.calcAngleDependentLoD=function(a){a=this.computedMbs(a);var b=a[3];a=(Math.abs(a[0]*(a[0]-this._camPos[0])+a[1]*(a[1]-this._camPos[1])+a[2]*(a[2]-this._camPos[2]))/g.length(a)+b)/g.dist(a,this._camPos);return Math.min(1,a)};d.prototype.hasLOD=function(a){return this.enableLoD&&null!=a.lodSelection};d.prototype.hasFeatures=function(a){return null!=a.features&&
0<a.features.length||null!=a.featureData};d.prototype.getDistancePlanarMode=function(a,b,c){var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];d=d+d+e*e;if(d<=c*c)return Math.abs(a);c=Math.sqrt(d)-c;return Math.sqrt(a*a+c*c)};d.prototype.getDistanceGlobeMode=function(a,b,c){var d=g.length(b),e=g.length(a)-d;g.scale(a,g.dot(a,b)/g.length2(a),this._tmp0);if(g.dist2(b,this._tmp0)<=c*c)return Math.abs(e);b=g.scale(b,1/d,this._tmp0);var d=g.scale(b,d-c*c/2/d,this._tmp1),f=g.subtract(a,d,this._tmp2),f=g.subtract(f,
g.scale(b,g.dot(b,f),this._tmp3),this._tmp2),d=g.add(d,g.scale(f,c/g.length(f),this._tmp2),this._tmp2);c=g.dist(a,d);2E5<=e&&(a=g.subtract(a,d,this._tmp1),a=g.dot(a,b)/g.length(a),.08>a&&(a=1E-4),c/=a);return c};d.prototype.getDistance=function(a,c,d){return this.engineSR===b.SphericalRenderSpatialReference?this.getDistanceGlobeMode(a,c,d):this.getDistancePlanarMode(a,c,d)};d.prototype._selectErrorMetric=function(a){if(this.errorMetricPreference)for(var b=0;b<this.errorMetricPreference.length;b++)for(var c=
0;c<a.length;c++){if(a[c].metricType===this.errorMetricPreference[b])return a[c]}else for(b=0;b<a.length;b++)if(0<=this.supportedMetrics.indexOf(a[b].metricType))return a[b];return null};d.prototype.isTooHighLOD=function(a){if(a.lodSelection&&0<a.lodSelection.length){if(!1===this.hasFeatures(a))return!1;var b=this._selectErrorMetric(a.lodSelection);if(null!=b)return this.evaluateLODmetric(a,b)}return!1};d.prototype.evaluateLODmetric=function(a,b){if("screenSpaceRelative"===b.metricType)return a=this.computedMbs(a),
a=2*this.getDistance(this._camPos,a,a[3])/this._screenSizeFactor,b.maxError*this.screenspaceErrorBias<=a;if("maxScreenThreshold"===b.metricType){var c=this.calcScreenSpaceSize(a,a.mbs[3]);this.options.angleDependentLoD&&(c*=this.calcAngleDependentLoD(a));return c*this.screenspaceErrorBias<b.maxError}return"removedFeatureDiameter"===b.metricType?10>this.calcScreenSpaceSize(a,b.maxError)*this.screenspaceErrorBias:"distanceRangeFromDefaultCamera"===b.metricType?this.calcCameraDistance(a)>b.maxError:
!1};d.prototype.isChosenLOD=function(a,b,c,d){return a.lodSelection&&0<a.lodSelection.length?(c||!a.children)&&!(b&&d):!0};d.prototype.distToPOI=function(a,b){a=this.computedMbs(a);return g.dist(a,b)-a[3]};return d}()})},"esri/layers/SceneLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./FeatureLayer ./support/Field ./support/fieldUtils ./support/LabelClass ../symbols/support/ElevationInfo ./support/labelingInfo ./mixins/SceneService ./support/commonProperties ../PopupTemplate ../request ../core/requireUtils ../core/promiseUtils ../core/urlUtils ../core/Error ../core/Logger ../core/accessorSupport/PropertyOrigin ../core/accessorSupport/utils ../renderers/support/jsonUtils ../renderers/support/styleUtils ../portal/PortalItem ../tasks/support/Query dojo/_base/lang dojo/promise/all".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I){function F(a,b,c){a&&((a=D.read(a,b,c)||void 0)||L.error("Failed to create renderer",{rendererDefinition:a,layer:this,context:c}));return a}var N=["3DObject","Point"],L=B.getLogger("esri.layers.SceneLayer");h=function(a){function b(b,c){b=a.call(this)||this;b.featureReduction=null;b.operationalLayerType="ArcGISSceneServiceLayer";b.type="scene";b.fields=[];b.definitionExpression=null;b.elevationInfo=null;b.labelsVisible=!1;b.labelingInfo=
null;b.legendEnabled=!0;b.cachedDrawingInfo={color:!1};b.popupEnabled=!0;b.popupTemplate=null;b.objectIdField=null;b.objectIdFilter=null;b._fieldUsageInfo={};b.screenSizePerspectiveEnabled=!0;return b}d(b,a);b.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?J.mixin({},{url:a},b):a};b.prototype.getField=function(a){return g.getField(a,this.fields)};Object.defineProperty(b.prototype,"geometryType",{get:function(){return K[this.profile]||"mesh"},enumerable:!0,configurable:!0});b.prototype.readLabelsVisible=
function(a,b){return b.showLabels};b.prototype.writeLabelsVisible=function(a,b){b.showLabels=!!a};b.prototype.readLegendEnabled=function(a,b){return null!=b.showLegend?b.showLegend:!0};b.prototype.writeLegendEnabled=function(a,b){b.showLegend=!!a};Object.defineProperty(b.prototype,"renderer",{set:function(a){g.fixRendererFields(a,this.fields);this._set("renderer",a)},enumerable:!0,configurable:!0});b.prototype.readCachedDrawingInfo=function(a,b){if(null==a||"object"!==typeof a)a={};null==a.color&&
(a.color=!1);return a};b.prototype.readPopupEnabled=function(a,b){return null!=b.disablePopup?!b.disablePopup:void 0};b.prototype.writePopupEnabled=function(a,b){a||(b.disablePopup=!0)};b.prototype.readPopupTemplate=function(a,b){return b.popupInfo?n.fromJSON(b.popupInfo):void 0};b.prototype.writePopupTemplate=function(a,b){a&&(b.popupInfo=a.toJSON())};b.prototype.readObjectIdField=function(a,b){!a&&b.fields&&b.fields.some(function(b){"esriFieldTypeOID"===b.type&&(a=b.name);return!!a});return a||
void 0};b.prototype.readProfile=function(a,b){a=b.store.profile;if(null!=a&&M[a])return M[a];L.error("Unknown or missing profile",{profile:a,layer:this});return"mesh-pyramids"};b.prototype.readNormalReferenceFrame=function(a,b){return b.store.normalReferenceFrame};b.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return I([a._verifyRootNodeAndUpdateExtent(),a._setCompanionFeatureLayer()])}).then(function(){return a._applyCompanionOverrides()}).then(function(){return a._populateFieldUsageInfo()}).then(function(){return E.loadStyleRenderer(a,
{origin:"service"})}).then(function(){return g.fixRendererFields(a.renderer,a.fields)});this.addResolvingPromise(b);return this};b.prototype.createLayerView=function(a){var b=this;return u.when(m,null==this.profile||"mesh-pyramids"===this.profile?"../views/3d/layers/SceneLayerView3D":"../views/3d/layers/SceneLayerGraphicsView3D").then(function(c){return new c({view:a,layer:b})})};b.prototype.createQuery=function(){var a=new G;"mesh"!==this.geometryType&&(a.returnGeometry=!0,a.returnZ=!0);a.where=
this.definitionExpression||"1\x3d1";a.sqlFormat="standard";return a};b.prototype.queryExtent=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryExtent(a||b.createQuery())})};b.prototype.queryFeatureCount=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryFeatureCount(a||b.createQuery())})};b.prototype.queryFeatures=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryFeatures(a||
b.createQuery())}).then(function(a){if(a&&a.features)for(var c=0,d=a.features;c<d.length;c++)d[c].layer=b;return a})};b.prototype.queryObjectIds=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryObjectIds(a||b.createQuery())})};b.prototype.getFieldUsageInfo=function(a){return this._fieldUsageInfo[a]||{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}};b.prototype._getCompanionLayerForQuery=function(){var a=this;
if(!this.loaded)return this.load().then(function(){return a._getCompanionLayerForQuery()});var b=this.companionFeatureLayer;return null!=b?x.resolve(b):x.reject(new z("scenelayer:query-not-available","SceneLayer queries are not available without companion feature layer"))};b.prototype.hasCachedStatistics=function(a){return null!=this.statisticsInfo&&this.statisticsInfo.some(function(b){return b.name===a})};b.prototype.queryCachedStatistics=function(a){if(!this.hasCachedStatistics(a))return x.reject(new z("scenelayer:no-cached-statistics",
"Cached statistics for this attribute are not available"));for(var b=0,c=this.statisticsInfo;b<c.length;b++){var d=c[b];if(d.name===a)return a=r.join(this.parsedUrl.path,d.href),t(a,{query:{f:"json"},responseType:"json"}).then(function(a){return a.data.stats})}};b.prototype.graphicChanged=function(a){this.emit("graphic-update",a)};b.prototype._validateLayer=function(a){if(a.layerType&&-1===N.indexOf(a.layerType))throw new z("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",
{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});a=this.normalReferenceFrame;var b=this.spatialReference,c=!1,d=!1;if(null==a)d=c=!0;else switch(b=
b&&b.isGeographic,a){case "east-north-up":case "earth-centered":c=!0;d=b;break;case "vertex-reference-frame":c=!0;d=!b;break;default:c=!1}if(!c)throw new z("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!d)throw new z("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.");};b.prototype._populateFieldUsageInfo=function(){this._fieldUsageInfo={};if(this.fields)for(var a=function(a){var c=!(!b.attributeStorageInfo||
!b.attributeStorageInfo.some(function(b){return b.name===a.name})),d=!!(b.companionFeatureLayer&&b.companionFeatureLayer.fields&&b.companionFeatureLayer.fields.some(function(b){return b&&a.name===b.name}));b._fieldUsageInfo[a.name]={supportsLabelingInfo:c,supportsRenderer:c,supportsPopupTemplate:c||d,supportsLayerQuery:d}},b=this,c=0,d=this.fields;c<d.length;c++)a(d[c])};b.prototype._applyCompanionOverrides=function(){if(this.companionFeatureLayer){if(this.companionFeatureLayer.fields)for(var a=0,
b=this.companionFeatureLayer.fields;a<b.length;a++){var c=b[a];this.getField(c.name)||this.fields.push(c.clone())}a=["popupTemplate","popupEnabled"];b=A.getProperties(this);for(c=0;c<a.length;c++){var d=a[c];this._buddyIsMoreImportant(d)&&(b.setDefaultOrigin(this.companionFeatureLayer.originOf(d)),b.set(d,this.companionFeatureLayer[d]),b.setDefaultOrigin("user"))}}};b.prototype._setCompanionFeatureLayer=function(){var a=this;return this._fetchCompanionFeatureLayer().then(function(b){a.companionFeatureLayer=
b})};b.prototype._fetchCompanionFeatureLayer=function(){var a=this;return-1===["mesh-pyramids","points"].indexOf(this.profile)?x.resolve(null):(this.portalItem&&this.portalItem.isResolved()?this._fetchCompanionFeatureLayerFromRelatedItems(this.portalItem):this._fetchCompanionFeatureLayerFromUrl()).then(function(a){return a.load()}).otherwise(function(b){null==a.attributeStorageInfo?L.warn("Companion FeatureLayer could not be loaded and no binary attributes found. Popups will not work for this SceneLayer: "+
a.title):L.info("Companion FeatureLayer could not be loaded. Falling back to binary attributes for Popups on this SceneLayer: "+a.title);return null})};b.prototype._fetchCompanionFeatureLayerFromRelatedItems=function(a){var b=this;return a.fetchRelatedItems({relationshipType:"Service2Data",direction:"forward"}).then(function(a){return(a=a.filter(function(a){return"Feature Service"===a.type})[0])?b._fetchCompanionFeatureLayerFromPortalItem(new H({id:a.id,portal:a.portal})):x.reject()}).otherwise(function(){return b._fetchCompanionFeatureLayerFromUrl()})};
b.prototype._fetchCompanionFeatureLayerFromPortalItem=function(a){var b=this;return a.load().then(function(a){return b._findMatchingCompanionSublayerUrl(a.url)}).then(function(b){return x.resolve(new k({url:b,portalItem:a}))})};b.prototype._fetchCompanionFeatureLayerFromUrl=function(){return this._findMatchingCompanionSublayerUrl().then(function(a){return x.resolve(new k({url:a}))})};b.prototype._findMatchingCompanionSublayerUrl=function(a){var b=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);
if(!b)return x.reject();null==a&&(a=b[1]+"/FeatureServer");var c=a.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");a={query:{f:"json"},responseType:"json"};var d=b[1]+"/SceneServer",e=parseInt(b[2],10),b=t(this._addUrlToken(d),a).otherwise(function(a){return{layers:null}});a=t(this._addUrlToken(c),a);return I([a,b]).then(function(a){var b=a[0];a=a[1];a=a.data&&a.data.layers;b=b.data&&b.data.layers;if(!Array.isArray(b))throw Error("expected layers array");if(Array.isArray(a))for(var d=0;d<Math.min(a.length,
b.length);d++){if(a[d].id===e)return c+"/"+b[d].id}else if(e<b.length)return c+"/"+b[e].id;throw Error("could not find matching companion sublayer");})};b.prototype._buddyIsMoreImportant=function(a){if(!this.companionFeatureLayer)return!1;var b=C.nameToId(this.originOf(a));a=C.nameToId(this.companionFeatureLayer.originOf(a));return null!=a&&a<=C.OriginId.SERVICE?null==b||b<C.OriginId.SERVICE:null!=a&&a<=C.OriginId.PORTAL_ITEM?null==b||b<C.OriginId.PORTAL_ITEM:!1};return b}(a.declared(b,v));c([a.shared("esri.layers.SceneLayer")],
h.prototype,"declaredClass",void 0);c([a.property({json:{origins:{webScene:{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],h.prototype,"featureReduction",void 0);c([a.property()],h.prototype,"companionFeatureLayer",void 0);c([a.property()],h.prototype,"operationalLayerType",void 0);c([a.property({json:{read:!1},readOnly:!0,value:"scene"})],h.prototype,"type",void 0);c([a.property({type:[f]})],h.prototype,"fields",void 0);c([a.property({readOnly:!0})],
h.prototype,"attributeStorageInfo",void 0);c([a.property({readOnly:!0})],h.prototype,"statisticsInfo",void 0);c([a.property({json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],h.prototype,"definitionExpression",void 0);c([a.property({type:l,json:{origins:{service:{read:{source:"elevationInfo"},write:{target:"elevationInfo",enabled:!1}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}})],
h.prototype,"elevationInfo",void 0);c([a.property({type:String,dependsOn:["profile"]})],h.prototype,"geometryType",null);c([a.property({type:Boolean})],h.prototype,"labelsVisible",void 0);c([a.reader("labelsVisible",["showLabels"])],h.prototype,"readLabelsVisible",null);c([a.writer("labelsVisible")],h.prototype,"writeLabelsVisible",null);c([a.property({type:[e],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:p.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",
reader:p.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],h.prototype,"labelingInfo",void 0);c([a.property({type:Boolean})],h.prototype,"legendEnabled",void 0);c([a.reader("legendEnabled",["showLegend"])],h.prototype,"readLegendEnabled",null);c([a.writer("legendEnabled")],h.prototype,"writeLegendEnabled",null);c([a.property({json:{origins:{service:{read:{source:"drawingInfo.renderer",reader:F},write:{target:"drawingInfo.renderer",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.renderer",
reader:F},write:{target:"layerDefinition.drawingInfo.renderer"}},value:null})],h.prototype,"renderer",null);c([a.property({json:{read:!1}})],h.prototype,"cachedDrawingInfo",void 0);c([a.reader("service","cachedDrawingInfo")],h.prototype,"readCachedDrawingInfo",null);c([a.property({type:Boolean})],h.prototype,"popupEnabled",void 0);c([a.reader("popupEnabled",["disablePopup"])],h.prototype,"readPopupEnabled",null);c([a.writer("popupEnabled")],h.prototype,"writePopupEnabled",null);c([a.property({type:n})],
h.prototype,"popupTemplate",void 0);c([a.reader("popupTemplate",["popupInfo"])],h.prototype,"readPopupTemplate",null);c([a.writer("popupTemplate")],h.prototype,"writePopupTemplate",null);c([a.property({type:String,json:{read:!1}})],h.prototype,"objectIdField",void 0);c([a.reader("service","objectIdField",["objectIdField","fields"])],h.prototype,"readObjectIdField",null);c([a.property()],h.prototype,"objectIdFilter",void 0);c([a.property({type:String,json:{read:!1}})],h.prototype,"profile",void 0);
c([a.reader("service","profile",["store.profile"])],h.prototype,"readProfile",null);c([a.property({readOnly:!0,type:String,json:{read:!1}})],h.prototype,"normalReferenceFrame",void 0);c([a.reader("service","normalReferenceFrame",["store.normalReferenceFrame"])],h.prototype,"readNormalReferenceFrame",null);c([a.property(q.screenSizePerspectiveEnabled)],h.prototype,"screenSizePerspectiveEnabled",void 0);h=c([a.subclass()],h);var M={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",
points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},K={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return h})},"esri/layers/mixins/SceneService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Layer ../../core/MultiOriginJSONSupport ./ArcGISService ./OperationalLayer ./PortalLayer ../../core/Error ../../core/urlUtils ../../core/promiseUtils ../../core/requireUtils ../../request dojo/_base/lang dojo/io-query ../../geometry/Extent ../../geometry/HeightModelInfo ../../geometry/SpatialReference ../support/arcgisLayerUrl".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B){h=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.blendMode=null;b.spatialReference=null;b.fullExtent=null;b.heightModelInfo=null;b.version={major:Number.NaN,minor:Number.NaN,versionString:""};b.copyright=null;b.sublayerTitleMode="item-title";b.title=null;b.layerId=null;return b}d(b,a);b.prototype.readSpatialReference=function(a,b){return this._readSpatialReference(b)};b.prototype._readSpatialReference=function(a){if(null!=
a.spatialReference)return z.fromJSON(a.spatialReference);a=a.store;a=(a=a.indexCRS||a.geographicCRS)&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10);return null!=a?new z(a):null};b.prototype.readFullExtent=function(a,b){a=b.store;b=this._readSpatialReference(b);return null==b||null==a||null==a.extent?null:new x({xmin:a.extent[0],ymin:a.extent[1],xmax:a.extent[2],ymax:a.extent[3],spatialReference:b})};b.prototype.readVersion=function(a,b){a=b.store;b=null!=a.version?a.version.toString():"";
a={major:Number.NaN,minor:Number.NaN,versionString:b};b=b.split(".");2<=b.length&&(a.major=parseInt(b[0],10),a.minor=parseInt(b[1],10));return a};b.prototype.readCopyright=function(a,b){return b.copyrightText};b.prototype.readTitlePortalItem=function(a,b){return"item-title"!==this.sublayerTitleMode?void 0:a};b.prototype.readTitleService=function(a,b){a=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return B.titleFromUrlAndName(this.url,b.name);b=b.name||B.parse(this.url).title;
"item-title-and-service-name"===this.sublayerTitleMode&&a&&(b=a+" - "+b);return B.cleanTitle(b)};b.prototype.readLayerId=function(a,b){return b.id};Object.defineProperty(b.prototype,"url",{set:function(a){var b=p.urlToObject(a),c=B.parse(b.path);c&&null!=c.sublayer&&(this.layerId=c.sublayer,b=u.objectToQuery(b.query),a=c.url.path,b&&(a=a+"?"+b));for(;"/"===a[a.length-1];)a=a.slice(0,-1);this._set("url",a)},enumerable:!0,configurable:!0});b.prototype.writeUrl=function(a,b){a&&p.isProtocolRelative(a)&&
(a="https:"+a);a=a?p.normalize(a):a;var c=p.urlToObject(a);null!=this.layerId&&c?(b.url=c.path+"/layers/"+this.layerId,c.query&&Object.keys(c.query)&&(b.url+="?"+u.objectToQuery(c.query))):a&&(b.url=a)};Object.defineProperty(b.prototype,"parsedUrl",{get:function(){var a=this._get("url");if(!a)return null;a=p.urlToObject(a);null!=this.layerId&&B.match.test(a.path)&&(a.path=a.path+"/layers/"+this.layerId);return a},enumerable:!0,configurable:!0});b.prototype._addUrlToken=function(a){var b=t.mixin({},
this.parsedUrl.query,{token:this.token}),b=u.objectToQuery(b);return a+(b?"?"+b:"")};b.prototype.readRootNode=function(a,b){return b.store.rootNode};b.prototype._verifyRootNodeAndUpdateExtent=function(){var a=this;return this._fetchRootNode().then(function(b){return a._updateExtentFromRootNode(b)})};b.prototype._updateExtentFromRootNode=function(a){if(null!=this.fullExtent&&!this.fullExtent.hasZ&&null!=a&&Array.isArray(a.mbs)&&4===a.mbs.length){var b=a.mbs[2];a=a.mbs[3];this.fullExtent.zmin=b-a;this.fullExtent.zmax=
b+a}};b.prototype._fetchRootNode=function(){if(!this.rootNode)return v.resolve();var a=p.join(this.parsedUrl.path,this.rootNode);return n(this._addUrlToken(a),{query:{f:"json"},responseType:"json"}).then(function(a){return a.data}).otherwise(function(b){throw new l("sceneservice:root-node-missing","Root node missing.",{error:b,url:a});})};b.prototype._fetchService=function(){var a=this;return(null==this.layerId&&/SceneServer\/*$/i.test(this.url)?this._fetchFirstLayerId().then(function(b){null!=b&&
(a.layerId=b)}):v.resolve()).then(function(){return a._fetchServiceLayer()})};b.prototype._fetchFirstLayerId=function(){return n(this._addUrlToken(this.url),{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(a){if(a.data&&Array.isArray(a.data.layers)&&0<a.data.layers.length)return a.data.layers[0].id})};b.prototype._fetchServiceLayer=function(){var a=this;return n(this._addUrlToken(this.parsedUrl.path),{query:{f:"json"},responseType:"json"}).then(function(b){b.ssl&&
(a.url=a.url.replace(/^http:/i,"https:"));b=b.data;a.read(b,{origin:"service",url:a.parsedUrl});a._validateLayer(b)})};b.prototype._validateLayer=function(a){};b.prototype.createGraphicsController=function(a){var b=this;a.layer=this;a.addUrlToken=function(a){return b._addUrlToken(a)};var c=q.when(m,"../graphics/controllers/I3SOnDemandController").then(function(b){return new b(a)});c.then(function(a){b.emit("graphics-controller-create",{graphicsController:a})});return c};return b}(a.declared(b,f,k,
g,e));c([a.shared({id:{json:{origins:{service:{read:!1},portalItem:{read:!1}}}}})],h.prototype,"properties",void 0);c([a.property({type:z})],h.prototype,"spatialReference",void 0);c([a.reader("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],h.prototype,"readSpatialReference",null);c([a.property({type:x})],h.prototype,"fullExtent",void 0);c([a.property({type:r})],h.prototype,"heightModelInfo",void 0);c([a.reader("fullExtent",["store.extent","spatialReference","store.indexCRS",
"store.geographicCRS"])],h.prototype,"readFullExtent",null);c([a.property({readOnly:!0})],h.prototype,"version",void 0);c([a.reader("version",["store.version"])],h.prototype,"readVersion",null);c([a.property({type:String})],h.prototype,"copyright",void 0);c([a.reader("copyright",["copyrightText"])],h.prototype,"readCopyright",null);c([a.property({type:String})],h.prototype,"sublayerTitleMode",void 0);c([a.property({type:String})],h.prototype,"title",void 0);c([a.reader("portal-item","title")],h.prototype,
"readTitlePortalItem",null);c([a.reader("service","title",["name"])],h.prototype,"readTitleService",null);c([a.property({type:Number})],h.prototype,"layerId",void 0);c([a.reader("service","layerId",["id"])],h.prototype,"readLayerId",null);c([a.property()],h.prototype,"url",null);c([a.writer("url")],h.prototype,"writeUrl",null);c([a.property({dependsOn:["layerId"]})],h.prototype,"parsedUrl",null);c([a.property()],h.prototype,"store",void 0);c([a.property({type:String})],h.prototype,"rootNode",void 0);
c([a.reader("rootNode",["store.rootNode"])],h.prototype,"readRootNode",null);return h=c([a.subclass("esri.layers.mixins.SceneService")],h)})},"esri/layers/IntegratedMeshLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./mixins/SceneService ../core/Error dojo/_base/lang".split(" "),function(m,h,d,c,a,b,k,f,g){m=function(a){function b(b,c){b=a.call(this)||this;b.geometryType="mesh";b.operationalLayerType=
"IntegratedMeshLayer";b.type="integrated-mesh";return b}d(b,a);b.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?g.mixin({},{url:a},b):a};b.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return a._verifyRootNodeAndUpdateExtent()});this.addResolvingPromise(b);return this};b.prototype._validateLayer=function(a){if(a.layerType&&"IntegratedMesh"!==a.layerType)throw new f("integratedmeshlayer:layer-type-not-supported",
"IntegratedMeshLayer does not support this layer type",{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new f("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new f("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});};return b}(a.declared(b,k));c([a.shared("esri.layers.IntegratedMeshLayer")],
m.prototype,"declaredClass",void 0);c([a.shared({"3d":"../views/3d/layers/SceneLayerView3D"})],m.prototype,"viewModulePaths",void 0);c([a.property({type:String,readOnly:!0})],m.prototype,"geometryType",void 0);c([a.property()],m.prototype,"operationalLayerType",void 0);c([a.property({json:{read:!1},readOnly:!0,value:"integrated-mesh"})],m.prototype,"type",void 0);return m=c([a.subclass()],m)})},"esri/views/3d/layers/ElevationLayerView3D":function(){define(["../../../core/declare","../../../core/promiseUtils",
"../../../core/Error","./TiledLayerView3D"],function(m,h,d,c){return m(c,{declaredClass:"esri.views.3d.layers.ElevationLayerView3D",properties:{isTransparent:{readOnly:!0,get:function(){return!0}}},initialize:function(){var a=this.get("view.map.ground.layers");a&&-1!==a.indexOf(this.layer)||this.addResolvingPromise(h.reject(new d("layerview:elevation-layer-only","3D elevation layer '"+this.layer.id+"' can only be added in the map ground")))}})})},"esri/views/3d/layers/TiledLayerView3D":function(){define("dojo/request/xhr ../../../core/declare ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Error ../../../layers/support/arcgisLayerUrl ../../layers/LayerView ../terrain/terrainUtils ./support/LayerViewUpdatingPercentage".split(" "),
function(m,h,d,c,a,b,k,f,g){function e(a){var b=null,c=a.search(/\/rest\/services\//i);0<c&&(b=a.substring(0,c+6));return b}return h([k,g],{declaredClass:"esri.views.3d.layers.TiledLayerView3D",properties:{formatIsTransparent:{dependsOn:["layer.tileInfo.format"],get:function(){return"jpg"!==this.get("layer.tileInfo.format")}},isTransparent:{dependsOn:["fullOpacity","formatIsTransparent"],readOnly:!0,get:function(){return 1>this.fullOpacity||this.formatIsTransparent}}},_numUpdating:0,_maxNumUpdating:0,
_isUpdating:!1,minDataLevel:0,maxDataLevel:Infinity,initialize:function(){var b=this.layer.tileInfo,e=f.checkIfTileInfoSupportedForView(b,this.layer.fullExtent,this.view.spatialReference,this.view.basemapTerrain.manifold);if(e){var g={layer:this.layer,error:e};switch(e.name){case "tilingscheme:local-gcs-not-supported":e=new a("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",g);break;case "tilingscheme:spatial-reference-mismatch":case "tilingscheme:global-unsupported-spatial-reference":e=
new a("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",g);break;default:e=new a("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",g)}this.addResolvingPromise(c.reject(e))}else e=d.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){if(!this.view.basemapTerrain.tilingScheme.compatibleWith(b)){var d=new a("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface");
return c.reject(d)}}.bind(this)),this.addResolvingPromise(e);this._checkServiceVersionCompatibility();var h=Infinity,k=0;b.lods.forEach(function(a){h=Math.min(a.level,h);k=Math.max(a.level,k)});k=Math.min(k,f.getKnownTiledServiceLevelCap(this.layer.url));this.minDataLevel=h;this.maxDataLevel=k},getTileUrl:function(a,b,c){return this.layer.getTileUrl(a,b,c)},_checkServiceVersionCompatibility:function(){if(!b.isHostedAgolService(this.layer.url))if(10.22>this.layer.version){var d=new a("layerview:service-version-too-old",
"Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+this.layer.version,{minVersion:10.22,detectedVersion:this.layer.version});this.addResolvingPromise(c.reject(d))}else if(10.22===this.layer.version&&!b.isHostedSecuredProxyService(this.layer.url,this.layer.get("portalItem.id"))){var d=e(this.layer.url),f=new a("tiledlayerview3d:service-missing-cors-patch","Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied."),d=m(d+"self?f\x3djson",
{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(a){if(!a||a.error)throw f;}).otherwise(function(){throw f;});this.addResolvingPromise(d)}},_evaluateUpdatingState:function(a){this._isUpdating=!!a;this.notifyChange("updating")},isUpdating:function(){return this._isUpdating}})})},"esri/views/3d/layers/support/LayerViewUpdatingPercentage":function(){define(["../../../../core/Accessor"],function(m){return m.createSubclass([],{properties:{updating:{readOnly:!0},updatingPercentageValue:{value:100,
readOnly:!0},updatingPercentage:{dependsOn:["updating","updatingPercentageValue"],readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}},constructor:function(){}})})},"esri/views/3d/layers/FeatureLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../layers/FeatureLayer ./GraphicLayerView3DBase ../../../layers/graphics/controllers/SnapshotController ../../../core/watchUtils ../../../core/Error ../../../core/promiseUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l){m=p=function(a){function c(c){var d=a.call(this)||this;d.labelingEnabled=c.layer instanceof b;return d}d(c,a);c.prototype.initialize=function(){this.addResolvingPromise(this.validateMaximumFeatureCount())};c.prototype.createController=function(){var a=this;return this.layer.createGraphicsController({layerView:this,options:{maxPageSize:300,extent:this.view.clippingArea}}).then(function(b){b instanceof f&&a._eventHandles.push(g.whenFalseOnce(a,"suspended",function(){b.startup()}));
return b}).otherwise(function(a){return l.reject(new e("featurelayerview3d:create-controller",a.message))})};c.prototype.validateMaximumFeatureCount=function(){return 0>p.maximumFeatureCount||!this.layer.url?l.resolve():this.layer.queryFeatureCount().then(function(a){if(a>p.maximumFeatureCount)throw new e("featurelayerview3d:maximum-feature-count-exceeded","The maximum number of allowed features (${maximumFeatureCount}) has been exceeded (layer has ${numberOfFeatures} features)",{maximumFeatureCount:p.maximumFeatureCount,
numberOfFeatures:a});})};return c}(a.declared(k));m.maximumFeatureCount=-1;c([a.property()],m.prototype,"controller",void 0);m=p=c([a.subclass("esri.views.3d.layers.FeatureLayerView3D")],m);var p;return m})},"esri/views/3d/layers/GraphicLayerView3DBase":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/promise/all ./graphics/Graphics3DLayerViewCore ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../../layers/LayerView ../../../renderers/support/renderingInfoUtils ../support/PromiseLightweight ../../../core/watchUtils ./support/projectExtentUtils ../../../core/Error ../../../core/promiseUtils ../../../layers/graphics/QueryEngine".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u){m=function(a){function c(b){b=a.call(this)||this;b.controller=null;b.supportsDraping=!0;b._overlayUpdating=null;b._progressMaxNumNodes=0;b._eventHandles=[];b._controllerClientSideFiltering=!1;b._suspendResumeExtent=null;b.fullExtentInViewSpatialReference=null;b._isUpdating=!1;b._controllerCreated=!1;return b}d(c,a);Object.defineProperty(c.prototype,"drawingOrder",{set:function(a){this._layerViewCore.graphicsCore.setDrawingOrder(a);this._set("drawingOrder",
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasDraped",{get:function(){return this._layerViewCore.graphicsCore.hasDraped},enumerable:!0,configurable:!0});c.prototype.initialize=function(){var a=this;this._layerViewCore=new k({owner:this,layer:this.layer,spatialIndexRequired:!0,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,labelingEnabled:this.labelingEnabled,elevationAlignmentEnabled:!0,verticalScaleEnabled:!0,highlightsEnabled:!0,updateSuspendResumeExtent:function(){return a.updateSuspendResumeExtent()},
updateClippingExtent:function(b){return a.updateClippingExtent(b)}});this.addResolvingPromise(this._layerViewCore.initialize());this.drawingOrder=this.view.getDrawingOrder(this.layer.uid);this.initializeController();this.addResolvingPromise(this.validateGeometryType());var b=q.toView(this).then(function(b){a.fullExtentInViewSpatialReference=b});b&&this.addResolvingPromise(b);this._evaluateUpdatingState()};c.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=
null;this.controller&&(this.controller.destroy(),this.controller=null);this._layerViewCore&&(this._layerViewCore.destroy(),this._layerViewCore=null);this.loadedGraphics=null};c.prototype.getRenderingInfo=function(a){if((a=l.getRenderingInfo(a,{renderer:this.layer.renderer}))&&a.color){var b=a.color;b[0]/=255;b[1]/=255;b[2]/=255}return a};c.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===
c?(d=a,!0):!1});a=new p.Promise;null!==d?a.done(d):a.reject();return a};c.prototype.getGraphics3DGraphics=function(){return this._layerViewCore.graphicsCore.getGraphics3DGraphics()};c.prototype.getGraphics3DGraphicsKeys=function(){return this._layerViewCore.graphicsCore.getGraphics3DGraphicsKeys()};c.prototype.getSymbolUpdateType=function(){return this._layerViewCore.graphicsCore.getSymbolUpdateType()};c.prototype.queryGraphics=function(){return this._queryEngine?this._queryEngine.queryFeatures():
this._rejectQuery()};c.prototype.queryFeatures=function(a){return this._queryEngine?this._queryEngine.queryFeatures(a):this._rejectQuery()};c.prototype.queryObjectIds=function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery()};c.prototype.queryFeatureCount=function(a){return this._queryEngine?this._queryEngine.queryFeatureCount(a):this._rejectQuery()};c.prototype.queryExtent=function(a){return this._queryEngine?this._queryEngine.queryExtent(a):this._rejectQuery()};
c.prototype.whenGraphicBounds=function(a){return this._layerViewCore.graphicsCore.whenGraphicBounds(a)};c.prototype.highlight=function(a,b){return this._layerViewCore.highlight(a,b,this.layer.objectIdField)};c.prototype._rejectQuery=function(){return t.reject(new n("FeatureLayerView3D","Not ready to execute query"))};c.prototype._notifySuspendedChange=function(){this.notifyChange("suspended")};c.prototype._notifyDrapedDataChange=function(){this.notifyChange("hasDraped");this.emit("draped-data-change")};
c.prototype.canResume=function(){return this.inherited(arguments)&&this._layerViewCore&&this._layerViewCore.canResume()};c.prototype._evaluateUpdatingState=function(){if(this._layerViewCore.elevationAlignment){var a;a=0+this._layerViewCore.elevationAlignment.numNodesUpdating();a+=this._layerViewCore.graphicsCore.numNodesUpdating();var b;b=(b=(b=(b=(b=!this._controllerCreated)||this.controller&&this.controller.updating)||this._overlayUpdating)||this._layerViewCore.graphicsCore.needsIdleUpdate())||
!(this.view.basemapTerrain&&this.view.basemapTerrain.ready);var c;c=0<a||b||this._layerViewCore.spatialIndex.isUpdating();this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);0===a&&(this._progressMaxNumNodes=1);this._isUpdating=c;this.notifyChange("updating");this._set("updatingPercentageValue",b?100:100*a/this._progressMaxNumNodes)}else this._isUpdating=!1,this.notifyChange("updating"),this._set("updatingPercentageValue",100)};c.prototype.isUpdating=function(){return this._isUpdating};
c.prototype.initializeController=function(){var a=this,c=this.createController();v.whenTrueOnce(this.view,"basemapTerrain.ready",function(){b([a,c]).then(function(b){b=b[1];a.controller=b;a._eventHandles.push(a.controller.watch("updating",function(){return a._evaluateUpdatingState()}));a.loadedGraphics=b.graphics;a._queryEngine=new u({features:a.loadedGraphics,objectIdField:a.layer.objectIdField});a._evaluateUpdatingState()}).always(function(){a._controllerCreated=!0;a._evaluateUpdatingState()})})};
c.prototype.updateClippingExtent=function(a){if(this.controller){if(this._controllerClientSideFiltering)return!1;this.controller.extent?(this.controller.extent=null,this._controllerClientSideFiltering=!0):this.controller.extent=a;return!0}return!1};c.prototype.updateSuspendResumeExtent=function(){return this._suspendResumeExtent=f.enlargeExtent(this._layerViewCore.graphicsCore.computedExtent,this._suspendResumeExtent,1.2)};c.prototype.validateGeometryType=function(){var a=this.layer;switch(a.geometryType){case "multipatch":case "multipoint":return t.reject(new n("featurelayerview3d:unsupported-geometry-type",
"Unsupported geometry type ${geometryType}",{geometryType:a.geometryType}))}};c.prototype.getStats=function(){var a=this._layerViewCore.graphicsCore.getGraphics3DGraphics(),b="null",c=this._suspendResumeExtent;c&&(b=[c[0],c[1],c[2],c[3]].map(function(a){return a.toPrecision(4)}).join(", "));var c="null",d=this._layerViewCore.graphicsCore.computedExtent;d&&(c=[d.xmin,d.ymin,d.xmax,d.ymax].map(function(a){return a.toPrecision(4)}).join(", "));return{numCollection:this.loadedGraphics.length,numGraphics:Object.keys(a).length,
numElevationUpdating:this._layerViewCore.elevationAlignment.numNodesUpdating(),numSpatialIndexUpdating:this._layerViewCore.spatialIndex.numNodesUpdating(),numGraphicsUpdating:this._layerViewCore.graphicsCore.numNodesUpdating(),visibilityFrustum:this._layerViewCore.frustumVisibility.canResume(),visibilityScale:this._layerViewCore.scaleVisibility.canResume(),resumeExtent:b,computedExtent:c,updating:this.updating,suspended:this.suspended}};return c}(a.declared(e,g));m.maximumFeatureCount=-1;c([a.property()],
m.prototype,"drawingOrder",null);c([a.property()],m.prototype,"loadedGraphics",void 0);c([a.property()],m.prototype,"symbolsUpdating",void 0);c([a.property()],m.prototype,"hasDraped",null);c([a.property()],m.prototype,"controller",void 0);return m=c([a.subclass("esri.views.3d.layers.GraphicsLayerView3DBase")],m)})},"esri/views/3d/layers/graphics/Graphics3DLayerViewCore":function(){define("require exports ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../core/promiseUtils ../../../../core/Collection ../../../../tasks/support/Query ../../../../Graphic ./Graphics3DCore ./Graphics3DLabeling ./Graphics3DScaleVisibility ./Graphics3DFrustumVisibility ./Graphics3DElevationAlignment ./Graphics3DSpatialIndex ./Graphics3DVerticalScale ./Graphics3DHighlights ../support/attributeUtils".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u){return function(){function h(a){var b=this;this._handles=new d;this.layer=a.layer;this.owner=a.owner;this.updateClippingExtent=a.updateClippingExtent;this.updateSuspendResumeExtent=a.updateSuspendResumeExtent;this.getGraphicsInExtent=a.getGraphicsInExtent;this.graphicsCore=new g;a.spatialIndexRequired&&(this.spatialIndex=new q);if(a.frustumVisibilityEnabled){this.frustumVisibility=new p;var f=this.owner.view.basemapTerrain;this._handles.add([this.owner.view.on("resize",
function(){return b.frustumVisibility.viewChange()}),this.owner.view.navigation.on("currentViewChanged",function(){return b.frustumVisibility.viewChange()}),f.on("elevation-bounds-change",function(){return b.frustumVisibility.elevationBoundsChange()})]);"local"===this.owner.view.viewingMode?this.frustumVisibility.isVisibleBelowSurface=!0:this._handles.add(c.init(f,["opacity","wireframe"],function(){return b.frustumVisibility.isVisibleBelowSurface=f._renderer.isTransparent()}))}a.scaleVisibilityEnabled&&
(a.spatialIndexRequired?(this.scaleVisibility=new l,this._handles.add(this.layer.watch("minScale,maxScale",function(){return b.scaleVisibility.layerMinMaxScaleChangeHandler()}))):console.warn("scaleVisibility requires a spatialIndex"));a.elevationAlignmentEnabled&&(this.elevationAlignment=new v,this._handles.add(this.layer.watch("elevationInfo",function(){return b.graphicsCore.elevationInfoChange()})));a.labelingEnabled&&(this.labeling=new e,this._handles.add(this.layer.watch("labelsVisible",function(){return b.labeling.labelVisibilityChanged()})),
this._handles.add(this.layer.watch("labelingInfo",function(){return b.labeling.updateLabelingInfo()})));a.verticalScaleEnabled&&(this.verticalScale=new n({sourceSpatialReference:this.layer.spatialReference,destSpatialReference:this.owner.view.spatialReference}));a.highlightsEnabled&&(this.highlights=new t)}h.prototype.initialize=function(){var a=this;return this.whenSpatialIndexLoaded().then(function(){return a.deferredInitialize()})};h.prototype.whenSpatialIndexLoaded=function(){return this.spatialIndex?
this.spatialIndex.whenLoaded():a.resolve()};h.prototype.deferredInitialize=function(){var a=this;this.spatialIndex&&this.spatialIndex.initialize(this.owner,this.layer,this.owner.view.spatialReference,this.graphicsCore);this.frustumVisibility&&this.frustumVisibility.initialize(this.owner);var b=this.owner.view.basemapTerrain,c=this.owner.view.elevationProvider;this.scaleVisibility&&this.scaleVisibility.initialize(this.owner,this.layer,this.spatialIndex,this.graphicsCore,b);this.elevationAlignment&&
this.elevationAlignment.initialize(this.owner,function(b,c,d){return a._getGraphicsInExtent(b,c,d)},this.graphicsCore,c);this.labeling&&this.labeling.initialize(this.owner,this.layer,this.graphicsCore,this.scaleVisibility);this.highlights&&this.highlights.initialize(this.graphicsCore);this.graphicsCore.initialize(this.owner,this.layer,this.elevationAlignment,this.scaleVisibility,this.spatialIndex,this.labeling,this.highlights,function(){a.updateSuspendResumeExtent&&a._updateSuspendResumeExtent(a.updateSuspendResumeExtent())},
function(b){return a.verticalScale?a.verticalScale.adjust(b):b},b);this._handles.add([this.layer.watch("renderer",function(b){return a.graphicsCore.rendererChange(b)}),this.owner.watch("fullOpacity",function(){return a.graphicsCore.opacityChange()})]);this._handles.add(this.layer.on("graphic-update",function(b){return a.graphicsCore.graphicUpdateHandler(b)}));this.owner.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate});this.updateClippingExtent&&
(this._handles.add(this.owner.view.watch("clippingArea",function(){return a._updateClippingExtent()})),this._updateClippingExtent());if(this.labeling)return this.labeling.updateLabelingInfo()};h.prototype.destroy=function(){this.owner&&this.owner.view.resourceController.deregisterIdleFrameWorker(this);this._handles&&(this._handles.destroy(),this._handles=null);this.frustumVisibility&&(this.frustumVisibility.destroy(),this.frustumVisibility=null);this.scaleVisibility&&(this.scaleVisibility.destroy(),
this.scaleVisibility=null);this.elevationAlignment&&(this.elevationAlignment.destroy(),this.elevationAlignment=null);this.labeling&&(this.labeling.destroy(),this.labeling=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.highlights&&(this.highlights.destroy(),this.highlights=null);this.owner=this.layer=null};h.prototype.highlight=function(a,c,d){var e=this;if(a instanceof k){c=this.highlights.acquireSet(c,
d);var g=c.set,h=c.handle;this.owner.queryObjectIds(a).then(function(a){return e.highlights.setObjectIds(g,a)});return h}if("number"===typeof a||a instanceof f)return this.highlight([a],c,d);a instanceof b&&(a=a.toArray());if(Array.isArray(a)&&0<a.length){if(a[0]instanceof f)if(h=a,d&&h[0].attributes&&null!==u.attributeLookup(h[0].attributes,d))a=h.map(function(a){return u.attributeLookup(a.attributes,d)});else return a=h.map(function(a){return a.uid}),h=this.highlights.acquireSet(c,null),c=h.set,
h=h.handle,this.highlights.setUids(c,a),h;if("number"===typeof a[0])return h=this.highlights.acquireSet(c,d),c=h.set,h=h.handle,this.highlights.setObjectIds(c,a),h}return{remove:function(){}}};h.prototype.canResume=function(){return(!this.frustumVisibility||this.frustumVisibility.canResume())&&(!this.scaleVisibility||this.scaleVisibility.canResume())};h.prototype._needsIdleUpdate=function(){return this.frustumVisibility&&this.frustumVisibility.needsIdleUpdate()||this.scaleVisibility&&this.scaleVisibility.needsIdleUpdate()||
this.elevationAlignment&&this.elevationAlignment.needsIdleUpdate()||this.graphicsCore&&this.graphicsCore.needsIdleUpdate()?!0:!1};h.prototype._idleUpdate=function(a){this.frustumVisibility&&this.frustumVisibility.idleUpdate(a);this.scaleVisibility&&this.scaleVisibility.idleUpdate(a);this.elevationAlignment&&this.elevationAlignment.idleUpdate(a);this.graphicsCore&&this.graphicsCore.idleUpdate(a)};h.prototype._updateSuspendResumeExtent=function(a){this.frustumVisibility&&this.frustumVisibility.setExtent(a);
this.scaleVisibility&&this.scaleVisibility.setExtent(a)};h.prototype._updateClippingExtent=function(){var a=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(a,this.owner.view.spatialReference)&&(this.updateClippingExtent(a)||this.graphicsCore.recreateAllGraphics())};h.prototype._getGraphicsInExtent=function(a,b,c){this.getGraphicsInExtent?this.getGraphicsInExtent(a,b,c):this.spatialIndex&&this.spatialIndex.intersects(a,b,c)};return h}()})},"esri/views/3d/layers/graphics/Graphics3DLabeling":function(){define("require exports dojo/promise/all ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../layers/support/LabelClass ../../../../symbols/callouts/calloutUtils ../../webgl-engine/lib/TextTextureAtlas ../../webgl-engine/lib/MaterialCollection ./Graphics3DWebStyleSymbol ./Graphics3DCalloutSymbolLayerFactory ./labelPlacement ../../support/debugFlags".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v){return function(){function h(){this.calloutMaterialCollection=this.hudMaterialCollection=this.textTextureAtlas=null;this.labelVisibilityDirty=!1;this.labelClasses=[];this.eventHandles=new c;this.graphicsCore=this.layer=this.layerView=null}h.prototype.initialize=function(b,c,d,e){var f=this;this.layerView=b;this.layer=c;this.graphicsCore=d;this.scaleVisibility=e;this.eventHandles.add(a.whenNot(this.layerView,"suspended",function(){return f.resume()}))};h.prototype.destroy=
function(){this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null);this.calloutMaterialCollection&&(this.calloutMaterialCollection.dispose(),this.calloutMaterialCollection=null);this.labelClasses=null;this.eventHandles.destroy();this.graphicsCore=this.layer=this.layerView=this.eventHandles=null};h.prototype.clear=function(){this.layerView.view.deconflictor.setDirty();this.textTextureAtlas&&
(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null);this.calloutMaterialCollection&&(this.calloutMaterialCollection.dispose(),this.calloutMaterialCollection=null)};h.prototype.updateLabelingInfo=function(){var a=this;this.removeLabels();return this.layer.then(function(){a.scaleVisibility&&a.scaleVisibility.updateScaleRangeActive();var b=a.layer.labelingInfo&&a.layer.labelingInfo.filter(function(a){return!!a.symbol});
if(b&&0<b.length){var c=Array(b.length),b=b.map(function(b,d){var f=b.symbol,g;g=a.graphicsCore.getOrCreateGraphics3DSymbol(f);g=g instanceof e?g.graphics3DSymbol:g;var h=null;k.isCalloutSupport(f)&&f.hasVisibleCallout()&&(h=l.make(f,a.graphicsCore.symbolCreationContext));c[d]={labelClass:b,graphics3DSymbol:g,graphics3DCalloutSymbolLayer:h,options:b.getOptions()};return g});return d(b).then(function(){return c})}return null}).then(function(b){a.labelClasses=b;a.labelVisibilityChanged()})};h.prototype.createLabelsForGraphic=
function(a,c){var d=!1;if(this.labelClasses&&0!==this.labelClasses.length&&c._graphics[0]){for(var e=this.layerLabelsEnabled(),h=0;h<this.labelClasses.length;h++){var k=this.labelClasses[h],l=k.labelClass;if(b.evaluateWhere(l.where,a.attributes)&&(l=l.getLabelExpression(),l.expression)){var m=b.buildLabelText(l.expression,a,this.layer.fields,k.options);if(m){l=null;k.graphics3DSymbol&&k.graphics3DSymbol.symbol&&"label-symbol-3d"===k.graphics3DSymbol.symbol.type&&(l=k.graphics3DSymbol.symbol);var n=
k.graphics3DSymbol.childGraphics3DSymbols[0],q=p.get({graphic:a,graphics3DGraphic:c,labelSymbol:l,labelClass:k.labelClass});if(q.isValid){null==this.textTextureAtlas&&(this.textTextureAtlas=new f(this.layer.id,this.layerView.view._stage));null==this.hudMaterialCollection&&(this.hudMaterialCollection=new g(this.layerView.view._stage));h={text:m,centerOffset:q.centerOffset,translation:q.translation,elevationOffset:q.elevationOffset,screenOffset:q.screenOffset,anchor:q.anchor,needsOffsetAdjustment:q.needsOffsetAdjustment,
centerOffsetUnits:q.centerOffsetUnits,verticalOffset:q.verticalOffset,debugDrawBorder:v.LABELS_SHOW_BORDER};if(n=n.createGraphics3DGraphic(a,h,this.hudMaterialCollection,this.textTextureAtlas))n._labelClass=k.labelClass,c.addLabelGraphic(n,this.graphicsCore.labelStageLayer,this.graphicsCore.stage),c.setVisibilityFlag(0,e,1),c.setVisibilityFlag(1,void 0,1),this.layerView.view.deconflictor.initializeLabelVisibility(c),d=!0,k.graphics3DCalloutSymbolLayer&&q.hasLabelVerticalOffset&&(null==this.calloutMaterialCollection&&
(this.calloutMaterialCollection=new g(this.layerView.view._stage)),(e=k.graphics3DCalloutSymbolLayer.createGraphics3DGraphic(a,{symbol:l,needsOffsetAdjustment:q.needsOffsetAdjustment,translation:h.translation,elevationOffset:h.elevationOffset,screenOffset:h.screenOffset,centerOffset:h.centerOffset,centerOffsetUnits:h.centerOffsetUnits,materialCollection:this.calloutMaterialCollection}))&&c.addLabelGraphic(e,this.graphicsCore.labelStageLayer,this.graphicsCore.stage));break}}}}d&&this.scaleVisibility&&
this.scaleVisibility.updateGraphicLabelScaleVisibility(a,c)}};h.prototype.layerLabelsEnabled=function(){return this.layer.labelsVisible};h.prototype.getGraphics3DGraphics=function(){return this.graphicsCore.getGraphics3DGraphics()};h.prototype.getGraphics3DGraphicsKeys=function(){return this.graphicsCore.getGraphics3DGraphicsKeys()};h.prototype.labelVisibilityChanged=function(){var a=this;if(this.layerView.suspended)this.labelVisibilityDirty=!0;else if(this.layerView.loadedGraphics){var b=this.layerLabelsEnabled();
this.layerView.loadedGraphics.forEach(function(c){var d=a.graphicsCore.getGraphics3DGraphicById(c.uid);d&&(b&&0===d._labelGraphics.length&&a.createLabelsForGraphic(c,d),d.setVisibilityFlag(0,b,1))});this.layerView.view.deconflictor.setDirty();this.labelVisibilityDirty=!1}};h.prototype.elevationInfoChange=function(){this.labelClasses&&this.labelClasses.forEach(function(a){a.graphics3DSymbol.layerPropertyChanged("elevationInfo",{})})};h.prototype.resume=function(){this.labelVisibilityDirty&&this.labelVisibilityChanged()};
h.prototype.removeLabels=function(){var a=this;this.layerView.loadedGraphics&&(this.layerView.loadedGraphics.forEach(function(b){if(b=a.graphicsCore.getGraphics3DGraphicById(b.uid))b._labelGraphics&&b._labelGraphics.forEach(function(a){return a._labelClass=null}),b.clearLabelGraphics()}),this.labelClasses=null,this.layerView.view.deconflictor.setDirty())};return h}()})},"esri/views/3d/webgl-engine/lib/TextTextureAtlas":function(){define("require exports ./Texture ./ModelContentType ../../../webgl/Texture ../../../webgl/enums".split(" "),
function(m,h,d,c,a,b){var k=function(){function b(a){this.textTextures={};this.dirty=!1;this._glTexture=null;this.id=d.idGen.gen(a)}b.prototype.getId=function(){return this.id};b.prototype.dispose=function(){};b.prototype.deferredLoading=function(){return!1};b.prototype.getWidth=function(){return 512};b.prototype.getHeight=function(){return 512};b.prototype.initializeThroughRender=function(b,c){c.wrapMode=33071;c.samplingMode=9987;c.flipped=!0;c.preMultiplyAlpha=!0;c.hasMipmap=!0;var d=this._drawToCanvas();
this._glTexture=new a(b,c,d);this.dirty=!1;return this._glTexture};b.prototype.redraw=function(){if(this.dirty&&this._glTexture){var a=this._drawToCanvas();this._glTexture.setData(a);this.dirty=!1}};b.prototype.setUnloadFunc=function(a){this._unloadFunc=a};b.prototype.unload=function(){null!=this._unloadFunc&&(this._unloadFunc(this.id),this._unloadFunc=null)};b.prototype._drawToCanvas=function(){var a=b._create2Dcanvas(),c=a.getContext("2d");c.clearRect(0,0,512,512);for(var d in this.textTextures){var f=
this.textTextures[d];f.textTexture.renderText(1,f.placement.width,f.placement.height,c,f.placement.atlasOffX,f.placement.atlasOffY)}return a};b._create2Dcanvas=function(){b._textCanvas2D||(b._textCanvas2D=document.createElement("canvas"),b._textCanvas2D.setAttribute("id","canvas2d"),b._textCanvas2D.setAttribute("width",(512).toString()),b._textCanvas2D.setAttribute("height",(512).toString()),b._textCanvas2D.setAttribute("style","display:none"));return b._textCanvas2D};return b}();return function(){function a(a,
b){this._textureAtlasSubtextures=[];this._curLineHeight=this._curY=this._curX=0;this._idHint=a;this._stage=b}a.prototype.dispose=function(){for(var a=0;a<this._textureAtlasSubtextures.length;a++)this._stage.remove(c.TEXTURE,this._textureAtlasSubtextures[a].getId());this._textureAtlasSubtextures=[]};a.prototype.addTextTexture=function(a){for(var b=JSON.stringify(a.getParams())+"_"+a.getString(),d=0;d<this._textureAtlasSubtextures.length;d++){var f=this._textureAtlasSubtextures[d].textTextures[b];if(null!=
f)return f.placement}var g=null;0===this._textureAtlasSubtextures.length&&(g=new k(this._idHint),this._textureAtlasSubtextures.push(g));var d=a.getTextWidth(),f=a.getTextHeight(),h=d+2,m=f+2+2,t;this._curLineHeight=Math.max(this._curLineHeight,m);512>this._curX+h&&512>this._curY+this._curLineHeight||(512>this._curY+this._curLineHeight+m?(this._curX=0,this._curY+=this._curLineHeight):(g=new k(this._idHint),this._textureAtlasSubtextures.push(g),this._curY=this._curX=0,this._curLineHeight=m));m=this._curX;
t=this._curY;this._curX+=h;null!=g&&this._stage.add(c.TEXTURE,g);g=this._textureAtlasSubtextures[this._textureAtlasSubtextures.length-1];d={uvMinMax:[m/512,1-(t+f)/512,(m+d)/512,1-t/512],atlasOffX:m,atlasOffY:t,width:d,height:f,texture:g};g.textTextures[b]={placement:d,textTexture:a};g.dirty=!0;return d};return a}()})},"esri/views/3d/webgl-engine/lib/MaterialCollection":function(){define(["require","exports","./ModelContentType"],function(m,h,d){return function(){function c(a){this.materials={};this.stage=
a}c.prototype.getMaterial=function(a){return this.materials[a]};c.prototype.addMaterial=function(a,b){this.materials[a]=b;this.stage.add(d.MATERIAL,b)};c.prototype.dispose=function(){for(var a in this.materials)this.stage.remove(d.MATERIAL,this.materials[a].getId());this.materials={}};return c}()})},"esri/views/3d/layers/graphics/labelPlacement":function(){define("require exports ../../../../core/Logger ../../lib/glMatrix ../../webgl-engine/materials/HUDMaterial ./Graphics3DWebStyleSymbol".split(" "),
function(m,h,d,c,a,b){function k(a){return a instanceof b?a.graphics3DSymbol:a}function f(a){return{screenLength:a.screenLength,minWorldLength:a.minWorldLength,maxWorldLength:a.maxWorldLength}}Object.defineProperty(h,"__esModule",{value:!0});var g=d.getLogger("esri.views.3d.graphics.Labeling");h.get=function(b){var d=e[b.labelClass.labelPlacement]||e["default"],h=b.graphics3DGraphic._graphics[0],l=h.graphics3DSymbolLayer.getGraphicElevationInfo(b.graphics3DGraphic.graphic),d={placement:d.placement,
anchor:d.anchor,normalizedOffset:d.normalizedOffset,needsOffsetAdjustment:h.isDraped()?void 0:l.hasOffsetAdjustment,verticalOffset:null,screenOffset:[0,0],centerOffset:[0,0,0,-1],centerOffsetUnits:"world",translation:[0,0,0],elevationOffset:0,hasLabelVerticalOffset:!1,isValid:!0},h=b.labelSymbol,l=b.graphics3DGraphic,m=k(l.graphics3DSymbol).symbol;if("point-symbol-3d"===m.type&&m.supportsCallout()&&m.hasVisibleVerticalOffset()&&!l.isDraped())d.verticalOffset=f(m.verticalOffset);else if(h&&h.hasVisibleCallout()&&
(!m.supportsCallout()||!m.verticalOffset||l.isDraped())){a:switch(d.placement){case "above-center":l=!0;break a;default:l=!1}l?(d.verticalOffset=f(h.verticalOffset),d.anchor="bottom",d.normalizedOffset=[0,d.normalizedOffset[1],0],d.hasLabelVerticalOffset=!0):(g.error("verticalOffset","Callouts and vertical offset on labels are currently only supported with above-center label placement (not with "+d.placement+" placement)"),d.isValid=!1)}switch(b.graphic.geometry.type){case "polyline":case "polygon":case "extent":d.anchor=
"center";break;case "point":switch(l=b.graphics3DGraphic,h=k(l.graphics3DSymbol).symbol.symbolLayers.getItemAt(0),l=l.getCenterObjectSpace(),c.vec3d.set(l,d.translation),h.type){case "icon":case "text":l=b.graphics3DGraphic;h=l._graphics[0].getScreenSize();l.isDraped()?d.hasLabelVerticalOffset||(d.anchor="center"):(l=void 0,void 0===l&&(l=q),b=b.graphics3DGraphic._graphics[0].stageObject.getGeometryRecords()[0].materials[0],b instanceof a?(b=b.getParams().anchorPos,l[0]=2*(b[0]-.5),l[1]=2*(b[1]-.5)):
(l[0]=0,l[1]=0),b=l,v[0]=h[0]/2*(d.normalizedOffset[0]-b[0]),v[1]=h[1]/2*(d.normalizedOffset[1]-b[1]),d.screenOffset[0]=v[0],d.hasLabelVerticalOffset?(d.centerOffset[1]=v[1],d.centerOffsetUnits="screen"):d.screenOffset[1]=v[1]);break;case "object":b=b.graphics3DGraphic._graphics[0].getBoundingBoxObjectSpace(),b=[b[3]-b[0],b[4]-b[1],b[5]-b[2]],d.centerOffset[0]=1.1*Math.max(b[0],b[1])/2*d.normalizedOffset[0],h=b[2]/2*d.normalizedOffset[1]+d.translation[2],d.translation[2]=h*(1.1-1),d.elevationOffset=
h,b=c.vec3d.length(b),d.centerOffset[2]=1.1*b/2*d.normalizedOffset[2]}}return d};var e={"above-center":{placement:"above-center",normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{placement:"above-left",normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{placement:"above-right",normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{placement:"below-center",normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{placement:"below-left",normalizedOffset:[-1,-1,0],anchor:"top-right"},
"below-right":{placement:"below-right",normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{placement:"center-center",normalizedOffset:[0,0,1],anchor:"center"},"center-left":{placement:"center-left",normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{placement:"center-right",normalizedOffset:[1,0,0],anchor:"left"}},l={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],
"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};m=function(a){var b=e[a];l[a].forEach(function(a){e[a]=b})};for(var p in l)m(p);Object.freeze&&(Object.freeze(e),Object.keys(e).forEach(function(a){Object.freeze(e[a]);
Object.freeze(e[a].normalizedOffset)}));var v=[0,0],q=[0,0]})},"esri/views/3d/layers/graphics/Graphics3DScaleVisibility":function(){define(["require","exports"],function(m,h){function d(c,a){return null!==c&&0<c&&8E7>c||1E3<a}return function(){function c(){this._scaleRangeActive=!1;this.layerScaleRangeVisibilityDirty=this.layerScaleRangeVisibility=!0;this.layerScaleRangeVisibilityQuery=!1;this.basemapTerrain=this.graphicsCore=this.extent=this.spatialIndex=this.layer=this.layerView=this.scaleChangeEventHandle=
null}c.prototype.initialize=function(a,b,c,d,g){this.layerView=a;this.layer=b;this.spatialIndex=c;this.graphicsCore=d;this.basemapTerrain=g;this.updateScaleRangeActive()};c.prototype.destroy=function(){this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);this.graphicsCore=this.spatialIndex=this.extent=this.layerView=null};c.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&this.layerScaleRangeVisibilityDirty};c.prototype.canResume=
function(){return this.layerScaleRangeVisibility};c.prototype.setExtent=function(a){this.extent=a;this.layerScaleRangeVisibilityDirty=!0};c.prototype.idleUpdate=function(a){this.layerView.view.basemapTerrain&&!a.done()&&this.layerScaleRangeVisibilityDirty&&(this.updateSuspendScaleVisible(),this.layerScaleRangeVisibilityDirty=!1)};c.prototype.scaleRangeActive=function(){return this._scaleRangeActive};c.prototype.updateScaleRangeActive=function(){var a=this;if(!this.spatialIndex)return this._scaleRangeActive=
!1;var b=this.layer,c=!1;b.labelingInfo&&(c=c||b.labelingInfo.some(function(a){return a&&d(a.minScale,a.maxScale)}));c=c||d(b.minScale,b.maxScale);b=this._scaleRangeActive!==c;(this._scaleRangeActive=c)&&!this.scaleChangeEventHandle&&this.basemapTerrain?this.scaleChangeEventHandle=this.basemapTerrain.on("scale-change",function(b){return a.scaleUpdateHandler(b)}):!c&&this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);return b};c.prototype.updateSuspendScaleVisibleFinish=
function(a){this.layerScaleRangeVisibilityQuery=!1;this.layerScaleRangeVisibility!==a&&(this.layerScaleRangeVisibility=a,this.layerView._notifySuspendedChange())};c.prototype.updateSuspendScaleVisible=function(){var a=this,b=this.layerView.view.basemapTerrain;this.extent&&b&&this._scaleRangeActive?this.layerScaleRangeVisibilityQuery||(this.layerScaleRangeVisibilityQuery=!0,b.queryVisibleScaleRange(this.extent,this.layer.minScale,this.layer.maxScale,function(b){return a.updateSuspendScaleVisibleFinish(b)})):
this.updateSuspendScaleVisibleFinish(!0)};c.prototype.visibleAtScale=function(a,b,c){return null==a?!0:a>c&&(!b||a<b)};c.prototype.visibleAtLayerScale=function(a){return this.visibleAtScale(a,this.layer.minScale,this.layer.maxScale)};c.prototype.visibleAtLabelScale=function(a,b){return this.visibleAtScale(a,b.minScale,b.maxScale)};c.prototype.graphicScale=function(a,b){var c;b.centroid?c=b.centroid:"point"===a.geometry.type&&(c=a.geometry);return c?this.layerView.view.basemapTerrain?this.layerView.view.basemapTerrain.getScale(c):
1:null};c.prototype.graphicVisible=function(a,b){a=this.graphicScale(a,b);return this.visibleAtLayerScale(a)};c.prototype.updateGraphicScaleVisibility=function(a,b){return this._scaleRangeActive?(b.addedToSpatialIndex||this.spatialIndex.addGraphicToSpatialIndex(a,b),a=this.graphicVisible(a,b),b.setVisibilityFlag(1,a)):!1};c.prototype.updateGraphicLabelScaleVisibility=function(a,b){if(!this._scaleRangeActive||!b._labelGraphics||0===b._labelGraphics.length)return!1;b.addedToSpatialIndex||this.spatialIndex.addGraphicToSpatialIndex(a,
b);a=this.graphicScale(a,b);(b=this.updateLabelScaleVisibility(b,a))&&this.layerView.view.deconflictor.setDirty();return b};c.prototype.updateLabelScaleVisibility=function(a,b){if(!a._labelGraphics||0===a._labelGraphics.length)return!1;1<a._labelGraphics.length&&console.warn("Multiple label classes are not supported");var c=a._labelGraphics[0]._labelClass;return c&&null!=c.minScale&&null!=c.maxScale&&(b=this.visibleAtLabelScale(b,c),a.setVisibilityFlag(1,b,1))?!0:!1};c.prototype.scaleUpdateHandler=
function(a){var b=this;if(!this.layerView.suspended&&this.spatialIndex.hasGraphics()){var c=a.extent,d=a.scale;this.spatialIndex.intersects(c,a.spatialReference,function(a,e){for(var f=b.visibleAtLayerScale(d),g=!1,h=!1,k=0;k<e;k++){var m=b.graphicsCore.getGraphics3DGraphicById(a[k]);if(m){var t=m.centroid;t&&(c[0]>t.x||c[1]>t.y||c[2]<t.x||c[3]<t.y)||(t=!1,m.setVisibilityFlag(1,f)&&(t=!0),b.updateLabelScaleVisibility(m,d)&&(t=!0),t&&(h=!0,m.isDraped()&&(g=!0)))}}h&&b.layerView.view.deconflictor.setDirty();
g&&b.layerView._notifyDrapedDataChange()})}this.layerScaleRangeVisibilityDirty=!0};c.prototype.layerMinMaxScaleChangeHandler=function(){this.updateScaleRangeActive()&&(this._scaleRangeActive?this.graphicsCore.updateAllGraphicsVisibility():this.graphicsCore.forEachGraphics3DGraphic(function(a){return a.setVisibilityFlag(1,void 0)}));this.layerScaleRangeVisibilityDirty=!0};return c}()})},"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":function(){define("require exports ../../support/earthUtils ../../support/projectionUtils ../../support/intersectionUtils ../../lib/glMatrix".split(" "),
function(m,h,d,c,a,b){var k=b.vec3d,f=b.vec4d,g=-.3*d.earthRadius;m=.5*Math.PI;var e=m/Math.PI*180,l=m*d.earthRadius,p=.9*d.earthRadius,v=function(){function b(){this.extent=Array(4);this.planes=Array(4);this.maxSpan=0;this.center={origin:k.create(),direction:k.create()};for(var a=0;4>a;a++)this.extent[a]={origin:k.create(),originLength:0,direction:k.create(),cap:{next:null,direction:k.create()}},this.planes[a]=f.create();this.planes[4]=f.create()}b.prototype.update=function(a,b,d,e,f,g){var h=this.extent;
k.set3(a[0],a[1],g,h[0].origin);k.set3(a[2],a[1],g,h[1].origin);k.set3(a[2],a[3],g,h[2].origin);k.set3(a[0],a[3],g,h[3].origin);if(!f)for(f=0;4>f;f++)c.vectorToVector(h[f].origin,e,h[f].origin,d);k.add(h[0].origin,h[2].origin,this.center.origin);k.scale(this.center.origin,.5);b(this.center.origin,this.center.direction);for(f=0;4>f;f++)d=h[f],b(d.origin,d.direction),d.originLength=k.length(d.origin),e=h[3===f?0:f+1],d.cap.next=e.origin,k.direction(e.origin,d.origin,d.cap.direction),this._computePlane(d.cap.direction,
d.direction,d.origin,this.planes[f]);this._computePlane(h[1].cap.direction,h[0].cap.direction,h[0].origin,this.planes[4]);this.maxSpan=Math.max(Math.abs(a[0]-a[2]),Math.abs(a[1]-a[3]))};b.prototype.isVisibleInFrustumGlobal=function(a){if(0>k.dot(this.center.direction,a.direction))return!0;for(var b=0;4>b;b++)if(0>k.dot(this.extent[b].direction,a.direction))return!0;return!1};b.prototype.isVisibleInFrustum=function(b,c,d){if("global"===b.viewingMode){if(this.maxSpan>(b.spatialReference.isWGS84?e:l))return!0;
if(c.altitude()>=p)return this.isVisibleInFrustumGlobal(c)}for(b=0;b<this.extent.length;b++)if(d=this.extent[b],a.frustumRay(c.planes,d.origin,null,d.direction)||a.frustumLineSegment(c.planes,d.origin,d.cap.next,d.cap.direction))return!0;for(b=0;b<c.lines.length;b++)if(d=c.lines[b],a.frustumLineSegment(this.planes,d.origin,d.endpoint,d.direction))return!0;return!1};b.prototype._computePlane=function(a,b,c,d){k.cross(a,b,d);d[3]=-k.dot(d,c)};return b}();return function(){function a(){this.frustumVisibilityDirty=
this.frustumVisibility=!0;this.extent=null;this.extentEngine=new v;this.extentEngineDirty=!0;this.renderSREqualsViewSR=null;this._isVisibleBelowSurface=!1;this.layerView=null}a.prototype.initialize=function(a){this.layerView=a;this.renderSREqualsViewSR=a.view.renderSpatialReference.equals(a.view.spatialReference)};a.prototype.destroy=function(){this.extentEngine=this.extent=this.layerView=null};a.prototype.needsIdleUpdate=function(){return this.frustumVisibilityDirty};a.prototype.canResume=function(){return this.frustumVisibility};
a.prototype.setExtent=function(a){this.extent=a;this.frustumVisibilityDirty=this.extentEngineDirty=!0};a.prototype.viewChange=function(){this.frustumVisibilityDirty=!0};a.prototype.elevationBoundsChange=function(){this.extentEngineDirty=this.frustumVisibilityDirty=!0};Object.defineProperty(a.prototype,"isVisibleBelowSurface",{set:function(a){this._isVisibleBelowSurface=a;this.extentEngineDirty=this.frustumVisibilityDirty=!0},enumerable:!0,configurable:!0});a.prototype.idleUpdate=function(a){!a.done()&&
this.frustumVisibilityDirty&&(this.updateSuspendFrustumVisible(),this.frustumVisibilityDirty=!1)};a.prototype.updateExtentEngine=function(){if(this.extentEngineDirty){this.extentEngineDirty=!1;var a=this.layerView.view,b=a.renderCoordsHelper.worldUpAtPosition,c;if(this._isVisibleBelowSurface)c=g;else{c=a.basemapTerrain.getElevationBounds();var d=c[0];c=d-Math.max(1,(c[1]-d)*(1.2-1))}this.extentEngine.update(this.extent,b,a.renderSpatialReference,a.spatialReference,this.renderSREqualsViewSR,c)}};a.prototype.updateSuspendFrustumVisible=
function(){if(this.extent){this.updateExtentEngine();var a=this.layerView.view.getFrustum(),a=this.extentEngine.isVisibleInFrustum(this.layerView.view,a,this._isVisibleBelowSurface);a!==this.frustumVisibility&&(this.frustumVisibility=a,this.layerView._notifySuspendedChange())}else this.frustumVisibility=!0};return a}()})},"esri/views/3d/layers/graphics/Graphics3DVerticalScale":function(){define(["require","exports","../../../../geometry/support/scaleUtils"],function(m,h,d){return function(){function c(a){this.sourceSpatialReference=
a.sourceSpatialReference;this.destSpatialReference=a.destSpatialReference}c.prototype.adjust=function(a){var b=this._getVerticalUnitScale();1!==b&&(a=a.slice(),this._scaleVerticalUnits(a,b));return a};c.prototype._getVerticalUnitScale=function(){if(this.sourceSpatialReference&&!this.sourceSpatialReference.equals(this.destSpatialReference)){var a=d.getVerticalUnitValueForSR(this.sourceSpatialReference),b=d.getVerticalUnitValueForSR(this.destSpatialReference);return a/b}return 1};c.prototype._vertexListsScaleZ=
function(a,b){for(var c=0;c<a.length;++c)for(var d=a[c],g=0;g<d.length;++g)d[g][2]*=b};c.prototype._scaleVerticalUnits=function(a,b){for(var c=0;c<a.length;++c){var d=a[c].geometry;if(d.hasZ)this._geometryIsPoint(d)?null!==d.z&&(d.z*=b):this._geometryIsPolyline(d)?this._vertexListsScaleZ(d.paths,b):this._geometryIsPolygon(d)&&this._vertexListsScaleZ(d.rings,b);else break}};c.prototype._geometryIsPoint=function(a){return"point"===a.type};c.prototype._geometryIsPolygon=function(a){return"polygon"===
a.type};c.prototype._geometryIsPolyline=function(a){return"polyline"===a.type};return c}()})},"esri/views/3d/layers/graphics/Graphics3DHighlights":function(){define(["require","exports","./Graphics3DHighlightSet"],function(m,h,d){return function(){function c(){this.graphicsCore=null;this.highlights=[]}c.prototype.destroy=function(){this.highlights.forEach(function(a){return a.highlightSet.removeAll()});this.highlights=null};c.prototype.initialize=function(a){this.graphicsCore=a};c.prototype.acquireSet=
function(a,b){var c=this,f=new d(a,b);this.highlights.push(f);return{set:f,handle:{remove:function(){return c.releaseSet(f)}}}};c.prototype.releaseSet=function(a){a.highlightSet.removeAll();a=this.highlights?this.highlights.indexOf(a):-1;-1!==a&&this.highlights.splice(a,1)};c.prototype.setUids=function(a,b){var c=this.graphicsCore.graphics;b.forEach(function(b){a.ids.add(b);(b=c[b])&&b.addHighlight(a.highlightSet,a.options)})};c.prototype.setObjectIds=function(a,b){var c=this.graphicsCore.graphics;
b.forEach(function(b){return a.ids.add(b)});for(var d in c)(b=c[d])&&a.hasGraphic(b)&&b.addHighlight(a.highlightSet,a.options)};c.prototype.graphicCreated=function(a){this.highlights.forEach(function(b){b.hasGraphic(a)&&a.addHighlight(b.highlightSet,b.options)})};c.prototype.graphicDeleted=function(a){this.highlights.forEach(function(b){b.hasGraphic(a)&&a.removeHighlight(b.highlightSet)})};c.prototype.allGraphicsDeleted=function(){this.highlights.forEach(function(a){return a.highlightSet.removeAll()})};
return c}()})},"esri/views/3d/layers/graphics/Graphics3DHighlightSet":function(){define(["require","exports","../../webgl-engine/lib/HighlightSet"],function(m,h,d){return function(){function c(a,b){this.highlightSet=new d;this.ids=new Set;this.options=a;this.objectIdField=b}c.prototype.hasGraphic=function(a){return this.objectIdField?this.ids.has(a.graphic.attributes[this.objectIdField]):this.ids.has(a.graphic.uid)};return c}()})},"esri/views/3d/webgl-engine/lib/HighlightSet":function(){define(["require",
"exports"],function(m,h){return function(){function d(){this.items=[]}d.prototype.addObject=function(c,a){this.items.push({type:"object",highlightId:a,object:c})};d.prototype.addRenderGeometry=function(c,a,b){this.items.push({type:"renderGeometry",highlightId:b,renderGeometry:c,renderer:a})};d.prototype.removeObject=function(c){for(var a=this.items.length-1;0<=a;--a){var b=this.items[a];"object"===b.type&&b.object===c&&(b.object.removeHighlights(b.highlightId),this.items.splice(a,1))}};d.prototype.removeRenderGeometry=
function(c){for(var a=this.items.length-1;0<=a;--a){var b=this.items[a];"renderGeometry"===b.type&&b.renderGeometry===c&&(b.renderer.removeRenderGeometryHighlight(b.renderGeometry,b.highlightId),this.items.splice(a,1))}};d.prototype.removeAll=function(){this.items.forEach(function(c){"object"===c.type?c.object.removeHighlights(c.highlightId):"renderGeometry"===c.type&&c.renderer.removeRenderGeometryHighlight(c.renderGeometry,c.highlightId)});this.items=[]};return d}()})},"esri/views/3d/layers/support/attributeUtils":function(){define(["require",
"exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});h.attributeLookup=function(d,c){c=c.toLowerCase();for(var a=0,b=Object.keys(d);a<b.length;a++){var h=b[a];if(h.toLowerCase()===c)return d[h]}return null}})},"esri/renderers/support/renderingInfoUtils":function(){define(["require","exports"],function(m,h){function d(a,b){if(!a||a.symbol)return null;b=b.renderer;return a&&b&&b.getObservationRenderer?b.getObservationRenderer(a):b}function c(a,b){if(a.symbol)return a.symbol;var c=
d(a,b);return c&&c.getSymbol(a,b)}Object.defineProperty(h,"__esModule",{value:!0});h.getRenderer=d;h.getSymbol=c;h.getRenderingInfo=function(a,b){var h=d(a,b),f=c(a,b);if(!f)return null;f={renderer:h,symbol:f};if(h){h.colorInfo&&(f.color=h.getColor(a).toRgba());if(h.sizeInfo){var g=h.getSize(a);f.size=[g,g,g]}if(h.visualVariables){a=h.getVisualVariableValues(a,b);g=["proportional","proportional","proportional"];for(b=0;b<a.length;b++){var e=a[b],h=e.variable,l=e.value;"color"===h.type?f.color=l.toRgba():
"size"===h.type?"outline"===h.target?f.outlineSize=l:(e=h.axis,h=h.useSymbolValue?"symbolValue":l,"width"===e?g[0]=h:"depth"===e?g[1]=h:"height"===e?g[2]=h:g[0]="width-and-depth"===e?g[1]=h:g[1]=g[2]=h):"opacity"===h.type?f.opacity=l:"rotation"===h.type&&"tilt"===h.axis?f.tilt=l:"rotation"===h.type&&"roll"===h.axis?f.roll=l:"rotation"===h.type&&(f.heading=l)}if(isFinite(g[0])||isFinite(g[1])||isFinite(g[2]))f.size=g}}return f}})},"esri/views/3d/layers/support/projectExtentUtils":function(){define("require exports ../../../../portal/support/geometryServiceUtils ../../../../core/promiseUtils ../../../../tasks/support/ProjectParameters ../../../../geometry/support/webMercatorUtils".split(" "),
function(m,h,d,c,a,b){Object.defineProperty(h,"__esModule",{value:!0});h.toView=function(h){var f=h.view.spatialReference,g=h.layer.fullExtent&&h.layer.fullExtent.spatialReference;return!g||g.equals(f)||"local"!==h.view.viewingMode?c.resolve(null):b.canProject(g,f)?c.resolve(b.project(h.layer.fullExtent,f)):d.create(h.layer.portalItem).then(function(b){var c=new a;c.geometries=[h.layer.fullExtent];c.outSR=f;return b.project(c)}).then(function(a){if(!h.destroyed&&a&&Array.isArray(a)&&1===a.length)return a[0]}).otherwise(function(){return null})}})},
"esri/views/3d/layers/SceneLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../layers/IntegratedMeshLayer ../../../core/arrayUtils ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Logger ../../../core/Collection ../../../core/lang dojo/_base/lang dojox/color/_base dojo/has ../../layers/LayerView ../../../Graphic ../../../symbols/Symbol3D ../../../tasks/support/Query ./i3s/I3SUtil ./i3s/I3SBinaryReader ./i3s/I3SElevationProvider ./i3s/I3SProjectionUtil ./i3s/I3SQueryEngine ./i3s/Highlights ./i3s/FeatureChangeNotifier ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../support/projectionUtils ../support/aaBoundingBox ../webgl-engine/Stage ../webgl-engine/lib/Layer ../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../webgl-engine/lib/Object3D ../webgl-engine/lib/Texture ../webgl-engine/materials/Material ./support/attributeUtils ../webgl-engine/lib/Util ../webgl-engine/lib/base64Binary ../lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I,F,N,L,M,K,ba,X,T,V,P,W,U){function Y(a,b,c,d){var e=!1,f;b.encoding===z.DDS_ENCODING_STRING?f=X.DDS_ENCODING:e=!(P.isPowerOfTwo(a.width)&&P.isPowerOfTwo(a.height));a=b.usedByEngineMats.some(function(a){return a.getParams().atlasRegions})||b.atlas;c=(c||!a)&&!e;return{mipmap:c,wrapClamp:a||!b.wrap,disableAnisotropy:a&&c&&d,encoding:f,noUnpackFlip:!0}}var S=N.ModelContentType,ca=e.getLogger("esri.layers.SceneService"),ga=[1,1,1,1],ea=
[.8,.8,.8],aa=[.5,.5,.5];m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._queryEngine=null;b._controllerCreated=!1;b._highlights=new E(b);b._hasColors=!1;b._hasTextures=!1;b._hasData=!1;b._definitionExpressionErrors=0;b._maxDefinitionExpressionErrors=20;return b}d(c,a);Object.defineProperty(c.prototype,"hasTexturesOrVertexColors",{get:function(){return this._hasData?this._hasTextures||this._hasColors?"yes":"probably-not":"unknown"},enumerable:!0,configurable:!0});c.prototype.initialize=
function(){var a=this;z.checkSceneLayerValid(this.layer);z.checkSceneLayerCompatibleWithView(this.layer,this.view);var b=this.layer.version,b=!n("trident")||1<b.major||1===b.major&&3<b.minor;this.useCompressedTextures=this.view.has("s3tc")&&b;this._disableAtlasAnisotropy=(this._enableAtlasMipMaps=this.view.has("standardDerivatives"))&&!this.view.has("shaderTextureLOD");this._initGraphicsController();this.dbg=!1;this.maxGpuMemory=1E3;this.geoMemoryEstimate=this.texMemoryEstimate=this.gpuMemoryEstimate=
0;this._stage=this.view._stage;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._colorOverride=null;for(var b=new Uint8Array(256),c=0;c<b.length;c++)b[c]=255;this._whiteTexture=new X(b,"white",{width:8,height:8});this._stage.add(S.TEXTURE,this._whiteTexture);this._addThisLayerToStage();this._elevationProvider=new C(this,this._engineLayer);this._layerEventHandles=[f.init(this.layer,"renderer",function(b){return a._rendererChange(b)}),f.watch(this,"fullOpacity",
function(b){return a._opacityChange(b)}),f.init(this.layer,"objectIdFilter",function(){return a._filterChange()}),f.init(this,"_controller.parsedDefinitionExpression",function(){return a._filterChange()}),f.init(this.view,"clippingArea",function(){return a._clippingAreaChanged()}),f.init(this,"suspended",function(b){return a.setVisibility(!b)})];this.debugLODVis=this.debugNodeVis=!1};c.prototype.destroy=function(){this._stage.remove(S.TEXTURE,this._whiteTexture.getId());this._removeThisLayerFromStage();
this._layerEventHandles.forEach(function(a){a.remove()});this._stage=null;null!=this._controller&&(this._controller.destroy(),this._controller=null);this._highlights.destroy();this._nodeId2Meta=this._texId2Meta=this._matId2Meta=null};c.prototype.canResume=function(){return this.inherited(arguments)&&(!this._controller||this._controller.rootNodeVisible)};c.prototype.isUpdating=function(){return this._controllerCreated?!(!this._controller||!this._controller.updating):!0};c.prototype.memEstimateTextureAdded=
function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate+=a;this.texMemoryEstimate+=a};c.prototype.memEstimateTextureRemoved=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate-=a;this.texMemoryEstimate-=a};c.prototype.memEstimateGeometryAdded=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate+=a;this.geoMemoryEstimate+=a};c.prototype.memEstimateGeometryRemoved=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate-=a;this.geoMemoryEstimate-=
a};c.prototype.isBundleAlreadyAddedToStage=function(a,b){return this._nodeId2Meta[a.id]&&this._nodeId2Meta[a.id].engineObjectsPerBundle&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle[b]};c.prototype._initGraphicsController=function(){var a=this,b={addBundle:this._addBundle.bind(this),isBundleAlreadyAddedToStage:function(b,c){return a.isBundleAlreadyAddedToStage(b,c)},isOverMemory:function(){return a.isOverMemory()},removeNodeData:function(b){return a._removeNodeDataFromStage(b)},removeFeatures:function(b,
c){return a._removeFeatures(b,c)},getAddedFeatures:function(b){return a._getAddedFeatures(b)},getAddedNodeIDs:function(){return a._getAddedNodeIDs()},areAllBundlesLoaded:function(b){return a._areAllBundlesLoaded(b)},wholeNodeSwitchEnabled:!0};this.layer.createGraphicsController({layerView:this,layerViewRequiredFunctions:b,layerViewOptionalFunctions:{additionalStartNodeLoadingHandler:function(){return a._startNodeLoading()},additionalCancelNodeLoadingHandler:function(){return a.cancelNodeLoading()},
getTexturePrefetchFunctions:function(){return{_calcDesiredTextureLOD:function(b,c){return a._calcDesiredTextureLOD(b,c)},_imageIsPartOfTextureBundle:function(b){return a._imageIsPartOfTextureBundle(b)},_matId2Meta:a._matId2Meta,_texId2Meta:a._texId2Meta,useCompressedTextures:function(){return a.useCompressedTextures}}},_nodeDebugVisualizer:this._nodeDebugVisualizer,setPolygonOffset:function(b,c){return a._setPolygonOffset(b,c?1:0)},traversalOptions:{initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1,
allowPartialOverlaps:!1},getLoadedAttributes:function(b){return a.getLoadedAttributes(b)},setAttributeData:function(b,c,d){return a.setAttributeData(b,c,d)}}}).then(function(b){a._controller=b;a._featureChangeNotifier=new H.FeatureChangeNotifier(a,b);b.watch("rootNodeVisible",function(){a.notifyChange("suspended")})}).always(function(){a._controllerCreated=!0;a.notifyChange("updating")})};c.prototype.setMaxGpuMemory=function(a){this.maxGpuMemory=a};c.prototype.setVisibility=function(a){if(this._stage&&
this._engineLayer){var b=this._engineLayer.getId(),c=0<=this._stage.getViewContent().indexOf(b);!!a!==c&&(b=[b],null!=this._nodeDebugVisualizer&&b.push(this._nodeDebugVisualizer.engineLayer.getId()),a?(this._stage.addToViewContent(b),a=this._isIntegratedMesh()?"im":"scene",this.view.elevationProvider.register(a,this._elevationProvider),this._elevationProvider.visibilityChanged()):(this._stage.removeFromViewContent(b),this._elevationProvider.visibilityChanged(),this.view.elevationProvider.unregister(this._elevationProvider)))}};
c.prototype.getEngineLayer=function(){return this._engineLayer};c.prototype.getStats=function(){var a={nodesInIndex:0,knownFeatures:0,activeMaterials:0,"Total GPU Memory Estimate":this.gpuMemoryEstimate+"MB","Geometry Memory Estimate":this.geoMemoryEstimate+"MB","Texture Memory Estimate":this.texMemoryEstimate+"MB"};if(!this._controller)return a;for(var b=0,c=Object.keys(this._controller.nodeIndex);b<c.length;b++){var d=c[b];a.nodesInIndex++;d=this._controller.nodeIndex[d];null!=d.features&&(a.knownFeatures+=
d.features.length)}a.activeMaterials=Object.keys(this._matId2Meta).length;return a};c.prototype._addThisLayerToStage=function(){var a=this._stage;this._initTexture=new X(null,"i3sInitTexture");a.add(S.TEXTURE,this._initTexture);var b=this.layer.id;this._engineLayer=b=new L(b,{},b);a.add(S.LAYER,b);null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose()};c.prototype._removeThisLayerFromStage=function(){this.cancelNodeLoading();if(null!=this._engineLayer){var a=this._stage;a.remove(S.TEXTURE,
this._initTexture.getId());if(null!=this._controller)for(var b in this._controller.nodeIndex)this._controller.nodeIndex.hasOwnProperty(b)&&(this._removeNodeDataFromStage(this._controller.nodeIndex[b]),delete this._controller.nodeIndex[b]);P.assert(P.objectEmpty(this._nodeId2Meta));P.assert(P.objectEmpty(this._matId2Meta));P.assert(P.objectEmpty(this._texId2Meta));a.remove(S.LAYER,this._engineLayer.getId());null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose();this._nodeDebugVisualizer=
void 0;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._engineLayer=void 0;this.gpuMemoryEstimate=0}};c.prototype._startNodeLoading=function(){this._updateAllTextureLOD()};c.prototype.cancelNodeLoading=function(){null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.clear();this._requestedTexImageIds={}};c.prototype._isAllHidden=function(a){a=this._nodeId2Meta[a.id].engineObjects;for(var b=0;b<a.length;b++)if(!a[b].isAllHidden())return!1;return!0};
c.prototype.getLoadedAttributes=function(a){if((a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length)return a.engineObjects[0].getMetadata().loadedAttributes};c.prototype.setAttributeData=function(a,b,c){var d=this._nodeId2Meta[a.id];if(d&&1===d.engineObjects.length){var d=d.engineObjects[0],e=d.getMetadata();e.loadedAttributes=b;e.attributeData=c;this._setObjectSymbology(d);this._applyFilters(a);this._elevationProvider.visibilityChanged(d)}};c.prototype._createUnitTestData=function(a){var b=this.view.navigation.targetCamera,
b={viewParams:{eye:b.eye,center:b.center,up:b.up,viewMatrix:b.viewMatrix,projectionMatrix:b.projectionMatrix,fovX:b.fovX,viewport:b.viewport,perPixelRatio:b.perPixelRatio},visibleObjects:[]};a=a.getAll("objects");for(var c in a){var d=a[c];if(d.getParentLayer()===this._engineLayer){var e=d.getMetadata(),d=e.i3sNode,e=e.features.map(function(a){return a.id});e.sort();b.visibleObjects.push({featureIDs:e,nodeId:d})}}console.debug(""+b.visibleObjects.length);return JSON.stringify(b)};c.prototype.isOverMemory=
function(){if(this.gpuMemoryEstimate>this.maxGpuMemory&&this.gpuMemoryEstimate!==this.warnGpuMemoryEstimate){this.warnGpuMemoryEstimate=this.gpuMemoryEstimate;var a=function(a){return a.toLocaleString(void 0,{maximumFractionDigits:1})+" Mb"};ca.warn("GPU Memory Limit exceeded!\nLimit: "+a(this.maxGpuMemory)+" Current: "+a(this.gpuMemoryEstimate)+"\n(Textures: "+a(this.texMemoryEstimate)+" Geometry: "+a(this.geoMemoryEstimate)+")")}return this.gpuMemoryEstimate>this.maxGpuMemory};c.prototype._getAddedFeatures=
function(a){if(null==this._nodeId2Meta[a])return null;var b=[];a=this._nodeId2Meta[a].engineObjects;for(var c=0;c<a.length;c++)b=b.concat(a[c].getMetadata().features);return b};c.prototype._getAddedNodeIDs=function(){return Object.keys(this._nodeId2Meta)};c.prototype._calcEngineMaterialTransparencyParams=function(a,b,c){var d=this.fullOpacity,e=1-P.clamp(P.fallbackIfUndefined(b.transparency,0),0,1);a=1>e||1>d||a&&p.endsWith(a.channels,"a")||!0===b.useVertexColorAlpha||c;return{opacity:e,layerOpacity:d,
transparent:a}};c.prototype._calcEngineMaterialDoubleSidedParams=function(a){return null!=a.doubleSided?a.doubleSided:!0};c.prototype._calcEngineMaterialCullFaceParams=function(a){return a.cullFace?a.cullFace:null!=a.doubleSided?a.doubleSided?"none":"back":"none"};c.prototype._createEngineMaterial=function(a,b,c,d,e,f){var g,h;null!=a&&(g=(h=this._texId2Meta[b])&&h.engineTex?h.engineTex.getId():this._initTexture.getId());var k=c.params,l=P.fallbackIfUndefined(k.diffuse,ea),m,n;null!=a&&(n=z.getAppropriateTextureEncoding(a.encoding,
this.useCompressedTextures),m=-1<n?a.encoding[n]:a.encoding);"standard"!==c.type&&ca.warn("Unknown material type '"+c.type+"', must be 'standard'");void 0===k.reflectivity&&ca.warn("Material parameter 'reflectivity' is missing.");c=this._isIntegratedMesh();g={ambient:this._colorOverride||l,diffuse:this._colorOverride||l,specular:P.fallbackIfUndefined(k.specular,aa),shininess:P.fallbackIfUndefined(k.shininess,64),atlasRegions:k.vertexRegions,textureId:g&&this._colorOverride?this._whiteTexture.getId():
g,vertexColors:this._hasVertexColors(),symbolColors:this._hasSymbolColors(),flipV:!1,doubleSided:this._calcEngineMaterialDoubleSidedParams(k),cullFace:this._calcEngineMaterialCullFaceParams(k),writeStencil:c,receiveSSAO:!c,groundNormalShading:c};c||(l=this._calcEngineMaterialTransparencyParams(a,k),v.mixin(g,l));g=new T(g,d);g.metadata={i3sMatId:d,i3sTexId:b,i3sTex:a,i3sMatParams:k};if(null!=a){h?h.usedByEngineMats.push(g):(h={id:b,featureMBS:[],usedByEngineMats:[g],images:a.images,encoding:m,encodingIdx:n,
atlas:!0===a.atlas,wrap:"none"!==a.wrap[0]||"none"!==a.wrap[1]},this._texId2Meta[b]=h);for(a=0;a<e.length;a++)h.featureMBS.push(e[a].engineMBS);if(void 0!==f[b]){null==h.engineTex&&(e=f[b].data,a=Y(e,h,this._enableAtlasMipMaps,this._disableAtlasAnisotropy),h.engineTex=new X(e,h.id,a),this._stage.add(S.TEXTURE,h.engineTex),h.desiredLOD=f[b].desiredLOD,h.curLOD=h.desiredLOD,this.memEstimateTextureAdded(h.engineTex));e=h.engineTex.getId();for(a=0;a<h.usedByEngineMats.length;a++)k=h.usedByEngineMats[a],
null==this._colorOverride&&k.setParameterValues({textureId:e}),k.metadata.originalTextureId=e;f[b].createdTextureForDomImage();delete f[b]}else this._updateTextureLOD(h)}this._matId2Meta[d]||(this._matId2Meta[d]={});this._matId2Meta[d][b]={engineMat:g,refCount:1};return g};c.prototype._createVertexArrays=function(a,b){var c=a.params.vertexAttributes;a={};for(var d=0,e=Object.keys(c);d<e.length;d++){var f=e[d];if("classification"!==f){var g=c[f],h=B.valueType2TypedArrayClassMap[g.valueType];P.assert(null!=
h,"unsupported vertex attribute value type: "+g.valueType);a[f]={data:new h(b,g.byteOffset,g.count*g.valuesPerElement),size:g.valuesPerElement}}}b=Array.isArray(c.position)?c.position.length/3:c.position.count;if(this._hasVertexColors()&&null==a[P.VertexAttrConstants.COLOR])for(c=new Uint8Array(4*b),a[P.VertexAttrConstants.COLOR]={data:c,size:4},d=0;d<c.length;d++)c[d]=255;this._hasSymbolColors()&&(c=new Uint8Array(4*b),a[P.VertexAttrConstants.SYMBOLCOLOR]={data:c,size:4});null==a[P.VertexAttrConstants.NORMAL]&&
(c=new Float32Array(3*b),a[P.VertexAttrConstants.NORMAL]={data:c,size:3});return a};c.prototype._hasNonWhiteColors=function(a){if("color"in a){a=a.color.data;for(var b=0;b<a.length;b++)if(255!==a[b])return!0}return!1};c.prototype._createEngineMats=function(a,b,c,d,e){for(var f=a.params.components.length,g=Array(f),h=0;h<f;h++){var k=a.params.components[h],l=k.materialID,m=c.materialDefinitions[l];null!=m.href&&(m=d[m.hrefConcat].materialDefinitions[l]);P.assert(void 0!==m,"geometry wants unknown material "+
l);var n=k.textureID||"none",p=void 0;"none"!==n&&(null!=c.textureDefinitions&&null!=c.textureDefinitions[n]||ca.warn("textureDefinitions missing in shared resource"),p=c.textureDefinitions[n]);k=void 0;this._matId2Meta[l]&&this._matId2Meta[l][n]?(l=this._matId2Meta[l][n],k=l.engineMat,l.refCount++):k=this._createEngineMaterial(p,n,m,l,b,e);g[h]=k}return g};c.prototype._areAllBundlesLoaded=function(a){if(null==this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjectsPerBundle)return!1;
for(var b=0;b<a.featureData.length;b++)if(null==this._nodeId2Meta[a.id].engineObjectsPerBundle[b])return!1;return!0};c.prototype._getObjectIdField=function(){return this.layer.objectIdField||"OBJECTID"};c.prototype._findGraphicNodeAndIndex=function(a){a=V.attributeLookup(a.attributes,this._getObjectIdField());for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)for(var d=c[b],e=this._nodeId2Meta[d].engineObjects,f=0;f<e.length;f++){var g=e[f].getMetadata().featureIds.indexOf(a);if(-1!==g)return{node:this._controller.nodeIndex[d],
nodeId:d,bundleNr:f,index:g}}return null};c.prototype._getGraphicIndices=function(a,b,c){a=this._nodeId2Meta[a.id].engineObjects;if(!a||!a[b])return[];b=a[b].getMetadata();a=[];for(var d=this._getObjectIdField(),e=0;e<c.length;e++){var f=V.attributeLookup(c[e].attributes,d),f=b.featureIds.indexOf(f);-1!==f&&a.push(f)}return a};c.prototype.whenGraphicBounds=function(a){a=this._findGraphicNodeAndIndex(a);if(null!=a&&(a=this._boundingBoxCornerPoints(a.index,this._nodeId2Meta[a.nodeId].engineObjects[a.bundleNr],
new Float64Array(24)),I.bufferToBuffer(a,this.view.renderSpatialReference,0,a,this.view.spatialReference,0,8))){var b=F.create(F.NEGATIVE_INFINITY);F.expandBuffer(b,a,0,8);return g.resolve({boundingBox:b,screenSpaceObjects:[]})}return g.reject()};c.prototype.whenGraphicAttributes=function(a,b){var c=this;return z.whenGraphicAttributes(this.layer,[a],this._getObjectIdField(),b,function(){var b=c._findGraphicNodeAndIndex(a);return{node:b.node,indices:[b.index]}}).then(function(a){return a[0]})};c.prototype.getGraphicsFromStageObject=
function(a,c){if(this.layer instanceof b)return g.reject();var d=a.getMetadata();a=a.getFaceRangeIndexFromTriangleNr(c);return null!=a&&null!=d.featureIds&&a<d.featureIds.length?(d=this._createGraphic(a,d),g.resolve(d)):g.reject()};c.prototype._addBundle=function(a,b,c,d,e,f,g){!this._hasTextures&&null!=a.textureData&&0<a.textureData.length&&(this._hasTextures=!0);this._hasData=!0;if(!0===this.debugNodeVis&&null!=this._nodeDebugVisualizer){var h="grey";switch(a.level){case 1:h="red";break;case 2:h=
"green";break;case 3:h="blue";break;case 4:h="yellow";break;case 5:h="magenta";break;case 6:h="brown"}this._nodeDebugVisualizer.show(a,this._controller.crsIndex,h)}var h=this._stage,k={};k[S.OBJECT]={};k[S.GEOMETRY]={};k[S.MATERIAL]={};k[S.TEXTURE]={};var l=this._engineLayer,m=l.getId(),n=d[a.sharedResource.hrefConcat];if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle&&this._nodeId2Meta[a.id].engineObjectsPerBundle[g])this._applyFilters(a),null!=e&&e.done();else if(!this.isOverMemory())if(null==
this._nodeId2Meta[a.id]&&(this._nodeId2Meta[a.id]={engineObjects:[],engineObjectsPerBundle:[]}),this._nodeId2Meta[a.id].engineObjectsPerBundle[g]=[],null==b)null!=e&&e.done();else{for(var p=0,q=0;q<b.length;q++){var t=b[q],r=t.faceRanges,w=t.componentOffsets,u=t.geometries,v=t.featureIds,x=t.features,B=d[a.geometryData[g].hrefConcat];P.assert(B instanceof ArrayBuffer,"I3S: geometry data is not an ArrayBuffer");null==B._isReprojected&&(B._isReprojected={});for(var C=a.id+"|"+x[0].id.toString(),D=[],
E=[],F=[],H=void 0,t=function(b){var c=u[b],e=G._createVertexArrays(c,B);!G._hasColors&&G._hasNonWhiteColors(e)&&(G._hasColors=!0);var g=new K(e,K.DefaultIndices,w||K.DefaultOffsets),h=G._createEngineMats(c,x,n,d,f),l=G._controller.crsIndex,m=G.view.renderSpatialReference;H=A.reprojectPoints(G._controller.isMeshPyramid?A.ReprojectionTypes.PER_VERTEX:A.ReprojectionTypes.BOUNDINGBOX,e.position.data,a.mbs,B._isReprojected[c.id],l,G._controller.crsVertex,m);B._isReprojected[c.id]=!0;G._controller.isMeshPyramid&&
z.processNormals({normals:g.vertexAttributes.normal.data,positions:g.vertexAttributes.position.data,normalInd:g.indices.normal,positionInd:g.indices.position},G.layer.normalReferenceFrame||"none",function(b,c){A.reprojectNormalsPerVertex(b,a.mbs,l,c,m)});e=H.localTrafo;null!=c.transformation&&(e=U.mat4d.create(c.transformation),U.mat4d.multiply(H.localTrafo,e,e));for(c=0;c<h.length;c++){var p=h[c];k[S.MATERIAL][p.getId()]=p}g=new M(g,C+"_"+b);G.memEstimateGeometryAdded(g.getData());k[S.GEOMETRY][g.getId()]=
g;D[b]=g;E[b]=e;F[b]=h},G=this,Q=0;Q<u.length;++Q)t(Q);r={i3sNode:a.id,ceLayer:m,features:x,faceRanges:r,featureIds:v,attributeData:c?c.attributeData:null,loadedAttributes:c?c.loadedAttributes:null,layerId:this.layer.id};p+=null!=r.featureIds?r.featureIds.length:1;r=new ba({idHint:a.id,name:C,geometries:D,materials:F,transformations:E,castShadow:!0,metadata:r});v=U.mat4d.create();U.mat4d.identity(v);U.mat4d.multiply(v,H.globalTrafo,v);r.setObjectTransformation(v);this._nodeId2Meta[a.id].engineObjectsPerBundle[g].push(r);
this._nodeId2Meta[a.id].engineObjects.push(r);k[S.OBJECT][r.getId()]=r;this._setObjectSymbology(r);this._applyFilters(a);this._highlights.objectCreated(r);this._elevationProvider.objectCreated(r)}h.beginMod();b=k[S.OBJECT];for(var I in b)b.hasOwnProperty(I)&&l.addObject(b[I]);for(var ja in k)if(k.hasOwnProperty(ja)){I=k[ja];for(var J in I)I.hasOwnProperty(J)&&null==h.get(ja,J)&&h.add(ja,I[J])}h.endMod();null!=e&&e.done();this.notifyChange("hasTexturesOrVertexColors");this._featureChangeNotifier.notify(p,
0)}};c.prototype._clippingAreaChanged=function(){var a=this,b=[];I.extentToBoundingBox(this.view.clippingArea,b,this.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null;this._updateFilters();if(this._controller){var c=this._controller.nodeIndex;c&&Object.keys(this._nodeId2Meta).forEach(function(b){return a._applyFilters(c[b])});this._controller.updateClippingArea(this.view.clippingArea)}};c.prototype._filterChange=function(){this._updateFilters();if(this._controller){var a=this._controller.nodeIndex;
if(a)for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)this._applyFilters(a[c[b]])}};c.prototype._updateFilters=function(){var a=this,b=[];if(this.layer.objectIdFilter){var c=new Float64Array(this.layer.objectIdFilter.ids),d="include"===this.layer.objectIdFilter.method;c.sort();b.push(function(b,e){return a._objectIdFilter(c,d,e)})}if(this._controller&&this._controller.parsedDefinitionExpression&&this._controller.definitionExpressionFields){this._definitionExpressionErrors=0;var e=this._controller.parsedDefinitionExpression,
f=this._controller.definitionExpressionFields;b.push(function(b,c){return a._sqlFilter(b,e,f,c)})}this._clippingArea&&b.push(function(b,c){return a._boundingboxFilter(b,a._clippingArea,c)});this._filters=b};c.prototype._sqlFilter=function(a,b,c,d){var e={},f=new u(null,null,e);f.layer=this.layer;var g=0,h=0,k=function(a){var k=a.getMetadata();a=k.featureIds;for(var m=k.attributeData,k=c.every(function(a){return null!=m[a]}),n=0;n<a.length&&g<d.length;n++)if(d[g]===a[n]){var p=!0;if(k){for(var p=0,
q=c;p<q.length;p++){var t=q[p];e[t]=z.getCachedAttributeValue(m[t],n)}p=l._evaluateClause(b,f)}p&&(d[h]=d[g],h++);g++}},l=this,m=0;for(a=this._nodeId2Meta[a.id].engineObjects;m<a.length;m++)k(a[m]);d.length=h};c.prototype._evaluateClause=function(a,b){try{return a.testFeature(b)}catch(Q){return this._definitionExpressionErrors<this._maxDefinitionExpressionErrors&&ca.error("Error while evaluating definitionExpression: "+Q),this._definitionExpressionErrors++,this._definitionExpressionErrors===this._maxDefinitionExpressionErrors&&
ca.error("Further errors are ignored"),!1}};c.prototype._objectIdFilter=function(a,b,c){for(var d=0,e=0;d<c.length;)0<=k.binaryIndexOf(a,c[d])===b&&(c[e]=c[d],e++),d++;c.length=e};c.prototype._boundingboxFilter=function(a,b,c){var d=[0,0,0,0];I.mbsToMbs(a.mbs,this._controller.crsIndex,d,this.view.renderSpatialReference);d=null!=b?z.intersectBoundingBoxWithMbs(b,d):2;if(2!==d){var e=0,f=0;for(a=this._nodeId2Meta[a.id].engineObjects;f<a.length;f++){var g=a[f],h=g.getMetadata().featureIds;if(0===d){for(var k=
0,g=0;g<h.length&&e+k<c.length;g+=1)c[e+k]===h[g]&&k++;c.splice(e,k)}else{var l=g.getObjectTransformation(),k=g.getGeometryRecords()[0].getShaderTransformation();U.mat4d.multiply(l,k);if(0===l[1]&&0===l[2]&&0===l[3]&&0===l[4]&&0===l[6]&&0===l[7]&&0===l[8]&&0===l[9]&&0===l[11]&&1===l[15])for(var k=(b[0]-l[12])/l[0],m=(b[1]-l[13])/l[5],n=(b[2]-l[14])/l[10],p=(b[3]-l[12])/l[0],q=(b[4]-l[13])/l[5],l=(b[5]-l[14])/l[10],t=g.getGeometryRecords()[0].geometry.getData(),r=t.getFaces()[0].indices.position,t=
t.getVertexAttr().position.data,u=g.getMetadata().faceRanges,v=void 0,x=void 0,B=void 0,A=void 0,C=void 0,D=void 0,g=0;g<u.length&&e<c.length;g+=1)if(c[e]===h[g]){for(var v=u[g],E=v[0],F=v[1],v=x=B=Number.MAX_VALUE,A=C=D=-Number.MAX_VALUE;E<=F;E+=1)for(var G=0;3>G;G+=1)var H=3*r[3*E+G],Q=t[H],J=t[H+1],H=t[H+2],v=Math.min(Q,v),x=Math.min(J,x),B=Math.min(H,B),A=Math.max(Q,A),C=Math.max(J,C),D=Math.max(H,D);v>p||A<k||x>q||C<m||B>l||D<n?c.splice(e,1):e++}}}}};c.prototype._applyFilters=function(a){if(this._nodeId2Meta[a.id]&&
null!=this._nodeId2Meta[a.id].engineObjects){for(var b=this._nodeId2Meta[a.id].engineObjects,c=0;c<b.length;c++){var d=b[c];d.unhideAllComponents()}if(0!==this._filters.length){for(var c=[],e=0;e<b.length;e++)d=b[e],c=c.concat(d.getMetadata().featureIds);d=c.length;for(e=0;e<this._filters.length;e++)this._filters[e](a,c);if(c.length!==d)for(e=a=0;e<b.length;e++)for(var d=b[e],f=d.getGeometryRecords()[0],g=d.getMetadata().featureIds,h=0;h<g.length;h+=1){var k=g[h];a>=c.length||c[a]!==k?d.setComponentVisibility(f,
h,!1):a++}}}};c.prototype._hideFeatures=function(a,b){var c=0;for(a=this._nodeId2Meta[a.id].engineObjects;c<a.length;c++)for(var d=a[c],e=d.getGeometryRecords()[0],f=d.getMetadata().features,g=d.hasComponents(),h=0,k=b;h<k.length;h++)for(var l=k[h],m=0;m<f.length;m++)l===f[m].id&&(g?d.setComponentVisibility(e,m,!1):d.hideAllComponents())};c.prototype._removeFeatures=function(a,b){null!=this._nodeId2Meta[a.id]&&(this._hideFeatures(a,b),!0===this._isAllHidden(a)&&this._removeNodeDataFromStage(a))};
c.prototype._removeNodeDataFromStage=function(a){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjects){for(var b=this._stage,c=this._engineLayer,d=0,e=this._nodeId2Meta[a.id].engineObjects,f=0;f<e.length;++f){var g=e[f];this._highlights.objectDeleted(g);this._elevationProvider.objectDeleted(g);var h=g.getMetadata(),d=d+(null!=h.featureIds?h.featureIds.length:1);c.removeObject(g);for(var h=g.getGeometryRecords(),k=0;k<h.length;k++){var l=h[k];this.memEstimateGeometryRemoved(l.geometry.getData());
b.remove(S.GEOMETRY,l.geometry.getId());for(var m=0;m<l.materials.length;m++){var n=l.materials[m],p=n.getId(),q=n.metadata.i3sMatId,t=n.metadata.i3sTexId||"none",r=this._matId2Meta[q][t];P.assert(0<r.refCount);r.refCount--;0===r.refCount&&this._removeMaterial(p,t,q,n,b)}}b.remove(S.OBJECT,g.getId())}delete this._nodeId2Meta[a.id];this._featureChangeNotifier.notify(0,d)}};c.prototype._removeMaterial=function(a,b,c,d,e){e.remove(S.MATERIAL,a);if("none"!==b){a=this._texId2Meta[b];var f=a.usedByEngineMats;
d=f.indexOf(d);P.assert(-1<d);f[d]=f[f.length-1];f.pop();1>f.length&&((d=a.engineTex)&&d!==this._initTexture&&(this.memEstimateTextureRemoved(d),e.remove(S.TEXTURE,a.engineTex.getId())),a.engineTex=void 0,a.desiredLOD=-1,a.curLOD=-1,delete this._texId2Meta[b])}delete this._matId2Meta[c][b];P.objectEmpty(this._matId2Meta[c])&&delete this._matId2Meta[c]};c.prototype._updateAllTextureLOD=function(){for(var a in this._texId2Meta)this._texId2Meta.hasOwnProperty(a)&&this._updateTextureLOD(this._texId2Meta[a])};
c.prototype._calcDesiredTextureLOD=function(a,b){for(var c=0,d=0;d<a.length;d++){var e=a[d],f=U.vec3.dist(e,this._controller.camPos),e=2*e[3]/f*this._controller.screenSizeFactor;e>c&&(c=e)}c/=9;for(a=b.length-1;0<a&&b[a].size<c;)a--;return a};c.prototype._updateTextureLOD=function(a){var b=this;a.desiredLOD=this._calcDesiredTextureLOD(a.featureMBS,a.images);if(a.curLOD!==a.desiredLOD&&(0>a.curLOD||!a.curLOD||0===a.desiredLOD||a.desiredLOD>a.curLOD||a.desiredLOD<a.curLOD-1)){if(0===a.images.length)return;
var c=a.images[a.desiredLOD],d=-1<a.encodingIdx?c.hrefConcat[a.encodingIdx]:c.hrefConcat;if(!this._requestedTexImageIds[c.id]){var e={metadata:{texMeta:a,image:c}};this._requestedTexImageIds[c.id]=!0;this._imageIsPartOfTextureBundle(c)?this._controller.streamDataSupplier.request(d,"binary",e).then(this._extractTextureImageFromBlob.bind(this)):this._controller.streamDataSupplier.request(d,"image",e).then(function(a,c,d,e){b._textureImageLoaded(a,c,e.image,e.texMeta)})}}a.engineTex||(a.engineTex=this._initTexture,
a.curLOD=-1);if(this.debugLODVis)for(c=q.fromHsv(a.desiredLOD/a.images.length*270,100,100).toRgb().map(function(a){return a/255}),d=0;d<a.usedByEngineMats.length;d++)a.usedByEngineMats[d].setParameterValues({ambient:c,diffuse:c})};c.prototype._extractTextureImageFromBlob=function(a,b,c,d){var e=d.texMeta;if(0>e.desiredLOD||d.image.size>e.images[e.desiredLOD].size)delete this._requestedTexImageIds[d.image.id];else{var f=this;P.assert("binary"===c);var g="";try{var h=c=0;-1<e.encodingIdx?(c=d.image.byteOffset[e.encodingIdx],
h=d.image.length[e.encodingIdx]):(c=d.image.byteOffset,h=d.image.length);var k=new Uint8Array(b,c,h),l=new Blob([k],{type:e.encoding}),g=window.URL.createObjectURL(l)}catch(wa){g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",ca.error("error loading texture "+a+" "+wa)}var m=new Image;m.onerror=function(){window.URL.revokeObjectURL(g);m.src="";m.onerror=void 0;m.onload=void 0};m.onload=function(){f._controller.queueAnimationFrameFunctionCall(f._textureImageLoaded,
f,[a,m,d.image,d.texMeta,g],void 0,1);window.URL.revokeObjectURL(g);m.src="";m.onerror=void 0;m.onload=void 0};m.src=g}};c.prototype._textureImageLoaded=function(a,b,c,d){delete this._requestedTexImageIds[c.id];if(!(0>d.desiredLOD)){a=d.images[d.desiredLOD];var e=d.images[d.curLOD];if(!this.isOverMemory()||!(null==e||c.size>e.size))if(!e||c.size>e.size&&c.size<=a.size||c.size<e.size&&c.size>=a.size){(e=d.engineTex)&&e!==this._initTexture&&(this.memEstimateTextureRemoved(e),this._stage.remove(S.TEXTURE,
d.engineTex.getId()));e=Y(b,d,this._enableAtlasMipMaps,this._disableAtlasAnisotropy);d.engineTex=new X(b,d.id,e);this._stage.add(S.TEXTURE,d.engineTex);d.curLOD=d.desiredLOD;this.memEstimateTextureAdded(d.engineTex);b=d.engineTex.getId();for(e=0;e<d.usedByEngineMats.length;e++){var f=d.usedByEngineMats[e];null==this._colorOverride&&f.setParameterValues({textureId:b});f.metadata.originalTextureId=b}c!==a&&(d.curLOD=d.images.indexOf(c),P.assert(-1<d.curLOD),this._requestedTexImageIds[a.id]||(c={metadata:{texMeta:d,
image:a}},this._requestedTexImageIds[a.id]=!0,this._controller.streamDataSupplier.request(a.hrefConcat,"binary",c).then(this._extractTextureImageFromBlob.bind(this))))}}};c.prototype._imageIsPartOfTextureBundle=function(a){return!this._controller.isMeshPyramid};c.prototype._setPolygonOffset=function(a,b){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle){b={polygonOffset:b};for(var c=0;c<this._nodeId2Meta[a.id].engineObjectsPerBundle.length;c++)for(var d=this._nodeId2Meta[a.id].engineObjectsPerBundle[c],
e=0;e<d.length;e++)for(var f=d[e].getGeometryRecords(),g=0;g<f.length;g++)for(var h=f[g].materials,k=0;k<h.length;k++)h[k].setParameterValues(b)}};c.prototype._rendererChange=function(a){(this._currentRenderer=a)&&(a.colorInfo||a.sizeInfo)&&ca.warn("renderer.colorInfo and renderer.sizeInfo are not supported for Scene Services. Use visualVariables instead.")};c.prototype._getRenderingInfo=function(a){var b=this._currentRenderer,c=b&&b.getSymbol(a);if(!(c instanceof x))return null;var c={symbol:c},
d,e;if(b&&b.visualVariables)for(a=b.getVisualVariableValues(a),b=0;b<a.length;b++){var f=a[b],g=f.variable.type;"color"===g?d=f.value:"opacity"===g&&(e=f.value)}d&&(c.color=[d.r/255,d.g/255,d.b/255]);null!=e?c.opacity=e:d&&null!=d.a&&(c.opacity=d.a);return c};c.prototype._getSymbolFillColor=function(a){var b=0;for(a=a.symbolLayers.items;b<a.length;b++){var c=a[b];if("fill"===c.type&&(c=c.material,c=null!=c?c.color:null,null!=c))return[c.r/255,c.g/255,c.b/255,c.a]}return null};c.prototype._getSymbolFillColorMixMode=
function(a){var b=0;for(a=a.symbolLayers.items;b<a.length;b++){var c=a[b];if("fill"===c.type&&(c=c.material,c=null!=c?c.colorMixMode:null,null!=c))return c}return null};c.prototype._hasSymbolColors=function(){return!this._isIntegratedMesh()};c.prototype._isIntegratedMesh=function(){return this.layer instanceof b};c.prototype._hasVertexColors=function(){return null!=this.layer.store.defaultGeometrySchema.vertexAttributes.color&&(null==this.layer.cachedDrawingInfo||!this.layer.cachedDrawingInfo.color)};
c.prototype._setObjectSymbology=function(a){if(this._hasSymbolColors()){for(var b=a.getMetadata(),c=b.faceRanges?b.faceRanges.length:1,d=new u(null,null,{}),e=d.attributes,f=this.layer.objectIdField,g=this._currentRenderer&&this._currentRenderer.requiredFields,h=a.geometryRecords[0].geometry.data.vertexAttributes[P.VertexAttrConstants.SYMBOLCOLOR].data,k=!1,l=new Uint8Array(4),m=0;m<c;m++){null!=f&&null!=b.featureIds&&(e[f]=b.featureIds[m]);if(null!=g&&null!=b.attributeData)for(var n=0,p=g;n<p.length;n++){var q=
p[n];b.attributeData[q]&&(e[q]=z.getCachedAttributeValue(b.attributeData[q],m))}var t=this._getRenderingInfo(d),n=null!=b.faceRanges?b.faceRanges[m]:null;if(t){var p=this._getSymbolFillColorMixMode(t.symbol),q=t.color,r=t.opacity;null==q||null==r?(t=this._getSymbolFillColor(t.symbol),q=G.overrideColor(q,r,t,t&&t[3],ga)):q=G.overrideColor(q,r,null,null,ga);1>q[3]&&(k=!0);z.encodeSymbolColor(q,p,l)}else z.encodeSymbolColor(null,null,l);this._setFaceRangeColor(n,h,l)}a.geometryColorAttrsUpdated(0);a=
a.getGeometryRecords();for(b=0;b<a.length;b++)for(c=a[b],d=0;d<c.materials.length;d++)e=c.materials[d],f=e.getParams().transparent,g=e.getParams().opacity,e.metadata.symbolIsTransparent=k,h=this._calcEngineMaterialTransparencyParams(e.metadata.i3sTex,e.metadata.i3sMatParams,e.metadata.symbolIsTransparent),f===h.transparent&&g===h.opacity||e.setParameterValues({transparent:h.transparent,opacity:h.opacity})}};c.prototype._setFaceRangeColor=function(a,b,c){var d=12*a[1]+12;for(a=12*a[0];a<d;a+=4)b[a+
0]=c[0],b[a+1]=c[1],b[a+2]=c[2],b[a+3]=c[3]};c.prototype._opacityChange=function(a){for(var b in this._matId2Meta)for(var c in this._matId2Meta[b]){a=this._matId2Meta[b][c].engineMat;var d=a.getParams(),e=this._calcEngineMaterialTransparencyParams(a.metadata.i3sTex,a.metadata.i3sMatParams,a.metadata.symbolIsTransparent);d.transparent===e.transparent&&d.layerOpacity===e.layerOpacity||a.setParameterValues(e)}};c.prototype.queryExtent=function(a){return this._ensureQueryEngine().queryExtent(a)};c.prototype.queryFeatureCount=
function(a){return this._ensureQueryEngine().queryFeatureCount(a)};c.prototype.queryFeatures=function(a){return this._ensureQueryEngine().queryFeatures(a)};c.prototype.queryObjectIds=function(a){return this._ensureQueryEngine().queryObjectIds(a)};c.prototype._ensureQueryEngine=function(){this._queryEngine||(this._queryEngine=this._createQueryEngine());return this._queryEngine};c.prototype._createQueryEngine=function(){var a=this,b={id:0,index:0,object:null,bbCorners:new Float64Array(24)};return new D({forAll:function(c,
d){a._forAllFeatures(function(d,e,f){b.id=d;b.index=e;b.object=f;a._boundingBoxCornerPoints(b.index,b.object,b.bbCorners);c(b)},d)},createGraphic:function(b){return a._createGraphic(b.index,b.object.getMetadata())},requestFields:function(b,c,d){return z.whenGraphicAttributes(a.layer,c,a._getObjectIdField(),d,function(){var d=a._getGraphicIndices(b.node,b.bundleNr,c);return{node:b.node,indices:d}})},createExtentBuilder:function(){return a._createExtentBuilder()}},{enableObjectId:!0,enableOutFields:!!this.layer.objectIdField})};
c.prototype._createExtentBuilder=function(){var a=this.view.renderSpatialReference,b=this.view.spatialReference,c=F.create(F.NEGATIVE_INFINITY),d=new Float64Array(24);return{add:function(e){I.bufferToBuffer(e.bbCorners,a,0,d,b,0,8)&&F.expandBuffer(c,d,0,8)},getExtent:function(){return F.toExtent(c,b)}}};c.prototype._forAllFeatures=function(a,b,c){for(var d=0,e=Object.keys(this._nodeId2Meta);d<e.length;d++)for(var f=e[d],g=this._nodeId2Meta[f].engineObjects,h=0;h<g.length;h++)this._forAllFeaturesOfObject(g[h],
a,c),b&&b({node:this._controller.nodeIndex[f],bundleNr:h})};c.prototype._forAllFeaturesOfObject=function(a,b,c){for(var d=a.getMetadata().featureIds,e=a.getGeometryRecords()[0],f=0;f<d.length;f++)(c||a.getComponentVisibility(e,f))&&b(d[f],f,a,e)};c.prototype._createGraphic=function(a,b){var c={};c[this._getObjectIdField()]=b.featureIds[a];for(var d=0,e=Object.keys(b.attributeData);d<e.length;d++){var f=e[d];c[f]=z.getCachedAttributeValue(b.attributeData[f],a)}a=new u(null,null,c);a.layer=this.layer;
return a};c.prototype._boundingBoxCornerPoints=function(a,b,c){a=b.geometries[0].getComponentAABB(a,da);for(var d=0;8>d;++d)R[0]=d&1?a[0]:a[3],R[1]=d&2?a[1]:a[4],R[2]=d&4?a[2]:a[5],U.mat4d.multiplyVec3(b.objectTransformation,R),c[3*d]=R[0],c[3*d+1]=R[1],c[3*d+2]=R[2];return c};c.prototype.highlight=function(a,b){var c=this,d=this._highlights;if(a instanceof r){b=d.acquireSet(b);var e=b.set,f=b.handle;this.queryObjectIds(a).then(function(a){return d.setFeatureIds(e,a)});return f}if("number"===typeof a||
a instanceof u)return this.highlight([a],b);a instanceof l&&(a=a.toArray());if(Array.isArray(a)&&0<a.length){if(a[0]instanceof u)return a=a.map(function(a){return V.attributeLookup(a.attributes,c._getObjectIdField())}),f=d.acquireSet(b),b=f.set,f=f.handle,d.setFeatureIds(b,a),f;if("number"===typeof a[0])return f=d.acquireSet(b),b=f.set,f=f.handle,d.setFeatureIds(b,a),f}return{remove:function(){}}};return c}(a.declared(t,J));c([a.property()],m.prototype,"layer",void 0);c([a.property()],m.prototype,
"view",void 0);c([a.property()],m.prototype,"_controller",void 0);c([a.property({dependsOn:["_controller.updating"]})],m.prototype,"updating",void 0);c([a.property({readOnly:!0,aliasOf:"_controller.updatingPercentage"})],m.prototype,"updatingPercentageValue",void 0);c([a.property({readOnly:!0})],m.prototype,"hasTexturesOrVertexColors",null);m=c([a.subclass("esri.views.3d.layers.SceneLayerView3D")],m);var R=[0,0,0],da=[0,0,0,0,0,0];return m})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang",
"dojo/_base/Color","dojo/colors"],function(m,h,d,c){m=h.getObject("color",!0,m);m.Color=d;m.blend=d.blendColors;m.fromRgb=d.fromRgb;m.fromHex=d.fromHex;m.fromArray=d.fromArray;m.fromString=d.fromString;m.greyscale=c.makeGrey;h.mixin(m,{fromCmy:function(a,b,c){h.isArray(a)?(b=a[1],c=a[2],a=a[0]):h.isObject(a)&&(b=a.m,c=a.y,a=a.c);return new d({r:Math.round(255*(1-a/100)),g:Math.round(255*(1-b/100)),b:Math.round(255*(1-c/100))})},fromCmyk:function(a,b,c,f){h.isArray(a)?(b=a[1],c=a[2],f=a[3],a=a[0]):
h.isObject(a)&&(b=a.m,c=a.y,f=a.b,a=a.c);f/=100;return new d({r:Math.round(255*(1-Math.min(1,a/100*(1-f)+f))),g:Math.round(255*(1-Math.min(1,b/100*(1-f)+f))),b:Math.round(255*(1-Math.min(1,c/100*(1-f)+f)))})},fromHsl:function(a,b,c){h.isArray(a)?(b=a[1],c=a[2],a=a[0]):h.isObject(a)&&(b=a.s,c=a.l,a=a.h);b/=100;for(c/=100;0>a;)a+=360;for(;360<=a;)a-=360;var f,g;120>a?(f=(120-a)/60,g=a/60,a=0):240>a?(f=0,g=(240-a)/60,a=(a-120)/60):(f=(a-240)/60,g=0,a=(360-a)/60);f=2*b*Math.min(f,1)+(1-b);g=2*b*Math.min(g,
1)+(1-b);a=2*b*Math.min(a,1)+(1-b);.5>c?(f*=c,g*=c,a*=c):(f=(1-c)*f+2*c-1,g=(1-c)*g+2*c-1,a=(1-c)*a+2*c-1);return new d({r:Math.round(255*f),g:Math.round(255*g),b:Math.round(255*a)})}});m.fromHsv=function(a,b,c){h.isArray(a)?(b=a[1],c=a[2],a=a[0]):h.isObject(a)&&(b=a.s,c=a.v,a=a.h);360==a&&(a=0);b/=100;c/=100;var f,g,e;if(0==b)g=e=f=c;else{var k=a/60;a=Math.floor(k);var m=k-a,k=c*(1-b),v=c*(1-b*m);b=c*(1-b*(1-m));switch(a){case 0:f=c;g=b;e=k;break;case 1:f=v;g=c;e=k;break;case 2:f=k;g=c;e=b;break;
case 3:f=k;g=v;e=c;break;case 4:f=b;g=k;e=c;break;case 5:f=c,g=k,e=v}}return new d({r:Math.round(255*f),g:Math.round(255*g),b:Math.round(255*e)})};h.extend(d,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var a,b=this.r/255,c=this.g/255,d=this.b/255;a=Math.min(1-b,1-c,1-d);return{c:Math.round((1-b-a)/(1-a)*100),m:Math.round((1-c-a)/(1-a)*100),y:Math.round((1-d-a)/(1-a)*100),b:Math.round(100*a)}},toHsl:function(){var a=
this.r/255,b=this.g/255,c=this.b/255,d=Math.min(a,c,b),g=Math.max(a,b,c),e=g-d,h=0,m=0,d=(d+g)/2;0<d&&1>d&&(m=e/(.5>d?2*d:2-2*d));0<e&&(g==a&&g!=b&&(h+=(b-c)/e),g==b&&g!=c&&(h+=2+(c-a)/e),g==c&&g!=a&&(h+=4+(a-b)/e),h*=60);return{h:h,s:Math.round(100*m),l:Math.round(100*d)}},toHsv:function(){var a=this.r/255,b=this.g/255,c=this.b/255,d=Math.max(a,b,c),g=d-Math.min(a,c,b),e=null,h=0==d?0:g/d;0==h?e=0:(e=a==d?60*(b-c)/g:b==d?120+60*(c-a)/g:240+60*(a-b)/g,0>e&&(e+=360));return{h:e,s:Math.round(100*h),
v:Math.round(100*d)}}});return m})},"dojox/main":function(){define(["dojo/_base/kernel"],function(m){return m.dojox})},"esri/views/3d/layers/i3s/I3SElevationProvider":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../../../core/Logger ../../../../geometry/Point ../../webgl-engine/lib/Selector ../../support/Evented ../../support/aaBoundingRect ../../lib/glMatrix".split(" "),
function(m,h,d,c,a,b,k,f,g,e,l,p){var v=l.create(l.NEGATIVE_INFINITY),q={spatialReference:null,extent:v},n=p.vec3d.create(),t=p.vec3d.create(),u=p.vec3d.create(),x=k.getLogger("esri.layers.SceneService");m=function(a){function b(b,c){var d=a.call(this)||this;d.layerView=b;d.renderCoordsHelper=d.layerView.view.renderCoordsHelper;d.intersectLayers=[c];d.selector=new g(d.layerView.view.viewingMode);d.zmin=b.layer.fullExtent.zmin;d.zmax=b.layer.fullExtent.zmax;return d}d(b,a);b.prototype.getElevation=
function(a){if(a instanceof f){if(!this.renderCoordsHelper.toRenderCoords(a,n))return x.error("could not project point for elevation alignment"),-Infinity}else if(!this.renderCoordsHelper.toRenderCoords(a,this.spatialReference,n))return x.error("could not project point for elevation alignment"),-Infinity;p.vec3d.set(n,t);p.vec3d.set(n,u);this.renderCoordsHelper.setAltitude(this.zmax,t);this.renderCoordsHelper.setAltitude(this.zmin,u);this.selector.init(this.intersectLayers,t,u,null,null,1,!1);return this.selector.getMinResult().getIntersectionPoint(n)?
this.renderCoordsHelper.getAltitude(n):-Infinity};b.prototype.objectCreated=function(a){this.objectChanged(a)};b.prototype.objectDeleted=function(a){this.objectChanged(a)};b.prototype.visibilityChanged=function(a){void 0!==a?this.objectChanged(a):this.spatialReference&&(q.extent=this.computeLayerExtent(this.intersectLayers[0]),q.spatialReference=this.spatialReference,this.emit("elevation-change",q))};b.prototype.objectChanged=function(a){this.spatialReference&&(q.extent=this.computeObjectExtent(a),
q.spatialReference=this.spatialReference,this.emit("elevation-change",q))};b.prototype.computeObjectExtent=function(a){l.set(v,l.NEGATIVE_INFINITY);this.expandExtent(a,v);return v};b.prototype.computeLayerExtent=function(a){l.set(v,l.NEGATIVE_INFINITY);var b=0;for(a=a.getObjects();b<a.length;b++)this.expandExtent(a[b],v);return v};b.prototype.expandExtent=function(a,b){for(var c=a.getBBMin(!0),d=a.getBBMax(!0),e=0;8>e;++e)n[0]=e&1?c[0]:d[0],n[1]=e&2?c[1]:d[1],n[2]=e&4?c[2]:d[2],p.mat4d.multiplyVec3(a.objectTransformation,
n),this.renderCoordsHelper.fromRenderCoords(n,n,this.spatialReference),l.expand(b,n);return b};return b}(a.declared(b,e.Evented));c([a.property()],m.prototype,"layerView",void 0);c([a.property({readOnly:!0,aliasOf:"layerView.view.elevationProvider.spatialReference"})],m.prototype,"spatialReference",void 0);return m=c([a.subclass("esri.views.3d.layers.i3s.I3SElevationProvider")],m)})},"esri/views/3d/layers/i3s/I3SProjectionUtil":function(){define(["../../support/projectionUtils","../../lib/glMatrix",
"../../webgl-engine/lib/Util"],function(m,h,d){var c=h.vec3d,a=h.mat4d,b=d.assert,k={PER_VERTEX:"perVertex",BOUNDINGBOX:"boundingBox",NO_REPROJECTION:"noReprojection"},f=new Float64Array(3E3);return{ReprojectionTypes:k,reprojectPoints:function(b,c,d,f,h,q,n){b===k.PER_VERTEX?d=this.reprojectPointsPerVertex(c,d,h,q,n,f):b===k.BOUNDINGBOX?d=this.reprojectBoundingBox(c,d,h,q,n):(b=a.create(),a.identity(b),c=a.create(),m.computeLinearTransformation(h,d,c,n),d={localTrafo:b,globalTrafo:c});return d},reprojectPointsPerVertex:function(b,
c,d,h,k,q){var e=a.create();m.computeLinearTransformation(d,c,e,k);var g=a.create(),g=a.inverse(e,g),l=a.create();a.identity(l);if(!q){q=[0,0,0];var p=b.length/3;m.vectorToVector(c,d,q,h);for(d=c=0;d<p;d+=1E3){var r=Math.min(1E3,p-d);for(c=0;c<r;c++)f[3*c]=b[3*(d+c)]+q[0],f[3*c+1]=b[3*(d+c)+1]+q[1],f[3*c+2]=b[3*(d+c)+2]+q[2];m.bufferToBuffer(f,h,0,f,k,0,r);var v,B,C;for(c=0;c<r;c++)v=f[3*c],B=f[3*c+1],C=f[3*c+2],b[3*(d+c)]=g[0]*v+g[4]*B+g[8]*C+g[12],b[3*(d+c)+1]=g[1]*v+g[5]*B+g[9]*C+g[13],b[3*(d+
c)+2]=g[2]*v+g[6]*B+g[10]*C+g[14]}}return{localTrafo:l,globalTrafo:e}},reprojectNormalsPerVertex:function(c,d,f,h,k){b(h.equals(m.SphericalRenderSpatialReference));h=a.create();m.computeLinearTransformation(f,d,h,k);d=a.create();d=a.inverse(h,d);f=c.length/3;for(var e,g=0;g<f;g++)k=c[3*g],h=c[3*g+1],e=c[3*g+2],c[3*g]=d[0]*k+d[4]*h+d[8]*e,c[3*g+1]=d[1]*k+d[5]*h+d[9]*e,c[3*g+2]=d[2]*k+d[6]*h+d[10]*e},reprojectBoundingBox:function(b,d,f,h,k){for(var e=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],
g=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],l=0;l<b.length/3;l++)for(var p=[b[3*l],b[3*l+1],b[3*l+2]],v=0;3>v;v++)e[v]=Math.min(e[v],p[v]),g[v]=Math.max(g[v],p[v]);l=this.geographicToProjected(d,f,h);c.add(l,e,e);c.add(l,g,g);for(l=0;3>l;l++)g[l]==e[l]&&(g[l]+=1);l=[[e[0],e[1],e[2]],[g[0],e[1],e[2]],[e[0],g[1],e[2]],[e[0],e[1],g[2]]];for(p=0;4>p;p++)v=l[p],m.vectorToVector(v,h,v,k);h=c.subtract(l[1],l[0],c.create());p=c.subtract(l[2],l[0],c.create());v=c.subtract(l[3],l[0],c.create());
c.scale(h,1/(g[0]-e[0]));c.scale(p,1/(g[1]-e[1]));c.scale(v,1/(g[2]-e[2]));var e=c.length(h),g=c.length(p),r=c.length(v);if(3<Math.abs(e-g)||3<Math.abs(e-r)||3<Math.abs(g-r)){for(l=0;l<b.length/3;l++)b[3*l]*=e,b[3*l+1]*=g,b[3*l+2]*=r;c.normalize(h);c.normalize(p);c.normalize(v)}b=a.createFromMatrixRowMajor([h[0],p[0],v[0],0,h[1],p[1],v[1],0,h[2],p[2],v[2],0,0,0,0,1]);e=[0,0,0,0];m.vectorToVector(d,f,e,k);return{globalTrafo:a.createFromMatrixRowMajor([1,0,0,e[0],0,1,0,e[1],0,0,1,e[2],0,0,0,1]),localTrafo:b}},
geographicToProjected:function(a,b,c){return 4326===c.wkid?[a[0],a[1],a[2]]:a}}})},"esri/views/3d/layers/i3s/I3SQueryEngine":function(){define("require exports dojo/promise/all ../../../../core/promiseUtils ../../../../core/Error ../../../../tasks/support/FeatureSet".split(" "),function(m,h,d,c,a,b){return function(){function h(a,b){this._support=a;this._options=b}h.prototype.queryExtent=function(a){var b=this;return this._rejectUnsupported(a).then(function(){var c=0,d=b._support.createExtentBuilder();
b._forAllQueried(a,function(a){c++;d.add(a)});return{count:c,extent:0===c?null:d.getExtent()}})};h.prototype.queryFeatureCount=function(a){var b=this;return this._rejectUnsupported(a).then(function(){var c=0;b._forAllQueried(a,function(){return c++});return c})};h.prototype.queryFeatures=function(a){var f=this;return this._rejectUnsupported(a).then(function(){var b=[],g=a&&a.outFields,h=[];f._forAllQueried(a,function(a){return h.push(f._support.createGraphic(a))},function(a){g&&(b.push(f._support.requestFields(a,
h,g)),h=[])});g||b.push(c.resolve(h));return d(b)}).then(function(a){a=a.reduce(function(a,b){return a.concat(b)},[]);var c=new b;c.features=a;return c})};h.prototype.queryObjectIds=function(a){var b=this;return this._rejectUnsupported(a).then(function(){var c=[];b._forAllQueried(a,function(a){return c.push(a.id)});return c})};h.defaultExtentBuilder=function(a){var b=null;return{add:function(c){(c=a(c))&&(b=null!=b?b.union(c):c.clone())},getExtent:function(){return b}}};h.prototype._forAllQueried=
function(a,b,c){var d=[];if(a&&a.objectIds){var e=a.objectIds;d.push(function(a){return 0<=e.indexOf(a.id)})}this._support.forAll(function(a){for(var c=0;c<d.length;c++)if(!(0,d[c])(a))return;b(a)},c)};h.prototype._rejectUnsupported=function(b){if(null==b)return c.resolve();var d=function(b){return c.reject(new a("Unsupported Query","Unsupported property '"+b+"'"))};return null!=b.distance?d("distance"):null!=b.geometryPrecision?d("geometryPrecision"):b.groupByFieldsForStatistics&&b.groupByFieldsForStatistics.length?
d("groupByFieldsForStatistics"):null!=b.maxAllowableOffset?d("maxAllowableOffset"):b.multipatchOption?d("multipatchOption"):null!=b.num?d("num"):b.orderByFields&&b.orderByFields.length?d("orderByFields"):b.outSpatialReference?d("outSpatialReference"):b.outStatistics&&b.outStatistics.length?d("outStatistics"):b.pixelSize?d("pixelSize"):b.quantizationParameters?d("quantizationParameters"):b.relationParam?d("relationParam"):b.returnDistinctValues?d("returnDistinctValues"):null!=b.start?d("start"):b.text?
d("text"):b.timeExtent?d("timeExtent"):b.where?d("where"):b.geometry?d("geometry"):!this._options.enableOutFields&&b.outFields&&b.outFields.length?d("outFields"):!this._options.enableObjectId&&b.objectIds&&b.objectIds.length?d("objectIds"):c.resolve()};return h}()})},"esri/views/3d/layers/i3s/Highlights":function(){define(["require","exports","../../webgl-engine/lib/HighlightSet"],function(m,h,d){var c=function(){return function(a){this.highlightSet=new d;this.ids=new Set;this.options=a}}();return function(){function a(a){this.highlights=
[];this.layerView=a}a.prototype.destroy=function(){this.highlights.forEach(function(a){return a.highlightSet.removeAll()});this.highlights=null};a.prototype.acquireSet=function(a){var b=this,d=new c(a);this.highlights.push(d);return{set:d,handle:{remove:function(){return b.releaseSet(d)}}}};a.prototype.releaseSet=function(a){a.highlightSet.removeAll();a=this.highlights?this.highlights.indexOf(a):-1;-1!==a&&this.highlights.splice(a,1)};a.prototype.setFeatureIds=function(a,c){c.forEach(function(b){return a.ids.add(b)});
this.layerView._forAllFeatures(function(b,c,d,h){a.ids.has(b)&&(b=d.setComponentHighlight(h,c,a.options),a.highlightSet.addObject(d,b))},null,!0)};a.prototype.objectCreated=function(a){var b=this;this.highlights.forEach(function(c){b.layerView._forAllFeaturesOfObject(a,function(a,b,d,f){c.ids.has(a)&&(a=d.setComponentHighlight(f,b,c.options),c.highlightSet.addObject(d,a))},!0)})};a.prototype.objectDeleted=function(a){this.highlights.forEach(function(b){b.highlightSet.removeObject(a)})};a.prototype.allObjectsDeleted=
function(){this.highlights.forEach(function(a){return a.highlightSet.removeAll()})};return a}()})},"esri/views/3d/layers/i3s/FeatureChangeNotifier":function(){define(["require","exports"],function(m,h){Object.defineProperty(h,"__esModule",{value:!0});m=function(){function d(c,a){this._eventIsScheduled=!1;this._event=null;this._controller=a;this._layerView=c}d.prototype._emitFeaturesChangedEvent=function(){this._layerView.emit("features-changed",this._event);this._event=null;this._eventIsScheduled=
!1};d.prototype._cancelFeaturesChangedEvent=function(){this._eventIsScheduled=!1};d.prototype.notify=function(c,a){var b=this;null==this._event&&(this._event={addedCount:0,removedCount:0});this._event.addedCount+=c;this._event.removedCount+=a;this._eventIsScheduled||(this._eventIsScheduled=!0,this._controller.queueAnimationFrameFunctionCall(function(){return b._emitFeaturesChangedEvent()},null,null,function(){return b._cancelFeaturesChangedEvent()},null))};return d}();h.FeatureChangeNotifier=m})},
"esri/views/3d/webgl-engine/lib/base64Binary":function(){define(["require","exports"],function(m,h){function d(a){var b=c[a.charAt(a.length-1)],d=c[a.charAt(a.length-2)],f=a.length/4*3;64===b&&f--;64===d&&f--;b=new ArrayBuffer(f);d=new Uint8Array(b);a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var g=0,e=0;e<f;e+=3){var h=c[a.charAt(g++)],m=c[a.charAt(g++)],v=c[a.charAt(g++)],q=c[a.charAt(g++)],n=(m&15)<<4|v>>2,t=(v&3)<<6|q;d[e]=h<<2|m>>4;64!==v&&(d[e+1]=n);64!==q&&(d[e+2]=t)}return b}Object.defineProperty(h,
"__esModule",{value:!0});var c={};for(m=0;65>m;m++)c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[m]]=m;h.decode=d;h.decodeFloat32=function(a){return new Float32Array(d(a))};h.decodeUint32=function(a){return new Uint32Array(d(a))};h.decodeInt32=function(a){return new Int32Array(d(a))};h.encode=function(a){var b;b=a instanceof Uint8Array?a:new Uint8Array(b.buffer,b.byteOffset,b.byteLength);a=b.length%3;for(var c="",d,g=b.length-a,e=0;e<g;e+=3)d=(b[e]<<16)+(b[e+1]<<8)+b[e+
2],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>18&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d&63];switch(a){case 1:d=b[b.length-1];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>2];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d<<
4&63];c+="\x3d\x3d";break;case 2:d=(b[b.length-2]<<8)+b[b.length-1],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>10],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>4&63],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d<<2&63],c+="\x3d"}return c}})},"url:esri/widgets/Popup/templates/Popup.html":'\x3cdiv role\x3d"presentation" class\x3d"${_css.invisible}"\x3e\r\n  \x3c!-- Popup Container --\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_containerNode" class\x3d"${_css.container} ${_css.alignTop} ${_css.shadow}"\x3e\r\n    \x3cdiv class\x3d"${_css.main}"\x3e\r\n      \x3c!-- Popup Docked Pagination --\x3e\r\n      \x3csection class\x3d"${_css.paginationDocked}"\x3e\r\n        \x3cdiv role\x3d"presentation" class\x3d"${_css.loadingContainer}" title\x3d"${_i18n.loading}"\x3e\r\n          \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLoading}"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.loading}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${_css.paginationDockedButtons}"\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_previousDockedNode" class\x3d"${_css.button} ${_css.paginationPrevious}" title\x3d"${_i18n.previous}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationPreviousIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationPreviousIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.previous}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_pageTextDockedNode" class\x3d"${_css.paginationText}"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_nextDockedNode" class\x3d"${_css.button} ${_css.paginationNext}" title\x3d"${_i18n.next}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationNextIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationNextIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.next}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_pageMenuDockedNode" class\x3d"${_css.button} ${_css.featureMenuButton}" title\x3d"${_i18n.menu}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconPaginationMenu}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.menu}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/section\x3e\r\n      \x3c!-- /Popup Docked Pagination --\x3e\r\n      \x3c!-- Popup Header --\x3e\r\n      \x3cheader class\x3d"${_css.header}"\x3e\r\n        \x3ch1 data-dojo-attach-point\x3d"_titleNode" class\x3d"${_css.headerTitle}"\x3e\x3c/h1\x3e\r\n        \x3cdiv class\x3d"${_css.headerButtons}"\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_dockNode" class\x3d"${_css.button} ${_css.buttonDock}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToRight}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToTop}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToLeft}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToBottom}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.dock}\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconUndock}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.undock}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_closeNode" class\x3d"${_css.button}" title\x3d"${_i18n.close}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconClose}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.close}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/header\x3e\r\n      \x3c!-- /Popup Header --\x3e\r\n      \x3c!-- Popup Content --\x3e\r\n      \x3carticle class\x3d"${_css.content}" data-dojo-attach-point\x3d"_bodyContentNode"\x3e\x3c/article\x3e\r\n      \x3c!-- /Popup Content --\x3e\r\n      \x3c!-- Popup Footer --\x3e\r\n      \x3cfooter class\x3d"${_css.footer}"\x3e\r\n        \x3c!-- Popup Actions --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_actionsNode" class\x3d"${_css.actions}"\x3e\x3c/div\x3e\r\n        \x3c!-- /Popup Actions --\x3e\r\n        \x3c!-- Popup Pagination --\x3e\r\n        \x3csection class\x3d"${_css.pagination}"\x3e\r\n          \x3cdiv role\x3d"presentation" class\x3d"${_css.loadingContainer}" title\x3d"${_i18n.loading}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLoading}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.loading}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_previousNode" class\x3d"${_css.button} ${_css.paginationPrevious}" title\x3d"${_i18n.previous}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationPreviousIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationPreviousIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.previous}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_pageTextNode" class\x3d"${_css.paginationText}"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_nextNode" class\x3d"${_css.button} ${_css.paginationNext}" title\x3d"${_i18n.next}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationNextIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationNextIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.next}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_pageMenuNode" class\x3d"${_css.button} ${_css.featureMenuButton}" title\x3d"${_i18n.menu}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconPaginationMenu}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.menu}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/section\x3e\r\n        \x3c!-- /Popup Pagination --\x3e\r\n      \x3c/footer\x3e\r\n      \x3c!-- /Popup Footer --\x3e\r\n      \x3c!-- Popup Menu --\x3e\r\n      \x3csection class\x3d"${_css.featureMenu}" data-dojo-attach-point\x3d"_pageMenuSectionNode" aria-hidden\x3d"true"\x3e\r\n        \x3ch2 class\x3d"${_css.featureMenuHeader}" data-dojo-attach-point\x3d"_pageMenuInfoNode"\x3e\x3c/h2\x3e\r\n        \x3cnav class\x3d"${_css.featureMenuViewport}"\x3e\r\n          \x3col class\x3d"${_css.featureMenuList}" role\x3d"menu" data-dojo-attach-point\x3d"_paginationNode"\x3e\x3c/ol\x3e\r\n        \x3c/nav\x3e\r\n      \x3c/section\x3e\r\n      \x3c!-- /Popup Menu --\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Popup Pointer --\x3e\r\n    \x3cdiv class\x3d"${_css.pointer}" role\x3d"presentation"\x3e\r\n      \x3cdiv class\x3d"${_css.pointerDirection} ${_css.shadow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- /Popup Pointer --\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- /Popup Container --\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/views/3d/environment/materials/SimpleAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n#ifndef PANORAMIC\r\n\r\n  const float TWICEPI \x3d 2.0*3.14159265;\r\n  const float ATMOSPHERE_RIM_SEGMENTS \x3d 128.0;\r\n\r\n  uniform vec3 silCircleCenter;\r\n  uniform vec3 silCircleV1;\r\n  uniform vec3 silCircleV2;\r\n  uniform vec2 texV;\r\n\r\n#endif\r\n\r\n  uniform vec3 lightDirection;\r\n\r\n  attribute vec3 $position;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main(void) {\r\n\r\n#ifdef PANORAMIC\r\n\r\n    vec3 pos \x3d $position;\r\n    float ndotl \x3d lightDirection.z;\r\n    vtc \x3d vec2(0, $position.z+0.05);\r\n\r\n#else\r\n\r\n    float phi \x3d $position.x * (TWICEPI / ATMOSPHERE_RIM_SEGMENTS) + 1.0;\r\n    vec3 pos \x3d (sin(phi) * silCircleV1 + cos(phi) * silCircleV2 + silCircleCenter) * $position.y;\r\n    float ndotl \x3d dot(normalize(pos), lightDirection);\r\n\r\n    vtc.x \x3d $position.x / ATMOSPHERE_RIM_SEGMENTS;\r\n    vtc.y \x3d texV.x * (1.0 - $position.z) + texV.y * $position.z;\r\n\r\n#endif\r\n\r\n    falloff \x3d max(0.0, (smoothstep(-1.0, 0.8, ndotl + ndotl)));\r\n\r\n    gl_Position \x3d proj * view * vec4(pos, 1.0);\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n  uniform sampler2D tex;\r\n  uniform vec4 color;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor * color * falloff;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/RealisticAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--Vertex Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"vsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n//\r\n// Based on Atmospheric scattering vertex shader by Sean O\'Neil from GPU Gems 2 Chapter 16.\r\n//\r\n// Link:                   http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\r\n// Download Portal:        http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Index.html\r\n// Unmodified Source Code: http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Content/16.zip\r\n//\r\n// Adapted for WebGIS by Jascha Gr\u00fcbel (jgruebel@esri.com), Z\u00fcrich 2015\r\n//\r\n\r\n  $vsprecisionf\r\n\r\n  //Camera\r\n  uniform vec2 halfSizeNearPlane;\r\n  uniform vec3 v3CameraUp;\r\n  uniform vec3 v3CameraRight;\r\n  uniform vec3 v3CameraDir;\r\n  uniform vec2 v2CameraCenterOffset;\r\n\r\n  //Attributes\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  //Varyings\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n#ifdef HAZE\r\n  varying vec3 v3EyeDir;\r\n#endif\r\n\r\n  void main(void) {\r\n    vec3 v3Pos \x3d $position;\r\n    vtc \x3d $uv0;\r\n    vec2 rayvtc \x3d $uv0 - v2CameraCenterOffset;\r\n\r\n#ifdef HAZE\r\n    v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#else\r\n    vec3 v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#endif\r\n    v3WorldRay \x3d v3EyeDir.z*v3CameraDir + v3EyeDir.y*v3CameraUp + v3EyeDir.x*v3CameraRight;\r\n    gl_Position \x3d vec4(v3Pos, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereScaleFunction"\x3e\x3c![CDATA[\r\n  //Approximation for inner integral based on a radii ratio of 10.25:10\r\n  float scale(float fCos){\r\n    float x \x3d 1.0 - fCos;\r\n    return exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toneMapperConstants"\x3e\x3c![CDATA[\r\n#ifdef HAZE\r\n  const float fOneOverGamma \x3d 1.0;//Gamma \x3d 1.0\r\n#else\r\n  const float fOneOverGamma \x3d 0.454545; // Gamma \x3d 2.2\r\n#endif\r\n  const vec3 v3OneOverGamma \x3d vec3(fOneOverGamma);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"exponentialToneMapper"\x3e\x3c![CDATA[\r\n  //ToneMapping operators\r\n  vec3 expTM(vec3 inputColor,float exposure){\r\n      return pow(1.0 - exp(inputColor * -exposure), v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"reinhardToneMapper"\x3e\x3c![CDATA[\r\n  vec3 reinhardTM(vec3 inputColor, float exposure){\r\n      vec3 intermediate \x3d inputColor *exposure;\r\n      intermediate /\x3d (1.0+intermediate);\r\n      return pow(intermediate, v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"HSVColorSpace"\x3e\x3c![CDATA[\r\n//based on http://gamedev.stackexchange.com/a/59808\r\n// Hue in range [0,1] instead of 360\u00b0\r\nvec3 rgb2hsv(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n    vec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\r\n    vec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\r\n\r\n    float d \x3d q.x - min(q.w, q.y);\r\n    float e \x3d 1.0e-10;\r\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n}\r\n\r\nvec3 hsv2rgb(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n    vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUniformsConstantsVaryings"\x3e\x3c![CDATA[\r\n\r\n  //Light\r\n  uniform vec3 v3LightDir;      // The direction vector to the light source\r\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\r\n  uniform vec3 v3InvWavelengthScaled; //v3InvWavelength * fKr4PI + fKm4PI\r\n\r\n  //Radii\r\n  uniform vec4 v4Radii; // inner, inner^2, outer, outer^2,\r\n\r\n  //Atmosphere\r\n  const float fKrESun \x3d 0.075;        // Kr * ESun \x3d 0.005 * 15.0\r\n  const float fKmESun \x3d 0.015;        // Km * ESun \x3d 0.005 * 15\r\n  //uniform float fScale;         // 1 / (fOuterRadius - fInnerRadius)\r\n  //uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepth; // 1.0 / fScaleDepth\r\n\r\n  //uniform float fScaleDepthBlue;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepthBlue; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepthBlue; // 1.0 / fScaleDepth\r\n\r\n  uniform vec4 v4AtmosParams1; //(fScale,fScaleDepth,fScaleOverScaleDepth,fOneOverScaleDepth)\r\n  uniform vec4 v4AtmosParams2; //(g,fScaleDepthBlue,fScaleOverScaleDepthBlue,fOneOverScaleDepthBlue)\r\n#ifndef HAZE\r\n  uniform vec4 v4AtmosParams3; //(g2,fMiePhaseCoefficients,fLowerAlphaBlendBound,fOneOverOuterRadiusMinusAlphaBlendBound)\r\n#endif\r\n\r\n  //Camera\r\n  uniform vec3 v3CameraPos;     // The camera\'s current position\r\n  //uniform float fCameraHeight;  // The camera\'s current height\r\n  //uniform float fCameraHeight2; // fCameraHeight^2\r\n  //uniform float fC; //fCameraHeight2 - fOuterRadius2; // C \x3d ||o-c||^2 - r^2\r\n  //uniform float fCSur; //fCameraHeight2 - (fInnerRadius2 - 63756370000.0); // C \x3d ||o-c||^2 - r^2\r\n  uniform vec4 v4SphereComp; //The camera\'s current height, CameraHeight^2,fC,fCSur\r\n  uniform vec2 nearFar;\r\n\r\n  //Camera HDR\r\n#ifdef HAZE\r\n  const float fExposure \x3d 1.5;\r\n#else\r\n  const float fExposure \x3d 2.0;\r\n#endif\r\n\r\n#ifdef HAZE\r\n  //Depth texture\r\n  uniform sampler2D tDepth;\r\n#endif\r\n\r\n  //Testing variables\r\n  uniform float showTest;\r\n\r\n  //Varyings\r\n  varying vec3 v3EyeDir;\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n  //Loop constants for integral approximation\r\n  const float fSamples \x3d 5.0;\r\n  const int maxSamples \x3d 5;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmospherePrecomputation"\x3e\x3c![CDATA[\r\n    float fInnerRadius \x3d v4Radii[0];   // The inner (planetary) radius\r\n    float fInnerRadius2 \x3d v4Radii[1];  // fInnerRadius^2\r\n    float fOuterRadius \x3d v4Radii[2];   // The outer (atmosphere) radius\r\n    float fOuterRadius2 \x3d v4Radii[3];  // fOuterRadius^2\r\n\r\n    float fCameraHeight \x3d v4SphereComp[0];\r\n    float fCameraHeight2 \x3d v4SphereComp[1];\r\n    float fC \x3d v4SphereComp[2];\r\n    float fCSur \x3d v4SphereComp[3];\r\n\r\n#ifdef PLANAR\r\n    vec3 cameraPosition \x3d vec3(0.0,0.0,fCameraHeight);\r\n#else\r\n    vec3 cameraPosition \x3d v3CameraPos;\r\n#endif\r\n\r\n    //Debug variables\r\n    vec3 test \x3d vec3(0.0,0.0,0.0);\r\n\r\n    //Obtain ray from Camera\r\n    vec3 worldSpaceRay \x3d normalize(v3WorldRay);\r\n\r\n    //Compute Atmosphere intersection; i.e. ray/sphere intersection\r\n    float B \x3d 2.0 * dot(cameraPosition, worldSpaceRay); // B \x3d 2(l * (o-c))\r\n    float det \x3d B*B - 4.0 * fC; // det \x3d B^2 - 4.0* C\r\n\r\n    //idealized sphere intersection to discard early some pixels\r\n    float detSur \x3d B*B - 4.0 * fCSur; // det \x3d B^2 - 4.0* C\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereDiscardPixels"\x3e\x3c![CDATA[\r\n      bool continueComputation \x3d true;\r\n#ifdef HAZE\r\n      // only use red channel from depth texture.\r\n      // see \'Issues\' at https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture\r\n      float depthSample \x3d texture2D(tDepth, vtc).r;\r\n\r\n      float zNear \x3d nearFar[0];\r\n      float zFar \x3d nearFar[1];\r\n\r\n      // http://web.archive.org/web/20130416194336/http://olivers.posterous.com/linear-depth-in-glsl-for-real\r\n      float zNorm \x3d 2.0 * depthSample - 1.0;\r\n      float linDepth \x3d 2.0 * zNear * zFar /\r\n        (zFar + zNear - zNorm * (zFar - zNear));\r\n\r\n      float nearSurfaceT;\r\n      if (detSur\x3e0.0){\r\n        nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n      }\r\n\r\n      float rayEndT;\r\n\r\n      // find intersections with ground, but only between the near and far\r\n      // clipping planes.\r\n      if (depthSample \x3c 1.0 \x26\x26 depthSample \x3e 0.0) {\r\n        vec3 cameraSpaceRay \x3d normalize(v3EyeDir);\r\n        cameraSpaceRay /\x3d cameraSpaceRay.z;\r\n        cameraSpaceRay *\x3d linDepth;\r\n#ifndef PLANAR\r\n        if((fCameraHeight-fInnerRadius)\x3e8000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d nearSurfaceT;\r\n        } else  if ((fCameraHeight-fInnerRadius)\x3e2000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d mix(length(cameraSpaceRay),nearSurfaceT,((fCameraHeight-fInnerRadius)-2000000.0)/6000000.0);\r\n        } else {\r\n          rayEndT \x3d length(cameraSpaceRay);\r\n        }\r\n#else\r\n        rayEndT \x3d length(cameraSpaceRay);\r\n#endif\r\n      } else {\r\n        continueComputation \x3d false;\r\n      }\r\n#ifdef PLANAR\r\n      if (16500.0+ fInnerRadius \x3c fCameraHeight){\r\n        continueComputation \x3d false;\r\n      }\r\n#endif\r\n#else\r\n      if (detSur\x3e0.0){\r\n        float nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n        if (nearSurfaceT \x3e 0.0){\r\n          continueComputation \x3d false;\r\n        }\r\n      }\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUnpackAddUniforms"\x3e\x3c![CDATA[\r\n        float fScale \x3d v4AtmosParams1.x;\r\n        vec2 v2ScaleDepth \x3d vec2(v4AtmosParams1.y,v4AtmosParams2.y);//fScaleDepth, fScaleDepthBlue\r\n        vec2 v2ScaleOverScaleDepth \x3d vec2(v4AtmosParams1.z,v4AtmosParams2.z);//fScaleOverScaleDepth, fScaleOverScaleDepthBlue\r\n        vec2 v2OneOverScaleDepth \x3d vec2(v4AtmosParams1.w,v4AtmosParams2.w);//fOneOverScaleDepth, fOneOverScaleDepthBlue\r\n\r\n#ifndef HAZE\r\n        float g \x3d v4AtmosParams2.x;\r\n        float g2 \x3d v4AtmosParams3.x;\r\n        float fMiePhaseCoefficients \x3d v4AtmosParams3.y;\r\n        float fLowerAlphaBlendBound \x3d v4AtmosParams3.z;\r\n        float fOneOverOuterRadiusMinusAlphaBlendBound \x3d v4AtmosParams3.w;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeRayAndLoopSetup"\x3e\x3c![CDATA[\r\n        float rayStartT \x3d 0.5 *(-B - sqrt(det)); //near intersection with atmosphere\r\n#ifdef HAZE\r\n        float nearT \x3d abs(rayStartT);\r\n        float farT \x3d abs(rayEndT);\r\n#else\r\n        float rayEndT \x3d 0.5 *(-B + sqrt(det)); //far intersection with atmosphere\r\n\r\n#endif\r\n\r\n        float fDistance;//calculate its scattering offset\r\n        // Calculate the ray\'s starting position\r\n        if (rayStartT \x3c 0.0)\r\n        { //ray starts from camera to far\r\n          rayStartT \x3d 0.0;\r\n#ifndef HAZE\r\n          fDistance \x3d fScale*(fInnerRadius - fCameraHeight);\r\n#endif\r\n        }\r\n#ifndef HAZE\r\n        else\r\n        {//outside atmosphere\r\n          fDistance \x3d -1.0;\r\n        }\r\n#endif\r\n\r\n        // Initialize the scattering loop variables\r\n        vec3 v3Start \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n\r\n#ifdef HAZE\r\n        vec3 v3End \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n\r\n        float fEndLength \x3d length(v3End);\r\n        float fLocalCameraHeight \x3d length(v3Start);\r\n\r\n        //computed for the original end point to get consistent light angles after possible inversions\r\n        float fLightAngle \x3d dot(v3LightDir, v3End) / fEndLength;\r\n\r\n        if (nearT \x3e farT)\r\n        {\r\n          if (fLocalCameraHeight \x3c fEndLength)\r\n          {\r\n            //Switch positive slopes for flipped rays\r\n            v3End \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n            v3Start \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n            worldSpaceRay *\x3d -1.0;\r\n            fEndLength \x3d length(v3End);\r\n            fLocalCameraHeight \x3d length(v3Start);\r\n          }\r\n          else if (fLocalCameraHeight \x3d\x3d fEndLength)\r\n          {// create minuscule fake slope for integration if the slope is zero\r\n            fLocalCameraHeight +\x3d 1.0; //BUGFIX, if the height of camera and ground is equal the equation breaks, add fake meter to camera height to get\r\n            //slope for the camera function\r\n          }\r\n        }\r\n\r\n        //Calculate its scattering offset\r\n        // Assumes camera constrains of WSV 3.8\r\n        float fCameraDepth;\r\n        float fCameraDepthBlue;\r\n        if (fLocalCameraHeight \x3e fOuterRadius)\r\n        {\r\n          fDistance \x3d fInnerRadius - fOuterRadius;\r\n        } else\r\n        {//outside atmosphere\r\n          fDistance \x3d fEndLength - fLocalCameraHeight;\r\n        }\r\n\r\n#endif\r\n        vec2 v2OpticalStartDepth \x3d exp(fDistance * v2OneOverScaleDepth);\r\n\r\n        float fRayLength \x3d rayEndT - rayStartT;\r\n        float fSampleLength \x3d fRayLength / fSamples;\r\n        float fScaledLength \x3d fSampleLength * fScale;\r\n        vec3 v3SampleRay \x3d worldSpaceRay * fSampleLength;\r\n        vec3 v3SamplePoint \x3d v3Start + v3SampleRay * 0.5;\r\n\r\n#ifdef HAZE\r\n        float fCameraAngle \x3d dot(-worldSpaceRay, v3End) / fEndLength;\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth;\r\n\r\n        float scaledValues \x3d scale(fLightAngle) + fScaleCameraAngle;\r\n        vec2 v2ScaledValuesDepth \x3d scaledValues * v2ScaleDepth;\r\n#else\r\n        float fCameraAngle \x3d dot(worldSpaceRay, v3Start / length(v3Start));\r\n        float angleMultiplier \x3d fCameraAngle\x3e0.0?fCameraAngle:0.0;\r\n\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth * v2ScaleDepth;\r\n#endif\r\n\r\n        //Loop variables\r\n        vec3 v3FrontColor \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3FrontColorBlue \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3Attenuate\x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3AttenuateBlue \x3d vec3(0.0, 0.0, 0.0);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeSampleContribution"\x3e\x3c![CDATA[\r\n          float fHeight \x3d length(v3SamplePoint);\r\n          vec2 v2Depth \x3d exp(v2ScaleOverScaleDepth * (fInnerRadius - fHeight));\r\n#ifdef HAZE\r\n          vec2 v2Scatter \x3d v2Depth*v2ScaledValuesDepth-v2CameraOffset;\r\n#else\r\n          float fLightAngle \x3d dot(v3LightDir, v3SamplePoint) / fHeight;\r\n          float fCameraAngle \x3d dot(worldSpaceRay, v3SamplePoint) / fHeight;\r\n          float fTempScaledValues \x3d scale(fLightAngle) - scale(fCameraAngle);\r\n          vec2 v2Scatter \x3d v2CameraOffset + fTempScaledValues*v2Depth* v2ScaleDepth;\r\n#endif\r\n          v3Attenuate \x3d exp(-v2Scatter.x * v3InvWavelengthScaled);\r\n          v3AttenuateBlue \x3d exp(-v2Scatter.y * v3InvWavelengthScaled);\r\n\r\n          v3FrontColor +\x3d v3Attenuate * v2Depth.x;\r\n          v3FrontColorBlue +\x3d v3AttenuateBlue * v2Depth.y;\r\n\r\n          v3SamplePoint +\x3d v3SampleRay;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeHDRColors"\x3e\x3c![CDATA[\r\n        //Phase computation\r\n        //clamp to avoid numerical instability at fCos \x3d\x3d -1.0 (and close values) to display fake sun\r\n        float fCos \x3d clamp(dot(v3LightDir, -worldSpaceRay ),-0.9999999,1.0);\r\n        float fOnePlusCos2 \x3d fCos*fCos + 1.0;\r\n#ifdef HAZE\r\n        // Finally, scale the Rayleigh colors and set up the varying variables for the pixel shader\r\n        vec3 colorCoefficients \x3d (fScaledLength* 0.75 * fOnePlusCos2)*(fKrESun*v3InvWavelength+fKmESun);\r\n\r\n        //Scaled Length is only applied afterwards to save multiplications\r\n        vec3 v3Color \x3d colorCoefficients *v3FrontColor;\r\n        vec3 v3ColorBlue \x3d colorCoefficients *v3FrontColorBlue;\r\n#else\r\n        vec3 v3RayleighCoefficients \x3d (fScaledLength*0.75 * fOnePlusCos2*fKrESun)*v3InvWavelength;\r\n        float fMieCoefficients \x3d fScaledLength*fKmESun * fMiePhaseCoefficients * fOnePlusCos2 / pow(1.0 + g2 - 2.0*g*fCos, 1.5);\r\n\r\n        // Calculate the attenuation factor for the ground\r\n        vec3 v3Color \x3d v3RayleighCoefficients * v3FrontColor + fMieCoefficients * v3FrontColor;\r\n        vec3 v3ColorBlue \x3d v3RayleighCoefficients * v3FrontColorBlue + fMieCoefficients * v3FrontColorBlue;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputePixelColor"\x3e\x3c![CDATA[\r\n\r\n\r\n        //HDR to LDR conversion\r\n        vec3 ldrBlue \x3d expTM(v3ColorBlue,2.0*fExposure);\r\n        vec3 ldrRed \x3d expTM(v3Color,fExposure);\r\n\r\n        //mix reddish and blueish atmosphere\r\n        vec3 LDR \x3d mix(ldrBlue,ldrRed,0.2);\r\n#ifdef HAZE\r\n        LDR *\x3d (1.0-fCameraAngle);\r\n        vec3 hsv \x3d rgb2hsv(LDR);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost haze saturation by 50%\r\n        LDR \x3d hsv2rgb(hsv);\r\n        vec3 finalColor \x3d LDR;\r\n        // when rendering we specify the blend functions such that\r\n        // newDestColor \x3d oldDestColor*(1.0-finalColor) + finalColor\r\n#else\r\n        //reinhard tonemapper for looking upwards\r\n        vec3 ldrReinhard \x3d reinhardTM(v3Color,fExposure);\r\n        LDR +\x3d angleMultiplier*ldrReinhard;\r\n\r\n        //height dependent parameter to smooth out reddish atmosphere\r\n        float side \x3d (rayEndT+rayStartT)*0.5;\r\n        float atmoHeight \x3d sqrt(fCameraHeight2 - side*side);\r\n        float h2 \x3d clamp(1.0-(atmoHeight-fLowerAlphaBlendBound)/(fOuterRadius-fLowerAlphaBlendBound),0.0,1.0);\r\n\r\n        vec3 finalColor \x3d LDR*h2;\r\n        vec3 hsv \x3d rgb2hsv(finalColor);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost sky saturation by 50%\r\n        finalColor \x3d hsv2rgb(hsv);\r\n#endif\r\n#ifdef PLANAR\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#else\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,0.0,16500.0);\r\n        alpha \x3d alpha / (16500.0-0.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#endif\r\n#else\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        float atmosStrength \x3d clamp((length(ldrRed)-0.05)*1.05,0.0,1.0);\r\n        gl_FragColor \x3d vec4(finalColor, atmosStrength*clamp(1.0-(atmoHeight-fInnerRadius)/(fOuterRadius-fInnerRadius),0.0,1.0));\r\n#else\r\n        gl_FragColor \x3d vec4(finalColor, 1.0);\r\n#endif\r\n#endif\r\n\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--Fragment Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"fsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n\r\n  $fsprecisionf\r\n\r\n$atmosphereUniformsConstantsVaryings\r\n\r\n$atmosphereScaleFunction\r\n\r\n  //Conversion implementation found in util.xml\r\n$rgba2float\r\n\r\n\r\n$toneMapperConstants\r\n$exponentialToneMapper\r\n#ifndef HAZE\r\n$reinhardToneMapper\r\n#endif\r\n\r\n$HSVColorSpace\r\n\r\n  void main()\r\n  {\r\n\r\n    $atmospherePrecomputation\r\n\r\n    //Inside Atmosphere\r\n    if (det \x3e\x3d 0.0){\r\n\r\n      $atmosphereDiscardPixels\r\n\r\n      if(continueComputation){\r\n\r\n        $atmosphereUnpackAddUniforms\r\n\r\n        $atmosphereComputeRayAndLoopSetup\r\n\r\n        // Now loop through the sample rays\r\n        for(int i\x3d0; i\x3cmaxSamples; i++)\r\n        {\r\n          $atmosphereComputeSampleContribution\r\n        }\r\n\r\n        $atmosphereComputeHDRColors\r\n\r\n        $atmosphereComputePixelColor\r\n\r\n        //Debug variable overlay\r\n        if(showTest\x3e0.0){\r\n          gl_FragColor \x3d vec4(test,1.0);\r\n        }\r\n\r\n      } else {//Not on surface\r\n        gl_FragColor \x3d vec4(0.0);\r\n      }\r\n    } else {//Outside Atmosphere\r\n      gl_FragColor \x3d vec4(0.0);\r\n    }\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  attribute vec2 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n\r\n  void main(void) {\r\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\r\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n  uniform sampler2D tex;\r\n  varying vec2 vtc;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor;\r\n  }\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/StarMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderStar"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec4 viewport;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n  attribute float $size;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\t$alignToPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t\tvec4 posProj \x3d proj * view * model*vec4($position*1.0e25,1.0);//move infinitely far away\r\n\t\tgl_Position \x3d alignToPixelCenter(posProj, viewport.zw); //pixel align position\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n\t\tvcolor \x3d $color/1.2;\r\n\t\tvsize \x3d size*5.0;\r\n\t\tgl_PointSize \x3d vsize;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderStar"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\tvoid main() {\r\n\t\tfloat cap \x3d 0.7;\r\n\t\tfloat scale \x3d 1.0/cap;\r\n\t\tfloat helper \x3d clamp(length(abs(gl_PointCoord-vec2(0.5))),0.0,cap);\r\n\t\tfloat alpha \x3d clamp((cap-helper)*scale,0.0,1.0);\r\n\t\tfloat intensity \x3d alpha*alpha*alpha;\r\n\t\tif (vsize \x3c 3.0)\r\n\t\t\tintensity *\x3d 0.5;\r\n\t\tgl_FragColor \x3d vec4(1.0,1.0,1.0,intensity);\r\n\t\tgl_FragColor.xyz *\x3d vcolor.xyz;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderSimple"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderSimple"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform vec4 color;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderTexOnly"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4(position, 1.0)).xyz, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderTexOnly"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 color;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tgl_FragColor \x3d texColor * color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/ssao.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\t\x3csnippet name\x3d"createFsSSAOSrc"\x3e\x3c![CDATA[\r\n\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D rnm;\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform float\t\tssaoAtt;\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform float\t\tradius;\r\n\tuniform vec2\t\tnearFar;\r\n\tuniform vec3\t\tpSphere[64];\r\n\r\n\tvarying vec2\t\tuv;\r\n\r\n\tconst\tfloat\t\tstrength \x3d .07;\r\n\tconst\tfloat\t\tfalloff \x3d .000002;\r\n\r\n\t$rgba2float\r\n\tvoid main(void) {\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\t\tfloat currentPixelDepth \x3d rgba2float(texture2D(depthMap, uv));\r\n\t\tvec3 ep \x3d vec3(uv.xy, currentPixelDepth);\r\n\t\tvec3 norm \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, uv).xyz;\r\n\t\tfloat bl \x3d .0;\r\n\t\tfloat f \x3d mix(nearFar.x, nearFar.y, currentPixelDepth) / nearFar.x;\r\n\t\tfloat radD \x3d radius / f;\r\n\t\tradD \x3d min(radD, .5);\r\n\t\tfloat depthDifference;\r\n\t\tvec3 ray;\r\n\r\n\t\tfor(int i \x3d 0; i \x3c NUM_TAP_SAMPLES; ++i) {\r\n\t\t\tray \x3d radD*reflect(pSphere[i], fres);\r\n\t\t\tvec2 tc \x3d ep.xy + sign(dot(ray, norm) ) * ray.xy;\r\n\t\t\tif (tc.x \x3e\x3d .0 \x26\x26 tc.y \x3e\x3d .0 \x26\x26 tc.x \x3c\x3d 1.0 \x26\x26 tc.y \x3c\x3d 1.0) {\r\n\t\t\t\tfloat occluderDepth \x3d rgba2float(texture2D(depthMap, tc));\r\n\t\t\t\tvec3 occluderNormal \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, tc).xyz;\r\n\t\t\t\tdepthDifference \x3d currentPixelDepth - occluderDepth;\r\n\t\t\t\tbl +\x3d step(falloff, depthDifference) * (1.0 - dot(occluderNormal, norm)) * (1.0 - smoothstep(falloff, strength, depthDifference));\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tfloat ao \x3d 1.0 + bl * (-1.38 / float(NUM_TAP_SAMPLES)) * ssaoAtt;\r\n\t\tgl_FragColor.a \x3d ao;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"getDepthLinear"\x3e\x3c![CDATA[\r\n\tfloat getDepthLinear(vec2 ssC) {\r\n\t\treturn -(rgba2float(texture2D(depthMap, ssC))*(nearFar[1] - nearFar[0])+nearFar[0]);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"createFsSSAOSrcObscurance"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform mat4 projMatrixInv;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\r\n\tuniform float     intensity;\r\n\r\n\tuniform float projScale;\r\n\tuniform float     radius;\r\n\tuniform vec2      nearFar;\r\n\r\n\tuniform vec4      projInfo;\r\n\r\n\tuniform vec2\t  screenDimensions;\r\n\r\n\t//noise texture lookup could be replaced with hash function if WebGL gets XOR functionality\r\n\tuniform vec3\t\tpSphere[NUM_TAP_SAMPLES]; //tap position\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform sampler2D rnm; //noise texture\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\tvarying vec2  uv;\r\n\tvarying vec4  camPos;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\t/** Returns a unit vector and a screen-space radius for the tap on a unit disk (the caller should scale by the actual disk radius) */\r\n\t/*uniform float numSpiralTurns;\r\n\tvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\r\n\t\t// Radius relative to ssR\r\n\t\tfloat alpha \x3d (float(sampleNumber) + 0.5) * (1.0 / float(NUM_TAP_SAMPLES));\r\n\t\tfloat angle \x3d alpha * (numSpiralTurns * 6.28) + spinAngle;\r\n\r\n\t\tssR \x3d alpha;\r\n\t\treturn vec2(cos(angle), sin(angle));\r\n\t}*/\r\n\r\n\r\n\tfloat fallOffFunction(float vv, float vn, float bias) {\r\n\t  float radius2 \x3d radius * radius;\r\n\r\n\t\t// A: From the HPG12 paper\r\n\t\t// Note large epsilon to avoid overdarkening within cracks\r\n\t\t// return float(vv \x3c radius2) * max((vn - bias) / (epsilon + vv), 0.0) * radius2 * 0.6;\r\n\r\n\t\t// B: Smoother transition to zero (lowers contrast, smoothing out corners). [Recommended]\r\n\t\tfloat f \x3d max(radius2 - vv, 0.0); return f * f * f * max(vn-bias, 0.0);\r\n\r\n\t\t// C: Medium contrast (which looks better at high radii), no division.  Note that the\r\n\t\t// contribution still falls off with radius^2, but we\'ve adjusted the rate in a way that is\r\n\t\t// more computationally efficient and happens to be aesthetically pleasing.\r\n\t\t// return 4.0 * max(1.0 - vv * invRadius2, 0.0) * max(vn - bias, 0.0);\r\n\r\n\t\t// D: Low contrast, no division operation\r\n\t\t// return 2.0 * float(vv \x3c radius * radius) * max(vn - bias, 0.0);\r\n\t}\r\n\r\n\r\n\t/** Compute the occlusion due to sample point \\a Q about camera-space point \\a C with unit normal \\a n_C */\r\n\tfloat aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {\r\n\t\tvec3 v \x3d Q - C;\r\n\t\tfloat vv \x3d dot(v, v);\r\n\t\tfloat vn \x3d dot(normalize(v), n_C);\r\n\t\treturn fallOffFunction(vv, vn, 0.1);\r\n\t}\r\n\r\n\r\n\t/** Reconstruct camera-space P.xyz from screen-space S \x3d (x, y) in\r\n\t\tpixels and camera-space z \x3c 0.  Assumes that the upper-left pixel center\r\n\t\tis at (0.5, 0.5) [but that need not be the location at which the sample tap\r\n\t\twas placed!]\r\n\r\n\t\tCosts 3 MADD.  Error is on the order of 10^3 at the far plane, partly due to z precision.\r\n\t  */\r\n\tvec3 reconstructCSPosition(vec2 S, float z) {\r\n\t\treturn vec3(( (S.xy) * projInfo.xy + projInfo.zw)*(z*zScale.x+zScale.y), z);\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\t//Hash function used in the HPG12 AlchemyAO paper\r\n\t\t//Not supported in WebGL -\x3e using texture lookup as in old SSAO shader instead\r\n\t\t//ivec2 ssC \x3d ivec2(gl_FragCoord.xy);\r\n\t\t//float randomPatternRotationAngle \x3d float((3 * ssC.x ^ ssC.y + ssC.x * ssC.y) * 10);\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\r\n\t   float currentPixelDepth \x3d getDepthLinear(uv);\r\n\r\n\t   if (-currentPixelDepth\x3enearFar.y || -currentPixelDepth\x3cnearFar.x) {\r\n\t\tgl_FragColor \x3d vec4(0);\r\n\t\treturn;\r\n\t   }\r\n\r\n\t   vec3 currentPixelPos \x3d reconstructCSPosition(gl_FragCoord.xy,currentPixelDepth);\r\n\r\n\t   // get the normal of current fragment\r\n\t   vec4 norm4 \x3d texture2D(normalMap, uv);\r\n\t   vec3 norm \x3d vec3(-1.0) + 2.0 * norm4.xyz;\r\n\t   bool isTerrain \x3d norm4.w\x3c0.5;\r\n\r\n\t   float sum \x3d .0;\r\n\r\n\t   vec4 occluderFragment;\r\n\t   vec3 ray;\r\n\r\n\t   vec3 tapPixelPos;\r\n\r\n\t   // note: the factor 2.0 should not be necessary, but makes ssao much nicer.\r\n\t   // bug or deviation from CE somewhere else?\r\n\t   float ps \x3d projScale/(2.0*currentPixelPos.z*zScale.x+zScale.y);\r\n\r\n\t   for(int i \x3d 0; i \x3c NUM_TAP_SAMPLES; ++i)\r\n\t   {\r\n\t\t  // get a vector (randomized inside of a sphere with radius 1.0) from a texture and reflect it\r\n\t\t  //float ssR;\r\n\t\t  //vec2 unitOffset \x3d tapLocation(i, randomPatternRotationAngle, ssR);\r\n\t\t  // get the depth of the occluder fragment\r\n\t\t  //vec2 offset \x3d vec2(-unitOffset*radius*ssR*ps);\r\n\r\n\t\t  vec2 unitOffset \x3d reflect(pSphere[i], fres).xy;\r\n\t\t  vec2 offset \x3d vec2(-unitOffset*radius*ps);\r\n\r\n\r\n\t\t  //don\'t use current or very nearby samples\r\n\t\t  if ( abs(offset.x)\x3c2.0 || abs(offset.y)\x3c2.0) continue;\r\n\r\n\r\n\t\t  vec2 tc \x3d vec2(gl_FragCoord.xy + offset);\r\n\t\t  if (tc.x \x3c 0.0 || tc.y \x3c 0.0 || tc.x \x3e screenDimensions.x || tc.y \x3e screenDimensions.y) continue;\r\n\t\t  vec2 tcTap \x3d tc/screenDimensions;\r\n\t\t  float occluderFragmentDepth \x3d getDepthLinear(tcTap);\r\n\r\n\t\t  if (isTerrain) {\r\n\t\t  \tbool isTerrainTap \x3d texture2D(normalMap, tcTap).w\x3c0.5;\r\n\t\t  \tif (isTerrainTap)\r\n\t\t  \t\tcontinue;\r\n\t\t  }\r\n\r\n\t\t  tapPixelPos \x3d reconstructCSPosition(tc, occluderFragmentDepth);\r\n\r\n\t\t  sum+\x3d aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);\r\n\t   }\r\n\r\n\t   // output the result\r\n\r\n\t\tfloat A \x3d max(1.0-sum*intensity/float(NUM_TAP_SAMPLES),0.0);\r\n\r\n\t\t// Anti-tone map to reduce contrast and drag dark region farther\r\n\t\t// (x^0.2 + 1.2 * x^4)/2.2\r\n\t\tA \x3d (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\r\n\r\n\r\n\t   //gl_FragColor \x3d vec4(norm/2.0+0.5, 1.0);\r\n\t   //gl_FragColor \x3d vec4(-currentPixelDepth/1000.0);\r\n\t   //gl_FragColor \x3d vec4(tapPixelPos.x/100.0);\r\n\t   gl_FragColor \x3d vec4(A);\r\n\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsBlurEdgeAware"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform sampler2D tex;\r\n\r\n\r\n\tuniform vec2 blurSize;\r\n\r\n\r\n\tuniform float g_BlurFalloff;\r\n\tuniform float projScale;\r\n\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tuniform vec2\t\tnearFar;\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\tfloat BlurFunction(vec2 uv, float r, float center_d, inout float w_total, float sharpness)\r\n\t{\r\n\t\tfloat c \x3d texture2D(tex, uv).r;\r\n\t\tfloat d \x3d getDepthLinear(uv);\r\n\r\n\t\tfloat ddiff \x3d d - center_d;\r\n\r\n\t\tfloat w \x3d exp(-r*r*g_BlurFalloff - ddiff*ddiff*sharpness);\r\n\r\n\t\tw_total +\x3d w;\r\n\r\n\t\treturn w*c;\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\tfloat b \x3d 0.0;\r\n\t\tfloat w_total \x3d 0.0;\r\n\r\n\t\tfloat center_d \x3d  getDepthLinear(uv);\r\n\r\n\t\tfloat sharpness \x3d -0.05*projScale/(center_d*zScale.x+zScale.y);\r\n\t\tfor (int r \x3d -RADIUS; r \x3c\x3d RADIUS; ++r)\r\n\t\t{\r\n\t\t\tfloat rf \x3d float(r);\r\n\t\t\tvec2 uvOffset \x3d uv + rf*blurSize;\r\n\t\t\tb +\x3d BlurFunction(uvOffset, rf, center_d, w_total, sharpness);\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d vec4(b/w_total);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc0"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform float blurSize;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main() {\r\n\t\tint rad \x3d RADIUS - 1;\r\n\r\n\t\tvec4 sum \x3d vec4(0.0);\r\n\t\tfor (int k \x3d -RADIUS; k \x3c\x3d RADIUS; ++k) { \t\t// NOTE for-variable-init must be a const expression\r\n\t\t\tfloat fi \x3d float(k);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc1"\x3e\x3c![CDATA[\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d sum / float(RADIUS * RADIUS);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurH"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x + fi * blurSize, uv.y)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurV"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x, uv.y + fi * blurSize)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/highlight.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\nSmartly downsamples a texture, halfing its resolution. This allows for a square\r\nscreen region to check if none, any or all pixels were set.\r\n\r\nThe red channel is always ceiled after interpolating the 4 merged pixels.\r\nThis allows to evaluate:\r\nany(pixels.red !\x3d 0.0) as red \x3d\x3d 1.0\r\nnone(pixels.red !\x3d 0.0) as red \x3d\x3d 0.0\r\n\r\nThe green and blue channels are set to floor(max(green, blue)).\r\nThis allows to evaluate:\r\nall(pixels.green || pixels.blue) as green \x3d\x3d 1.0\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\r\n\x3csnippet name\x3d"vsConservativeDownsample"\x3e\x3c![CDATA[\r\n\r\n  $vsprecisionf\r\n\r\n  attribute vec2 $position;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4(vec2(1.0) - $position * 2.0, .0, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsConservativeDownsample"\x3e\x3c![CDATA[\r\n\r\n  $fsprecisionf\r\n\r\n  uniform sampler2D tex;\r\n  uniform vec2 invFramebufferDim;\r\n\r\n  void main()\r\n  {\r\n    vec2 coord \x3d gl_FragCoord.xy * invFramebufferDim;\r\n    vec4 value \x3d texture2D(tex, coord);\r\n    float mx \x3d floor(max(value.g, value.b));\r\n    gl_FragColor \x3d vec4(ceil(value.r), mx, mx, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\nGaussian blur with linear sampling. Supports different number of samples, but\r\nonly 5 samples have proper weights. Uses linear texture interpolation to reduce\r\nthe number of samples taken.\r\n\r\nDefines:\r\nGRID_OPTIMIZATION (set or !set)\r\nGAUSSIAN_SAMPLES (3,5,7)\r\n\r\nThis technique requires linear filtering on source texture\r\nhttp://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurFastGaussian"\x3e\x3c![CDATA[\r\n\r\n  $vsprecisionf\r\n\r\n  attribute vec2 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  #ifdef GRID_OPTIMIZATION\r\n    uniform sampler2D coverageTex;\r\n    varying vec3 blurCoordinate;\r\n  #else\r\n    uniform vec2 blurSize;\r\n    varying vec2 blurCoordinates[GAUSSIAN_SAMPLES];\r\n  #endif\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position, 0.0, 1.0);\r\n\r\n    #ifdef GRID_OPTIMIZATION\r\n      // sample the coverage texture at the block center\r\n      // and if no coverage detected, create degenerate triangle\r\n      vec4 cov \x3d texture2D(coverageTex, $uv0);\r\n      if (cov.r \x3d\x3d 0.0) {\r\n        gl_Position \x3d vec4(0,0,0,0);\r\n      }\r\n\r\n      // create texture coordinate for blur center\r\n      // encode information about fully inside block in z coordinate\r\n      blurCoordinate \x3d vec3(gl_Position.xy * .5 + vec2(.5), max(cov.g, cov.b));\r\n    #else\r\n      vec2 uv \x3d $position.xy * .5 + vec2(.5);\r\n\r\n      #if GAUSSIAN_SAMPLES \x3d\x3d 3\r\n        // not proper gaussian weights\r\n        blurCoordinates[0] \x3d uv;\r\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 5\r\n        blurCoordinates[0] \x3d uv;\r\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n        blurCoordinates[3] \x3d uv + blurSize * 3.294215;\r\n        blurCoordinates[4] \x3d uv - blurSize * 3.294215;\r\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 7\r\n        // not proper gaussian weights\r\n        blurCoordinates[0] \x3d uv;\r\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n        blurCoordinates[3] \x3d uv + blurSize * 3.294215;\r\n        blurCoordinates[4] \x3d uv - blurSize * 3.294215;\r\n        blurCoordinates[5] \x3d uv + blurSize * 5.1;\r\n        blurCoordinates[6] \x3d uv - blurSize * 5.1;\r\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 9\r\n        // not proper gaussian weights\r\n        blurCoordinates[0] \x3d uv;\r\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n        blurCoordinates[3] \x3d uv + blurSize * 3.294215;\r\n        blurCoordinates[4] \x3d uv - blurSize * 3.294215;\r\n        blurCoordinates[5] \x3d uv + blurSize * 5.1;\r\n        blurCoordinates[6] \x3d uv - blurSize * 5.1;\r\n        blurCoordinates[7] \x3d uv + blurSize * 7.1;\r\n        blurCoordinates[8] \x3d uv - blurSize * 7.1;\r\n      #endif\r\n    #endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurFastGaussian"\x3e\x3c![CDATA[\r\n\r\n  $fsprecisionf\r\n\r\n  uniform sampler2D tex;\r\n\r\n  #ifdef GRID_OPTIMIZATION\r\n    uniform vec2 blurSize;\r\n    varying vec3 blurCoordinate;\r\n  #else\r\n    varying vec2 blurCoordinates[GAUSSIAN_SAMPLES];\r\n  #endif\r\n\r\n  void main()\r\n  {\r\n    #ifdef GRID_OPTIMIZATION\r\n      vec2 uv \x3d blurCoordinate.xy;\r\n      vec4 center \x3d texture2D(tex, uv);\r\n\r\n      // do not blur if no pixel or all pixels in neighborhood are set\r\n      if (blurCoordinate.z \x3d\x3d 1.0) {\r\n        gl_FragColor \x3d center;\r\n      }\r\n      else {\r\n        vec4 sum \x3d vec4(0.0);\r\n\r\n        #if GAUSSIAN_SAMPLES \x3d\x3d 3\r\n          // not proper gaussian weights\r\n          sum +\x3d center * 0.204164;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\r\n        #elif GAUSSIAN_SAMPLES \x3d\x3d 5\r\n          sum +\x3d center * 0.204164;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 3.294215) * 0.093913;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 3.294215) * 0.093913;\r\n        #elif GAUSSIAN_SAMPLES \x3d\x3d 7\r\n          // not proper gaussian weights\r\n          sum +\x3d center * 0.204164;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 3.294215) * 0.093913;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 3.294215) * 0.093913;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 5.1) * 0.03;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 5.1) * 0.03;\r\n        #elif GAUSSIAN_SAMPLES \x3d\x3d 9\r\n          // not proper gaussian weights\r\n          sum +\x3d center * 0.154164;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 1.5) * 0.204005;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 1.5) * 0.204005;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 3.5) * 0.123913;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 3.5) * 0.123913;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 5.5) * 0.123913;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 5.5) * 0.123913;\r\n          sum +\x3d texture2D(tex, uv + blurSize * 7.5) * 0.05;\r\n          sum +\x3d texture2D(tex, uv - blurSize * 7.5) * 0.05;\r\n        #endif\r\n\r\n        gl_FragColor \x3d sum;\r\n      }\r\n    #else\r\n      vec4 sum \x3d vec4(0.0);\r\n\r\n      #if GAUSSIAN_SAMPLES \x3d\x3d 3\r\n        // not proper gaussian weights\r\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\r\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\r\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 5\r\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\r\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\r\n        sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\r\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 7\r\n        // not proper gaussian weights\r\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\r\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\r\n        sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\r\n        sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.03;\r\n        sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.03;\r\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 9\r\n        // not proper gaussian weights\r\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.154164;\r\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.204005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.204005;\r\n        sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.123913;\r\n        sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.123913;\r\n        sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.09;\r\n        sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.09;\r\n        sum +\x3d texture2D(tex, blurCoordinates[7]) * 0.05;\r\n        sum +\x3d texture2D(tex, blurCoordinates[8]) * 0.05;\r\n      #endif\r\n\r\n      gl_FragColor \x3d sum;\r\n    #endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\nMerging blurred outlines with source image, advanced version\r\n\r\nDefines:\r\nGRID_OPTIMIZATION (set or !set)\r\nGRID_DEBUG (set or !set)\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  $vsprecisionf\r\n\r\n  attribute vec2 $position;\r\n  varying vec2 uv;\r\n\r\n  #ifdef GRID_OPTIMIZATION\r\n    attribute vec2 $uv0;\r\n    uniform sampler2D coverageTex;\r\n  #endif\r\n\r\n  void main()\r\n  {\r\n    #ifdef GRID_OPTIMIZATION\r\n      #ifdef GRID_DEBUG\r\n        vec4 cov \x3d texture2D(coverageTex, $uv0);\r\n        // if no highlight pixel set in this block,\r\n        // or all pixels set, hide block\r\n        if (cov.r \x3d\x3d 0.0 || cov.g \x3d\x3d 1.0 || cov.b \x3d\x3d 1.0) {\r\n          gl_Position \x3d vec4(0,0,0,0);\r\n          return;\r\n        }\r\n        gl_Position \x3d vec4($position, .0, 1.0);\r\n        uv \x3d $uv0;\r\n        return;\r\n      #else\r\n        vec4 cov \x3d texture2D(coverageTex, $uv0);\r\n        // if no highlight pixel set in this block, hide block\r\n        if (cov.r \x3d\x3d 0.0) {\r\n          gl_Position \x3d vec4(0,0,0,0);\r\n          return;\r\n        }\r\n      #endif\r\n    #endif\r\n\r\n    gl_Position \x3d vec4($position, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  $fsprecisionf\r\n\r\n  uniform sampler2D tex;\r\n  uniform sampler2D origin;\r\n\r\n  uniform vec4 color;\r\n  uniform float outlineSize;\r\n  uniform float blurSize;\r\n  uniform vec4 opacities; // [outline, outlineOccluded, fill, fillOccluded]\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    #if defined(GRID_OPTIMIZATION) \x26\x26 defined(GRID_DEBUG)\r\n      gl_FragColor \x3d vec4(uv, 0, 1.0);\r\n    #else\r\n      // Read the highlight intensity from the blurred highlight image\r\n      vec4 blurredHighlightValue \x3d texture2D(tex, uv);\r\n      float highlightIntensity \x3d blurredHighlightValue.a;\r\n\r\n      // Discard all pixels which are not affected by highlight\r\n      if (highlightIntensity \x3d\x3d 0.0) {\r\n        discard;\r\n      }\r\n\r\n      vec4 origin_color \x3d texture2D(origin, uv);\r\n\r\n      float outlineIntensity;\r\n      float fillIntensity;\r\n\r\n      // if occluded\r\n      if (blurredHighlightValue.g \x3e blurredHighlightValue.b) {\r\n        outlineIntensity \x3d color.w * opacities[1];\r\n        fillIntensity \x3d color.w * opacities[3];\r\n      }\r\n      // if unoccluded\r\n      else {\r\n        outlineIntensity \x3d color.w * opacities[0];\r\n        fillIntensity \x3d color.w * opacities[2];\r\n      }\r\n\r\n      float inner \x3d 1.0 - outlineSize / 9.0;\r\n      float outer \x3d 1.0 - (outlineSize + blurSize) / 9.0;\r\n\r\n      float outlineFactor \x3d smoothstep(outer, inner, highlightIntensity);\r\n      //float fillFactor \x3d smoothstep(0.6, 0.72, highlightIntensity);\r\n      float fillFactor \x3d any(notEqual(origin_color, vec4(0.0, 0.0, 0.0, 0.0))) ? 1.0 : 0.0;\r\n      float intensity \x3d outlineIntensity * outlineFactor * (1.0 - fillFactor) + fillIntensity * fillFactor;\r\n\r\n      // Blending equation: gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n      // I.e., color should not be premultiplied with alpha\r\n      gl_FragColor \x3d vec4(color.xyz, intensity);\r\n    #endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/util.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"alignToPixelCenter"\x3e\x3c![CDATA[\r\n  vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\r\n    // From clip space to (0 : 1), bias towards right pixel edge\r\n    vec2 xy \x3d vec2(.500123) + .5 * clipCoord.xy / clipCoord.w;\r\n\r\n    // Size of a pixel in range (0 : 1)\r\n    vec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\r\n    // Round to nearest pixel center\r\n    vec2 ij \x3d (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\r\n\r\n    // Convert back to clip space\r\n    vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\r\n    return vec4(result, clipCoord.zw);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"alignToPixelOrigin"\x3e\x3c![CDATA[\r\n  vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\r\n    // From clip space to (0 : 1),\r\n    vec2 xy \x3d vec2(.5) + .5 * clipCoord.xy / clipCoord.w;\r\n\r\n    // Size of a pixel in range (0 : 1)\r\n    vec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\r\n    // Round to nearest pixel border, (0 : 1)\r\n    vec2 ij \x3d floor((xy + .5 * pixelSz) * widthHeight) * pixelSz;\r\n\r\n    // Convert back to clip space\r\n    vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\r\n    return vec4(result, clipCoord.zw);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"float2rgba"\x3e\x3c![CDATA[\r\n\tvec4 float2rgba(const in float v) {\r\n\t\tvec4 enc \x3d vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\r\n\t\tenc \x3d fract(enc);\r\n\t\tenc -\x3d enc.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0);\r\n\t\treturn enc;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"rgba2float"\x3e\x3c![CDATA[\r\n\tfloat rgba2float(vec4 rgba) {\r\n\t\treturn dot(rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0));\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"calcFragDepth"\x3e\x3c![CDATA[\r\n\t#extension GL_OES_standard_derivatives : enable\r\n\r\n\tfloat calcFragDepth(const in float depth) {\r\n\t\t//calc polygon offset\r\n\t\tconst float SLOPE_SCALE \x3d 2.0;\r\n\t\tconst float BIAS \x3d 2.0 * .000015259;\t\t// 1 / (2^16 - 1)\r\n\t\tfloat m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\r\n\t\tfloat result \x3d depth + SLOPE_SCALE * m + BIAS;\r\n\t\treturn clamp(result, .0, .999999);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"evalShadow"\x3e\x3c![CDATA[\r\n\t$rgba2float\r\n\r\n\t// "matrix" parameter used to have const qualifier as well, but IE11 couldn\'t deal with it at time of writing.\r\n\t// once IE11 is fine with it, const should probably be re-introduced\r\n\tfloat evalShadow(const in vec3 vpos, const in float depth, const in sampler2D depthTex, const int num, const in vec4 distance, in mat4 matrix[4], const in float halfPxSz) {\r\n\t\t//choose correct cascade\r\n\t\tint i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\r\n\r\n\t\tif (i \x3e\x3d num) return .0;\r\n\r\n\t\tmat4 mat \x3d i \x3d\x3d 0 ? matrix[0] : i \x3d\x3d 1 ? matrix[1] : i \x3d\x3d 2 ? matrix[2] : matrix[3];\r\n\r\n\t\tvec4 lv \x3d mat * vec4(vpos, 1.0);\r\n\t\tlv.xy /\x3d lv.w;\r\n\r\n\t\t//vertex completely outside? -\x3e no shadow\r\n\t\tvec3 lvpos \x3d .5 * lv.xyz + vec3(.5);\r\n\t\tif (lvpos.z \x3e\x3d 1.0) return .0;\r\n\t\tif (lvpos.x \x3c .0 || lvpos.x \x3e 1.0 || lvpos.y \x3c .0 || lvpos.y \x3e 1.0) return .0;\r\n\r\n\t\t//calc coord in cascade texture\r\n\t\tvec2 uv \x3d vec2(float(i - 2 * (i / 2)) *.5, float(i / 2) * .5) + .5 * lvpos.xy;\r\n\r\n\t\tfloat texSize \x3d .5 / halfPxSz;\r\n\r\n\t\t//filter, offset by half pixels\r\n\t\tvec2 st \x3d fract((vec2(halfPxSz) + uv) * texSize);\r\n\r\n\t\tfloat s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\t\tfloat s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\r\n\r\n\t\treturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\tScene Lighting Definitions:\r\n\t\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n\r\n\tdefines:\r\n\t\t- SH_ORDER: 1|2|3\r\n\tinput:\r\n\t\t- normal: vec3\r\n\t\t- albedo: vec3\r\n\t  - shadow: float\r\n\t\t- ssao: float\r\n\treturn:\r\n\t  - color: vec3\r\n--\x3e\r\n\x3csnippet name\x3d"sceneLightingDefinitions"\x3e\x3c![CDATA[\r\n\t$viewingMode\r\n\r\n\t// main light\r\n\t/////////////////////////////////////////\r\n\tuniform vec3 lightingMainDirection;\r\n\tuniform vec3 lightingMainIntensity;\r\n\r\n\t// ambient lighting\r\n\t/////////////////////////////////////////\r\n\t#ifndef SH_ORDER\r\n\t\t#define SH_ORDER 2\r\n\t#endif\r\n\r\n\t#if SH_ORDER \x3d\x3d 0\r\n\t\tuniform vec3 lightingAmbientSH0;\r\n\t#elif SH_ORDER \x3d\x3d 1\r\n\t\tuniform vec4 lightingAmbientSH_R;\r\n\t\tuniform vec4 lightingAmbientSH_G;\r\n\t\tuniform vec4 lightingAmbientSH_B;\r\n\t#elif SH_ORDER \x3d\x3d 2\r\n\t\tuniform vec3 lightingAmbientSH0;\r\n\t\tuniform vec4 lightingAmbientSH_R1;\r\n\t\tuniform vec4 lightingAmbientSH_G1;\r\n\t\tuniform vec4 lightingAmbientSH_B1;\r\n\t\tuniform vec4 lightingAmbientSH_R2;\r\n\t\tuniform vec4 lightingAmbientSH_G2;\r\n\t\tuniform vec4 lightingAmbientSH_B2;\r\n\t#endif\r\n\r\n\t// special tweaking\r\n\t//////////////////////////////////////////\r\n\t\tuniform float lightingFixedFactor;\r\n\t\tuniform float lightingGlobalFactor;\r\n\r\n\t\tuniform float ambientBoostFactor;\r\n\r\n\t// evaluation\r\n\t//////////////////////////////////////////\r\n\r\n\tvec3 evaluateSceneLighting(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\r\n\t\t// evaluate the main light\r\n\t\tfloat dotVal \x3d mix(clamp(-dot(normal, lightingMainDirection), 0.0, 1.0), 1.0, lightingFixedFactor);\r\n\t\tvec3 mainLight \x3d (1.0 - shadow) * lightingMainIntensity * dotVal;\r\n\r\n\t\t// evaluate the sh ambient light\r\n\t\t#if SH_ORDER \x3d\x3d 0\r\n\t\t\tvec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\r\n\t\t#elif SH_ORDER \x3d\x3d 1\r\n\t\t\tvec4 sh0 \x3d vec4(\r\n\t\t\t\t0.282095,\r\n\t\t\t\t0.488603 * normal.x,\r\n\t\t\t\t0.488603 * normal.z,\r\n\t\t\t\t0.488603 * normal.y\r\n\t\t\t);\r\n\t\t\tvec3 ambientLight \x3d vec3(\r\n\t\t\t\tdot(lightingAmbientSH_R, sh0),\r\n\t\t\t\tdot(lightingAmbientSH_G, sh0),\r\n\t\t\t\tdot(lightingAmbientSH_B, sh0)\r\n\t\t\t);\r\n\t\t#elif SH_ORDER \x3d\x3d 2\r\n\t\t\tvec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\r\n\r\n\t\t\tvec4 sh1 \x3d vec4(\r\n\t\t\t\t0.488603 * normal.x,\r\n\t\t\t\t0.488603 * normal.z,\r\n\t\t\t\t0.488603 * normal.y,\r\n\t\t\t\t1.092548 * normal.x * normal.y\r\n\t\t\t);\r\n\t\t\tvec4 sh2 \x3d vec4(\r\n\t\t\t\t1.092548 * normal.y * normal.z,\r\n\t\t\t\t0.315392 * (3.0 * normal.z * normal.z - 1.0),\r\n\t\t\t\t1.092548 * normal.x * normal.z,\r\n\t\t\t\t0.546274 * (normal.x * normal.x - normal.y * normal.y)\r\n\t\t\t);\r\n\t\t\tambientLight +\x3d vec3(\r\n\t\t\t\tdot(lightingAmbientSH_R1, sh1),\r\n\t\t\t\tdot(lightingAmbientSH_G1, sh1),\r\n\t\t\t\tdot(lightingAmbientSH_B1, sh1)\r\n\t\t\t);\r\n\t\t\tambientLight +\x3d vec3(\r\n\t\t\t\tdot(lightingAmbientSH_R2, sh2),\r\n\t\t\t\tdot(lightingAmbientSH_G2, sh2),\r\n\t\t\t\tdot(lightingAmbientSH_B2, sh2)\r\n\t\t\t);\r\n\t\t#endif\r\n\t\tambientLight *\x3d (1.0 - ssao);\r\n\r\n\t\t// inverse gamma correction on the albedo color\r\n\t\tfloat gamma \x3d 2.1;\r\n\t\tvec3 albedoGammaC \x3d pow(albedo, vec3(gamma));\r\n\r\n\t\t// physically correct BRDF normalizes by PI\r\n\t\tconst float PI \x3d 3.14159;\r\n\t\tvec3 totalLight \x3d mainLight + ambientLight + additionalLight;\r\n\t\ttotalLight \x3d min(totalLight, vec3(PI, PI, PI));\r\n\t\tvec3 outColor \x3d vec3((albedoGammaC / PI) * (totalLight));\r\n\r\n\t\t// apply gamma correction to the computed color\r\n\t\toutColor \x3d pow(outColor, vec3(1.0/gamma));\r\n\r\n\t\treturn outColor;\r\n\t}\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"sceneLightingAdditionalLightGlobal"\x3e\x3c![CDATA[\r\n\t// heuristic lighting model originally used in the terrain shading\r\n\t// now used to generated additional ambient light\r\n\t#ifdef VIEWING_MODE_GLOBAL\r\n\t\tfloat vndl \x3d -dot(normalize(vpos + localOrigin), lightingMainDirection);\r\n\t#else\r\n\t\tfloat vndl \x3d -dot(vec3(0,0,1), lightingMainDirection);\r\n\t#endif\r\n\tfloat additionalAmbientScale \x3d smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));\r\n\tvec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"normal2envTC"\x3e\x3c![CDATA[\r\n\tvec2 normal2envTC(vec3 normal) {\r\n\t\tfloat v \x3d .5 + .5 * asin(normal.y) * 0.63661977;\r\n\t\tfloat u \x3d .5 - .5 * atan(normal.z, normal.x) * 0.31830988;\r\n\t\treturn vec2(u, v);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderShowDepth"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tattribute vec2 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * vec4($position.x, $position.y, .0, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fragmentShaderShowDepth"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D depthTex;\r\n\tvarying vec2 vtc;\r\n\t$rgba2float\r\n\tvoid main() {\r\n\t//\tgl_FragColor \x3d vec4(vec3(texture2D(depthTex, vtc).a), 1.0);\r\n\t\tgl_FragColor \x3d vec4(rgba2float(texture2D(depthTex, vtc)));\r\n\t//\tgl_FragColor \x3d texture2D(depthTex, vtc);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsUVQuad"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec2 $position;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n\t\tuv \x3d $position * .5 + vec2(.5);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toScreenCoords"\x3e\x3c![CDATA[\r\n\tvec4 toScreenCoords(vec3 vertex) {\r\n\t\tvec4 vClipSpace \x3d proj * view * vec4((model * vec4(vertex, 1.0)).xyz, 1.0);\r\n\t\tvClipSpace.xy *\x3d screenSize;\r\n\t\treturn vClipSpace/abs(vClipSpace.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vvUniforms"\x3e\x3c![CDATA[\r\n#if defined(VV_SIZE)\r\n\t#define VV_CUSTOM_MODEL_MATRIX\r\n#endif\r\n\r\n#if defined(VV_SIZE)\r\n\tuniform vec3 vvSizeMinSize;\r\n\tuniform vec3 vvSizeMaxSize;\r\n\tuniform vec3 vvSizeOffset;\r\n\tuniform vec3 vvSizeFactor;\r\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tuniform vec3 vvSizeValue;\r\n#endif\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\tuniform mat3 vvSymbolRotation;\r\n#endif\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\tuniform vec3 vvSymbolAnchor;\r\n#endif\r\n\r\n#ifdef VV_COLOR\r\n\t#define VV_COLOR_N 8\r\n\tuniform float vvColorValues[VV_COLOR_N];\r\n\tuniform vec4 vvColorColors[VV_COLOR_N];\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vvFunctions"\x3e\x3c![CDATA[\r\n// Evaluation of size\r\n#if defined(VV_SIZE)\r\n\tvec3 vvGetScale(vec4 featureAttribute) {\r\n\t\treturn clamp(vvSizeOffset + featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\r\n\t}\r\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tvec3 vvGetScale(vec4 featureAttribute) {\r\n\t\treturn vvSizeValue;\r\n\t}\r\n#endif\r\n\r\n// Applying the model matrix\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\tvec4 vvTransformPosition(vec3 position, vec4 featureAttribute) {\r\n\t\treturn vec4(vvSymbolRotation * (vvGetScale(featureAttribute) * (position + vvSymbolAnchor)), 1.0);\r\n\t}\r\n\r\n\tvec4 vvTransformNormal(vec3 normal, vec4 featureAttribute) {\r\n\t\t// Normal transform is the inverse transpose of model transform\r\n\t\treturn vec4(vvSymbolRotation * normal / vvGetScale(featureAttribute), 1.0);\r\n\t}\r\n#endif\r\n\r\n#ifdef VV_COLOR\r\n\tvec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\r\n\t\tfloat value \x3d featureAttribute.y;\r\n\t\tif (value \x3c\x3d values[0]) {\r\n\t\t\treturn colors[0];\r\n\t\t}\r\n\r\n\t\tfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n\t\t\tif (values[i] \x3e\x3d value) {\r\n\t\t\t\tfloat f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\r\n\t\t\t\treturn mix(colors[i-1], colors[i], f);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn colors[VV_COLOR_N - 1];\r\n\t}\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"rgb2hsv"\x3e\x3c![CDATA[\r\nvec3 rgb2hsv(vec3 c)\r\n{\r\n\tvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n\tvec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\r\n\tvec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\r\n\r\n\tfloat d \x3d q.x - min(q.w, q.y);\r\n\tfloat e \x3d 1.0e-10;\r\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"hsv2rgb"\x3e\x3c![CDATA[\r\nvec3 hsv2rgb(vec3 c)\r\n{\r\n\tvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n\tvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"colorMixMode"\x3e\x3c![CDATA[\r\n$rgb2hsv\r\n$hsv2rgb\r\n\r\n\r\n/*\r\n * The color mix modes are encoded in the symbol color as follows:\r\n *  - Fully transparent symbols are represented with alpha 0 for\r\n *    all color mix modes (except ignore).\r\n *  - color mix mode ignore is encoded as multiply with white\r\n *  - the other 3 color mix modes (tint, replace, multiply) are\r\n *    equally distributed on the remaining 255 alpha values, which\r\n *    gives us 85 possible alpha values\r\n *\r\n * alpha             0 : fully transparent\r\n * alpha in [  1 -  85]: tint\r\n * alpha in [ 86 - 170]: replace\r\n * alpha in [171 - 255]: multiply\r\n */\r\nvec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\r\n  float symbolAlpha \x3d 0.0;\r\n\r\n  const float maxTint \x3d 85.0;\r\n  const float maxReplace \x3d 170.0;\r\n  const float scaleAlpha \x3d 3.0;\r\n\r\n  if (symbolColor.a \x3d\x3d 0.0) {\r\n    colorMixMode \x3d 1; // fully transparent -\x3e multiply\r\n    symbolAlpha \x3d 0.0;\r\n  }\r\n  else if (symbolColor.a \x3c\x3d maxTint) {\r\n    colorMixMode \x3d 0; // tint\r\n    symbolAlpha \x3d scaleAlpha * symbolColor.a;\r\n  }\r\n  else if (symbolColor.a \x3c\x3d maxReplace) {\r\n    colorMixMode \x3d 3; // replace\r\n    symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxTint);\r\n  }\r\n  else {\r\n    colorMixMode \x3d 1;  // multiply\r\n    symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxReplace);\r\n  }\r\n\r\n  return vec4(symbolColor.rgb, symbolAlpha);\r\n}\r\n\r\nvec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\r\n  if (mode \x3d\x3d 1 /* multiply */) {\r\n    return internalColor * textureColor * externalColor;\r\n  }\r\n  else if (mode \x3d\x3d 2 /* ignore */ ) {\r\n    return internalColor * textureColor;\r\n  }\r\n  else if (mode \x3d\x3d 3 /* replace */ ) {\r\n    return externalColor;\r\n  }\r\n  else {\r\n    // tint (or something invalid)\r\n    vec3 hsvIn \x3d rgb2hsv(internalColor * textureColor);\r\n    vec3 hsvTint \x3d rgb2hsv(externalColor);\r\n    vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, hsvIn.z * hsvTint.z);\r\n    return hsv2rgb(hsvOut);\r\n  }\r\n}\r\n\r\nfloat mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\r\n  if (mode \x3d\x3d 2 /* ignore */ ) {\r\n    return internalOpacity * textureOpacity;\r\n  }\r\n  else if (mode \x3d\x3d 3 /* replace */ ) {\r\n    return externalOpacity;\r\n  }\r\n  else {\r\n    // multiply or tint (or something invalid)\r\n    return internalOpacity * textureOpacity * externalOpacity;\r\n  }\r\n}\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"highlightWrite"\x3e\x3c![CDATA[\r\n  // the following uniforms are common to all highlight shaders:\r\n  // uniform sampler2D depthTex\r\n  // uniform vec4 highlightViewportPixelSz\r\n  float sceneDepth \x3d texture2D(depthTex, (gl_FragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\r\n  if (gl_FragCoord.z \x3e sceneDepth + 5e-6) {\r\n    gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\r\n  }\r\n  else {\r\n    gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"screenSizePerspective"\x3e\x3c![CDATA[\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n// These could be functions, but I wanted to make sure that they are inlined. Additionally,\r\n// as macros, applying the scale works also for different types (float, vec2, etc).\r\n// Note that the implementation here should be kept in sync with the corresponding\r\n// CPU implementation (used for hitTest etc) in screenSizePerspectiveUtils.ts\r\n\r\n// Transform the input minimum size (factor.z) so that, when comparing to it, we are\r\n// excluding the \'padding\' size (factor.w).\r\n#define screenSizePerspectiveMinSize(/* float */ size, /* vec4 */ factor) (factor.z * (1.0 + 2.0 * factor.w  / size))\r\n\r\n#define screenSizePerspectiveFactor(/* float */ absCosAngle) (absCosAngle * absCosAngle * absCosAngle)\r\n\r\n#define screenSizePerspectiveScaleFactor(/* float */ absCosAngle, /* float */ distanceToCamera, /* vec4 */ params) vec4(min(params.x / (distanceToCamera - params.y), 1.0), screenSizePerspectiveFactor(absCosAngle), params.z, params.w)\r\n\r\n// Factor is computed from screenSizePerspectiveScaleFactor\r\n#define applyScreenSizePerspectiveScaleFactorFloat(/* float */ size, /* vec4 */ factor) max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor))\r\n#define screenSizePerspectiveScaleFloat(/* float */ size, /* float */ absCosAngle, /* float */ distanceToCamera, /* vec4 */ params) applyScreenSizePerspectiveScaleFactorFloat(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params))\r\n\r\n#define applyScreenSizePerspectiveScaleFactorVec2(/* vec2 */ size, /* vec4 */ factor) mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y)\r\n#define screenSizePerspectiveScaleVec2(/* vec2 */ size, /* float */ absCosAngle, /* float */ distanceToCamera, /* vec4 */ params) applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params))\r\n\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"selectShadingNormal"\x3e\x3c![CDATA[\r\n\t#ifdef GROUND_NORMAL_SHADING\r\n\t\t#ifdef VIEWING_MODE_GLOBAL\r\n\t\t\tvec3 shadingNormal \x3d normalize(vpos + localOrigin);\r\n\t\t#else\r\n\t\t\tvec3 shadingNormal \x3d vec3(0,0,1);\r\n\t\t#endif\r\n\t#else\r\n\t\tvec3 shadingNormal \x3d normal;\r\n\t#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/hud.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"commonAttributesAndUniformsHUD"\x3e\x3c![CDATA[\r\n  attribute vec3 $position;\r\n  attribute vec3 $normal;\r\n  attribute vec4 $auxpos1;\r\n\r\n  uniform mat4 proj;\r\n\r\n  uniform mat4 view;\r\n  uniform mat4 viewNormal;\r\n\r\n  uniform mat4 model;\r\n  uniform mat4 modelNormal;\r\n\r\n  uniform vec4 viewport;\r\n\r\n  uniform vec3 camPos;\r\n\r\n  uniform float polygonOffset;\r\n  uniform float cameraGroundRelative;\r\n\r\n#ifdef VERTICAL_OFFSET\r\n\r\n  // [ screenLength, distanceFactor, minWorldLength, maxWorldLength ]\r\n  uniform vec4 verticalOffset;\r\n\r\n#endif\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n  // [ divisor, offset, minPixelSize, paddingPixels ]\r\n  uniform vec4 screenSizePerspectiveAlignment;\r\n\r\n#endif\r\n\r\n  uniform sampler2D hudVisibilityTexture;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"projectPositionHUD"\x3e\x3c![CDATA[\r\n  $screenSizePerspective\r\n\r\n  // Corresponds to cos(10 deg), used to compare against dot product of two vectors\r\n  const float SMALL_OFFSET_ANGLE \x3d 0.984807753012208;\r\n\r\n  struct ProjectHUDAux {\r\n    vec3 posModel;\r\n    vec3 posView;\r\n    vec3 vnormal;\r\n\r\n    float distanceToCamera;\r\n    float absCosAngle;\r\n  };\r\n\r\n\r\n  /**\r\n   * Apply the simulated polygon offset for HUD objects that improves\r\n   * issues with Z-fighting.\r\n   *\r\n   * @param posView {vec3} (inout) the position in view space. Will be modified in place.\r\n   * @param pointGroundDistance {float} the distance from the point geometry to the ground surface.\r\n   * @param absCosAngle {float} the absolute cosine of the angle between the world-up at the point geometry\r\n   *   and the view direction.\r\n   *\r\n   * Dependencies:\r\n   *\r\n   *   Attributes:\r\n   *     - auxpos1: contains centerOffset and pointGroundDistance\r\n   *\r\n   *   Uniforms:\r\n   *     - cameraGroundRelative: indicates whether camera is above (1) or below (-1) ground.\r\n   *         This is used for emulated polygon offset for improved visibility of points sitting on the surface.\r\n   *     - polygonOffset: a constant polygon offset to bring the point closer to the viewer for\r\n   *         reduced flickering.\r\n   *     - viewport: the viewport [x, y, width, height]\r\n   */\r\n  float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\r\n    float pointGroundSign \x3d sign(pointGroundDistance);\r\n\r\n    if (pointGroundSign \x3d\x3d 0.0) {\r\n      pointGroundSign \x3d 1.0;\r\n    }\r\n\r\n    // cameraGroundRelative is -1 if camera is below ground, 1 if above ground\r\n    // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\r\n    float groundRelative \x3d cameraGroundRelative * pointGroundSign;\r\n\r\n    // view angle dependent part of polygon offset emulation\r\n    // we take the absolute value because the sign that is dropped is\r\n    // instead introduced using the ground-relative position of the symbol and the camera\r\n    if (polygonOffset \x3e .0) {\r\n      float cosAlpha \x3d clamp(absCosAngle, 0.01, 1.0);\r\n\r\n      float tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\r\n      float factor \x3d (1.0 - tanAlpha / viewport[2]);\r\n\r\n      // same side of the terrain\r\n      if (groundRelative \x3e 0.0) {\r\n        posView *\x3d factor;\r\n      }\r\n      // opposite sides of the terrain\r\n      else {\r\n        posView /\x3d factor;\r\n      }\r\n    }\r\n\r\n    return groundRelative;\r\n  }\r\n\r\n  /**\r\n   * Project the 3d position of a HUD object from world space to clip space. In addition\r\n   * to standard model view projection, it also emulates a polygon offset to\r\n   * help with points above/below ground and icon flickering. The resulting location\r\n   * is the anchor of the HUD object, i.e. the position that is used also for testing\r\n   * visibility of the HUD object. Note that the returned projected position is not\r\n   * aligned to a pixel center or border, it is up to the caller to align if necessary.\r\n   *\r\n   * Dependencies:\r\n   *\r\n   *   Attributes:\r\n   *     - position: contains the point world position\r\n   *     - normal: contains the world normal pointing up at the point\r\n   *     - auxpos1: contains centerOffset and pointGroundDistance\r\n   *\r\n   *   Uniforms:\r\n   *     - model: the object -\x3e world transformation matrix\r\n   *     - modelNormal: the object -\x3e world normal transformation matrix (inv transp of model)\r\n   *     - view: the world -\x3e view transformation matrix\r\n   *     - viewNormal: the world -\x3e view normal transformation matrix (inv transp of view)\r\n   *     - proj: the view -\x3e clip projection matrix\r\n   *     - verticalOffset: a vec4 containing:\r\n   *         - the screen height of the vertical offset\r\n   *         - the screen height of the vertical offset as a fraction of camera distance.\r\n   *         - the minimum world size vertical offset.\r\n   *         - the maximum world size vertical offset.\r\n   *       This will do a screen sized offset of the point along its normal (used for line callouts)\r\n   *     - screenSizePerspectiveAlignment: a vec3 containing\r\n   *         - the view distance dependent divisor\r\n   *         - the view distance dependent offset\r\n   *         - the minimum pixel size\r\n   *         - the amount of padding in pixels around the region to be scaled (not used for alignment)\r\n   *     - cameraGroundRelative: indicates whether camera is above (1) or below (-1) ground.\r\n   *         This is used for emulated polygon offset for improved visibility of points sitting on the surface.\r\n   *     - polygonOffset: a constant polygon offset to bring the point closer to the viewer for\r\n   *         reduced flickering.\r\n   *     - camPos: the position of the camera in world space\r\n   *     - viewport: the viewport [x, y, width, height]\r\n   */\r\n  vec4 projectPositionHUD(out ProjectHUDAux aux) {\r\n    // centerOffset is in view space and is used to implement world size offsetting\r\n    // of labels with respect to objects. It also pulls the label towards the viewer\r\n    // so that the label is visible in front of the object.\r\n    vec3 centerOffset \x3d $auxpos1.xyz;\r\n\r\n    // The pointGroundDistance is the distance of the geometry to the ground and is\r\n    // negative if the point is below the ground, or positive if the point is above\r\n    // ground.\r\n    float pointGroundDistance \x3d $auxpos1.w;\r\n\r\n    aux.posModel \x3d (model * vec4($position, 1.0)).xyz;\r\n    aux.posView \x3d (view * vec4(aux.posModel, 1.0)).xyz;\r\n    aux.vnormal \x3d (modelNormal * vec4($normal, 1.0)).xyz;\r\n\r\n    // Screen sized offset in world space, used for example for line callouts\r\n    // Note: keep this implementation in sync with the CPU implementation, see\r\n    //   - MaterialUtil.verticalOffsetAtDistance\r\n    //   - HUDMaterial.applyVerticalOffsetTransformation\r\n\r\n    aux.distanceToCamera \x3d length(aux.posView);\r\n\r\n    vec3 viewDirObjSpace \x3d normalize(camPos - aux.posModel);\r\n    float cosAngle \x3d dot(aux.vnormal, viewDirObjSpace);\r\n\r\n    aux.absCosAngle \x3d abs(cosAngle);\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n#if defined(VERTICAL_OFFSET) || defined(CENTER_OFFSET_UNITS_SCREEN)\r\n    vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);\r\n#endif\r\n\r\n#endif\r\n\r\n#ifdef VERTICAL_OFFSET\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n    float verticalOffsetScreenHeight \x3d applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);\r\n#else\r\n    float verticalOffsetScreenHeight \x3d verticalOffset.x;\r\n#endif\r\n\r\n    float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\r\n    vec3 modelOffset \x3d aux.vnormal * worldOffset;\r\n\r\n    aux.posModel +\x3d modelOffset;\r\n\r\n    vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\r\n    aux.posView +\x3d viewOffset;\r\n\r\n    // Since we elevate the object, we need to take that into account\r\n    // in the distance to ground\r\n    pointGroundDistance +\x3d worldOffset;\r\n\r\n#endif\r\n\r\n    float groundRelative \x3d applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\r\n\r\n#ifndef CENTER_OFFSET_UNITS_SCREEN\r\n    // Apply x/y in view space, but z in screen space (i.e. along posView direction)\r\n    aux.posView +\x3d vec3(centerOffset.x, centerOffset.y, 0);\r\n\r\n    // Same material all have same z !\x3d 0.0 condition so should not lead to\r\n    // branch fragmentation and will save a normalization if it\'s not needed\r\n    if (centerOffset.z !\x3d 0.0) {\r\n      aux.posView -\x3d normalize(aux.posView) * centerOffset.z;\r\n    }\r\n#endif\r\n\r\n    vec4 posProj \x3d proj * vec4(aux.posView, 1.0);\r\n\r\n#ifdef CENTER_OFFSET_UNITS_SCREEN\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n    float centerOffsetY \x3d applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);\r\n#else\r\n    float centerOffsetY \x3d centerOffset.y;\r\n#endif\r\n\r\n    posProj.xy +\x3d vec2(centerOffset.x, centerOffsetY) * 2.0 / viewport.zw * posProj.w;\r\n\r\n#endif\r\n\r\n    // constant part of polygon offset emulation\r\n    posProj.z -\x3d groundRelative * polygonOffset * posProj.w;\r\n\r\n    return posProj;\r\n  }\r\n\r\n  /**\r\n   * Test for visibility of a HUD object.\r\n   *\r\n   * Dependencies:\r\n   *\r\n   *   Uniforms:\r\n   *     - hudVisibilityTexture: the texture that contains the visibility information\r\n   *     - markerColor: the special marker color that is used to write visibility information\r\n   *     - viewport: the viewport\r\n   */\r\n  bool testVisibilityHUD(vec4 posProj) {\r\n    // For occlusion testing, use the nearest pixel center to avoid\r\n    // subpixel filtering messing up the color we use to test for\r\n    vec4 posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\r\n\r\n    return texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w).r \x3e 0.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/BillboardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboard"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tvec3 zDir \x3d normalize(-pos);\r\n\t\tvec3 xDir \x3d normalize(cross(vec3(.0, 1.0, .0), zDir));\r\n\t\tvec3 yDir \x3d cross(zDir, xDir);\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * size;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * size;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBillboard"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec3 lightDirection;\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .15) discard;\r\n\t\tgl_FragColor \x3d texColor;\r\n\t\tgl_FragColor.rgb *\x3d lightAmbient.rgb * lightAmbient.w + lightDiffuse.rgb * lightDiffuse.w * dot(lightDirection, vnormal);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboardDepth"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying float depth;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tpos.x +\x3d (uv01.x - .5) * size;\r\n\t\tpos.y +\x3d (uv01.y - .5) * size;\r\n\t\tvec4 eye \x3d vec4(pos, 1.0);\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\t\tvtc \x3d uv;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/ColorMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderColorMaterial"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n\r\n\tvarying vec4 vColor;\r\n\r\n\tvoid main(void) {\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255;\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderColorMaterial"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vColor * eColor;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/HUDMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUD"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  $commonAttributesAndUniformsHUD\r\n\r\n  uniform float pixelRatio;\r\n  uniform vec2 screenOffset;\r\n  uniform vec2 anchorPos;\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n  uniform vec4 screenSizePerspective;\r\n\r\n#endif\r\n\r\n#ifdef DEBUG_DRAW_BORDER\r\n  varying vec3 debugBorderCoords;\r\n#endif\r\n\r\n  attribute vec2 $uv0;\r\n  attribute vec4 $color;\r\n  attribute vec2 $size;\r\n  attribute vec4 $auxpos2;\r\n\r\n  varying vec4 vcolor;\r\n\r\n  varying vec2 vtc;\r\n  varying vec2 vsize;\r\n\r\n  $vvUniforms\r\n\r\n  $alignToPixelCenter\r\n  $alignToPixelOrigin\r\n  $projectPositionHUD\r\n  $vvFunctions\r\n\r\n  void main(void) {\r\n    ProjectHUDAux projectAux;\r\n    vec4 posProj \x3d projectPositionHUD(projectAux);\r\n\r\n    vec2 inputSize;\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n    inputSize \x3d screenSizePerspectiveScaleVec2($size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\r\n\r\n    vec2 screenOffsetScaled \x3d screenSizePerspectiveScaleFloat(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\r\n\r\n#else\r\n\r\n    inputSize \x3d $size;\r\n\r\n    vec2 screenOffsetScaled \x3d screenOffset;\r\n#endif\r\n\r\n#ifdef VV_SIZE\r\n    // only use width (.xx) for proportional scaling\r\n    // (if no width was defined in vv, width\r\n    //  will be a copy of height vv)\r\n    inputSize *\x3d vvGetScale($auxpos2).xx;\r\n#endif\r\n\r\n    vec2 combinedSize \x3d inputSize * pixelRatio;\r\n    vec4 quadOffset \x3d vec4(0);\r\n\r\n#ifdef OCCL_TEST\r\n    if (testVisibilityHUD(posProj)) {\r\n#endif\r\n      // UV goes from 0 to 1.99999, where the integer part is used\r\n      // for the normalized vertex coordinates, and the fractional\r\n      // part is used for texture sampling\r\n      vec2 uv01 \x3d floor($uv0);\r\n      vec2 uv \x3d $uv0 - uv01;\r\n\r\n      // Displace icon based on anchor position (normalized for size) and\r\n      // absolute screen offset. anchorPos is [-0.5, 0.5]\r\n      quadOffset.xy \x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;\r\n\r\n#ifdef SIGNED_DISTANCE_FIELD\r\n\r\n      // SDF primitives might be scaled so that the SDF texture resolution does\r\n      // not match the resolution of the canvas, but we still want to render\r\n      // outline-only (\'cross\' and \'x\') primitives cleanly. Aligning to a screen\r\n      // pixel border at the geometry center achieves this, since SDF textures\r\n      // always have power of 2 dimensions.\r\n      posProj \x3d alignToPixelOrigin(posProj, viewport.zw) + quadOffset;\r\n#else\r\n      posProj +\x3d quadOffset;\r\n\r\n      // Aligning vertex positions to the nearest (using \'floor\') screen pixel\r\n      // border renders textures with pixel-perfect results. If the texture\r\n      // resolution does not match the canvas resolution then aligning is\r\n      // redundant.\r\n      if (inputSize.x \x3d\x3d $size.x) {\r\n        posProj \x3d alignToPixelOrigin(posProj, viewport.zw);\r\n      }\r\n#endif\r\n\r\n      gl_Position \x3d posProj;\r\n\r\n      vtc \x3d uv;\r\n\r\n#ifdef DEBUG_DRAW_BORDER\r\n      debugBorderCoords \x3d vec3(uv01, 1.0 / combinedSize);\r\n#endif\r\n\r\n      vsize \x3d inputSize;\r\n#ifdef OCCL_TEST\r\n    } else {\r\n      vtc \x3d vec2(.0);\r\n\r\n#ifdef DEBUG_DRAW_BORDER\r\n      debugBorderCoords \x3d vec3(0);\r\n#endif\r\n\r\n    }\r\n#endif\r\n\r\n    gl_Position \x3d posProj;\r\n\r\n#ifdef VV_COLOR\r\n    vcolor \x3d vvGetColor($auxpos2, vvColorValues, vvColorColors);\r\n#else\r\n    vcolor \x3d $color / 255.0;\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDBaseVariables"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n  #extension GL_OES_standard_derivatives : require\r\n\r\n  uniform sampler2D tex;\r\n  uniform vec4 overrideColor;\r\n  uniform vec4 outlineColor;\r\n  uniform float outlineSize;\r\n\r\n  varying vec4 vcolor;\r\n\r\n  varying vec2 vtc;\r\n  varying vec2 vsize;\r\n\r\n#ifdef DEBUG_DRAW_BORDER\r\n  varying vec3 debugBorderCoords;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDBaseMain"\x3e\x3c![CDATA[\r\n  vec4 premultiply(vec4 v) {\r\n    return vec4(v.rgb * v.a, v.a);\r\n  }\r\n\r\n  void main() {\r\n\r\n#ifdef SIGNED_DISTANCE_FIELD\r\n    vec4 color \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n    vec4 fillPixelColor \x3d overrideColor * vcolor;\r\n\r\n    // Attempt to sample texel centers to avoid thin cross outline\r\n    // disappearing with large symbol sizes.\r\n    // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\r\n    const float txSize \x3d 128.0;\r\n    vec2 scaleFactor \x3d ((vsize - txSize) / txSize);\r\n    vec2 samplePos \x3d vtc + vec2(1.0, -1.0) * (1.0 / txSize) * scaleFactor;\r\n\r\n    // Distance in [-0.5, 0.5]\r\n    float d \x3d dot(texture2D(tex, samplePos), vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0)) - 0.5;\r\n\r\n    // Work around loss of precision for \'d \x3d 0.0\'.\r\n    // \'0\' gets normalised to 0.5 * 256 \x3d 128 before float packing, but can only\r\n    // be stored in the texture as 128 / 255 \x3d 0.502.\r\n    // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603110\r\n    const float diff \x3d (128.0/255.0 - 0.5);\r\n\r\n    // adjust all values, not just those close to 0, to avoid discontinuities in\r\n    // the outlines of other shapes e.g. circles\r\n    d \x3d d - diff;\r\n\r\n    // Distance in output units\r\n    float dist \x3d d * vsize.x;\r\n\r\n    fillPixelColor.a *\x3d clamp(0.5 - dist, 0.0, 1.0);\r\n\r\n    if (outlineSize \x3e 0.25) {\r\n      vec4 outlinePixelColor \x3d outlineColor;\r\n      float clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\r\n      outlinePixelColor.a *\x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\r\n\r\n      // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\r\n      float compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n      vec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\r\n        vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\r\n      gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n    }\r\n    else {\r\n      gl_FragColor \x3d premultiply(fillPixelColor);\r\n    }\r\n\r\n    // visualize SDF:\r\n    // gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\r\n#else\r\n\r\n    // HUDMaterial is rendered with a blending mode that assumes a pre-multiplied\r\n    // fragment color. Input textures should already be pre-multiplied and so\r\n    // don\'t require adjustment, but the override and vertex colors must be\r\n    // modulated by their alpha values.\r\n\r\n    gl_FragColor \x3d texture2D(tex, vtc, -0.5) * premultiply(overrideColor * vcolor);\r\n\r\n#endif\r\n\r\n#ifdef DEBUG_DRAW_BORDER\r\n     float isBorder \x3d float(any(lessThan(debugBorderCoords.xy, vec2(debugBorderCoords.z))) || any(greaterThan(debugBorderCoords.xy, vec2(1.0 - debugBorderCoords.z))));\r\n     gl_FragColor \x3d mix(gl_FragColor, vec4(1, 0, 1, 1), isBorder);\r\n#endif\r\n\r\n    if (gl_FragColor.a \x3c 0.1) {\r\n      discard;\r\n    }\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUD"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBaseVariables\r\n$fragmentShaderHUDBaseMain\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDHighlight"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBaseVariables\r\n\r\n  uniform sampler2D depthTex;\r\n  uniform vec4 highlightViewportPixelSz;\r\n\r\n$fragmentShaderHUDBaseMain\r\n    $highlightWrite\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderOcclusionTestPixel"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  $commonAttributesAndUniformsHUD\r\n\r\n  $alignToPixelCenter\r\n  $projectPositionHUD\r\n\r\n  void main(void) {\r\n    vec4 posProjCenter;\r\n\r\n    // Check for special value of position (0, 0, 0) which is used by the Renderer when graphics\r\n    // are removed before the VBO is recompacted. If this is the case, then we just project outside\r\n    // of clip space.\r\n    if (dot($position, $position) \x3e 0.0) {\r\n      // Render single point to center of the pixel to avoid subpixel filtering to affect\r\n      // the marker color\r\n      ProjectHUDAux projectAux;\r\n      vec4 posProj \x3d projectPositionHUD(projectAux);\r\n\r\n      posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\r\n    }\r\n    else {\r\n      // Project out of clip space\r\n      posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\r\n    }\r\n\r\n    gl_Position \x3d posProjCenter;\r\n    gl_PointSize \x3d 1.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/LineCalloutMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderLineCallout"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  $commonAttributesAndUniformsHUD\r\n\r\n  attribute vec2 $uv0;\r\n\r\n  uniform float lineSize;\r\n  uniform vec2 pixelToNDC;\r\n  uniform float borderSize;\r\n  uniform vec2 screenOffset;\r\n\r\n  varying vec4 coverageSampling;\r\n  varying vec2 lineSizes;\r\n\r\n  $alignToPixelOrigin\r\n  $alignToPixelCenter\r\n\r\n  $projectPositionHUD\r\n\r\n  void main(void) {\r\n    ProjectHUDAux projectAux;\r\n    vec4 endPoint \x3d projectPositionHUD(projectAux);\r\n\r\n#ifdef OCCL_TEST\r\n    if (!testVisibilityHUD(endPoint)) {\r\n      gl_Position \x3d vec4(1e38, 1e38, 1e38, 1);\r\n    }\r\n    else {\r\n#endif\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n      vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\r\n      vec2 screenOffsetScaled \x3d applyScreenSizePerspectiveScaleFactorFloat(screenOffset, perspectiveFactor);\r\n#else\r\n      vec2 screenOffsetScaled \x3d screenOffset;\r\n#endif\r\n\r\n      // Add view dependent polygon offset to get exact same original starting point. This is mostly\r\n      // used to get the correct depth value\r\n      vec3 posView \x3d (view * model * vec4($position, 1.0)).xyz;\r\n      applyHUDViewDependentPolygonOffset($auxpos1.w, projectAux.absCosAngle, posView);\r\n\r\n      vec4 startPoint \x3d proj * vec4(posView, 1);\r\n\r\n      // Apply screen offset to both start and end point\r\n      vec2 screenOffsetNorm \x3d screenOffsetScaled * 2.0 / viewport.zw;\r\n\r\n      startPoint.xy +\x3d screenOffsetNorm * startPoint.w;\r\n      endPoint.xy +\x3d screenOffsetNorm * endPoint.w;\r\n\r\n      // Align start and end to pixel origin\r\n      vec4 startAligned \x3d alignToPixelOrigin(startPoint, viewport.zw);\r\n      vec4 endAligned \x3d alignToPixelOrigin(endPoint, viewport.zw);\r\n\r\n#ifdef DEPTH_HUD\r\n\r\n#ifdef DEPTH_HUD_ALIGN_START\r\n      endAligned \x3d vec4(endAligned.xy / endAligned.w * startAligned.w, startAligned.zw);\r\n#else\r\n      startAligned \x3d vec4(startAligned.xy / startAligned.w * endAligned.w, endAligned.zw);\r\n#endif\r\n\r\n#endif\r\n\r\n      vec4 projectedPosition \x3d mix(startAligned, endAligned, $uv0.y);\r\n\r\n      // The direction of the line in screen space\r\n      vec2 screenSpaceDirection \x3d normalize(endAligned.xy / endAligned.w - startAligned.xy / startAligned.w);\r\n      vec2 perpendicularScreenSpaceDirection \x3d vec2(screenSpaceDirection.y, -screenSpaceDirection.x);\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n      float lineSizeScaled \x3d applyScreenSizePerspectiveScaleFactorFloat(lineSize, perspectiveFactor);\r\n      float borderSizeScaled \x3d applyScreenSizePerspectiveScaleFactorFloat(borderSize, perspectiveFactor);\r\n\r\n#else\r\n\r\n      float lineSizeScaled \x3d lineSize;\r\n      float borderSizeScaled \x3d borderSize;\r\n\r\n#endif\r\n\r\n      float halfPixelSize \x3d lineSizeScaled * 0.5;\r\n\r\n      // Calculate a pixel offset from the edge of the pixel, s.t. we keep the line aligned\r\n      // to pixels if it has a full pixel size. Since pixel aligned biases to the bottom-left,\r\n      // we bias the size to the right (for odd sizes) to balance out the bias. Grow sub-pixel\r\n      // sizes towards the left or right s.t. there is a smooth transition (e.g. from 2 to 3 px).\r\n      float halfWholePixelSize \x3d floor(lineSizeScaled) * 0.5;\r\n      float halfPixelSizeInt \x3d floor(halfWholePixelSize);\r\n\r\n      // Sub-pixel offset if we need to grow sub-pixels to the left\r\n      float subpixelOffset \x3d -fract(lineSizeScaled) * float(halfWholePixelSize \x3e 0.0);\r\n\r\n      // Pixel offset aligning to whole pixels and adding subpixel offset if needed\r\n      float pixelOffset \x3d -halfPixelSizeInt + subpixelOffset;\r\n\r\n      // Compute full ndc offset, adding 1px padding for doing anti-aliasing and the border size\r\n      float padding \x3d 1.0 + borderSizeScaled;\r\n      vec2 ndcOffset \x3d (pixelOffset - padding + $uv0 * (lineSizeScaled + padding + padding)) * pixelToNDC;\r\n\r\n      // Offset x/y from the center of the line in screen space\r\n      projectedPosition.xy +\x3d perpendicularScreenSpaceDirection * ndcOffset * projectedPosition.w;\r\n\r\n      // Compute a coverage varying which we can use in the fragment shader to determine\r\n      // how much a pixel is actually covered by the line (i.e. to anti alias the line).\r\n      // This works by computing two coordinates that can be linearly interpolated and then\r\n      // subtracted to find out how far away from the line edge we are.\r\n      float edgeDirection \x3d ($uv0.x * 2.0 - 1.0);\r\n\r\n      float halfBorderSize \x3d 0.5 * borderSizeScaled;\r\n      float halfPixelSizeAndBorder \x3d halfPixelSize + halfBorderSize;\r\n      float outerEdgeCoverageSampler \x3d edgeDirection * (halfPixelSizeAndBorder + halfBorderSize + 1.0);\r\n\r\n      float isOneSided \x3d float(lineSizeScaled \x3c 2.0 \x26\x26 borderSize \x3c 2.0);\r\n\r\n      coverageSampling \x3d vec4(\r\n        // Edge coordinate\r\n        outerEdgeCoverageSampler,\r\n\r\n        // Border edge coordinate\r\n        outerEdgeCoverageSampler - halfPixelSizeAndBorder * isOneSided,\r\n\r\n        // Line offset\r\n        halfPixelSize - 0.5,\r\n\r\n        // Border offset\r\n        halfBorderSize - 0.5 + halfPixelSizeAndBorder * (1.0 - isOneSided)\r\n      );\r\n\r\n      lineSizes \x3d vec2(lineSizeScaled, borderSizeScaled);\r\n\r\n      gl_Position \x3d projectedPosition;\r\n\r\n#ifdef OCCL_TEST\r\n    }\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet\x3e\x3c![CDATA[\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderLineCallout"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n  uniform vec4 color;\r\n  uniform vec4 borderColor;\r\n\r\n  varying vec4 coverageSampling;\r\n  varying vec2 lineSizes;\r\n\r\n  void main() {\r\n    // Mix between line and border coverage offsets depending on whether we need\r\n    // a border (based on the sidedness).\r\n    vec2 coverage \x3d min(1.0 - clamp(abs(coverageSampling.xy) - coverageSampling.zw, 0.0, 1.0), lineSizes);\r\n\r\n    // Mix between border and line color based on the line coverage (conceptually the line\r\n    // blends on top of the border background).\r\n    //\r\n    // Anti-alias by blending final result using the full (including optional border) coverage\r\n    // and the color alpha\r\n    float borderAlpha \x3d color.a * borderColor.a * coverage.y;\r\n    float colorAlpha \x3d color.a * coverage.x;\r\n\r\n    float finalAlpha \x3d mix(borderAlpha, 1.0, colorAlpha);\r\n\r\n#ifdef DEPTH_HUD\r\n\r\n    if (finalAlpha \x3c 0.01) {\r\n      discard;\r\n    }\r\n\r\n#else\r\n\r\n    // Compute the finalRgb, but keep it pre-multiplied (for unpre-multiplied you\r\n    // need to divide by finalAlpha). We avoid the division here by setting the\r\n    // appropriate blending function in the material.\r\n    vec3 finalRgb \x3d mix(borderColor.rgb * borderAlpha, color.rgb, colorAlpha);\r\n\r\n    gl_FragColor \x3d vec4(finalRgb, finalAlpha);\r\n\r\n#endif\r\n\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/LeafCardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCard"\x3e\r\n\t\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\r\n\tuniform vec3 localOrigin;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $normal;\r\n\tattribute vec4 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tuniform float trafoScale;\r\n\tvarying vec3 vpos;\r\n\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tvoid main(void) {\r\n\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0.xy);\r\n\t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w *trafoScale;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w *trafoScale;;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tambientLeaf \x3d normal.w;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal.xyz, 1.0)).xyz);\r\n\t}\r\n]]\x3e\r\n\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderLeafCard"\x3e\r\n\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform vec3 diffuse;\r\n\r\n\tuniform vec3 localOrigin;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\t$sceneLightingDefinitions\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tvec3 albedo \x3d diffuse * ambientLeaf * texColor.rgb;\r\n\r\n\t\tfloat ssao \x3d 1.0;\r\n\r\n\t\t$sceneLightingAdditionalLightGlobal\r\n\r\n\t\tvec3 color \x3d evaluateSceneLighting(normal, albedo, 1.0, 1.0 - ssao, additionalLight);\r\n\r\n\t\tgl_FragColor \x3d vec4(color, texColor.a);\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCardDepth"\x3e\x3c![CDATA[\r\n    $vsprecisionf\r\n\r\n   \tuniform mat4 proj;\r\n   \tuniform mat4 view;\r\n   \tuniform mat4 model;\r\n   \tuniform vec2 nearFar;\r\n\r\n   \tattribute vec3 $position;\r\n   \tattribute vec4 $uv0;\r\n\r\n   \tuniform float trafoScale;\r\n\r\n   \tvarying vec2 vtc;\r\n   \tvarying float depth;\r\n\r\n   \tvec2 rotate(vec2 pos, float angle) {\r\n   \t\tfloat c \x3d cos(angle);\r\n   \t\tfloat s \x3d sin(angle);\r\n   \t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n   \t}\r\n\r\n   \tvoid main(void) {\r\n   \t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n   \t\tvec2 uv01 \x3d floor($uv0.xy);\r\n   \t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n   \t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w*trafoScale;\r\n   \t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w*trafoScale;\r\n   \t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n   \t\tgl_Position \x3d pos4;\r\n   \t\tvtc \x3d uv;\r\n\r\n   \t\tdepth \x3d (-pos.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\r\n   \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/Material.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"calculateVerticalOffset"\x3e\x3c![CDATA[\r\n  $viewingMode\r\n\r\n#ifdef VERTICAL_OFFSET\r\n  // [ verticalOffsetPerDistance, minWorldLength, maxWorldLength ]\r\n  uniform vec4 verticalOffset;\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n\r\n  uniform vec4 screenSizePerspectiveAlignment;\r\n\r\n  $screenSizePerspective\r\n\r\n#endif\r\n\r\n  vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\r\n    float viewDistance \x3d length((view * vec4(worldPos, 1)).xyz);\r\n    float verticalOffsetOffsetDistance \x3d verticalOffset.x * viewDistance;\r\n\r\n#ifdef VIEWING_MODE_GLOBAL\r\n    vec3 worldNormal \x3d normalize(worldPos + localOrigin);\r\n#else\r\n    vec3 worldNormal \x3d vec3(0, 0, 1);\r\n#endif\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE\r\n    float cosAngle \x3d dot(worldNormal, normalize(worldPos - camPos));\r\n\r\n    float verticalOffsetScreenHeight \x3d screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);\r\n#else\r\n    float verticalOffsetScreenHeight \x3d verticalOffset.x;\r\n#endif\r\n\r\n    // Screen sized offset in world space, used for example for line callouts\r\n    float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\r\n\r\n    return worldNormal * worldOffset;\r\n  }\r\n#endif\r\n]]\x3e\r\n\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n  uniform vec3 camPos;\r\n\r\n\tuniform vec3 localOrigin;\r\n\r\n#ifdef INSTANCED\r\n    attribute mat4 model;\r\n    attribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n\tattribute vec4 instanceColor;\r\n#endif\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n\r\n#ifdef VERTEXCOLORS\r\n\tattribute vec4 $color;\r\n#endif\r\n\r\n#ifdef SYMBOLVERTEXCOLORS\r\n  attribute vec4 $symbolColor;\r\n#endif\r\n\r\n#if defined(VV_SIZE) || defined(VV_COLOR)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\r\n$vvUniforms\r\n\r\n#if defined(VERTEXCOLORS)\r\n\tvarying vec4 vcolor;\r\n#endif\r\n\r\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\r\n\tuniform vec4 externalColor;\r\n\tvarying vec4 vcolorExt;\r\n#endif\r\n\r\n#if defined(SYMBOLVERTEXCOLORS)\r\n\tvarying mediump float colorMixMode; // varying int is not supported in WebGL\r\n#endif\r\n\r\n\t$vvFunctions\r\n\r\n\t$colorMixMode\r\n\r\n  $calculateVerticalOffset\r\n\r\n\tvoid main(void) {\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\r\n\t\tvpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\r\n\t\tvnormal \x3d normalize((modelNormal * vvTransformNormal($normal, instanceFeatureAttribute)).xyz);\r\n\r\n#ifdef VERTICAL_OFFSET\r\n\t\tvec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\r\n#endif\r\n\r\n#else /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\r\n#ifdef VERTICAL_OFFSET\r\n\t\tvec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\r\n#endif\r\n\r\n#endif /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\r\n#endif\r\n\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\r\n#ifdef VERTEXCOLORS\r\n\t\tvcolor \x3d $color * 0.003921568627451; // \x3d 1/255\r\n#endif\r\n\r\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\r\n\t\tvcolorExt \x3d externalColor;\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n\t\tvcolorExt *\x3d instanceColor;\r\n#endif\r\n#ifdef VV_COLOR\r\n\t\tvcolorExt *\x3d vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\r\n#endif\r\n#ifdef SYMBOLVERTEXCOLORS\r\n    int symbolColorMixMode;\r\n    vcolorExt *\x3d decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451; // \x3d 1/255;\r\n    colorMixMode \x3d float(symbolColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongSrc"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n\tuniform vec3 camPos;\r\n\tuniform vec3 localOrigin;\r\n\r\n\t$sceneLightingDefinitions\r\n\r\n\t// material parameters\r\n\t//////////////////////////////////////////\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\tuniform float opacity;\r\n\tuniform float layerOpacity;\r\n\r\n#ifdef SYMBOLVERTEXCOLORS\r\n\tvarying mediump float colorMixMode; // varying int is not supported in WebGL\r\n#else\r\n  uniform int colorMixMode;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n#endif\r\n\r\n#ifdef RECEIVE_SSAO\r\n\tuniform sampler2D ssaoTex;\r\n\tuniform vec4 viewportPixelSz;\r\n#endif\r\n\r\n\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n#if defined(VERTEXCOLORS)\r\n\tvarying vec4 vcolor;\r\n#endif\r\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\r\n\tvarying vec4 vcolorExt;\r\n#else\r\n\tuniform vec4 externalColor;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\t$evalShadow\r\n#endif\r\n\r\n\t$colorMixMode\r\n\r\n\tvoid main() {\r\n\t\tvec3 viewDir \x3d normalize(vpos - camPos);\r\n\r\n\t\t// compute normal\r\n\t\t#ifndef DOUBLESIDED\r\n\t\t\t\tvec3 normal \x3d vnormal;\r\n\t\t#else\r\n\t\t\t\tvec3 normal \x3d dot(vnormal, viewDir)\x3e0.0 ? -vnormal : vnormal;\r\n\t\t#endif\r\n\t\tnormal \x3d normalize(normal);\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(viewDir, normal));\r\n\r\n\t\t// compute ssao\r\n\t\t#ifdef RECEIVE_SSAO\r\n\t\t\t\tfloat ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n\t\t\t\tssao \x3d viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\r\n\t\t#else\r\n\t\t\t\tfloat ssao \x3d 1.0;\r\n\t\t#endif\r\n\r\n\t\t// At global scale we create some additional ambient light based on the main light to simulate global illumination\r\n\t\t// This also defines "additionalAmbientScale" which might be used as a shadow fallback further down\r\n\t\t$sceneLightingAdditionalLightGlobal\r\n\r\n\t\t// compute shadowing\r\n\t\tfloat shadow \x3d 0.0;\r\n\t\t#ifdef RECEIVE_SHADOWS\r\n\t\t\tshadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n\t\t#elif defined(VIEWING_MODE_GLOBAL)\r\n\t\t\t// at global scale (and in global scenes) we fall back to this approximation\r\n\t\t\t// to shadow objects on the dark side of the earth\r\n\t\t\tshadow \x3d lightingGlobalFactor * (1.0 - additionalAmbientScale);\r\n\t\t#endif\r\n\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"externalColorMix"\x3e\x3c![CDATA[\r\n\tvec3 matColor \x3d max(ambient, diffuse); // combine the old material parameters into a single one\r\n\t#if defined(VERTEXCOLORS) \x26\x26 (defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS))\r\n\t\t\t// Internal colors: varying vcolor + uniform ambient/diffuse, external colors: varying vcolorExt\r\n\t\t\tvec3 albedo_ \x3d mixExternalColor(vcolor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\r\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(vcolor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));\r\n\t#elif defined(VERTEXCOLORS)\r\n\t\t\t// Internal colors: varying vcolor + uniform ambient/diffuse, external colors: uniform externalColor\r\n\t\t\tvec3 albedo_ \x3d mixExternalColor(vcolor.rgb * matColor, texColor.rgb, externalColor.rgb, int(colorMixMode));\r\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(vcolor.a * opacity, texColor.a, externalColor.a, int(colorMixMode));\r\n\t#elif defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\r\n\t\t\t// Internal colors: uniform ambient/diffuse, external colors: varying vcolorExt\r\n\t\t\tvec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\r\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\r\n\t#else\r\n\t\t\t// Internal colors: uniform ambient/diffuse, external colors: uniform externalColor\r\n\t\t\tvec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, externalColor.rgb, int(colorMixMode));\r\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, externalColor.a, int(colorMixMode));\r\n\t#endif\r\n\talbedo_+\x3d 0.25 * specular; // don\'t completely ignore specular for now\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhong"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\t$vsPhongSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhong"\x3e\x3c![CDATA[\r\n\t\t$fsprecisionf\r\n\r\n\t\t$fsPhongSrc\r\n\r\n\t\tvec4 texColor \x3d vec4(1,1,1,1);\r\n\t\t$externalColorMix\r\n\r\n\t\t$selectShadingNormal\r\n\r\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(shadingNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\r\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongTextured"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTextured"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\r\n\t$fsPhongSrc\r\n\r\n\t\t// read texture color\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\r\n\t\t$externalColorMix\r\n\r\n\t\t$selectShadingNormal\r\n\r\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(shadingNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\r\n\r\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec4 $uv0;\r\n\tattribute vec4 $region;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0.xy;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t\tregionV \x3d $region/65535.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec2 texSize;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\r\n\tfloat calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\r\n\t\t// from:\r\n\t\t//   - OpenGLES Common Profile Specification Version 2.0.25, Section 3.7.7 - Texture Minification\r\n\t\t//   - https://www.opengl.org/discussion_boards/showthread.php/171485-Texture-LOD-calculation-(useful-for-atlasing)\r\n\t\t//   - http://www.linedef.com/virtual-texture-demo.html\r\n\t\tfloat deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\r\n\t\treturn max(0.5 * log2(deltaMaxSqr), 0.0);\r\n\t}\r\n\r\n\t$fsPhongSrc\r\n\r\n\t\tvec2 uv \x3d vtc;\r\n\t\tuv \x3d fract(uv);\r\n\t\t//[umin, vmin, umax, vmax]\r\n\r\n\t\tvec2 atlasScale \x3d regionV.zw - regionV.xy;\r\n\t\tuv \x3d uv.xy * atlasScale + regionV.xy;\r\n\r\n\t\tvec4 texColor;\r\n\t\t#ifdef GL_OES_standard_derivatives\r\n\t\t\t#extension GL_OES_standard_derivatives : enable\r\n\r\n\t\t\t// calculate derivative of continuous texture coordinate\r\n\t\t\t// to avoid mipmapping artifacts caused by manual wrapping in shader\r\n\t\t\tvec2 dUVdx \x3d dFdx(vtc) * atlasScale;\r\n\t\t\tvec2 dUVdy \x3d dFdy(vtc) * atlasScale;\r\n\r\n\t\t\t#ifdef GL_EXT_shader_texture_lod\r\n\t\t\t\t#extension GL_EXT_shader_texture_lod : enable\r\n\r\n\t\t\t\t// workaround for artifacts in Windows 10 using Intel HD Graphics 4000 series\r\n\t\t\t\t// see: https://devtopia.esri.com/Zurich-R-D-Center/arcgis-js-api-canvas3d-issues/issues/768\r\n\t\t\t\tconst float epsilon \x3d 1.0E-32;\r\n\t\t\t\tfloat zeroUVShift \x3d uv.x \x3d\x3d 0.0 \x26\x26 uv.y \x3d\x3d 0.0 ? epsilon : 0.0;\r\n\r\n\t\t\t\ttexColor \x3d texture2DGradEXT(tex, uv + zeroUVShift, dUVdx, dUVdy);\r\n\t\t\t#else\r\n\t\t\t\t// use bias to compensate for difference in automatic vs desired mipmap level\r\n\t\t\t\tvec2 dUVdxAuto \x3d dFdx(uv);\r\n\t\t\t\tvec2 dUVdyAuto \x3d dFdy(uv);\r\n\t\t\t\tfloat mipMapLevel \x3d calcMipMapLevel(dUVdx * texSize, dUVdy * texSize);\r\n\t\t\t\tfloat autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * texSize, dUVdyAuto * texSize);\r\n\t\t\t\ttexColor \x3d texture2D(tex, uv, mipMapLevel - autoMipMapLevel);\r\n\t\t\t#endif\r\n\t\t#else\r\n\t\t\ttexColor \x3d texture2D(tex, uv);\r\n\t\t#endif\r\n\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\r\n\t\t$externalColorMix\r\n\r\n\t\t$selectShadingNormal\r\n\r\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(shadingNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\r\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\r\n\t}\r\n\t]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsPhongTexturedRefl"\x3e\x3c![CDATA[\r\n\t\t$fsprecisionf\r\n\r\n\t\tuniform sampler2D tex;\r\n\t\tuniform sampler2D reflTex;\r\n\t\tuniform float reflectivity;\r\n\t\tvarying vec2 vtc;\r\n\r\n\t\t$normal2envTC\r\n\r\n\t\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tvec4 reflColor \x3d texture2D(reflTex, normal2envTC(reflDir));\r\n\r\n\t\t$externalColorMix\r\n\r\n\t\t$selectShadingNormal\r\n\r\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(shadingNormal, albedo_, shadow, 1.0 - ssao, additionalLight);\r\n\t\tshadedColor.rgb \x3d mix(shadedColor.rgb, reflColor.rgb, reflectivity);\r\n\r\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n  uniform vec3 camPos;\r\n  uniform vec3 localOrigin;\r\n\r\n#ifdef INSTANCED\r\n\tattribute mat4 model;\r\n  attribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n  uniform mat4 modelNormal;\r\n#endif\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tvarying float depth;\r\n\r\n\t$vvUniforms\r\n#if defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\t$vvFunctions\r\n\r\n  $calculateVerticalOffset\r\n\r\n\tvoid main(void) {\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\r\n    vec3 vpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\r\n#endif\r\n\r\n#else /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n\t\tvec3 vpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\r\n#ifdef VERTICAL_OFFSET\r\n\t\tvec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\r\n#endif\r\n\r\n#endif /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\r\n#endif\r\n\r\n    vec4 eye \x3d view * vec4(vpos, 1);\r\n\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepth"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\t$vsDepthSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthTextured"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsDepthSrc\r\n#ifndef FLIPV\r\n        vtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n  uniform vec3 camPos;\r\n  uniform vec3 localOrigin;\r\n\r\n#ifdef INSTANCED\r\n\tattribute mat4 model;\r\n\tattribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n#endif\r\n\tuniform mat4 viewNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vnormal;\r\n\r\n\t$vvUniforms\r\n#if defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\t$vvFunctions\r\n\r\n  $calculateVerticalOffset\r\n\r\n\tvoid main(void) {\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\r\n    vec3 vpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\r\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vvTransformNormal($normal, instanceFeatureAttribute)).xyz);\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\r\n#endif\r\n\r\n#else /* VV_CUSTOM_MODEL_MATRIX */\r\n\t\tvec3 vpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vec4($normal, 1.0)).xyz);\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\r\n#endif\r\n\r\n#endif /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4(vpos, 1);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormal"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\t$vsNormalSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalTextured"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsNormalSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightSrc"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n  uniform vec3 camPos;\r\n  uniform vec3 localOrigin;\r\n\r\n#ifdef INSTANCED\r\n\tattribute mat4 model;\r\n  attribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n  uniform mat4 modelNormal;\r\n#endif\r\n\tattribute vec3 $position;\r\n\r\n\t$vvUniforms\r\n#if defined(VV_CUSTOM_MODEL_MATRIX)\r\n\tattribute vec4 instanceFeatureAttribute;\r\n#endif\r\n\t$vvFunctions\r\n\r\n  $calculateVerticalOffset\r\n\r\n\tvoid main(void) {\r\n\r\n#ifdef VV_CUSTOM_MODEL_MATRIX\r\n\r\n    vec3 vpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\r\n#endif\r\n\r\n#else /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n    vec3 vpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\r\n#endif\r\n\r\n#endif /* VV_CUSTOM_MODEL_MATRIX */\r\n\r\n#ifdef VERTICAL_OFFSET\r\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\r\n#endif\r\n\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlight"\x3e\x3c![CDATA[\r\n\t$vsHighlightSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightTextured"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsHighlightSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthSrc"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\tvarying float depth;\r\n\r\n\tvoid main() {\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepth"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\t$fsDepthSrc\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthTextured"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\r\n\t$fsDepthSrc\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormal"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tvarying vec3 vnormal;\r\n\tvoid main() {\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormalTextured"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tvarying vec3 vnormal;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlight"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n  uniform sampler2D depthTex;\r\n  uniform vec4 highlightViewportPixelSz;\r\n\r\n\tvoid main() {\r\n\t\t$highlightWrite\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightTextured"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n  uniform sampler2D depthTex;\r\n  uniform vec4 highlightViewportPixelSz;\r\n\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n\r\n\t\t$highlightWrite\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/RibbonLineMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsRibbonLine"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tuniform float extLineWidth;\r\n\tuniform float nearPlane;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tattribute vec4 $color;\r\n\tvarying vec4 vColor;\r\n\r\n\tattribute float size;\r\n\r\n#ifndef WALL\r\n\tuniform float miterLimit;\r\n\tattribute vec3 $auxpos1;\r\n\tattribute vec3 $auxpos2;\r\n#endif\r\n\r\n#ifdef SCREENSCALE\r\n\tuniform vec2 screenSize;\r\n\t$toScreenCoords\r\n#define VECTYPE vec2\r\n#define ZEROVEC vec2(0.0, 0.0)\r\n#define PERPENDICULAR(v) vec2(v.y, -v.x);\r\n#define ISOUTSIDE (left.x * right.y - left.y * right.x)*$uv0.y \x3e 0.0\r\n\r\n#else //ifdef SCREENSCALE\r\n\r\n#define VECTYPE vec3\r\n#define ZEROVEC vec3(0.0, 0.0, 0.0)\r\n// these macros are only valid for "strip" type lines:\r\n#define PERPENDICULAR(v) cross(up/*vec3(0.0, 1.0, 0.0)*/, v)\r\n#define ISOUTSIDE dot(cross(left, right), up/*vec3(0.0, 1.0, 0.0)*/)*$uv0.y \x3c 0.0\r\n\r\n#endif //ifdef SCREENSCALE\r\n\r\n\tfloat interp(float ncp, vec4 a, vec4 b) {\r\n\t\treturn (-ncp - a.z) / (b.z - a.z);\r\n\t}\r\n\r\n#ifdef SCREENSCALE\r\n\r\n  void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next) {\r\n\t\tfloat vnp \x3d nearPlane*0.99;\r\n\r\n\t\t//We have four vertices per point on the line. Start and end vertices\r\n\t\t//are treated differently --\x3e d \x3e 0, d \x3c 0\r\n\t\tfloat d \x3d abs($uv0.y) - 1.1;\r\n\r\n\t\t//current pos behind ncp --\x3e we need to clip\r\n\t\tif(pos.z \x3e -nearPlane) {\r\n\t\t\tif (d \x3c 0.0) {\r\n\t\t\t\t//previous in front of ncp\r\n\t\t\t\tif(prev.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(prev, pos, interp(vnp, prev, pos));\r\n\t\t\t\t\tnext \x3d pos;\r\n\t\t\t\t} else {\r\n\t\t\t\t  pos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t\t//next in front of ncp\r\n\t\t\tif(d \x3e 0.0) {\r\n\t\t\t\tif(next.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(pos, next, interp(vnp, pos, next));\r\n\t\t\t\t\tprev \x3d pos;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\telse {\r\n\t\t\t//current position visible\r\n\t\t\t//previous behind ncp\r\n\t\t\tif (prev.z \x3e -nearPlane) {\r\n\t\t\t\tprev \x3d mix(pos, prev, interp(vnp, pos, prev));\r\n\t\t\t}\r\n\t\t\t//next behind ncp\r\n\t\t\tif (next.z \x3e -nearPlane) {\r\n\t\t\t\tnext \x3d mix(next, pos, interp(vnp, next, pos));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpos\x3d proj * pos;\r\n\t\tpos.xy *\x3d screenSize;\r\n\t\tpos /\x3d pos.w;\r\n\r\n\t\tnext \x3d proj * next;\r\n\t\tnext.xy *\x3d screenSize;\r\n\t\tnext /\x3d next.w;\r\n\r\n\t\tprev \x3d proj * prev;\r\n\t\tprev.xy *\x3d screenSize;\r\n\t\tprev /\x3d prev.w;\r\n  }\r\n\r\n#endif // SCREENSCALE\r\n\r\n\tvoid main(void) {\r\n\r\n\tfloat lineWidth \x3d extLineWidth + $size;\r\n\r\n#ifdef SCREENSCALE\r\n\r\n#if 0\r\n\t\tvec4 pos \x3d toScreenCoords($position.xyz);\r\n\t\tvec2 left \x3d (pos - toScreenCoords($auxpos1)).xy;\r\n\t\tvec2 right \x3d (toScreenCoords($auxpos2) - pos).xy;\r\n#else\r\n\t\tvec4 pos  \x3d view * vec4((model * vec4($position.xyz, 1.0)).xyz, 1.0);\r\n\t\tvec4 prev \x3d view * vec4((model * vec4($auxpos1.xyz, 1.0)).xyz, 1.0);\r\n\t\tvec4 next \x3d view * vec4((model * vec4($auxpos2.xyz, 1.0)).xyz, 1.0);\r\n\r\n\t\tclipAndTransform(pos, prev, next);\r\n\r\n\t\tvec2 left \x3d (pos - prev).xy;\r\n\t\tvec2 right \x3d (next - pos).xy;\r\n#endif\r\n\r\n#else // ifdef SCREENSCALE\r\n\t\tvec4 pos \x3d vec4($position, 1.0);\r\n#ifndef WALL\r\n\t\tvec3 left \x3d $position.xyz - $auxpos1;\r\n\t\tvec3 right \x3d $auxpos2 - $position.xyz;\r\n\t\tvec3 up \x3d normalize($position.xyz);\r\n#endif // ifndef WALL\r\n#endif // ifdef SCREENSCALE\r\n\r\n#ifdef WALL\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tvec3 displacementDir \x3d normalize($position.xyz);//vec3(0.0, 1.0, 0.0);\r\n#else // ifdef WALL\r\n\r\n\t\tfloat leftLen \x3d length(left);\r\n\t\tleft \x3d (leftLen \x3e 0.001) ? left/leftLen : ZEROVEC;\r\n\r\n\t\tfloat rightLen \x3d length(right);\r\n\t\tright \x3d (rightLen \x3e 0.001) ? right/rightLen : ZEROVEC;\r\n\r\n\t\t// determine if vertex is on the "outside or "inside" of the join\r\n\t\tbool isOutside \x3d ISOUTSIDE;\r\n\r\n\t\t// compute miter join position first\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tVECTYPE displacementDir \x3d normalize(left + right);\r\n\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\tif (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\r\n\t\t\tfloat nDotSeg \x3d dot(displacementDir, left);\r\n\t\t\tdisplacementLen /\x3d length(nDotSeg*left - displacementDir);\r\n\r\n\t\t\t// limit displacement of inner vertices\r\n\t\t\tif (!isOutside)\r\n\t\t\t\tdisplacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\r\n\t\t}\r\n\r\n\t\tif (isOutside \x26\x26 (displacementLen \x3e miterLimit*lineWidth)) {\r\n\t\t\t// convert to bevel join if miterLimit is exceeded\r\n\t\t\tif (leftLen \x3c 0.001)\r\n\t\t\t    displacementDir \x3d right;\r\n\t\t\telse if (rightLen \x3c 0.001)\r\n\t\t\t\tdisplacementDir \x3d left;\r\n\t\t\telse\r\n\t\t\t\tdisplacementDir \x3d (abs($uv0.y) - 1.1 \x3c 0.0) ? left : right;\r\n\t\t\tdisplacementDir \x3d normalize(displacementDir);\r\n\t\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\t\tdisplacementLen \x3d lineWidth;\r\n\t\t}\r\n\r\n#endif // ifdef WALL\r\n\r\n#ifdef SCREENSCALE\r\n\t\tpos.xy +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos.xy /\x3d screenSize;\r\n#else\r\n\t\tpos.xyz +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos \x3d proj * view * model * pos;\r\n#endif\r\n\r\n\t\tvtc \x3d $uv0;\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255\r\n\t\tgl_Position \x3d pos;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsRibbonLine"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d eColor * vColor;\r\n\t\t//gl_FragColor.a \x3d 1;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsRibbonLineHighlight"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/WaterMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderWater"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main(void) {\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderWater"\x3e\x3c![CDATA[\r\n\t$fsprecisionf\r\n\r\n\tuniform vec3 color;\r\n\tuniform float scale;\r\n\tuniform float speed;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform sampler2D noiseTex;\r\n\tuniform sampler2D reflTex;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\t$evalShadow\r\n\r\n\t$normal2envTC\r\n\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tfloat compDelta(vec2 pos) {\r\n\t\tconst float PI_THIRD \x3d 1.04719755;\r\n\r\n\t\tfloat result \x3d .0;\r\n\t\tfloat s \x3d 1.0;\r\n\t\tfor (int i \x3d 0; i \x3c 6; ++i) {\r\n\t\t\tvec2 tc \x3d pos / (20.0 * s);\r\n\t\t\ttc +\x3d rotate(vec2(1.0 + speed, .0), PI_THIRD * float(i));\r\n\t\t\tresult +\x3d s * texture2D(noiseTex, tc).r;\r\n\t\t\ts *\x3d 1.5;\r\n\t\t}\r\n\t\treturn result * scale * .2;\r\n\t}\r\n\r\n\tvoid main() {\r\n\t\tvec3 viewVec \x3d normalize(camPos - vpos);\r\n\r\n\t\tfloat d0 \x3d compDelta(vpos.xz);\r\n\t\tfloat dx \x3d compDelta(vpos.xz + vec2(.05, .0));\r\n\t\tfloat dz \x3d compDelta(vpos.xz + vec2(.0, .05));\r\n\r\n\t\tvec3 normal \x3d normalize(vec3(d0 - dx, .05, d0 - dz));\r\n\r\n\t\tfloat fresnel \x3d clamp(1.0 - 1.25 * dot(viewVec, normal), .0, 1.0);\r\n\r\n\t\tfloat shadow \x3d 0.0;\r\n\t\tif (halfPxSz \x3e\x3d .0) {\r\n\t\t\tshadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n\t\t}\r\n\r\n\t\tvec3 reflDir \x3d reflect(-viewVec, normal);\r\n\t\tif (reflDir.y \x3c .02) reflDir.y \x3d 0.04 - reflDir.y;\r\n\r\n\t\tvec3 reflCol \x3d texture2D(reflTex, normal2envTC(reflDir)).rgb * lightAmbient.rgb*lightSpecular.w;\r\n\t\treflCol *\x3d .5 + max(lightDirection.y, .0) * .5; // ?\t+\r\n\t\tvec3 waterColor \x3d color * (lightAmbient.rgb * lightAmbient.w + (1.0 - shadow) * max(lightDirection.y, .0) * lightDiffuse.rgb * lightDiffuse.w);\r\n\t\tvec3 finalColor \x3d mix(waterColor, reflCol, .15 + .6 * fresnel);\r\n\r\n\t\tvec3 spec \x3d pow(max(dot(reflDir, lightDirection), .001), 80.0) * lightSpecular.rgb * lightSpecular.w * 2.0;\r\n\t\tfinalColor +\x3d (1.0 - shadow) * lightDiffuse.w * spec;\r\n\r\n\t\tgl_FragColor \x3d vec4(finalColor, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/BlendLayers.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBlendLayers"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\r\n\tuniform float scale;\r\n\tuniform vec2 offset;\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d vec4($position, 1.0);\r\n\t\tuv \x3d $uv0 * scale + offset;;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBlendLayers"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform float opacity;\r\n\r\n\tvoid main() {\r\n\t\tvec4 color \x3d texture2D(tex, uv);\r\n\r\n    // Note: output in pre-multiplied alpha for correct alpha compositing\r\n\t\tgl_FragColor \x3d vec4(color.xyz, 1.0) * color.a * opacity;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/terrain/TerrainMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrain"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform vec3 origin;\r\n  uniform vec2 texOffset;\r\n  uniform float texScale;\r\n  uniform mat4 viewNormal;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  uniform vec3 lightDirection;\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n#ifdef OVERLAY\r\n  uniform vec2 overlayTexOffset;\r\n  uniform vec2 overlayTexScale;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\r\n\r\n  uniform vec4 screenSizePerspective;\r\n\r\n  varying float screenSizeDistanceToCamera;\r\n  varying float screenSizeCosAngle;\r\n\r\n#endif\r\n\r\n  void main(void) {\r\n    vpos \x3d $position;\r\n\r\n#ifdef SPHERICAL\r\n    vnormal \x3d normalize(vpos + origin);\r\n#else\r\n    vnormal \x3d vec3(0, 0, 1); // WARNING: up-axis dependent code\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n    wpos \x3d (view * vec4(vpos, 1.0)).xyz;\r\n    wnormal \x3d (viewNormal * vec4(normalize(vpos+origin), 1.0)).xyz;\r\n    wlight \x3d (view  * vec4(lightDirection, 1.0)).xyz;\r\n#endif\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n    vuv \x3d $uv0;\r\n#endif\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\r\n\r\n    vec3 viewPos \x3d (view * vec4(vpos, 1.0)).xyz;\r\n\r\n    screenSizeDistanceToCamera \x3d length(viewPos);\r\n\r\n    vec3 viewSpaceNormal \x3d (viewNormal * vec4(normalize(vpos + origin), 1.0)).xyz;\r\n    screenSizeCosAngle \x3d abs(viewSpaceNormal.z);\r\n\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\r\n    vtc \x3d $uv0*texScale + texOffset;\r\n\r\n#ifdef OVERLAY\r\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainCommon"\x3e\x3c![CDATA[\r\n  uniform vec3 lightDirection;\r\n  uniform vec3 viewDirection;\r\n  uniform sampler2D depthTex;\r\n  uniform int shadowMapNum;\r\n  uniform vec4 shadowMapDistance;\r\n  uniform mat4 shadowMapMatrix[4];\r\n  uniform float depthHalfPixelSz;\r\n  uniform sampler2D ssaoTex;\r\n  uniform vec4 viewportPixelSz;\r\n  uniform sampler2D tex;\r\n  uniform float opacity;\r\n\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n  varying vec2 vtc;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n  $sceneLightingDefinitions\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\r\n  $screenSizePerspective\r\n\r\n  uniform vec4 screenSizePerspective;\r\n\r\n  varying float screenSizeDistanceToCamera;\r\n  varying float screenSizeCosAngle;\r\n#endif\r\n\r\n  const vec3 ambient \x3d vec3(0.2,0.2,0.2);\r\n  const vec3 diffuse \x3d vec3(0.8,0.8,0.8);\r\n  const float diffuseHardness \x3d 2.5;\r\n\r\n#ifdef OVERLAY\r\n  uniform sampler2D overlayTex;\r\n  uniform float overlayOpacity;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\t$evalShadow\r\n#endif\r\n\r\n  float lum(vec3 c) {\r\n    float max \x3d max(max(c.r, c.g), c.b);\r\n    float min \x3d min(min(c.r, c.g), c.b);\r\n    return (min + max) * 0.5;\r\n  }\r\n\r\n#ifdef ATMOSPHERE\r\n  vec3 atmosphere(vec3 lightPos, vec3 normal, vec3 view) {\r\n    vec3 surfaceColor   \x3d vec3(0.0);\r\n    vec3 fuzzySpecColor \x3d vec3(1.0);\r\n    vec3 subColor       \x3d vec3(0.0);\r\n    float rollOff       \x3d 1.0;\r\n\r\n    vec3 Ln \x3d normalize(lightPos);\r\n    vec3 Nn \x3d normalize(normal);\r\n    vec3 Hn \x3d normalize(view + Ln);\r\n\r\n    float ldn \x3d dot(Ln, Nn);\r\n    float diffComp \x3d max(0.0, ldn);\r\n    float vdn \x3d 1.0 - dot(view, Nn);\r\n    float ndv \x3d dot(view, Ln);\r\n\r\n    vec3 diffContrib \x3d surfaceColor * diffComp;\r\n    float subLamb \x3d max(0.0, smoothstep(-rollOff, 1.0, ldn) - smoothstep(0.0, 1.0, ldn));\r\n\r\n    vec3 subContrib \x3d subLamb * subColor;\r\n    vec3 vecColor \x3d vec3(vdn);\r\n\r\n    vec3 diffuseContrib \x3d (subContrib + diffContrib);\r\n    vec3 specularContrib \x3d (vecColor * fuzzySpecColor);\r\n\r\n    return (diffContrib + specularContrib) * rollOff;\r\n  }\r\n#endif\r\n\r\n  void main() {\r\n    vec3 a \x3d ambient;\r\n\r\n    float shadow \x3d 0.0;\r\n#ifdef RECEIVE_SHADOWS\r\n    shadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n#endif\r\n    float vndl \x3d dot(normalize(vnormal), lightDirection);\r\n    float k \x3d smoothstep(0.0, 1.0, clamp(vndl*diffuseHardness, 0.0, 1.0));\r\n    vec3 d \x3d (1.0 - shadow/1.8) * diffuse * k;\r\n\r\n    float ssao \x3d viewportPixelSz.w \x3c .0 ? 1.0 : texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n    vec4 texCol \x3d texture2D(tex, vtc);\r\n\r\n#ifdef OVERLAY\r\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\r\n      vec4 overlayTexCol \x3d texture2D(overlayTex, vtcOverlay);\r\n      overlayTexCol *\x3d overlayOpacity;\r\n      texCol \x3d texCol * (1.0 - overlayTexCol.a) + overlayTexCol; // texCol and overlayTexCol have pre-multiplied alpha\r\n    }\r\n#endif\r\n\r\n    vec3 atm \x3d vec3(0.0);\r\n#ifdef ATMOSPHERE\r\n    float ndotl \x3d max(0.0, min(1.0, vndl));\r\n    atm \x3d atmosphere(wlight, wnormal, -viewDirection);\r\n    atm *\x3d max(0.0, min(1.0, (1.0-lum(texCol.rgb)*1.5))); //avoid atmosphere on bright base maps\r\n    atm *\x3d max(0.0, min(1.0, ndotl*2.0)); // avoid atmosphere on dark side of the globe\r\n#endif\r\n\r\n    vec3 albedo \x3d atm + texCol.rgb;\r\n    vec3 normal \x3d normalize(vnormal);\r\n\r\n    // heuristic shading function used in the old terrain, now used to add ambient lighting\r\n    float additionalAmbientScale \x3d smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));\r\n\t\tvec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\r\n\r\n    gl_FragColor \x3d vec4(evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight), texCol.a) * opacity;\r\n\r\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\r\n    // This is only used for debug rendering the screenSize perspective\r\n\r\n    float perspectiveScale \x3d screenSizePerspectiveScaleFloat(1.0, screenSizeCosAngle, screenSizeDistanceToCamera, screenSizePerspective);\r\n\r\n    if (perspectiveScale \x3c\x3d 0.25) {\r\n      gl_FragColor \x3d mix(gl_FragColor, vec4(1, 0, 0, 1), perspectiveScale * 4.0);\r\n    }\r\n    else if (perspectiveScale \x3c\x3d 0.5) {\r\n      gl_FragColor \x3d mix(gl_FragColor, vec4(0, 0, 1, 1), (perspectiveScale - 0.25) * 4.0);\r\n    }\r\n    else if (perspectiveScale \x3e\x3d 0.99) {\r\n      gl_FragColor \x3d mix(gl_FragColor, vec4(0, 1, 0, 1), 0.2);\r\n    }\r\n    else {\r\n      gl_FragColor \x3d mix(gl_FragColor, vec4(1, 0, 1, 1), (perspectiveScale - 0.5) * 2.0);\r\n    }\r\n\r\n#endif\r\n\r\n  // closing } is missing here, it\'s in the shaders using this snippet below\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainWireframe"\x3e\x3c![CDATA[\r\n#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\n  $fsprecisionf\r\n\r\n  struct WireframeSettings {\r\n    float width;\r\n    float falloff;\r\n    float subdivision;\r\n    vec4 color;\r\n    float wireOpacity;\r\n    float surfaceOpacity;\r\n  };\r\n\r\n  uniform WireframeSettings wireframe;\r\n\r\n    $fsTerrainCommon\r\n\r\n    vec2 dVuv;\r\n    vec2 vuvScaled \x3d vuv * wireframe.subdivision;\r\n    vec2 vuvMod \x3d fract(vuvScaled);\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n    dVuv \x3d fwidth(vuvScaled);\r\n#else\r\n    // Something that reasonably works\r\n    dVuv \x3d vec2(0.05);\r\n#endif\r\n\r\n    vec2 edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                                  wireframe.width * dVuv, min(vuvMod, 1.0 - vuvMod));\r\n\r\n    float edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n#ifdef WIREFRAME\r\n    gl_FragColor \x3d vec4(mix(gl_FragColor.rgb, wireframe.color.rgb, edgeFactor * wireframe.color.a),\r\n                        mix(wireframe.surfaceOpacity, wireframe.wireOpacity, edgeFactor));\r\n#endif\r\n\r\n\r\n#ifdef TILE_BORDERS\r\n    dVuv \x3d fwidth(vuv);\r\n    edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                              wireframe.width * dVuv, min(vuv, 1.0 - vuv));\r\n    edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n    gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrain"\x3e\x3c![CDATA[\r\n    $fsprecisionf\r\n    $fsTerrainCommon\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainNormal"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  uniform vec3 origin;\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform mat4 viewNormal;\r\n  attribute vec3 $position;\r\n  varying vec3 vnormal;\r\n\r\n  void main(void) {\r\n#ifdef SPHERICAL\r\n    vec4 normal \x3d vec4(normalize($position + origin), 1.0);\r\n#else\r\n    vec4 normal \x3d vec4(0.0, 1.0, 0.0, 1.0);\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n    vnormal \x3d normalize((viewNormal * normal).xyz);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n  attribute vec3 $position;\r\n\r\n  void main() {\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n  void main() {\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainHighlight"\x3e\x3c![CDATA[\r\n  $vsprecisionf\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform vec2 overlayTexScale;\r\n  uniform vec2 overlayTexOffset;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  varying vec2 vtcOverlay;\r\n\r\n  void main() {\r\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\r\n\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainHighlight"\x3e\x3c![CDATA[\r\n  $fsprecisionf\r\n\r\n  uniform sampler2D overlayTex;\r\n\r\n  uniform sampler2D depthTex;\r\n  uniform vec4 highlightViewportPixelSz;\r\n\r\n  varying vec2 vtcOverlay;\r\n\r\n  void main() {\r\n    vec4 texCol \x3d vec4(0,0,0,0);\r\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\r\n      texCol \x3d texture2D(overlayTex, vtcOverlay);\r\n    }\r\n\r\n    if (texCol.a \x3d\x3d 0.0) {\r\n      // Here we have to write black, instead of discarding the fragment in order to overwrite\r\n      // the highlights which might have been written by skirts of other tiles.\r\n      // As a consequence skirts are not visible, but terrain overwrites draped highlights.\r\n      gl_FragColor \x3d vec4(0,0,0,0);\r\n      return;\r\n    }\r\n\r\n    $highlightWrite\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"*now":function(m){m(['dojo/i18n!*preload*esri/views/nls/SceneView*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},"*noref":1}});
define("../core/accessorSupport/watch dojo/_base/lang dojo/_base/kernel dojo/dom dojo/Deferred dojo/when ./View ./DOMContainer ./ViewAnimation ./animation/easing ../geometry/HeightModelInfo ../geometry/SpatialReference ../geometry/support/scaleUtils ../geometry/support/webMercatorUtils ../Camera ../Graphic ../geometry/Point ../geometry/Extent ../geometry/ScreenPoint ../Viewpoint ../core/Scheduler ../core/sniff ../core/watchUtils ../core/promiseUtils ../core/Error ../core/Logger ../core/HandleRegistry ../webscene/Environment ./support/screenshotUtils ./support/WebGLRequirements ./3d/environment/SceneViewEnvironment ./3d/environment/SceneViewEnvironmentManager ./3d/constraints/SceneViewConstraints ./3d/input/SceneInputManager ./3d/lib/glMatrix ./3d/support/cameraUtils ./3d/support/viewpointUtils ./3d/support/projectionUtils ./3d/webgl-engine/Stage ./3d/webgl-engine/lib/Selector ./3d/support/CombinedElevationProvider ./3d/support/HighlightOptions ./3d/support/RenderCoordsHelper ./3d/support/MapCoordsHelper ./3d/support/ResourceController ./3d/support/DisplayQualityProfile ./3d/support/QualitySettings ./3d/support/SharedSymbolResources ./3d/support/FocusTracker ./3d/support/debugFlags ./3d/terrain/TerrainSurface ./3d/terrain/terrainUtils ./3d/layers/graphics/Deconflictor ./3d/layers/GraphicsView3D ./3d/navigation/spherical/NavigationSpherical ./3d/navigation/planar/NavigationPlanar ./3d/support/Frustum ./ui/3d/DefaultUI3D".split(" "),function(m,
h,d,c,a,b,k,f,g,e,l,p,v,q,n,t,u,x,r,z,B,C,A,D,E,H,G,J,I,F,N,L,M,K,ba,X,T,V,P,W,U,Y,S,ca,ga,ea,aa,R,da,fa,la,ja,ka,Q,va,na,ya,w){function ia(a,b){return function(){return this._internallyReady?b.apply(this,arguments):this._get(a)}}function ra(a,b){return function(c){if(this._internallyReady)return b.apply(this,arguments);this._initialProps[a]=c;this._set(a,c);ta[a]&&this.notifyChange("initialExtentRequired")}}R=R.default;var oa=H.getLogger("esri.views.SceneView"),Ba=ba.vec3d,wa=Ba.create();H=new u(0,
0,0);var sa=new n(new u(0,0,0)),Z={point:H,retval:null},Aa={heading:0,tilt:0},ta={camera:["viewpoint"],viewpoint:["extent"],extent:["center","scale"],scale:["zoom"],center:[],zoom:[]},Fa=Object.keys(ta);da=da.default;return f.createSubclass([k],{declaredClass:"esri.views.SceneView",properties:{animation:{type:g,value:null},basemapTerrain:{readOnly:!0,value:null},elevationProvider:{readOnly:!0,value:null},camera:{copy:function(a,b){a.position.x=b.position.x;a.position.y=b.position.y;a.position.z=b.position.z;
a.position.spatialReference=b.position.spatialReference;a.heading=b.heading;a.tilt=b.tilt},type:n},canvas:{readOnly:!0,value:null},center:{copy:function(a,b){if(!a)return b.clone();a.x=b.x;a.y=b.y;a.z=b.z;a.spatialReference=b.spatialReference;return a},type:u},clippingArea:{type:x,dependsOn:["map.clippingArea","map.clippingEnabled","viewingMode"],get:function(){if("global"===this.viewingMode)return null;if(this._userClippingArea)return this._userClippingArea;var a=this.get("map.clippingEnabled"),
b=this.get("map.clippingArea");if(!a||!b)return this._clippingArea=null;if(!(b instanceof x))return oa.error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea;if(q.canProject(b.spatialReference,this.spatialReference))b=q.project(b,this.spatialReference);else return oa.error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea;return this._clippingArea&&b&&this._clippingArea.equals(b)?this._clippingArea:this._clippingArea=
b},set:function(a){this.ready&&"global"===this.viewingMode&&a?oa.error("#clippingArea\x3d","Clipping area is only supported in local viewingMode"):(this._userClippingArea=a,this.notifyChange("clippingArea"))}},constraints:{type:M,value:null},dataExtent:{dependsOn:["basemapTerrain.extent","clippingArea","map"],readOnly:!0,get:function(){function a(a){a&&(a=q.project(a,c))&&(d&&(a=a.intersection(d)),a&&b.push(a))}var b=[],c=this.spatialReference||p.WGS84,d=this.clippingArea;d&&(d=q.project(d,c));var e=
this._get("basemapTerrain");e&&e.spatialReference&&a(new x({xmin:e.extent[0],ymin:e.extent[1],zmin:0,xmax:e.extent[2],ymax:e.extent[3],zmax:0,spatialReference:e.spatialReference}));this.map&&this.map.allLayers.forEach(function(b){a(b.fullExtent)});return 0<b.length?(e=b.reduce(function(a,b){return a.union(b)}),e.hasZ?(e.zmin=Math.min(0,e.zmin),e.zmax=Math.max(0,e.zmax)):(e.zmin=0,e.zmax=0),e):new x({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:c})}},environment:{value:null,set:function(a){a!==
this._defaults.environment&&(this._externallySet.environment=!0);a?a instanceof N?this._set("environment",a):a instanceof J?this.environment.lighting=a.lighting:a.declaredClass?this._set("environment",a):this._set("environment",new N(a)):this._set("environment",new N)}},environmentManager:{},extent:{copy:function(a,b){a.xmin=b.xmin;a.ymin=b.ymin;a.zmin=b.zmin;a.xmax=b.xmax;a.ymax=b.ymax;a.zmax=b.zmax;a.spatialReference=b.spatialReference},type:x},fullOpacity:1,groundExtent:{dependsOn:["basemapTerrain.extent"],
readOnly:!0,get:function(){var a=this._get("basemapTerrain");if(a&&a.spatialReference){var b=a.extent;return new x({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a.spatialReference})}return new x({spatialReference:this.spatialReference||p.WGS84})}},initialExtentRequired:{dependsOn:["map.initialViewProperties.viewpoint"],get:function(){if(this.get("map.initialViewProperties.viewpoint"))return!1;for(var a=0;a<Fa.length;a++)if(this._initialProps&&void 0!==this._initialProps[Fa[a]])return!1;
return!0}},heightModelInfo:{type:l,dependsOn:["map.initialViewProperties.heightModelInfo","defaultsFromMap.heightModelInfo"]},interacting:{dependsOn:["navigation.interacting"],get:function(){return!(!this.navigation||!this.navigation.interacting)}},map:{value:null},mapCoordsHelper:{},screenSizePerspectiveEnabled:!0,navigation:{readOnly:!0,value:null},inputManager:{},qualityProfile:{set:function(a){ea.isValidProfile(a)&&(ea.apply(a,this),this._set("qualityProfile",a))}},qualitySettings:{type:aa},ready:{dependsOn:["viewingMode"]},
renderCoordsHelper:{},resolution:{dependsOn:["scale","spatialReference"],readOnly:!0,get:function(){return null!=this.spatialReference?v.getResolutionForScale(this.scale,this.spatialReference):0}},scale:{},spatialReference:{dependsOn:["map.initialViewProperties.spatialReference","defaultsFromMap.isSpatialReferenceDone"]},type:"3d",ui:{type:w},updating:{},updatingPercentage:0,viewingMode:{dependsOn:["map.initialViewProperties.viewingMode","spatialReference"],get:function(){var a=this.get("map.initialViewProperties.viewingMode"),
b=this.spatialReference;a||(a=!b||b.isWebMercator||b.isWGS84?"global":"local");return a},set:function(a){this._internallyReady?oa.error("#viewingMode","viewingMode cannot be set once view is ready"):0<=["local","global"].indexOf(a)?this._override("viewingMode",a):void 0===a&&this._clearOverride("viewingMode")}},viewpoint:{copy:function(a,b){a.rotation=b.rotation;a.scale=b.scale;a.targetGeometry=b.targetGeometry;a.camera=b.camera},dependsOn:["camera"],type:z},zoom:{dependsOn:["scale"]},highlightOptions:{type:Y}},
getDefaults:function(a){var b=this.inherited(arguments);b.constraints||a.constraints||(this._defaults.constraints=new M,b.constraints=this._defaults.constraints);b.environment||a.environment||(this._defaults.environment=new N,b.environment=this._defaults.environment);b.popup.autoPanEnabled=!1;b.qualitySettings=new aa;b.qualityProfile=ea.getDefaultProfile();b.highlightOptions=new Y;return b},constructor:function(){A.when(this,"ready",this._viewReadyHandler.bind(this));this._internallyReady=!1;this._initialProps=
{};this._initialDefaultSpatialReference=this._gotoTask=this._userHeightModelInfo=this._userClippingArea=null;this._initCoordinateSystem();this._frustum=new ya;this._clippingArea=this._constraints=this._animationStateWatcher=null;this.inputManager=new K({view:this});this._defaults={};this._externallySet={};this.resourceController=new ga(this);this.deconflictor=new ka(this);this._evaluateUpdating=this._evaluateUpdating.bind(this);this._layerViewsUpdatingHandles={};this._navigationHandles=new G;this._stageHandles=
new G;this._navigationPauseNotifications=!1;this._navigationHandles.add([A.on(this,"navigation","currentViewChanged",this._navigationCurrentViewChanged.bind(this),null,null,!0),A.on(this,"navigation","currentViewReachedTarget",this._navigationCurrentViewReachedTarget.bind(this),null,null,!0),A.on(this,"navigation","targetViewChanged",function(a){this._navigationPauseNotifications||this._navigationTargetViewChanged(a)}.bind(this),null,null,!0),A.on(this,"navigation","animationStarted",function(a){this._navigationPauseNotifications||
this._navigationAnimationStarted(a)}.bind(this),null,null,!0)]);this.watch("map",function(a){a&&a.load&&a.load()})},initialize:function(){this.environmentManager=new L({view:this});this._updateUpdatingMonitorsHandle=this.allLayerViews.on("change",this._updateUpdatingMonitors.bind(this));this._updateUpdatingMonitors({added:this.allLayerViews.toArray(),removed:[],moved:[]});A.whenNot(this,"ready",this._viewUnreadyHandler.bind(this));A.init(this.qualitySettings,"gpuMemoryLimit",function(a){this.resourceController&&
this.resourceController.setMaxGpuMemory(a)}.bind(this))},destroy:function(){m.dispatchTarget(this);this.environmentManager.destroy();this._disposeGraphicsView();this._updateUpdatingMonitorsHandle.remove();this._updateUpdatingMonitorsHandle=null;this._navigationHandles.remove();this._navigationHandles=null;this._stageHandles.remove();this.inputManager&&(this.inputManager.destroy(),this.inputManager=null)},destroyLayerViews:function(){for(var a in this._layerViewsUpdatingHandles)this._layerViewsUpdatingHandles[a].remove();
this._layerViewsUpdatingHandles={};this._disposeSurface();this.inherited(arguments);this._stage&&(this._stage.dispose(),this._stage=null,this._stageHandles.remove());this._setCanvas(null);this.deconflictor.destroy();this.deconflictor=null;this.resourceController.destroy();this.resourceController=null},on:function(a,b,c){var d=this.inputManager.viewEvents.register(a,b,c);return d?d:this.inherited(arguments)},toMap:function(a,b,c){if(!this._internallyReady)return oa.error("#toMap()","Scene view cannot be used before it is ready"),
null;a=this._normalizePointArgs(a,b,void 0,c);b=this._stage.pick([a.point.x,this.height-a.point.y]).getMinResult();return this._computeMapPointFromIntersectionResult(b,a.retval)},toScreen:function(a,b,c,d){if(!this._internallyReady)return oa.error("#toScreen()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,c,d);V.pointToVector(a.point,wa,this.renderSpatialReference);return this.engineToScreen(wa,a.retval)},pixelSizeAt:function(a,b,c){if(!this._internallyReady)return oa.error("#pixelSizeAt()",
"Scene view cannot be used before it is ready"),null;if("esri.geometry.ScreenPoint"===a.declaredClass){if(!this._stage.pick([a.x,this.height-a.y]).getMinResult().getIntersectionPoint(wa))return 0}else a=this._normalizePointArgs(a,b,c,void 0),V.pointToVector(a.point,wa,this.renderSpatialReference);return this.navigation.currentCamera.computePixelSizeAt(wa)},hitTest:function(a,c){if(!this._internallyReady)return oa.error("#hitTest()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,
c,void 0,void 0);var d=[a.point.x,this.height-a.point.y],e=this._stage.pick(d,null,!0);a=e.getMinResult();var f=this._computeMapPointFromIntersectionResult(a),g;switch(a.targetType){case "None":g=null;break;case "StageObject":g=this._getGraphicFromStageObject(a.target,a.triangleNr);break;case "StagePoint":g=this._getGraphicFromStagePoint(a.target)}return b(g).otherwise(function(){return null}).then(function(a){var b=[];(a||f)&&b.push({mapPoint:f,graphic:a});a={screenPoint:d,results:b};fa.SCENEVIEW_HITTEST_RETURN_SELECTOR&&
(a.selector=e);return a})},goTo:function(a,b){if(this._internallyReady)return b=h.mixin({animate:!0},b),a=T.create(this,a,b),this._gotoTask={},b.animate?this._gotoAnimated(a,b):this._gotoImmediate(a,b);oa.error("#goTo()","Scene view cannot be used before it is ready")},animateTo:function(a,b){d.deprecated(this.declaredClass+".animateTo is deprecated. Use .goTo instead.","","4.0");return this.goTo(a,b)},takeScreenshot:function(b){if(this._internallyReady){b=I.adjustScreenshotSettings(b,this);var c=
new a;this._stage.requestScreenCapture(b,function(a){B.schedule(function(){c.resolve(a)})});return c.promise}oa.error("#takeScreenshot()","Scene view cannot be used before it is ready")},engineToScreen:function(a,b){var c=Ba.create();this._stage.getCamera().projectPoint(a,c);a=c[0];var d=this.height-c[1],c=c[2];return b?(b.x=a,b.y=d,b.z=c,b):new r({x:a,y:d,z:c})},getDefaultSpatialReference:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||
this.get("defaultsFromMap.isSpatialReferenceDone")&&this._initialDefaultSpatialReference||null},getDefaultHeightModelInfo:function(){return this.get("map.initialViewProperties.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null},validate:function(){var a=F.check();C("safari")&&9>C("safari")&&(a=new E("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari \x3c 9)",{type:"safari",requiredVersion:9,detectedVersion:C("safari")}));return a?D.reject(a):D.resolve()},
isSpatialReferenceSupported:function(a,b){var c=a.isGeographic,d=a.isWebMercator,e=a.isWGS84,f="local"===this.viewingMode,g=!(!this._isOverridden("viewingMode")&&!this.get("map.initialViewProperties.viewingMode"));if(g){if(f&&c||!f&&!d&&!e)return!1}else if(c&&!e)return!1;if(b)if(ja.isTiledLayer(b)){if(c=ja.getTileInfo(b),g?null!=ja.checkIfTileInfoSupportedForView(c,b.fullExtent,a,this.viewingMode):null!=ja.checkIfTileInfoSupportedForView(c,b.fullExtent,a,"local")&&null!=ja.checkIfTileInfoSupportedForView(c,
b.fullExtent,a,"global"))return!1}else if((e||d)&&!f)return null==this._initialDefaultSpatialReference&&(this._initialDefaultSpatialReference=a),g||this.ready||(this.viewingMode="global"),!1;return!0},isHeightModelInfoRequired:function(){return!0},has:function(a){return this._stage.has(a)},flushDisplayModifications:function(){this._stage.processDirty()},getFrustum:function(){this._frustum.dirty&&this._frustum.update(this.navigation.currentCamera);return this._frustum},getDrawingOrder:function(a){return this.allLayerViews.findIndex(function(b){return b.layer&&
b.layer.uid===a})},getViewForGraphic:function(a){return a.layer?this.allLayerViews.find(function(b){return b.layer===a.layer}):this._graphicsView},whenViewForGraphic:function(a){return a.layer?this.whenLayerView(a.layer):D.resolve(this._graphicsView)},renderSpatialReference:null,_graphicsView:null,_surfaceReadyWatchHandle:null,_stageHandles:null,_navigationHandles:null,_gotoImmediate:function(a,b){var c=this._gotoTask;return a.then(function(a){c===this._gotoTask&&(this.viewpoint=a)}.bind(this))},
_gotoAnimated:function(a,b){!this.animation||"running"!==this.animation.state&&"waiting-for-target"!==this.animation.state?this.animation=new g({target:a}):this.animation.target=a;var c=this.animation;c.state="waiting-for-target";a.then(function(d){if(c.target===a&&this.animation===c){c.target=d;c.state="running";d=T.toCamera(this,d);if(!d)throw oa.error("#goTo()","Invalid target specified for animateTo"),new E("goto:invalid-camera","Invalid camera in conversion from viewpoint");this._cameraAlmostEquals(this.camera,
d)?c.finish():(d=X.externalToInternal(this,d),d.almostEquals(this.navigation.currentCamera,5E-4/this.renderCoordsHelper.unitInMeters)?c.finish():(this._navigationPauseNotifications=!0,this._setInternalCamera(d,this._animateOptions(b)),c.state===g.State.STOPPED&&c.stop(),this._navigationPauseNotifications=!1))}}.bind(this)).otherwise(function(){c.target===a&&this.animation===c&&(this.animation=null,c.finish())});return c},_animateOptions:function(a){var b={animate:!0};a&&null!=a.speedFactor&&(b.speedFactor=
a.speedFactor);a&&null!=a.duration&&(b.duration=a.duration/1E3);a&&null!=a.minDuration&&(b.minDuration=a.minDuration/1E3);a&&null!=a.maxDuration&&(b.maxDuration=a.maxDuration/1E3);a&&null!=a.easing&&(b.easing="string"===typeof a.easing?e.named[a.easing]:a.easing);return b},_trackCanvasSize:function(){this.on("resize",function(a){if(this.canvas){this.canvas.width=a.width;this.canvas.height=a.height;var b=this._stage.getCamera();b.width=a.width;b.height=a.height;this._stage.setCamera(b);this.navigation&&
(this.navigation.windowSize=[a.width,a.height])}}.bind(this));this.canvas.width=this.width;this.canvas.height=this.height},_computeMapPointFromIntersectionResult:function(a,b){if(a.getIntersectionPoint(wa)){b=this._computeMapPointFromVec3d(wa,b);var c=this._get("basemapTerrain");"terrain"===a.intersector&&c&&(a=c.getElevation(b),null!==a&&(b.z=a));return b}return null},_computeMapPointFromVec3d:function(a,b){var c=this.spatialReference||p.WGS84;V.vectorToVector(a,this.renderSpatialReference,a,c)||
(c=p.WGS84,V.vectorToVector(a,this.renderSpatialReference,a,c));b?(b.x=a[0],b.y=a[1],b.z=a[2],b.spatialReference=c):b=new u(a,c);return b},_getGraphicFromStageObject:function(a,b){var c=a.getMetadata();if(null!=c&&null!=c.layerId){if(c.layerId===this._graphicsView.mockLayerId)return this._graphicsView.getGraphicsFromStageObject(a,b);if(c=this.map.findLayerById(c.layerId))return this.whenLayerView(c).then(function(c){if(c&&null!=c.getGraphicsFromStageObject&&!c.suspended)return c.getGraphicsFromStageObject(a,
b)})}return null},_getGraphicFromStagePoint:function(a){var b=this._computeMapPointFromVec3d(a.point),b=new t(b);a=a.metadata.layerId;null!=a&&(b.layer=this.map.findLayerById(a));return b},_viewingModeToManifold:function(a){return{local:"planar",global:"spherical"}[a]},_initBasemapTerrain:function(a){this._disposeBasemapTerrain();this._set("basemapTerrain",new la(this,this._viewingModeToManifold(a)));this._set("elevationProvider",new U(this));this.elevationProvider.register("ground",this.basemapTerrain);
this.navigation.elevationProvider=this.basemapTerrain},_initGlobe:function(a){this._initCoordinateSystem();this._initNavigation(a);this._stage.setViewParams({backgroundColor:[0,0,0,0],maxFarNearRatio:0,frustumCullingEnabled:!1});this._initBasemapTerrain(a);this._navigationCurrentViewChanged({camera:this.navigation.currentCamera})},_initCoordinateSystem:function(){if(this.spatialReference){var a=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(a)||(this.mapCoordsHelper=
new ca(this.map,a));var b=this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1,c="global"===this.viewingMode,a=c?V.SphericalRenderSpatialReference:a;a!==this.renderSpatialReference&&(this.renderSpatialReference=a,this.renderCoordsHelper=new (c?S.Spherical:S.Planar)(a),this._stage&&this._stage.setIntersectTolerance(W.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._constraints&&this._constraints.scale(b/this.renderCoordsHelper.unitInMeters))}else this.renderSpatialReference=
this.renderCoordsHelper=this.mapCoordsHelper=null},_paddingEqualsArray:function(a){var b=this.padding;return b?b.top===a[0]&&b.right===a[1]&&b.bottom===a[2]&&b.left===a[3]:!0},_navigationCurrentViewChanged:function(a){this._frustum.dirty=!0;a=a.camera;var b=a.padding,c=this._get("basemapTerrain"),d=c.spatialReference;d&&(d=this.renderCoordsHelper.fromRenderCoords(a.eye,d),c=c.getElevation(d)||0,a.aboveGround=d.z>=c);this._paddingEqualsArray(b)||(c=this._padding,b={top:b[0],right:b[1],bottom:b[2],
left:b[3]},this._internallyReady?(this._padding=b,this.notifyChange("padding",c,b)):this.padding=b);this._stage.setCamera(a);this.notifyChange("center");this.notifyChange("extent");this.notifyChange("scale");b=this.camera;a=X.internalToExternal(this,a,sa);b&&this._cameraAlmostEquals(b,a)||this.notifyChange("camera")},_cameraAlmostEquals:function(a,b){return 1E-5>Math.abs(a.tilt-b.tilt)&&1E-5>Math.abs(a.heading-b.heading)&&1E-5>Math.abs(a.fov-b.fov)&&a.position.equals(b.position)},_navigationAnimationStarted:function(a){a=
T.fromInternalCamera(this,this.navigation.targetCamera);this.animation?this.animation.target=a:this.animation=new g({target:a})},_navigationTargetViewChanged:function(a){if(this.animation&&"waiting-for-target"!==this.animation.state){a=a.camera;var b=this.spatialReference||p.WGS84,c=X.internalToExternal(this,a);a=new z({camera:c,targetGeometry:V.vectorToPoint(a.center,b,this.renderSpatialReference),scale:X.computeScale(this,a),rotation:T.headingToRotation(c.heading)});this.animation.target=a}},_navigationCurrentViewReachedTarget:function(a){if(a.interruptedAnimation||
a.finishedAnimation)this._gotoTask=null;if(this.animation&&(a.interruptedAnimation||a.finishedAnimation)){this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null);var b=this.animation;this.animation=null;a.finishedAnimation?b.finish():b.stop();this.notifyChange("animation")}},_setInternalCamera:function(a,b){a&&(this.navigation.setCamera(a,b),this._externallySet.camera=!0);return!!a},_setCamera:function(a,b){return this._setInternalCamera(X.externalToInternal(this,
a),b)},_evaluateUpdating:function(){var a=0,b=0,c=!1;this.allLayerViews.forEach(function(d){d.updating&&(c=!0,d=d.updatingPercentage,null!=d&&(++b,a+=d))});this._graphicsView&&this._graphicsView.updating&&(c=!0);c!==this.updating&&(this.updating=c);a=0!==b?a/b:c?100:0;this.updatingPercentage!==a&&(this.updatingPercentage=a)},_updateUpdatingMonitors:function(a){for(var b=0;b<a.removed.length;b++){var c=a.removed[b],d=this._layerViewsUpdatingHandles[c.id];d&&(delete this._layerViewsUpdatingHandles[c.id],
c.destroyed||d.remove())}for(b=0;b<a.added.length;b++)c=a.added[b],c.destroyed||(d=c.watch(["updating","updatingPercentage"],this._evaluateUpdating),this._layerViewsUpdatingHandles[c.id]=d);this._evaluateUpdating()},_spatialReferenceSetter:function(a){this.inherited(arguments);this._initCoordinateSystem()},_setInitialView:function(a){if(a&&!this._externallySet.camera){var b=null;a instanceof z&&!a.camera&&a.targetGeometry instanceof x&&(b=T.rotationToHeading(a.rotation),a=a.targetGeometry);if(a instanceof
z)this.viewpoint=a;else if(a instanceof n)this.camera=a;else{var c=this._getDesiredHeadingTilt();null!=b&&(c.heading=b);T.create(this,{target:a,heading:c.heading,tilt:c.tilt}).then(function(a){this.navigation._dataExtentChanged();this.viewpoint=a}.bind(this))}}},_pickRay:function(a,b,c,d,e,f,g){return this._stage?this._stage.pickRay(a,b,c,d,e,f,g):null},_pickRayWithBeginPoint:function(a,b,c,d,e){return this._stage?this._stage.pickRayWithBeginPoint(a,b,c,d,e):null},_removeHandles:function(a){for(var b=
0;b<a.length;b++){var c=a[b];this[c]&&(this[c].remove(),this[c]=null)}},_setCanvas:function(a){a!==this._get("canvas")&&this._set("canvas",a)},_disposeSurface:function(){this._removeHandles(["_stageFrameTask","_updateDrawingOrderHandle","onViewExtentUpdateHandle","_mapLayersChangeHandle"]);this._disposeBasemapTerrain();this._setNavigation(null);this.environmentManager&&this.environmentManager.disposeRendering()},_disposeBasemapTerrain:function(){var a=this._get("basemapTerrain");a&&(a.destroy(),this._set("basemapTerrain",
null))},_disposeNavigation:function(){var a=this._get("navigation");a&&(a.destroy(),a.elevationProvider=null,this._set("navigation",null));this.focusTracker&&(this.focusTracker.destroy(),this.focusTracker=null)},_setNavigation:function(a){this._get("navigation")!==a&&(this._disposeNavigation(),a&&(a.windowSize=[this.width,this.height],a.userConstraints=this.constraints),this._set("navigation",a))},_initNavigation:function(a){a=a||this.viewingMode;var b={view:this};"global"===a?this._setNavigation(new va(b)):
this._setNavigation(new na(b));this.focusTracker=new da(this)},_initSurface:function(){var a={};a.deactivatedWebGLExtensions=this.deactivatedWebGLExtensions;a.viewingMode=this.viewingMode;this.renderCanvas&&(a.canvas=this.renderCanvas);this._stage=new P(this.viewingMode,c.byId(this.surface),a);this._stage.selectionState=!1;this._stageHandles.add(A.init(this.qualitySettings,"antialiasingEnabled",function(){this._stage.setRenderParams({antialiasingEnabled:this.qualitySettings.antialiasingEnabled})}.bind(this)));
this._stageHandles.add(A.watch(this,this.highlightOptions.keys().map(function(a){return"highlightOptions."+a}),function(){this._stage.setRenderParams({defaultHighlightOptions:Y.toEngineOptions(this.highlightOptions)})}.bind(this)));this._stageHandles.add(A.init(this,"highlightOptions",function(){this._stage.setRenderParams({defaultHighlightOptions:Y.toEngineOptions(this.highlightOptions)})}.bind(this)));this.renderCoordsHelper&&this._stage.setIntersectTolerance(W.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters);
this._setCanvas(this._stage.getCanvas());this._stageFrameTask=B.addFrameTask(this._stage.getFrameTask());this._trackCanvasSize();this._initGlobe(this.viewingMode);this.sharedSymbolResources=new R({stage:this._stage,viewingMode:this.viewingMode,resourceController:this.resourceController,focusTracker:this.focusTracker})},_initGraphicsView:function(){this._surfaceReadyWatchHandle=A.whenTrueOnce(this,"basemapTerrain.ready",function(){this._graphicsView=new Q({view:this,graphics:this.graphics});this._surfaceReadyWatchHandle=
null;this._layerViewsUpdatingHandles[this._graphicsView.mockLayerId]=A.init(this._graphicsView,"updating",this._evaluateUpdating)}.bind(this))},_disposeGraphicsView:function(){this._surfaceReadyWatchHandle&&(this._surfaceReadyWatchHandle.remove(),this._surfaceReadyWatchHandle=null);if(this._graphicsView){var a=this._graphicsView.mockLayerId;this._layerViewsUpdatingHandles[a].remove();delete this._layerViewsUpdatingHandles[a];this._graphicsView.destroy();this._graphicsView=null}},_normalizePointArgs:function(a,
b,c,d,e){e=e||Z;var f=e.point;f.spatialReference=void 0;"object"===typeof a?(f.x=a.x,f.y=a.y,f.z=a.z,a.spatialReference&&(f.spatialReference=a.spatialReference),e.retval=b):(f.x=a,f.y=b,"number"!==typeof c&&void 0!==c?(f.z=void 0,e.retval=c):(f.z=c,e.retval=d));f.spatialReference||(f.spatialReference=this.spatialReference||p.WGS84);return e},_separateInitialProperties:function(){var a={},b={},c={},d=function(a){if(a=ta[a])for(var b=0;b<a.length;b++)c[a[b]]=!0,d(a[b])},e;for(e in this._initialProps){var f=
this._initialProps[e];ta[e]?(d(e),a[e]=f):b[e]=f}for(e in c)delete a[e];return{view:a,other:b}},_viewReadyHandler:function(a,b){if(!b){"global"===this.viewingMode&&(this._clippingArea=null);this._internallyReady=!0;this._initSurface();this._initGraphicsView();a=this._separateInitialProperties();for(var c in a.other)this.set(c,a.other[c]);for(c in a.view)this.set(c,a.view[c]);c=this.get("map.initialViewProperties.viewpoint");a=this.get("initialExtent");c?this._setInitialView(c):a&&a.spatialReference.equals(this.spatialReference)?
this._setInitialView(a):"local"===this.viewingMode&&A.whenOnce(this.basemapTerrain,"ready",function(){this._setInitialView(this.groundExtent)}.bind(this));!this._externallySet.environment&&(c=this.get("map.initialViewProperties.environment"))&&(this.environment=c);this._initialProps={};this.notifyChange("initialExtentRequired");this._updateDrawingOrderHandle=this.allLayerViews.on("change",this._updateDrawingOrder.bind(this));this._updateDrawingOrder({added:this.allLayerViews.toArray(),removed:[],
moved:[]});this.environmentManager.updateReadyChange(!0)}},_viewUnreadyHandler:function(a,b){b&&(this._initialDefaultSpatialReference=null,this.environmentManager.updateReadyChange(!1),this._disposeGraphicsView(),this._internallyReady=!1,this._disposeSurface(),this.sharedSymbolResources&&(this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null),this._stage&&(this._stage.dispose(),this._stage=null,this._stageHandles.remove()),this._setCanvas(null))},_getDesiredHeadingTilt:function(){if(this._externallySet.camera){var a=
this.camera;Aa.heading=a.heading;Aa.tilt=a.tilt}else Aa.heading=0,Aa.tilt=.5;return Aa},_cameraSetter:ra("camera",function(a){this._setCamera(a,{animate:!1})||oa.error("#camera\x3d","Invalid camera",a)}),_cameraGetter:ia("camera",function(a){return X.internalToExternal(this,this.navigation.currentCamera,a)}),_externalExtent:function(){this._cachedExtentDirty&&(X.toExtent(this,null,null,this._cachedExtent,sa),this._cachedExtentDirty=!1);return this._cachedExtent},_extentGetter:ia("extent",function(a){return X.toExtent(this,
null,null,a,sa)}),_extentSetter:ra("extent",function(a){var b=X.fromExtent(this,a,this._getDesiredHeadingTilt(),sa);b?this.camera=b:this._isIncompatibleSpatialReference(a.spatialReference)?oa.error("#extent\x3d","Extent has an incompatible spatial reference (extent: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a):oa.error("#extent\x3d","Invalid extent",a)}),_heightModelInfoGetter:function(){var a=this.getHeightModelInfoWithOverride();a&&null==a.heightUnit&&(a=l.deriveUnitFromSR(a,
this.spatialReference));return a},_heightModelInfoSetter:function(a){this._internallyReady?oa.error("#heightModelInfo","heightModelInfo cannot be set once view is ready"):this.setHeightModelInfoOverride(a)},_isIncompatibleSpatialReference:function(a){return a&&!a.equals(this.spatialReference)&&!q.canProject(a,this.spatialReference)},_scaleGetter:ia("scale",function(){return null!=this.navigation?X.computeScale(this,this.navigation.currentCamera):0}),_scaleSetter:ra("scale",function(a){var b=this._getDesiredHeadingTilt(),
c=this.navigation.currentCamera.center,d=Ba.create();V.vectorToVector(c,this.renderSpatialReference,d,p.WGS84);a=X.scaleToDistance(this,a,d[1]);b=X.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,c,a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}),_zoomGetter:ia("zoom",function(){return X.scaleToZoom(this,this.scale)}),_zoomSetter:ra("zoom",function(a){this.scale=X.zoomToScale(this,a)}),_centerGetter:ia("center",function(a){var b=
this.spatialReference||p.WGS84;return V.vectorToPoint(this.navigation.currentCamera.center,this.renderSpatialReference,a||b,b)}),_centerSetter:ra("center",function(a){if(this._isIncompatibleSpatialReference(a&&a.spatialReference))oa.error("#center\x3d","Center has an incompatible spatial reference (center: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a);else{var b=this._getDesiredHeadingTilt();(b=X.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,a,this.navigation.currentCamera.distance))||
oa.error("#center\x3d","Invalid center",a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}}),_viewpointGetter:ia("viewpoint",function(){return T.fromCamera(this,this.camera)}),_viewpointSetter:ra("viewpoint",function(a){var b=T.toCamera(this,a);b?this._setCamera(b,{animate:!1}):oa.error("#viewpoint\x3d","Invalid viewpoint",a)}),_screenCenterGetter:function(){var a=this.padding;return new r((this.size[0]-(a.left+a.right))/2+a.left,(this.size[1]-
(a.top+a.bottom))/2+a.top)},_updateDrawingOrder:function(){var a=this.allLayerViews.length-1;this.allLayerViews.forEach(function(b,c){null!=b.drawingOrder&&(b.drawingOrder=a-c)},this)},_paddingSetter:ra("padding",function(a){this._set("padding",{top:a&&a.top||0,right:a&&a.right||0,bottom:a&&a.bottom||0,left:a&&a.left||0});this.navigation&&(this.navigation.padding=this._get("padding"))}),_constraintsSetter:ra("constraints",function(a){this._set("constraints",a);a===this._defaults.constraints&&(this._defaults.constraints=
null,a.scale(1/this.renderCoordsHelper.unitInMeters));this.navigation.userConstraints=a}),_animationSetter:function(a){a!==this._get("animation")&&(this._internallyReady?(this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null),this._set("animation",a),a&&(this._animationStateWatcher=a.watch("state",function(a){if(a===g.State.FINISHED||a===g.State.STOPPED)this.animation=null,a===g.State.FINISHED?this.navigation.setCurrentToTarget():this.navigation.setCamera(this.navigation.currentCamera,
{animate:!1})}.bind(this)))):oa.error("#animation\x3d","Scene view cannot be used before it is ready"))},_mapSetter:function(a){a!==this._get("map")&&(this.navigation&&this.navigation._dataExtentChanged(),this._mapLayersChangeHandle&&this._mapLayersChangeHandle.remove(),a&&(this._mapLayersChangeHandle=a.allLayers.on("change",this.notifyChange.bind(this,"dataExtent"))),delete this._externallySet.camera,this.inherited(arguments))}})});