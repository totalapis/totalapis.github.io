// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.4/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),function(e,p,m,l,k,n){e=function(e){function b(a){a=e.call(this,a)||this;a._container=null;a._overlay=null;a._backgroundShape=null;a._boxShape=null;a._box={x:0,y:0,width:0,height:0};a._redraw=a._redraw.bind(a);return a}m(b,e);b.prototype.destroy=function(){this.view=null};Object.defineProperty(b.prototype,"view",{set:function(a){var c=
this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],function(a){return c._handleDrag(a,1)}),a.on("drag",["Shift","Ctrl"],function(a){return c._handleDrag(a,-1)}))},enumerable:!0,configurable:!0});b.prototype._start=function(a,c,d,g){this._createContainer();this._createOverlay();this.navigation.begin()};b.prototype._update=function(a,c,d,g){this._box.x=a;this._box.y=c;this._box.width=d;this._box.height=
g;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};b.prototype._end=function(a,c,d,g,f){var b=this.view;a=b.toMap(a+.5*d,c+.5*g);d=Math.min(d/b.width,g/b.height);-1===f&&(d=1/d);this._destroyOverlay();this.navigation.end();b.goTo({center:a,scale:b.scale*d})};b.prototype._updateBox=function(a,c,d,g){var b=this._boxShape;b.setAttributeNS(null,"x",""+a);b.setAttributeNS(null,"y",""+c);b.setAttributeNS(null,"width",""+d);b.setAttributeNS(null,"height",""+g);b.setAttributeNS(null,"class",
"esri-zoom-box__outline")};b.prototype._updateBackground=function(a,c,d,b){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,c,d,b,this.view.width,this.view.height))};b.prototype._createContainer=function(){var a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a};b.prototype._createOverlay=function(){var a=this.view.width,c=this.view.height,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,
"d","M 0 0 L "+a+" 0 L "+a+" "+c+" L 0 "+c+" Z");d.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg","rect");c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");c.setAttributeNS(null,"class","esri-zoom-box__overlay");c.appendChild(d);c.appendChild(a);this._container.appendChild(c);this._backgroundShape=d;this._boxShape=a;this._overlay=
c};b.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};b.prototype._toSVGPath=function(a,c,d,b,f,e){d=a+d;b=c+b;return"M 0 0 L "+f+" 0 L "+f+" "+e+" L 0 "+e+" ZM "+a+" "+c+" L "+a+" "+b+" L "+d+" "+b+" L "+d+" "+c+" Z"};b.prototype._handleDrag=function(a,b){var d=a.x,c=a.y,f=a.origin.x,e=a.origin.y,h;d>f?(h=f,f=d-f):(h=d,f-=d);c>e?(d=e,c-=
e):(d=c,c=e-c);switch(a.action){case "start":this._start(h,d,f,c);break;case "update":this._update(h,d,f,c);break;case "end":this._end(h,d,f,c,b)}a.stopPropagation()};b.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=this._box,c=a.x,b=a.y,e=a.width,a=a.height;this._updateBox(c,b,e,a);this._updateBackground(c,b,e,a);this._rafId=requestAnimationFrame(this._redraw)}};return b}(k.declared(n));l([k.property()],e.prototype,"navigation",void 0);l([k.property()],e.prototype,
"view",null);return e=l([k.subclass("esri.views.2d.navigation.ZoomBox")],e)});