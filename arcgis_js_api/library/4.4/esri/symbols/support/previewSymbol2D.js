// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.4/esri/copyright.txt for details.
//>>built
define("require exports dojox/gfx/_base ../SimpleMarkerSymbol ../../core/promiseUtils ../../core/Error ../../core/screenUtils ./renderUtils ./previewUtils ./gfxUtils".split(" "),function(y,p,u,m,r,v,n,w,x,t){Object.defineProperty(p,"__esModule",{value:!0});p.previewSymbol2D=function(d,h){var g=h&&h.size?n.pt2px(h.size):null,k=h&&h.maxSize?n.pt2px(h.maxSize):null,b=t.getStroke(d),f={shape:null,fill:t.getFill(d),stroke:b};b&&b.width&&(b.width=Math.min(b.width,80));var a=0,c=0,q=b&&b.width||0,p=!1,l=
null;switch(d.type){case "simple-marker-symbol":a=m.defaultProps;b=d.style;c=a=g=Math.min(g||n.pt2px(d.size||a.size),k||120);switch(b){case m.STYLE_CIRCLE:f.shape={type:"circle",cx:0,cy:0,r:.5*g};break;case m.STYLE_CROSS:f.shape={type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[a,.5*c]},{command:"M",values:[.5*a,0]},{command:"L",values:[.5*a,c]},{command:"E",values:[]}]};break;case m.STYLE_DIAMOND:f.shape={type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*
a,0]},{command:"L",values:[a,.5*c]},{command:"L",values:[.5*a,c]},{command:"Z",values:[]}]};break;case m.STYLE_SQUARE:f.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[a,c]},{command:"L",values:[0,c]},{command:"Z",values:[]}]};break;case m.STYLE_X:f.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,c]},{command:"M",values:[a,0]},{command:"L",values:[0,c]},{command:"E",values:[]}]};break;case m.STYLE_PATH:p=!0,f.shape={type:"path",
path:d.path||""}}break;case "simple-line-symbol":d=Math.min(g||q,k||80);a=22<d?2*d:40;c=d;b.width=d;q=0;f.shape={type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[a,.5*c]},{command:"E",values:[]}]};break;case "picture-fill-symbol":case "simple-fill-symbol":f.shape=x.shapes.fill[0];break;case "picture-marker-symbol":var l=k||120,b=n.pt2px(d.width),e=n.pt2px(d.height),l=Math.min(g||Math.max(b,e),l),a=b/e,b=1>=a?Math.ceil(l*a):l,e=1>=a?l:Math.ceil(l/a),a=b,c=e,l=h.opacity;f.shape=
{type:"image",x:-Math.round(b/2),y:-Math.round(e/2),width:b,height:e,src:d.url||""};break;case "text-symbol":b=d.text||"Aa";e=d.font;g=Math.min(g||n.pt2px(e.size),k||120);for(c=a=0;c<b.length;c++)k=b.charAt(c),k=k===k.toUpperCase()?.7:.5,a+=g*k;c=g;f.shape={type:"text",text:b,x:0,y:.25*u.normalizedLength((e?g:0).toString()),align:"middle",decoration:d.decoration||e&&e.decoration,rotated:d.rotated,kerning:d.kerning};f.font=e&&{size:g,style:e.style,variant:e.variant,decoration:e.decoration,weight:e.weight,
family:e.family}}return f.shape?r.resolve(w.renderSymbol([[f]],[(a||22)+2*q,(c||22)+2*q],{node:h&&h.node,scale:p,opacity:l})):r.reject(new v("symbolPreview: renderPreviewHTML2D","symbol not supported."))}});