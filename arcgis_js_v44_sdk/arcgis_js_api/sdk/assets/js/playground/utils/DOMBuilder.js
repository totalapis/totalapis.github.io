/*! ArcGIS API for JavaScript 4.4 | Copyright (c) 2017 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
define(["esri-playground-js/utils/CurrentState","esri-playground-js/utils/mainUtils","esri-playground-js/utils/ObjectProvider","dijit/registry"],function(e,t,a,d){"use-strict";var i={},n=function(e){var t;return t=document.createElement(e.tag),e.data&&(t.innerHTML=e.data),e.class&&(t.className=e.class),e.id&&t.setAttribute("id",e.id),t},l=function(e){var t=document.createElement("ul");return e.forEach(function(e){var a=document.createElement("li"),d=n({data:e.name,tag:"p"});a.setAttribute("data-config-loc",e.location),a.setAttribute("data-config-name",e.name),a.appendChild(d);var i;e.message&&(i=n({tag:"i",class:"fa fa-exclamation-circle"}),e.error&&(i.style.color="#e74c3c"),a.setAttribute("data-tooltip",e.message),a.className="hasToolTip",d.appendChild(i)),t.appendChild(a)}),t},r=function(e){var t=e.node,a=document.createElement("ul");return e.config.properties.forEach(function(t){s({config:e.config,property:t,node:a,domId:e.domId,isList:!0,enableDelete:e.enableDelete})}),null==t&&(t=n({tag:"div"})),t.appendChild(a),t},s=function(t){var a,i=e.getInstance(),l=t.config,s=t.property,f=t.node,v=t.domId,m=t.enableDelete,g=t.isList;a=g?document.createElement("li"):n({tag:"div",class:t.class}),v&&a.setAttribute("data-domId",v);var h,b;if("Object"===s.type||"Array"===s.type||"Class"===s.type||"Color"===s.type){var y=n({tag:"div",class:"nested-property-container"});if(h=n({data:s.name,tag:"p",class:"nested-property-name"}),s.required){var C=n({data:"*",tag:"span"});h.appendChild(C)}var I=n({tag:"div"}),A=n({data:"expand",tag:"p",class:null,id:s.domId+"-TextID"});I.appendChild(A),y.appendChild(h),y.appendChild(I),a.appendChild(y),b=n({tag:"div",class:"modal-container"}),a.addEventListener("click",function(e){b.style.display="block";var t=document.getElementById("playArea").children[0].children[0];t.appendChild(b),t.scrollTop=0,t.style.overflow="hidden",e.stopPropagation()})}else{if(h=n({data:s.name,tag:"p",class:"property-name"}),s.required){var C=n({data:"*",tag:"span"});h.appendChild(C)}a.appendChild(h),b=n({tag:"div",class:"property-value-container"}),a.className="flexer"}if("Number"===s.type)if(s.attributes&&s.attributes.min&&s.attributes.max){var j=n({tag:"input",class:"property-value",id:s.domId+"-RangeID"});if(j.setAttribute("type","range"),void 0!==s.default?(j.setAttribute("placeholder",Math.round(100*s.default)/100),j.value=Math.round(100*s.default)/100):j.setAttribute("placeholder","enter "+s.name),s.attributes)for(var E in s.attributes)j.setAttribute(E,s.attributes[E]);b.appendChild(j);var j=n({tag:"input",class:"property-value",id:s.domId+"-ID"});if(j.setAttribute("type","number"),void 0!==s.default?(j.setAttribute("placeholder",Math.round(100*s.default)/100),j.value=Math.round(100*s.default)/100):j.setAttribute("placeholder","enter "+s.name),s.attributes)for(var E in s.attributes)j.setAttribute(E,s.attributes[E]);b.appendChild(j)}else{var j=n({tag:"input",class:"property-value",id:s.domId+"-ID"});if(j.setAttribute("type","number"),void 0!==s.default?(j.setAttribute("placeholder",Math.round(100*s.default)/100),j.value=Math.round(100*s.default)/100):j.setAttribute("placeholder","enter "+s.name),s.attributes)for(var E in s.attributes)j.setAttribute(E,s.attributes[E]);b.appendChild(j)}else if("Boolean"===s.type){var N=n({tag:"div",class:"checkbox-container"}),j=n({tag:"input",class:"property-value",id:s.domId+"-ID"});j.setAttribute("type","checkbox"),s.default&&(j.checked=!0);var O=n({tag:"label"});O.setAttribute("for",s.domId+"-ID"),N.appendChild(j),N.appendChild(O),b.appendChild(N)}else if("String"===s.type)if(s.options){var D=n({tag:"SELECT",class:"property-value",id:s.domId+"-ID"});D.setAttribute("name",s.name);var k=n({data:"select "+s.name,tag:"option"});k.disabled=!0,k.selected=!0,k.style.background="#ecf0f1",D.appendChild(k);var L=s.options.values;L.forEach(function(e){var t,a,d=n({tag:"option"});"string"==typeof e?(t=e,a=e):(t=e.name,a=e.value),d.innerHTML=t,d.setAttribute("value",a),s.default&&s.default===a&&(d.selected=!0),D.appendChild(d)}),b.appendChild(D)}else if(s.value){var S=n({data:s.value+" (default)",tag:"p",class:"property-value",id:s.domId+"-ID"});b.appendChild(S)}else{var j=n({tag:"input",class:"property-value",id:s.domId+"-ID"});j.setAttribute("type","text"),void 0!==s.default?j.setAttribute("placeholder",s.default):j.setAttribute("placeholder","enter "+s.name),b.appendChild(j)}else if("Color"===s.type){var x=s.domId+"-",M=n({tag:"div",class:"colorDiv",id:x+"HolderID"}),T=n({tag:"div",class:"property-value",id:x+"ID"});M.appendChild(T),u(a,b,s.name,T)}else if("Object"===s.type){var P=s.config||s,q=r({config:P});u(a,b,s.name,q)}else if("Array"===s.type){var B=s.options;"Object"===B.type?c(a,s,B,b):"Color"===B.type?p(a,s,b):"Number"===B.type&&o(a,s,b)}else if("Class"===s.type){var P=s.config,B=s.options;if(P){var H=r({config:P});u(a,b,s.name,H)}else B&&c(a,s,B,b)}if(a.appendChild(b),m){var w=n({tag:"i",class:"fa fa-trash-o"});a.appendChild(w),w.addEventListener("click",function(e){if(g){var n,r=i.statefulObject[l.name].slice(0),s=a.getAttribute("data-domId");l.properties.some(function(e,t){if(s===e.domId)return n=t,!0}),l.properties.splice(n,1),r.splice(n,1),i.statefulObject.set(l.name,r)}else t.selectNode.style.display="block",i.statefulObject.set(l.name,null);if(d.findWidgets(a).forEach(function(e){e.destroy(!0)}),f.removeChild(a),0===f.childNodes.length){var o=f.parentNode,p=o.parentNode;o.removeChild(f),p.removeChild(o)}e.stopPropagation()})}return f.appendChild(a),f},o=function(t,a,d){var i=e.getInstance(),l=n({tag:"div",class:"inputSelect-block"}),r=n({data:"Add",tag:"button"});l.appendChild(r),u(t,d,a.name,l),r.addEventListener("click",function(){var e=n({tag:"input",class:"property-value",id:a.domId+"-ID"});e.setAttribute("type","text"),e.setAttribute("placeholder","enter "+a.name),d.firstChild.childNodes[1].appendChild(e),e.addEventListener("change",function(){a.properties.push(e.value);var t=[e.value];i.statefulObject.set(a.name,t)})})},p=function(e,t,a){var d=n({tag:"div",class:"colorSelect-node",data:"select color"}),i=n({tag:"div"}),l=n({data:"Add",tag:"button"}),r=n({tag:"div",class:"colorSelect-block"});i.appendChild(d),i.appendChild(l),r.appendChild(i),u(e,a,t.name,r),d.addEventListener("click",function(){})},c=function(d,i,l,o){var p=e.getInstance(),c=n({tag:"SELECT"});c.setAttribute("name",i.domId),l.values.forEach(function(e){if("Class"===e.type){var t=n({data:e.className,tag:"option"});t.setAttribute("value",e.location),c.appendChild(t)}else if("Object"===e.type){var t=n({data:e.name,tag:"option"});t.setAttribute("value",e.name),c.setAttribute("data-type","Object"),c.appendChild(t)}});var v=n({data:"Add",tag:"button"}),m=n({tag:"div"}),g=n({tag:"div",class:"typeSelect-block"});m.appendChild(c),m.appendChild(v),g.appendChild(m),u(d,o,i.name,g),v.addEventListener("click",function(e){var d=c.value;if(d)if(i.properties){var n,l=c.getAttribute("data-type");"Object"===l?i.options.values.some(function(e){if(e.name===d)return n=e,!0}):n=t.parseConfig(require.toUrl("esri-playground-data")+"/"+d,!0);var u=i.domId+"-"+i.properties.length;f(n,u);var v;if("Object"===l?(v=n,v.domId=u):v={name:n.className,className:n.className,config:n,domId:u,type:"Class"},i.properties.push(v),1===i.properties.length){var g=r({config:i,domId:u,enableDelete:!0});o.firstChild.childNodes[1].appendChild(g);var h=[a.getStatefullObject(n,p.statefulObject)];p.statefulObject.set(i.name,h)}else{s({config:i,property:v,domId:u,node:o.firstChild.childNodes[1].childNodes[1].firstChild,isList:!0,enableDelete:!0});var h=p.statefulObject[i.name].slice(0);h.push(a.getStatefullObject(n,p.statefulObject)),p.statefulObject.set(i.name,h)}}else{var u=i.domId,n=t.parseConfig("esri-playground-data/"+d,!0);f(n,u),i.location=d,i.config=n,i.className=n.className;var v={name:n.className,type:"Class",config:n,className:n.className,domId:u};s({config:i,property:v,domId:u,node:o.firstChild.childNodes[1].firstChild,selectNode:m,class:"item",isList:!1,enableDelete:!0}),p.statefulObject.set(i.name,a.getStatefullObject(n,p.statefulObject)),m.style.display="none"}e.stopPropagation()})},u=function(e,t,a,d){var i=n({tag:"div",class:"modal"}),l=n({tag:"div",class:"header"}),r=n({data:a,tag:"p",class:"title"}),s=n({tag:"i",class:"fa fa-times"}),o=n({tag:"div",class:"body"});l.appendChild(r),l.appendChild(s),i.appendChild(l),o.appendChild(d),i.appendChild(o),s.addEventListener("click",function(a){t.style.display="none";var d=document.getElementById("playArea").children[0].children[0];d.removeChild(t),e.appendChild(t),1===d.children.length&&(d.style.overflow="auto"),a.stopPropagation()}),t.appendChild(i)},f=function(e,t){e.properties.forEach(function(e){var a=t+"-"+e.name;e.config?f(e.config,a):(e.domId=a,"Object"===e.type&&f(e,a))})},v=function(e){var t=n({tag:"div",class:"data-container"}),a=n({tag:"div",class:"data-block"});f(e,e.className);var d=r({config:e,node:a});t.appendChild(d);var i=document.createDocumentFragment();return i.appendChild(t),i},m=function(e){var t=document.createDocumentFragment();return e.constructor===Array&&e.forEach(function(e){var a=n({tag:"div",class:"modules-container"}),d=n({data:e.name,tag:"p",class:"title"}),i=l(e.list);a.appendChild(d),a.appendChild(i),t.appendChild(a)}),t};return i.getMainfragment=v,i.getIndexfragment=m,i});